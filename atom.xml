<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dyd&#39;s Blog</title>
  
  <subtitle>He who has a strong enough why can bear almost any how.</subtitle>
  <link href="https://dyd-true.github.io/atom.xml" rel="self"/>
  
  <link href="https://dyd-true.github.io/"/>
  <updated>2022-01-09T08:41:24.187Z</updated>
  <id>https://dyd-true.github.io/</id>
  
  <author>
    <name>Dyd</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>三/四元环计数</title>
    <link href="https://dyd-true.github.io/2022/01/09/%E4%B8%89-%E5%9B%9B%E5%85%83%E7%8E%AF%E8%AE%A1%E6%95%B0/"/>
    <id>https://dyd-true.github.io/2022/01/09/%E4%B8%89-%E5%9B%9B%E5%85%83%E7%8E%AF%E8%AE%A1%E6%95%B0/</id>
    <published>2022-01-09T06:57:45.000Z</published>
    <updated>2022-01-09T08:41:24.187Z</updated>
    
    <content type="html"><![CDATA[<p> 还是比较简单的</p><span id="more"></span><h1 id="三-四元环计数"><a href="#三-四元环计数" class="headerlink" title="三/四元环计数"></a>三/四元环计数</h1><h2 id="三元环计数"><a href="#三元环计数" class="headerlink" title="三元环计数"></a>三元环计数</h2><p>思考如下问题：</p><p>给定一个<strong>无向图</strong>，求图中有多少个环是<strong>由且仅由三个点构成的</strong>，这样的环被称为<strong>三元环</strong></p><p>暴力的办法当然是枚举每一个点 $u$ ，再枚举和它相连的点 $v$ ，再枚举和 $v$ 相连的点 $w$ ，判断 $w$ 是否和 $u$ 相连</p><p>但这样会有一个巨大的问题：一个环被算了多遍，必须想办法让一个环只被考虑一遍</p><p>考虑将边变为有向边，具体的，对于边 $(u, v), u &lt; v$ ：</p><ol><li>若 $\deg(u) = \deg(v)$ 则令 $v \to u$ </li><li>否则，让度数大的指向度数小的</li></ol><p>下面证明这样做后原图会变成一个<strong>DAG</strong>：</p><p>使用反证法，假设有一个环为 $a \to b \to … \to a$ ，则有 $\deg(a) \ge \deg(b) \ge … \ge \deg(a)$ ，明显应该 $\deg(a) = \deg(b)$ ，换句话说，这个环上的所有边都是第 $1$ 类情况，那么就有 $a &gt; b &gt; … &gt; a$ 这显然不成立</p><p>在上面的DAG中，一个三圆环显然会变成这样：<img src="https://s2.loli.net/2022/01/09/efZA16ptMNFakVw.png" alt="三元环"></p><p>此时再枚举，这个环就只会被记在红点上了</p><p>关于时间，首先我们要枚举每个点和它的出边，时间为 $O(n + m)$ ，然后，要枚举出边指向的点的出边</p><p>如此，对于第二次枚举，讨论这个点（就是红色点的出边指向的那个点）的出度：</p><ol><li>如果出度 $\le \sqrt{m}$ ，那么最多有 $n - 1$ 个点会指向它，由它会枚举的点数为就是出度，所以总的时间为 $O(n \sqrt{m})$ </li><li>如果出度 $&gt; \sqrt{m}$ ，那么指向它的边最多有 $\frac{m}{\sqrt{m}} = \sqrt{m}$ ，虽然它的出度最坏是 $m$ ，但总的时间为 $O(m\sqrt{m})$ </li></ol><p>注意在上面的讨论中，第一次枚举和第二次枚举是站在两个不同的角度计算的时间，在计算第二次枚举的时间时，第一次枚举的时间对它并没有影响，故总的时间为 $O(n + m + (n \sqrt{m} 或 m \sqrt{m})) = O(m \sqrt{m})$ </p><p>同时也可以得到，三元环的个数上界是 $m \sqrt{m}$ </p><p>代码如下 ：</p><p><a href="https://www.luogu.com.cn/problem/P1989">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find3c</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            vis[e[i].ver] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                res += vis[e[j].ver];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            vis[e[i].ver] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    STC PII _e[M];</span><br><span class="line">    STC <span class="keyword">int</span> deg[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;_e[i].fi, &amp;_e[i].se);</span><br><span class="line">        <span class="keyword">if</span> (_e[i].fi &lt; _e[i].se)</span><br><span class="line">            <span class="built_in">swap</span>(_e[i].fi, _e[i].se);</span><br><span class="line">        ++deg[_e[i].fi], ++deg[_e[i].se];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_e[i].fi == _e[i].se)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (deg[_e[i].fi] &gt;= deg[_e[i].se])</span><br><span class="line">            <span class="built_in">add</span>(_e[i].fi, _e[i].se);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">add</span>(_e[i].se, _e[i].fi);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">find3c</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="四元环计数"><a href="#四元环计数" class="headerlink" title="四元环计数"></a>四元环计数</h2><p>简单的思路是将四元环分成两个形如 $u \to v \to w$ 的形式，枚举 $u$ ，然后像三元环化为DAG，一样枚举 $v, w$ ，对于 $u, w$ 记 <code>cnt[u][w]</code> 表示从 $u$ 通过一个其它点到达 $w$ 的路径数，然后对答案的贡献即为 <code>cnt[u][w] * (cnt[u][w] - 1) / 2</code> </p><p>这样当然是错误的，因为三元环是无序的，有唯一性（即三个点最多存在一个三元环，且在DAG中这个三元环的形式确定），但四元环就不是了，如图：<img src="https://s2.loli.net/2022/01/09/hNO64LyPJT1aqfK.png" alt="四元环"></p><p>同一个四元环在DAG中可能有两种表示（ $2 + 2$ 或者 $3 + 1$ ）</p><p>那如何才能不重不漏呢？考虑三元环建边时的不等式：如果存在 $u \to v$ ，则 $\deg(u) \ge \deg(v)$ ，那么，在上面两幅图中，我们发现，<strong>度数最大的是同一个点</strong>，这启发了我们</p><p><strong>我们将每个点按度数大小重新编号，度数相同原来编号大的点在前</strong>的方法，就可以通过编号直接得到任意两个点的关系</p><p>设重新编号后排名为 $rk$ ，枚举四圆环中 $rk$ 最大的点 $x$ ，再枚举 $x$ 的出点 $y$ ，枚举  $y$ 的出点 $z$ （这里直接枚举无向边，注意判断 $rk(x) &gt; rk(y) &gt; rk(z)$ ）， 这里就得到了一个长度为 $2$ 的链了，再枚举一个点 $c$ ，只要 $rk(x) &gt; rk(c)$ 就计入答案的贡献，不管 $rk(c)$ 和 $rk(z)$ 的关系</p><p>时间复杂度还是 $O(m \sqrt{m})$ </p><p>注意四元环的个数上界是 $nm\sqrt{m}$ ，可能要 <code>long long</code> </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> id[N], deg[N], rk[N];</span><br><span class="line"><span class="keyword">int</span> cnt[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">find4c</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (rk[x] &gt; rk[e[i].ver])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                    <span class="keyword">if</span> (rk[x] &gt; rk[e[j].ver])</span><br><span class="line">                        res += cnt[e[j].ver]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (rk[x] &gt; rk[e[i].ver])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                    cnt[e[i].ver] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> deg[x] == deg[y] ? x &lt; y : deg[x] &lt; deg[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>, id[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        ++deg[u], ++deg[v];</span><br><span class="line">        <span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(id + <span class="number">1</span>, id + <span class="number">1</span> + n, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        rk[id[i]] = i;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">find4c</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>以后在写，现在鸽了</p><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>啊啊啊，马上就要考期末考试了，这估计是我考前最后一次写blog了，老天保佑我别考爆炸啊！</p>]]></content>
    
    
    <summary type="html">&lt;p&gt; 还是比较简单的&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="图论" scheme="https://dyd-true.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
    <category term="笔记" scheme="https://dyd-true.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>luoguP3765 总统选举</title>
    <link href="https://dyd-true.github.io/2022/01/08/luoguP3765-%E6%80%BB%E7%BB%9F%E9%80%89%E4%B8%BE/"/>
    <id>https://dyd-true.github.io/2022/01/08/luoguP3765-%E6%80%BB%E7%BB%9F%E9%80%89%E4%B8%BE/</id>
    <published>2022-01-08T11:50:26.000Z</published>
    <updated>2022-01-09T00:15:48.514Z</updated>
    
    <content type="html"><![CDATA[<p> 心血来潮想写SBT了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3765">总统选举</a></p><p>想写平衡树了，所以看了道题</p><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><p>首先有一个小小的前置知识：<strong>摩尔投票法</strong></p><p>摩尔投票法用来寻找数组中<strong>出现次数超过一半的元素</strong></p><p>思想很简单，考虑每次取两个不同的数，把他们都删掉，如果有一个数出现次数超过一半的话，最后剩下的数一定都是这个数，正确性显然</p><p>具体实现可以考虑维护一个 <code>cnt</code> 和 <code>t</code> ，扫描每一个元素，若 <code>cnt = 0</code> ，则令 <code>t = x</code> ，否则 <code>cnt += (t == x ? 1 : -1)</code> ， 最后如果 <code>cnt</code> 大于 $0$ ， <code>t</code> 即是出现次数超过一半的元素</p><p>但这里有一个条件，那就是<strong>必须保证出现次数超过一半的元素存在</strong>，否则 <code>t</code>  当然就不是所求，所以我们还需要判断一下 <code>t</code> 的出现次数是否超过一半</p><h2 id="题"><a href="#题" class="headerlink" title="题"></a>题</h2><p>那么考虑这道题</p><p>由摩尔投票法，对于每个区间我们只需要维护出 <code>cnt</code> 和 <code>t</code> </p><p>考虑道维护的东西可以合并，即对于 $fa = [l, r], lc = [l, mid], rc = [mid + 1, r]$ ，有：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (v[lc] == v[rc])</span><br><span class="line">&#123;</span><br><span class="line">    v[fa] = v[lc];</span><br><span class="line">    cnt[fa] = cnt[lc] + cnt[rc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (cnt[lc] &gt;= cnt[rc])</span><br><span class="line">&#123;</span><br><span class="line">    cnt[fa] = cnt[lc] - cnt[rc];</span><br><span class="line">    v[fa] = v[lc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    cnt[fa] = cnt[rc] - cnt[lc];</span><br><span class="line">    v[fa] = v[rc];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>正确性显然</p><p>所以可以考虑用线段树维护 <code>cnt</code> 和 <code>t</code> （就是上面的 <code>v</code> ）</p><p>但是！问题来了：摩尔投票法有一个讨厌的前提——<strong>必须保证出现次数超过一半的元素存在</strong>，所以我们还要检验这个数是否真的是出现次数超过一半的数</p><p>考虑平衡树，对于每一个候选人，建一棵平衡树，维护支持他的人的下标，直接查询 <code>l - 1</code> 和 <code>r</code> 在平衡树中的排名即可得到在 $[l, r]$ 中有多少人支持他</p><p>卡了个最优（主要是SBT快），估计现在已经没了吧</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SBT yyds</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, K = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeForSBT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, v, si;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) node_for_sbt[(x)].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) node_for_sbt[(x)].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> v(x) node_for_sbt[(x)].v</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> si(x) node_for_sbt[(x)].si</span></span><br><span class="line">&#125; node_for_sbt[N + K]; <span class="comment">//由于del优化,SBT的节点数为n+插入节点数</span></span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SBT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> rt = <span class="number">0</span>;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">rr</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="built_in">l</span>(t);</span><br><span class="line">        <span class="built_in">l</span>(t) = <span class="built_in">r</span>(k), <span class="built_in">r</span>(k) = t;</span><br><span class="line">        <span class="built_in">si</span>(k) = <span class="built_in">si</span>(t);</span><br><span class="line">        <span class="built_in">si</span>(t) = <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="built_in">si</span>(<span class="built_in">r</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        t = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">lr</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="built_in">r</span>(t);</span><br><span class="line">        <span class="built_in">r</span>(t) = <span class="built_in">l</span>(k), <span class="built_in">l</span>(k) = t;</span><br><span class="line">        <span class="built_in">si</span>(k) = <span class="built_in">si</span>(t);</span><br><span class="line">        <span class="built_in">si</span>(t) = <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="built_in">si</span>(<span class="built_in">r</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        t = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">mt</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">bool</span> f)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!f)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">l</span>(<span class="built_in">l</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">r</span>(t)))</span><br><span class="line">                <span class="built_in">rr</span>(t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">r</span>(<span class="built_in">l</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">r</span>(t)))</span><br><span class="line">                <span class="built_in">lr</span>(<span class="built_in">l</span>(t)), <span class="built_in">rr</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">r</span>(<span class="built_in">r</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">l</span>(t)))</span><br><span class="line">                <span class="built_in">lr</span>(t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">l</span>(<span class="built_in">r</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">l</span>(t)))</span><br><span class="line">                <span class="built_in">rr</span>(<span class="built_in">r</span>(t)), <span class="built_in">lr</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">mt</span>(<span class="built_in">l</span>(t), <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">mt</span>(<span class="built_in">r</span>(t), <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">mt</span>(t, <span class="literal">false</span>), <span class="built_in">mt</span>(t, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!t)</span><br><span class="line">        &#123;</span><br><span class="line">            t = ++num;</span><br><span class="line">            node_for_sbt[t] = &#123;<span class="number">0</span>, <span class="number">0</span>, v, <span class="number">1</span>&#125;;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        ++<span class="built_in">si</span>(t);</span><br><span class="line">        <span class="keyword">if</span> (v &lt;= <span class="built_in">v</span>(t))</span><br><span class="line">            <span class="built_in">ins</span>(<span class="built_in">l</span>(t), v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">ins</span>(<span class="built_in">r</span>(t), v);</span><br><span class="line">        <span class="built_in">mt</span>(t, v &gt; <span class="built_in">v</span>(t));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        --<span class="built_in">si</span>(t); <span class="comment">//一定要先减,不然会错</span></span><br><span class="line">        <span class="keyword">if</span> ((<span class="built_in">v</span>(t) == v) || (<span class="built_in">v</span>(t) &lt; v &amp;&amp; !<span class="built_in">r</span>(t)) || (<span class="built_in">v</span>(t) &gt; v &amp;&amp; !<span class="built_in">l</span>(t)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="built_in">v</span>(t);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">l</span>(t) || !<span class="built_in">r</span>(t))</span><br><span class="line">                t = <span class="built_in">l</span>(t) + <span class="built_in">r</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">v</span>(t) = <span class="built_in">del</span>(<span class="built_in">l</span>(t), <span class="built_in">v</span>(t) + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//在这里--si(t)就会错</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">v</span>(t) &lt; v ? <span class="built_in">del</span>(<span class="built_in">r</span>(t), v) : <span class="built_in">del</span>(<span class="built_in">l</span>(t), v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">rk</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!t)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="built_in">v</span>(t))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> v &lt; <span class="built_in">v</span>(t) ? <span class="built_in">rk</span>(<span class="built_in">l</span>(t), v) : <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="number">1</span> + <span class="built_in">rk</span>(<span class="built_in">r</span>(t), v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sbt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Date</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> cnt, v;</span><br><span class="line">    &#125; ;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">NodeForLineTree</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> l, r;</span><br><span class="line">        Date dat;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> ll(x) node_for_line_tree[(x)].l</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> rr(x) node_for_line_tree[(x)].r</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> ct(x) node_for_line_tree[(x)].dat.cnt</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> vv(x) node_for_line_tree[(x)].dat.v</span></span><br><span class="line">    &#125; node_for_line_tree[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> Mid (ll(u) + rr(u) &gt;&gt; 1)</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">merge</span><span class="params">(Date x, Date y, Date &amp;z)</span> <span class="comment">//合并x和y,储存在z</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x.v == y.v)</span><br><span class="line">            z.v = x.v, z.cnt = x.cnt + y.cnt;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x.cnt &gt;= y.cnt)</span><br><span class="line">            z.v = x.v, z.cnt = x.cnt - y.cnt;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            z.v = y.v, z.cnt = y.cnt - x.cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">merge</span>(node_for_line_tree[lc].dat, node_for_line_tree[rc].dat, node_for_line_tree[u].dat);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">ll</span>(u) = l, <span class="built_in">rr</span>(u) = r;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ct</span>(u) = <span class="number">1</span>, <span class="built_in">vv</span>(u) = x[l];</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="built_in">build</span>(lc, l, mid, x), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r, x);</span><br><span class="line">        <span class="built_in">up</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> pos, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ll</span>(u) == <span class="built_in">rr</span>(u))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ct</span>(u) = <span class="number">1</span>, <span class="built_in">vv</span>(u) = d;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="keyword">if</span> (pos &lt;= mid)</span><br><span class="line">            <span class="built_in">change</span>(lc, pos, d);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">change</span>(rc, pos, d);</span><br><span class="line">        <span class="built_in">up</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL Date <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ll</span>(u) &gt;= l &amp;&amp; <span class="built_in">rr</span>(u) &lt;= r)</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="built_in">ct</span>(u), <span class="built_in">vv</span>(u)&#125;;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        Date res = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">            <span class="built_in">merge</span>(<span class="built_in">ask</span>(lc, l, r), res, res);</span><br><span class="line">        <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">            <span class="built_in">merge</span>(<span class="built_in">ask</span>(rc, l, r), res, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; lt;</span><br><span class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = sbt[x].<span class="built_in">rk</span>(sbt[x].rt, r) - sbt[x].<span class="built_in">rk</span>(sbt[x].rt, l - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> (t &lt;&lt; <span class="number">1</span>) &gt; (r - l + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    STC <span class="keyword">int</span> a[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        sbt[a[i]].<span class="built_in">ins</span>(sbt[a[i]].rt, i);</span><br><span class="line">    &#125;</span><br><span class="line">    lt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, a);</span><br><span class="line">    <span class="keyword">int</span> l, r, s, k, win, t;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;s, &amp;k);</span><br><span class="line">        win = lt.<span class="built_in">ask</span>(<span class="number">1</span>, l, r).v;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">check</span>(win, l, r))</span><br><span class="line">            win = s;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, win);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">            lt.<span class="built_in">change</span>(<span class="number">1</span>, t, win);</span><br><span class="line">            sbt[a[t]].<span class="built_in">del</span>(sbt[a[t]].rt, t);</span><br><span class="line">            sbt[win].<span class="built_in">ins</span>(sbt[win].rt, t);</span><br><span class="line">            a[t] = win;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    win = lt.<span class="built_in">ask</span>(<span class="number">1</span>, <span class="number">1</span>, n).v;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">check</span>(win, l, r))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, win);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 心血来潮想写SBT了&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="SBT" scheme="https://dyd-true.github.io/tags/SBT/"/>
    
    <category term="平衡树" scheme="https://dyd-true.github.io/tags/%E5%B9%B3%E8%A1%A1%E6%A0%91/"/>
    
    <category term="数据结构" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="线段树" scheme="https://dyd-true.github.io/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>CF1221C Perfect Team</title>
    <link href="https://dyd-true.github.io/2022/01/03/CF1221C-Perfect-Team/"/>
    <id>https://dyd-true.github.io/2022/01/03/CF1221C-Perfect-Team/</id>
    <published>2022-01-03T00:11:22.000Z</published>
    <updated>2022-01-03T00:21:28.291Z</updated>
    
    <content type="html"><![CDATA[<p> 简单的二分</p><span id="more"></span><p>尝试了一下CF难度 $1200$ ，一道简单的二分（感觉一直在A水题）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, c, m, x;</span><br><span class="line">    <span class="keyword">int</span> l, r, mid, ans;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;c, &amp;m, &amp;x);</span><br><span class="line">        l = ans = <span class="number">0</span>, r = <span class="built_in">min</span>(c, m);</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">        &#123;</span><br><span class="line">            mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> ((c + m + x - mid) &gt;= (mid &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                ans = mid;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 简单的二分&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="贪心" scheme="https://dyd-true.github.io/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="二分" scheme="https://dyd-true.github.io/tags/%E4%BA%8C%E5%88%86/"/>
    
    <category term="CF" scheme="https://dyd-true.github.io/tags/CF/"/>
    
  </entry>
  
  <entry>
    <title>CF1455C Ping-pong</title>
    <link href="https://dyd-true.github.io/2022/01/03/CF1455C-Ping-pong/"/>
    <id>https://dyd-true.github.io/2022/01/03/CF1455C-Ping-pong/</id>
    <published>2022-01-02T23:47:58.000Z</published>
    <updated>2022-01-03T00:11:58.944Z</updated>
    
    <content type="html"><![CDATA[<p> 结论题？</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1455/C">Ping-pong</a></p><p> $1100$ ，不是很简单了，先考虑贪心吧</p><p>但是一个细节是体力少的一方可以不打，等对方体力耗完，可以这样理解：反正体力少这把必输，且打不打体力差都变小 $1$ ，不如不打保留实力</p><p>由上也可以得到一个策略：设双方体力为 $x, y$ ，若 $x &gt; y(y &gt; x)$ ，则体力大的一方赢 $x - y$ 次，双方体力都变成 $y$ </p><p>而当体力相同时，先开球的人必输，但他们是优先保证自己赢的多，所以先/后手都不会让体力被一把打尽，就会故意输（对于先手，这把输了双方体力相同，而对方变成下一把的先手；对于后手，这把输了自己体力更大，下把必胜），所以体力相同的时候两人一定是每个人都把自己的体力赢完</p><p>但第一局Alice必须开球，所以她的胜场会少 $1$ </p><p>另外，其实看样例找规律也能做吧？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, x - <span class="number">1</span>, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 结论题？&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="贪心" scheme="https://dyd-true.github.io/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="CF" scheme="https://dyd-true.github.io/tags/CF/"/>
    
  </entry>
  
  <entry>
    <title>CF1567B MEXor Mixup</title>
    <link href="https://dyd-true.github.io/2022/01/02/CF1567B-MEXor-Mixup/"/>
    <id>https://dyd-true.github.io/2022/01/02/CF1567B-MEXor-Mixup/</id>
    <published>2022-01-02T13:24:23.000Z</published>
    <updated>2022-01-02T23:49:59.660Z</updated>
    
    <content type="html"><![CDATA[<p> 再挑战一下 $1000$ </p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1567/B">MEXor Mixup</a></p><p>略有点水，放代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sum[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sum[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] ^ i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, a, b;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="keyword">if</span> (sum[a - <span class="number">1</span>] == b)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((sum[a - <span class="number">1</span>] ^ b) == a)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a + <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a + <span class="number">1</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 再挑战一下 $1000$ &lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="贪心" scheme="https://dyd-true.github.io/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="CF" scheme="https://dyd-true.github.io/tags/CF/"/>
    
  </entry>
  
  <entry>
    <title>CF4A Watermelon</title>
    <link href="https://dyd-true.github.io/2022/01/02/CF4A-Watermelon/"/>
    <id>https://dyd-true.github.io/2022/01/02/CF4A-Watermelon/</id>
    <published>2022-01-02T12:58:43.000Z</published>
    <updated>2022-01-02T23:49:25.291Z</updated>
    
    <content type="html"><![CDATA[<p> CF $800$ 的水题</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/4/A">Watermelon</a></p><p>蒻蒟发现自己刷了好久luogu了，偶尔想换换口味，于是看了道CF的题</p><p>毕竟（不通过luogu做CF）是第一次，所以做一道难度 $800$ 的try one try，在思考了整整 $1145141919810.1415926535…$ 秒后，终于做出来了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">    <span class="keyword">if</span> ((w &lt; <span class="number">4</span>) || (w &amp; <span class="number">1</span>))</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; CF $800$ 的水题&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="暴力" scheme="https://dyd-true.github.io/tags/%E6%9A%B4%E5%8A%9B/"/>
    
    <category term="CF" scheme="https://dyd-true.github.io/tags/CF/"/>
    
  </entry>
  
  <entry>
    <title>luoguP4466 [国家集训队]和与积</title>
    <link href="https://dyd-true.github.io/2022/01/02/luoguP4466-%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F-%E5%92%8C%E4%B8%8E%E7%A7%AF/"/>
    <id>https://dyd-true.github.io/2022/01/02/luoguP4466-%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F-%E5%92%8C%E4%B8%8E%E7%A7%AF/</id>
    <published>2022-01-02T10:29:41.000Z</published>
    <updated>2022-01-02T12:46:09.675Z</updated>
    
    <content type="html"><![CDATA[<p> 时间复杂度到底是多少……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4466">和与积</a></p><p>一眼望过去感觉像莫反，心里拔凉</p><p>但还是坚强的把25分的暴力打了，不出意外，刚刚好25分，于是，找规律</p><p>打了个表找规律，看见答案一块一块的贼像数论分块，心里更凉了，把100以内的数对打表出来，发现（<del>反正我看见的</del>） $gcd(a, b) \ne 1$ ，硬着头皮推</p><p>莫反<br>$$<br>\begin{aligned}<br>设 &amp; gcd(a, b) = r, c = \frac{a}{r}, d = \frac{b}{r}, k \in \mathbb{N_+} \\<br>&amp; a b = (a + b) k \\<br>&amp; r^2 c d = r (c + d) k \\<br>&amp; r c d = (c + d) k \\<br>\because &amp; gcd(c, d) = 1 \\<br>\therefore &amp; cd \mid k \\<br>设 &amp; k’ = \frac{k}{cd} \\<br>有 &amp; r = (c + d) k’<br>\end{aligned}<br>$$<br>乱推一波到这里不知道该干啥了，于是去看了看（<del>被我遗忘了很久的</del>）莫反，想到莫反的经典操作——将枚举约数改成枚举倍数</p><p>考虑求 $c, d, k’, (c &lt; d, gcd(c, d) = 1, k’ \in \mathbb{N_+})$ ，则可计计算出 $r = (c + d) k’, a = rc, b = rd$ ，又因为 $b \le n$ ，所以 $d (c + d) k’ \le n$ ，也就是说， $c, d$ 确定以后， $k’$ 的范围也确定了，可以直接计算有几对，时间复杂度为 $O(n^2)$ ——woc，暴力也是 $O(n^2)$ 啊！</p><p>再次推式子：<br>$$<br>\begin{aligned}<br>Ans<br>&amp; = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} [gcd(i, j) == 1] \lfloor \frac{N}{i (i + j)} \rfloor \\<br>&amp; = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} \sum_{k | gcd(i, j)} \mu(k) \lfloor \frac{N}{i (i + j)} \rfloor \\<br>&amp; 令 pk = i, qk = j, N’k = N, 有 : \\<br>Ans<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{N’}{p (p + q)} \rfloor \\<br>\end{aligned}<br>$$<br>到这一步动不了了，主要是 $p(p + q)$ 是个二次项没法整除分块，卡了1145141919810h，高素质的瞟了一眼题解：<br>$$<br>\begin{aligned}<br>Ans<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{N’}{p (p + q)} \rfloor \\<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{\lfloor \frac{N’}{p} \rfloor}{p + q} \rfloor \\<br>\end{aligned}<br>$$<br>于是当 $k, p$ 定了后，后面只关于 $q$ 可以整除分块（<del>我咋就想不到呢？</del>）</p><p>机房的巨佬在这一步就可以做了，但蒟蒻我还是不能理解（感觉三个 $\sum$ 时间不是更慢了吗），所以我又绕了一下</p><p>发现这里没有必要跑满每一个 $N$ ，中间有一步：<br>$$<br>Ans = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} \sum_{k | gcd(i, j)} \mu(k) \lfloor \frac{N}{i (i + j)} \rfloor \\<br>$$<br>这里当 $i \ge \sqrt{N}$ 时后面就为 $0$ ，所以直接令 $M = \sqrt{N}$ ，则<br>$$<br>Ans = \sum_{k = 1}^M \sum_{p = 1}^M’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{\lfloor \frac{M’}{p} \rfloor}{p + q} \rfloor \\<br>$$<br>枚举 $k$ 用 $N^{\frac{1}{2}}$  ，枚举 $p$ 用大概用个 $N^{\frac{1}{4}}$ ，数论分块大概用个 $\sqrt{N^{\frac{1}{4}}}$ ……？？？啊啊啊算不出来了</p><p>看了一下题解，大家也都各不相同，但好像是 $O(n^{\frac{3}{4}})$ ？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> mu[N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; prime;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> v[N];</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!v[i])</span><br><span class="line">            prime.<span class="built_in">push_back</span>(i), mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j : prime)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * j &gt; n)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            v[i * j] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % j)</span><br><span class="line">                mu[i * j] = -mu[i];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">work</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ed = p &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = p + <span class="number">1</span>, r; l &lt; ed; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x / l)</span><br><span class="line">            r = <span class="built_in">min</span>(x / (x / l), ed - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        res += (LL)(r - l + <span class="number">1</span>) * (x / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    m = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="built_in">prev</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mu[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * i &lt;= m; ++j)</span><br><span class="line">            ans += <span class="built_in">work</span>(j, n / (i * i * j)) * mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>感觉自己莫反好弱</p>]]></content>
    
    
    <summary type="html">&lt;p&gt; 时间复杂度到底是多少……&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="莫比乌斯反演" scheme="https://dyd-true.github.io/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>luoguP4022 [CTSC2012]熟悉的文章</title>
    <link href="https://dyd-true.github.io/2022/01/02/luoguP4022-CTSC2012-%E7%86%9F%E6%82%89%E7%9A%84%E6%96%87%E7%AB%A0/"/>
    <id>https://dyd-true.github.io/2022/01/02/luoguP4022-CTSC2012-%E7%86%9F%E6%82%89%E7%9A%84%E6%96%87%E7%AB%A0/</id>
    <published>2022-01-02T02:53:51.000Z</published>
    <updated>2022-01-02T07:20:53.781Z</updated>
    
    <content type="html"><![CDATA[<p> shit，不是水题了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4022">熟悉的文章</a></p><p>首先匹配的问题很好解决，SAM、SA维护文本串或者kmp处理模式串都可以</p><p>关键问题在于 $L_0$ ，首先考虑的是二分，因为答案很明显有单调性（如果长度 $L_0$ 可以，那么长度小于 $L_0$ 的也明显可以），但二分后如何判定是个问题</p><p>目测感觉和dp挂钩，有点像在kmp上dp，关键是假设已知长度为 $L_0$ ，如何得到划分方案，这边想考虑贪心</p><p>贪了一会贪不动，如果没有明显的贪心就考虑dp，设 <code>f[i]</code> 表示在已知长度为 $L_0$ 的情况下，以 $i$ 结尾的前缀串中“熟悉”的子串的长度总和，设以 $i$ 结尾的能匹配上的子串中最长的长度为 $len_i$ dp方程比较好推（就是状态不好设）：<br>$$<br>\begin{aligned}<br>f[i] = max<br>\begin{cases}<br>f[i - 1] (不让 i 成为一段) \\<br>f[j] + i - j, j \in [i - len_i, i - L_0] (让 i 匹配)<br>\end{cases}<br>\end{aligned}<br>$$<br>关于 $len_i$ ，可以对于每一个串预处理出来</p><p>明显可以单调队列维护，但由于数据范围是“输入文件的长度不超过 $1100000$ 字节”，所以我也不知道时间复杂度是多少</p><p>关于处理 $len_i$ ，我想的是先把文本串全都连起来（中间用 \$ 隔开），建一个SAM或者SA，然后对于每个询问直接暴力跑一遍，好像会挂</p><p>发现可以用类似AC自动机的想法，直接扫描匹配，就是建一个SAM，开始像Trie一样匹配，失配就用parent tree向上跳，大概应该也许可能是 $O(n)$ 的……吧？</p><p>还有一个实现的时候卡了的地方是单调队列维护时，区间长度是在变化的，解决办法是每次入队不是让 $i$ 入队，而是让 $i - L0$ 入队，这样可以保证队列中节点一定在区间内</p><p>结果SAM打挂了，调了好久才过样例，对这些东西还不是很熟悉啊</p><p>慢的一比的代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> SAM</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> len, fa;</span><br><span class="line">        <span class="keyword">int</span> ch[<span class="number">3</span>];</span><br><span class="line">    &#125; nd[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_v</span><span class="params">(<span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ch == <span class="string">&#x27;$&#x27;</span> ? <span class="number">2</span> : ch - <span class="string">&#x27;0&#x27;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="built_in">get_v</span>(ch);</span><br><span class="line">        <span class="keyword">int</span> p = last, np = last = ++tot;</span><br><span class="line">        <span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[x]; p = nd[p].fa)</span><br><span class="line">            nd[p].ch[x] = np;</span><br><span class="line">        <span class="keyword">if</span> (!p)</span><br><span class="line">            nd[np].fa = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> q = nd[p].ch[x];</span><br><span class="line">            <span class="keyword">if</span> (nd[q].len == nd[p].len + <span class="number">1</span>)</span><br><span class="line">                nd[np].fa = q;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> nq = ++tot;</span><br><span class="line">                nd[nq] = nd[q], nd[nq].len = nd[p].len + <span class="number">1</span>;</span><br><span class="line">                nd[q].fa = nd[np].fa = nq;</span><br><span class="line">                <span class="keyword">for</span> (; p &amp;&amp; nd[p].ch[x] == q; p = nd[p].fa)</span><br><span class="line">                    nd[p].ch[x] = nq;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">1</span>, now = <span class="number">0</span>, t, len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">get_v</span>(s[i]);</span><br><span class="line">            <span class="keyword">if</span> (nd[p].ch[t])</span><br><span class="line">                ++now, p = nd[p].ch[t];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[t]; p = nd[p].fa);</span><br><span class="line">                <span class="keyword">if</span> (!p)</span><br><span class="line">                    p = <span class="number">1</span>, now = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    now = nd[p].len + <span class="number">1</span>, p = nd[p].ch[t];</span><br><span class="line">            &#125;</span><br><span class="line">            x[i] = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> len[N];</span><br><span class="line"><span class="keyword">int</span> f[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> sl)</span> <span class="comment">//x就是L0</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; ++i)</span><br><span class="line">        f[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= sl; ++i)</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">//由于i-L0可以跟新i,所以要先入队</span></span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; f[q[r]] - q[r] &lt;= f[i - x] - (i - x))</span><br><span class="line">            --r;</span><br><span class="line">        q[++r] = i - x;</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; q[l] &lt; i - len[i])</span><br><span class="line">            ++l;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= r)</span><br><span class="line">            f[i] = <span class="built_in">max</span>(f[i], f[q[l]] + i - q[l]);    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[sl] * <span class="number">10</span> &gt;= sl * <span class="number">9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SAM::<span class="built_in">find</span>(s, len);</span><br><span class="line">    <span class="keyword">int</span> sl = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = sl, mid, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid, sl))</span><br><span class="line">        &#123;</span><br><span class="line">            res = mid;</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    STC <span class="keyword">char</span> s[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        t = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= t; ++j)</span><br><span class="line">            SAM::<span class="built_in">ins</span>(s[j]);</span><br><span class="line">        SAM::<span class="built_in">ins</span>(<span class="string">&#x27;$&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">work</span>(s));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; shit，不是水题了&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="字符串" scheme="https://dyd-true.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="dp" scheme="https://dyd-true.github.io/tags/dp/"/>
    
    <category term="单调队列" scheme="https://dyd-true.github.io/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
    <category term="二分" scheme="https://dyd-true.github.io/tags/%E4%BA%8C%E5%88%86/"/>
    
    <category term="后缀自动机,SAM" scheme="https://dyd-true.github.io/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA-SAM/"/>
    
  </entry>
  
  <entry>
    <title>luoguP3906 Geodetic集合</title>
    <link href="https://dyd-true.github.io/2022/01/02/luoguP3906-Geodetic%E9%9B%86%E5%90%88/"/>
    <id>https://dyd-true.github.io/2022/01/02/luoguP3906-Geodetic%E9%9B%86%E5%90%88/</id>
    <published>2022-01-02T02:18:15.000Z</published>
    <updated>2022-01-02T02:20:28.195Z</updated>
    
    <content type="html"><![CDATA[<p> 大水题</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3906">Geodetic集合</a></p><p>水题（主要是 $n$ 太小了），直接给代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, que;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Que</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Que &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> u == t.u ? u &lt; t.u : v &lt; t.v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; qq[N * N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans[N * N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="keyword">int</span> dis[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[(N * N) &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = (Edge)&#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> star)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        dis[i] = <span class="number">0</span>;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    dis[star] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(star);</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (!dis[y = e[i].ver])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> star)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(star);</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        vis[i] = <span class="literal">false</span>;</span><br><span class="line">    ans[id].<span class="built_in">push_back</span>(star);</span><br><span class="line">    vis[star] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (!vis[y = e[i].ver] &amp;&amp; dis[y] == dis[x] - <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans[id].<span class="built_in">push_back</span>(y);</span><br><span class="line">                vis[y] = <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b), <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;que);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;qq[i].u, &amp;qq[i].v);</span><br><span class="line">        qq[i].id = i;</span><br><span class="line">        <span class="keyword">if</span> (qq[i].u &gt; qq[i].v)</span><br><span class="line">            <span class="built_in">swap</span>(qq[i].u, qq[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(qq + <span class="number">1</span>, qq + <span class="number">1</span> + que);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, now = <span class="number">0</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (now != qq[i].u)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bfs</span>(qq[i].u);</span><br><span class="line">            now = qq[i].u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">work</span>(qq[i].id, qq[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sort</span>(<span class="built_in">all</span>(ans[i]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j : ans[i])</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, j);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 大水题&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="STL" scheme="https://dyd-true.github.io/tags/STL/"/>
    
    <category term="搜索" scheme="https://dyd-true.github.io/tags/%E6%90%9C%E7%B4%A2/"/>
    
    <category term="bfs" scheme="https://dyd-true.github.io/tags/bfs/"/>
    
  </entry>
  
  <entry>
    <title>奇妙的数学知识</title>
    <link href="https://dyd-true.github.io/2022/01/02/%E5%A5%87%E5%A6%99%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/"/>
    <id>https://dyd-true.github.io/2022/01/02/%E5%A5%87%E5%A6%99%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/</id>
    <published>2022-01-02T01:32:02.000Z</published>
    <updated>2022-01-02T01:43:33.444Z</updated>
    
    <content type="html"><![CDATA[<p> 奇奇怪怪</p><span id="more"></span><ul><li><p> $gcd(x, y, z) = gcd(x, y - x, z - y)$ ，这启发我们，对于已知数列 $\{a\}$ 及其差分数列 $\{b\}$ ， $gcd(a_i, a_{i+1}, …, a_j) = gcd(a_i, b_{i+1}, …, b_j)$ </p></li><li><p>$C_{a}^{b}=C_{a-1}^{b-1}+C_{a-1}^{b}$ ，这启发我们可以用递推求组合数</p></li><li><p>自然数次幂求和：<br>$$<br>\begin{aligned}<br>&amp; \sum_{i = 1}^{n} i = \frac{1}{2} n (n + 1) \\<br>&amp; \sum_{i = 1}^{n} i^2 = \frac{1}{6} n (n + 1) (2n + 1) \\<br>&amp; \sum_{i = 1}^{n} i^3 = \frac{1}{4} n^2 (n + 1)^2 \\<br>&amp; \sum_{i = 1}^{n} i^4 = \frac{1}{30} n (n + 1) (2n + 1) (3n^2 + 3n - 1) \\<br>&amp; \sum_{i = 1}^{n} i^5 = \frac{1}{12} n^2 (n + 1)^2 (2n^2 + 2n - 1) \\<br>&amp; \sum_{i = 1}^{n} i^6 = \frac{1}{42} n (n + 1) (2n + 1) (3n^4 + 6n^3 - 3n + 1) \\<br>\end{aligned}<br>$$</p><p>对于自然数 $k$ 次幂求和，明显其结果是一个关于 $n$ 的 $k + 1$ 次多项式，可以待定系数法求解</p></li><li></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt; 奇奇怪怪&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="其它" scheme="https://dyd-true.github.io/tags/%E5%85%B6%E5%AE%83/"/>
    
  </entry>
  
  <entry>
    <title>luoguP4927 [1007]梦美与线段树</title>
    <link href="https://dyd-true.github.io/2022/01/02/luoguP4927-1007-%E6%A2%A6%E7%BE%8E%E4%B8%8E%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    <id>https://dyd-true.github.io/2022/01/02/luoguP4927-1007-%E6%A2%A6%E7%BE%8E%E4%B8%8E%E7%BA%BF%E6%AE%B5%E6%A0%91/</id>
    <published>2022-01-02T00:36:02.000Z</published>
    <updated>2022-01-02T01:35:10.136Z</updated>
    
    <content type="html"><![CDATA[<p> 出题人我谢谢您</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4927">梦美与线段树</a></p><p>很快手玩了一下答案，设 $\{a_i\}$ 为序列， $\{v_i\}$ 为线段树节点的权值，答案就是 $Ans = \frac{\sum v_i^2}{\sum a_i}$ </p><p>下面的分母好解决，问题在上面的平方和</p><p>考虑线段树维护节点权值平方和（同时可以很自然的维护序列和），当区间加 $d$ 的时候，设该节点对应区间长度为 $len_i$ ，则 $v_i^2 \rightarrow (v_i + len_i * d)^2 = v_i^2 + v_i * len_i * 2d + len_i^2 * d$ ，发现节点的改变量和它的权值与长度都有关，考虑维护系数，即维护 $v_i * len_i$ 的和与 $len_i^2$ 和</p><p>具体地，设 $s2$ 表示节点权值示平方和， $sl2$ 表示节点长度平方和（它只用算一次，是不变的）， $sm$ 是 $v_i * len_i$ 的和有：<br>$$<br>\begin{aligned}<br>pushup : \\<br>&amp; v_i = v_{lc} + v_{rc} \\<br>&amp; s2_i = v_i^2 + s2_{lc} + s2_{rc} \\<br>&amp; sl2_i = len_i^2 + sl2_{lc} + sl2_{rc} \\<br>&amp; sm_i = len_i * v_i + sm_{lc} + sm_{rc} \\<br>pushdown : \\<br>&amp; s2_i = sl2_i * d^2 + 2d * sm_i + s2_i \\<br>&amp; v_i = len_i * d + v_i \\<br>&amp; sm_i = sl2_i * d + sm_i \\<br>\end{aligned}<br>$$<br>打好懒标记，调了一下，一交……WA90？！</p><p>一看，输出了个 $0$ 以为爆精度了，就 <code>#define int long long</code> 结果不变，一看讨论区，有人说这题要用高精（或者不要脸的 <code>__int128</code> ），我看了一遍，每一步都模了 $P = 998244353$ ，连 <code>long long</code> 会不会炸都怀疑，但还是改成 <code>__int128</code> 试了试，结果不变……</p><p>对 <code>__int128</code> 不是很熟悉，我以为自己用错了，还手打了快读快输，结果还是不变</p><p>忍无可忍看题解，发现问题在于题目说“令答案化成最简分数为 $\frac{p}{q}$ （保证 $q$ 不是 $998244353$ 的倍数”，也就是说答案可能是 $\frac{k * P}{r * P}$ 的形式，所以<strong>中间的过程中不能取模</strong>，只能开 <code>__int128</code> 硬存最后约分</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int __int128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="comment">//值,平方和,长度平方和,长度与值的积的和</span></span><br><span class="line">    <span class="keyword">int</span> v, s2, sl2, sm;</span><br><span class="line">    <span class="keyword">int</span> add;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) tr[(x)].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) tr[(x)].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) tr[(x)].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> s2(x) tr[(x)].s2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sl2(x) tr[(x)].sl2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sm(x) tr[(x)].sm</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ad(x) tr[(x)].add</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mid (tr[u].l + tr[u].r &gt;&gt; 1)</span></span><br><span class="line">&#125; tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        x = x * <span class="number">10</span> + ch - <span class="number">48</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span> (t)</span><br><span class="line">        x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % P;</span><br><span class="line">        x = x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_init</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">v</span>(u) = (<span class="built_in">v</span>(lc) + <span class="built_in">v</span>(rc));</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">v</span>(u) * <span class="built_in">v</span>(u) + <span class="built_in">s2</span>(lc) + <span class="built_in">s2</span>(rc));</span><br><span class="line">    <span class="built_in">sl2</span>(u) = (len * len + <span class="built_in">sl2</span>(lc) + <span class="built_in">sl2</span>(rc));</span><br><span class="line">    <span class="built_in">sm</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * <span class="built_in">v</span>(u)+ <span class="built_in">sm</span>(lc) + <span class="built_in">sm</span>(rc));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">v</span>(u) = (<span class="built_in">v</span>(lc) + <span class="built_in">v</span>(rc));</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">v</span>(u) * <span class="built_in">v</span>(u) + <span class="built_in">s2</span>(lc) + <span class="built_in">s2</span>(rc));</span><br><span class="line">    <span class="built_in">sm</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * <span class="built_in">v</span>(u) + <span class="built_in">sm</span>(lc) + <span class="built_in">sm</span>(rc));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_tag</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">sl2</span>(u) * d * d +d * <span class="number">2</span> * <span class="built_in">sm</span>(u) + <span class="built_in">s2</span>(u));</span><br><span class="line">    <span class="built_in">v</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * d + <span class="built_in">v</span>(u));</span><br><span class="line">    <span class="built_in">sm</span>(u) = (<span class="built_in">sl2</span>(u) * d + <span class="built_in">sm</span>(u));</span><br><span class="line">    <span class="built_in">ad</span>(u) = (<span class="built_in">ad</span>(u) + d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">ad</span>(u))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">add_tag</span>(lc, <span class="built_in">ad</span>(u));</span><br><span class="line">        <span class="built_in">add_tag</span>(rc, <span class="built_in">ad</span>(u));</span><br><span class="line">        <span class="built_in">ad</span>(u) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">l</span>(u) = l, <span class="built_in">r</span>(u) = r;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">v</span>(u) = <span class="built_in">sm</span>(u) = a[l];</span><br><span class="line">        <span class="built_in">s2</span>(u) = a[l] * a[l];</span><br><span class="line">        <span class="built_in">sl2</span>(u) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = Mid;</span><br><span class="line">    <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">push_init</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">l</span>(u) &gt;= l &amp;&amp; <span class="built_in">r</span>(u) &lt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">add_tag</span>(u, d);</span><br><span class="line">    <span class="built_in">push_down</span>(u);</span><br><span class="line">    <span class="keyword">int</span> mid = Mid;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">        <span class="built_in">modify</span>(lc, l, r, d);</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">        <span class="built_in">modify</span>(rc, l, r, d);</span><br><span class="line">    <span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = __gcd(<span class="built_in">s2</span>(<span class="number">1</span>), <span class="built_in">v</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">int</span> A = <span class="built_in">s2</span>(<span class="number">1</span>) / t, B = <span class="built_in">v</span>(<span class="number">1</span>) / t;</span><br><span class="line">    <span class="keyword">return</span> A % P * <span class="built_in">qpow</span>(B, P - <span class="number">2</span>) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">int</span> op, l, r, v;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(op);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(v);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, l, r, v);   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">write</span>(<span class="built_in">ask</span>()), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 出题人我谢谢您&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="线段树" scheme="https://dyd-true.github.io/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
    <category term="STL" scheme="https://dyd-true.github.io/tags/STL/"/>
    
  </entry>
  
  <entry>
    <title>luoguP5389 [Cnoi2019]数学课</title>
    <link href="https://dyd-true.github.io/2022/01/01/luoguP5389-Cnoi2019-%E6%95%B0%E5%AD%A6%E8%AF%BE/"/>
    <id>https://dyd-true.github.io/2022/01/01/luoguP5389-Cnoi2019-%E6%95%B0%E5%AD%A6%E8%AF%BE/</id>
    <published>2022-01-01T03:08:53.000Z</published>
    <updated>2022-01-01T06:33:22.502Z</updated>
    
    <content type="html"><![CDATA[<p> 神仙数学，想复杂了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5389">数学课</a></p><p>最近感觉不在状态（可能是快期末考试了吧），所以随机跳了一题，肉眼可见的数学题</p><p>由于 $a, b$ 产生方式相同，所以 $P(a &gt; b) = P(a &lt; b)$ ，因此只需要计算 $P(a = b)$ 即可</p><p>考虑 $a = x_k$ 的概率：</p><p>设数列为 $\{x_i\}$ ，明显 $x_i = \frac{i (i + 1)}{2}$ ，选出  $x_i, (i \ge k)$ 的概率有 $P(x_i) = \frac{3 i (i + 1)}{n (n + 1)(n + 2)}$ ，再得 $a = x_k$ 的概率有：<br>$$<br>\begin{aligned}<br>P(a = x_k)<br>&amp; = \sum_{i \ge k} P(x_i) \times \frac{1}{x_i} \\<br>&amp; = \sum_{i \ge k} \frac{6}{n (n + 1)(n + 2)} \\<br>&amp; =\frac{6 (n - k + 1)}{n (n + 1)(n + 2)} \\<br>\end{aligned}<br>$$<br>所以：<br>$$<br>\begin{aligned}<br>P(a = b)<br>&amp; = \sum_{i = 1}^n i \times P(a = x_i)^2 \\<br>&amp; = \sum_{i = 1}^n i \times (\frac{6 (n - i + 1)}{n (n + 1) (n + 2)})^2 \\<br>&amp; = \frac{36}{(n (n + 1)(n + 2))^2} \sum_{i = 1}^n i(n - i + 1)^2 \\<br>&amp; = \frac{3}{n (n + 2)}<br>\end{aligned}<br>$$<br>注意数据范围 $n$ 要开 <code>long long</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> LL P = <span class="number">998244353</span>;</span><br><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL x, LL y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x %P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    n %= P;</span><br><span class="line">    <span class="keyword">if</span> (!n)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        LL a = ((LL)(n + <span class="number">2</span>) * n % P - <span class="number">3</span> + P) % P;</span><br><span class="line">        LL b = (LL)(n + <span class="number">2</span>) * n % P * <span class="number">2</span> % P;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, (LL)<span class="built_in">qpow</span>(b , P - <span class="number">2</span>) * a % P);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 神仙数学，想复杂了&lt;/p&gt;</summary>
    
    
    
    <category term="练习" scheme="https://dyd-true.github.io/categories/%E7%BB%83%E4%B9%A0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="luogu" scheme="https://dyd-true.github.io/tags/luogu/"/>
    
    <category term="练习" scheme="https://dyd-true.github.io/tags/%E7%BB%83%E4%B9%A0/"/>
    
    <category term="概率" scheme="https://dyd-true.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>多项式</title>
    <link href="https://dyd-true.github.io/2021/12/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    <id>https://dyd-true.github.io/2021/12/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F/</id>
    <published>2021-12-27T09:23:05.000Z</published>
    <updated>2022-01-01T01:55:27.091Z</updated>
    
    <content type="html"><![CDATA[<p> 多项式没家桶</p><span id="more"></span><h1 id="多项式"><a href="#多项式" class="headerlink" title="多项式"></a>多项式</h1><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><ul><li>NTT</li><li>FFT</li><li>一定的数学</li></ul><h2 id="多项式乘法"><a href="#多项式乘法" class="headerlink" title="多项式乘法"></a>多项式乘法</h2><p>NTT/FFT即可</p><p>毒瘤卡常之预处理原根（然鹅不开O2有可能反向优化，慎用）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> VIT vector<span class="meta-string">&lt;int&gt;</span>::iterator</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; g[N], _g[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>, gn, mid, i, _gn, t, <span class="keyword">_t</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        _gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        t = <span class="keyword">_t</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; mid; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            g[mid].<span class="built_in">push_back</span>(t);</span><br><span class="line">            _g[mid].<span class="built_in">push_back</span>(<span class="keyword">_t</span>);</span><br><span class="line">            t = (LL)t * gn % P;</span><br><span class="line">            <span class="keyword">_t</span> = (LL)<span class="keyword">_t</span> * _gn % P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, a, b;</span><br><span class="line">    VIT gn;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = (op == <span class="number">1</span> ? g[mid].<span class="built_in">begin</span>() : _g[mid].<span class="built_in">begin</span>());</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)gn[j] * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    a = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * a % P;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式求逆"><a href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4238">板子</a></p><p>对于给定 $F (x)$ ，求出 $G(x)$ 使得 $ G(x)F(x) \equiv 1 \pmod {x^n}$ ，其中 $A(x) \equiv 1 \pmod {x^n}$ 指 $A(x)$ 次数低于 $n$ 的项只有常数为1，其余都为0，即 $A(x) =  1 + 0x + 0x^2 + 0x^3 + … + 0x^{n - 1} + a_nx^n + a_{n + 1}x^{n + 1} + …$ </p><p>做法：</p><p>考虑倍增，变形：<br>$$<br>\begin{aligned}<br>设G_0(x)满足:\\<br>&amp; G_0(x)F(x) \equiv 1 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>故:\\<br>&amp; G(x) - G_0(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; (G(x) - G_0(x))^2 \equiv 0 \pmod {x^n}\\<br>&amp; G^2(x) - 2G(x)G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br>\because &amp; G(x)F(x) \equiv 1 \pmod {x^n}\\<br>\therefore &amp; G(x) - 2G_0(x) + G_0^2(x)F(x) \equiv 0 \pmod {x^n}\\<br> &amp; G(x) \equiv (2 - G_0(x)F(x))G_0(x) \pmod {x^n}<br>\end{aligned}<br>$$<br>注意特判常数项要有逆，然后倍增即可，时间 $O(n \log n)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="comment">//逆变换记得除</span></span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> len, <span class="keyword">int</span> x[], <span class="keyword">int</span> y[])</span> <span class="comment">//将x求逆,答案为y</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, x, y);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)t[i] * y[i] % P + P) % P * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    --n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyinv</span>(n + <span class="number">1</span>, a, b); <span class="comment">//是长度,要加1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式除法和取模"><a href="#多项式除法和取模" class="headerlink" title="多项式除法和取模"></a>多项式除法和取模</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4512">板子</a></p><p>对于给定 $F(x), G(x)$ ，其中 $deg(F) \ge deg(G)$ ，不妨设 $deg(F) = n, deg(G) = m$ ，求 $Q(x), R(x)$ 使得 $F(x) = Q(x)G(x) + R(x)$ ，且 $deg(Q) = n - m, deg(R) = m - 1$ ，其中 $R(x)$ 最高位可以为0</p><p>做法：</p><p>对于多项式 $A(x)$ ，记 $A_r(x) = x^{deg(A)}A(\frac{1}{x})$ （其实就是把 $A$ 的系数翻转）</p><p>变形：<br>$$<br>\begin{aligned}<br>&amp; F(\frac{1}{x}) = Q(\frac{1}{x}) G(\frac{1}{x}) + R(\frac{1}{x})\\<br>&amp; x^n F(\frac{1}{x}) = x^{n -m} Q(\frac{1}{x}) x^m G(\frac{1}{x}) + x^{n - m + 1} x^{m - 1} R(\frac{1}{x})\\<br>&amp; F_r(x) = Q_r(x) G_r(x) + x^{n - m + 1} R_r(x)\\<br>&amp; F_r(x) \equiv Q_r(x) G_r(x) \pmod {x^{n - m + 1}}\\<br>&amp; Q_r(x) \equiv F_r(x) G_r^{-1}(x) \pmod {x^{n - m + 1}}<br>\end{aligned}<br>$$<br>多项式求逆得 $G_r^{-1}(x)$ ，多项式乘法得 $Q_r(x)$ ，计算即可得 $Q(x), R(x)$ ，时间还是 $O(n \log n)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydiv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> n, <span class="keyword">int</span> y[], <span class="keyword">int</span> m, <span class="keyword">int</span> a[], <span class="keyword">int</span> b[])</span> <span class="comment">//x除以y,商a余b</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> ta[N], tb[N];</span><br><span class="line">    <span class="keyword">int</span> dt = n - m + <span class="number">1</span>, tot = <span class="number">1</span>, bit = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (n &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = tb[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//求逆</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        ta[i] = y[m - i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">polyinv</span>(dt, ta, tb); <span class="comment">//这里就不加1了</span></span><br><span class="line">    <span class="comment">//求乘积</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        ta[i] = x[n - i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = (LL)ta[i] * tb[i] %P;</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dt; ++i)</span><br><span class="line">        a[i] = ta[dt - i - <span class="number">1</span>];</span><br><span class="line">    <span class="comment">//求余式</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = tb[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dt; ++i)</span><br><span class="line">        ta[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        tb[i] = y[i];</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = (LL)ta[i] * tb[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; ++i)</span><br><span class="line">        b[i] = (x[i] - ta[i] + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], as1[N], as2[N];</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]), b[i] = (b[i] + P) % P;</span><br><span class="line">    <span class="built_in">polydiv</span>(a, n + <span class="number">1</span>, b, m + <span class="number">1</span>, as1, as2); <span class="comment">//多项式注意+1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, as1[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m - <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, as2[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式开根"><a href="#多项式开根" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5205">板子</a></p><p>给定 $F(x)$ ，求 $G(x)$ 满足 $G^2(x) \equiv F(x) \pmod {x^n}$ </p><p>做法：</p><p>当然可以多项式快速幂求 $F^{\frac{1}{2}}(x)$ </p><p>也可以考虑倍增，变形：<br>$$<br>\begin{aligned}<br>设G_0(x)满足:\\<br>&amp; G_0^2(x) \equiv F(x) \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>故:\\<br>&amp; G^2(x) - G_0^2(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; (G(x) + G_0(x)) (G(x) - G_0(x)) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; G(x) - G_0(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; G^2(x) - 2G(x)G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br>&amp; F(x) - 2G(x) G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br> &amp; G(x) \equiv \frac{G_0^2(x) + F(x)}{2G_0(x)} \pmod {x^n}<br>\end{aligned}<br>$$<br>边界条件是常数项必须是模 $P$ 的二次剩余，时间 $O(n \log n)$ </p><p>代码懒得打了，反正<strong>次幂也行</strong></p><h2 id="牛顿迭代"><a href="#牛顿迭代" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h2><p>牛顿是一种思考的方法，多项式的题很多都用倍增，但每一道题都手推式子太过痛苦，于是，我们可以（<del>更痛苦的</del>）推出式子</p><p>问题：</p><p>对于给定 $F(x)$ ，求 $G(x)$ ，使 $F(G(x)) \equiv 0 \pmod {x^n}$ </p><p>做法：</p><p>推式子（<del>啊啊啊我要疯了</del>）：</p><p>呃……突然发现<strong>康托展开</strong>我不会，推个寂寞，直接给结论：<br>$$<br>G(x) \equiv G_0(x) - \frac{F(G_0(x))}{F’(G_0(x))} \pmod {x^n}<br>$$</p><h2 id="多项式求导和积分"><a href="#多项式求导和积分" class="headerlink" title="多项式求导和积分"></a>多项式求导和积分</h2><p>来两个简单的，直接算就行了</p><p>求导：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">    res[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">res[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>积分：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//逆元可以预处理</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">    res[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">inv</span>(i) % P;</span><br><span class="line">res[<span class="number">0</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h2 id="多项式对数"><a href="#多项式对数" class="headerlink" title="多项式对数"></a>多项式对数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4725">板子</a></p><p>对于给定 $F(x)$ ，求出 $G(x)$ 使得 $G(x) \equiv \ln(F(x)) \pmod {x^n}$ </p><p>做法：</p><p>求导，有 $G’(x) \equiv \frac{F’(x)}{F(x)} \pmod {x^n}$ </p><p>多项式求导得 $F’(x)$ ，求逆得 $\frac{1}{F(x)}$ ，乘法得 $G’(x)$ ，积分出 $G(x)$ ，时间 $O(n \log n)$ ，注意要保证常数项 $f_0 = 1$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span> <span class="comment">//differentiate</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span> <span class="comment">//integral</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> n, a[N], b[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyln</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项指数"><a href="#多项指数" class="headerlink" title="多项指数"></a>多项指数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4726">板子</a></p><p>对于给定 $F(x)$ ，求 $G(x)$ 使得 $G(x) \equiv e^{F(x)} \pmod {x^n}$ </p><p>做法：</p><p>两边取对数得， $\ln(G(x)) \equiv F(x) \pmod {x^n}$ </p><p>由牛顿迭代：<br>$$<br>\begin{aligned}<br>G(x) \equiv G_0(x) - \frac{\ln(G_0(x)) - F(x)}{\frac{1}{G_0(x)}} \pmod {x^n}\\<br>G(x) \equiv (1 - \ln(G_0(x)) + F(x)) G_0(x) \pmod {x^n}\\<br>\end{aligned}<br>$$</p><p>时间 $O(n \log n)$ ，注意一定要有 $f_0 = 0$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> n, a[N], b[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式次幂"><a href="#多项式次幂" class="headerlink" title="多项式次幂"></a>多项式次幂</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5273">板子</a></p><p>对于给定 $F(x), k$ ，求 $G(x)$ 使得 $G(x) \equiv F^k(x) \pmod {x^n}$ </p><p>做法：</p><p>推式子：<br>$$<br>\begin{aligned}<br>&amp; G(x) \equiv F^k(x) \pmod {x^n}\\<br>&amp; \ln(G(x)) \equiv k \ln(F(x)) \pmod {x^n}\\<br>\end{aligned}<br>$$<br>对 $F(x)$ 取 $\ln$ ，乘 $k$ 以后 $\exp$ 即可</p><p>但是并不保证常数项为1，则求 $\exp$ 时边界不一定为1了，不能直接取对数，所以提公因式，设 $r$ 为 $F(x)$ 的第一个非0项次数，提取公因式 $a_rx^r$ 就可以保证最低位是1了</p><p>考虑提公因式对答案的影响：我们提了公因式后，最后答案的前 $k * r$ 项都为0，后面的项就是我们求出来的，最后一起乘一个 $a_r^m$ 即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    k1是模P后的次数</span></span><br><span class="line"><span class="comment">    k2是模P-1的,用欧拉定理求第r项系数的k次幂</span></span><br><span class="line"><span class="comment">    k3存真实的k的一部分,若r*k3 &gt;= n说明前n项全是0</span></span><br><span class="line"><span class="comment">    num记录r</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    STC <span class="keyword">char</span> k[K];</span><br><span class="line">    <span class="keyword">int</span> n, k1, k2, k3;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;n, k + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    k1 = k2 = k3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l = <span class="built_in">strlen</span>(k + <span class="number">1</span>); i &lt;= l; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        k1 = ((LL)k1 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % P;</span><br><span class="line">        k2 = ((LL)k2 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % (P - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> ((LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>) &lt;= P)</span><br><span class="line">            k3 = (LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polypow</span>(a, b, k1, k2, k3, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式开根2"><a href="#多项式开根2" class="headerlink" title="多项式开根2"></a>多项式开根2</h2><p>前置：Cipolla算法</p><p>如果 $y^2 \equiv x \pmod P$ ，则称 $x$ 为模 $P$ 的二次剩余（然鹅我们要求的是 $y$ ）</p><p>而对于不保证 $f_0 = 0$ 的开根，我们必须要求出 $f_0$ 做 $x$ 时的 $y$ </p><p>下面是一堆我听不懂的思路</p><p>可以找一个 $t$ ，使得 $t^2 - x$ 为非二次剩余，设 $w = t^2 - x$ ，则 $y = (t + \sqrt{w})^{\frac{P + 1}{2}}$ ，这里考虑把 $w$ 定义为负数中的 $i$ ，随机选 $t$ 尝试即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polysqrt</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式三角函数"><a href="#多项式三角函数" class="headerlink" title="多项式三角函数"></a>多项式三角函数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5264">板子？</a></p><p>对于给定 $F(x)$ ，求 $\sin F(x), \cos F(x), \tan F(x)$ </p><p>做法：<br>$$<br>\begin{aligned}<br>考虑欧拉公式： \\<br>&amp; e^{i \theta} = \cos \theta + i \sin \theta \\<br>故: \\<br>&amp; e^{i x} = \cos x + i \sin x \\<br>&amp; e^{i (-x)} = \cos (-x) + i \sin (-x) = \cos x - i \sin x \\<br>所以: \\<br>&amp; \cos x = \frac{e^{i x} + e^{-i x}}{2} \\<br>&amp; \sin x = \frac{e^{i x} - e^{-i x}}{2i} \\<br>待入f(x): \\<br>&amp; \cos F(x) = \frac{\exp(i F(x)) + \exp(-iF(x))}{2} \\<br>&amp; \sin F(x) = \frac{\exp(i F(x)) - \exp(-iF(x))}{2i} \\<br>又因为: \\<br>&amp; i^2 \equiv -1 \pmod P \\<br>所以: \\<br>&amp; i^2 \equiv P - 1 \pmod P<br>\end{aligned}<br>$$<br>做一遍二次剩余求出 $i$ ，照着计算即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> img = <span class="number">86583718</span>; <span class="comment">//直接计算出了二次剩余</span></span><br><span class="line"><span class="comment">//封装时记得清空数组，要重复使用</span></span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注意模数不为998244353是要重新算img</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] + b[i]) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] - b[i] + P) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(img &lt;&lt; <span class="number">1</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(b, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = a[i] * t[i] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n, op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    op ? <span class="built_in">polycos</span>(a, b, n) : <span class="built_in">polysin</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式反三角函数"><a href="#多项式反三角函数" class="headerlink" title="多项式反三角函数"></a>多项式反三角函数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5265">板子？</a></p><p>对于给定 $F(x)$ ，求 $\arcsin F(x), \arccos F(x), \arctan F(x)$ </p><p>做法：</p><p>直接积分得<br>$$<br>\begin{aligned}<br>&amp; \arcsin F(x) =\int \frac{F’(x)}{\sqrt{1 - F^2(x)}} dx \\<br>&amp; \arccos F(x) = - \int \frac{F’(x)}{\sqrt{1 - F^2(x)}} dx \\<br>&amp; \arctan F(x) = \int \frac{F’(x)}{1 + F^2(x)} dx \\<br>\end{aligned}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> img = <span class="number">86583718</span>; <span class="comment">//直接计算出了二次剩余</span></span><br><span class="line"><span class="comment">//封装时记得清空数组，要重复使用</span></span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polymul</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注意模数不为998244353是要重新算img</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] + b[i]) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] - b[i] + P) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(img &lt;&lt; <span class="number">1</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(b, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = a[i] * t[i] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyasin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = (<span class="number">1</span> - (LL)x[i] * x[i]% P + P) % P;</span><br><span class="line">    <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polysqrt</span>(b, c, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyinv</span>(c, b, len);</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyacos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">polyasin</span>(x, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = y[i] ? P - y[i] : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyatan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = (<span class="number">1</span> + (LL)x[i] * x[i]% P) % P;</span><br><span class="line">    <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(c, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * c[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n, op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    op ? <span class="built_in">polyatan</span>(a, b, n) : <span class="built_in">polyasin</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拉格朗日反演"><a href="#拉格朗日反演" class="headerlink" title="拉格朗日反演"></a>拉格朗日反演</h2><p>不造有啥用，给个式子吧：</p><p>若两个多项式 $F(x), G(x)$ 满足常数项为0且1次项不为0，且两者互为复合</p><p>逆，即 $G(F(x)) = x$ （或者 $F(G(x)) = x$ ，它们是等价的），则有：<br>$$<br>\begin{aligned}<br>[x^n] F(x)<br>&amp; = \frac{1}{n} [x^{-1}] \frac{1}{G^n(x)} \\<br>&amp; = \frac{1}{n} [x^{n - 1}] (\frac{x}{G(x)})^n<br>\end{aligned}<br>$$<br>简证：<br>$$<br>\begin{aligned}<br>\sum_{i = 0}^{n - 1} a_i G^i(x) &amp; = x \\<br>\sum_{i = 0}^{n - 1} a_i i G^{i - 1}(x) G’(x) &amp; = 1 \\<br>\sum_{i = 0}^{n - 1} a_i i G^{i - n - 1}(x) G’(x) &amp; = \frac{1}{G^n(x)} \\<br>[x^{-1}] \sum_{i = 0}^{n - 1} a_i i G^{i - n - 1}(x) G’(x) &amp; = [x^{-1}] \frac{1}{G^n(x)} \\<br>对于 i \ne n : \\<br>G^{i - n - 1}(x) G’(x) &amp; = \frac{1}{i - n} (G^{i - n}(x))’ \\<br>求导, x^{-1} 系数为 0, 所以只考虑 i = n : \\<br>[x^{-1}] G^{-1}(x) G’(x) &amp; = 1 \\<br>[x^n] F(x) &amp; = \frac{1}{n} [x^{-1}] \frac{1}{G^n(x)} \\<br>\end{aligned}<br>$$</p><h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>由于那么多东西烦的很，于是封装了</p><p>千万别打 <code>class</code> 和shit一样，我用的 <code>namespace</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mod, quadratic residue, original root</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Remember const int is faster than int</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">If you want to change, remember</span></span><br><span class="line"><span class="comment">I = min&#123;qpow(G, (P - 1) / 4), P - qpow(G, (P - 1) / 4)&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span>, I = <span class="number">86583718</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">This is a class for solving polynomial problems</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Its default data type is int32, However, when multiplication is</span></span><br><span class="line"><span class="comment">out of range, it will conversion is enforced</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Its default modulus is 998244353, but it can also be changed</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Note that when changing the modulus, remember to change the</span></span><br><span class="line"><span class="comment">original root at the same time, and the modulus should not be</span></span><br><span class="line"><span class="comment">too large, if the modulus exceeding int32 </span></span><br><span class="line"><span class="comment">may exceed int64 (that is, long long) when multiplying.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">And you should note that N is defined outside the class,</span></span><br><span class="line"><span class="comment">it represents the longest possible length of the polynomial,</span></span><br><span class="line"><span class="comment">generally 3 to 4 times the original length </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This is a class written by Dyd on December 30, 2021,</span></span><br><span class="line"><span class="comment">and hopes to help you</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//This is for fast exponentiation </span></span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">res = (LL)res * x % P;</span><br><span class="line">x = (LL)x * x % P;</span><br><span class="line">y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//This is Cipolla</span></span><br><span class="line">    <span class="keyword">namespace</span> Cipolla</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> w;</span><br><span class="line">        DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">        <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">int</span> x, y;</span><br><span class="line">            IL Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="function">IL Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">while</span> (y)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                    res = res * x;</span><br><span class="line">                x = x * x;</span><br><span class="line">                y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">int</span> t;</span><br><span class="line">            <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                t = <span class="built_in">u</span>(e);</span><br><span class="line">                w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//It records the flip subscript </span></span><br><span class="line">    <span class="keyword">int</span> r[N];</span><br><span class="line">    <span class="comment">//Fill x with y</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">fill</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i)</span><br><span class="line">            x[i] = y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">fill</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i)</span><br><span class="line">            x[i] = y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Ready bit and tot </span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ready</span><span class="params">(<span class="keyword">int</span> &amp;bit, <span class="keyword">int</span> &amp;tot, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tot = <span class="number">1</span>, bit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//preprocess the flip subscript</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">get_r</span><span class="params">(<span class="keyword">int</span> bit, <span class="keyword">int</span> tot)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//NTT, remember to preprocess the flip subscript </span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">                <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">        <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">        <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">                gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">            &#123;</span><br><span class="line">                g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">                &#123;</span><br><span class="line">                    a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                    x[i + j] = (a + b) % P;</span><br><span class="line">                    x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * gn % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial multiplication</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polymul</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * y[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="comment">//Remember to clear the number of bits that x does not need to 0 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial inversion</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(t, x, <span class="number">0</span>, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            y[i] = (<span class="number">2</span> - (LL)t[i] * y[i] % P + P) % P * y[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial Derivative</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">        y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial integral</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial natural logarithm</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit,tot);</span><br><span class="line">        <span class="built_in">fill</span>(a, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(a, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial natural index</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Polynomial power function</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    k1 is the real power(it could be modulo)</span></span><br><span class="line"><span class="comment">    k2 is for Euler&#x27;s theorem(it&#x27;s modulo by P - 1)</span></span><br><span class="line"><span class="comment">    k3 is to determine how many leading 0 there are</span></span><br><span class="line"><span class="comment">    we use them as the power is too large</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">            ++num;</span><br><span class="line">        <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">fill</span>(y, <span class="number">0</span>, <span class="number">0</span>, len);</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">        len -= num;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(x, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">        len += num;</span><br><span class="line">        x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">        num = num * k3;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">            y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, <span class="number">0</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    This is to get k1, k2, k3 for the k which is too large too be</span></span><br><span class="line"><span class="comment">    used in polypow</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ready_for_pow</span><span class="params">(<span class="keyword">char</span> *k, <span class="keyword">int</span> &amp;k1, <span class="keyword">int</span> &amp;k2, <span class="keyword">int</span> &amp;k3)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        k1 = k2 = k3 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l = <span class="built_in">strlen</span>(k + <span class="number">1</span>); i &lt;= l; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            k1 = ((LL)k1 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % P;</span><br><span class="line">            k2 = ((LL)k2 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % (P - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> ((LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>) &lt;= P)</span><br><span class="line">                k3 = (LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial rooting</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sq = Cipolla::<span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * inv % P;</span><br><span class="line">        <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)y[i] * sq % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Polynomial trigonometric function</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Note that if the modulus is not</span></span><br><span class="line"><span class="comment">    998244353 I should be recalculated</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            a[i] = (LL)x[i] * I % P;</span><br><span class="line">        <span class="built_in">polyexp</span>(a, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            b[i] = (b[i] - c[i] + P) % P;</span><br><span class="line">        <span class="keyword">int</span> inv = <span class="built_in">qpow</span>((I &lt;&lt; <span class="number">1</span>) % P, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)b[i] * inv % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            a[i] = (LL)x[i] * I % P;</span><br><span class="line">        <span class="built_in">polyexp</span>(a, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            b[i] = (b[i] + c[i]) % P;</span><br><span class="line">        <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)b[i] * inv % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">        <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = a[i] * c[i] % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial inverse trigonometric function</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyasin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            b[i] = (<span class="number">1</span> - (LL)x[i] * x[i]% P + P) % P;</span><br><span class="line">        <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polysqrt</span>(b, c, len);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">polyinv</span>(c, b, len);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyacos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">polyasin</span>(x, y, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = y[i] ? P - y[i] : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyatan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            b[i] = (<span class="number">1</span> + (LL)x[i] * x[i]% P) % P;</span><br><span class="line">        <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(c, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * c[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    works</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 多项式没家桶&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="快速傅里叶变换,FFT" scheme="https://dyd-true.github.io/tags/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2-FFT/"/>
    
    <category term="多项式" scheme="https://dyd-true.github.io/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    <category term="快速数论变换,NTT" scheme="https://dyd-true.github.io/tags/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2-NTT/"/>
    
  </entry>
  
  <entry>
    <title>快速数论变换</title>
    <link href="https://dyd-true.github.io/2021/12/26/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2/"/>
    <id>https://dyd-true.github.io/2021/12/26/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2/</id>
    <published>2021-12-26T06:40:03.000Z</published>
    <updated>2021-12-27T14:24:45.686Z</updated>
    
    <content type="html"><![CDATA[<p> 不给好质数的出题人都***</p><span id="more"></span><h1 id="快速数论变换"><a href="#快速数论变换" class="headerlink" title="快速数论变换"></a>快速数论变换</h1><p>众所周知，FFT有两个缺陷：虚数常数大、无法支持取模</p><p>而NTT就巧妙的把这两个缺陷（<del>转化成另外的缺陷</del>）解决了</p><p>思路大体和FFT一样，不同的是，NTT不用虚数的单位根了，而用的是数论中的<strong>原根</strong></p><h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><p>设 $a \in \mathbb{Z}, p \in \mathbb{N_+}$ ，且 $gcd(a, p) = 1$ ，设 $d$ 为使 $a^d \equiv 1 \pmod p$ 成立的最小正整数，则称 $d$ 为 $a$ 在模 $p$ 意义下的<strong>阶</strong>，若 $d = \varphi(p)$ ，则称 $a$ 为 $p$ 的一个<strong>原根</strong></p><p>可以证明，<strong>奇质数一定存在原根</strong></p><p>原根有一个关键性质：**若 $g$ 是 $p$ 的原根，则 $g^i \mod p(i \in [1, p - 1])$ 两两不同且取遍 $[1, p - 1]$**，则让我们可以取原根做点值表达式的点</p><p>下面用 $g_n$ 表示 $g^{\frac{p - 1}{n}}$ </p><p>而原根也和虚数一样满足折半引理、消去引理和求和引理，即（以下都在模 $p$ 意义下）：</p><ul><li>  $g_n^n = 1$ </li><li> $g_n^{k + \frac{n}{2}} = -g_n^k$ </li><li> $g_{dn}^{dk} = g_{n}^k$ </li><li> $(g_n^{k + \frac{n}{2}})^2 = g_n^{2k + n} = g_n^{2k}$ </li></ul><p>也就是说，在FFT中用到的虚数的性质原根都有，而且原根支持取模</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span> + <span class="number">5</span>, P = <span class="number">998244353</span>; <span class="comment">//注意N要大于二倍n</span></span><br><span class="line"><span class="keyword">int</span> r[N], bit, tot;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        这里可以预处理3和inv的次幂卡常</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len); <span class="comment">//3是998244353的原根</span></span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>) <span class="comment">//负数的bool值是true!</span></span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P; <span class="comment">//一定要保证是正数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]), b[i] = (b[i] + P) % P;</span><br><span class="line">    bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt;= n + m)</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(a, <span class="number">1</span>), <span class="built_in">ntt</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (LL)a[i] * inv % P);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="关于质数"><a href="#关于质数" class="headerlink" title="关于质数"></a>关于质数</h2><p>模数必须是 $2^n + 1$ 的形式且 $n$ 要足够大常见的有998244353，1004535809，469762049它们的原根都是3</p><p>具体的，见表：</p><p>设 $P = k2^r + 1$ ，原根为 $g$ </p><table><thead><tr><th>P</th><th>r</th><th>k</th><th>g</th></tr></thead><tbody><tr><td>81788929</td><td>21</td><td>39</td><td>7</td></tr><tr><td>104857601</td><td>21</td><td>50</td><td>3</td></tr><tr><td>104857601</td><td>22</td><td>25</td><td>3</td></tr><tr><td>113246209</td><td>21</td><td>54</td><td>7</td></tr><tr><td>113246209</td><td>22</td><td>27</td><td>7</td></tr><tr><td>132120577</td><td>21</td><td>63</td><td>5</td></tr><tr><td>136314881</td><td>21</td><td>65</td><td>3</td></tr><tr><td>138412033</td><td>21</td><td>66</td><td>5</td></tr><tr><td>155189249</td><td>21</td><td>74</td><td>6</td></tr><tr><td>167772161</td><td>23</td><td>20</td><td>3</td></tr><tr><td>249561089</td><td>21</td><td>119</td><td>3</td></tr><tr><td>377487361</td><td>21</td><td>180</td><td>7</td></tr><tr><td>377487361</td><td>22</td><td>90</td><td>7</td></tr><tr><td>383778817</td><td>21</td><td>183</td><td>5</td></tr><tr><td>415236097</td><td>22</td><td>99</td><td>5</td></tr><tr><td>415236097</td><td>21</td><td>198</td><td>5</td></tr><tr><td>469762049</td><td>24</td><td>28</td><td>3</td></tr><tr><td>469762049</td><td>21</td><td>224</td><td>3</td></tr><tr><td>469762049</td><td>23</td><td>56</td><td>3</td></tr><tr><td>469762049</td><td>22</td><td>112</td><td>3</td></tr><tr><td>576716801</td><td>21</td><td>275</td><td>6</td></tr><tr><td>645922817</td><td>22</td><td>154</td><td>3</td></tr><tr><td>645922817</td><td>21</td><td>308</td><td>3</td></tr><tr><td>666894337</td><td>21</td><td>318</td><td>5</td></tr><tr><td>683671553</td><td>22</td><td>163</td><td>3</td></tr><tr><td>740294657</td><td>21</td><td>353</td><td>3</td></tr><tr><td>897581057</td><td>22</td><td>214</td><td>3</td></tr><tr><td>897581057</td><td>21</td><td>428</td><td>3</td></tr><tr><td>918552577</td><td>22</td><td>219</td><td>5</td></tr><tr><td>935329793</td><td>22</td><td>223</td><td>3</td></tr><tr><td>935329793</td><td>21</td><td>446</td><td>3</td></tr><tr><td>950009857</td><td>21</td><td>453</td><td>7</td></tr><tr><td>962592769</td><td>21</td><td>459</td><td>7</td></tr><tr><td>998244353</td><td>23</td><td>119</td><td>3</td></tr><tr><td>1004535809</td><td>21</td><td>479</td><td>3</td></tr><tr><td>1107296257</td><td>23</td><td>132</td><td>10</td></tr><tr><td>1107296257</td><td>24</td><td>66</td><td>10</td></tr><tr><td>1107296257</td><td>21</td><td>528</td><td>10</td></tr><tr><td>1138753537</td><td>21</td><td>543</td><td>5</td></tr><tr><td>1161822209</td><td>22</td><td>277</td><td>3</td></tr><tr><td>1161822209</td><td>21</td><td>554</td><td>3</td></tr><tr><td>1205862401</td><td>21</td><td>575</td><td>3</td></tr><tr><td>1212153857</td><td>22</td><td>289</td><td>3</td></tr><tr><td>1212153857</td><td>21</td><td>578</td><td>3</td></tr><tr><td>1214251009</td><td>21</td><td>579</td><td>7</td></tr><tr><td>1218445313</td><td>21</td><td>581</td><td>3</td></tr><tr><td>1224736769</td><td>22</td><td>292</td><td>3</td></tr><tr><td>1224736769</td><td>21</td><td>584</td><td>3</td></tr><tr><td>1281359873</td><td>21</td><td>611</td><td>3</td></tr><tr><td>1300234241</td><td>23</td><td>155</td><td>3</td></tr><tr><td>1300234241</td><td>21</td><td>620</td><td>3</td></tr><tr><td>1306525697</td><td>21</td><td>623</td><td>3</td></tr><tr><td>1327497217</td><td>21</td><td>633</td><td>5</td></tr><tr><td>1438646273</td><td>21</td><td>686</td><td>3</td></tr><tr><td>1484783617</td><td>21</td><td>708</td><td>5</td></tr><tr><td>1570766849</td><td>21</td><td>749</td><td>3</td></tr><tr><td>1709178881</td><td>21</td><td>815</td><td>3</td></tr><tr><td>1835008001</td><td>21</td><td>875</td><td>6</td></tr><tr><td>1866465281</td><td>22</td><td>445</td><td>3</td></tr><tr><td>1866465281</td><td>21</td><td>890</td><td>3</td></tr><tr><td>1893728257</td><td>21</td><td>903</td><td>5</td></tr><tr><td>1931476993</td><td>21</td><td>921</td><td>5</td></tr><tr><td>2088763393</td><td>22</td><td>498</td><td>5</td></tr><tr><td>2113929217</td><td>22</td><td>504</td><td>5</td></tr><tr><td>2113929217</td><td>25</td><td>63</td><td>5</td></tr><tr><td>2113929217</td><td>23</td><td>252</td><td>5</td></tr><tr><td>2130706433</td><td>22</td><td>508</td><td>3</td></tr><tr><td>2130706433</td><td>23</td><td>254</td><td>3</td></tr><tr><td>2281701377</td><td>27</td><td>17</td><td>3</td></tr><tr><td>2483027969</td><td>23</td><td>296</td><td>3</td></tr><tr><td>2483027969</td><td>25</td><td>74</td><td>3</td></tr><tr><td>2533359617</td><td>24</td><td>151</td><td>3</td></tr><tr><td>2533359617</td><td>23</td><td>302</td><td>3</td></tr><tr><td>2558525441</td><td>23</td><td>305</td><td>3</td></tr><tr><td>2671771649</td><td>22</td><td>637</td><td>3</td></tr><tr><td>2680160257</td><td>22</td><td>639</td><td>7</td></tr><tr><td>2717908993</td><td>22</td><td>648</td><td>5</td></tr><tr><td>2717908993</td><td>24</td><td>162</td><td>5</td></tr><tr><td>2722103297</td><td>22</td><td>649</td><td>3</td></tr><tr><td>2780823553</td><td>22</td><td>663</td><td>10</td></tr><tr><td>2885681153</td><td>24</td><td>172</td><td>3</td></tr><tr><td>2885681153</td><td>26</td><td>43</td><td>3</td></tr><tr><td>2910846977</td><td>22</td><td>694</td><td>3</td></tr><tr><td>2998927361</td><td>22</td><td>715</td><td>3</td></tr><tr><td>3112173569</td><td>22</td><td>742</td><td>2</td></tr><tr><td>3221225473</td><td>24</td><td>192</td><td>3</td></tr><tr><td>3221225473</td><td>25</td><td>96</td><td>3</td></tr><tr><td>3221225473</td><td>26</td><td>48</td><td>3</td></tr><tr><td>3238002689</td><td>22</td><td>772</td><td>2</td></tr><tr><td>3238002689</td><td>23</td><td>386</td><td>2</td></tr><tr><td>3313500161</td><td>22</td><td>790</td><td>2</td></tr><tr><td>3414163457</td><td>23</td><td>407</td><td>3</td></tr><tr><td>3435134977</td><td>22</td><td>819</td><td>2</td></tr><tr><td>3451912193</td><td>22</td><td>823</td><td>2</td></tr><tr><td>3489660929</td><td>23</td><td>416</td><td>2</td></tr><tr><td>3489660929</td><td>25</td><td>104</td><td>2</td></tr><tr><td>3489660929</td><td>22</td><td>832</td><td>2</td></tr><tr><td>3510632449</td><td>22</td><td>837</td><td>2</td></tr><tr><td>3577741313</td><td>22</td><td>853</td><td>2</td></tr><tr><td>3615490049</td><td>23</td><td>431</td><td>2</td></tr><tr><td>3615490049</td><td>22</td><td>862</td><td>2</td></tr><tr><td>3628072961</td><td>22</td><td>865</td><td>2</td></tr><tr><td>3665821697</td><td>23</td><td>437</td><td>2</td></tr><tr><td>3686793217</td><td>22</td><td>879</td><td>2</td></tr><tr><td>3749707777</td><td>23</td><td>447</td><td>2</td></tr><tr><td>3892314113</td><td>23</td><td>464</td><td>2</td></tr><tr><td>3892314113</td><td>25</td><td>116</td><td>2</td></tr><tr><td>3892314113</td><td>24</td><td>232</td><td>2</td></tr><tr><td>3892314113</td><td>22</td><td>928</td><td>2</td></tr><tr><td>3938451457</td><td>22</td><td>939</td><td>2</td></tr><tr><td>3942645761</td><td>23</td><td>470</td><td>2</td></tr><tr><td>3942645761</td><td>24</td><td>235</td><td>2</td></tr><tr><td>3942645761</td><td>22</td><td>940</td><td>2</td></tr><tr><td>4013948929</td><td>22</td><td>957</td><td>2</td></tr><tr><td>4194304001</td><td>24</td><td>250</td><td>2</td></tr><tr><td>4253024257</td><td>23</td><td>507</td><td>2</td></tr><tr><td>4630511617</td><td>26</td><td>69</td><td>2</td></tr><tr><td>4630511617</td><td>25</td><td>138</td><td>2</td></tr><tr><td>4882169857</td><td>24</td><td>291</td><td>2</td></tr><tr><td>4882169857</td><td>23</td><td>582</td><td>2</td></tr><tr><td>5158993921</td><td>23</td><td>615</td><td>2</td></tr><tr><td>5175771137</td><td>23</td><td>617</td><td>2</td></tr><tr><td>5251268609</td><td>23</td><td>626</td><td>2</td></tr><tr><td>5528092673</td><td>23</td><td>659</td><td>2</td></tr><tr><td>5536481281</td><td>24</td><td>330</td><td>2</td></tr><tr><td>5578424321</td><td>23</td><td>665</td><td>2</td></tr><tr><td>5788139521</td><td>24</td><td>345</td><td>2</td></tr><tr><td>5788139521</td><td>23</td><td>690</td><td>2</td></tr><tr><td>5838471169</td><td>25</td><td>174</td><td>2</td></tr><tr><td>5838471169</td><td>26</td><td>87</td><td>2</td></tr><tr><td>6014631937</td><td>23</td><td>717</td><td>2</td></tr><tr><td>6165626881</td><td>23</td><td>735</td><td>2</td></tr><tr><td>6333399041</td><td>23</td><td>755</td><td>2</td></tr><tr><td>6434062337</td><td>23</td><td>767</td><td>2</td></tr><tr><td>6534725633</td><td>23</td><td>779</td><td>2</td></tr><tr><td>6593445889</td><td>24</td><td>393</td><td>2</td></tr><tr><td>6660554753</td><td>23</td><td>794</td><td>2</td></tr><tr><td>6719275009</td><td>23</td><td>801</td><td>2</td></tr><tr><td>6811549697</td><td>25</td><td>203</td><td>2</td></tr><tr><td>6811549697</td><td>23</td><td>812</td><td>2</td></tr><tr><td>6996099073</td><td>23</td><td>834</td><td>2</td></tr><tr><td>6996099073</td><td>24</td><td>417</td><td>2</td></tr><tr><td>7096762369</td><td>24</td><td>423</td><td>2</td></tr><tr><td>7348420609</td><td>24</td><td>438</td><td>2</td></tr><tr><td>7348420609</td><td>25</td><td>219</td><td>2</td></tr><tr><td>7474249729</td><td>23</td><td>891</td><td>2</td></tr><tr><td>7566524417</td><td>23</td><td>902</td><td>2</td></tr><tr><td>7717519361</td><td>26</td><td>115</td><td>2</td></tr><tr><td>7717519361</td><td>25</td><td>230</td><td>2</td></tr><tr><td>7717519361</td><td>23</td><td>920</td><td>2</td></tr><tr><td>7818182657</td><td>23</td><td>932</td><td>2</td></tr><tr><td>7843348481</td><td>23</td><td>935</td><td>2</td></tr><tr><td>7918845953</td><td>27</td><td>59</td><td>2</td></tr><tr><td>8170504193</td><td>24</td><td>487</td><td>2</td></tr><tr><td>8220835841</td><td>25</td><td>245</td><td>2</td></tr><tr><td>8220835841</td><td>23</td><td>980</td><td>2</td></tr><tr><td>8279556097</td><td>23</td><td>987</td><td>2</td></tr><tr><td>8858370049</td><td>26</td><td>132</td><td>2</td></tr><tr><td>8858370049</td><td>27</td><td>66</td><td>2</td></tr><tr><td>9177137153</td><td>24</td><td>547</td><td>2</td></tr><tr><td>9227468801</td><td>25</td><td>275</td><td>2</td></tr><tr><td>9865003009</td><td>24</td><td>588</td><td>2</td></tr><tr><td>10267656193</td><td>24</td><td>612</td><td>2</td></tr><tr><td>10267656193</td><td>26</td><td>153</td><td>2</td></tr><tr><td>10267656193</td><td>25</td><td>306</td><td>2</td></tr><tr><td>10619977729</td><td>24</td><td>633</td><td>2</td></tr><tr><td>10871635969</td><td>26</td><td>162</td><td>2</td></tr><tr><td>10871635969</td><td>24</td><td>648</td><td>2</td></tr><tr><td>10871635969</td><td>25</td><td>324</td><td>2</td></tr><tr><td>11123294209</td><td>24</td><td>663</td><td>2</td></tr><tr><td>11173625857</td><td>25</td><td>333</td><td>2</td></tr><tr><td>11173625857</td><td>24</td><td>666</td><td>2</td></tr><tr><td>11341398017</td><td>26</td><td>169</td><td>2</td></tr><tr><td>11341398017</td><td>25</td><td>338</td><td>2</td></tr><tr><td>11693719553</td><td>24</td><td>697</td><td>2</td></tr><tr><td>12297699329</td><td>24</td><td>733</td><td>2</td></tr><tr><td>12348030977</td><td>27</td><td>92</td><td>2</td></tr><tr><td>12348030977</td><td>25</td><td>368</td><td>2</td></tr><tr><td>12348030977</td><td>26</td><td>184</td><td>2</td></tr><tr><td>13186891777</td><td>25</td><td>393</td><td>2</td></tr><tr><td>13757317121</td><td>26</td><td>205</td><td>2</td></tr><tr><td>13857980417</td><td>25</td><td>413</td><td>2</td></tr><tr><td>13857980417</td><td>24</td><td>826</td><td>2</td></tr><tr><td>14042529793</td><td>24</td><td>837</td><td>2</td></tr><tr><td>14092861441</td><td>26</td><td>210</td><td>2</td></tr><tr><td>14092861441</td><td>27</td><td>105</td><td>2</td></tr><tr><td>14092861441</td><td>24</td><td>840</td><td>2</td></tr><tr><td>15065939969</td><td>24</td><td>898</td><td>2</td></tr><tr><td>15065939969</td><td>25</td><td>449</td><td>2</td></tr><tr><td>15619588097</td><td>24</td><td>931</td><td>2</td></tr><tr><td>15653142529</td><td>24</td><td>933</td><td>2</td></tr><tr><td>15854469121</td><td>24</td><td>945</td><td>2</td></tr><tr><td>16475226113</td><td>24</td><td>982</td><td>2</td></tr><tr><td>16575889409</td><td>24</td><td>988</td><td>2</td></tr><tr><td>16626221057</td><td>24</td><td>991</td><td>2</td></tr><tr><td>17314086913</td><td>26</td><td>258</td><td>2</td></tr><tr><td>17314086913</td><td>25</td><td>516</td><td>2</td></tr><tr><td>17314086913</td><td>27</td><td>129</td><td>2</td></tr><tr><td>18387828737</td><td>26</td><td>274</td><td>2</td></tr><tr><td>19998441473</td><td>26</td><td>298</td><td>2</td></tr><tr><td>19998441473</td><td>25</td><td>596</td><td>2</td></tr><tr><td>20501757953</td><td>25</td><td>611</td><td>2</td></tr></tbody></table><h2 id="三模数NTT"><a href="#三模数NTT" class="headerlink" title="三模数NTT"></a>三模数NTT</h2><p>对于模数不符合要求的，可以用这三个质数分别NTT，用中国剩余定理合并（要求答案小于它们的积），一般来说可以应付系数不超过 $10^{23}$ 的情况</p><p>然鹅，拆系数FFT跑得比它快……</p>]]></content>
    
    
    <summary type="html">&lt;p&gt; 不给好质数的出题人都***&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="多项式" scheme="https://dyd-true.github.io/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    <category term="快速数论变换,NTT" scheme="https://dyd-true.github.io/tags/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2-NTT/"/>
    
  </entry>
  
  <entry>
    <title>文章密码</title>
    <link href="https://dyd-true.github.io/2021/12/24/%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81/"/>
    <id>https://dyd-true.github.io/2021/12/24/%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81/</id>
    <published>2021-12-24T13:51:32.000Z</published>
    <updated>2021-12-26T06:50:04.952Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b572895a584fab6d7a2a75073aa07caa0200c2b91ea314150080ed513312b269">fb7f687860606098f1ad1cb36041d4e3ac537c2c4647f3d67e3b11a8c7ee588e1c7ca94440e71812a71af5c098d2f09cb95d70bfa129432469064c7c37a746ac9e48dd7a73101584b7db912bb8fc955c587e056548a9972225090ed57b1ad9b2c39bac7b4465451af25420f3a38931f70ac021a27ff02591a413abdfedcdfd824e700fd50dc0f63c859e4956529889f2a9d94b605d7510b5f091e10a4400a6438a8e95def3b721e3651ca534691c334d1dcf733169f11e9e2d642644156dcce4d57f90ef0a44e88684f48e0a6172cdd4e2707fbc0b8563e15597d99e044f8f1fb27c941524582e91594e3275d0a8c5b82c37a7eaffaab23edf2379378a627f9cc72af3b96cdf1a541bdb79df12b5c4c8bc78dab851a8a19a07e90ca504c4c8ee43a50d9b182dde1ea29e58372b5cf510d7b3c2d5b38936934a34e1008cfa61f2ed9cfa7da4cf86b8f1523918ffe90e6e53ab2b86f25e23e3eedef8c7b8dba566cfe61fc678bacdc6d1949cdac7eb812a4b7ddc1f7396b73bca4963ec2ffb8b288a3d4c0a1eb71f8d4b3c92d33676059f05de3ecd5297a41123e7b254fc49f6ab0eda5f22fa36e4b992110387a422e8f23a8460651deec85efdf17b6a39d7742fd0186e91e59db1f789b109fbb61c6a17a883ce119498d8c89d6461c7f44126171b38e5465889e7c7916bdcfb7e00aa933ef8db9df4e971cfc9ec43c9e1bae758c725642d596b0b6b969f9f69c8e29330ec2bfaec28a0578130dc2516a089c7dcbbcd74e9313e5c184daf3322cf6592db3cff2cd61beacf318977b9b8ef0fc3a2a06f1eb46b9970856cdb1e10cd791bcc5fed520a185f740085d7544ddcdd933a90df89c9416a5c826aa9d4c509ca2fd10a2ad6f93a739ebceff8313350e12006b2523f161c28087f9a9b17e3f73da08d486288852f91d5f111a99d9205ee361ce9498963d24769b38f3d365a4c3de2e57d874e4db7fdcd21c7cfdef147ce2fd1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">防止我忘了</summary>
    
    
    
    <category term="others" scheme="https://dyd-true.github.io/categories/others/"/>
    
    
    <category term="其它" scheme="https://dyd-true.github.io/tags/%E5%85%B6%E5%AE%83/"/>
    
  </entry>
  
  <entry>
    <title>后缀自动机</title>
    <link href="https://dyd-true.github.io/2021/12/23/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    <id>https://dyd-true.github.io/2021/12/23/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/</id>
    <published>2021-12-23T10:53:28.000Z</published>
    <updated>2021-12-24T14:19:07.352Z</updated>
    
    <content type="html"><![CDATA[<p> 自动机/鸡/姬，到底那个好</p><span id="more"></span><h1 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>后缀自动机</strong>（SAM）是一个<strong>状态机</strong>，他有<strong>一个起点</strong>，<strong>若干终点</strong>，原串的所有本质不同子串和从SAM起点开始的所有路径<strong>一一对应，不重不漏</strong>，所以终点就是包含后缀的点</p><p>简单来说就是用一个边上有字符的DAG存储下了一个字符串的所有子串（当然Trie也可以做到，但是Trie的点数和边数都是 $O(n^2)$ 而SAM的点数和边数都是 $O(n)$ 的）</p><h2 id="一些性质"><a href="#一些性质" class="headerlink" title="一些性质"></a>一些性质</h2><p>再继续讨论SAM前，我们必须先知道一些东西</p><h3 id="endpos"><a href="#endpos" class="headerlink" title="endpos"></a>endpos</h3><p>定义函数 $endpos(S)$ 表示<strong>子串 $S$ 在原串中出现的位置的尾字母下标集合</strong>，如对于字符串“abcbabc”，有 $endpos(ab) = \{2, 6\}$ </p><p>endpos有以下结论（<strong>较常用</strong>）：</p><ol><li><p>对于两个子串 $s_1, s_2$ ，有：<br>$$<br>\begin{aligned}<br>&amp; s_1是s_2的后缀 \Leftrightarrow endpos(s_2) \subseteq endpos(s_1) \\<br>&amp; s_1不是是s_2的后缀 \Leftrightarrow endpos(s_2) \wedge endpos(s_1) = \phi \\<br>\end{aligned}<br>$$<br>正确性可以感性理解一下</p></li><li><p>两个不同子串的endpos，要么有包含关系，要么没有交集，可以理解为，它们要么有后缀关系，要么没有</p></li></ol><p>对于endpos相同的子串，我们将它们归为一个<strong>endpos等价类</strong>，对于任意一个endpos等价类，将包含在其中的所有子串依长度从大到小排序，则每一个子串的长度均为上一个子串的长度减1，且为上一个子串的后缀（简单来说，一个endpos等价类内的串的长度连续）</p><p>定义  $longest(st), shortest(st)$ ，表示endpos等价类 $st$ 中最长，最短的子串，由以上定义可知：对于 $longest(st)$ 的任意后缀 $s$ ，如果 $| shortest(st) | \le | s | \le | longsest(st) |$ ，则 $s \in st$  </p><p>而我们还有一个结论：</p><p><strong>endpos等价类个数的级别为 $O(n)$</strong> </p><p>对于一个类（endpos等价类） $st$ ，在 $longest(st)$ 前添加任意一个字符（满足新形成的字符串为原串子串），得到的字符串必然不属于此类，因此会得到若干个新的类，得到新形成的字符串的endpos必然为 $endpos(longest(st))$ 的子集，并且分别添加两个不同的字符，所得到的两个字符串的endpos必然完全不相交，所以对于此操作（添加一个字符），我们可以认为是对一个原集合进行分割，分割得到几个新的集合，且保留原集合，新的集合还可以继续分割，但是总的分割的次数不会超过原集合的大小，所以最终形成的集合个数也不会超过 $2n$ </p><h3 id="parent-tree"><a href="#parent-tree" class="headerlink" title="parent tree"></a>parent tree</h3><p>考虑上面类的划分过程，将一个串前面添加字符，得到新的类，这种关系可以构成一棵<strong>树</strong>，如对于串“aababa”（图中红色串为每个类的最长串）：</p><p><img src="https://s2.loli.net/2021/12/23/ycUCONS1Aa2fvVd.png" alt="pt"></p><p>于是，类之间就有了父子关系，我们称这棵树为<strong>parent tree</strong>，记类 $a$ 的父节点为 $fa(a)$ </p><p>也有个结论：<br>$$<br>|longest(fa(a))| + 1 = |shortest(a)|<br>$$<br>正确性很显然，从建树的步骤中就可以看出，在一个类中的最长子串前再添加一个字符，形成的字符串就必然属于其儿子中的一类，且这个新形成的字符串肯定是它所属的类中最短的一个，所以我们只需储存 $|longest(a)|$ </p><p>那么定义那么多有什么用呢？其实，<strong>SAM的节点就是parent tree中的节点</strong>，只不过二者的边不同，其中空串所属的节点（parent tree的根）就是后缀自动机的源点，而最大子串（整个原串）所属于的节点，以及其在parent tree上的祖先就是终点，如图即是一个SAM，蓝色为SAM的边，橘色为终点：</p><p><img src="https://s2.loli.net/2021/12/23/3iyroqBa6Fw1MId.png" alt="SAM"></p><p>根据定义，SAM的边应该满足：<strong>从源点出发到达点 $i$ 的任意一条路径形成的字符串均属于节点  $i$ 所代表的类</strong></p><p>二者边的主要区别为，延parent tree的边往下走是在字符串<strong>前面</strong>添加字符，延自动机的边往下走是在字符串<strong>后面</strong>添加字符，故parent tree主要用来求节点（即各个字符串）的性质，而后缀自动机本身则主要用来直接跑字符串</p><h3 id="数量级"><a href="#数量级" class="headerlink" title="数量级"></a>数量级</h3><p>前面证过，<strong>SAM的点数为 $O(n)$</strong></p><p>下面证明：<strong>SAM的边数为 $O(n)$</strong> </p><p>先取<strong>后缀自动机的任意一棵生成树</strong>（不是parent tree），这棵树一定与点数同级，即 $O(n)$ ，那么我们考虑向这棵生成树中加边</p><p>对于每个终止节点，我们按一定顺序跑遍属于它的子串（跑的时候逆着边的方向），如果能顺利跑回源点，则跑下一个子串；否则，说明我们需要加边，每次连上本应该跑回的边，沿它跑回下一个节点（这里若干次加边后得到一条回源点的路可能不是对于的当前串，但没关系，因为它一定对于终点的某一个子串，我们下次跑那个子串的时候就不必加边了，之后重跑我们原本希望跑的子串，直到真正顺利跑完这个子串）</p><p>这样，当跑完所有终止节点时，在原本的生成树上增加的边不会超过后缀的个数，即 $n$ 个，故总的边数是 $O(n)$ 级的</p><h2 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h2><p>那么如何构造SAM呢？</p><p>先看看构造好的长啥样（这个SAM比较特殊，只有一个终点）：</p><p><img src="https://s2.loli.net/2021/12/23/n1TRXCxIJgzH95q.jpg" alt="SAM2"></p><p>那整齐的一行节点表示的就是各个前缀所属的节点，显然，对于任意一个前缀，它在它所属的类中长度是最长的（不能再在其前面添加字符）</p><p>而相邻两个前缀所属点之间也肯定有连边，当然，不相邻的节点之间也会有一些边</p><p>上面那些零零散散的节点则是不包含任意一个前缀的节点</p><p>而蓝色的边就是SAM中正常的边，绿色的边是parent tree</p><p>SAM的构造是在线的，即我们通过不断添加单个字符的方式构建后缀自动机，时刻调整其状态</p><p>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="comment">//1为空节点</span></span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>; <span class="comment">//last:未加入此字符前最长的前缀所属的节点的编号</span></span><br><span class="line"><span class="comment">//这里的节点只维护了最长的串,因为所有长度小于它但同结尾的串一定被它的祖先维护了</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> len, fa; <span class="comment">//最长长度,父节点</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">26</span>]; <span class="comment">//类似于Trie</span></span><br><span class="line">&#125; nd[N &lt;&lt; <span class="number">1</span>]; <span class="comment">//开2倍</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = last, np = last = ++tot;</span><br><span class="line">nd[np].len = nd[p].len + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[x]; p = nd[p].fa) <span class="comment">//遍历所有长度小于它但同结尾的串,加字符</span></span><br><span class="line">nd[p].ch[x] = np;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">如果最后形成的新字符串没有旧串里出现过,</span></span><br><span class="line"><span class="comment">说明x实际上是一个在旧串中没有出现过的字符</span></span><br><span class="line"><span class="comment">因此不可能存在除节点1以外的祖先</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span> (!p)</span><br><span class="line">nd[np].fa = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> q = nd[p].ch[x];</span><br><span class="line"><span class="keyword">if</span> (nd[q].len == nd[p].len + <span class="number">1</span>) <span class="comment">//判断np是否为q的子节点</span></span><br><span class="line">nd[np].fa = q;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">//不是就说明q含了不该含的子串,直接新建节点为np的父节点</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> nq = ++tot;</span><br><span class="line">nd[nq] = nd[q], nd[nq].len = nd[p].len + <span class="number">1</span>; <span class="comment">//这里就相当于去掉不该含的串</span></span><br><span class="line">nd[q].fa = nd[np].fa = nq;</span><br><span class="line"><span class="keyword">for</span> (; p &amp;&amp; nd[p].ch[x] == q; p = nd[p].fa) <span class="comment">//同理跟新</span></span><br><span class="line">nd[p].ch[x] = nq;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; sam;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 自动机/鸡/姬，到底那个好&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="字符串" scheme="https://dyd-true.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    <category term="后缀自动机,SAM" scheme="https://dyd-true.github.io/tags/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA-SAM/"/>
    
  </entry>
  
  <entry>
    <title>行列式和基尔霍夫矩阵</title>
    <link href="https://dyd-true.github.io/2021/12/22/%E8%A1%8C%E5%88%97%E5%BC%8F%E5%92%8C%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/"/>
    <id>https://dyd-true.github.io/2021/12/22/%E8%A1%8C%E5%88%97%E5%BC%8F%E5%92%8C%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/</id>
    <published>2021-12-22T12:39:40.000Z</published>
    <updated>2021-12-24T14:18:36.049Z</updated>
    
    <content type="html"><![CDATA[<p>  神仙数学，一起递归式学的，就写在一起吧</p><span id="more"></span><h1 id="行列式和基尔霍夫矩阵"><a href="#行列式和基尔霍夫矩阵" class="headerlink" title="行列式和基尔霍夫矩阵"></a>行列式和基尔霍夫矩阵</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>给定一个无向图 $G(V, E)$ </p><ul><li><p>度数矩阵 $D$ ：当 $i \ne j$ 时，  $D[i][j] = 0$ ，否则  $D[i][j] = 点 i(j) 的度数$ </p></li><li><p>邻接矩阵 $A$ ：当 $(u, v) \in E$ 时， $A[u][v] = 1$ ，否则 $A[u][v] = 0$ </p></li><li><p><strong>基尔霍夫矩阵</strong>(Kirchhoff)  $K$ ，也称<strong>拉普拉斯算子</strong>：定义为 $K = D - A$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/VatPLREvlyDocXh.png" alt="K"></p></li><li><p><a href="https://baike.baidu.com/item/%E8%A1%8C%E5%88%97%E5%BC%8F/2010180"><strong>行列式</strong></a>：对于一个 $n \times n$ 的矩阵 $X$ ，其行列式定义为 $\det(X) = \mid X \mid = \sum_{p} (-1)^{\tau(p)} \prod_{i = 1}^n a_{i, p_i}$ ，其中 $p$ 取遍 $1 \sim n$ 的全排列， $\tau(p)$ 表示<strong>排列 $p$ 的逆序对个数</strong>，行列式可以理解为所有列向量所夹的几何体的有向体积，这样可以结合从几何直观出发理解为线性变换的伸缩因子（没有屁用）</p></li><li><p><strong>排列的奇偶性</strong>：定义排列 $p$ 的奇偶性为 $\tau(p)$ 的奇偶性</p></li><li><p><strong>对换</strong>：交换一个排列 $p$ 中的两个元素 $p_i, p_j (i \ne j)$ ，其它元素不变</p></li></ul><h2 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h2><p>我们来看如何快速求出行列式</p><h3 id="关于排列的奇偶性"><a href="#关于排列的奇偶性" class="headerlink" title="关于排列的奇偶性"></a>关于排列的奇偶性</h3><p>关于排列的奇偶性，有两个性质：</p><ol><li><strong>对于 $n(n \ge 2)$ 阶排列的所有排列情况，奇排列和偶排列各占一半</strong></li><li><strong>一个排列可以通过若干次对换变成一个元素严格递增的自然排列，对换次数的奇偶性与原排列的奇偶性相同</strong></li></ol><h3 id="关于行列式的性质"><a href="#关于行列式的性质" class="headerlink" title="关于行列式的性质"></a>关于行列式的性质</h3><ol><li><p>交换对应矩阵的2行（列），行列式取反</p></li><li><p>交换对应矩阵的1行和1列（进行一次<strong>矩阵转置</strong>），行列式不变</p></li><li><p>行列式的行（列）所有元素等比例变化，则行列式也等比例变化，如图：</p><p><img src="https://s2.loli.net/2021/12/22/Mj3HBxZNmVEyDhz.png" alt="行列k"></p></li><li><p>如果行列式对应矩阵 $A$ 中有一行（列），是对应2个矩阵 $B, C$ 中分别的2行（列）所有元素之和，且 $B, C$ 中其它元素都等于 $A$ 中对于元素，则有  $\mid A \mid = \mid B \mid + \mid C \mid$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/aGZFo8zKqbBiefm.png" alt="行列式1"></p></li><li><p>如果一个矩阵存在两行（列）成比例则 $\mid A \mid = 0$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/SFQXY2w85KWeJtZ.png" alt="行列式2"></p></li><li><p>把一个矩阵的一行（列）的值全部乘一个常数加到另一行（列）上，行列式值不变，如图：</p><p><img src="https://s2.loli.net/2021/12/22/W31fApMycDaFo5B.png" alt="行列式3"></p></li></ol><h3 id="关于代数余子式"><a href="#关于代数余子式" class="headerlink" title="关于代数余子式"></a>关于代数余子式</h3><p>由于<strong>代数余子式</strong>的定义过于复杂，所以在这里定义：</p><p>在一个 $n$ 阶行列式 $D$ 中选定 $k$ 行 $k$ 列可以组成一个 **$k$ 阶子行列式 $A$**，而删除在 $k$ 行 $k$ 列后剩下的 $n−k$ 阶行列式称为 $A$ 对应的 <strong>$n−k$ 阶余子式 $M$</strong></p><p>设 $A$ 在 $D$ 中的下标集合为 $\{ \mathbb{I}, \mathbb{J} \}$ ，其中 $\mathbb{I} = \{i_k\}$ ， $\mathbb{J} = \{j_k\}$ ，则定义 $(-1)^{(\sum \mathbb{I})(\sum \mathbb{J})} \times \mid M \mid$ 为 $n$ 阶行列式 $D$ 的 $k$ 阶子式 $A$ 的<strong>代数余子式</strong></p><p>对于单一元素 $a_{i,j}$ 我们令其代数余子式为 $A_{i,j}$ ，余子式为 $M_{i,j}$ ，有 $A_{i,j}=(-1)^{i+j}M_{i,j}$ </p><p>那么有如下性质：</p><ol><li><p>$n$ 阶行列式 $D$ 等于其任意一行（列）所有元素与其对应代数余子式的乘积之和，即<br>$$<br>\begin{aligned}<br>D = \sum_{j = 1}^n a_{i, j} \times A_{i, j}, (i \in [1, n]) \\<br>D = \sum_{i = 1}^n a_{i, j} \times A_{i, j}, (j \in [1, n]) \\<br>\end{aligned}<br>$$</p></li><li><p>$n$ 阶行列式 $D$ 的任意一行（列）余另不同的一行（列）对应元素的代数余子式之和为0<br> $$<br> \begin{aligned}<br> \sum_{k = 1}^n a_{i, k} \times A_{j, k} = 0, (i, j \in [1, n] \wedge i \ne j) \\<br> \sum_{k = 1}^n a_{k, i} \times A_{k, j} = 0, (i, j \in [1, n] \wedge i \ne j) \\<br> \end{aligned}<br> $$</p></li></ol><p>以上所有麻烦的要死的性质都不用证明，太好了！</p><h3 id="消元"><a href="#消元" class="headerlink" title="消元"></a>消元</h3><p>我们考虑一个情况，当一个矩阵任意一个位置出现0，看公式中的 $\prod_{i = 1}^n a_{i, p_i}$ ，发现只有有一个0，整个排列就没有贡献了，所以我们的思路就是利用上面（<del>讨厌至极的</del>）性质，让矩阵中出现0</p><p>我们现在考虑将矩阵一行（列）消成只有最后一个元素非0该怎么做，即实现图中变化：</p><p><img src="https://s2.loli.net/2021/12/22/xQysulI6frHmAdc.png" alt="非0"></p><p>利用行列式的性质6，对于1到第 $n−1$ 列中的第 $i$ 列，我们只需要让第 $i$ 列整列加上第 $n$ 列的 $\frac{a_{n,i}}{a_{n,n}}$ 倍就可以在 $\mid A \mid$ 不变的情况下使得整行前 $n−1$ 个元素被消掉</p><p>将最后一行消成只有 $a_{n, n}$ 非0后，由代数余子式的性质1可知 $D = a_{n, n} \times A_{n, n}$ ，其中 $A_{n, n}$ 就是红色矩阵：</p><p><img src="https://s2.loli.net/2021/12/22/lMVqvp7KU6jrifg.png" alt="A"></p><p>然后我们对于这个红色矩阵 $A_{n, n}$ 又消元，有 $A_{n, n} = a_{n - 1, n - 1} \times A_{n - 1, n - 1}$ </p><p>如此一直消元下去，得到的就是一个下三角行列式：</p><p><img src="https://s2.loli.net/2021/12/22/CK8jT1EdYtX9f2g.png" alt="三角"> </p><p>我们就会发现这样一个矩阵的行列式是其对角线所有元素的乘积，也就是 $\prod_{i = 1}^n a_{i, i}$ </p><h3 id="其它细节"><a href="#其它细节" class="headerlink" title="其它细节"></a>其它细节</h3><ul><li>每次取新的余子式的时候需要注意奇偶性，及时变化正负，因为记得代数余子式是要乘上一个 $(-1)^{(\sum \mathbb{I})(\sum \mathbb{J})}$ </li><li>如果题目要求 $\mod p$ 情况下的行列式，有些数是不一定有逆元的，或者说消元的时候精度出问题，我们可以考虑对两行（列）做辗转相减消元</li></ul><h3 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h3><p>消元是 $O(n^3)$ 的，辗转相除法是 $O(\log p)$ 的，因为辗转相除和消元每次必然使得数变小，势能只会减少，所以这个是均摊到 $O(n^2)$ 的（我也不懂为啥），总时间为 $O(n^2\log n + n^3) = O(n^3)$ </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P7112">【模板】行列式求值</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">600</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> P;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">det</span><span class="params">(<span class="keyword">int</span> x[][N])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>, w = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (x[i][i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//对第i行和第j行做辗转相减</span></span><br><span class="line"><span class="keyword">int</span> div = x[j][i] / x[i][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n; ++k)</span><br><span class="line">x[j][k] = (x[j][k] - (LL)div * x[i][k] % P + P) % P;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">res = (LL)x[i][i] * res % P;</span><br><span class="line">res *= w;</span><br><span class="line"><span class="keyword">return</span> (res + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> a[N][N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;P);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">det</span>(a));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基尔霍夫矩阵"><a href="#基尔霍夫矩阵" class="headerlink" title="基尔霍夫矩阵"></a>基尔霍夫矩阵</h2><p>基尔霍夫矩阵 $K$ 有如下性质：</p><ol><li>基尔霍夫矩阵的每一行或每一列上的元素和都是0</li><li>基尔霍夫矩阵的行列式的值为0</li><li>基尔霍夫矩阵的任意一个代数余子式值都相同</li><li>如果图 $G$ 不连通，基尔霍夫矩阵 $K$ 的任意主子式行列式值为0</li><li>如果图 $G$ 是一棵树，基尔霍夫矩阵 $K$ 的任意一个 $n − 1$ 阶主子式的行列式为1</li></ol><h2 id="Matrix-Tree-定理"><a href="#Matrix-Tree-定理" class="headerlink" title="Matrix-Tree 定理"></a>Matrix-Tree 定理</h2><p><strong>对于已经得出的基尔霍夫矩阵，去掉其第 $k$ 行和第 $k$ 列得出的矩阵的行列式，其绝对值为生成树的个数</strong>，该定理被称为<strong>Matrix-Tree定理（矩阵树定理）</strong></p><p>因此，对于给定的图 $G$ ，若要求其生成树个数，可以先求其基尔霍夫矩阵，然后随意取其任意一个 $n − 1$ 阶行列式，然后求出行列式的值，其绝对值就是这个图中<strong>生成树的个数</strong></p><p>以上的定理适用于<strong>无向无权图无自环</strong>的图，下面是一些拓展</p><h3 id="加权"><a href="#加权" class="headerlink" title="加权"></a>加权</h3><p>如果图中边有边权，可以把<strong>度数矩阵 $D$ 变成边的权值和</strong>，直接用Matrix-Tree 定理，求得的就是<strong>所有生成树边权乘积的总和</strong></p><h3 id="有向"><a href="#有向" class="headerlink" title="有向"></a>有向</h3><p>首先要把邻接矩阵 $A$ 变成有向图的邻接矩阵，然后对于 $D$ ，如果它记录的是<strong>到该点入的边权总和</strong>，那么求得的就是<strong>外向树</strong> (从根向外)，即 $D[i][j] = \sum_{j = 1}^n A[j][i]$ ；类似的，如果它记录的是<strong>到该点出的边权总和</strong>，那么求得的就是<strong>内向树</strong> (从外向根)</p><p>关于如何保证根，巨佬们说：去掉第 $k$ 行 $k$ 列就是以 $k$ 为根</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P6178">【模板】Matrix-Tree 定理</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">det</span><span class="params">(<span class="keyword">int</span> x[][N])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>, w = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">2</span>; i &lt;= n; ++i) <span class="comment">//以1为根,故删掉1行1列</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (x[i][i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> div = x[j][i] / x[i][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n; ++k)</span><br><span class="line">x[j][k] = (x[j][k] - (LL)div * x[i][k] % P + P) % P;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">res = (LL)x[i][i] * res % P;</span><br><span class="line">res *= w;</span><br><span class="line"><span class="keyword">return</span> (res + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line">STC <span class="keyword">int</span> k[N][N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;t);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="keyword">if</span> (t)</span><br><span class="line">&#123;</span><br><span class="line">k[u][v] = (k[u][v] - w + P) % P;</span><br><span class="line">k[v][v] = (k[v][v] + w) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">k[u][v] = (k[u][v] - w + P) % P;</span><br><span class="line">k[v][v] = (k[v][v] + w) % P;</span><br><span class="line">k[v][u] = (k[v][u] - w + P) % P;</span><br><span class="line">k[u][u] = (k[u][u] + w) % P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">det</span>(k));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;  神仙数学，一起递归式学的，就写在一起吧&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数论,数学" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E8%AE%BA-%E6%95%B0%E5%AD%A6/"/>
    
    <category term="图论" scheme="https://dyd-true.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
    <category term="基尔霍夫矩阵" scheme="https://dyd-true.github.io/tags/%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/"/>
    
    <category term="矩阵" scheme="https://dyd-true.github.io/tags/%E7%9F%A9%E9%98%B5/"/>
    
    <category term="行列式" scheme="https://dyd-true.github.io/tags/%E8%A1%8C%E5%88%97%E5%BC%8F/"/>
    
    <category term="Matrix-Tree定理" scheme="https://dyd-true.github.io/tags/Matrix-Tree%E5%AE%9A%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>test2021/12/21总结</title>
    <link href="https://dyd-true.github.io/2021/12/22/test2021-12-21%E6%80%BB%E7%BB%93/"/>
    <id>https://dyd-true.github.io/2021/12/22/test2021-12-21%E6%80%BB%E7%BB%93/</id>
    <published>2021-12-22T12:25:34.000Z</published>
    <updated>2021-12-26T06:49:17.035Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="87d7407f86e6de9e962175ddd0f634a1fa15e5b606050fd9b6f612ac84ff67a9">9f1ae9a104c95f1bdc52d8723feba369f3d3abf2d4fa95b59e8d6349f0aacdc5b05ef848d181645fe2e47264c6ef88d466cc300b50895b7c38d6045dc9a6ecd002009d42932ddf1d661cde659f512b0c2787d70865fb696cb5714d68347fa8d7fe68bae506d585ed6fd995b816f94190a341ff407035bef1c7918f9563c2b0d441a5201a1f55d29b22200889ae6a9b76426c8d2cc30613b2fe21b7ef1468a5e308f109e9e7eb9cfc6c3887286870abaa77e86029c196430d1b0df0e7a2350bc2145bb9035564a8fb3f63930b2638c8eaa3b09ef0f1c0d1fb165c2424be3881dfc2d27d467cef2415adde99d758fb7cf4faf54e896c4739533fcf2cb243780293840a1d3020be4964f424b51ee08acfcd1eed074623a422c6e942606d04366fe812d1d6e97c1080aeeebe5a4016b7f33a614c575bfb9550729de126b49241a4f9a51271159d13a8c904f5b233be147f59c6edef78d79f6f8e9145b77eab025233d1ff8c91576148ef608045ed2d1206ed410b1bb59073477214ff3f36834d0f9e0a9e056b51cc1a23671b78bb34d5b9f1800706c9073a9762f6c921cfcdd3d665cd90195154e10b89e624a73ef97e4f62208478823a2651efb67f876b2e0acc10315217f5f0380cf5bf432634db522dcdaa62bc9d49958544dbd9974be0ee5eb67b121a68b36991770b8045136c0234495b800a54376a452aff29cf0f31e2f99107121147d9c8e2a876d95898e15e92225d37bf19d31bc8bc0f40416736e62512e74009dde0c15f54e869a0cacc10e7232487d625424e543e9408b2cb889d843ea51d42c66c46dc632f3f878bfca6f3644e88ed284f98be9ef709e0f7c07eb35f2d8e04a901eaeeee9fb8c0220f34e9ca873a3636c76057935356ef9d232274966c066790470025c4d3f9ea9f11f992d2e6b95c6d8a79f99f8f8bbe59ebe3c97e1cfc143a04361593ad6846a506153096534e2d56605f547075f11e29056e18e799c38fc6788e1423f2b31fc4b18cc1426f30af715549f0a398558be653726b0777f4ecf78754c3d113f7a3d97e77198f8532aea0df03926e2fc517ebb30363b6aff307312d020d587a516a7ed3845982cd0c1a38c2705d789da03154aac5e41e8075ce3c8e15518af7a4ebd15347017b44458ebec92a4b32e7ec1f5c5f3cbed041b5c80bac397cf61cd1adeae83ecc1ccf5ea64687f257206eadd3c2ec267ae674fd555f763abf0e2af3662300a4e7d19389e89e1bc3efe106a2e8cfad888736fc1279c806ebe36ddc7340c2e3f60db92155cd7b79b87d835a6cc697d20b3d51288f905b760a691a8d89bd4d03c278d7ab02285fc9af7695d07236cdd7b9a8a21ada38e3458ec3036837b4c999c4eb9f600c88bcd3f5226abc4f63ebfe8b84edced56bb975f984c2906248ab5c0976e62c7b6548eb800abb8c0f1e34c51c34ab376df21ff46ba5a5e3876feb2e6fc29a448803890f1a49cd33b37607dbfce3c1d0dcbd0289fdd77e82a488448c92017680b802b7c08492d9e58a10ca0598ea032d8270751974ddd252b6dbd109057e0ae4998564affcdf60c9b644bd598a609ca220252c930b1545417bb5fd1b10cffc2977818aba62cebed2be9bc85ecb500e3ffcf027df4e418864a7b637c1de871b3b27d0ad5dae444033c152d2625d2ef324bd8dcf460b38bd3709fa960dfae0b138e5da372cf6e78bdf9429665782a8dd529f0274e5fa7163d148618444c72c25bcbddb182ebae38cf26f36ecbd320b1d7390f024d9b11dc8c70532365d4580e187320d6864bb99489f7d7a6e06beaf30a32290331b8ffb4fc7ca7af2d696b6f8c966bc11f55ff6c05969962d2bfcfa5bef82e8f1bec8b510186bd517dc59bb9c951599b3539f70b46d4312bf1be2ec40967df127df2fa90dc3a7e2d36b5286ddf12be616a6b8a3ffd575ce87536370f5264113c2487e33a30a09462c485e6170cfdc4be5c78d52bcea12ced30d4ef44969fa704c58b0be7b16513bc57122f524852eb4360489f720ead6a9a86209d83f3be79317dd58de1a8e871be1f23f9ae98a3ca9691c13bb11ac8bf6777a95eac14a68c42e60c4eb757604d3adea5ffc484569dc33b9d908c4b0aca1f25e1b95c77d3087af59ab6357709c79e4936fd356e5e453782495507644f9e9f2ef579af30edb030d759137ef30ed13feb266098ca74dd4667ae4efd0a8f73759ac485dd1fd393c64f36b3d66037c2ac991ef7883f416245460937640353ef9b1df4cd03bf3858c36f6f6a46e5a9c8c1bddeaa9304e58b2702ded14ca477c1047b188087be13ce5702d8f00b12ac2e8e16fabbfdfcf0a7cab4b0b10d01d5b842c9b48954fc8fabb28f1124648eb117b7a4890a0bc934aae1387d148ad5edf2633a1deaa48a6c56f07cd2e6e825a680b38d13ad824f0076433c44996a36c9554c6197585a6d425dcd34a0a0e9d29055c97700d9854ba123a288e0750ff473c7f7570dee690afa2ab1f7d6ee04d43888267743d0a2433d4c2180ca143dc886dfff67869139db6f36055964af35bea5743670529c27247ed0603931cce951a133954fcc69c4e6b04c6981788ad979afb7a0ae4286d7a0c026adcf5a6a746486aee9ab77daff5306e440d62832bcfb0716809ad85b61275d8111849a1be84c218cf6634fe3ca99b11dbaef5d1cfa72a5cf40de98099dbb6031d8ff5ebfe3337745c1b5578d2ecbb095244f35339054a70941abe93fe6735a7ea8764f4cfca6a11ff70165d1c2734470fe032b1b445162855ddf7e7273b59dfc5fedd97c3b812a654328f8eef175bb70a27765c6790aa128d08add755ae9ebe4904a99326a570cbb6df0a2bc34338b73844719e0aac3ae272938ef6e270e28c7ad195cecdcdcc7133b6e099d38e018626e1f9c36ee57dc247762a73b0c6dd0c7444b4e9c8de9772327172167c615228228c86a920ac3508b2ed2138453bcc6a2cb30036cf29ffc692d01f2179e0f05033e570d51470b723c1ba07e41d4c8877e859de565f4bfc9d3812086634f287c1c0151363ffe4b74c8327b33f1c46d7a1c7a63ed5e1e602267fe0ad80158e2170f7b1b43881b43d1b3d3aaa5d3f4c447458d7ced1c6edbb09289dc8b715c8588e264d3edced12b764bc6b40502a7c0d0d01cb30c7b569732f5cf155849d2ade6de041bc9a4922b7edc5114642ba827a81e37b2d3d93b09ac86efa933c1ebdff618a7b7448a4d59d6852c47954429647108308dc952cb18dca734910760d8628b7420e7bd17c87d4997814cee54315681dd92fa00b5632584765c1291af985f30d497805502471312300018dd14fdfe070405bac5c73fe15c0dab3bd6bc835f70471c2208404f8b20cb304e99d890c8b4d60980f37420abbc3451f3481f967473433f15962e16d1be3b3e5a96c24569042000ff3f85210645355212500809896fe153352687a0ff592adad63853f6a20d7053a2f385394842d126c42640f283bddadf43a4473b74b42d68ad74e26844bc8bb1eb36037aff683f15f4f1f559beb41eaca321c0df8f5c2cc4da9534c04170b570b3d77ab2eb7545126a208952b1eec78258476ab9d04e2b0588cf39c225f4e5cf2724fb0a6d41cd395b6e3bd802a1aa0bb62ef2e80f59349c9e61027ff474167cbc48ef13513225fd279b3d9d0f69d6bc87e238b5245c6d707741500fb6308a418f8bdc8978d94a3f16571d6f26aa315a08e19bdb28471f0c66a5254c59b0095f1097461a989ed3ebf5d81d99510cf0606c5e23a75cb090d9bfd8c69306c851ffe2e22bae9ebb4fbe1b82bc5b333d034a93f16608b244e65a406c7fa84ba2e7e99a42f05129f94717bfb6ed365f3a3b880818b1ed15923a588fe902d57961e58d72667087be1773c4026858cef0bc1749b12d27097fded53a8339d2a49705b178532158ca1409e316404289c994584982abb0a8fd49c60f3745bc612147aaef5981ae27fb050e522b17fbb2fa3d4bb114f9d0a55ae348b8330707162db60453419ed66211e8b22ce6802557bf5e155afb5ef8f073b021b4b07a9018eaa4d332fb0449b259cdd0fd3db6e9f056e4cc640ccd77add40e2d8dc650f6696a7754e8114aa00116b263a52f8abbe63dbebd104a9cb60c2d513a043b38583d5a217457cb84fc4fc41367d2462e7b3601697fc23834e31421d324ca3a20d4611c7303d49a87e8ef34dfcddf60c5f20279e19e31618424ffe0326244945fa229d601c2630583a96fbd36161276e7e1e0c284cf9b0d8d3c9add56791107d857738dfca49ef1554a7c1954f6c92b1472d1e4f7821ca49d253e7540c7ab718f8bcce78134c15bbd482c0c592bbce3a715c8786314fab8978e7e2a8fc72deb1cde21dce3a45d8135280fabddc300b41144608719856de0fd8820b887009dd7e64ea1979a6782efc6b5a047575b43de934d883b213ee9a6a8670f7a1ff67ed8552249480aaa42897eb69c057ac57200d85f15fcfa0a468f99a198e022a1bae2926191e031e43fc2a396660d657fededd2eb1be84b5d653dcd86130ca8b31cebfcbe660d1ea4f8932dde7f1660fb7cf5d0f59c8f3234a9d7fb8cea74bf52d1dae67931a538c368caf962edbe4dc647f9abbf56de9b6981cbd932534fe6a1698dc433f18f0dc2ca6e3cee2a51e5627a59e3e588ad0310eef5216ff65a2074341b563befb547873444da274f623ac33f9bfae27ab30085d215e2be5741f68837eb8f8ff128f54010d5bf9d67ca3e40ef3cdca8f7d7500f4edc48fa769cf968d648cb076d56ed18cf918a4b0ed633f66887b2daf0c7447d2d980a69fdf757d5d89cbc9f6cc9b8403236c3aa121eaa4d0b96f6ca2a39a4c3666f763feab509056a9f70f8b13e39408504d957c6c9094ed6ab2ec56cf67e773db26cb36aeebe74c28c2e8f1970573a3ad0ebe0162238337294373421f3df432ad146c3eab804490d206668cd172297f8846fe77fbdbafa17cbfb449005dd8a404598530d817d4788e54f20a3e345ad29f94ef0d5d386fa7bd5c34e41897b9c7c1a377f2ed6536f6e34a1d19b256d901ec09fce45c07b5f11bc8152bdda8427162ece110e014576159f0d5c4ed792dcbe3133b960b6e0e9d2a3490f8136a082033a812ca20673e9b290b8c6532f9138dce64646602aabe0927bed2a56433596c7583ddd7f3fa5525524db226c8e8a18cdef15c03f5d5216c8f4d3b707008a1998f0baa17ab8b8b8cb314d3d6674a022eb92c09c05fe7f4737cd676a676ccc37accdc689eaccea28411873e1081d1e02b3d37b799b54d6bb43e0bd00877766ed664585fe4d839421f4a868a01c7dd4d44ec328ff950ae5b0335ce42c9c59ce20798ef8041d01fd229115435a3a21e83ba90b0d959209b9890bd98f006c29204a21bc217a4eedcb12047ec175dadc98cdead3fe10b6a603aa84321ae2b6cf3144f0e7c6e6f134b492231e447e0282435c1a425f22124e1d88a1627f551eacbe280b3dd25a1f3b974e5ddca6500be8a1b47b3798d173a0698f4cf86f5e6e92857bdcc2e783b902fb29fa7e2985e3a8b47e254b6c3ef4be1614f2b1d0ffeaf73bbe63d7f11de0f16d2c50f0bdca8d0c53c0f964681325c3dc60c0ecd892d88e2449c1d92a55903441df51d0d7cd8747784f771dac573b50f6fb5ab1ca5401969a31a0c48f32aa4a34b624a45c263fd3c10858763d9b39fa1f5f06bd4c93911aaa6f9615d0cc3f880097a026e1ab9ed19585a1f359fbb36f89b78e2e2f0c04c68d7133ac92983e0291dde6a43091e71c6c8cdd3dfa44a921c0bab84d8f552c50de270f669871d25278e07f489e67fa9c41ac191de1f96712377605a7142c2f3956b5a636d1ebdcb40a902b3ddb5ffc0b2fb0dd37ae037af7c1dc102de3d2aa626ea9ac27e1422deb9efc033c7e67f18142d341deb34b77475ab6a911963d3dbb314f3e61b135453a3e294b489097ac1417e1ea5d390be99f11e732e69e847f281d6fd00e96dd896f7935f92a69de7ca3d927e8a4d8da3295877eb97d189d010a8bddd1897818e7e87a06832f46dd0a55b33903d3810d3fd02482e0f4ee21f24a369090791e1ccf1f8e0609f67bc82022c1d41c0a702259fd0338e77ded98464ad19da7b89a9f144a8a0cd0557b157f49032da39e6c2829f8369c8a3cf031c395f9f8654184237a32da4afa20a79c430e728d03cf38c06935c957913bfd08984a0e31bdb25867e3e4cd8f8f515d85472943b09a527312097cd7adb17b98abb31592f56a01c50258e6203e7e9960e1bc89e146137d24e89d336077fe5eaefb3dbce999988dbff5a35f2729aa23b65e82a7f7413538165288d6b0ff6f652beb2f82e6f38ab5b2a707ab3d1fdf4aecb1852a4bb8ca76ef42af005eddf06c0f3b9797a568b13b92c995145717481360348008ed3f9c3f372f3449928a176b2dd269f2558700d7ebbd06cbc2e684ac483723b93b7e5fd709eee94444c75022e04be46dd9a8f18dbc53d06d6ccf85250fef57f091366df83e2378e0ba04be76062ca51f0c8647c7734e86491ec16f1d02f246c0a0dbb85bcbca4c94394add05ee7db832119af497e98c4e8affa6e7f952a8a8e6f3dcfaaddaecce891e7534febf683a250e633c40d147e27bb5054eeba3fb66a06f58d92e7c010e042bc586ce59ef4e1b1a3c11f93f90d30dd506110aa243cf433d98505c711d6df6e676c3bbde40281135bbaf8415cfacbe7ce90810ac6c9ec2eee6cfe93ca2fb1c577205379fb01ef8d55b40c8ad0450bb2a2784b4b8458a4331a3e67bc37c41f53c968d5e18f946c1678d97f6bf2d92ba922a97ebb8183ebeeb56aaa7433ce863841a14babc427c35ddb30d72abc53f6308868e29cf404403f0d37c1a606b24acf67be3f575577cf74167c122f56d9f34aefc1dd5ac5f5dd7f7620a160086c60b6fb9ce48e8414ac0a214202de44c7d767e29a06afccd5391554a9e217156961e7c6937251982cdf5577c940ae1d7932f473b3893fb1244e15af102e9f136a52434ce5fc9d1c86144fc75844ab365d4d985970ab11eed725385d94e3d1097f1126e0cee5bcb85dcbba1dcb7828b17aa5bc2cb7049b294d660223dcc25b53e30b70778e647ed7eb2fd90efaf40db4f7f23f3be8da5e7d9e60620e1979e455949d99e2325b79ed91396b93b18160eef0870666321c8b2dbbe0cb2be2b9663dbc3e065899a0330bae0580202a0bf5406d9ad14ca7b663178cee0dfe6555c40c5aff00ff77d4d093c0d832e94f159fe4d38e3c3faa6e205175ed375fdc5edfc96933c72bd54a1ec4f057b0358416fb31b8a2b1a392cb9e82a5f4c4c82f82dabd92307ef747da21a65b913b97faa543aa19518aba30ed55b9c71df62fb5146077a1289a775f6abd7ee7b081a71aab37b2f7a9a4918cc026ddfaa38a436eb8c84b705c7ae6cba4cf5c54e04f7a6a7b213b3e45257e4a27798b39a57cd39c26bced2471f2c6d34f8eb3b71bb061877e7c033607ff57afb8570942ef4dc146781809d1edb34e464df3c59e06c27003095ba7edf812dd45a12743483aebf3967466dd6e7a607518a8b1f4e7850604015a5896fd9c22dfb95a9e6fa45c25f4d3892d3816745a3843be9009615f19b49b5e587661f447a5db807f320c64814bcce9317a81029362af31d816b8894c8fc9317ab1b35fb90271ea4793b01259fbed0e29f174a38288163d20bd59d7c927c0b0e81acd7c9a3b88f73666dda50cf320c2a7201f158754c51de59cb218e6e187840b4952f77681283fce6823ac4572c4cf37846a40b1e8cd8c675f66a3f428e1b4a5ebfd69c232427196c6ca21bc42d9645fef4ac8b6de8769d2dce6157aecc9c7b9bf7c3c04f97f478127892dd713fdf1fd19c2136101b769fa8a5595bb1ff0f6010afd52cb34417777bea80d4173b5060b3f766186f519406dc960113bd0b597ed545bc6c0c4891a4c20504c1c7dc6b8d078ec8b90302cd3785d24cc8d3cd39a6861363c11b85bb84e3bd4d83e0ca7f2daa4fcdd5e078854e1202cf62f70c51db4fa65ed3f0578775946ed7e992081a21ebff8f2adc64961f56436381650fc877a072f1ceb44d32b0cc524b857011e2df7f2065a39c4984020883b74f56a738cc9d4f7ccb0d13bb80abde30e40fd5e1f72001e16fa0da3f5c891c7e2dd391e89fe215c16e2caf8abe70af1a745a042d4b81cf51c59369a15237bfc3799fbbf2f3fd92ea04f4650b9c58e10322a22d5174075501d41c88e3494756d0cf44db72d78cf5abf3437228bef5f81ecf1d8b1739f1a4d97f7173ec18ce28508bee0d16cdfd81862389938b367acb8ca1a6da5249ecc51973d2cb9f92df3f956a6e7406161a8157a9835f13efe3f6b931d90447c525e67cdf0548f0a71e84b7610e175d9aa08c93f5940a149debcc42510e95b73f242c53ea086e3cb484b2465a8eb17a6cbaeb584409332383346c6b5e4ba22fe1eb70342f60779b492e7943ed7ebe8d8893d48e8a2367910730a4ed98ca49ada40d8de5d4c87f8f14b1b54983b5eb8e4ee7ccb6824bfdba022eb392ff52e3c36c98506c80f451d3607711a1ab6ce78ee15e614bec9e3f3fc121baee7ae63c2af99f3f17859f15b496e25ae094ed283ed97299e564ed8aed857348dfa1a8bcaef79016c5d26f4095e65ff319a12a73ff25422199c745c22d27d808a3436d5f0dc66f4359a6de7b3c9d4210f1821a9c52deb017c49a521723888cebd67aba050e30e9c5cfbb756685da68409fa12cc99ba849252cb578a973f128dd608b147ce0d20e4ca3d626ad3a0e3241de68d8b727bc48ab3711a8593367864befb3c6a5edb9d3a747403a5475fb809dfdc958dd3061d3a7936219737e136727f3de758274e6e6fdee962558cf77b572f6f9d5344df3746c1d54ea2ad9c2a1d71fe6c737954b5ce722aaad7111da135b83832f7886a0ba032836a0050937f7fe03ac14a6f73d416c29cbdad7359b3194d3d5b6bd8b014102a0b58b12e321ea17a66b5e6146099ced49e603858d3b52a7e1e4383388f3dfc4e0e10c52c2743f793a15e7170c4e5ddc0d3aa2be6be10bdd189c5d485227d1243ffabad65d486d05933ebbc92f9a1a0acd74b04d8d974d8face37ba91041c87878f5c28095638cf3d36e99ec56b56d880e666bee4555bc07010c3cc6b82a8e399c35f978e493d8a9aae60691f490c28b2e2456094834dd0f87e1d2a3902a190bb8d7518df2b363c455e0e605edc2cc135b829f29dd9c28d575e04a1edc1c89a711cc8a4023fcb48a086527191acc96baf4c09ce057f2553f5258339ec0e45b5713af0c98ebac828478065dd4c458b64de0db484659a5c8c5b3cd5ee35e26ca2b0459643bebc6a31a010dc25a257738a88c31d5dbaf8058537e05b7af4a717476c6cb42409115bdaa824869dcfab32f9b127860a86b13eedb2012adaa8906279332f8607b453c5c098feac3ccc597064b5c1754d64a39b0114eb4b1be33337c59f4d96417fdd473bf7562d1d1fad9faa16bc8cfd328f242606a2f65d3be9dbbe80b2085943afdcd82a267d8869c44ddb95bc5efba2bef96fb7dfe34a764c6404b884847958cb5ef1db9af8227616ad6e4f4592bbf4b40e296afd4d180f738df8da0138289cd4326b6c56754b40c805b635d60796dce718ed2e913508395b346eb719b4dcfb24c899ac8bc4f9aa28117de8274e59324c787e7e0381df7e8f746d68d954f00712bfd78d693b97fbafda570ee098611f16746ffee8067233a4bbbe10643d02c9868ef3528236c7378f047c9261e9017d4e54c963db4fac4ebc31652fb5d571108fc57c312277d2f87cbd711f8636d89f1afbe1bd49bcbbd2710da853b42ee125542182840bac9a58162d14a48fac5588140e7eae575154b0976fe9e6f255e97ef2c011e7a5e8e9900cca41f86002dc1056e9d31cd9f4d1c13d755c8a6a14e894f5fa9e5996eb158f8b3e59f85b11e3a55be052ee8914b2a6a6111b136cc1efe23d769b9df778bac1d2a5d6b76894952a5a9c5f099534e69d38248604fd6f42f48c5bb352137055f02a42cb098b9232ba041ebd2004605ba5881d0bac7f2bb15a37470087632abbc8c49236e331cfdde7399103185ad3f97e590ee71417e4052ac476389dde0c0ff56d4cea63e1349e9d56552ce975a78b34dbf1eff251f488de7635177ae22eae34bd796dcfe4e12b8cec075a7f3280f65ed03ba32a26a391336523ec1653bba952893e3c2bdbaa5db89e94380395dcf1c7da279a0db0786c3f2e08c43053850aae04948f0984580233c7954e527f6523db61655d162aea6ff6ca389b942ebf2f90e6e654f5a193bd64e1b885b6019f16f6e0e9af9fcc2d59df3525cb3cd9961d62ba38530d8e196c0019d9fed8fae403c747553094006d00a9ffa3f04462a66840767b51c4a943ecfacfe72ef846c864cdb1d4e6efea45a9f6cf2efac5a0a9ab0fc67b7033ad07b4b48807efa7b6a00af8f4c2cab2c5ec4341d4bcf9988a29c354e72d590419e999cd86349528ef1256fd68bedf21db9ad873f4c4e8aed6468d5e32808f0a31f93c53e59f80b10953be3f40b51cda65fa96c3e44bc1955cdc8d1514d932d6693b2c5c1d5e73bb4589cce8d0598fbd13b1d1d1a750215eeb7bf98cccc84cf307a6b079f12bd0002c9ebe7adc05d1d92576bfbe91cc04409a60757ce0c31321d764bb9455a9f24b580303f74c68122c73147e5ef02fb0e9f40647fcfaf165336b9970cbcfe003df41e86c71674f225cc7d6ab0476afe7d44b0fc39f922da254d6061900cc3ad8b3505094e7702201fd0301653d44ac91bb18972e733bfdde4277dfea3f8985b51eb41d5aa571ff9c628212a0084b2702263f6bbb135db28493395e6b7b433f75df2ec6fd329bf1c3eef58ace8da136932c2d467e7df4671194a2191e667b7f62a8ac7c42bf3f80ac5f644b01b389ad4ee8d740bc0886d6d640a988af626b97123436a64a810b829548900c700d668238b82392c4e8f16782d16b8e2c461b9cf0f6f4e6012e372e7475a7baad1eb018041fca5599f5b1f7a13ab78af623d27a65546875ac003ef79567b07a8e3e4124aaadd4bb576d0e4d94e00258c05fda8b82b46c69316fc7b149d4b8ec6a9c5d7ea465f80a0c1bc3778477441eef9815b2ceee3ace30c4cefc57492fdb32ae77088eb5c89d594fcd17d5878585bc7b7c77aeaacb9e80b1e67c38760d9a7f98097a87347ba2e288e3d6b8d40b38705fe6b0e9c2795627f9057bfcfa389fce7cee0e026dc881c10e188743b1854c2b2291514b9ecf4b92a0b5c79c9e5a4633edff8add1ca2c037525c52a6d26fa8237142ad72cf7ecec63e443bcb07584be9ea3fc1f110b8bff0bc6f191ce62b1270ced7c78dd84cc38556e00ce27bc85864031fe3f19573f41f8a21540e04a9ce44f0edaff12eb96618930e967930ddccbcddc379427a7354f9ac2b01b04af83541d83e32257b59092dc9c9f0bdb6c7dabea6de65573bf2b20e1fe480f5fa542940086bee7c2a490e4feeee19a6d8c7cd2c145439efdec81f9cbf978976479c3b3fe9e8297ad64e9620703f89ec52b69ffd0568df1b1ae5e55513d25cf9f063a47b15fc335ef2ab18a9ebe61310a95a0adc83269d06a7d727a0f87fd61a869bfbe57fbed3d56391885c3b0b83f0a339046dc9c42c4f1294ca71a69f7c1c9ef5f159bbeab80ddbc804e1febe93ea44ce7cdbf15c5b8ac382348f88a3567759d4587e10ec8c957bc35aa431863102e70dbc579635bdc7ccd9003a067947d46824cd032893d28f0eadb9e71949bd6975f795ab451d70533d5da7bfcc1ab1664ee03d7ab9ea55a4473b714b28ec56f4db0819edff1aaa0cbc3ba210daf61032f6945b1b60583d28f4aa583be09d0bd73b8d4bab3ba32f2baeb3efed737aa9bac6bdaf2c7d9038b175267d81022320fcca393caa2c9cf363856164bc4014de7010eba4529eef93e85b96861c3945a70e972834b295c5dbb59a6e133b312e2a4b04c713a9b46a141e99bf61406d55ffa4c4b254bd64b7b5bc0629c41454d6900de3d938c0f6ec5b93baae258ab5509f5d27df4d80ede97cb216799ac588b00c0a41849a3dfff100481e305e09917d88fcf325fb81ab44534395ae0b5eacaa913ba3a91614a0f1567f9c201f230327ba6353a491cfbfe0a7074b9473064830f2f100e370b8b9b3d935f80c7f975e187e838800eaec6e9eff8ab7b84db0d0230a52c0cf354e29d96cefd5103a0d8dee3d2e64b173456c629ebfbb9f6227e1ff4b464d02e998f308f49c68aa632c67dc0f5c9b6aba29d5248684a791733e2e4db7ad436ef0e12c9a0b17c3ec26cb7ef92a50a51728eb69a5855b48edb76bdf6cade77948bb4f8ffad33194e361535cf5225bc5ccd371bca56d3df0f80082598ef7074fe0d53ffeeaa265babd28e56f322732c9da650d917c21bf588a2b49ef648cd593956d20176e69b52c9e8b7ec1934eab98cbd50390a83a8a1e79fb66d17c2bddeb47bdf28486c5a9b406ac06604e39c83ad9482702af0589d6323419ff40d07cfad0950cb6309b6bd2ba861a284276654d7c62492ef165f65b89d59ef9c81fb7adad6af08c7d249b84001555b5db635a83674409ca2ac4d4b4dda6fce22342c5685c7f8aee6bd9cd5fa4c881c0d2a790d69b878acd70cf7a5584f054efce47fed3c2548cc1c1e45db805fe4cad5e7e2e0e3ee33b548ba79fa293feca72b7072f6d279a829f86f30e9a9818f2426134f593c55f4d52e797bae6adc328eef3a08d26d28e6d02ce2e1a16c049ab2b1608333cc42ca9a9d2dcbfe64a313a4fd943e078429d68673584c72b1a06a8812287f31033cb4b303bcd93989d61917772ab767ea1106afefbbe07944e1b5daf204b97e20329d84ea07ebcdd2f5530f0c6e55b2f692bfea093e1a22a2f55a209782559c2210e084e3f762d96ebe34575b4b79372e40af31e5081db1ba6a6d2cb951044f9a80b5e448a925e790015ed4f5da8e9a4c33877dcb9386a639b68789ad0a7484e54b0cb50b5e35c6ec7e3d09e6a2ab8c2ec5cb520820bdf4a4c142e1cf1c3bedd3155d536b450e24e0876bb76260856dda6363d09e0b719d4be40d7e20247eaf0a2f1e581581502efd0ae9403849796c73fa429a0193d8fbc5379b9f31d3c1c766a7d68bedaa927f577f76190dfb4facca1754f77a6c93fbacd5687f00320c477e4acbef7a255c2e0bc5def36f214107a570e2f85a4d86df33f31033fef1b2852e4e9aed044b4c721337d71ebca744251106041d3f9056d7e5b3742364177321de2e061d9a80cef0269cdd7c7c644481fc6c4456110364374a2143cb810a189bb8c01b4439b89bb6193f3ea8cfc8bcbcd24d8ea34ad1b45d646bbb7c95d1cae905fe90dc3b76481c8bed31b235436abb93fcf767a4c17bb91e14de7d6c461df3a600d37bc80e67733e34c03c87b427b688a287a1dfe9b1f7ab7de2b9494b01f764bfb5686e4fed51e548e4f778b9f6c4f67976b89b53678a28513a8e84f51ef62956860da8b92518dade583a919dd2249aa9ef04f50ae5c336a8744968b9cee21da431dff46628b6f82b6ee35bb046560acad502384c6ebd51d0b3ce9f6fefbccd58c364b60787c57793418c183a44a166142b252ce809a91b34cc0981561818a8579b3698ebc89b8d2db256ac401535778b06b4423362e2dfdf9dafb4a301ce2fc4a78d65afda9056aa9ef50d41dc0b7e536c5c8d94d1be59ddf427c2caeab24083adbb40a4187ed082845e2960e1ed527babe6f90351bd754968224f8cbd6cb69c6b5a96c5db85df912584e66a6ec8dfcf8fac174a329b68c32fbf2e0456946cba0cbc5123630ccc8fe4f14603e342d4563342a27d18b1a7f9ff5fb54a2e2a081f32a3be7ed1f603b2af69057feacc20c8eb74f2c3c09f4369bb0fe5a3911866036391f58fea7984fdf544c06f4a38a1fbb6fde4e9b9bb5ba4c23a3a86d0300433b85035a352e5926af4b8c5f2a53d3ac54109549ebd1e8e44587ffc21c1f2cbb7861fe8f6eac9ff47850b9757968d8b657f7db8e754d3f2655c74ebc2bddbf23758e9d8ab9a732960c6d4e33d366ec188d464104494da695edffa0a2bcb44b2f8aac17df2d4dfa8497f220f77ccf779de2a9d0bc5584bfd705e70d40b10da20968e76342724fc90c51708c20cddc7aa3be583212eef54f69f7de37599f9adf48be57e4c95726d1410ab7cf93774a656150afc876167164d02e41ef0b53bea9fd901b3cc14b629144a5ab834c44abe03091a5cc01ea450b0f79e75c6e7ad853431592857845f2937b9bde81d52db67637c0ada40d9cb7046089b1e4efa4794710250c19ac3b55fdacaa05177e941a1d9233e56ad971019bc7778d0f927aa53f5791c0156f445e77a9e35d9470f6b869ddd6ecba6022792db3271f69f5a8bd1a201f901f0667c21675d6cfd52802196630536cc59a386f7e70a10df157ae1168b09f227eed760c1c88d2b963de1a085c65c2eb64084118f94b0da2f45d0be382af044ebb0f1b6d9f64787141d2336bbddfdb2ac54b246a6964eb1319283babf11ee4aeba492fa9b148dbca349bee5f80b29c4255658c2d5570315a51f1a5da9238c6876d7a1ab0f5c18af3e645d9b7c221895ba8ea2d700b8a56bac89b32cb5b236b3a375ffcbcee4b1f9a707b6712fb105868b218bfce6fe65d0aaf6e5a00d0add3d72cfd78590bf3a69bc91a39ecbe18d8c30403273971c3cb7b53f16fea6c47d5ef17f0a980e108cdaf533b4f9b56dc23abc1be31b76522cf1f5d2e11be2b70bb0140651830bd605249672a19898ec8f2954ef0e4f2dce777ecb9e2b7c2cae9472b399a6471df476de6cec9151bbb2cd9eba0cf0adbffeb4990d1ca6366fd4588dbf355f06655a506ef2f5dec7436a00573c6044be20f9c5b9f0cc81627c6ba80ae22398970ed178f440d0c3517acc53280007a730526f0353ef35a6d8b83307ab992910cfdc282b39f4a15c59152f229ce837a886acd1b68195fdf3b3325085e9da3b4823627a82981f1109dd002837a31f9043336adba64f65ee2a6435e064998f12eeba950460de51fd0797f1069bc6b2874a1d3e4fdfe6fa4371198d56371a1536f1ef20808274e0e698152bc5c167467e33f1185a9e3cbd0f4631d040fced77d99835781a2e1b20f1d9b2a0eb66d2ac278a1e5c676e5e5f2ecdd911cb80f045051c9d4c92ec0df01e87b7fdcb8ec2f290c0330aee43dc86a67a7b01495315f43ba0a3302084356f7b47075c2c0e5e8e4ecc2f499b0ee5eabbf29588699934af73284d9a3f54f0d3a17ad39c6b1cf3ea9a1a610587313d463db99058594962eff2cbfed65462a9a07286b2157da2c813e42993e6160d07a545c1a9aaaad4927c6cb7bf9d8e3daaedd4cc2acc795039f0216a912e5389ddbeb20c7c3be7c7ff4a72ee1d623abca34de28f7f58a5f8427ab3114fe0f5bc85c1f331fd94450b4b05d2b39afd017c374904ffab8129f7c136783f03de22e7b39ec63d6df1da3df62e00a6e98ed02d8819b0d30856d5aa101f71f43d18dd57b4afcda2123cadc476494fd7403f6b8d5ce16d30a4c8c0be0e542049b875459526554166f69af4b364d7b52442873a95eac8234a982152c8eaf3fa8fded2552dd0040dcc4e9769cb739354968cca2dd16a700b07203589a3d7ddcea92a4d56f191f87f23415355b5890dacaa5447555e2aa46ef56fc06621f9e8618382b0ea325a42eed61cf9d35404fc442ddd4b2e11e84885fb42d7fb56acb3d9e98071ca0140b04b6bd5c61c17491607ed0c26fc2e2c7c1bdbc825533249f45ddad42cba85a3c860b09c7ed217f2efb42d58c96dd42464764c36b7d9f37883d3121638002e55febe7392d8db329d131abe21a217d7ca287859804862ddcf60463fb73cb572fc2690a5f17a6251cd8b317ece88706e8e47fba759a9b50801ebee68999ee3278cd669167b5c700d56635464067be2cb5b6509f5f699d04cd8b68f5605ea65059eea49d074dd102430e00cece8118e1327e681141fb4974527e15596e26437c16d08d31105a05098ba55481a3cccc67c059c7081dd606b5c98684b8b0f32d58c785750df1a681d7dba2578c1c6fa686bfc1a9e17e8cda1bca448ddbc976b44961e009a338d246e917fd05ce76f3b9061c894b11239ca4d9fb096fa71011b114375b41c1af0ca4486819436e13340427fd45ddd1fdd38454615bf07e47b1d8b5bba082e13cc3bae5f308efb0d583a3c466a66b0847886350b6e0cea56497b667d5a1dde2442b891fd2962cae64fb49aeb406a2ce78fdf3cd470895b1db4f259f0090c42f13eeab507201bfc4bb28eb73f973c343a5b7bae46761f6b1fe5cd1c6f54948fe1189a9f0e5d51a562fd7b4f55bfc69af172b14cfebb1e6b539f49cea52272d34390b3f4cf2474e4a5f283245156c09e256c54a2145188966738c7991031cb8e41f8b91cfc8a5960511c08b07731ad1d6da319f5b78822a49e442d26d8a662247bb2b5254746f3d5ac6f4e916493fa7b5c8ff59036ee7792d24c12ee216d53c58f51b0a0556dab252b9fcc9f6d2ddbc717fcbc5c00ecb8556768c7269d452ab0cbf941fd762522a45c1c276e886995dad72d27fc1d617fed83fe9f0ffccbbec25c5acb7c2d4621f32dca9884c017a30349c0b10d2a47dd30987a56e41798f2e3bde2b675a43c78de093c48a610f36159fb2851a1a300b16d34d01da87f21f2f6f19b404f9c3cb38b47959096685d47f7097a30af8b78ad47e200a6a377c7bebbc7e1bf17cc9eab3f75432a70877fe94d248e8df911ce5c0644ab516efb112d656aff4fb720519e3c9cd8e0bac188ae5196f843d576a15a3cc68592051f75493e54ad73ef9e6c16d3b83212b2066a7332264b959b09c1415686605c5c22e97f917a23817d077050c7badae4c7d1a7e61922815b3539d68da0d44819ce6102fab617d6b185e19d89d49ad019abd2844cf6cac791b38b07da43a903ae5c59d7b9868d0ef27143f0b5a69afbcd3745b4fcc7ea3ea347a94fa9a0660825ef02f28731ab1067297ee96ed954330aeba03bd737c6d360e85f4ecd6ea16a885724da3b066c1e20cf0342d598905fdbaad6fc8ad19dc7f88b50c7f39a31ef62924f3fa3c38cfaf13e0cf81f52059b69f437b18d7e380499fb683054117918cf6d3b3cfe380cd8ced6541a726250a778964b208138339cb93f15744a8629e74a16dc530f59159c418c82f7ab124985ff2bba574e455798fc071d888f934a360a01df98ae2f37237dcd7759bbf9ee194d423b2c5640f75780fb94f25c0f367ebd4a45f7f73ebc78b6f915efcd81ce58f02631ea1f6f2a535bb14e85799009411fefaff2c21b38e86b0f640aea18834e4dfecff7a1d8186a7739292f8a716118d0b452299e8952fc6f335a0f956427ec8671bee153d53fab7b0fd4dc00fdd49f0391a684cfa4e1b1b8c193692400bbc47ac9288accc6bb476d61b8285564626f46bd64b38bdfb2fec402829458bbf35c8a52aeb06e0f9d31549fdd01923c75bbc57a2956f9f564c89639a6f76cf86f6231b2b4860bb05ce06370bfeedc28415df073a01a7e68d65aa0e6064fa76ca1a293f91a161a150858313dbe94661c879217f2e08b640ff4e9314408d615709b822553aff19ff85fe276184022aaa8170df3fb0dccf1432e38fb3f4b89b66f18eaf4381f3c454f49b38ec343c61ddcdb4ea0d319ab1123325a18d90e3fbead845c9f9dfa2a8dd1ee09c157fce03dae137603616a4b940f26c756e66f125050dde2867535d435459e38dc6588fa8c139759d0a5a67ce4c2940ae1c082cfc82d6fd9c40c9a67d50c527070327a0e9494092c04df9d5169fd042758c96b214ee416572132d910b2a472dd5c4986def8d673139a4de2b46123de2fd99280ef8fb877a0acc217b04f942ed16392eef26869ea72098ba92d8e131210bea3ffead841a14452dc46dcd912eea9b084093ca5e5571ed253194bc867c3fa539bf7fededfb03297719270dbd57508f3704614dd7f94cc74d22ef964a46efc7cf628732462587e862fb9110b5a826ee50c0bf360dd71b1e3f2fa02b5594ee50c9c39d12ebe55c73b1f2ad033962ffc4e298e8b2db2d039366081d8064fa2dc479e7a756e2c0b9ef2f77d566f6bf0fda20677dd6940e8eed6bf392b3d3f75e33a0709ac6171aeac7cf20eb423a32e10e2439769e378f20ffd13f0b315d6f0109648bb20e9eef3c159fb6e51aa85f84c51ff105e8cd900f84d14157f17bac9065b9e5faa58df58b07c70f11a64e2545d34de89c693d789040c65db4d4453e913d2651467e3a948d4035848e4cedd528a33255034ec4a91f9b0bfa88aee7689ac4d853cb64b886d827cc0933b01ea2aaefd2904f234c03f9f0e1e9ad12ec11e79291012c2b51f3039320fd65af94267d5f808f92cf85b7e5973437d4dd7368a4c96521679720c97f80aa42c169707069486aa71794c98499025e687ccfd8a5145f26296672e6ca6744a854bf70742532cee4859e55a4d62c011f4bf9b445a86e8c2e8e38eb7b92396579677e3cbabdd29acbbc7a6ae3ef99a74fada31d50a162d5a56736099db01f6412b0d7b93f65107cf5b59bf0f121b78f3afbcb4a179de995b7f03b6087cfd4314b273310de9a09fde87403c09decd8df49f613a02d00d858df7b617dbe97a97940c8845507300238357abe49e11c66f0538b4aefffa839de9cdb9c0229657f4c3922c18320588d2334ec0e6bf182743912451e30f217e97795f23db203ebf4744b8d4ec6847c555823361c9f4eba5c67944e85d14eaef87832b689304a526df57afffd0b567b76c433725f68450afbac99d00f2bb733d8b762c10594b14bddceb7c4c6e6263358f0ecdea29a8743ea2f137eda20100aa6b188d3b6a0cb3212a039d4c81c46ccad8150f857da79e4c9ef04ae6330271e47cb6c9b005acdd80e3d84a05a8e9c9f1322fa65098b4ced11c1aa5ad4d58dc17d6a69dbd305328912065388d66ea7330de13148668ef80f8b893a7c5c6dcb5d9fbc7835298423e2a6d03b46f6f3ff0b0f979508d1f032640ead8c7790e55f004d9d1c77893afd1ef94e75a2e26208ed41f324e879f563c93c3a4976c82eb9a8dceebe795971ed8c97b863f96d674c542368949d484a62e8ff3a50d2608fce756e3032efe11e5ee7705c8f64e5f25cfe909cd8613bf6f463f8868b9783dfd42609d38f9e3b728eb8a192e50fa06dc1b9ead91dffb234df1749b8f40681efe2c725736f23e39252dfdd192cacf0fc700618fdaad566c5352db6f9fdbadd7f0342c3949d6b4f2fc3dc5bbb1d23dc35b8dbf725fe9ac0397c83275b07fc8814847e542a72330c297ecdae48c337a1333221009a86568abbf986aa2f64c97ccf80bde3bfcc696479a137ac4583aa010868e4bc8d30910882d717e69afc3cdd00d8bc773d90bd6da5c4cd5863c4a14a26976375345175a0b3a7c633ce83465dda29bc6915109ca4bb59f8cb2019b1d43e0139c3c634d27a81f5ec17bfd36dd2b21fdac8e695333900cfb78d169cac8ed975aa9783acebfe7cb0c0208becdf62c1d54c4ff3e61671fdcc739d5014c32ba716346ad5cfcf4e98600e94d438aae646a243011c06ac2f28eea34e7a91912608a82308716e5ffd8a8486fb1e16f7688c06a3346a37d154933ec8924a375e02186977c2f9ebd4d6d4bc4820994cea01217ef295707dab368ca7eb007fa9567922566e2c6c2aead45c38be9994ebbe272ca0a3a20023479790dadc2e23d0d8cf17239b2d69285556498f610e839b735d5ffe741d35478cb6e4f00dfd09a6591f6e845702f614bce724ca8cc1f80a59a71febaabf1366d5f4331f558ae89b63a19949893488cfe2120a0d47d0ca08427b3d2d390a28ae9c83e986cf0c328afa23af188e668717550527a9378b8e4c4b59e61fba3c008c85c33358b74a7ac04dabc7da40ea90a5ca37bc832bde0c3febff44c3cc742c4cf6ae43040c4d39e5dec8b8b94fb5e0501da002d274d7d3fea6630a5e384b43b4eeafde8608af73cf79d00756cffc55a7e6e2c8d317c7ed3323375ff5be1ff918799439a08d8b4eb1a2ec663710d98f320606317f7b1ecb47758762cd7f420e20f466d0d34065b202621bd49352908b0c2fe43d1ca476cfa0522d5c2b836bfa50adb1e792ef5b671cc074fdc2fc50d988c4ffbb9d0557b1fd45017fb93709dac451d398903525ecd5b9b5bc395d1a869c9adeec31037a6bf86d512c4f0353b906d3a7be78fa3603e9f2df56dc5e6fdf38892111afee45f2828b95116a4f9c75c1d05d60f03ab84b3b164ccadee65c8864c303a10f7c16331b867611e90428eb7471a2588d1f18b80caff6e276839187c951d77cdd8261599c767ca5c847219eb5973e168e34ec7976e7e585a5b2ce6c37e4114b243f168fddfeb75a8755e1884af27cec288ae4b876f071a4fc1593d8f9b30aa4f5f8cd102cbb3991adba281eb2a07731fc47dc1cd6c20592ff6143216e027311f401541c5d999c36f1c5880ba86b97f050fb00013cc3cfcd727d64f70bc39ea688a56233fb877f8c2a62e56c781ae6a70416d60f5180f8b2ea4c2a665b93ced599fed607666a52ef40b49e887574dbf8e657097e8a4bb4b9f8e6670b72f24cfdfacba3d6fb08553177815771f3e68b58dc27fea77060f53b0e6ede7a9300d2e08c99afe5d85de13e4b3b1a9c8897197d7b89f7c084b70e60596de3e47e55b563bf62a715735243b0b4196f968bbc2a569d4b466be46c08b979aa89c6f6b6f18db273eb5ae3bbaaf1b3959b9b55e470782623674dd9f5555c7590be84b0892b7dca90b45c71a6399a517b530cd2f04f47fd595d4084bf00aeba77d56e0baef2b9a02762d3acd61aa325ade4b399679afa68a223668a4b4f24099cb8deced91d08e5405b3bc223181ee1f19b09433b88010a4d1bdf5d2aca2fec62455893ad7c7e1af90c1f5c341797526728c856f55e95598bfc407bad116275f3c754e0b45616aba3d0b2bfcf64cf23bd0cff774b2301f80515f7927940cae67cfc1e510f074cf36a2cc27112d57142f247e9f3713f01de96a631857875267fe0a81a5e04d3063d8a669c4d81bcf1a802c79623536f18b60c4e0bcdc087a74a55981cd6f5eb31f821227b52f71ac9b9f6d8809ad2cddcceb5dd33a467c30c27abc5463b6bc95fcc147481343c7886a8e65e824f2f9c179302711fbcb733c95b1486be62a67f8d552845fe39916eeb528f04354b88e9c58f39d28440922c8f9bb34a188f643c134972fff2572019dde7a037aaed492cf31e9d51f22d859a7211b023dfff7d53044888a2bc10c5cbbfc001e164a7d72a4e5ea519c81121d3fc6ec7305c8018b9860caa60304f1efdd25162d293b2584d8a84aa6ad013b9a22f6a3bbf3cb00ed612cf95d4708ebb5ad16ffbb5040c690519221a9d9f1319eb268679ba77943b6949ff683bbd826d3909a1b0638d9cbeea32d3cb6436fb6ce232c84ff33b7ec7694b191800164d71777a0ed36d3cd361ed93dc882e3b6ae1cbf186652d612433a21f4c14713141d741b6fd47b3d25b42130c221971ae6c8cdd00634befc02f3147aed30bf862826f60b6633a6fd9c6aae1a6939b4e42b1de9a2a614815928aa3e0df88350903646f875846837ea22c494752f8ed84163664daed10671b54c5afc3fb4a9f90b2457845f406c920c22f7a2705a58825a503a9d4d29207afdf4f7b9970755b582c2ea5c474f844160507b3a2e548a42e6954ae478d53726ad257a6dbece5fa5ea262b664c44052f1676d3ec1e86d171886f999062482941933b2d5224846cdaff99842951a3235b5b12aa969a67860922b6b36bd09726c96bcbfe22ffbf1c1690fb0ed25059c722352f5c889ae833a28d631941437e7e0c26096f3957f34b7313efcc95d7440f6680dd473a54544c000510b291c5c749a777c21990a419237c4d93f6371a78f12a892c407ad4abc1bde80a49bad12216873609549c81744f12c69a483fc33ba1f1ff68e56322a5c718d0d4674ea4d7b90768d914944f37eba58d2b7ab95d0260a7285eabfda754acb897035746f95955df1f7f89e34f88878292ce66c5d3c026822d8a7f0c8029fa05e1a722ffb66645e1c529e487fb87cf01366a83ca25ec31916113bfce352f5cc01f50afe2be51f3db2ade85a4de2d24ba3a8c87d19e3888f729de087a1caeca5ecf5eda1e646983897969a8ed77a66d8b1a8f3fcf16dd7e8a899a708cd47964989c5f010aed2543e9e4e2c4e3d87ebfc41f52fea2a553823b5982e0aae1a026163113356931f2940b240e6a2612b2e0c7d4b007e26ba4f3b4b9098ef65630546aafb36a9c5c82954474cd1bd00442475b27b2fc5a8869c73f4b7a38edf41d374f9c226fd4523af92af0180fad338c21181635b7a8a5c75a740435d78e53fd7aaff3c5c7ccc9c983feea9b8a3b65bb0c7771225067123f4de1ed9aa97538c113f821490fed9c0f56ed806d599a668b915e7db973812da7b6bd10f33e26a1e59cf80cb52b0f92cfef12b9fb2ea87a2ca185a4536b685951333179de73cae47aeca35a07864d7f81c81b761633b66323e04d4c9833da652f009f01eff2d1434b4cadcb79a1351f4ea19b0920dcf7cfaeec1eb1a6695b61c05ee9ca44543506bfce878572478a895ee4ac41e0b201a72f7e2ec6be866c5a9943d56a4789b6f2fb496ebaa309f87a69bee4e9890b0ae1c656c7fc05ed1992b653b66bd75a7432a85a0a49e1a54d55556370c39b821b4094e2930fe1b85668004c761167e1021cfc0059e3acb1a1cb1242171e30005cd20baad808f96c5588ea5a11d67358977d427f6f02b004ed7e5ff74262279febbb81dc8076c7e7a9404099727eda50f46ab8ecd578f0bba853c968d758a33384e219a3448c84d3c23b11e2df55e4ce233bd9b007943aae95771c61ef65165fd7de4aa67db65d16d7a825fe719d880d9df5534b829c7cfccb8d7940ea40fdf20c13d2432a4d794894842115cf8b9f9826da42e3da6220dbeecb76a50c5f38ed250348519da2eabc0042502f90449027939ee3f3da24e22fa3a4c32c3232974f8250c1534fab5e5e386fafe748fa76c844e111d192a8a3400b51bf84b40bd722e449f51fab11e79ac6198af73231b15adda2d8840c6b5bd02b4dbe8c9b24be177bd927ff061a8bd2cdf9ce92ea2aa013d9267ce3c9bba1d59c1195a24ab70eeeb96b815e6e10e163743510c45a6105d7084652b3a926cb17d91d58eed461a1095d54dcd82f81d1560c2774f3f475a4d20b52c74e67d0b4b5c0e1ca1ec2683f64ea8d66cf361282f9aebcb3e94fc2b48a7a50a2bd9f831aa22d1b16745eb331e6692f7c33842f9ede5f19a362389da963f8d4bf6a87589e90c5e47d3f3bf7b2b35b11f19519319dc7c0596e5e0971a61141ba4c77060f90dfc4719d4ec4fff9c01ca57db75d9e566599186c167c27de1bc1fba50dc1864d0c6d051aa9c6d186c36c81246936bc6836d6833c0ecace40725029da384c685f99ca6817a638ab1fcb60cc4c67aeb02113867fce05a66b00b946c3224d7ca2f237396187c24c320e28e3b952704104efce46ff521cbaf2f5125d2986d00eb53a4cb2b4ad17e69a1fc5054260ab8b042148ecb7130731df2414b8b44f21fbfe5ac530ee2009bad94b7c80890a6f37728ed6dcbb94193a8f85adb3ed6cc476277482bfdb39d76b47931995632ae6ca7478a3be30734f28d4b5678c5b84e722c23acea3ad027c71bf850e6a229bd52f17eb45db328a0ff537f170890958d5e32c57f0e46191e69a2ff4aa8b20a3d3ec9d35ec74b1e6d9081a6fdbba1bc3ec86a6f24cc02dd716c73298173521ed1be85500e65b06e8b15b710804bce3744c5e3e319a95fd1b6d335d8833235c06e7900f290685f1c8db24f027297a89fa322940e5936afee9536517abede5fd43295b646e7349b7d649e80ae12be85daf7cdb1bf0dc6717a0425455779a26759d30b00d1d379133f8653e4dd2c9691241f857ead6cfc584556cf081b8847d6415e030667ac6b566c527ec5fc67f4c152f624f60bf00fa57f8c55bb3479e2cf171b0823a4304caac0f19fd3444d4a28fa156d63aec12b1f6c4a36ae548f438ac46bd0e26eca1b94d576853c3c647fb9eefb3788f60339b17ff23315a6a35c1c7f18e6d9cd557f6865fe8b6a0b591b1d6a585d9ed9b92894f40d30b84d32ec04963eabd780269dfe527df0b0f448666fe40d974c7d48a5c7a0faa71523d2ffc4c263c710c0e25f3dea0d1198f43a9225753c8ef1a6df9dc3fe9bb2685567f0886b7d14bf260e3051c655b3d88218723ed273331e4fc5855643f1e4d0bb64490e0c1842f26a76c827dabe1259d936ac338bee0d4111aceb7c0d9729ae59362b3b6bc65ae580b84ad8ed371a4041326958f309e942e1dca6cc02e506c29dbbf3dfd235b2f1900043c1c458193f14b48ea87058cdd8614e99745207aca2f5ec69c81be7d5e0af4130ea943191bc3aa11de66d948afc6ecb22b1ea46ae6388bba6d16989a72321bad3a8e70330792e7b01cb2a4e85eef427210b7260a27e420a3921529a2f90547fb85b25f3df8ca8a6ed3c942649c37eba178afd4ff7b65e49005abeedc50b634b2357e1afb9d6499b9c1bca5eed09b1cd3a4edc7919110c83fbcc0f3e6442ae8d27c6cf920f42883dd6153fea41f057096fef86d28ed26d7dcbe35e8943fc4d5576d59dcba328a1b3251cef0b4908a50374de0bcbbd1a0b6cfb98a19526baf600458f5cabe0038371dd75e129f3568e32b1f297efc3e1feeb8e1e61ddd4b43533b45a4fc63c639cc5a9c2f2fe2b6def7afdb371500980808b50d7779e19889f37978f441bd0d5e648d9bd4a8216a52468fd9a644845a01e92ad8ad3f21eea2bd2559ff4954ec8b6ecf7ed4cdc9341291dd1b540bce7f4c95efe9c1b715f5394efd3d297359346cc4116d1b08d9a9245c5e109</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">爆0了</summary>
    
    
    
    <category term="test" scheme="https://dyd-true.github.io/categories/test/"/>
    
    
    <category term="暴力" scheme="https://dyd-true.github.io/tags/%E6%9A%B4%E5%8A%9B/"/>
    
    <category term="dp" scheme="https://dyd-true.github.io/tags/dp/"/>
    
    <category term="test" scheme="https://dyd-true.github.io/tags/test/"/>
    
    <category term="基环树" scheme="https://dyd-true.github.io/tags/%E5%9F%BA%E7%8E%AF%E6%A0%91/"/>
    
    <category term="基尔霍夫矩阵" scheme="https://dyd-true.github.io/tags/%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/"/>
    
    <category term="生成树" scheme="https://dyd-true.github.io/tags/%E7%94%9F%E6%88%90%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>后缀数组</title>
    <link href="https://dyd-true.github.io/2021/12/20/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/"/>
    <id>https://dyd-true.github.io/2021/12/20/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/</id>
    <published>2021-12-20T10:46:41.000Z</published>
    <updated>2021-12-24T14:18:55.528Z</updated>
    
    <content type="html"><![CDATA[<p> 字符串总是让人头疼</p><span id="more"></span><h1 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h1><h2 id="前置知识：基数排序"><a href="#前置知识：基数排序" class="headerlink" title="前置知识：基数排序"></a>前置知识：基数排序</h2><p>首先保证值域为 $[0, n] \wedge \mathbb{Z}$ </p><p>然后统计每个数有多少个，记作 $cnt[i]$ ，然后将 $cnt$ 求出前缀和，此时 $cnt[i]$ 就是“小于等于 $i$ 的数的个数”，倒序扫描每一个数（倒序是为了<strong>使排序稳定</strong>），扫到 $i$ 就令 $i$ 的排名为 $cnt[i]$ ，并 $–cnt[i]$ ，由此就可以做到<strong>单关键字基数排序</strong>，时间为 $O(n)$ </p><p>对于双关键字，我们先对第二关键字进行排序，然后不管第二关键字，只对第一关键字进行基数排序，由于基数排序是稳定的，所以当第一关键字相同时，第二关键字仍然是有序的</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>后缀数组是一种针对字符串的数据结构，为了方便，我们统一令字符串的<strong>下标从1开始</strong></p><ul><li>字符串：由字符组成的序列，用大写字母表示，如 $T = ababbcbac$ ，记其长度为 $len(T)$ </li><li>子串：一个字符串的某一段，记作 $T[2, 5] = babb$ ，其中 $[2, 5]$ 是下标区间</li><li>后缀：一个长度为 $len$ 的字符串有  $len$ 个后缀子串，为 $\{S \mid S = T[i, len], i \in [1, n]\}$ ，为了方便，称从 $i$ 开头的后缀为“第 $i$ 个后缀”，记作 $suf(i)$ （suffix），即 $suf(i) = T[i, len]$ </li><li>前缀：我们将串 $T$ 长度为 $len$ 的前缀 $T[1, len]$ 记为 $T^{len}$  </li><li>后缀数组 $SA[i]$ ：排名第 $i$ 的后缀是 $suf(SA[i])$ ，注意<strong>区别“排名为 $i$ ”和“第 $i$ 个后缀”</strong></li><li>排名数组 $rk[i]$ ：第 $i$ 个后缀的排名是 $rk[i]$ </li><li>$hei[i]$ （height）： $suf(SA[i])$ 与 $suf(SA[i - 1])$ 的LCP（最长公共前缀），<strong>可指字符串，也可指长度</strong></li><li>$lcp(i, j)$ ： $suf(SA[i])$ 和 $suf(SA[j])$ 的LCP</li><li> $h(i)$ ：第 $i$ 个后缀与排名在其前面的第一个后缀的LCP，即 $h(i) = height[rk[i]]$ </li></ul><h2 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h2><h3 id="SA-rk"><a href="#SA-rk" class="headerlink" title="SA/rk"></a>SA/rk</h3><p>求后缀数组 $SA$ 一般用<strong>倍增算法</strong>求出（同时 $rk$ 也就求出来了），时间复杂度为 $O(n \log n)$ </p><p>首先我们想如何对 $\{suf(i)\}$ 排序，由整数排序的方法我们知道，至少要进行 $n \log n$ 次比较，但是，字符串比较的时间复杂度为 $O(n)$ ，故直接比较时间为 $O(n^2 \log n)$ </p><p>不难想到，如果能让字符串对应上数字（且大小关系对应）不就可以直接比较了吗？倍增算法就基于此，其流程如下：</p><ol><li>假设我们要比较 $\{S_i[l, r]\}$ ，取 $mid = \frac{l + r}{2}$ ，递归比较 $\{S_i[l, mid]\}$ 和 $\{S_i[mid + 1, r]\}$ ；递归的边界是当 $S_i[l, r]$ 只有一个字符，可以直接排序</li><li>假设递归完毕，则 $\{S_i[l, mid]\}$ 和 $\{S_i[mid + 1, r]\}$ 已经有序，扫一遍可以把他们离散化到整数，设 $S_i[p, q] \rightarrow A_i[p, q]$ ，现在 $S_i[l, r]$ 被变成了整数二元组 $(A_i[l, mid], A_i[mid + 1, r])$ ，直接排序即可</li></ol><p>以上会递归 $\log n$ 层，每次基数排序为 $O(n)$ ，总时间复杂度为 $O(n \log n)$ 具体实现时常用循环代替递归</p><p>ps：其实有 $O(n)$ 的DC3算法，但不常用（常数大+难打），有时间再写吧（挖坑）</p><h3 id="hei"><a href="#hei" class="headerlink" title="hei"></a>hei</h3><p>首先证明三个引理：</p><p><strong>引理1</strong>：<br>$$<br>lcp(i, j) = \min(lcp(i, k), lcp(k, j)),i \le k \le j<br>$$<br>即对于任意的 $i \le k \le j$ ，排名第 $i$ 的后缀和排名第 $j$ 的后缀的LCP就是排名第 $k$ 的后缀和它们分别的LCP中较小值</p><p><img src="https://s2.loli.net/2021/12/20/fOrihaHRVncWGz6.png" alt="引理1"></p><p>证明：</p><p>排名为 $i$ 的后缀为 $S_i$ ，设 $T = \min(lcp(i, k), lcp(k, j)), R = lcp(i, j)$ </p><p>首先若 $R &lt; T$ ，那么由于 $lcp(i, k) \ge T$ ，所以 $i$ 的一定有前缀 $T$ ，而 $j$ 也有前缀 $T$ ，则 $lcp(i, j) = T$ ，矛盾，故 $lcp(i, j) \ge T$ </p><p>然后若 $R &gt; T$ ，那么因为 $S_i[1, R] = S_j[1, R]$ ，又z因为排名， $S_i[1, R] \le S_k[1, R] \le S_j[1, R]$ ，则 $S_i[1, R] = S_k[1, R] = S_j[1, R]$ ，则 $T = R$ ，矛盾</p><p>综上，$T = R$ 引理得证</p><p><strong>引理2</strong>：<br>$$<br>lcp(i, j) = \min(lcp(i, i + 1), lcp(i + 1, i + 2), …, lcp(j - 1, j)), i \le j<br>$$<br>即对于任意的 $i \le j$ 排名第 $i$ 的后缀和排名第 $j$ 的后缀的LCP就是它们之间的后缀（包括它们）中相邻两个的LCP的最小值</p><p>证明：</p><p>由引理1，有 $\min(lcp(i, i + 1), lcp(i + 1, i + 2)) = lcp(i, i + 2)$ 不断以此类推，即得引理2</p><p>这个引理也可以表示为：<br>$$<br>lcp(i, j) = \min_{i &lt; k \le j} \{ hei[k]\}<br>$$<br>用这个引理可以<strong>将后缀的LCP转化为RMQ</strong>，ST表可以做到 $O(1)$ </p><p><strong>引理3</strong>：<br>$$<br>hi(i) \ge hi(i - 1) - 1<br>$$<br> $hi(i - 1) \le 1$ 时显然成立</p><p>当 $hi(i - 1) &gt; 1$ 时，不妨设 $k = SA[rk[i - 1] - 1]$ ，即排名在第 $i$ 个后缀（不是排名为 $i$ 的后缀）前面的第一个后缀是第 $k$ 个后缀，同理设 $r = SA[rk[i] - 1]$ </p><p>有 $hi(i - 1) = lcp(suf(i - 1), suf(k))$ ，将这两个字符串各自去掉第一个字符，因为它们的LCP大于1，所以这个字符一定相等，则有 $lcp(suf(k + 1), suf(i)) = hi(i - 1) - 1$ 且 $suf(k + 1)$ 排在 $suf(i)$ 前面，则由引理1有<br>$$<br>\begin{aligned}<br>hi(i - 1) - 1<br>&amp;= lcp(suf(k + 1), suf(i))\\<br>&amp;= \min(lcp(suf(k + 1), suf(r)), lcp(suf(r), suf(i)))\\<br>&amp;\le lcp(suf(r), suf(i))\\<br>&amp;= hi(i)<br>\end{aligned}<br>$$<br>故 $hi(i) \ge hi(i - 1) - 1$ </p><p>有了上面三个引理，我们来看如何求 $hei$ </p><p>我们枚举 $1 \le i \le n$ ，计算 $hei[rk[i]]$ </p><p>对于 $rk[i] = 1$ ，不必管，因为 $hei[1] = 0$ ，否则令 $k = hi(i - 1) - 1$ （特别的，若 $hi(i - 1) \le 1$ ，就让 $k = 0$ ），然后暴力求 $k$ 还能向后走多少，易知时间为 $O(n)$  </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.acwing.com/problem/content/2717/">模板</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> sa[N], rk[N], hei[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_sa</span><span class="params">(<span class="keyword">int</span> _num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> x[N], y[N], c[N]; <span class="comment">//排序用,第一关键字,第二关键字,cnt</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i] = s[i]]; <span class="comment">//第一次只有一个字符,不必离散化</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[i]]--] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, num; k &lt;= n; k &lt;&lt;= <span class="number">1</span>) <span class="comment">//k枚举关键字长度,合并后长度应为2k</span></span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>; <span class="comment">//记录离散化后的值域</span></span><br><span class="line"><span class="comment">//先以第二关键字排序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i)  <span class="comment">//没有第二关键字的牌最前</span></span><br><span class="line">y[++num] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">y[++num] = sa[i] - k;</span><br><span class="line"><span class="comment">//以第一关键字排序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[y[i]]]--] = y[i], y[i] = <span class="number">0</span>;  <span class="comment">//这里清空y实际上是清空x,因为后面交换了</span></span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="comment">//将排好序的字符串离散化</span></span><br><span class="line">x[sa[<span class="number">1</span>]] = num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++num;</span><br><span class="line"><span class="keyword">if</span> (num == n)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">_num = num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">rk[sa[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_hei</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rk[i] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k)</span><br><span class="line">--k;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; s[i + k] == s[j + k])</span><br><span class="line">++k;</span><br><span class="line">hei[rk[i]] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">get_sa</span>(<span class="string">&#x27;z&#x27;</span>);</span><br><span class="line"><span class="built_in">get_hei</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, sa[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, hei[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>SA的应用主要是通过引理2来实现的</p><h3 id="多模式串的匹配"><a href="#多模式串的匹配" class="headerlink" title="多模式串的匹配"></a>多模式串的匹配</h3><p>考虑如下问题：给定模式串 $P$ 和长度为 $n$ 的文本串 $T$ 询问 $P$ 在 $T$ 中出现的情况</p><p>当 $P$ 只有一个时，就是kmp，当有多个 $P$ 时，也可以AC自动机，以上算法都是 $O(n)$ 的，那么后缀数组如何比较好的解决该问题</p><p>首先不难想到， $T$ 的任意一个子串都一定可以对应到唯一一个后缀的前缀，具体的， $T[l, r] \leftrightarrow suf(l)^r$ </p><p>那么考虑构造出 $T$ 的后缀数组，由于 $T$ 的后缀已经被排好了序，可以二分查找每个后缀是否有前缀 $P$ ，具体的，若我们二分到了区间 $[l, r]$ ：</p><ol><li>如果 $P$ 是 $suf(SA[mid])$ 的前缀，说明这就是 $P$ 在 $T$ 中的出现，所有 $lcp(mid, j) \ge len(P)$ 的 $j$ 也是 $P$ 的出现</li><li>如果 $P \le suf(SA(mid))$ ，进入区间 $[l, mid - 1]$ ，否则进入 $[mid + 1, r]$ </li></ol><p>以上算法的时间复杂度为 $O(len(P) \log n)$ ，时间主要消耗在第二步的比较上，可以用 $hei$ 数组优化</p><p>假设到当前为止，获得的最大前缀匹配长度为 $maxlen$ ，其对应的后缀位置为 $SA[pos]$ ，即 $P^{maxlen} = suf(SA[pos])^{maxlen}$ ，对于当前位置 $mid$ ，求出 $len = lcp(mid, pos)$  （这可以ST表 $O(1)$ 求出），分类讨论：</p><ol><li> $len &lt; maxlen$ ，由匹配的最大性可知 $suf(SA[mid])$ 的第 $len + 1$ 个字符一定不同于 $P$ 的第 $len + 1$ 个字符，直接比较这两个字符即可</li><li> $len \ge maxlen$ ，从 $maxlen + 1$ 开始比较 $P$ 和 $suf(SA[mid])$ ，完成后更新 $maxlen$ 和 $pos$ </li><li>当 $maxlen = len(P)$ 时，匹配完成</li></ol><p>以上过程中， $maxlen$ 是不下降的，加上一个二分，在不考虑预处理的情况下，时间复杂度为 $O(len(P) + \log n)$ （然而，就算是用DC3 $O(n)$ 求出后缀数组，ST表预处理还是 $O(n \log n)$ ）</p><p>代码如下：</p><p><a href="https://www.luogu.com.cn/problem/P3808">【模板】AC自动机（简单版）</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span> + <span class="number">5</span>, D = <span class="number">30</span>; <span class="comment">//开大点</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> T[N], P[N], s[N];</span><br><span class="line"><span class="keyword">int</span> sa[N], rk[N], hei[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> mn[N][D];</span><br><span class="line"><span class="keyword">int</span> log_2[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">log_2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">log_2[i] = log_2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">mn[i][<span class="number">0</span>] = x[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= log_2[n] + <span class="number">1</span>; ++j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - (<span class="number">1</span> &lt;&lt; j) + <span class="number">1</span>; ++i)</span><br><span class="line">mn[i][j] = <span class="built_in">min</span>(mn[i][j - <span class="number">1</span>], mn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t = log_2[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">min</span>(mn[l][t], mn[r - (<span class="number">1</span> &lt;&lt; t) + <span class="number">1</span>][t]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; st;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_sa</span><span class="params">(<span class="keyword">int</span> _num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> x[N], y[N], c[N];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i] = T[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[i]]--] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, num; k &lt;= n; k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">y[++num] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">y[++num] = sa[i] - k;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[y[i]]]--] = y[i], y[i] = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line">x[sa[<span class="number">1</span>]] = num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++num;</span><br><span class="line"><span class="keyword">if</span> (num == n)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">_num = num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">rk[sa[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_hei</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rk[i] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k)</span><br><span class="line">--k;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; T[i + k] == T[j + k])</span><br><span class="line">++k;</span><br><span class="line">hei[rk[i]] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lcp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == y)</span><br><span class="line"><span class="keyword">return</span> n - sa[x] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x &gt; y)</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="keyword">return</span> st.<span class="built_in">ask</span>(x + <span class="number">1</span>, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">suf</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> T + x - <span class="number">1</span>; <span class="comment">//减1是为了让下标从1开始</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span> *x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">2</span>, r = n, m = <span class="built_in">strlen</span>(x + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">1</span>, mxl = <span class="number">0</span>; <span class="comment">//pos初值不能为0,否则ST表会RE</span></span><br><span class="line"><span class="keyword">char</span> *t = <span class="built_in">suf</span>(sa[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">while</span> (mxl &lt; m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (sa[<span class="number">1</span>] + mxl &gt; n || t[mxl + <span class="number">1</span>] != x[mxl + <span class="number">1</span>]) <span class="comment">//为防止越界</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">++mxl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (mxl == m)</span><br><span class="line"><span class="keyword">return</span> pos;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">lcp</span>(mid, pos);</span><br><span class="line">t = <span class="built_in">suf</span>(sa[mid]); <span class="comment">//这里一定是sa[mid]不是mid</span></span><br><span class="line"><span class="keyword">if</span> (len &gt;= mxl)</span><br><span class="line">&#123;</span><br><span class="line">len = mxl;</span><br><span class="line">pos = mid;</span><br><span class="line"><span class="keyword">while</span> (len &lt; m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (sa[mid] + len &gt; n || t[len + <span class="number">1</span>] != x[len + <span class="number">1</span>]) <span class="comment">//为防止越界</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">++len;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (len == m)</span><br><span class="line"><span class="keyword">return</span> pos;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (sa[mid] + len &gt; n || x[len + <span class="number">1</span>] &gt; t[len + <span class="number">1</span>])</span><br><span class="line">l = mid + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">r = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> q, ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, cs = <span class="number">0</span>; i &lt;= q; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">while</span> (ch &lt; <span class="string">&#x27;a&#x27;</span> || ch &gt; <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">ch = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">s[++cs] = ch, ch = <span class="built_in">getchar</span>();</span><br><span class="line">s[++cs] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, T + <span class="number">1</span>);</span><br><span class="line">n = <span class="built_in">strlen</span>(T + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">get_sa</span>(<span class="string">&#x27;z&#x27;</span>);</span><br><span class="line"><span class="built_in">get_hei</span>();</span><br><span class="line">st.<span class="built_in">prev</span>(hei);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, cs = <span class="number">1</span>, j; i &lt;= q; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; s[cs] != <span class="string">&#x27;$&#x27;</span>; ++cs, ++j)</span><br><span class="line">P[j] = s[cs];</span><br><span class="line">++cs;</span><br><span class="line">P[j] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">find</span>(P) != <span class="number">-1</span>)</span><br><span class="line">++ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt; 字符串总是让人头疼&lt;/p&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://dyd-true.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="字符串" scheme="https://dyd-true.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    <category term="分治" scheme="https://dyd-true.github.io/tags/%E5%88%86%E6%B2%BB/"/>
    
    <category term="数据结构" scheme="https://dyd-true.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="后缀数组,SA" scheme="https://dyd-true.github.io/tags/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84-SA/"/>
    
    <category term="LCP" scheme="https://dyd-true.github.io/tags/LCP/"/>
    
  </entry>
  
  <entry>
    <title>test2021/12/20总结</title>
    <link href="https://dyd-true.github.io/2021/12/20/test2021-12-20%E6%80%BB%E7%BB%93/"/>
    <id>https://dyd-true.github.io/2021/12/20/test2021-12-20%E6%80%BB%E7%BB%93/</id>
    <published>2021-12-20T07:52:30.000Z</published>
    <updated>2021-12-26T06:49:11.523Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ed335c3bf68d2a0fa54d6c7c13beac672c0e6ce951cdfbc3e932463d28cf8385">111e7d6409c611e6b63fd1363c3273c869b19609281eb10b40c0a6c772dac972e0464347c763e23e7fd9f61b1f7cde0ad008d715abfc45cc75d5ee73f8a8b9a10d96527c6539f3b05e5fa92d383942a731b3b6d7ef8a2bf4c86f16f2ffc638ff217614bc7e076a23f486c7ace2d610ae29f3d704476a25bcf4025ed086de31c5babf42ba756b2684c3468a7c6f538afb5754936cf88355738cee7433c4aac8429fdabc0edeeef84b9e62710824bbfcd1251f2a45e1e4e03f7069eee2f2c83bf278f559ab2a4f299ac8ff1758e0e10c4b1cb63e7e8c6767d9ad3dc1484b00784f0c090babcca16a52d1553624d8517926087012b3c4167ca55dc63b6d88d43707661520df8226e08894155bd35ff3c92fb7642b605093d5e072d7fdb5ea09f78cffde2f460f072998815b4a6a155d4f402e9a7a9ad28d379368459061e776f72e84f02f831a8d88d17eab92f65a75456830877310451b2142fcf586ee1cee7243e088fea114f4a3226561bb5bde1d7108a53fe131aaaa650c6ccaf1dbb998a74f8a197cf9584af206fbf7d26c486392c1e2e58b155fd83b9ddbfe44aa47823f18340e6eb0db2c599e20204696d90e2a613b2b67c8c73d0c7c35cdb7b124e69cd60cb8927f45522ea84212b311de7b0bfd3c41612e18d710b76a7534c9835d3bf18277dee9f0f44679d685418fd7c2cfb8b1b3266d9775dc36c04523da6db5b99644d6634ced3d912c444cace46202b5aabd0381292ec97e6a5ad8f3a5ff954771d4572e151cf842d0be80b780864e129a468b818cb522b8d7d6afdc0140bd7320c70768f53de1bdb1e424af4cc113095ed7bff4e4830684708944ee253db5a65eca366d4d03303976027629f97723c348e2160fc63c3befc202319f17186ce39590c05b7654f9b420542e183bea7ff944cbacbec9970d634d689f957fb2e69b5f3d3ddea1872f0facb96804c729c98438f07e8b0a22b2e9f21237978c747dd6b88b0b04f2d8dafa4b6429e6e9006d615404540ebee1da2b842055c84330c7ece7e63199e915d8e5998fda41ed873070bc7947b837fcad4b3f49b71bdeae51bd56cffcb97da8811819b47b0a031361b2df6110dea238355b098fbf1f32027ed0f608b1c23ca12fbdb0bf9a40649d848de92c0468ef9d32fe6b27da51885734ab309f20505f38f34380d341e97832161b96fe85ebb6fec6c737788b0ea6be284e15ac33bf2b50d0c70f37731960dfa7927a814a099a52a346da5eac74fed26b957b035c7c035e6934077ed73b3974689c58b3502f9fe5b3b51de35059a5f80274e48376c958a0d3c986ed9c67dbc8497812277077d1daf48d20a87a55214a18b9de90a6e622bf27cd42b5ffd2ae0b69d141661b90441969e77c110e5cd157531508069c59a95a856b7ae30d3a4b1b4039e3f262d9db620ad41d7cc64e76fe651e9c7b69f0ef397d853aa8dc133f461c618cd17bc35d5aad87a7668122166171656f657fc218b7b460f4e06e67748ae60a654a08f292b54da2de8e5e9498850789345b185a1da05f10476b17ce5032b288b6e954e84e555d24e873a588b2d490fa606b410dbdf96a551af36868b10bef48fbbd44d44f2830a5f032cb484c227dd9f534e31c2395ccec0b1e02952c331cc67be23c539f30cd274d4918115f56d92346bdc31a99bb94e2743ac47b9d7419f226ef99fa17177d7f95300446e5d8d801fedb90520dff7bce224d66912817e01ecb9af575fc82a80a94b63bef2281584760915673c01f9a8e21f14c5fd161e41728650844f198a56382520c25cd519fbe244bc8f99e8317b74d07afbd78e0fa06a20171914bb555058d4b453c24435d8cbbdc98ff89b74e87e94c3db500aac180efb802b4876d17e9a4ee08184bb0d517fc208541368cbecfcb71ebd0fdcf45415dd4dd85e14087cd638974860af4379d06897cf70d1b240b37455fa821416d9fd7a56861e1cf96604d14497d8a9213af7066632c237f973364443af9afac70613f4e0148db571c570b2a6faf7cc5c2f17f5e81edfc00cad067f2babdb4659c890b7e18afdba16923051fc4c13b4332f786268999ee107c21fedc36376fe4bef765c2ffcb7a4c20e0b393112b105869e10ca420fcb8e3b84ee8bfe5db5a159ec8dae2be6658d72c486e9f8ece6878ee437ec0d839e7c8bc1ea9ed156c75ddc0f3df1fe75ddc087308e87af2044b5319f2a723fb3fe13afd134e8dbfef59c9f6f434214322f77807cdb7cf3120f0428c4645fad5039d50a8c1b8d0c20d14a5c1f64abf41149d028e8428360cefe8dc4c0baa2e322c6dfa7000ed9679073d57cc50df6d371a9cf44401accdc94c1d98c5cd921edb99d9f1b5afc0477dcb8170ccbdb3e429ee83a369c2842a581b83a9dec4cfa7b56134c8aa59ced0ec7b1a8719b3f5060e83d585ea8abc8840974e343d820c8503dadd6c6e4b122d17e7f4849ba8b2258b751f1f2118225937041dd071db3a5fc4043557dce73a9d5faae59587b1849bd4dda2a681e6c5dc8c54be23d86659d8188a21b3d44e80f9cfa767f6c1e84c555f0399efd439a475a40db09eb92e28cf50fc84642396db61757abecb1a51737cd39596b4dc3179c6b73b9c601a878ee69d5fee03fb843b7594c5a1087b3307bb73944280a73cf7c08d2ad45d89548e27337ec9e444cbec402b58416a211110b864df33c44378926f0587bf8f728e364aae4f1dfd4721fb0fcd3ebf7acf49995b5ce0cc4131a880423ff85be4275225a92c43cdbfd6a09b0f3c660eeed396ed4faf4c1f2ae4602afcf5ddb0678d0f1253573ac57d34a7883095226344c5d45a5c0eb7cda3e8e2c26f1f45b326d78b007fda0caeb646695e7d7ce2943b918deb44c6a995e9e368f58ca2abfa0abddfcacec4dff60ff0ea74488573659ea4367fd031c568d01ce1d77bb4faff0c595621b337730aaa2113afdaa36f07e81a5df2cf9537469d42d376372c5ebdae27fd900de53d4cba806c3f8117b621c1bb963341011b7cbf1a91a0c8dd51a1aa607b7ef152ebf53217c46bd3ec12915c8b4445ce58230b43cb11758fad81473c430052f1113b688a7de25d512117b8713f17ff7420d0bd597caec2ec181777f891908442006a5df24815108e4f9ae07b80bb1c97ffd3d210dd8ac092c9a5c83d313a8e5d721b8f00b81ca7094089f1fb6481cb637a807ca82346cd50f251f9cfcb59620db177bbc7c6c3f409f1523053e7916ac937dd84440d288ae470b3481f289a47f7c6c4009ce7b0795c27db0419a3bbdd1500d5ef54d1c1bf28accf816ca5dc95541ebecc1201dd966cb4925de4ef2c0bf01c1d56a256fecf8c624ec8405625863de2ded5bb49bd816ec4b7b35826fac41e9ae4f0f54da9a3357257f5c2f332f50347758c23201d498637c24e06250c38bf3c69b12e9b229027e1091247b7881a6c9f2f4cbaf1b2dd781b9bec7ee6a5193747649826edf16b4e6e0eb3f34289ebec892aefa394015432fe039a2d379d86cf438d06256532e859bee3a0a667f925365234d6ebf9fc86a7c8f738e05ee130eab2f7c89623747526151b774d34cf305be5447aa47e59dce28f4c59de6c9ede67742b00b7a5371cab976b298963f6ca12ee37326841b1c368fd45cf44fa2116fadd6b132cea0cd62fc71a28aea245efee6b854508b48afd4848b527cf1ae75d819dd6b9f4828063e1ab790d9abe25200848c3c92fae16c3373399cac311aac07f0132dca52042fdff636221118330dbee5a4e1b1c3bb2a612762a3c36521637de7b492531899ee93ecdb3d029d129c28bde5b14295a9af1f6d2d1cf759071b14ff4056d582a188ed8fb28bceb3ba7864aa69e55219ffd64dac918755e0b7a104e2e01c6f2409e07e5710093a1ac7c2a5585d0ea24f74b0d3c3e7d527cddd255657703b655e7f73abbe114203413ebc25468ca71446ec7272154211dfb85317808e2c1308bc3f95bce17da2ee05e6b9e1e2e20e2d0f1f12b06981f2ef4ac6a4ba94dc9d5c5a3f168ea3b24a0f389a3e65fbd6e01a16bb58293d1c0d9fc0989a79ae0950a38e88aa0c70cc1b060611080a27a676e9c6e43fc8fc3ef0298d9ff1ce9c231c0ac70c7634ac0cc37240f91f987ff3b5ae5e9492cedca42bd210382231eee84d78d97dffe78bb854ae291ba545dd5295aaae7a588da9a9ced523c16dfa797005c5771facc799d84a9371a1f5cf483004367c7ac4e5a154a2951dc76c3f7ce0028ebe1b82aef06dc9869abc0e437362f2c460fe6a433c676bd67575fad21be59dd7535cebc804a530e5c64a495895250ed3806c927efefe41eb4a08fa10dbc78f7ac70f84d41b1d6fd37bdf6c9a88c80576f8e05e0dcb42bdecf5e7a658244072879ceb6e5af4a7cfb61bb1c46e1d47b1c8439e5990faf2922a04f1c5abba070b769198c6ce88388f6d3a504f364d003415acc1390c2fd8de70700d84a61bd075ab6e2e806c3e4aa477b408605ef48565a3837be7e4e9ed29350e886ef637d420a47b5434cf38cf107206b5057ad2ece56fd504a14ba0a5a78c05ab17c5dea652fde790479bea4a715db2015d0d237c8e8fce6826f6988ea79e4358a941c5c772036e97328770963cadaae4157af161ad0e78873054ae99b1f0cc21f981ae4675667a96c3f782677d8f6f1b5b12831a5188a01dc87639e442e46ac1eb5b66bf365da47d3f1ca4a3d92baeaef980de3e361778b5bde75d4d4148ebc697bce3171910962a857f383c4e0e3b213676970036170dccdbf43247460f533ffaffa02d1897dd4f12625d83e62133422822c107768240de6e90a54da0a9392e8d9bf30841366d272149f65864b457cb7c60b0ef6c1f59393220371bb85cf46d07aca4e1b4a492dbb43c072123ac90bb8fe9c227e23b8b9025ce1009a8b47da01db3c6c9809b4c49c0ce4c13d8b53caac0fddfdf71c654a338ebfa1c3e4e4370f82fe3af11cff00043777dbeceebbfb9a85bf9ce5bfd9018a40fdcc96e56389157b6b3e928c5975743462b0bb8902a7b7af6596e44303c49e9655be2fcf8557ebbdfe02cd48bcba3c6f07c0e0f7f70143b35dcb422d6e5bc4c121ebc5288c6306d72ff4766654c0920b87ec6ef926afd60eb53ac92638f125e046729c04c8fd7d92f88fdc229f297d8b8146a29350c794f2d72cc0459da23a50d27213c0930f4542f87d43e419fde8b47234d7905bfaccf54c06d1074a4857cc07d928957e0fd6947c5ac6a61aba9535e61d949a421db81c519d77867ea4e97b53dc13ad4405944335a3bce0d02dfa2ffbe40e84a9a99333018442d5ce6c3c74624d51cd75503f7cf8d6465aa9ae9e9ca4ea6d396148e62f024869f383955ac22ba48a20dfb87210fd85c57c69c90dc5f9c1b531a36813426ddef62ca9710318d671e02e0d04c555f6fdf766a2141c0381981172f7cf12015803a372495d8777f7d19e401118311a2dc8a46159e26d65b21721cf1b0266b2cdf5f6f2c8fc567cc117919d0d62c6707e665b3171e43c27b2a3bbe47533fab307c8f32c5f9292797202d0f68f50e5c86a10befef6eaec7ecc9c844fd4346ffd571ad04e57438b2b3971d24675600a5dad3a63db8e490e29fe19a9d60e022625a9fbaf2e3c6899ae9025238fb7f11c317b3c02b8915b16c926e3c13f589437d75a83b770e91d397e4bebde90f55a80301709047a5073e23399e3f280442a948dfce542db84d0f645c2d19d67228c6eb96c9b1043b3f8f044b4776188dbc98e9cc7d24313d96a40e129dadb57f45feb4f3cc24916e703bbaa0a1f696b47d02d8221b3a800fee5d386071c81002aa7367cfa4f8fc9759ed706b110dbdc0a37906f5b9049e8de5f27249dfd9089961291a22f339cf387d795efc83c27538d4faffbf6d6c174081227454d96cdd1c7cd56409bf54b2596ff74dac65c6d69a32a84ab03e0b160a44e257f7b5a94670b8a9a86f70033834748b3cc2cdc364a7bba5c7bab420f8a841b9d3ced22b0ee3c95f90c37cb723f3d24e4f1c0e8a0907c924c9672da04968a63f1868850b15f327b94525a181b1c4d7da74d5b07a68dde9b8dbc073b6912fe489c880a41b959ce6736902f4660e1b68b52192ac4835a2736c1dffd3979b525a52a5a81b9e4b36f2a8c0f4c04bfb5a135e975ea6e82e9320d94cb6721be5d524b94110fb5e3592d55af121cea6d4185f56e124dfd8987c309a9f36f806e2c6f773b1c54474460dd085d154cedecc5256172daa8ccd4f754c3ae39c8a52c86cc8dd7bfea56db2ca1942c27d08fbc68e156671c7af161ec169acaef9d455ee26da6afd6149fa986039b85c1469fe4702ffa3edf919287c02dc7b0c7e47c7b5989085a686365ab5135aa288f214d655bb337d7119de2fea1a86607485bcd92de8f565c16daaf05b49e1ca74b445a281fd31fe7c37d4e5d68418a0835404632a1205de3c9fe46dd817eff415ee08a504188f4a2e6299a12c3efe646a84c9a0b024ecf8515f493e98f13a5511beaff3b3aded3189c01672f61b8daffe5ae648441a300731cebb894fc1713c103883ea20a196f845854524ca26697dc63d4d63a1bab5fbe0f991cda6a5946087a51cef27d04605c3c95ae46b2fdd0a3f771f4597c9cd680f8e01c154e6fee22cf4d2dc72799214aec8185fe69b0eec690067509a6fbfd04a8746cbc185624c18f862a4a090e7afc0607841165c1eb357c7ee229a4d9132880ef0cc0aaeb40b84f635e00ece0713c00a5964f61a850d59f9975ed77c36e60b692a2ee24929068e25033a090d307d59b7c0015a41d26ebfe5235a4e267d7e0801ed1eca15b2faebadab45b216a4126add12790def53cf061cbc2f42469910061410c8e92b79946c87afc1c6f6730dd116f722f29294245af9e2fad545bf0e7cb564325a8fb8ac5d17422af34818391e38be7b54235d5946598093de77449bf94e5fad07c6408da1f990148dd03c12db1c26cb409da5f7ef12b295fcae5e88e17d9f9c919f3e89489f09cd6b1ad3477684546851cc0ccffc0d09843e2ce29fb36ad71f64cd09a8969aa8a6f15e9b64d673ad5c02acd4b9db65781887809472d221f320388b3731dc1b56b1770315826bd6c3d50dd649a8245d7c3cb017e5646a1d86b069c803bcdf6265062bd688c6652a7c33c9a235266bfd9913207897dd9978aa2378b9a5699c34272b55861baa0b226f7bdc9cb3f18cd172214fb4ce03757092c4f0873c0f91706c4f0d42c26033f3c3b3993d4fba04187ec4968bdf68411b3994abe11652d9b95fdace769d723d2617780cf8d4572bbeab08a6834c93b47cafdfcc3ae8f01d0916798f00b2c3be0232c3bc6194abb6a7bdd6458577fe11a2052a421b2b3d0fc0b8770b66a4bedf13df72082c5250829956910b9c7c800414b59b54d11108be8eabf036d082c13b5a477f68c9d94bd186206ea7c828859fe7810b1afc43f25933b87ac35de724bc27240c28d5c7a0d0e9db1b97abfaa3e909cebfd28eccfab71c802caaa5ab479c05254a4b1fc7840a6ab853291e0e4b8392c7f27380bff1b82af37a4d8b5f92d38511491052f16ff8cdc5ab4d64fed08578cbba8392aed693f32263eaa01f61cf78133fdaa6fa8accfb594b58a0613f70a083b745bb978636b99e9a056cbad4447989a0bcc23a42b28cf2219b1a3cd322f980c694848e454f0c29177a18e062611224bc2947942cbb1ebd155c0a2e6ce8a031e9b67b91d5cd62aaf418416ec249210049516f081d666cce16168a07aa76bd40202e97ea62b78efc98c1e72f934efe61ef7aa7fe641c01d03239429b16e58bbcc0f7614af2930b8fe3f804a5bccc69a75800d226b8ddb0401e98cb7eb7fb7cd252d141ef1dabcb6983c01fd4cc838a68495ee41648a090cf5089818a34abf9f661e0478ebc4dbeaa9e1dc202dc796d1466325ede4ab3d5f22dae939e5b3c5959d76b72fc3f1b42d8322921bd633a85a7952b8743d56f2405d13366565a56dbd7d12ef7fcac8d15031b0f5fab79599a2d36e774cee8218fa8a53c1297360233c423a964a266044ce0dde99c90553a327be2b2c4bccbe856ee01b60ef985aaa5107ac70a7a240053a70d4fc920003fe7ced4cfa40f9b452203187a1db504a9990c951486b64606bd19b81d9d16554b00dc1c1f65e0954dcced17177b175b4f1f943ce7a885dc972c3649494c60ccba4011634d376a428ce52b97abe6f74b6d2a30210a9f5a3a7817655c2ee6b7a17c57402be5f9039a87f171cc660ec3bbb5c95f8dde3bd8f6a00d7c76c0fef2a025598aa328b2705fda5db4fafddcd9a309a6190ddb8314b109f02589e5408094db3eab67d72a4221496e5e2bb4e0ffc1058df895c8b6c0db4b9a2a8b28c983ec6916112b2a157b641f0201ea7c22f31384b763badacc996cf14e28a229a82ee7672d4a0a40e49d16ceeeee714233f05cc63dc8e1377435b549f7f9642179aacb6552360f6956a3c0cfb956f59481fca88f0cfea9d9b67ec9fc059caf19fabec353e6c6a6c06cd53413dfa26776b5390317a8c95ed4f2a8536aa6c021f3136044aabfcd88952cc84be2aab372a1a3a8837585897b2d6b0d9e54d8a21216ac8ece39f9403671e1471df52200c8e1917a4b2e60ed3e5fd946878e7bf45234595c8493ead44f147930d4928c7c5f8685e57353fbf2881cf94e99cad3f974593bff0fba40d3563e8a59ed5e4e2cddb10c123c6a5e4d3d724f29294bcc656c475597ae2e02c92a44dc43a9bf19f95383b1c313e0c29a4e9f1a868c48cfc9eaf027d4129bfda386726369473f0840d41689fc817b33d889f011f57b1d459c83e84956eca177889835dcf6cefe8848d6e7bc4e7a4babe2263575b971a61ebc0ee1a2b31de0494ea6d4c5bef29651b054164373f104927c5f582885b295a7b9cfa5747f9fb4eea6ff5b3f85ad4cda421a2f3ac8c2b18c99ff7b7638ca4cb84935507c48fc147ab58b20343c4e613b09534c760fc74c594a0ad4640ce02cf437ebea57e6d90efc035e55e8d6237f4e35f8166d44d84788bea39d9c3b93dfd85037d2571de5803d2ecee2b63c87cdc2540b84c33784735989addbd8c50decd44be33895727e8220029b38e24e7a39cc5ee0db689d1f2734e9fc4b3c403ae578eed6722b4789f1a50b0962741ad28167d175688fa0f7e5a26a52105073932ccd88a76eb038f673ea0e7c820da9f2828a5b9e534eaccd3aeb4d18b3d9e0b3ad3f6faf50ffacd28ff2f3e66d85401b600330068faf639ba4de7d2c22b287fab1fade6e136108a7890328ec8afb930722fd7165b6d27145742d320965d1eb03536d591d9ab661b2e04ce4c20ba0073eaa3066436650d9ff0660ce9f1b22283ba74db3dea7401afd87bdd730ca8cd889a50fa3fd484ef05f0da6de58e0ee4e2e5179113731fef8cedd87f50bcf103efb02eed7e17033315848155eb015ba555c428d571926b740d452866a37e0674c64467265c31235735650b1bac19028bfd1dfd9002fe7af837a36aaeb8ec5209f9d5b4b60225e1724416dc3afb300ee2280513bf9eac0d6b3af210f03d7b90595af445bae671a53ca759cee0762a7b435f1f4f5023f9d2b7e07705ffe883a830ae4792e6c620e56d9a99ec83a7b00abe2cce0a0008d8dd3c68904de11999129e7f7663102d175f3822033ecada6456efefb1f3604e42033f7e35696e4d723831467ad548f61188c312bb79364f007ebbe21981b2b2899b3aaa252eaff1b057186e0ffa09064115caa55c3af887aced50c79d71927ad7ade95d9620a57f5d1c1f68ee7eaef635677b7eea494381c60b29612fd1ef4d3cb650fcada6edb4e9fcea493d8bd99b95fe548865042432c7ed9030fd5ec474f118e45b044dfe3b1a88741d8c183c9180692cbad1145aca9d415d5a3ba69fcb8c7dbd988fb1f8d7dc0c615b894dbeda2595f88cb900bd7c6c434feee77ffbd18d51106fa4bab3f4f2c47eb5e078f324d38169eab390137d4b3b74ca00c4c1c9c1bf24b4d3f60dddb6237923fe459a5cc03b0e9da29ef51fab1134048dad3107c7a6671a43a9db5aff9ad034a006f62b28ae5c383ed44b5411b677d47d54a2efd9d1c40d89f402f398db9e40665384cf949c078ec47254da01169658c900050a3ff115efb77649c5189fe0339e817e77b55603e63c5441d3e5994a6fe464cdd4fcfded76a3f9f1edd05b10a5106d8d7abc802338743c706173fc8f07a08383d2c52d62cd4b48bbbf3a07ecd03c6b7aafd2337658d7a7032f3773714c2b19b3dd46f6c321ea75680cd621864018467f58f3c0505cb23f910704d15f75d7d1d2ba80cea52c0f01655551ab44e730980c5f8c93942d0efcc485d9cd4c7227b261c387b43dd0f1a75b64cfdd8f8ceedb15b60eef11db013c78f55d64139c20d8cd661955635cdee6b00108cff854e9c00d2faa94fcd350cddade0191c15c0973d4606c8638f02f3d9856d23a212754f772bf6761172f28d31eaba50c8541d4e84157f7e65edb75b3c67f8a36bcfe77da46dbb60bf01f28e3656008cf12bd60732fc82834f7b769bc92436d9775b3d2ebad16e24f67a31bc243ec8249c79a1c9128f54e425e72058812af30a0ec274b0a18f8678705e89e67c192665abacf5c35d714eed49a637fb8ba5412f8cefb81e80ccc7dcb61ecceb226486d44636ad57a37f4163df63d72ffcfed02c979eeb13c258df386c59c9282fe7429d06c257cf18d534fd56aa55ffcb069dc1440a374a5d6015a6c540d3521e974129e84d7e7ea0e3ea0ad9ae579b3a7ec7f0972ef94a524609e175ba0b93cfdf78c27043ff677310e35b8d797d7a711ae9076f18141883b046d3cdb313782ea73b03ba2b3acd7f5ee0016b29cefea26298fc21020cd272ad224c1e33c7f7aee59ad1b18e614e1ba158c8f58dc792adf5a52cb468047eaabbb6aba8584bb03ee2c7e9bbb2377dffcde4d38d569d40e954a1755784bfba3243d0c73252dda0592ebb1b25b1fe5e406cf36b5361c99b7736f8fb9672a29c24c2f3a806f93f5dc47070438c1b43b8136e4e1aaffb9de259ce14dedd053cb924aca57e99bf8763a424ea10d34053cf94ca32d3ad5bc0d7197916538ed35b2551c93beceb80116fdaa3b5e364b073d607aa2127bc356c0bcaa27fd431fc62b5dc66f0b7cb8abc25b0058eda712a4a9c1a30a28eb4de36fe1de8b1784381b1bc80401721faaa4a9d2001ea303c17379e0ba89580d22aa90490a4fd85b824b45ef5c77be72e81b98871054433cce613a593a6c28cdd5339ac7e4755695de4190ab3f4ebe4426d15adecc2cc82b2d9219e32eca0084be16e139332f32faeab6eb25fdf16e227824fe89988834fc1384df19b967da83c705454c53b29703c7e8a405f76512aef939c2347728f7c4b61030b9ec9df6c8f946dd8d772a722778eb232545d1691970bd44819e65a77380333e04673ad7f848f623cec87a070337a1e70bb8bb21d094b68335bdc62843f938722f5e045a4c86dfd4638290746e4737aece6b7fa6e6dbff3a238f83137fd7b3dcd66a09e387dc6095f089d29b985d2cfc3142703931848f6bc4d50fea935175b775b27bd76559cfb500ac12d9bb0df22647b123a81d4423aea70cb5554ac14cd1f0733cf7e9b39510d6d6ea5af29b1296b63c6fd874f34cf599b1386dd11e240332a060a429297b5db4dab3050c22d4641e311792e038f2d6a70462e5bb8b99c974926dac6a1396c4576d3e2b8069bb066d9cd645384dd984512dc513f910a4ce8be83e571b753e5e51030f3620f6dc0ea7385ea0c15db0c65567e65771bc73d4c449ea6ed690bef38cdc286e176c93a47a848ecf1a2a34413cde23c21c72fe373d53fdb3e031b3fec76af5eb4b944c3b2aaec83cbf693c000c59aeb31a9f96532942bb562bdfd91c02192199b0e8fdddb4eeff91df29e02ab24752df7af995b919bcab36e0fa8c9060954a28b9fc10ea44c6bf036efc61ac848b871d69836cbc58a67569ef41949d9e2dfa03001214fa0c4a54733f6973efb8fe23af1fb3266ca14e7d8b6a4216590790ae04907ad89318c052708fe9127336cfe225e5e78b51beae9e940108d5452bb105fe2cbe59531bc25ecfae8235e0e34a5ccc943e6a1e23408ed0c3c037ad4e82c511cae20f47c9d3398d54a47b0163793693019c4d4944c464e55a605006278a8e150eba85e8ab45a5c7aa258950b3de894327008d1bbb087132e7349b8ecf33f38a9f24c31a6bd8c7dc27772c07f19338701bf003771065f6eeeb32a8f57a789f859e3508d12b80a31584b4bf8ae3f8757398a1d1dd8e1610e1fdbe2981591b1f8f9d74edb22cd7e1bb3fc814d9bffd81df08efaa8274d11046fd83a526f46ec63be2d4a8a126ea1d162e422447146a5be38c88572897ba018c9d2eb84b4f43d6154b52d92b9102bd425c9a5657e2ca424c12b1e40413f8b883d8a9db83b0d45514b7680c74b53db7c19e1dddde71a87b5cfd52c9249fd56362bbbd5e9cbe5c2327a22d337f671179c6f049209cdf225e1fb2d2338fab52e167896236df119e5fd0cfba1f1fddd131639b13896f561312bc9e6b054c1596cc4677a1c3850398e1ea229e419ec0506d6688005aac4ba2fc618d6f971ef96e93755bf7fe8b6e3e5cc4ab4e07fdc9decab304253444da2fd86f6db25974cadc8b031e4f7c0ae544a9bce464b43711ce4db30fe1e8a4bbc9037d9690eb5e42cf175813582c51b3da78fdf191a8c19a270607f74e577a60aad9d19ea21ee82e976314b7dd2773db9caf47ec2b1d5e4b90ac53d3fb7f51876b9b0060ce5348ebf1f0754681c7ff09a8702b5ca2064574a0197ed1c9337e368327600112ade619b3d81451d08e908094e400b054779f3705af90ff69b5f401d386d64709113fb8c66dc25da35c1c227644a19fd130ceae66a2bcef2a4a4bca1384d968bab02d907d8651e48fc4b2eadad38cc283f10d16db0019c6aa356f31a04af8b9aac3189df266d4d4b9aa119032a924ba82f4364acbf8bfd1f1b993186a314557a5991fb587f5a1029c22a2e58337394794216e9fa99b0952b3253caace2936cc1a5928e2626572884d1dced96c2164a692c5e767c1a0870cc8c2894ad67dcc53774cacd1f4504704ac36fc91effd5c5a361130af0ebe4bf14b27dca2e0a092e805fe08b83837c9ac528ef0e06aedeb0c2c8d2156ef7b6b0d6322bf251ccb7f95783486df3336077a8169182c93872c6ca8af1f5f135b70cd38137bd2896b1630595ddf9d2fe9bd01e056b5f160609f097b65f13e9ff068705782ed3d75da18836c856e1229bb7431b30bf552afd562a7ee0ff65cc68df00583ae52673209875f47ee52970b141b78e20d5870afe4cef16804c98e094832ae04390265e8d144102b57840fcea89360f196527060d4af95f075a2b9cd702f1bfef0ea96a3019cfe86a91cedf70b67a116bf54c7fff980fe22b6318e835f52894f5d8c112f79796ac155ee74b5b9374dd84ec8055b4a8020535e05d67c59a1f8d18c2a2ca0da9d8ff2b3ce5341601de9b4b150f62c49704969fd6fa714d959c4129703f7753b2b33c9b05019dae045391ea21d654787ec121093080a564dc7ac68b8af590268577b72410cde0524ede8dea39f59bd33f442ab21f3836111100313c5fde33b6d9ec3f3e84da360145cba15aabce6222a9915cdb47df44ff3cedee37eb939978a7ca36071ae8fa09ad36cf396017cd7dc4857582fb513c4875f17b5b60ac38dc3c7593afeac2402e75fb8afdd7c1bf97abe4bba1804420438cfca07ad27b6a831ed85e934840995d5a521ddba9de9634ee6f5a03811a1652fe97c8f5c6554089b54e39f224862233f82031fe1c7ac424df9f0717fca89eeacbfd17b43e72b1bbe89006b031612bd86149a7a82e03f49e18bf3229618ff4fd878287fef88958ed6412a8c82ee3ce3c43b4d28dedb6177213c167b085b8f69a8fd65670decd16438b3255c9c26d74506d5693bd52d4ed6444b60620a89d8a689523cd996808d738bb1f578a62a910f47343ae519accfdeaf55387bfc0d320cb8a72490dadb5ba318fc19b422b2ed174a2a6b557ba31d9dcb664a6805d54246eb4e1fce8192917ff40bb11a257965dbb1be78bc1f3da869f92e0415efcde84f2d4244450c7b324ada6a4b1db018d74c9cd3a6217860b3f99a5d7668fc2ac950a8d46ff8da4eed8c95a043e2d16eb532c819833008854e9967c96f968a97d9a25688256de44097b22923689bbbe1b50841176dc9066cf812d1750e9cfc35a9c55d3dbadaf48f708c793bf75c78bf96917654c5811e374e84b4da2c3134f7d0ed0c1ca283c03f7063a74f0e6c337d9f3bd5a60eb5ea836cb58b8301c5b63365e2c3824c2b407145ca028c33126e9c627f113e4ec599773a233bbe786c3caec3abcf106b463096f0d7412774e299d68808885589dd8d2b2b0a067a3b5d8b4af88730ce1fe4db17f08cd181f6855884f0154b1d70e0e649370c899a553bece31215216d83a942f8a207d63757134f943e422c5ea1d22db0f1862c2c50e118711c29ea1117d9e7780634ee6d73707abd1213798504a49fc652808a8bbdfa0c009eba503f11ff833261cbeeb9a66860cf61e7e2c47019ae9e848584631fa1133713c761ef38deff85dbf96b4599fbc00e283ed2b9c962b74898fad16d61f32294b1690235bc513eae31d2802371bbc8d22414ce663369afa4cced7dd7de3399a88f04cf1715bae2482068df2a98112fed1c1ffc8af26b42fa1ff338d3c2b02e1024587ae6d2a1baebe0d59cb6e2d217f6cda72232a270ddb69f2c577c7baaedef2dc7d6b32bf9627579edf391ee4ab0db7a745d4c4c4ae3d1493968fdc4a11262fdf32ac79b725621ed2903c670878a30cbafc3f69cfe7d0cd308a9eb3ea6ff696a76621f2c0b89f722ad1a58f8461e48b63cee717295e71b5efd62e43f4648a4c76c639f685891ec632dc180f15f391f5828831f55032f0f0b8036512f6c86c8a8ffa10ff9934b8ee408abe4e12183596191431adccbf888e4178da9832693d1d27a6a395c53d40283e91cc6c2ffbeaa2bf05524bb433b5f96c0c7e8ed5375bb04e2c01faa860e0fb2c9cc8bc897570b278e65bde741e94cb3b025cbb685fc7936ae49ce36df63e92b752270985eeb5cad11fce27ef2dcc164c95be3dcdb418b4ef43b91eeed7ac734adce9af4453617c728a472b17ee680f26a02b2ee3b7d29c585dd6b326e1d174ab7991e4f32023ef324dc84c69d9a0306d68a1d8b0b065554b27b8c0897ea61a0ad94b53d77754073618cf71f1ef42761caa8658136818354c34d8726bb8f63613ddbdb014f9df654733d1d06bced98b2b400546d2984f88d90c0506c8066a8fff5825393f8eb8383ffa23ed77ee4b98e735709ee9e4617fb0a9f490bcfbdf367de0fb935419688158a4296c3c6f49b847d8f69c508ba4f9dc8bdc6ebb64209c66c90d9ab3c13b9a37e90fe162337507e82d6cb6c1f0c35c88a3fbcb2929d1710be0a125de7b06235b42909f497f6b7f22a68d9a85cf47652ef869591f90c4b0a4a94e75637346d8fd34bfa0dcfce6d5a5cfe0591eeb57b205ce8f88e1682227731b44c22fcbb1757ce05fb4809a84836acee33682870779a778fd7ee7f82d7a61027dab9cc1592ec01c1b25a85533936d8c51671c4dbf2298670ba9c84a2cf6774ff4035fefec46b072f4e86113b01ab47754fce0b7028a81bdeddc59c4b21a0e066ad6c1478c6a0b2c37ffa2cbfd9d93b4c06e0c693bec69b34844e72a43c9582199e1f2235a4f96824e56ffe76fbc3e46605ef8eda8cbbf3f28f7e22b714fff5d8baa4a0616f94d5624adde6059b4ad201725680f7752c80106dd4be6e3a398cb2912c9b395708d310f49881653da84d68ece9407dc9a583efacd69811a7c6be4708c6db693986845e8b9799beb9eb275f8970cae3744fdaf7c4e9eef2afc8e5d3cecadfd1b008ad40cfab0093655cbdc6dd237b88adb04f68ab68e0a4d60fb279508fac3511618efc574ffde46ca576ad5c514584c3f3809de9946d1d9b601d175c09348cc4df2c209b73e9c6483181f4b3617f29eb5745747b0212f54e32cd594d012686de7ab6c303e30f99bb4e241425559b1743d62a280baf8566f61d040926f3fd9f92efb04caa2611e10cc70e806a48d049f9ac93879397e4900b9c571200e0b3e7eae563c544e0e079917049c71e0006347327c466f577b6e31202360636b40ccc7323e09a15e581ff099fd48f1f2440d78f01586883d088d2b8760d2ade9bf4ca59e9d0bd646d9d04c983cee62059d22be2a6348917c5133efaaddc736a1086951b809ac37f91dcf34d30f4695f2a8d7d48dbb6f91f0c1464af2882bb064014fdadff9466e7f4fdc3a2fa7b18abd7b2d6eee8f716f33f2da0a0d8b46472510a49d46bd6f6f1be0fdd11818551a9b7ed480acdc4e86b73c76361843654bc52e65f454dfffc2d152a1075514fe3b9d20fd59df55101c56b65e8d0a41849989b6e05b3d65bfef6a5903f47b2f09b7d5325d381ed0ef9661fb3186cdcca29ef6eb4d33a20efd83be3bb0f203666e0c8103a135e4ae4489e2943104f1598f7b395dfb172e20b887222896651ca52a1955d5df7da6abd87f441fa6cb290db1c03c280d3d30a761b0b79d3cffc27f68b78d556b4a759219b9017ac13bdf0ccfddda5fcd62f00ed0bf5ec4b9704c5167b3608a0ae11e6240b01bdb5c90f246705f89dbd82dbe44c531b10234611827e96d2fe266be88597d9ee21d5dc8ae91c20e2fe10e1b7abaf0de259d632a6e05196c273b6de7df78649288c734bf3b77c6b51405c39c0616b4688ca43426ac7a1134c32289997f539bfdd7afd58c2ea5e37ba12d270ea6a970d8166cdd23ff7683487aab840567f3a5c01e1f86f2ee9edd161f0be937885d405713335b5d640e8c6ce7142b97da325b619e0d60a7d30acbc90f8c43b8c48980428367d363978154032f731d7cb8d820782f10da9d7aa215ee7335e0e8ee72d8644c09d48e544b21cb929b70cc7ee019a5bed659084fd74d6839a9bd3c934ef4853e829003e41b89a81653eccdcfaa3aa6c78f2e9b0f410883bead4463695aa4c554b694c717f9b31b15f60190aa277e33c8c64455f553be9d0adfc0550ef7fc9d62c5df54b6ba5ab0b34af5c53176cf0c488b79a0066135c39b0654840c43488d7790073d7a57dd61f08eeaa26463e444e7380ab5325df2a69418e6c6a36aac26a54aaff53894598f8c25f4dedf038945a0ba6c9ef850cc9b98ea48261770204392c0f502212114781c7ef7a37bdaa43deb5affd6f2e0d89373f9e294709ca4ca82eb34cfa5055065300db7bf9f44c5c541c5e0ab93060c9ca0a4dd904c1ddbd819039d5dd9c3d59d67793db467fd07ac68bd5470fd6b01ee281b7410c1485a65d9e9a262bcd1cd791b6c971003ce8b476a9ae435b07b2277ae979724f84c813d5f003e748c49a24dc9ee4d12ff34ca5505411f7e2390cedbe59f9015d6c49478cd860d2a2375308b233de492438555b33808a4e2232b25ba3e505d81fcc244870ce5df3db1746a5281f67b662d305edd981b08ae3555c12cf0084eb2eb223f12f77b11b28a9052e7f4f63c4641fdc5e340dce1c2e27d3460e93e8d9be328c744b4fd97255d058d63a7a3baca305cbf4b65a0a6c89602bcf5f7dde20dd37e2230f01e2e35605fe931dfb5ac4eae6dd77f56971b74c44c8da7a65a8b777fecb2ca092f7bbb5a2f0754438e9055d29172ec97241d6d992fa71f20c3cf2a16bc3b68872661310ad86db976954fc959ac3da87369bca65ad601ed898bd4675bc695dd5a2fb3d58510bfdcfc6b2d67d23e90f525e85d6d17045364b68b65223bcb0863a4333ddbe3152502d5bfa6e5145b370088c9003b31123b2d0ce6685b63d77513ab7ee1d221339108e2372589467e285ca4d47792a62165ada955c3f0e9489929da7f956e7201195362eb3b51960eac5f44b06c914cae1fd11a4699cd35e3c563a632e617372a4c681b42df6c2801c55e6e029dec9905924e5dd37e568a129a95a50a9c9af8353559799c8e0926585e65f7ba70badcf15abaa1b1f7a166aa5780baa2c36a05d3cb4679433fee84f3a04ddd56e5abc73d14ff3483cbb0d69f031a2e842f683af6f15abe366e70467befb838b97510784526bed381db3af5da8340307ffa46a9ddea4a287a1eb38281dc9346e57ce4cc79a5149e8343bd704794cc9a7306a8a605b8f2025c1d766de3215c8d065d6709e2e987c180de2adebe567c9709ad255fb5ff65f3e738a38458331c2ea9bd5efacf883b81039db034ce57f857d1a22a4b890c3b2a634bdcff25a312a975c2b062c6e2234c4904082bd06361aae10e08836af418fef112ca35b1a50bae66dc23efb9e2c3ebd50d0039f24347b8806dfa2c6e2a8eb1f48d9f68b030a1f870a929803c0418a9a6488cdf361f26918e7b5f9b895f3f455232ca22a865a522ba6870a2650ee4653733f0d54cb36de80af6b3bf8f1fa79d782781c1aac55e1b5ffa5cc9c0174a43bcb4364684b50835828b222aa0f5e02c9d3642b7d2f493a504d857899110cc4b124e51bcd124d33b47cb7a1fa77af4293d4816a7dfabdfbc32b39946bac0e105f0eedee7a5dd33238424a148cac22b9d0a8c4e889fca8a461a265d7ddfdcb4f26d1dc920b2afc103ba1920de31cfa4dda3033de506a9099df369d2bf2a41d892e2251f65ffbdfb877e09ee839090295e3f511c01ae5330c645155175deb69967b6ce976a6f62ceeebb6d336acf91289a30e99683b0bc89a5af844543c2522dc0c77e2ca68a2637f31ef29a3a8e3b6df7092d7141c7c5772a8a75e3301c04ae3d1fd95d13d588821c40c8aa69d5d85abddfdb3ddc02bba46baa636288876b8a0a327fca9a5ff46a6fae1443f63ff376e529d3bfc2829f907234112e8ebd26db4c02b92e4c757f65624ca7cfb2fce69e101675f9895063d42a243e6f9c24af814daa8e12ea241f3c8bcc85d94d4a2e6b4f0ec3019e7e0287750e0d40b0775f29f55bf808a733fb798527d66029492e060f8206dda9cb3fca852952366e47fc22c2e91fb15518546bf307344e28ec64be735bc7f5ba48ef86493b2c732c2f750b5907e5a51f569da41b1dd19178ef3531892fbcd07cb7f87bc8281524ec16b5097c96f719274560b90b25bd041838890cfe4cc8a45db5360ce71f2bcb1d19ec6483f7aa2f2d63e7bbf8e9bf4f00a1dacb95850aecdac00bb0a6928d61ee97d2770193b98a016a1e6110b5cc77db291e4ec253cd72a1f34ee24555f3b8fd44d767ceca5d1b508ea1bb245aa2c409e52f4fa0f57ee049d8a7b1cf1415bd9c2d9fe0a6b224ea715dd5fb6b878d050a83b62b40496c5fda11e81d7079f0692ad898b770d33947397dc2b2c7081d87cc5a186f3bf307d7ad84e469e3c00133da47fe3b505184b4e078d9c69400c48ee048e43b5713070d86ba441133a9427485f6507c42f69a55da8bfe548b03b09dccfe37f1bf5a0133a53a66b5fea208befc22c6c16d0a4c615ad9e1abb0a4b4b7e43b391eea01ca8475ccd02077763be38c6fc0a2ce07419062dc933b2e10d1938ea7a47b1bfdd6c1e3136d70634fd5bb967ba00c087ebba8afdf44199afa8c3d3d22b5fd98e388d8fe50e319a8e4ba26e6061f9113ca83f4ba1fbc639047e334e6179f6ea4964e3bb45115200c6d6cbc49f8df798b54153ca6659b07816ccc9776bb56c1f8b115969fb1ba60827c15508845a31b5a7d221d3dcdbe0c2c580e3b0a10068cd1ff5c21550a657e5fd325161266d61bf5ced6a601b2c8945453f82d123228cee2fb29ee7f8c92c39468dbeeaee17677fb95e5b78be4791f39629714b7fc4078efe1900de09ca7236240a6c94bdf045cf6ae39be2a8ce1a2620107b8e82f5905dba36ad44e60257e1b41732dddb212d52432d5e524e989195b95cc199f101f6d33a48f09dee0a6988e1515243ac0177f6cd003e75d05a6bf6a8a6f790df7d8a6283127fb5f9b7246618225ebb90789c2c77be751f3f1ef03928f85314eb3c884094db2479070939978975f7f82df20eb9215e7812c942a79291b5202bb0ca3f95f6bc6802e1c761b9253419b886d156f5df70ea135c909a26f9b7949c54470fc1bfc75a318848f7513caed88ff4dbbefdcd2e6ef182a0af7bcfb4833129e4b67d68771b69db9e6073a7e8efbab2f7374130b9e1c7edfdef1841dddee7c55ccaee7957ef514f7141dce6061812c62ce4e1a4dcccd3d49ee07263ed99a25026e0272ac2ba94fdc2c041207a20dc279c54c0b1cc403be2d7572f10008bf14e482ac6aad891e9e2dc6d2720738d0ef1b80fb3f7e353d0a30b60e27c6a8ecf974dba8046de38f9888c078468520d81fd3307c72682a53120fa09456446452bccf6a7c33596023b70061bda0d14da3ac5d285fbd6a49a7696bf97a4823c1703be36c3fc9cef19eb2b0243165915e8456ccb4b0f28df66197c57ebaafe51944197b6dbed2bf1a37d5af5f10e24a0e55bf38a8d27b077a046e7c258fde4e1462a52d0792ee83c3342cf4a900bcc5e7d9336ef2ded3fa36c09ac3b5977a249d5579125f903a858871c39d64a5c2aa0d3253ca0b6bc72ef0364d30c23e70d48665a4b74591b7b9104f10c79b075591299348cc8d65c02f697254d64a5ea80f3da90805c1f3feaa157aa1662113a0265788e4974dc0f0edeaf433f1bbc5fe6e1721e97e06502e5d6ea56f389b3c9253238495d387f50279cb55f5c181ce9802acbdee96ea5852d0a6e7cf580faf75258a50dbe2d232222dc9452968eba1e37ad14134356508391da5767570903fc88fb83e1af6b526aae28ef5aa76a6f15d18fb92e88b8965cec15f2019dcae634c23876348f6403eef73e31594b2b99ce2bde3bf2b6d922fec1e272b8e88fa380d1674a0ed0fbd93fc6638898ca543e36074470e6e9931da7fb900f40604b08be55240193fed4b5d0c4eaaceb601bd1399cd020f736c2520e82955fe149084b63181635edeffc4ed6f2c449f6c97aa2854257a06599146fdb5b886f0540e74518ab49771ef8d0f56d126a5382d85b9736b4fc5802bb544b24d6ef907bc78c437beb316144e43fcb6ea59e3557008f44dead57acc2825f2dbf15a60459fc24129b9c98c80c841c6cc96aa72ae5855767222baedc5c94c95a56a609f64dd09b6c003a82df11dae8f026c76ff1605005a0e7b35a3ddaa31702e7ff29302c35107d975198323a63e1eed81f20d8b1d7fee4a175ce9f7d39a08a64a2188a7612879f06e07f164da39ac94a6218ae41fe6de91716d768658899bc69c9f545a313980cc671640173dde3a77566715e4e7a88c12d8ecbe9309176a2fac64b5f319b8cc154e954adf987bd9ec0a02533904ebdb7584def7da0b11afb49aa48a9386eb84cbfedd792ba2fa55e233ee5fedf9b304e064bac79d960007e18fc1d50e4241dd01b53ee7f11c5568bfbd0de242a33935af66b962499bfcc174433c4487d5cc85a345c2372fd1b61ebe7bafba37923275145eeb755090cac2424a9004459c890730503cc790f47cfdc68b05762a753ea7dfb66fcc606e89b6cf3290140c9a802ea5d46d82e27d7b8138b5af4f32d45949f1749a2ed05ed06c2673cfe85212b35ba0464073a118487c76a1cdcb9437903c6bcbdc04d8770a1cdfa0c0d9d8f629231216cc997d2f9724015460399d5104929332bffabc9435663d928036071f255a04b42f68cf679aeb6c5ee3de908ca26c871cca6b01a0d0bf107198b01fec03f8cf20cb2635a7c5aa7a24c3cbadc5bec2866d030aaf8e5a5dbcb11617023ef1e599919ff4a999c1fe283cf70b72f4b47657b0bd3b62a27494e54695c313d5c4e789cc64cf100846bcd915daf6fb1484300e744c050e3060415c2faee22583e83b864ececee008c501ef3a7d8042941b2d73f177f6a2e880886c4ae75b127dcfb6f9509895a0e91cdc709b3d1ca3c6030675b737a4e34a8001d7a7ddce3bf18efb3c0faea049ab08b45d9fd6157f198b7b41bf6cdee1bf45bcbf5a90f10881ac6043c6070532e405f2652dfee2633889c6dd7c64a1eb2a429e5e30df644a9d64a03e8c51c35fd35f1afffa523b6100cbe8b2f77cc92071efba78010a55a167bbac9bbb6c18c774b198ec1c8319d94b9bd0d5ae2057c284e8ee37be0dd99bf1cf63899145b9ff7854535c32e5504bce1907a3a735f005b39272b7fb044b6826fcf5fb30d8081b820232b08d5db99c54646af5c130420526653dc5350908984a9c82c6fb4107c0bd1e092ec436e78d5829c40ee97a7cc8adf8eb8d48db5282c6f008d7c03b5940bdb300efa823088fb5c6861b019e0b645598b953d4060e88411a0dddf5aa5fec5b2a59f4e060df10ae2f51c201858e9c31f9b78762355dcdcb616f4581acad1937661bded780c98c990264bd3d7863ffad75396748b48d46da8e8fff090e2a6acd26c64a1cff74319e9289a2b380b76e71eeb8991a9447061f70ba8f1d80564ce074419cc8267b2df46d92b64f06d014a32c29cb32d86a54c35bbc9b8447eee8aa16653d4d66bd22224733daa2c8e0eae3982f311c812f2f72050a2a809c583f4a5330f82d655c8e707dbbe0717f6408c159ee977a47828ca2531724530b6b12ee8daf7cc3b1036e09e8c802b8e8c15485eb178b2c24d9fa12886db882cd2b549581980bb74a243b9de32d65c29a791851bf1d291a26305be71974ffcfca81301eba7adac4974296a9d7a4aad5031b8f226bd068d58c8798b9ff0c495a248accb5126005ed7ecfe8de74dbd9bcdb8a4dc6cb911ffcc910f2c6dd055c0469e0c91d498b4dfab17ea4581c5ef5a991766da6a03c74226f73016b6cd167abfa6287d1593407b961816dffb2eaab40244d02f52d926015cd93bda937cf9240703690e90efe1d66616da349790433382348a9d932cb070b8aa51aa413643687bcbee633180f6447a75947043e6b72fd629ac23235e5d877f86808af2aa42d2fe6c221ea5d2204a6ec099d22ae4bc0c695cf9b34d2fb97b01dabb54179f2e3140980071ef1e68e88d788e1b5ad15cc960693497afd5de3bea29ef910bcc76cf74870de5757e242565d1215d65a76234e2b323d8b02c67be79d6a660002eaf23a4d96f6a292527ddf31242aca3049a1d098e154b31086cede909aea900cacfc01238262054395476d1464e79d87245d079022506122ab12cccb164e744e93e92d7f576718a21ab6a54130a2c0322dd541811b3b75f0bad3f65b52074706914cd71796613d00c6cd980d26c00fa816397eacc328985749491a8e9800fb336ff3adb543594b6a965ac2e24f998d5a029e56d5a8d8326ec0a770d0f8887d7bcbabe7191c6558559c36b12c89be245b65738b06bb53c3fb79df5c8d33be2c457187d071907247c800bc0ae712c22bb52a3a975e70b7359192106f185fcd2112896b9828f5d12360bd4ecd0a7546c45018eb28ab281c57d155330c4e1c578afceaf82ef16a29178477e0f59af773b1917a03f49d0871fd9b7d362e8e1986b0bd52a8cb08ae2b1949cd7f3db5542970bffa80ff3e9743fbce5e7a94eb760bae3002b1156552b4290c3e8375207fb102dc69cea69c94126d1663e83a5eb8ed4246e06ba9c48794196449802024f6fb05b9d6a6ba4a56caa66cfc53c177f27e4b744110eedf4b00a2f231a38ab281588860d381cc04d1863ef8cc94784e01f15b846b30076950f482f91f86c32273807c32b6f69e784d87704359cb8aec205ed7ce10a682145a7e2966301c1de3eaaa5f06d4c49d8048d182d03ea6b22ac39db037d79db17d0a7f0a5694c9598d3873b3f0076e71597a6a13da2fa2362d282d6d7eb30e05aa654cce1cccab643e1899e3cf268a89cbf4d1a0b362905cff62b93c42982a1a2a2a3b2b570d226ccfed836317e96e70e93b7c28e03c4cd4e032a6783d65655a1a8487edb35987c60a56f3d6564e1e2820f4f8bc3077f250847fb512987591af3f4859f12404cfc770aec4db4e1ff53c4cd7c4912f0553539b9dcdaa0a51e12fc84c714e66455d77507626aabcd2cbc49e49fc817895282dc4e8186b15e436ff3ada3a26853a78a7cbf2a4e33aeed44383d5b5f984ae8abdca2fe942f3f8961735b2fc3bfed862cf1d2e4f227498309a02f12b19617770e34e12ba92c9cacb81107644b493353d25618440ea7add7855ef96d58c2e4c1c6a5fcf9d40dc479e32457901dc9870dd805a5ce7656336eca3b15e40dd9daa85b691960882e8fd2d160ea899a62ffb4d64cc32a5e667a77e91ee71578b6463590c3b8577c0db2f89d4f451f8c1e16a292ce0021801c6cd3080cca65262205df83776306342be6f3d60e34e0f1051035a1198a9c72bbfbcc7ca6d2bd767c4ae0b12388f6e684d399219f0419c74f9b6b80e75bb6589049cd788cb67ee46109961f3b603f22640228cf25ceedbe777b8f8234ee23119d81d5f35a710413072a16c4e690b64f13a736d6ba784823f9846275caf173f1ef33eed6c98648dfcf85d00e5d519fb6b6f1fe49745e889e039b5392b1c6e73f17fe8aa87d74cf02ee6c5dee168115251d5ea5b58015a3696fefa2a4f1a38bbdd29f655e960c5a72e467d34cc76d8ef6e4ec85c80146ec7a97bb6a9b8393b2df6feb7e6f64f8ab4e7867f9cf14f77fbe38d60e4eb2defbf3d5384c42955993127173ff481a7c6b826599d91292089b8414b54ee2546ac2c728cd2f96e57cdaa04e0134a51e723097976a7050c42791329a03bbd68292fa4a50891784dc27d686cd1674bcb060c8ee48a71f44d11bc52b81deb2708ca25f7ac5a778640f4836a382084f5100f25cfa2cff3917e9dc592350ec9027b6218328b6a4aba9189bfc10c5279be7d416dc916a392e709a7625f5a158093646f664fbf614c5152d995c037bd4f567731c7617b67841b6e2a793fea41b0f87d769201b59dd91b68c34c3a100802dc94f6e25ea64a7d84a1784da1260487e55e7eb6a6b7c478c9c0e7302b9db09dd6878a1a9adab92ab5fecaf5115129863ea71c29f965439deaf13465b3fac3ce1eda9c26858c0b6eea1d8af8549652ef02fd1b716976686b7268143fecb31181121bbe1118d7222a897d0389e010f1445560e7be56b6ab00e029ecf8e4d3ea9213015013f25afb881e275ce1f2821333564b9327114b2ef4823c07a00a9cdc8ca61c392d67ac32f8f4336f3bdc49231b43d2236d01a944251f1d4bc8f704ba39fdf75d983b272f2fcb6b8cfae971da42cd61f21f213c2a21c7664368719a239938de73a044c1d66ef7684923ea20012135e367af106dea3daa841e5c24751fe174af800da8bae518610dfb36e768437f41195003badc87aca973f2843ca12e1d1c992df0a59af8e7233841b4809465c508c3d951d55e7676463a7507e5903644f56c4e464be6ba3e7163388e1e3cc36b867b9f5c7ffb4160788944969d6124d2abdc068e8a1fc70a3143ca77e61bf30f422d18980762bf88d6591ebbbcbaa89584e4c4732cf46be77229b4461696384bb49c21c20a43ddaff184f370fe4e0f6641d9d0a3d8c3ca762004404fb3fd9c69a3375d93c1245838c16a1c0cfdec466df803b31e1b9043888036b6c27009d30ede4349e83d239ce1e1ea3c6d0b716d0eaf339be901bd21913c8cae0a436b91f83c7769c2144ddd8481fd475667c4b2f7ae161e3ff60d788ef1adf9f9bad25a5d235520dbc3e8e19e9d13f20c72e625b2ce7d2156cda7f470c1621b2aa15538235489af51c2f6244a06e1e557055be80ed04f75ab78c3dbef8adf4bb136c9ae90b105eaa365e279b5f9f013c1e7f8b0791a67cef1a10b1a25cc4668b28e3838e61c703f47e13ec19ac38233eb246ec5dfbf0ac52b771da044b6afdcc0f0df17be4d2e7660d8804444421b8ea095ae2a6850990a70ed3a197f9fe79fa39014d9e06e26e2dee00ec26bcde834a8605ba05907eb427058fdaced66a0264be701ae19bcde0998abca5e7d9877335d50859b2decb3861b0236bd40daa7c575d3dd24ff5b728f64c1dd4934d98f34208c71fee1bac1e1eaaf6cf082bfef81bc7bf2724973d86a3004631064cad9a6d0c6e46a7daecc2bd56ed0bdc5725506a0dc26e899b15d495a67d8ab6ff139ae222ddde3a740274085442db719f8bcebf0437136cf14bb1c46935fc4249abac308d87f108ad10054b431e4c6338c48d0bbec7090b47a0cf987a21ddaff1e5dc3709cfeb0eb2681ccd565161b2edf5632c67c9294376cc9d16960648ad7c595255f8e6f5bb971ba33634929fc79b652333613f976bcb60cd648ce74f40c751c6eef7486fe56590ffa07b5c19b732a62f315e697c346a579e36ac0e3436e4e77a54bc965346c0ba4ab3215c4682a4512aa69144f1571589f4bb192aea7537bd60f0e24d8090c198f667bdc253079edd346940ae024bed0b8aea1d664edc36209ea8be7ebdb5f7be107b26c20cd41df6dbbae67f1fef152ad9206312e4cd7c912a8a363e13e47fbbc3851aabe3f7c39e7eb17a9b3d34ce844c72cc989c0ddabe2aba4cd1615b58ef2392519d44662e78965c7dc72273fd0137f9039c0c7412bf0dd7f27027b6a5f389e95cdac7b05020bff795b3029aef1c3ce85d1efa114fdb31667204526ef95bc30f91aff44ce52e121278c9515ad20888966e20e417927940c54d65d8b76a8ecc15b69971d89fccf229ced6a934250df1c89137b53a8bf852a13330c74ac77f98e0f7e3d9936fe56235d190fe30ab2a04793a6da797875b0d7f90b63c752c96319295ceebc41c384cc166615cb0d1195cafc9d2404716e7c75ec8b3f4d0b1736731d4b92396e51015a96970f3c482ba53faeac64456a5deb4ffabc4338d347a2b477505a830a1d125be4a20506219eb103280ada928c797c70d463cc736c884c062d6278d24f6f00c68c8e3082a96b7638dea8b1de0242cfa9c24b02060aeab0a8d664166bcf5cee5b893f4c2943f9c78eadb07b497e09f53425ee15e85aaf639cf1e78af0d202118c3943c757a4f81cf04c2a415a6e9f572523ce6584ac6abddaf7bea3ebe59839a9a6efb4441878bab141e3fef2708c59e77640dd6b48cccc4784899a2dece32a356a52131b0eff61a1de3cee12d8f619c51ff69c45eb88cdd6bc3041274e2af52109e79486b6e3674dc4466a8ae2e17f0e1fd12c174d3c7c005f640008e879a0c37596854012e5151709146f31b60a79f628779d5ef788a4e5aff83de4f506739934b2d067583887ba1ca3406c7ef41335952a312d4a1ba1504d1ee8d26f029d216123a29e9391490efd6fae237dee329a45cf1e3c36e6c508976422631435fffebea9798e69f270dbef3f3821b1950613b7e7b3a1d2f593320665bb532721f3665d73a882e2c33d5eef9d82dd41a9ad5e15d19335487bcb9c437445344fb78cc9d230f6017f6c315f4e2cd73e38862f79ff35bda70f4f28cf6ed114ccd2dc8151d8e4f129d3d056d3f2b9dd038f11e9ac2556247183a9eccf1018fa911ac3b77ffeb025a9cc4e1b5aa62e16f37a51781221b0fe6a03a6224c97ef96d309824a59b2c3d9a9309955ae28bd10d6375407010b47fc6ca155e6512f4bcdb555307d1741fcf62ffdd6820bfaf70a377fc33895d16cf704acb6f55ef918bfd216565de5904ab9803809589853b08c61bced75f2fc688bd30c8dcfb0d0ede16e4b331e6f9cfe385fd78f6ad80cb8e6eba3a2a9170889f4215fb9fc3da5dbebc73d41ca8bd8b446e18a37b8d81987c2f0306a564898a03faad8d0e9694a45ef9a8e77f37bd5ffdde5febde2680fb922cac419031d0b5a659f7c2420e2143d4d7f89aa3213d218693ab07100f0475547dfac58b2bc8e75ca648d914671476e1e3ac1fe51e2fc78ffa828d3ef1636edb5748930d46335d2f5a4b981ede2506e6f3805637ebc01f49140aca4d892636fb0403b2fb15971fc6de6bfe61f535e09afacca60b1a41a07dda4e8b48fc9db40823f10fe789438a66cdd62c0b77b6cb641ef9c3672fe8366ab5b753211c9481ae9ba1651431480cab3c22663e7e3b4fbb166b3af6b741abb409ec25d96939748e6f78527eae0d449646139a5088f42bee27a6c91ae8316bed08b0ac07e365a86381f9c49291d7d9953988b212e5113f4e62003218bd7f3a1cea56c8b97ee2f15ec0e3c9f51d9471ff517358794c085aace8fb259571c10e54f6f730445cb8868f1c0df0f4e796764a9c649a00d357e2b3fa7a3cae67b43b1f15c486167722d0ef176a2a289e1e98a1a9d92bb415b6c7ca7700fe6fded52b0973279eb67f181c25593f02c780191dd4c5779162bc29b1faef3e715265920b13e3c75863488194bda65daa5c6c408182e0151743337dc12e93e982f5bbfcc8e6150bbeb71cc84d41002c8b489e0d035ba6d25153c9788709be02a4906cf3969ae150f856d43559e9e7f7259be794930c27de8fbdc02b9e27c4195a3accbacadc7114ef8c4f8cfc1125c8fe4dd9fd4abdd029bd5e8435c720b81a9aa8307d8e1b7a7c2ff855aaeabd0beeef999f1d5e767f32749c2134b806acf4a87290f4f04f4410a095bfe3e47cf3d0d2da00a48822e1a29480ca73cf2a52c693087af8ee4a8033fdec2017b81b44cb516ba88719b7c3adf42cb0dc7e672fd270a9023c4b82db7a5a26a6b243b843f2138ac36282341598d9a596d3d2f521f7a9c76acc6829d01fa80f6001395da4baec7eb05251e466168b1bdad9025fae2f706e57c5cf9075f9d9d769b1606c228ab19628dfe97830eef9a4eb20f8cbf9952fec0ec11213a14ed7dffacbc4e6d1622f4984f396fee5f939e9875c2b3473dcfc52bddc7f0dd9ceae36bd491a1ad3de2a732611708f6a63e27dbbab363964b4e65b3d67d9ab1c5949ebcd2e2d596efef1196b600317034629e9385eb70c68d88449793a0e812d09cf3106926450007ddb8b602fdb8bc66638cdad95ee24ec1566d465745461031298bd0bac759fcd20b5b6941253bf3b6dd67383d5ab5a54ecd8a541668dbaa41429c189245945016d07e16ea9551f6e4f758e7343c01a18944a8c48768b0ae1955d9eb5a6d85a716ae918e810d721a30672a03de0de250aa7cf25d4d5a7a5d8978e80f1d14810c00eed148be0eb0eec6e985d3443a4d20096567e42f31a59477f5c23fbf61a14dab40e8f89dd0a49965c4a2b879979d748e98dab3a8499284efb1a1bb4ecbfbe027f58151bb12427c1b2ec7a17053e283307c3d8dac604636d0fcdfaadcd459305d30e2926fca1d6cdc7a47d08054040d4af2211a6d6bb01830cc2d585b2501d64cd065407437c0a704f4eac6c84327becf58b21b61bde51285113523cabe1817fa6e517596fc28ebdbfefe2ef53dd7285738ec68a5cfa7346f4d2abeb09f42b72a35e817e475d1bacf6d8a7d345bbee94d9291e64378776123798a03d60129791caaff80458881ecc6513fd44ed068e96eacfafc7a01f07261ff5a5342867669dbe2a2bc726a9e4ce978d746ee18b3bb0c99aaf77a4ca91023357f6d8f5c84bc1edc34dbc5085ef1ac0d464ea3e3195fa06608ea839796277bae78da9001f08ee7d26cfff6016a508cf0bf9c302f7b304e7a248a78e3ce5d7eb883f23ef35fc2f49b8887c69a7ec1d31cf20df59e18d6dcf66bacd113de042f37be7982e6ab9ac8a29c144a9ad2680191b0bfc440f3b7419aac0b9e054e73ece5918bde6a6ad5a410fc5d84e6af33b35a6d18a0921a2ade19183e287aa6743e1d5b252b7248e34a6c73aeb12129d3cb5c1f4eb8f70edef84c1a611deb573f27f9ef2c6fe50fb0f9537cbd360f0de0f5164ace8f68656e95a257a98cd4e514fde731628f4d82acc98049c49c46b76a8d1f153b7b8a4af6108fc44e781ae01bf924e2ac94ddb585898e084575a5a1a6a90b198e9e319f62f79a231aa0766ad087d7154fa8e4a1fb12d02f0cb6b7a65ab304d2ed28445fb41754ccf395a0a2fdfffb744116f48177ec18a9ae4dbb8cc0487b81398843314e578d2540760a8ed7576719669afd4e9242116ad0772cf0aeef38c53e3e544699b66792717a9b2ad51c1e52f83283b32d14005647c39f613455188e2ca6ef7e87c3c2499e06f4bfe233d3fb3cb35a0e16aaf9e7e38ffc5391d0d9ab3b16face61065b8e643e03e95b14daf60a38bd4b44bff11b27d7722576f6176d3e681f36dab2768397f649ebb912db9eb6219ae18c73e12575a803cf0f82995716b0eb14da920e344c5cffc801dd5be84263f0c0a670d0d52e4f7e4f84f1b40a946ba5a008f052c2928c7ce5278c146bacd2679a269f7efda0a865a3d9165e76167d67b2e1201d2dd06864237fea781a0f216fafe792e9395106319ad54663f36b9f5ce28596af016e0943d0846e123c44d5977400e4ca79fcc3193345e25780d50b45b7753f1cc8981657a960a356a418b9c8be052538fd3096f840af15c85d636a16909fd4da342ba9a1815b95d76eb310c215f287276f65e094ab4102bf6a2dedd3d5ac47b06ed4cecbb14036abff066d0e3c70ab0eb4d640153a2b5d072619fb186e014adc2566c2b12ee22305b6ee3a4246b85d28c804ee685f89316597d3dc6dfe34a2c37475f6b9bd16ebbc2726c1c752d3ebb4d2f9186a8d9b7a9e1eec125745726b40f7513f38933e98b284044fa063ee5eeaede0792bee5ddbfcfa3e8c7d106d11a965d955ee56d0c90a617c7efd25dc8747db3fd27fc9711ce3a4d21e3d7a5139731fba85b5e266293c436d0d7b249ea3a94aa14d3855405b1e5f73b45ceae3f2ea338ce6ce1fadd12ec38b5b1d7a8e0409e4cfb56b679bb43e0ed873d61528b400dc1182162567776d6ffabccd4af4015115cfde75ce4246f3bfc51e404984df7062808fd31be412eca500fa09987ee142e9c7c5de42bc111a6a26a06c24c01defd98abd7c0070885fa79b2fa24bd170d6207dd5ca946a60551ee1eed4cdc137358dab1dec83c16cd1cfbd1e020c519e9e03ccfe52fcaf7da7e3e42b27b251e33b32e90c024a04443286812fb5e8fcedbf10ce570bf78126e96bc896b8f5bbf99bd3b2fe3989f0be56e9b359b6ccc8a6790f83b3e462d158281b4edecb135d306fbe1cfe3269c876f02fc7667cdb25d96b3370237aa559cc44b893fa967c3f6fa5bee51ca22669c280d6237c45348b5feceda27933bc2b9fdf75f4273fa4af6c04a25d44282faba5080e6d7ceee9257fe27728d0c0da482a2066ba7d510517267b7378f7b8c2a89c08d3473048a4656065b60e24021c21ec091836b4a78c3b73f0f5433667841010431d2acf82e682fd2c1325abf9459150b569f56a1b2af3f73d0fb0b3f7773d152e7b069668a247b12c817052a98197fa8cd984fdc00deca410a5d52f635fccdde67af54423db49bdab3f2968a199a15faffe35baa03e9f2bb597c74b3b03c4428ba784efd33512b0cd49ae9b04914915a337cbcee969bc5de485f04dd3ca42a90d3c0d81d7835393ecf3b4873dfe503ea0211d3da6961083ebc5c405a90fdae1e4d51e8363847751c58e60d5c35a050624b8de9336afaf3ec76bb46ffeadd2b80daab24731f83cf5fce2981c406f049cb356fe4072905c40059394ad01063df63c13ad2d92c45028ed5e4f4902c06d1c8a8a165df2883f4f6e7fba95a7533034bf2d14150c9c7fd73d78bab7e9740b596fe24dbafeae780c0e118df4a1d9558a6b3b6f5d78556381f659ee2952fdc5c5738b74848f2193c10b0abe663c4b0b2b99637293ef2bab2b64abc61dcb96f07219fcd11dc2fe0d0e932f9faf38875dcc18a333745a5b2e2424ae2a8e091dcae943c82f3086a3abbc6397ec8669c40e05d52ce2d2e598f89497ae0b88c193608bfeb4972de936ac36eb6568c424ee180df6e1c2a66ecf58fb156057cc9a97921ba677b2687ad26bf9894c5bac31a74d3dd7826543653ab4168d301d5e8db0d80d4b303249a3928674dbb4933648acedf8cd5c27bf94e5ef3bb37b602b1436c1edc4ff2a66ab73d058ed299a6cc3a852f816639a88923d5ce31f3b9aa463e6f45ef27b74a0b7589e84e8db64a9fb325dcc066d85ec178c2e06fd68c518916d4297ac9ae8155ed14f6418ebaf7fb4e4b4f2619584773d49f5dc3c00d84bf2dfd1ef6e42fb4a5723d7577d06953792989741606f72babde11ac7c62a10f795b7324c5a6e837cc7430478a159b6d711fb1b68507fe1cf12865c802e38335fa9d0fc0302a7809b9903630b15d7d23a6fdbd529930c587d400f8a4f1b1ab99dab4a84fc8f5d74c8ea49316a52a1c824c3b1cc263235c65430924927f75725905b325a1ba4c149db9be46b5e7217f6eed8c326a4501a03fb4d322cffb81236a2675a7577eccfe44d1c8f0738a513f502f97f943f3c374d8014823dc1e4b3e2fed5f84c974be7a56484777b556bd45ee41725b4932e464ff3121061f883c1e345e0ca42e939f653f09402ad3da7ad7786ef9a8d7f235709e379eecc0c18d5a0a1ab801d11aa7eb99ce42abf4a02c4538656011822a235235ad7cce5d4d1c290078cf106ac2d1d8da5c86b8597bb53ade8030bcd0b3cc06929daf9716b655d8da27f1d860ac8f6a90608a6b2cda95c88aeb1f1732fe3aeb810cf1ec5e37679125a0a847844924f49269e2d9e5f3dac336df79fbea3b9f13a3a66cbc4eada1a175dbd6cdd7bfbb52fd02c8d74f5e53da80b995f9fa94524b31bb9540b218cdccdeb9fc84f5689cd847ccf2315023325166f5242c3f18359de67ac49a171c6a4f4fd24b3b1660a20ecf11f6c3a55575ff914d6f800caaf584b5245a30b7005fa52e885a24cc281cba8e12727420348e28fc31766b22a1fc0e0a146e38aa67b72b8cd5018fec679abf4906df378234865eafb8a5dcaf7cadcbce8fe9438c6f7a78eec25a1866b1eec188472589a7ecbfd676677fde18c70e7af062079e28cf17b4b08c249a0cb6412582605761ba8effe57ffcec7f6aea08c036a0ca22c2a67fea58ea411ddab9d83e919adea35864526e52d5952d632b99be400ca58cba33a52e1c8d9680330e749779fa0cbe041459226b323f40f8314e58168932adbca9f1429601eecefa4d20a46647d675f5e06082a1b93f880a89dea0dff0ab4e91a9a9ee82a6a9ad78f6fd0bd35a4570f38c8263b6ce44d1df48844ad5f1d7af845f2f9699f7619ef7fa8678a2ca62caaaf128c63947c9df5e0391a4f84875e5977cc7acd27d24616ce8eb965de06960fbc499cafdd0a5b9d3ea5836c40522f9319798e2802072f2bad74e7e424948beb0fae868cd41a66451864f3fcbf759b642e0857bea4d60813fc49396695c5075b429a62a95e6726e484bfe0abc0699cd072df2246ad6d76923876ec4949721b74354826cfd4a8b3f5777890ca7affd87b8c5b601e35c8737c893e09cc06d0a44d08904398d8bcc98e80954c2837f37f3621d6e4f1f031e2f8435e1c5f1ce40b6ffa6097cab81fd6f89610d7bf9143681d3567224b8ceeb1643c5b272a2c07f5ae3a4ae250fd2e94e8bc7886052712c5c6f16519e7fc2940d63c0747c59c73489b166020350bcbb9a14ca710c155bfe2be9579945a2affcde822180a92ee63b1edf985184739c51fe4c9a758267da284e5bd0ba62d0218d5e71ad8edc301fb70e669bdd2e27c36bb355ecdb4217d89aca7b9f42ceaf514ae718e5c3decd3788d29bcb278a476b1f08a83ca7e287e4656d8a95b98a2e0caca3369c4def5b98b458e1df4619566ec246808377ac1fddeeb532ea79f6c39b63abc122ee8c50b60ca497d673fb2bee227ee44e0f018e7c8449e58b091ec14c43a1c361a712421179ec136e2d48eb555bbd402c6106094bdb5e32629371f828ad1c97c03934415ae974f0087f5494a11748a24f082018dfc117af0e72026459cfb92ab8e12e49eb8fa523a096be2ace376c2c9d79325ffe0e78041c8823da08c9efaea04d6850fdadd59cce0df91ed0e37f417affb801b846e869066e5b8d4b35582b0edc672cc3ca6db11997ac89c72b7f036bee49359950c313857ee8cef5e6df6cae58228866c046d0a62fe8502cb32954ff7bfae35722cc59d7cebb9ff2096b33cc6d1e5c538fb3b68035c41a6348a6bfdaf0d2b01522aa85354a098890c4c42263b31009df52685d414c80be03b01bdd662e1b06419c331e5f4f35d006daab40e5c24c06644a28518e2557aefe8d01cd9a360b82e09ebf96803c1a916c4afb0cfa387ef27a6f1229f7aaa3163115136a06c549d88f30632708ea6166286d4d0ac798840614118b7e81a1e85f6299453b7b3f93d69ae8dfb539a03e74e7930b5fbe57e65dace08a38df61fb85d2d4abdd2dd9cc5215286ca35c9416f40abd357176730e9eb87e2dbbe2723367f079dd163008e20eb7c6071ddf708813a38a69f5f5ec239f47e51fb1f1ca45b2e45343cddc84523df4c03df68b20ce4819ccdab49f3c51e1c48e221520966f8b5a8793b75f06ee5c5258ec5f05013c89b13239daa2722517fcad97418e1de83eb035a937929d45b10e583902779615e08f9a86379e315f6ec7b741aeedf621e860ec5ada190c799a152a502f6a999fc243073a2fb924967b2d4c8199402b728ffb1eb8a8baf4f153762e79ab444c35649c1a5c3e2b8b3bc785dea414419d9f3d6fae4b0d82e29ac780788c53df473e19e303a1ce7441c55f8497fccc75d8c2237fd52b8a9e055896917611db6ccf5e671961ee2397373937602b280565e25435163cb7d02d8c8cfefb24bfc3947be914dbb49d641a9373b684c21027ea0e85a3bf64e23c76ce0f58d505d60c8a8a5790570cc822630e9ef06eeba6429abe97f2b72dc1e63e9a5f29081350e085f90354575acc44474bcd3edc3a97cc3feace4413d70660c363ae1c8e5e27c4e167878ec352e54244391c19c01a901ed98d72c33e67d7943c0f510c76e7a292552b6d05da0e361eb9c0ea4ddec9134075dbcb723d8849a4a18820e2e0c4fa32ae5ba260a69d573e747636f38c40b7186880295cafffc5d2edb324b51b20f7e15b95657d2d38d7e834e713b49e431d28ab3af299af302023cc039225a30eab35380a2ace3f16c7fc620e733442424fd03d3af68fa9f8d4f29d76162a11c4c483f44045682ee2a381a53b9cacbf5227242435d66736f5b6a2ea6422d68ce75a4d5b6e2002d9f484691de947f341cbda78bda2eefeca523f335e8f2655ea1face52d7b01e71fc0ce60f833cfa840e80261890853b3d89727b08d8eb446e6ebc4ae5e363ac5c25a10a0bd85773e89def173bd6bd5731c9e0be77576613ac14ec115152f0c432d5067a7ea286963b735e1c34d330d0676ad8770e95e4f31a4457331dc45489f51b803eafaa71124a9e5feb92f893e874e7f0904cf5b323a03a4c1e18ab8b1be58ed5f096204e3b8a291b5513b0545d5a5615870b0820123a71ce12ac1453acecca6710ea68e4bedb1d755b42a087f916f5d57471a6dd57448ea7a7c52564bc3c8c95e612fa1d9fb234d7a64e2754650aec5e2b7a98730132ebe91387c3007d64cb7f1ad5139739f0492ba3344dfcf6cb06ae65b78b03c2caee6c273448318723569fb1101f3933b1ce623c00eb8da3fbcf07094d63f29972f413605b6d477645fbb46caf8920b5e64b2d08ba28f3c2611c82bcf82f7a44e60f85d39e2f52a2ec842a9ead2895f4081581bf1bcb1ee261d04532642ab49bf7c02001f4f7b46e27105107f7a41fd1de22bbbe8fb88a4972c039a447c65c81bcad45fcdcc667bca1378838f005d9f1c7490c4861ec792a80dec9b6eac9e7ab8c69b6cb9fc93d2bd5456e886f6529b3df37bc7374c570bfdc6dfb63d97a716ea4079e6a38f13e305033aed84203af532aa626cbf64b3952ce11b286f36cbc8e0cd6263ba4b6f391bd5b00d18d9a78fa11d2007604241755e16c09f884f3a93587b5a4e7199df9c4ec7e33d86314e2024e201444a0d98b937e1b1fa3c1555b435c258d46792143009cc5a0de16d8369e24ab04acb9f0f0a347d825e8712df4c8b80ebfbe3c14bde65b82ed4018e895e708bf5d176a59add242d2af97afff795c82ee7b46a2b06ccbc06694f9347bc29324f55d8ba69f54b9a85c0453a5a21722058a020f2439e3aa3aac982f32f1732744a7198c5461e96671152c6de753603ed055cba5e4435d508cb341376100725d9ced188cc8758cab638604060775f3a050ed0990f226ef22226c45965ce491e7581db965992066dba103c1ef839a096fdea4b2a8151f08b37c7eb23d3d5f086a5298a3135157f0d43c2ec265eb745f0d9368bd289fb4bcc384c94e459a25abf4bf247d0a409837312e83eaa264f28b4825f0fcd6b56b163e3d4890099399f2a876d5e7cf52cbb55b9428963ed8128f0991bf6e3804d87b5a9ff593ac1651c0332ccc7cc44ce294b4f469b25d89ddf61d9f9393a6105c3979925a0013c482578e04918100c8619022e1e60170b6bb45029b159f9e60259c2e882a742aa5accb5afb269d8563d761125e929bd4de7cd3ad9c9e68ebd28f497fca05dc6966d60b415a123eb11070db88b3e2ce84fa1fc1290d87e7a5d6e7b46500e2587caf85438c3ba7bc28a6192de4d591def1224ba96cbe96e34fef222344d0e5d62cad86f3640460bba8b7c61a0c68875065f47f85e8a6c4823a4455584651c8137a8b981517777bc93a446a2eab80fe086f489bb1e798adb228757baafd054be70ffc1a04a7ec441903de4e1a7d993bb1ab9c3534827570e0804e52e826668a960e639ce939dea1b445ef72fdf796c4b4f1427b467dd89a88941d274fb31e26e6e35a3bff4153d99788aabaa1b86d07a072bc3d8930f6876109a6b459df5b6bfa4fa570bfaec9035b8e597ccf3b1e08f1fb48af714b5c1e2b417fb7481f8422af889c8fb7484aec24ceef652014ff83b7228653545e534492c71f1e43569515893cb6972103dd84bea4d5a1a6b05c806ada3cbd826b9543e401b5b25d57b18a88bee6c8381bdb8ba76fa31f367666d4ab301b2578260f5789930a89ad6f71bf51e9686834deecb94dd9cbf5acade5b71a7788653ebbcf0e2ef5f92ec92804f80478a9d28f0c71e02917142d5d330e1cd547902d4f99201e1304e8fb51b858568bebd84d5001ea4e849f351c337b27b496dbb1c70286bb415fb5b7e2acb18f6fbd0a57e950296643ed3e93c740fa800c3febe2262088e763dd8b7ddd9a610009953370019fa6777b7f80f56a7a9bd8d8350e1e0d95716934b5509fc73c06f94cb3782e15f4828d6758f2acd650f73291062182cb9541b67b8b782e530b594174c52b53d4beeeed1f28d777fa3fb73a3858441efbf06756aef01c2f9669c4f064e2ed4a049f0db90f6d3c1c91f1e27ca358ad26728a95ca0df5cb8f54c0e7f6bde7ef821811c5df63952e698abf24710ec16c02f24207fc017a765cf1830e4cbd59bc28a06928452b51b83759659938495a3157e5052f5a68eb454e17719414b069b3d1a09137bde3136178bf5dc54695dda8ccbef72d6b754fd747603a9c0da9485d0ac05e2f9eac878b67523461731710ae46d899ff2beb23ae8b8f4218a005b2794bdccad651ef819ebf739db7616b726818ea6cc31044aab85e2fbd5de90218848d62d18ce2548a8279cdb8a8642a487e09734550922619688d54fa3e8bbeadbdf17387eba8bb905c82f415e3a59cfbdfba50ae5b123505696e6f4ef6d568fe5db5a31348ab6895f49e329c7d10516ee927d789783de40bef703f958cc05fea22215f6a73a5a2c24aedf2ec103a08d2eb99ad89c3d318209fd2fd6a634c5736bfbc2b3a69e869467da2dbb4d52286bab17a8ae3ce4aacc91c6ac4cb510cbe77ef9ff8cc0319eb4c3a5ce6b76451aadeea6fbceac4c06f492a27ba6f33d6db6f199ec1aff725a3562977645e7cd9419ee730375740e709dbaa6c2a9e586198160a52f7c4062a44e0b1fa214605e2aa30dbdce34f23088f2766f162293765370ae6f441bcc80ce824b4ee2b726dd251cc9750dc445d67de0fdf0f1fa5d736022a399cab587fe37a4e4901c5f9b4400980332b63a75704db53f1b3d678b5fe45f0402b39c3a765e849e0e196b2f2d13b56e8d76b3630ecb8d706dce2b5f81b42e75dc0e3e1d141d87cf64d0e16e044aa6a1329378b30f63829ef048a0fa2728008350cb46e08305d74e05371d8056916ce15c77d21407809f1c36d66bb0fc87d52c868cca8ed4308b202118b378f149dbcbf4c343363995205502d0152eb243a021551dfe1971ee9c2804894677ce7fcad3005c16662f732268379c9da1140bd6f3a9aef10b625c9fd70d4b7c68dd40e3cfcff49476cdcfa299aaab47fefffda92afe1548e9a5be2af025fde7f035cd1fe7f6aff40b1a96652d752939faf8ff805695d3a964071f73427c72e1a9c83d7d03f3aa3265387229841c6212b571cb68d4091a3cdacdb42e837f8f390127aea1b201c421a9ca4ea26927ca514ca8eb07e759b99bd2e11466f4ddb0ab4fed52e046455381e313f170ac59bb1a6957d9bad8dbff7341d0b863b42b955fe31f4e0153273182b82a3ef94048c6717cee4f44b761e9d800d6497979adce82fb4dbda4701ce87d4383867dd8dfebbb317bc882ddd8d24bded65b3e489ee2f27dd45644538bf8864565b6c76f5504e68919899792b376eadfd7e2539f013733b21a7e546bdbef050881ff24e9db0deb5d353a9d1898a3c5af92936d6afedc79e470d61b5d3f4b1ea0a4491edd83a073a69d61ebb7f23554bfb86fbff9b5b8c2448d68f52c278906063f3161c69524b1bf697283a55131a7034215f412119d2188c85680276a2c3f84cfaaa2c6b5b31c760e4e1c963f753eeb65de3a5bbc1d19ba20a2b6b49e8fed32cd07972500534fa9cb1f3d2fed0c45292a1d4b527daae26c8a14ea4f744301c705c7678839ab1d57058104a84663bfdd623c8081507993c106a94b4f9675290e4c6e8eaea948530d7f701adfaca9926be023236d79236f5e42a3e6b51e7acbd9b9ae18206d7308fe494eae2e43c06fa4b7af56847059aa96da8c9a52fcabae21a95224bd84c90f1ba720c83de0ba0bf3eef6115a1e0cf2f37e357a89d97cbedc2d4c2dfae7cc19720ca6691fedead3ba3f747ea8e25bd3262fb83efa3ce8c0ec089ca911da8eca49fd3c66953ae44fffc83b7325209ed4e6146d1710a8fe81c3a929fef2be944dc8450e8a6d208a3baeff662a474cbdf96a8bca30c12a5f48dd4ca125b40b1cee8e3fd3b0a1a4af91f7da22a3e507ad0501ee70d20248ca268f6ea7f3b91441b042ff6224a2ffb26368475e27625fcb4d8ded75ba0d1594dcab04512064b908de3d06228c10af257887fa625190ffcbc05cf7180d357262825d0705054717c955556ac79830869178748c49139ddf476704318b00ff9fb0776e5c466eafc262307f2d950b7291e3bfc943cb6241fc3eab306f4c22a186e10a46c732bff71dd96d3869891ed9d9ab1066f6d3a0af7b83a811649337685182e5b46833d99e0583680455ff5f867d9c49a013db22d1a04a80cb59a1e5338df6e919d86d76ae05f9e925195b4c84fca6dcffab147901f930678eda84d314683fb76227479bb43c983dc59387c304f7198d850e23cd28ba6da88a3240c6f6a426c829153590f180541faa7ef32b8dd174f881342a00a5faef451862768b32bd180e817cb545d8a6231b5a63ce62b242952761acd173fb6611070c4989252622ac3ab55f1f7953ab9b8bcf0fcfaa0dc606bfcbbee323d94e0b6eeb76320c6a53a7df7220b006d4dff2d4c50db9cf9bb7455a96278c6d0e2964a6647d3803d9954b6ca097a73f5328667be9ac05f96a2d25821106f260c8d383a939e9a3d88276b188d6e3b1cb1eec3e43611f2303a04b3877957a14f91f8b3462430bc51dfd31cdb8b349349c12db08154652d1920265770f31e7a4e2ae04e7375c5fa0bb36833a6d9335ee5d50cab8bd78f05f6add075bc14f08e02d2f03c03ed7dfedb14d7ac87d3d248c1c6f5d52eaea5570e847408fd97402e148568d73378c1aecf62987aa9dc09bd9dd7c3193195358aacea450a870dab0a69be56e5a0c614ba2ecc27244f08f502f96ee67caeed0e450c93e399e270b8c3eeab8baefaaeaae9474bfccfc83944eb38ec6979417f7bb328eea9a74271451ba97dd3c559b6e3c8b3a316a21c9b7a767391dffe3a1cf256b7a62b462925d2598144b3aa86bef5ed54f175beb47c92f6a4c9efd21189a010476ab36719d4e54c53441e3a9169e1c39b9ef8ca3250fd0ad6ee1fa49be802727104d3c7740cc15ac52cc6cd3edcd5faa8afed38d5bf24f8b2dd213caa36313ad6a4a5e876330e4b8130d689782d8aea9e161c86ddf109c3afa5f54c3e6ac5d09b53bc0a70590fad6d9979443b731ec517d0e5d9944fd475949ba56f6f412ce0b8edea9cfe60811e32bb01d431092512360f1de31cbe2fdc7b2d564f426dcacdf4c701fa37573fd46af5ebc33370f4616eae840328b722e5d3bfe343faf6b8e3c4db1436d0a3653d09076d9d5adc599b19d69227842f5e432a6034b339848d1b67fc9bcae0ca1a2e59cc357975c758aaf5631e75f30942fe09df38f0a906033a3683c03eebd09fbcf821c83352e5dbb08eb81c38a25e27327aeaa0dbd8f650f9c10555b23417939616fd14c6673484402064278966b907665028d78826de097dc8f2c55585a4ce9b728f0072ebb962b57db5befc75e9bcb3e9e69e870460cbff459a5bee1f4dafccff95499fc77f1cf73a3645b9882963e2716dd81b99d95dc686d40eb8320ddda850c2bf173030bc855bbf7badfbf71c0a453bc976b0ac4b92ec3ea7bf4c5d554ed48d181107a9b2df0422715996a67e38de833707ca83efcbeaa991880faffa4a3a731e0bf0f9a72617e788cd431d62896afe3ee946681ae9cd21a7e621e004c1d9e22ce42517b7d5004b3b86709ff21f92d7e88646b7535d780483e70246ec4ab735e7cf4eadc4ba51bf2a05daf53c9bf2a277006e698cdb0f98f8fee0105bb1b5f1e4d1aab962266234c38ed7660260869c27a56c41a81dee5c82f6fee49342444ee1303d8d95dcc4a6f429868a50e3373ee42967da83f31c4d8cd84d5c69f789b4816f6c31204ddf6f4a6e232bbef0aba4a60bc3ffde319a7e40088aa028bcfd42985f1b707f2f2074f5f0cc49b934ea5b7990123ead6732ba6c6c0673bde4cd23e09e17151d8cd0311cddc0f1e37d2f6b168faa05e7055ec40802dc85d92de15ac68fea9929d7482fa0b735d22ce8fc77ccf28090917ffc6db693f46cd938ef38f222efe048ea90e00d70a84689606fb754b518ebc83bb553bfeda87ceed8d7e563ab4423017c53b8b66d80af4fef398bc787ed2bd601602421cb1ea307e5325326f29a993fe26efe2e1943cd820c55add231cdd509e0d080e6cd5fb1df14c014e875746df7475da2ce9520e5b63289b809e02091679c859a86a59e7bf57070ba5c7a3ff278584d36bcaa604b05be8750892cfbd027374e6e897495ab038a87412b278c6a9bc693df908abf29daee0a972b17daf0612f1f057dbfe6aa9cc85caedfab704c199ce0ae6c44b51c6cb88bf697af545a6839075092303fadc7541439361302e9a5d447d45e8950b5f683aca2b10f2fd80a6cdbbdf9741ff5c27d0e2c68c712409d8f7774ff7b1efdf4766f82a683270bc26c9cea1125c53bad2a1fdd84a50b23554a1afabce0d6e7431f7631a3b14a9c18f7299d5a1c3d62ddc1866bf3f4ff8dec9fb636ab73e4650594e5c6379a51cf27a1beacd7ca52f87a69784ddbfe5de5475884a7dcc35d3c30e24c0e34b46c74aed755e1e27dbc112c3e201d2a7c59d544aa161f6969585ae716a242929ced346787fe3dbe700776f8c69c64d11f589435662f32aadb666763847131d3e05c49cba9a2f38a5a3fc57e0a3783c0ac57cda5b5fd845dd8c7189eeff3e8bf1a35eca8d98b5ef90c7d854eec2fce120b6b9926686ea964c864f18cb77f9abd76009899056559c55dcc54145fad481837149e86ce4f043c29b719066896b49da93e82aaa1767f99c633b55b4f561e7affd7294789f420197f9a869eb7c1d98ae24961758d037005c740df9f1f9e35cba7fc898e6c0e1e0e681f7f2618f43ef24c9b2ed1d527988b84302ca230d4c80219f392cea6bc8d1755bd7c7981cd7e5adc89cc06310075562c7673afc9b297c04b02f0cb6fb4f943964b0a9b2ddfcac38eddeb9c46e00344db3e69e0e1ae5c7234e350fec2cd1c8ef1da1c8e61262ee55404f6fe35bd7172635277f33c366efaf34eec545ab9bc9000a3ad53c6e12864c723795c90a02cdd239bfa60dd80ab026b7b3f253a66e621e1614991920aea9cf5c934d762178d940277b19f1e7d6d6da5748cace6a894b9b3634189aa8172188371f04617ae3903debda60fb7683ddd184f764836d177105c259c2948a302b722979503740bffbdbd1f169768373f0f98ab58dbbc988aadebf29658f14208a07685f2630ffe697c2f57ab3a8c96c3660a02c9adc2873f2ee885e22c45ebc117880ee86b78dc282fb3436538759888e8b6bab1ee2061ea1521bb594ac95b7ee2ceaa2fa505ec9a3d14bf20df3e6b1e93d693604535c8f1be7e9b904ac5f7b114ba126a09809a7275ccbfec881629535ed9dd888d56c3758a8e1216d1425085ce33e3f24d9211d5171eb1fd41f6c748d9efc0b7c0aed9d43bfcbbe5b5a6bd62cc44da106915ed21f46b16a56182bb5e39b3b09a2950ac96d7009508706baca51268f6a3f1868537b8196074554bcf957c272bb8504a36dc1be4ccc1935439f2b66cc8b4221852a827a560ab8cc9bfa7abf2bfb97afeb7454be6fdae9100472f2ada1a5dd516920d912631df4ae6ee7dcfc56f12fe45db7ab75551c23217a9e4bee0422a3164d8b584950b767ebb2a0a5ecb507978cc898044d04dcb3409186761004113f0f4c6a52215f54d878b3e99fd4a2f8e9082b90ee1ce2687ab91fed44b45dbc5dd96cf210cd696e56ba1d67a1846225822a54bb3828efcc0973892b50a5ee26c459e86d747518b5e8a4daa23671ab903c62c65a71a6c3ed6de13da0eeac146de3ceaaefc3d2e2821be3ae5ed73be507db9f4db3da5b8c73927cb8e7f7f8107e348081d41f454224879892846a3da1e68096187c49d0f5a22a1b6d16a7625291c489491aa774882f8d6d358477065aa2f0373662a17d680c873052903f3f5412ff504bf1813c762872ee7c5ffce2f9fb986dc1f4848f9b6d908b2e2e6a92b40dec1e989408ddcefb134eccb62598c0ced13c1aa9b8a6a32f951f607721d79a8b9116fa1da1050fe85797901aeb0dd1a6e04649de6fcb9ef696deadb156493ca672fc1a28bbddcf55ca41a8bc575fe5ee45d056be38b74811dca6d95113b2df6389e40f758f3e1823d627bf08b3dc7ce3f6232aed07028feee45ad6052a3a4bfe1f0f24bf78b271da57d06d4be915d77b2778dfb1cb3de8526f05d5dbcb24395d0f75a1f6aaebf050763947cd0a4515b244347c29c7eec0b1a08066653f4a72fc545884f7f4531728a58a20b4dd501c5145ef5f6df9bb8daee02b620b5f349c24cdf33739fed985c78f2188b293ba812b03cd4af73b7d79d42bbf0f612eb869d45876371ba97ff4f9bf6247df708e69c2afa83f27a7db7258888e509e41f9fa03a648debd5a6e91abaea3e7aeafc64009a576579b14380992096f723c06f4134f1dba3f85a5a7e6588755c5759aa6eb2379a50773ff7aac6c10e5baae278a8ba78d6389c656ee7bf3dae71d4c5055a21de28d9271df856ba1d9bbcbda8ffad398cef9c176d9c4af8d985c07c79766fb696bdd82000be1aae28238c151bb20f939fe75c33991557045e5578b08593a5e774d3c3e3d3faa26a300af2b5954abd6df04cb71ae84af339721b1172f7eb72e53e0a85a7910487140f82b28bfcf1ceea4129e924c35999e4df0a59d630249835936ac416e7a65ccb4ac25d43ad801df29afd96e1eabf4e38be0c0025d03211f1e4cb5dd924fe5211137c5319e657aceee5daf5a7c1ebbf8a0329637e940528fd90c57b42030eee57151e3186e842cd8e0673790c8ff72db3a9f2e39448da530c86f41caf166651d1a8760ee3822fe857f5b39908a8ab2d02622bcec25708138a70ee3ea7af18c18341162bf7fb609dab3641f517e36ed0549851dc4e6e16e166a1673d080349ec1940f76c0cb35c97422a360804520956e6b2f9626365489335932adb3feeb862af4d3591d98eacdfd903fcc50bf237147e6791b8e8320355b0c291e076c4d579944baf00599d07b609d35bcc58456101371d1294f1618922804a40b2b6e74888a360a257d143eb7885b477d823c57c8bca744d16d99f79fec13850737fd020c3bbdddcd063f6f554e90e901ccfd5939ee32188827556e36f662ecb1284f70e70254f3169dbbb93343c3010424facde433a5e8546072e03ae0c1e7840a42fd5e50843dd9c94d4786c7dc7d1ab08ed6408d2abe1987ed307794d3621a3bd9fb5d8df9a1f07cb6d9dc16d42da8f66446f6f17f126444c14613242980b44efe112d22e79f6bf3a205c4378f396abb95acf6423cd7aa69a31da2fb250f68b63450be458fc2095f4ae1e2ef95e6ad980605f36e5b1798b583ae7fe080c6952340e962e3c4f405fdf044d1417cdcd7e5ee75fd7bf16d14cf28ab4d6704fbf8f3b4490e16d1caebf1e3ea5fd15b10da70313fde35550f1e4e784e5a3da9790221e4c7be31849d26c73295c2f2f3e188c36d26079b181d080c7a3e9bfae56f0183edce557dfd550565211fd344454a61a1da53c7abe78516da92929b57f0109cf242d7b9adaa50a7f6a70667d1d5f2eaa376ba3d12e5f244605e11f6ed46145127131e365af9aa2446623372897fd1197883c53aa21c8045a72729779413abc2a595ed9d28d4e63be0181c5bb47392e835cd076fb7cead8c5a5e399d9c066e170c8dc96b8e8e9fdab4981b1770495cd21e9d9d971a3dbc999e1c4c79696a15df302b5a9e0e69dcf8f0c19122bf6f4de234ec9172750b34c4fefc0b0a9d1cc6630cc26462fbd901765e81897bbee8698bbed264b867652ffd1d8226289ddeffaa64178b44f4247616d062b4dd165042124bb4924f6576d00bca32488d6eb7d05df15333d77d2c58573079e317b6292a710e2b013800df7ff9956b9dfd4645c5bc89c8ac0fd19da4cdbda494c33caf2d469d2e62334d682ec416c2e5bed07ffa3e0e7b65224e29d84dcb1bdcc4b8b2933c6e7d0c6cd5801fa37770dea34a8ec267db96ca4c83195286eb84da85203f3ede64fc8e103a7333a3e878d00e00e0568c11ed667dce4bf50e446aa724267745e609f9ad9037309910d792bb41f0924c264c76dae88d186a8ab7cf37570c140fae860ea6af6d686ffe9c7aad7f8d2c5190728b821f4ad3eba5f8d721362a304c7897169cf41c9cf7e16683e2e86d7b7ab0a55700d2dc630fb4612bd3937f101ed4b7e39e32b53769853023f8db620e464c98d4523408d2226c30a006224408a21301e9eeed6027553cfe06832c548c89077ba7f27f86a1137e657770e38d7bcf6d84ca8824d3443ae278c36c30bb1848225e16fd0530528d988564c7ad181cc5801fb55d61233d5987c15f8f7f5dd7423613569502f945d45ec566b8b8b955cb04ebdc977638043591d1c6a2a8f182d808588a0fe1208f29fc168e2e8715263f8eae15be42f644c8f94485b2bc6566861d8132fa26ee12892f35c5297a8e84f7491361a64bdaf132f3ca0e59b543fbb84cbc9ecdef642ff6f3eb431fba807605ce0c6afc11f6aac27af55cf8bc3be4b314abfd7c99fd2a1e8c3ace851c39d979d33873b75368296b0737306c69892cd3148135701fe337bde7e4a0990c658ed43a6826fade954de60871800e617881d15e0c2cfcd20f3a9932a6db6f0f3b47932a158ce762a2ef17ff3950dd855e1f6bc65cf73254c9f5f787893b7f3dda9726b90214a69dd85d9a9ab6042f5c382232b74fc53da4d80541b518236766497b135b9937a493a5ddc5e93d76e3cf99cfe33966552bb50af553d5cb54355fc4cec72dc78e610ebc096f4a06e544cd914b7e14f3b688ffae51c37c02dce6505f5461cfb5dee1fc1e04cb81442a6f9918c987b4c5d4bb895a8c7ab143064b85d5c5764449b16a667148db81fef3837d4b3d067f8028567515e8b1be0758f6bf27b96dfd4b58fb0e194691a6b746755f86691fdf339f455ab288760b31303b6609feea8be11f78154f3ca9d645d8d54c56ab4c6835f73adcee4de3f8c42941b706fa87f289d6f8beabee3eafb4327cc5b665dada0f654bc159d96c4b6b24add6a8832eadb01552f6a0955a8fab74ebc2609e53e10a48820706cbaaed0dccc8ab12efa088e848576bc665eddde4e1aff48082b04b7b945cfab532e639fef4f959f48cb5a27dcc203f473766fbe97deeb8ad08277e93f61ff8dbb4e5e5d75f5548b78599c5109fb7ff470e129445994bc8b55e9350dcad10737346b4568b4c42eee99a0dcbfa17d911caf6e8026a457366b912b884749aeb6f4d875b4358cfd6d371417e0f52ff9729405c4b06a9497510b67c4022290f45e834149e2c536ed3341b394956b1418e4af6ed4a8ed6b2c0574630580398b3ab9024f4b7a9e45baf0edf0f9339d6de64b965d75f755967fed1f75717b94339c92d845388ec81c9cb2f54eea63bc5a93698c20565da13e8524b217fa331c625604ad56b2d2d35299f957a2873318c214aa2050818116910c47780a39c101b80c37e5ef8523c33fa5d6571417463356c15afb551caaab4e80e0ecd94fef39ed5e84b101bd810a9339a1ba69fe5141bc72be5e53ef7232bfe3836fff150549f66738dd00eb68821c231bbf477ecf70abcc35628181b465be8655e9cebc95456aab98a8e841dd3fd5e6a2f0ef9e122056eb9e9d49106f7a7917e34c9ead06071d32c5709c8f3a2220be21bf04d876fa6d69b8695c7bc0095a7925e48655ee9ee9c45971a46bbe9c807132cd2f5704c2f17d28bca9b14fe58c0993b8a882b06f2dcb449e6772a73ed6fe15a13c424767aafcc152fb39cd157e88d805b2afc8f7d381fd1d64784872b0fe3bb325566a855b692c56a20d51b16634fcc489139ebffd68e552fcaa0bdd5cf28f09caa69e1ae6047d27bc1abad051442316a7702bf350e1f18b3b8ed3e581bee60b80237a27878355fc209d2ec363e03113647cab25c4b6011d1f9483218d2f6c18c13ddf1099d5e965a8a12abc3312bca5502596ecf8d9d019be450e3e7ea7b8b4de6a0d303edbd867c073626e06c5d22d6947b1c8f031e8216be7af473f20e06b2ad47c9362afef53fb7bbb9e22e36f06cb73692d8d41f855233939f8713a7f7f6377960c4f93a32355894842b39b649a4ab204bcb46f289a18139c2022fc954b7ff40d778a1e9a53ebe9b7b91f70eae511e493ec46c65531c3dfea8465ce01e11d835179bb5a296832f0fdb4efbf98c29736839a6a6b5b6e35eef37367a9114e8fbb72b8dbc3ae5fb597dbd118c421521bbfaa66d8098ab97129d31303599433de4718949af8cc041bdc4b0093dc6e545c65a64333a6799b3aedf4e5c89e4dfecfdc70f9bd181fa4ccfbf77b5a6c57bd1b724be96959009af9c592cc9a81b81b6847ee0d91bc018cfbf4cc273262462d35299b697f6014861faeadf86c057abfe68db413d153854fbb51cfb3f5543cda07d3d25dd09f54d5985472e3fa7b21c72df2b4d95d9d8a3eef4b01eeccd5d437e50187369fd074d1fcdd7199a97bafc01d57d1132559d8f5efe74fd9ce835b1c6ca00137dec27a5ab813bfba9244ed8b0412be958cb97c170b0852748deb6e3b894e9900757bdf43c3ab5e8f18a6bfd3e3818eb161a58c881a413b08638b5f40559178d5786dd532ce8b4d7e72848750d586fc1eec3e49824ec715740737322d40e4fe8b5978571d33ad8daa744e9cdf8886d180519e190f5a4f4a432ceeead17c601ebc5d3f8c005b561c3708fc2937244a289b5cf80e113c1dc3678a7fbe5627848e96c1ee6dff5c1a4c1d147c9d00e39b35819ecd020b4c4667f2a3f6bff844d8585b42c1ba92268585b0b39f58e13ae57787ab503ccc15d28db83379e2157384397ad09af861b008630711aba9c6d166c10cfdfa0f52124be1a33bb65226aaa8b6fb07ce65d2a07bee818001e07ba6a3269a0d76f70d14bee71580a239966e6acfab8ef65bf4cfab65414a297a421f99958612decfe15c3c0ad11b47e5ff10c1eca0eedc2566cc83474f67addff96d2ea35b10b41c939c3c879398f850d6ecf5729c1d25e3f0d257c6d846f3bf50ea9c6ee40976dc1e4ee7547a6bfd8946bc5931be6363bb61dc66488f87fcb6bbaa4b17259875dec5180474d617d19e9c2db73a640d1eb3e881bc7b7cecd0abd12c34ba9454900ef60391c8c1edeb1d687129b1021343511a0a5f483f4a36e6cf8a48fcbee482bf9c073f459c963b338dde7d1f3b0d421f689b179ba0c6be0c15e9856607e0a82039c23b5b0a0a0d55ec408dbc23aa0b3f5b5b97ed6ee9f7dd21638f90f7e826082defc5b00377a55fd841950ff93d51016477b1d653fd1f9bcde5359f9cad3d80d020d9c5b7a72f9be4249c71179c25c795d8f5726ffa0ba1a8a8c7aa31701581a065058ceafef586922655562b8565a9b839bcb1ed98b88f2ff75637bea2277c7f910dd2ba6126599bf64cd2ea0793e6981504d387f377d928957b3dcd9469a484390b14bccdb35178fa003e2c6eaaaca4502123979e2bcf3dbffb27025e4f0dbe0ed3cf445543bcaf7554c8ab5bc6452a742e3535c2b73ef3842dd5c662e92e90872e346a98ff95f98214c8cbb04635979cee0a93b274322a048dc4c1d411003ec40d7a22a19369246f66bb9d775e92c2eaf68f3ce2c0f52c87f2a2d07152f2320e567fd603da11e578fbc54fa121768383d300975530a0c0b7b1e51a1612e72c5c9100b7a03a1037a3ba0d41c40998ddaf5da7bed041728071d69cad841df68fc8a1e01716b87c4f573e56fabb2a63037f25178442131c9d5ab637bce9e03424eebe961de9f49e009aaf57ef7e4c94683f356e0ce2ed87b3fc4cfeb9ec1a85a633652566e1559ee8ef8452adc5880ea7ea1f5655b4ed576beac25ae5336bc4a300237d520ebc3b60ff78316834f31112c8d7701bf5f284fc8da5427633c82e0ad7ed967687348566e37b23583ea93be14bf3fa4ee75291428b0435a910b9f8870aca59742d8b5e7f4b343743b51931e6b44256a24b4be422e9e351cd04bd1ed65b22d6be9635b63c08128a9dbc8ea101c37b909e3e584279f858fa57605ad08310f6bbceb49fb49b3d936bda8e88fd0eb2e17c6ae8e34aaf1e9aa256b701a2625536c0028319b20ccb25286fde76ecca84be474eec3dba9e78d7f2a73249a820a1f61588dcb515a7ecd2cc7de767a57b91eaa4af2aa6fbd0635520d400f83ccd479df113fbf79951e3c2399d061961ece526529204aa0ec089e6275768108ddeea174052d60b67cefc3df679d8f933668b234de320ed4bcb9ffa8b6ba8d64e8bd161c6ca3ef5d2fb72635cf46ce6e2858f040300f7258810c961fcc0984f1a360dc8443ea5bcdc7b829e83410dc2bb423534676ef30811f43ec23592bda0fcc5b788901aa8ed61a58ba67788a8b86cf5fe3555889c4b9a6674f97826213529204427adeb18650a17c62a7cf8257c98d50d3b9cc72f1719b88165f4abf9facdff2dc21a4ebb4ff1990912f91010fda77ea85d5e9386a414e5f893d7c19658a0c14538e1aa3e04ebbae2463d98f1f98734a8044b0d124194aaf3c207ce19f880172f5d226a16b64ecf87c3d3a1ef24f6e9d001dcc7ce77e0a4b0773df45e4fc37323413e80b31351f378e2c46159c014cf43182be94170bf7fd8f7c6b19aa530f1ea1970a752f69cd8c1c6fe85f4b273bf509b048b1171cb5d564771d864c85a0d14209966f60455c3802722f5d656c5d3687868b195677441e72936e13c30fb611b5bc20a135197788b155e421ff604a67132ee628390575f2cdd2564459580e871ea38292702a893e888c3fdc8eab0db8d48bae80f03537889e06f0ec340a5acc8529b3d7e70b6b3987d76cd90097f057fa3a9df074d5363e443c58a13320c145c676cb0644cadbb9608a73bbde4d686a992eaca40c0b9197462b06383847f53fb731f19b26ab9910a4a337f6677acb860c21a52811248681d7afddda64c208ec5b58236cf685e8eda7ed0297007bf0181c45e4ea272ed3870b05df9be50277561b8b18000d708969fc7b287429f85081d673ed6f4c05fa597cd893fa2e1ed23458ada01d31bda28573034a4bdb4b0947db6bb384f361f505e7ba15e6391686292d203beb685324a38e9d9ef26cd3027ffab7e3e226eed6aab80b1cc1026f54303fbc20ce24813d5f054ea31b8f24378d78d5d29f1ce46625ba187946a3a1403b7a68cb93d046a9705bf398adb5ccde2ab6bc1b839f751a07e6e9d7b753c3b34f74f26b37346cb11266ea015b668c52248ccf4ff90c5e76e504b85a39d19dad375edeab661db1a2bdcf350a83cca3fe88cda2e0f1b3f24917f428922da8697576d14a8c5e019cb056a0d49b78e5849683d7faddad14bc6c5d71ea4f1ca84963687d3889e31fd5d60ef87bb830266e789c139526b8fa27821d05fc086fecf53994cd054e1216bcbc7b6da551db7c0425182ee06bb9093210aca86f6f8bbaee94cbe4b685ab28d1719615cdcd08f8837376d82d6e00461f9222cbc6e092b7c22c302675c4953c1838c28345cbcc72e07b08b9ae691d870e8bd36965ddef9aaa03a13c2bcf74edb3d99f0de9d6e6a8c8ebb7326f68c7176d763758b762fe325517952f1397d66b11f5b690921a707b54c558b43482b775005e9d143112eb532723bd9124d03ac2c042a3181cf3648ce6600ea073345fd8a92c8a6caf2670912974e834a9bfdfd68b702e63ddb1cb5e258f254d20017c06b7c724ec0f0ca73a60491a166d7241b99ed936487ed9912692ee1b4fabc4046d4596c04ddb5303f91a8662214b8e10a4b7cd7c05beca09541656e48093efbcef33355d037c5035fef1aaae2a53a81708f05dd2266252691cb8857df3390dc151ff007f7a6d16b7b1212ad8d3614510e802ea5ff873001e97ce9c54c69ba4016881a24d9e896154e6faa223067eb6b862e6a95c6de3ff479ca26ec50db055565e86fd504685f7cdb3e62b9ffadc5552121661aa615b225098d67e1217fd526f61d3b4e5df1db1c41072aa6c50e7ddcdb7215c7985eb1a5a334351076ba4848242e0b4f05c01490d3ae1dd92fcf45b7cba814810bd29a9cc799761a43f4974bbfb170994d7531a718dddfcb1a53597f1a302461b8bf04b6c2a49560067cfb22e680147af4373145285b02794a81f7a83a04b2a0c774b585f62beb582d851304c402e39f28b07e2838e9d7207084236ef4244a5f7e6afaaf3e1b5836f123485048d568c20ad5239702a937d6625ff630f1cf9234da652fdffb96460e6f09712ad24d0a07278a0dab19d21cb1251ba4d387f2d2c5ef987cb822bbc9fb5174ac9a559cfc8ec591704108652953e5fe29d9e2bab77439652f49f39b6c562d9716ee80a1e670df38ceb6efb5ff45f1b2cdb05d8a3d4be029872ac9f2367325876cf5698939860695f180826fe95ff8aa0a7b4ab0d6c4d54d76e635635c2c7fb6b129f3ae4c55806a15cc8f1a53ad7e526c068ab1851b0d09cad17007648a2dd19dc2a6b29d88403727f8afb431777f6a622e1f97fc3a5b87df925eb8154924b25fcc8a7519a5d1b534b8f6f47843e518a0bf86edf77a7f9a8f925b160ce3f3cdab876b77a4a9adea82f6f31084a590607f63af0c76c94847456591569a048702879808aec25636496483d61abc9d196c0e65b14690e6d805f602c92a6efb85c3e8dc339025da18807e32fce7310037b32e8b4f749e14068a9cf721b2becc625e569b8d3a5267b111ea0a7a37553b8724c9dc0df8d12316a9cbc3c19762535302e4316c8d3fdab3faea4693216c743a1bf127f2a31e1f5befe7f5b14c51edbb4b3b973aa6efec0532b6b541e0960adfcb4d4d571523fc245a168204cff2aa143a72080587e47e1785a4299a303f6b7f832d150a6c6d0aef953d4736364576cc172db58e1856f1dfc8f48252407a0562df6441c03aab3b3f79818e9b866f9a41e6479adc148075c1356fe21ffe74efc3b1cc608759aed03af96d3fe5217f97e22826029fde5b97b4f7792e63eff7d468a9d8e7e91a0685a63f19bd2b4ec3ceaa00ec7034a8bbe8156991da55e05512b31b6a6cd83164cee5d776c76a7108caa615dc80e338648e07a2c3b6cb97f599bff1db5ccb8275f196314117be24e372e6fc730773a52d71d5a01eaedb0cb70fe1d613a22664f93869705ece6db05a55a105c1ef496c432386d0a5925dfc8c2e6b28d45c90314cc4d55a540a7b6150f656c20de2135792ec189580823239a4dd6cd0e60ee929f6c6b5e823a00515320899f4612804a6288aacbbc32bddb3e6d8bf0debe4930ebf26e949f0845eb00ced04b4f461e1cc6478a4711a8fcceb9e91bb825f2d965672077b0710a5bf95ed2178de98f957912d3ff16868ec22c875988006fd60da5eb030297257307565b2f3327d1c14d4370b6af2690ff604c91f91534cb87ce259443969c60dedf2a8c76d6e9810164b39a556218eab1f1e1ccbbe89f9bc1456d00ced9ff4b2ff0063e3686fdc67c28a9f5280605bff26d48c7a0e5340a3c0f97047f6b790bd594a1d8e01082cfe25eb248c4e609068a9c5e2f3d5c80664fc3e6a21299266d626856743399638d6431120f16a313a879ad2aba2bba469a2748fa59c8a713f4d5e3f776f4dfb7ee8c99865fb34e646b1f30653dfd6e3a34149a70fefe2cf0934f32267408b78f7db229c0fc37752c65b3e7377fabaf6c92b44291b7cc0db4ed42214fb9ab44d76909d6ae161dd1b27121b1ed78edd62fcfdd35158a48a26a3c025d0998097987b7f43197898e541b65899210b96bf4489abf91d4b0422614b6257a153d0213c33fd487599e1f9a146496bd613f4c143bf702713e20b1b84e9aa7c2e31724f4a991248c29d5606c6c3869d9d217b25060cc6e11d2c5b1fc67713903dfe277033d8c834aef58e186363c482451eaf7ce7c980a600a7d1a1c1eb4714ba008ee657b7c0423d7a08a3bb11bbc92209bd265b6c567b855a7d32f38fc254a8cc8679dba1f59225ee2d314cc2dd24341a859e1058df51ff34d87dd8666f1172ce3931e7bbba7701d14cf0c5a2012842f5a801003db1956a22acb08dbfd4e441cccb34c80f27e265d610b968c41e615381e429e61c7dec16ae2fff3dd5b3e2fe1be13cc955ddee2af39381a710b8a3d47e4c31d1b31c70a04212cc4b57392e0f0381072129d6cec6c5715b7612ea118eef5da0a241bc5877fe97028cac35a0b4b6d8159e733b33ba30e03e5f68ab600b99de1dd0b8b85b62ca0a2619daa9e2fb3a25d1fcfe301b340d4adf234b227da56bc8b05c187e6b2e4d9e7003347716ec14553739e14e188f17bb9cfa17addc28563a47000d17fb46b925836902ee3b49899853772ada23222f018689851fa59f39f246bd8383227bd15d537d73a08e7f4631dc9d78af3a8bf07006e07f094037ce4f1aa619c17e5cde4d8cd7df0cdb1961e76deea37e3365dc01e36bac22408c18e35cfffbc739f31820a50aa9ecc8d2c870b813e5ac5d35b7beb24fd9c403d20407b259a0d2f455f58a753a12dc73281a99423a56996809a49f3630b5f061d5233fb7890ba19980a027956cbce6b616d098dd5a66d9f42fd6f016d46fc5ff5fb276c7dd90fc103c2d7febe2253cd01709fd70bfb51e3a2c6980b9a2226e042ed7089c3594a1e8577b474560c3c3824f29509800327128a38ef17535e7dbbe718421373f79a7dfbbfd96d861ee3b09bf25feef91e2f45914475b40d9cb5525aa31312621df1eb64e8475d340f18bbfd1ee75511dd6ba90181fe7b0a0980ced8fa4e77dfd9ea67995f4b3a8a3329c125ee5508c5731ecf177e94a9dff0ca22f48cc776561b34df8970f1c5ac16afa0a4d406bde6479a1ed909c3a73675e168daea51a42d46a6f1e85c295a524b5146ef15691853895b3e46589b6e7402f12532359dc0a839914d4fa9ad69df241ebf5138c60e447eb648fce30b4e2bd73a5c26e6f5bcfb9982ee942bcd8991c14e3384b8fa7a9a29879c53008a7f1325b4693d29b8fb3c052797066fda5eba0dae271ebdcb5efe45e5f97878ef32d105243c10e5cfe353d95c703d7bd86b73d7f8486fc7d898b97969b8191b48ca28354b052931772a6b61d7ff67b5f1dbae85a785d5e034905b7e438228def86830d37b3dbeb13b827d078d4087e90ae73bf46a71947b30a2b3cd4c0c386cb625f5c3b2c3a248dff8e68739524bfff2dbeddaac24b9f37e3722035859bc14067634eb8a9907fd618c28bc31ff9158ddb2b57041e827e200fb3303c36bbf2b5642e503eb9da93a0c5bf027a228c398e717a502bafdafafe58236a635d8540a80bd1b68a5479df0c21c626837d7423d6d4a5ffd0aadbfa872bfb3fbc766c537c5b9c0373bb725f5843c1dff14fd1da8ca92c13ec254762146e369f5f8598a7862974c94d035216250e34bd69a32180c703105303ee436bf0f053fc0aac4c6c955f726c04c21b3d9545eaaba5c35ea9ae4e36987a6991bb7d18cbfe63f2494466609dfd38eb729c7dc5e2fed41d42f1accb851c8f1698ca75ec472c9a1e90c02dbcf32d03ee5f34a33bd40ebb78f9b6285b53f4ac6aec725c394bec49e3507a7e3eea3c3536b7356db3a48f09e5934c768e5d61a81aff56698e4fa808c24137df5dad5193c478210be62a1dc6ea6f001913a9bb17f5d3715ec374ced256bada07d096166ea8525ccbaa52b186b2318dc8ab86d0e98ac2fc1393ebd2425e391789f24c92e8cfe8879c7e036eec9764a5ce6ca30884020d4179eaedbfb28c4de3ddc2f38da62b6499172472c35e0e746783489abb6f48086846e0a072a7d1a77e9ef4f150b382a95b6b6c68a50de545c25358f8b70af3d27acea50da7527d9a082225be3b88146a0b203f15ce96fb64df92bfb0d97395f32ba390db717b8e2215d2662bdb47b16050c8879b9bd80e029f5202f880989394c13e31476daed1b836ed2d3ba9afddbda26be182027ffd2d3804067ed1c41aaf79ee6aa9153b06bac06d03266fb2e6373f6160ddf83696142aef0a3f1dff4935212e9fbfa78cc3376f187208f70d1fc5aad62741766117e19e22282ab5df5965a1a224c83dd6b2dcbfa20104a1081b927e919e5714d00e0efecdc990051c359b77186ae72471fd466323b19d8033329c2ec6299568a941fbc19b9b006be38928fe761dba5100bef6cff88b861cfa0e9d9385f7cc46d855b918df65be97f6b45fef0eea439751613133786e3373c183d170ba9e542e27f4838ff1047dd8ad69cef341d0696d6562667d6b5be1461ff95932f3c4dee4ebedce1e13658350d30c0da41aebf295071ca50ac6d1890849f774c7fc782e416da18a244f096cee204c7954628bd41b5de60ed7e67d605e8e802cafa245150e45ce01f5cb59ba36c31c81e6e3ddf1d20859accd95f77c06666636767b9b7cb08566fc78d70a3e41bc0f7c2bff9e8581caad2214c88afcdf20df569a955da06d24dd34014535a26a45220dcfb4741b5c020abaf87fb7de17ad118fc8ed3fb5644b4429d4ac7f8e4f4ddb58eb5265cb6c13b82f7bbef7455489a5011e1b6b244eed8123432b759fdeeaaa0a7a0c8a9c18bfdba622727e26d71a22201c1056c38d0f15aa1ec0601fd8665326b0ab16a00c2c776580c92018bb9b8053a90d1603cf68e9cea36bc0128ed223745f160af594616981498473cc11edd9d795c6d98d8e52987901f9116c0fb7c17b22ca3015876d04869a3398e5459390f006f1e998e985ed9b66ed9d860ee0a088ace91d8de10627a8445cc08aefc37c2bed4c0f6e710828f01be1b3a4f8cb1c1b0e3b6dd89ad8cb6284223cc98217fd533280ae575560125f7fea1fea73b55100e900f9e6c1502f81f3ee689217e04b6a6a1fb4e243ca39cbcdcf679e86da1ec00f5bb9e07524d628d54cab3590a366fe6405342a1cd4a7cdcd34f3981a346259d33b37d7f29da4fd9f20f72659f7937decc6e6f9acb53b7c6f449d950c8014205cd9366d103fb0e526cbb15be3ed2f823317db0de6de363007ee5ab1ba2c109cef866d3119d34ce1e74af18283be6f57b86456492333280b8643493a241a40beeb81aa117c9e508794a17c8dc2135a43cf631391d2b7f3d7eb519a01bc67b5f4cc965599292d936c2c2d9affdb351edcd654447b5d083ca7d0b14fd58203e7a7dd46ef5b1538cbe38eff074094892ea2601556ddd9abb3e178b8aea36d88b4c29bc22a863076cc536d46a47e570a2a66294fb73356326ec86ae06176645687ae817ca5358bc0e66130e736a90c516e8206fd5c3be6dfbfb6f82901618384c393adff76d52514cc5c222049260a01bc83a05cfc0af6fca31fa1752db3351f6c39c61e8054ba39d6fc0c0f213fdcdb080567bd4b8d455237378d3507dfac1e9e503308a76c2e60b603958f20513474819748abd9346ecf98ee9940f02d4282575ae36daa5ee4f95d39c87751b74014d37a1276a88c6bc6757ece390a5a60094eab12e12da813262d0ba3e6c648ba660af579ad7b654f33f443bd72f1fb8a3daadf9cef0c0b7aea5aa9dbb375264f7a032bb6448868160abeabfda2d3a1024cee962bae4ed3d8026dfb91303c500dfa12698fa1361801bb0c04e1b803b351a37f27925455736211f3ab0c6fab4e22f689ced7b455c0b1ea5d1c2e6a4fe85dcafe01e45eec4577ccf86ec734fe07a54f8af6811df80798ebbeba9e3f5fe9a5ca8998615033ce3e839d845bd90d4168dc96f73575c6e072bf798a1eac47668a1458bedc1f3385b1db1e6afe6a75ce07c203714ea4142831bff6ad4fa96921fdc668b683f5942018d94bb5009d7137826dacccb410e5061fb6ddea3d778dd3bafbd59ad2c1582c6fc2f5f6a31c98ede5593d1f47083cc70cb273c3e3d3a3a4d392dbcfdc0d0418925a53c2188f1fcc5adc81f53347d7e3ce3b969977d7a76613e5d61bec3e98e856a222686c6d57c9a6978d872d1d9f00c416e67291a6f8f05f5ec49e77efbb857168644ee821bdb6de9477507e32f631596454f79d7b3628c69cfafbf148692f80ae464f107e7e89bb5753ed96483610a1a6403a88c24072e4a08a60f76a0b01bb86b37aea36d5e38e9829a52e0528930ec42dde62c6c597faa82cc43822bbf30cb66cd3e1f8f2c5b45b1f7c543037a927c18bd4cf71d2a3a5527011f23a2ae640bc554645e3cbc04b6a4eff14e23ed0e980de9c6d64ba2197b1b028e0b745ab0667a8d62c1731fb61b370910a3119c144a86c6d34a739c885524d757a92f39e63388ea49cc6a4d8d91165a003bfde40870581f3a956a3b3efd05101eed1c0fc76d1490e0bf4bfc9d4b489c42e3e227ae12feac4e8a2ec4bb55830416fc6e3fc24603e44ce4b4b92acca09b2cc4bbc49f617b7e3729d3a375952528b731b6fa726c7710c66a3e924091d99e4288e0f7ccb502ac0089c0da8dce5dd0d5354f00c955fc57f59a5ebc74b5267cb2cd161328cef3bee63ea3a0fa1acae5c899e9603088451c865939d3c176c90a00673296e4184510fe50e6ee78a6905b98fe77624de2c009e2cf28ae6130f7571a2657d62f1f9ecfa9d63690d01de63517ff92a0b48f5dc85d097b94f877873acb97c02a942cfb691e44dfa149aa2a2db102160639584373559cf49be8e5c59709c99507a8f71e31547432ca20fd2456a15a4938199b578af2feb4a70b88cbee8171920e09c0fca1a3705649247cea88b1e874a0d38bd6ebb6210db0001c6e14b1740759dd6da0ac309ce7b0a606662bd56b7a2a4315758e8fa92f002dffd2ce2e318dfd6c8143c5772f88a7908fa3b287b2c310f42f0ef4036ad9cb52b12d6f9e605905f3b8d3b07c4e927093c7253b74a2505dac7657471d3220d8855f4445fb4f450d74f866ec2b8c2a515b976b7ecff2a56e0776e07a36911cc35208f4200befbacc0b20c40306e36a63bf21f6f74303e2ede3da56d49f7339941b2d21d2c454e1733ac4e7e37fdc4c2328ca7ff2d71b06446bb5a3b9a87e5d47b74880f9dfaeec10cba6491b80772c372dabd7f209ca5529eecfb09df1a2cd794238ea06d93a53d09d56efc1add4eca2dfc9d1e671968f86338604b9a860453916071cf610fea9077d780cc512692e84a567e8a83a3d8fe1d630ac4543a484db1800d8fedb25e076da325d6d4b8b25f2d3be64c0232e369f547e2cdcac7eec420ca52557009a6d793ba15fc94835da168c9fe743a6e1b3e513e2276bb574755815f1ee347563619e54d757ac33356204290b8ab5caa0912279cdaecd87d8f9defc1450190a92e9e69d7d24ce6e04c774de850a8458b1382f146c3c351351355c837ee7d9d59f30132ecf79e80c2f101ef469bee701a8f789ae200f1cedf12d9fd52d7af809d19e12d86802031ec5b0e76d55167ac6506843f91ea48a8d644de9543b55232ecfe5931f24503937367d586267e6f378d959c5b1c520e9e57d3817597f7c61ec8476b6341782ee8d3fe2836392bb6f8f1880b405de267a90077637956559f17f8ac697467cc020aad745d6b8417bf289f95e2f376eabf4b569e77006b1f18539750a1d452e5521131c1194fa823f331d5bb6866c1871a7842c42cc1ddef202f3800f264c5f02282adbdd9ca37338aef26c69a4e3f23b20868e310692cd2a0015a6872be2490ee011f8bf3f44fb5007758f2c017472545b7029b0f9fd7c03d5c11bd7c57b75cbf7cc77ff58c698ef34201da514802049dcf4add3930c0818fde4fa9f2473e30434d1429d74422d31b74edfd8e09898e9097d6e7934ef3974a128049a369b733b75108594246ccb15fb1e311d8b5f8a20d5b83d659135f74a4bfe8c0030d6a678454849cb5cc304a8f6ac3d1cab0e7c7b344b101d1946dd37ebdab5d4694669e7b3d922d884dd464cf96973183af6bb369fdb6473a3980ded6842939bc43c347d5424ee1353a0034dcc41bab518f828700cd5910721a8dc3acba950dce3a041da50670b389d3be002650a2b69b827c51296545a5c3edadca642325ed8a34103c41baa43280c5eeeef5308f87499d147ed48a3bbefbca0b4791f0a5988de952ce7df27d80f80ca561f52753426b623a4c794b8e3c0432c9a0d3c98dd2c43ef788842556437bc47eb3e2d1f4c35f5b01af143361b5f73aacd2ae3aa09e3ea3f61417ff3b2d3e465536ebf6c1809f7f70a76fa2cb26600c7870eeff29f118746da86ba2f7a3cec466e9e17debce578c2ee4ed26c6c5416535664bc1d6b1ac54f022b5f3abfdf446df93306de56b9f8f4db195392cab0f17e9ce8ba255cf557522aeec77eb5f689e0f4968972d8614f03e37125a4bed83f89078be4ff098b64d898b0a4e8438feb051ec4ecaa6a301ab7eb16678e5d707a8026ca8ad07fc66b5313367e025bc293eb40cd7165015a76c62e5ed43f488a94d50f020c45614b1ffec7b4ab7f550664a85cc4672ba87b258b4a0ec7b31c1ed16171fd7c9c0a423d2ead68461bc407969d774d06f3dc119b7027d08b5ce13d6af2e3a69db758d3bc9e124a59e1048e731704f00514164865646ca9c6127cc5556d2e895dc4cd3cc1fa4f04e687ee3f64fe513aa70da54afae26d4da4f11472154340ba51de794510c853ac318a4973d8229535ff52a74740a27b8b45392741fafc521ba9a1511cbaea42d578dbce3c8c1bcf899971d30eb605acd43a551c17f9a1c8b203ccc61103c89a5b4056e1ee9b2b215a646606baf1218afbfac9a0bee95d4b1947e370c2764e882cb8fe78db291b28d350565f0b614a09d059e54596440a8d14a55058eaa0a64b5409b01db2b69c6607eb81292df61d8603495613b735d6710d4ec1afb55dafafbc320d7333555ea321f83271587d2c33428867de56c2cef71fe2b75a7d9b02280cd881ec93e8ff54147fb8e3249e8877e793a44e905d9e414c3a56f6b8dff603f56e6394ac494299849ee2fc563e554e12e623f1a62d82ffb1099fa1303e0229939dd6f319aba86e470df1413c0e02642bb805a4e0513261687e6241befc29d09f2638240dc88f73daee61d57c77fd73cf3cb4583756b085653c32cc967480f0f385241e4cbca21c7971e927860c838e7e116c4f58179a6e4f040589d2c1a758e43838b14ff91a810cdaaf60fdf68ca55f2ff41383dd8b9c332e8ecc42eb60169cfe4fe2502f3d7631c3c90c783626da012ad21096a0e096bfe7cadb3ea3fd7fae7727633219454fab8b69ae0b1c17e4e3ac8101dca5d152fdafc2ac74517b4767b00a27894bff9444d75fa3452cc684ca8733ff49307e4545f925f1f3b0c9488ea08e480627ded226f67655c8f330cc1bb94b15ca3984b9bb9a555c1bc71ca84d106bd86761339626f74b542bf0c9666b02bf86513a6b003a64158fec3601f0407acb943bc734ab2636cfda177d81c3def485202556d57164159159539682cc4e09b5784bb02f57a62865b92f1e965e33ce8d86da63ed6ac15a53204a706d35678b6079fbeaa63424ec2749c248e6563b14c353ca162577e29ad43f3fa512d0fd02800ae83b3a36b82cd24ffc0cfd3de9e840c2380964c581f9473125f9cd2c49da573a6c680cb590f1a2036e0f51e05540b3e5967ae650f256a228de75e882c7efa2637173062063569d91eaaefb209c13bb507d304f56f215c891eee4eae0ab88d69060ed28fde253504e98ca481ded2df49aba74013f32ef7924d48580c19596b35408ce2c29916dcea9e945bf76d7cb0fc0cc0e5e621aa6aca0bfab8636b44f8550be99cf4ecf4c50d59cc069bcdb19f30dfe0835ce1832444f618a7d3840b043d0dd016d9d0ad7ab9b642e6dd2e5741a7842ff64f5407da9679c54dff0d071a356ee91b6bbcd8eb76563aa748258bd10eb1aa6c3c08a6f7f94d3d8e43d0b22f75ff06922a0cd98e81abd2f9f68a7c4bf07ec3b1e896242cec1ac1c978a3dd3313ff12b1b78ba60b81d4d751a8651ac71c9810ab7db8b8367a1e59f66b35e74d9fd34b47ac0b1809a3e8822dd5bb5d8528f1d96937a4717bd151e47ce6236fe90c5e4ec4944de4dbe3636e48df352f9f4b0349c924bbb49a352365c1c32ff126bf3c0caa651395e26d51683e45d3d99d874d0171f7d1d4255d571fccb829438c3ed9470978fcfeeb9504755aabc198676278b13f076884e7ad52ca951b21887dcf1d5b7512d6661c55a29e971469d42341d63367b4ea3177f9b1cc3f559a027b122e1dad4b674440e7ca77228276f0db5fc5790d1fe456468a1ea4ad7735f798e5fc1ccb1e458b34a1c22aa679054ef49f3fa8b98fd3a730dd4c20de790e529a4b28a7327b5193c5457c29ff64360bf2d88aa0bbe6365a4cd669143398bff49db8f9fdec83e82c158e71ef9b2d73d1165735fddbeadca8f0d1da0984cb4a41b56b2cfab7f67f11f400c5640075bb28e7b05189e08065c75c7024fba588498caef5437a21a3828375d5ec3372770db649d793ad1e6a5c9d404afa0cc428139d86e8db690a44ed7ef0fc15d4c194679b814849fd311ac00a6c54501c3da341680d0e71987ef6383f4c4bb9368af8f18258bfe1b48f497947f11d94a11145f4d429db3be97cbb47eb92a82a72ea30e25f7af238a3347eb16fb53da0eca9bf66e7ef305675c3e5363e473aff8b3b6c7458a8a4d1d53f56e5454a1eaa29170a9de05001fd4038a1e8566acb59e3fc463e28aab361edc5a6df362cf5768cb83d847ccc3691e5f08168f129c102dfa66e696c6c33a53ca3313d6cb138c852311c735f121d5cdc82e536b1ff71e79d68c39dc3767758ff3ec80fd792cd108283b6d74000b394ee36c0458c25e458e0c653ff128a6f202a54fbb054ffdd618fa0be0859cd4eec7803933fd5147861dcdd6b859376cfd7c4f3f470250f24819caf1dc9df7be6ada7e95edb269ec35ffe0744d4fcea2c0a782122e573332de6715fe02c990251c4e7c1175f4b2be86574ce908b4399716941f85741bb93467f7b1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">死磕一道题是很危险的……</summary>
    
    
    
    <category term="test" scheme="https://dyd-true.github.io/categories/test/"/>
    
    
    <category term="暴力" scheme="https://dyd-true.github.io/tags/%E6%9A%B4%E5%8A%9B/"/>
    
    <category term="test" scheme="https://dyd-true.github.io/tags/test/"/>
    
    <category term="线段树" scheme="https://dyd-true.github.io/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
    <category term="网络流" scheme="https://dyd-true.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
    <category term="莫比乌斯反演" scheme="https://dyd-true.github.io/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
    <category term="二分" scheme="https://dyd-true.github.io/tags/%E4%BA%8C%E5%88%86/"/>
    
    <category term="杜教筛" scheme="https://dyd-true.github.io/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
    
    <category term="优先队列" scheme="https://dyd-true.github.io/tags/%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97/"/>
    
  </entry>
  
</feed>
