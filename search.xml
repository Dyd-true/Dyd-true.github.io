<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>luoguP5047 [Ynoi2019 模拟赛] Yuno loves sqrt technology II</title>
      <link href="/2022/03/25/luoguP5047-Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B-Yuno-loves-sqrt-technology-II/"/>
      <url>/2022/03/25/luoguP5047-Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B-Yuno-loves-sqrt-technology-II/</url>
      
        <content type="html"><![CDATA[<p>  比较板子，值域分块有点难想</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5047">Yuno loves sqrt technology II</a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>虽然有重复元素了，但没强制在线，考虑莫队，发现每次移动指针时改变的是<strong>点对区间的贡献</strong>，不好 $O(1)$ 移动指针，考虑二次离线，记 $f(i, [l, r])$ 表示“点 $i$ 对 $[l, r]$ 的贡献”，分类讨论：</p><ol><li>指针从 $[il, ir]$ 变为 $[il, r](r &gt; ir)$ ，则 $\Delta ans = \sum_{i = ir + 1}^r f(i, [il, i - 1])$  </li><li>指针从 $[il, ir]$ 变为 $[il, r](r &lt; ir)$ ，则 $\Delta ans = -\sum_{i = r + 1}^{ir} f(i, [il, i - 1])$  </li><li>指针从 $[il, ir]$ 变为 $[l, ir](l &lt; il)$ ，则 $\Delta ans = \sum_{i = l}^{il - 1} f(i, [i + 1, ir])$ </li><li> 指针从 $[il, ir]$ 变为 $[l, ir](l &gt; il)$ ，则 $\Delta ans = -\sum_{i = il}^{l - 1} f(i, [i + 1, ir])$ </li></ol><p>然后很套路的拆成前/后缀和，记 $f(i, j) = f(i, [1, j]), g(i, j) = f(i, [j, n])$ （前/后缀分开是因为逆序对点在前时贡献是“区间小于点的数”，在后是“区间大于点的数”，要分开），如第一类，就是 $\Delta ans = \sum_{i = ir + 1}^r f(i, [il, i - 1]) = \sum_{i = ir + 1}^r f(i, i - 1) - f(i, il)$ ，而第三类就是 $\Delta ans = \sum_{i = l}^{il - 1} f(i, [i + 1, ir]) = \sum_{i = l}^{il - 1} g(i, i + 1) - g(i, ir)$ </p><p>对于 $f(i, i - 1)$ 和 $g(i, i + 1)$ ，直接暴力求，用 BIT 就是 $O(n \log n)$ ，记得把它们前缀和了卡常；而 $f(i, il)$ 和 $g(i, ir)$ 根据套路直接打标记，然后……这里用 BIT 求就是 $O(n \sqrt{n} \log n)$ （ <strong>wfy</strong> 大佬说好像可以用条块分摊 $\log n$ 的方法卡，但在下是大常数选手），爆炸，仔细分析，对于 $f(i, il)$ 和 $g(i, ir)$ ，有 $O(n)$ 次修改和 $O(n \sqrt{n})$ 次查询，但 BIT 修改和查询都是 $O(\log n)$ 这显然不平均，为了平衡复杂度，考虑值域分块</p><p>我们用 BIT 想要维护的信息是“当前区间小于等于 $x$ 的数有多少个”，直接值域分块，记 $as[i]$ 表示“值小于第 $i$ 块最小值的数的个数”，再记 $ct[i]$ 表示“数 $i$ 所在块中值小于等于 $i$ 的数的个数”，这样，修改是 $O(\sqrt{n})$ 的，但询问变成了 $O(1)$ ；另外 BIT 也就不需要了， $f(i, i - 1)$ 和 $g(i, i + 1)$ 也用这个分块求</p><p>时间 $O(n \sqrt{n})$ ，注意常数</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>代码中的 $f[0/1]$ 代表 $f(i, i - 1)$ 和 $g(i, i + 1)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">namespace</span> FIO</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> *S, *E, buf[L], out[L];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (S == E ? E = (S = buf) + fread(buf, 1, L, stdin), (S == E ? EOF : *S++) : *S++)</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span>&#123; <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout), l = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">chk</span><span class="params">()</span></span>&#123; <span class="keyword">if</span> (l &gt;= L - <span class="number">5</span>) <span class="built_in">flus</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) t |= ch == <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        <span class="keyword">if</span> (t) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123; out[l++] = x, <span class="built_in">chk</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>, <span class="built_in">chk</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> FIO::flus;</span><br><span class="line"><span class="keyword">using</span> FIO::read;</span><br><span class="line"><span class="keyword">using</span> FIO::putc;</span><br><span class="line"><span class="keyword">using</span> FIO::write;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], nn;</span><br><span class="line">LL ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Q</span>&#123;</span> <span class="keyword">int</span> l, r, id; LL ans; &#125; q[N];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; xx;</span><br><span class="line"><span class="keyword">namespace</span> VBlock  <span class="comment">//值域分块</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> V = <span class="number">320</span>, NV = <span class="number">320</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span> <span class="keyword">int</span> l, r, as; &#125; b[NV];</span><br><span class="line">    <span class="keyword">int</span> bid[N], num, ct[N];</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nn; i += V) b[++num].l = i, b[num].r = i + V - <span class="number">1</span>;</span><br><span class="line">        b[num].r = nn;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = b[i].l; j &lt;= b[i].r; ++j) bid[j] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Node *t = &amp;b[bid[x]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= t-&gt;r; ++i) ct[i] += d;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bid[x] + <span class="number">1</span>; i &lt;= num; ++i) b[i].as += d;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> b[bid[x]].as + ct[x]; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> TOF <span class="comment">//Twice Offline</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">320</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Tag</span>&#123;</span> <span class="keyword">int</span> l, r, id, pos; &#125; tg1[N], tg2[N];</span><br><span class="line">    <span class="keyword">int</span> tp1 = <span class="number">0</span>, tp2 = <span class="number">0</span>;</span><br><span class="line">    LL f[<span class="number">2</span>][N];</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> bid[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) bid[i] = (i - <span class="number">1</span>) / B + <span class="number">1</span>;</span><br><span class="line">        std::<span class="built_in">sort</span>(q + <span class="number">1</span>, q + m + <span class="number">1</span>, [&amp;](Q x, Q y)&#123; <span class="keyword">return</span> bid[x.l] == bid[y.l] ? x.r &lt; y.r : x.l &lt; y.l; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">add_tag</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, il = q[<span class="number">1</span>].r + <span class="number">1</span>, ir = q[<span class="number">1</span>].r; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (il &gt; q[i].l) tg1[++tp1] = &#123;q[i].l, il - <span class="number">1</span>, -i, ir&#125;;</span><br><span class="line">            <span class="keyword">else</span>  <span class="keyword">if</span> (il &lt; q[i].l) tg1[++tp1] = &#123;il, q[i].l - <span class="number">1</span>, i, ir&#125;; </span><br><span class="line">            il = q[i].l;</span><br><span class="line">            <span class="keyword">if</span> (ir &lt; q[i].r) tg2[++tp2] = &#123;ir + <span class="number">1</span>, q[i].r, -i, il - <span class="number">1</span>&#125;;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ir &gt; q[i].r) tg2[++tp2] = &#123;q[i].r + <span class="number">1</span>, ir, i, il - <span class="number">1</span>&#125;;</span><br><span class="line">            ir = q[i].r;</span><br><span class="line">        &#125;</span><br><span class="line">        std::<span class="built_in">sort</span>(tg1 + <span class="number">1</span>, tg1 + tp1 + <span class="number">1</span>, [&amp;](Tag x, Tag y)&#123; <span class="keyword">return</span> x.pos &lt; y.pos; &#125;);</span><br><span class="line">        std::<span class="built_in">sort</span>(tg2 + <span class="number">1</span>, tg2 + tp2 + <span class="number">1</span>, [&amp;](Tag x, Tag y)&#123; <span class="keyword">return</span> x.pos &lt; y.pos; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">offline</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tp2; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (p &lt; tg2[i].pos &amp;&amp; ++p)</span><br><span class="line">            &#123;</span><br><span class="line">                f[<span class="number">0</span>][p] = f[<span class="number">0</span>][p - <span class="number">1</span>] + p - VBlock::<span class="built_in">ask</span>(a[p]) - <span class="number">1</span>;</span><br><span class="line">                VBlock::<span class="built_in">ins</span>(a[p], <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> l = tg2[i].l, r = tg2[i].r, k = (tg2[i].id &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>), id = tg2[i].id * k; l &lt;= r; ++l) q[id].ans += <span class="built_in">LL</span>(p - VBlock::<span class="built_in">ask</span>(a[l])) * k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (p &lt; n &amp;&amp; ++p)</span><br><span class="line">        &#123;</span><br><span class="line">            f[<span class="number">0</span>][p] = f[<span class="number">0</span>][p - <span class="number">1</span>] + p - VBlock::<span class="built_in">ask</span>(a[p]) - <span class="number">1</span>;</span><br><span class="line">            VBlock::<span class="built_in">ins</span>(a[p], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tp1; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (p &lt; tg1[i].pos &amp;&amp; ++p)</span><br><span class="line">            &#123;</span><br><span class="line">                VBlock::<span class="built_in">ins</span>(a[p], <span class="number">-1</span>);</span><br><span class="line">                f[<span class="number">1</span>][p] = f[<span class="number">1</span>][p - <span class="number">1</span>] + VBlock::<span class="built_in">ask</span>(a[p] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> l = tg1[i].l, r = tg1[i].r, k = (tg1[i].id &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>), id = tg1[i].id * k; l &lt;= r; ++l) q[id].ans += <span class="built_in">LL</span>(VBlock::<span class="built_in">ask</span>(a[l] - <span class="number">1</span>)) * k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (p &lt; n &amp;&amp; ++p)</span><br><span class="line">        &#123;</span><br><span class="line">            VBlock::<span class="built_in">ins</span>(a[p], <span class="number">-1</span>);</span><br><span class="line">            f[<span class="number">1</span>][p] = f[<span class="number">1</span>][p - <span class="number">1</span>] + VBlock::<span class="built_in">ask</span>(a[p] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">modui</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, il = q[<span class="number">1</span>].r + <span class="number">1</span>, ir = q[<span class="number">1</span>].r; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (il != q[i].l) q[i].ans += f[<span class="number">1</span>][il - <span class="number">1</span>] - f[<span class="number">1</span>][q[i].l - <span class="number">1</span>];</span><br><span class="line">            il = q[i].l;</span><br><span class="line">            <span class="keyword">if</span> (ir != q[i].r) q[i].ans += f[<span class="number">0</span>][q[i].r] - f[<span class="number">0</span>][ir];</span><br><span class="line">            ir = q[i].r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) q[i].ans += q[i - <span class="number">1</span>].ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) ans[q[i].id] = q[i].ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123; <span class="built_in">prev</span>(), <span class="built_in">add_tag</span>(), <span class="built_in">offline</span>(), <span class="built_in">modui</span>(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">lsh</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    xx.<span class="built_in">push_back</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) xx.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">    std::<span class="built_in">sort</span>(xx.<span class="built_in">begin</span>(), xx.<span class="built_in">end</span>());</span><br><span class="line">    xx.<span class="built_in">erase</span>(std::<span class="built_in">unique</span>(xx.<span class="built_in">begin</span>(), xx.<span class="built_in">end</span>()), xx.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) a[i] = std::<span class="built_in">lower_bound</span>(xx.<span class="built_in">begin</span>(), xx.<span class="built_in">end</span>(), a[i]) - xx.<span class="built_in">begin</span>();</span><br><span class="line">    nn = xx.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">read</span>(q[i].l), <span class="built_in">read</span>(q[i].r), q[i].id = i;</span><br><span class="line">    <span class="built_in">lsh</span>(), VBlock::<span class="built_in">prev</span>(), TOF::<span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">write</span>(ans[i]), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
            <tag> 莫队 </tag>
            
            <tag> 二次离线 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1654D</title>
      <link href="/2022/03/21/CF1654D/"/>
      <url>/2022/03/21/CF1654D/</url>
      
        <content type="html"><![CDATA[<p> 想到了，但很难实现</p><span id="more"></span><p><a href="https://codeforces.com/contest/1654/problem/D">Potion Brewing Class</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>有 $n(n \le 2 \times 10^5)$ 个未知正整数，给定 $n - 1$ 个形如“ $a_i : a_j = x : y(x, y \le n)$ ”的约束条件，要求给这 $n$ 个数赋值，使其满足所有条件，输出最小的 $\sum a_i$ ，答案对 $998244353$ 取模，保证一定有唯一解</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>由于保证有唯一解，所以可以把数看作点，条件看作边，这就是一棵树，我们发现只要一个数确定了，整棵树就确定了（但最初确定的那个数一定要合法），所以直接把树根先赋值为一个一定正确，但不一定最小的值，然后去确定整棵树，最后所有数字以前约掉公约数；由于有模数（最小共倍数太大了），我们要把每个数存成质因数分解的形式，有人用数组存直接实现，我 <del>太弱了</del> 只会用 <code>map</code> ，比他们多一个 $\log n$ </p><p>难点在实现上，考场上没打出来，下面是一些细节：</p><ol><li>给的 $x : y$ 可能不是最简的</li><li>对于把一个数分解质因数，可以在最初筛质数时给每个数记录一个最小质因数，每次把最小质因数除出来，单个时间为 $O(\log n)$ </li></ol><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">100</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, pr[N], ct = <span class="number">0</span>, mp[N], num[N], ans;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> to, x, y; &#125;;</span><br><span class="line">std::vector&lt;Edge&gt; G[N];</span><br><span class="line">std::map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ha, as;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC std::bitset&lt;N&gt; vis;</span><br><span class="line">    <span class="built_in">memset</span>(mp, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> mp);</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])&#123; pr[++ct] = i, mp[i] = i; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, t; j &lt;= ct &amp;&amp; <span class="built_in">LL</span>(pr[j]) * i &lt; N; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            mp[pr[j] * i] = std::<span class="built_in">min</span>(mp[pr[j]], mp[i]), vis[pr[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; y &gt;&gt;= <span class="number">1</span>, x = <span class="built_in">LL</span>(x) * x % P) <span class="keyword">if</span> (y &amp; <span class="number">1</span>) res = <span class="built_in">LL</span>(res) * x % P;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_ans</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i : as) res = <span class="built_in">LL</span>(res) * <span class="built_in">qpow</span>(i.fi, i.se) % P;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chkmin</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123; <span class="keyword">return</span> x &gt; y ? x = y, <span class="number">1</span> : <span class="number">0</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> now)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> e : G[x]) <span class="keyword">if</span> (e.to != fa)</span><br><span class="line">    &#123;</span><br><span class="line">        num[e.to] = <span class="built_in">LL</span>(now) * <span class="built_in">qpow</span>(e.x, P - <span class="number">2</span>) % P * e.y % P;</span><br><span class="line">        <span class="keyword">int</span> t = e.x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; t != <span class="number">1</span>; )</span><br><span class="line">        &#123;</span><br><span class="line">            cnt = <span class="number">0</span>, tp = mp[t];</span><br><span class="line">            <span class="keyword">while</span> (t % tp == <span class="number">0</span>) ++cnt, t /= tp;</span><br><span class="line">            <span class="built_in">chkmin</span>(as[tp], ha[tp] -= cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        t = e.y;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; t != <span class="number">1</span>; )</span><br><span class="line">        &#123;</span><br><span class="line">            cnt = <span class="number">0</span>, tp = mp[t];</span><br><span class="line">            <span class="keyword">while</span> (t % tp == <span class="number">0</span>) ++cnt, t /= tp;</span><br><span class="line">            ha[tp] += cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(e.to, x, num[e.to]);</span><br><span class="line">        t = e.x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; t != <span class="number">1</span>; )</span><br><span class="line">        &#123;</span><br><span class="line">            cnt = <span class="number">0</span>, tp = mp[t];</span><br><span class="line">            <span class="keyword">while</span> (t % tp == <span class="number">0</span>) ++cnt, t /= tp;</span><br><span class="line">            ha[tp] += cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        t = e.y;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; t != <span class="number">1</span>; )</span><br><span class="line">        &#123;</span><br><span class="line">            cnt = <span class="number">0</span>, tp = mp[t];</span><br><span class="line">            <span class="keyword">while</span> (t % tp == <span class="number">0</span>) ++cnt, t /= tp;</span><br><span class="line">            ha[tp] -= cnt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">prev</span>(), <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); T--; )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) G[i].<span class="built_in">clear</span>();</span><br><span class="line">        ha.<span class="built_in">clear</span>(), as.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b, c, d, t; i &lt; n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d), t = <span class="built_in">gcd</span>(c, d);</span><br><span class="line">            c /= t, d /= t;</span><br><span class="line">            G[a].<span class="built_in">push_back</span>(&#123;b, c, d&#125;), G[b].<span class="built_in">push_back</span>(&#123;a, d, c&#125;);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; c != <span class="number">1</span>; )</span><br><span class="line">            &#123;</span><br><span class="line">                cnt = <span class="number">0</span>, tp = mp[c];</span><br><span class="line">                <span class="keyword">while</span> (c % tp == <span class="number">0</span>) ++cnt, c /= tp;</span><br><span class="line">                ha[tp] += cnt;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> cnt, tp; d != <span class="number">1</span>; )</span><br><span class="line">            &#123;</span><br><span class="line">                cnt = <span class="number">0</span>, tp = mp[d];</span><br><span class="line">                <span class="keyword">while</span> (d % tp == <span class="number">0</span>) ++cnt, d /= tp;</span><br><span class="line">                ha[tp] += cnt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        as = ha;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>, num[<span class="number">1</span>] = <span class="built_in">get_ans</span>());</span><br><span class="line">        <span class="keyword">int</span> iv = <span class="built_in">qpow</span>(<span class="built_in">get_ans</span>(), P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) num[i] = <span class="built_in">LL</span>(iv) * num[i] % P;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ans = (ans + num[i]) % P;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dfs </tag>
            
            <tag> CF </tag>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5046 [Ynoi2019 模拟赛] Yuno loves sqrt technology I</title>
      <link href="/2022/03/20/luoguP5046-Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B-Yuno-loves-sqrt-technology-I/"/>
      <url>/2022/03/20/luoguP5046-Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B-Yuno-loves-sqrt-technology-I/</url>
      
        <content type="html"><![CDATA[<p> 预处理不好想</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5046">Yuno loves sqrt technology I</a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>首先明确一个地方：对于两个长度为 $x$ 的区间（依次设为 $1, 2$ ），用归并排序可以 $O(x)$ 求出区间 $1$ 中的数与区间 $2$ 中的数形成的逆序对数（即区间 $1$ 对区间 $2$ 的贡献），具体方法是：将两个区间按权值排序，用双指针扫，若区间 $1$ 当前数小于区间 $2$ ，就不管；否则若区间 $1$ 当前数大于区间 $2$ ，说明区间 $1$ 当前数及后面所有数都会对 $2$ 当前数有贡献，记录即可，代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> nx, <span class="keyword">int</span> ny)</span> <span class="comment">//归并求逆序对</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> ix = <span class="number">1</span>, iy = <span class="number">1</span>; ix &lt;= nx &amp;&amp; iy &lt;= ny; )</span><br><span class="line">        <span class="keyword">if</span> (x[ix] &lt; y[iy]) ++ix;</span><br><span class="line">        <span class="keyword">else</span> res += nx - ix + <span class="number">1</span>, ++iy;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再看题，直接求当然死挂， <del>看 lxl</del> 由于强制在线考虑分块，设块长为 $B$ ，考虑每个询问，分整块贡献、散点贡献、整块和散点的相互贡献讨论：</p><ol><li>整块贡献，记 <code>as[i,j]</code> 表示“块 $i$ 到块 $j$ 这段区间的逆序对数”，直接可得整块答案， $O(1)$ </li><li>散点贡献，记 <code>pre[i]/suf[i]</code> 表示“点 $i$ 到<strong>所在块</strong>的左/右端点这段区间的逆序对数”，于是两边的散点单独的贡献可以直接得答案；对于两边互相影响，归并排序求， $O(B)$ </li><li>整块和散点，记 <code>cnt[j, i]</code> （调转下标是为了卡常）为“点 $i$ 对第 $j$ 块的贡献”，对 <code>cnt</code> 怼一个前缀和即可枚举整块 $O(\frac{n}{B})$ 得答案</li></ol><p>然后看如何预处理， <code>pre/suf</code> 可以用树状数组把每个块扫一遍，记录每个点贡献即可，一个技巧是先计算 <code>pre</code> ，再计算 <code>suf</code> 时从上一次计算的树状数组里面删数，卡常，时间为 $O(\frac{n}{B} * B \log B) = O(n \log B)$ </p><p> <code>cnt</code> 就是直接把每个块和整个区间归并一下，注意考虑点在块前还是块后，记录每个点贡献即可， $O(n + B)$ </p><p> <code>as</code> 用区间 dp 的思想处理，不难发现 $as[i, j] = as[i + 1, j] + as[i, j - 1] - as[i + 1, j - 1] + (第i块对第j块的贡献)$ ，我们发现第 $i$ 块对第 $j$ 块的贡献可以用 $cnt$ 查，而 $as$ 的初始化就是 $as[i, i] = pre[第i块的右端点]$ ，于是可以 $O(B^2)$ 解决</p><p>至此，时间复杂度为 $O(n \log B + n + B + B^2 + m (1 + B + \frac{n}{B}))$ ，我们无脑取 $B = \sqrt{n}$ ，时间大概就是 $O(n \sqrt{n})$ ，注意常数</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">namespace</span> FIO</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> *E, *S, buf[L], out[L];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (E == S ? E = (S = buf) + fread(buf, 1, L, stdin), (E == S ? EOF : *S++) : *S++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> ( ; ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) t |= ch == <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        <span class="keyword">if</span> (t) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span>&#123; <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout), l = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">check</span><span class="params">()</span></span>&#123; <span class="keyword">if</span> (l &gt;= L - <span class="number">5</span>) <span class="built_in">flus</span>(); &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123; out[l++] = x, <span class="built_in">check</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>, <span class="built_in">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> FIO::read;</span><br><span class="line"><span class="keyword">using</span> FIO::flus;</span><br><span class="line"><span class="keyword">using</span> FIO::putc;</span><br><span class="line"><span class="keyword">using</span> FIO::write;</span><br><span class="line"><span class="keyword">using</span> PII = std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">100</span>, B = <span class="number">320</span>, NB = <span class="number">320</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">cnt[j,i]:点i与块j中的数形成的逆序对数的前缀和(点在块内没有意义)</span></span><br><span class="line"><span class="comment">pre[i]/suf[i]:每个点到所在块前/后缀逆序对数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">int</span> n, m, a[N], num = <span class="number">0</span>, bl[N], cnt[NB][N], pre[N], suf[N]; </span><br><span class="line">PII a2[N], a3[N]; <span class="comment">//排序用，a2给块,a3给整个序列</span></span><br><span class="line">LL as[NB][NB], ans; <span class="comment">//as[i][j]:块i到块j的逆序对数</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Block</span>&#123;</span> <span class="keyword">int</span> l, r; &#125; b[NB];</span><br><span class="line"><span class="keyword">namespace</span> BIT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lb(x) ((x) &amp; (-(x)))</span></span><br><span class="line">    <span class="keyword">int</span> ct[N];</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d)</span></span>&#123; <span class="keyword">for</span> (; x &lt;= n; x += <span class="built_in">lb</span>(x)) ct[x] += d; &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x; x ^= <span class="built_in">lb</span>(x)) res += ct[x];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">undef</span> lb</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> nx, <span class="keyword">int</span> ny)</span> <span class="comment">//归并求逆序对</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> ix = <span class="number">1</span>, iy = <span class="number">1</span>; ix &lt;= nx &amp;&amp; iy &lt;= ny; )</span><br><span class="line">        <span class="keyword">if</span> (x[ix] &lt; y[iy]) ++ix;</span><br><span class="line">        <span class="keyword">else</span> res += nx - ix + <span class="number">1</span>, ++iy;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">ready</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="comment">//计算每个块内前后缀信息</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    Block *x = &amp;b[id];</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x-&gt;l; i &lt;= x-&gt;r; ++i) bl[i] = id;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x-&gt;l; i &lt;= x-&gt;r; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        BIT::<span class="built_in">add</span>(a[i], <span class="number">1</span>);</span><br><span class="line">        t += BIT::<span class="built_in">ask</span>(n) - BIT::<span class="built_in">ask</span>(a[i]);</span><br><span class="line">        pre[i] = t;</span><br><span class="line">    &#125;</span><br><span class="line">    as[id][id] = t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x-&gt;l; i &lt;= x-&gt;r; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        suf[i] = t;</span><br><span class="line">        BIT::<span class="built_in">add</span>(a[i], <span class="number">-1</span>);</span><br><span class="line">        t -= BIT::<span class="built_in">ask</span>(a[i] - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    std::<span class="built_in">sort</span>(a2 + x-&gt;l, a2 + x-&gt;r + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = x-&gt;l; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &lt;= x-&gt;r &amp;&amp; a3[i].fi &gt; a2[j].fi) ++j;</span><br><span class="line">        <span class="keyword">if</span> (a3[i].se &lt; x-&gt;l) cnt[id][a3[i].se] = j - x-&gt;l;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a3[i].se &gt; x-&gt;r) cnt[id][a3[i].se] = x-&gt;r - j + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) cnt[id][i] += cnt[id][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span></span>&#123; <span class="keyword">return</span> cnt[id][r] - cnt[id][l - <span class="number">1</span>]; &#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">ready2</span><span class="params">()</span> <span class="comment">//计算as</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= num; ++len)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j; (j = i + len - <span class="number">1</span>) &lt;= num; ++i) as[i][j] = as[i + <span class="number">1</span>][j] + as[i][j - <span class="number">1</span>] - as[i + <span class="number">1</span>][j - <span class="number">1</span>] + <span class="built_in">get</span>(b[i].l, b[i].r, j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> tp1[N], tp2[N], ct1, ct2, ll, rr;</span><br><span class="line">    ct1 = ct2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ((ll = bl[l]) == (rr = bl[r]))</span><br><span class="line">    &#123;</span><br><span class="line">        Block *x = &amp;b[bl[l]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x-&gt;l; i &lt;= x-&gt;r; ++i)</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= a2[i].se &amp;&amp; r &gt;= a2[i].se) tp2[++ct2] = a2[i].fi;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (a2[i].se &lt; l) tp1[++ct1] = a2[i].fi;</span><br><span class="line">        ans = pre[r] - (l == x-&gt;l ? <span class="number">0</span> : pre[l - <span class="number">1</span>]) - <span class="built_in">merge</span>(tp1, tp2, ct1, ct2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ans = as[ll + <span class="number">1</span>][rr - <span class="number">1</span>] + suf[l] + pre[r];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = ll + <span class="number">1</span>; i &lt; rr; ++i) ans = ans + <span class="built_in">get</span>(l, b[ll].r, i) + <span class="built_in">get</span>(b[rr].l, r, i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = b[ll].l; i &lt;= b[ll].r; ++i) <span class="keyword">if</span> (a2[i].se &gt;= l) tp1[++ct1] = a2[i].fi;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = b[rr].l; i &lt;= b[rr].r; ++i) <span class="keyword">if</span> (a2[i].se &lt;= r) tp2[++ct2] = a2[i].fi;</span><br><span class="line">        ans = ans + <span class="built_in">merge</span>(tp1, tp2, ct1, ct2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]), a2[i] = a3[i] = &#123;a[i], i&#125;;</span><br><span class="line">    std::<span class="built_in">sort</span>(a3 + <span class="number">1</span>, a3 + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += B) b[++num].l = i, b[num].r = i + B - <span class="number">1</span>;</span><br><span class="line">    b[num].r = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num; ++i) <span class="built_in">ready</span>(i);</span><br><span class="line">    <span class="built_in">ready2</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l, r; m--; <span class="built_in">write</span>(ans), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>)) <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">ask</span>(l ^ ans, r ^ ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最小割树</title>
      <link href="/2022/03/18/%E6%9C%80%E5%B0%8F%E5%89%B2%E6%A0%91/"/>
      <url>/2022/03/18/%E6%9C%80%E5%B0%8F%E5%89%B2%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 一种快速求多次最小割的办法</p><span id="more"></span><h1 id="最小割树"><a href="#最小割树" class="headerlink" title="最小割树"></a>最小割树</h1><p>即 Gomory-Hu Tree ，是用来解决无向图最小割的问题的</p><h2 id="最小割"><a href="#最小割" class="headerlink" title="最小割"></a>最小割</h2><p>一个无向图的最小割是对于两个点来说的，形式化的：</p><p>对于无向图 $G = (V, E)$ ，若 $x, y \in V$ ，且存在边集 $S \sqsubseteq E$ ，使得删去 $S$ 后点 $x, y$ 不再联通，则称 $S$ 为 $x, y$ 的一个割；定义 $S$ 的权值为其中所有边权和，在所有的割中，权值最小的就叫做最小割</p><p>感性理解就是删掉权值和尽可能小的边，使得两点不联通</p><h2 id="最大流最小割定理"><a href="#最大流最小割定理" class="headerlink" title="最大流最小割定理"></a>最大流最小割定理</h2><p>在一个网络流中，能够从源点到达汇点的最大流量等于如果从网络中移除就能够导致网络流中断的边的集合的最小容量和，即在任何网络中，最大流的值等于最小割的容量</p><p>证明略</p><h2 id="最小割树-1"><a href="#最小割树-1" class="headerlink" title="最小割树"></a>最小割树</h2><p>定义一棵树 $T$ 为最小割树，如果对于树上的所有边 $(s,t)$ ，树上去掉 $(s,t)$ 后产生的两个集合恰好是原图上 $(s,t)$ 的最小割把原图分成的两个集合，且边 $(u,v)$ 的权值等于原图上 $(u,v)$ 的最小割</p><p>感性来说，就是一种特殊的树，树上两点路径上的最小权值就是原图两点的最小割</p><h2 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h2><p>最小割树的构造是递归实现的，假设递归到了点集 $P$ ，我们任取 $x, y \in P$ ，对它们做一次最小割，设答案为 $ans$ ，然后在树上连边 $(x, y, ans)$ ；去掉最小割中的边后， $P$ 必然被分成两个不联通的子集 $S_1, S_2$ ，我们递归处理 $S_1, S_2$ 即可，时间 $O(n \times 网络流)$ ，这里用 Dinic ，是 $O(n^3 m)$ ，跑不满（尤其是我们每次随机选两个点，很不好卡）</p><p>关于“树上两点路径上的最小权值就是原图两点的最小割”，可以感性理解一下，证明自己 baidu 吧</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>以<a href="https://www.luogu.com.cn/problem/P4897">这个题</a>为例</p><p>实现时有个技巧，我们可以利用 Dinic 的最后一次 bfs 得到的分成来判断每个点在那个联通图中</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span> + <span class="number">100</span>, M = <span class="number">1500</span> + <span class="number">100</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Q;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w; &#125;;</span><br><span class="line"><span class="keyword">namespace</span> Dinic</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> cur[N], dep[N], S, T, idx = <span class="number">0</span>, h[N];</span><br><span class="line">    Edge e[M &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; <span class="built_in">add</span>(x, y, z), <span class="built_in">add</span>(y, x, <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _s, <span class="keyword">int</span> <span class="keyword">_t</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        S = _s, T = <span class="keyword">_t</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; idx; i += <span class="number">2</span>) e[i].w = (e[i].w + e[i ^ <span class="number">1</span>].w), e[i ^ <span class="number">1</span>].w = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(dep, <span class="number">0</span>, <span class="keyword">sizeof</span> dep);</span><br><span class="line">        std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (q.<span class="built_in">push</span>(S), dep[S] = <span class="number">1</span>, cur[S] = h[S]; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne) <span class="keyword">if</span> (!dep[y = e[i].ver] &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                dep[y] = dep[x] + <span class="number">1</span>, cur[y] = h[y];</span><br><span class="line">                <span class="keyword">if</span> (y == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> lim)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == T) <span class="keyword">return</span> lim;</span><br><span class="line">        <span class="keyword">int</span> t, y, flow = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; ~i &amp;&amp; flow &lt; lim; i = e[i].ne)</span><br><span class="line">        &#123;</span><br><span class="line">            cur[x] = i;</span><br><span class="line">            <span class="keyword">if</span> (dep[y = e[i].ver] == dep[x] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(t = <span class="built_in">find</span>(y, std::<span class="built_in">min</span>(lim - flow, e[i].w)))) dep[y] = <span class="number">-1</span>;</span><br><span class="line">                e[i].w -= t, e[i ^ <span class="number">1</span>].w += t, flow += t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">(<span class="keyword">int</span> _s, <span class="keyword">int</span> <span class="keyword">_t</span>)</span> <span class="comment">//本题不用开long long</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>(_s, <span class="keyword">_t</span>);</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, flow;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>()) <span class="keyword">while</span> (flow = <span class="built_in">find</span>(S, INF)) res += flow;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> GHT <span class="comment">//Gomory-Hu Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> D = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> nd[N], h[N], idx = <span class="number">0</span>, dep[N], f[N][D], mn[N][D];</span><br><span class="line">    std::default_random_engine eee&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    Edge e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">        STC <span class="keyword">int</span> tp1[N], tp2[N];</span><br><span class="line">        <span class="keyword">int</span> s, t, flow, ct1 = <span class="number">0</span>, ct2 = <span class="number">0</span>;</span><br><span class="line">        s = nd[l], t = nd[l + <span class="number">1</span>];</span><br><span class="line">        flow = Dinic::<span class="built_in">dinic</span>(s, t);</span><br><span class="line">        <span class="built_in">add</span>(s, t, flow), <span class="built_in">add</span>(t, s, flow);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i) (Dinic::dep[nd[i]] ? tp1[++ct1] : tp2[++ct2]) = nd[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ct1; ++i) nd[i + l - <span class="number">1</span>] = tp1[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ct2; ++i) nd[i + l + ct1 - <span class="number">1</span>] = tp2[i];</span><br><span class="line">        <span class="built_in">build</span>(l, l + ct1 - <span class="number">1</span>), <span class="built_in">build</span>(l + ct1, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (q.<span class="built_in">push</span>(<span class="number">1</span>), dep[<span class="number">1</span>] = <span class="number">1</span>; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne) <span class="keyword">if</span> (!dep[y = e[i].ver])</span><br><span class="line">            &#123;</span><br><span class="line">                dep[y] = dep[x] + <span class="number">1</span>, f[y][<span class="number">0</span>] = x, mn[y][<span class="number">0</span>] = e[i].w;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; D; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                mn[i][j] = std::<span class="built_in">min</span>(mn[i][j - <span class="number">1</span>], mn[f[i][j - <span class="number">1</span>]][j - <span class="number">1</span>]);</span><br><span class="line">                f[i][j] = f[f[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) nd[i] = i;</span><br><span class="line">        <span class="built_in">shuffle</span>(nd + <span class="number">1</span>, nd + <span class="number">1</span> + n, eee); <span class="comment">//随机化</span></span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, n), <span class="built_in">bfs</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = INF;</span><br><span class="line">        <span class="keyword">if</span> (dep[x] &gt; dep[y]) std::<span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) <span class="keyword">if</span> (dep[f[y][i]] &gt;= dep[x]) res = std::<span class="built_in">min</span>(res, mn[y][i]), y = f[y][i];</span><br><span class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">return</span> res == INF ? <span class="number">-1</span> : res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) <span class="keyword">if</span> (f[x][i] != f[y][i])</span><br><span class="line">        &#123;</span><br><span class="line">            res = std::<span class="built_in">min</span>(res, std::<span class="built_in">min</span>(mn[x][i], mn[y][i]));</span><br><span class="line">            x = f[x][i], y = f[y][i];</span><br><span class="line">        &#125;</span><br><span class="line">        res = std::<span class="built_in">min</span>(res, std::<span class="built_in">min</span>(mn[x][<span class="number">0</span>], mn[y][<span class="number">0</span>]));</span><br><span class="line">        <span class="keyword">return</span> res == INF ? <span class="number">-1</span> : res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> <span class="comment">//因为数据有误,给定图的真实点数应该是n+1个,编号为0到n</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(Dinic::h, <span class="number">-1</span>, <span class="keyword">sizeof</span> Dinic::h);</span><br><span class="line">    <span class="built_in">memset</span>(GHT::h, <span class="number">-1</span>, <span class="keyword">sizeof</span> GHT::h);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m), ++n; <span class="comment">//更正标号</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w), Dinic::<span class="built_in">dad</span>(++u, ++v, w), Dinic::<span class="built_in">dad</span>(v, u, w);</span><br><span class="line">    GHT::<span class="built_in">work</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;Q);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u, v; Q--; <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, GHT::<span class="built_in">ask</span>(++u, ++v))) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外，本题 $n$ 小而 $Q$ 大，可以处理出 $n^2$ 询问存下来，直接回答，就不必用树上倍增了</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络流 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 树型结构 </tag>
            
            <tag> 最小割树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4003 无限之环</title>
      <link href="/2022/03/04/luoguP4003-%E6%97%A0%E9%99%90%E4%B9%8B%E7%8E%AF/"/>
      <url>/2022/03/04/luoguP4003-%E6%97%A0%E9%99%90%E4%B9%8B%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<p> 网络流建图</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4003">无限之环</a></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>典型的网络流，难点在建图（我改了三次建图方法），以下简述，可以对照代码理解：</p><p>将格子编号为 $id[x, y]$ ，将格子的四边编号为 $idm[x, y, 0/1/2/3]$ ，把格子黑白染色， $S$ 连向黑点，白点连向 $T$ </p><p>分接头数讨论：</p><ol><li>接头数为 $0$ ，不管</li><li>接头数为 $1$ ，直接建</li><li>接头数为 $2$ ，建四个辅助点代表四个方向，记为 $tct[0 \sim 3]$ ，黑点就由 $id[x, y]$ 向不用旋转就可接上的辅助点连容量为 $1$ 的边，再从不用旋转就可接上的辅助点向对面（上对下，左对右）连容量为 $1$ ，**代价为 $1$**的边（这就模拟了旋转），最后辅助点向对应的 $idm$ 连边；白点同理</li><li>接头数为 $3$ ，类似于为 $2$ ，只是代价设计不同</li><li>接头数为 $4$ ，直接连</li></ol><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2000</span> + <span class="number">100</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, S, T, a[N][N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w, c; &#125; e[N * N];</span><br><span class="line"><span class="keyword">int</span> h[N * <span class="number">15</span>], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> ct = <span class="number">0</span>, id[N][N], idm[N][N][<span class="number">4</span>], dx[<span class="number">4</span>] = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, dy[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> mnc, mxf, cur[N * <span class="number">15</span>], dis[N * <span class="number">15</span>], goal = <span class="number">0</span>, tct[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[N * <span class="number">15</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span></span>&#123; e[idx] = &#123;h[x], y, z, c&#125;, h[x] = idx++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span></span>&#123; <span class="built_in">add</span>(x, y, z, c), <span class="built_in">add</span>(y, x, <span class="number">0</span>, -c); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tb1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> t[<span class="number">4</span>])</span> <span class="comment">//tb:to_build,下同</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1就不必建辅助点了</span></span><br><span class="line">    <span class="keyword">if</span> ((x + y) &amp; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dad</span>(S, id[x][y], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) t[i] ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (!t[i])&#123; t[i ^ <span class="number">1</span>] = <span class="number">2</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(id[x][y], idm[x][y][i], <span class="number">1</span>, t[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) t[i] ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (!t[i])&#123; t[i ^ <span class="number">1</span>] = <span class="number">2</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(idm[x][y][i], id[x][y], <span class="number">1</span>, t[i]);</span><br><span class="line">        <span class="built_in">dad</span>(id[x][y], T, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tb2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> t[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((x + y) &amp; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dad</span>(S, id[x][y], <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (t[<span class="number">0</span>] == t[<span class="number">1</span>]) <span class="comment">//直线直接建</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(id[x][y], idm[x][y][i], <span class="number">1</span>, <span class="number">0</span>); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) tct[i] = ++ct; <span class="comment">//辅助点</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(id[x][y], tct[i], <span class="number">1</span>, <span class="number">0</span>), <span class="built_in">dad</span>(tct[i], tct[i ^ <span class="number">1</span>], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(tct[i], idm[x][y][i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (t[<span class="number">0</span>] == t[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(idm[x][y][i], id[x][y], <span class="number">1</span>, <span class="number">0</span>); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) tct[i] = ++ct;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(tct[i], id[x][y], <span class="number">1</span>, <span class="number">0</span>), <span class="built_in">dad</span>(tct[i ^ <span class="number">1</span>], tct[i], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(idm[x][y][i], tct[i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dad</span>(id[x][y], T, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tb3</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> t[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> where;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) tct[i] = ++ct;</span><br><span class="line">    <span class="keyword">if</span> ((x + y) &amp; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dad</span>(S, id[x][y], <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(id[x][y], tct[i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (!t[i])&#123; t[i ^ <span class="number">1</span>] = <span class="number">2</span>, where = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(tct[i], tct[where], <span class="number">1</span>, t[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(tct[i], idm[x][y][i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(tct[i], id[x][y], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (!t[i])&#123; t[i ^ <span class="number">1</span>] = <span class="number">2</span>, where = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="keyword">if</span> (t[i]) <span class="built_in">dad</span>(tct[where], tct[i], <span class="number">1</span>, t[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(idm[x][y][i], tct[i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">dad</span>(id[x][y], T, <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tb4</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((x + y) &amp; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dad</span>(S, id[x][y], <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(id[x][y], idm[x][y][i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">3</span>; ++i) <span class="built_in">dad</span>(idm[x][y][i], id[x][y], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">dad</span>(id[x][y], T, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> <span class="comment">//为了方便,把右和下换一下,即上下右左</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">int</span> t[<span class="number">4</span>], s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) id[i][j] = ++ct;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m + <span class="number">1</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            idm[i][j][<span class="number">0</span>] = idm[i - <span class="number">1</span>][j][<span class="number">1</span>] = ++ct;</span><br><span class="line">            idm[i][j][<span class="number">3</span>] = idm[i][j - <span class="number">1</span>][<span class="number">2</span>] = ++ct;</span><br><span class="line">        &#125;</span><br><span class="line">    S = ++ct, T = ++ct;</span><br><span class="line">    <span class="keyword">int</span> gs = <span class="number">0</span>, gt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, k, ta; j &lt;= m; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (k = s = <span class="number">0</span>, ta = a[i][j]; k &lt;= <span class="number">3</span>; ++k) s += (t[k] = ((ta &gt;&gt; k) &amp; <span class="number">1</span>));</span><br><span class="line">            std::<span class="built_in">swap</span>(t[<span class="number">1</span>], t[<span class="number">2</span>]); </span><br><span class="line">            <span class="keyword">if</span> (s == <span class="number">1</span>) <span class="built_in">tb1</span>(i, j, t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (s == <span class="number">2</span>) <span class="built_in">tb2</span>(i, j, t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (s == <span class="number">3</span>) <span class="built_in">tb3</span>(i, j, t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (s == <span class="number">4</span>) <span class="built_in">tb4</span>(i, j);</span><br><span class="line">            <span class="keyword">if</span> ((i + j) &amp; <span class="number">1</span>) gs += s; <span class="comment">//奇数为出点,偶数为入点</span></span><br><span class="line">            <span class="keyword">else</span> gt += s;</span><br><span class="line">        &#125;</span><br><span class="line">    goal = std::<span class="built_in">max</span>(gs, gt); <span class="comment">//不这样的话1*1的图要挂</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    <span class="built_in">memcpy</span>(cur, h, <span class="keyword">sizeof</span> h);</span><br><span class="line">    std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (q.<span class="built_in">push</span>(S), dis[S] = <span class="number">0</span>, vis[S] = <span class="literal">true</span>; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        vis[x] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne) <span class="keyword">if</span> (dis[y = e[i].ver] &gt; dis[x] + e[i].c &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            dis[y] = dis[x] + e[i].c;</span><br><span class="line">            <span class="keyword">if</span> (!vis[y]) vis[y] = <span class="literal">true</span>, q.<span class="built_in">push</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] != INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> lim)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == T) <span class="keyword">return</span> lim;</span><br><span class="line">    vis[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, y, t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; ~i &amp;&amp; flow &lt; lim; i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        cur[x] = i;</span><br><span class="line">        <span class="keyword">if</span> (!vis[y = e[i].ver] &amp;&amp; dis[y] == dis[x] + e[i].c &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">find</span>(y, std::<span class="built_in">min</span>(lim - flow, e[i].w));</span><br><span class="line">            e[i].w -= t, e[i ^ <span class="number">1</span>].w += t, flow += t, mnc += t * e[i].c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vis[x] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mcmf</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mnc = mxf = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flow;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">spfa</span>()) <span class="keyword">while</span> ((flow = <span class="built_in">find</span>(S, INF))) mxf += flow; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line">    <span class="built_in">build</span>(), <span class="built_in">mcmf</span>();</span><br><span class="line">    <span class="keyword">if</span> (mxf &lt; goal) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, mnc);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> 网络流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP2304 [NOI2015] 小园丁与老司机</title>
      <link href="/2022/02/27/luoguP2304-NOI2015-%E5%B0%8F%E5%9B%AD%E4%B8%81%E4%B8%8E%E8%80%81%E5%8F%B8%E6%9C%BA/"/>
      <url>/2022/02/27/luoguP2304-NOI2015-%E5%B0%8F%E5%9B%AD%E4%B8%81%E4%B8%8E%E8%80%81%E5%8F%B8%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<p> 啊对对对……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P2304">小园丁与老司机</a></p><h2 id="老司机的时间"><a href="#老司机的时间" class="headerlink" title="老司机的时间"></a>老司机的时间</h2><p>关于最长路，显然 dp ，我们发现是没有向下的，而且数据也提示我们把 $y_i$ 作为 dp 的阶段，令 <code>d[i]</code> 表示到点 $(x_i, y_i)$ 的最长长度，明显， $d[i]$ 由 $(x_i, y_i)$ 左、右、左下、右下和正下方的点转移，由于以 $y_i$ 为阶段，左下、右下和正下方的点是已知的（可以预处理出每个点向上转移到那里），但左右的点可以互相转移，顺序未知，考虑高斯消元，但高斯他这次不靠谱了，因为方程里有个 $\max$ ，那……我们就只好枚举每层（ $y_i$ 相等的点为一层）的 dp 顺序，这不爆炸？</p><p><del>看题解</del> 发现，我们走的一定是一段连续的区间，如图，若我们从点 $A$ 进入该层，从点 $B$ 离开，会发现射线 $BA$ 上的点我们都可达，而 $B$ 另一侧的点都不可达（这是因为只能去往<strong>最近的未到过的点</strong>，如果我们取了 $B$ 另一侧的点，说明我们一定到过了 $B$ ，那就不可能再回到 $B$ 了）</p><p><img src="https://s2.loli.net/2022/02/27/CGdcZ2ORIwn6bJg.png" alt="dp"></p><p>所以，我们对每一层，把该层的点按 $x_i$ 升序排序，然后处理出前/后缀？这样确实可以 dp 了，设 $d[i]$ 表示“以点 $(x_i, y_i)$ 作为它所在层的出点（即上图的点 $B$ ）的最长路长度”，计算时先枚举层数（可以把点排序来做到按层数转移），把本层从下面转移的全都转移了，再考虑本层的情况，但，难打的和……一样</p><p>我们再 <del>瞟一眼题解</del> 思考一下，发现可以拆点，把射线向左/右分开，更具体地，我们把一个点分成三个：左、右、上，分别代表从这个点向左走、向右走、向上走（都是必须走），如图：</p><p><img src="https://s2.loli.net/2022/02/27/iyvkt5QFEP1bnHx.png" alt="拆点"></p><p>黑色是向上点（你会发现所有点最后都走到一个黑色点，因为只有黑色点会连出向上一层的边）；红色是左向，蓝色是右向；所有横向走的边权都为 $1$ ，代表每走一次就多取了一个点；纵向的边权为 $0$ ，代表同一个点的不同状态</p><p>以上上幅图的 $A$ 进 $B$ 出为例，设 $A$ 是 $4$ 号点， $B$ 是 $2$ 号点，我们从 $A$ 到 $B$ 的路径就是 $下层 \to 红3 \to 红2 \to 黑2 \to 上层$ ，这里我们会发现 $4$ 号点及右边的 $5$ 号点没算，所以我们把 $红3$ 的入边的权值设为 $3$ （因为只要从 $红4$ 入，就意味着<strong>必须从左边某个点出</strong>，所以不连 $4$ ，直接连向 $3$ ，那么 $4, 5$ 号是必定可达的）</p><p>这里有一个要注意的地方，从起点开始就可以横着走到 $(x, 0)$ ，所以 dp 的起点是原点的 $红、蓝、黑$ 三个点</p><p>用以上方法，我们可以建出一个点数为 $3n$ 的 DAG ，直接在上面 dp 即可，比预处前/后缀简单（但也没简单多少，这道题就跟……一样），还有一个问题是要求方案（园丁的题也要用），记录来向即可</p><h2 id="小园丁的时间"><a href="#小园丁的时间" class="headerlink" title="小园丁的时间"></a>小园丁的时间</h2><p>我们把向上的黑点记作 $U$ ，向左、右的分别记作 $L, R$ ，明显，不合法的边是最长路上从 $U$ 型点上出发的所有边</p><p>我们新建一张图，初始只有 $n$ 个点，我们把所有可以在最长路上的边加入图中，上界为 $+ \infty$ ，下界为 $1$ ；然后从源点向每个点连边、从每个点向汇点连边，都是上界为 $+ \infty$ ，下界为 $0$ 的边，跑一遍源汇上下界最小流即可</p><p>这图有个特殊性质：一定有解，所以可以直接把可行流的部分省略（因为一定可行），只跑最小流</p><h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>打了好久，第一次交， TLE + WA $45 pts$ 呃呃呃，发现有一部分 WA 好像是网络流建图的问题，我把 <code>dad(i, T, -ve[i])</code> 打错为 <code>dad(i, T, ve[i])</code> ，好吧，我就承认我是个伞兵好吗</p><p>改了以后是 TLE + WA $75 pts$ ，WA 好像是 dp 挂了，先不管，搞搞 TLE，发现时间复杂度为 $O(Dinic)$ ，尝试改为 HLPP ，结果 RE ，然后尝试吸氧 + Dinic，也 RE ，怀疑是建图挂了</p><p>决定先把那个 WA 搞了，（<del>臭不要脸的交空代码骗数据</del>）发现 WA 的点是最长路很长（接近 $N$ ）且最优路线不唯一的点，感觉是太长了 dp 挂掉了，仔细一想，我用 <code>vector</code> 记录了所有的方案，中间一条边会被记录多次，那谁知道空间怎么样了，于是考虑只记录一条来向用于回答第老司机，其它的最长路用在反向图上 dfs 解决，另外，边一定要开足够大！</p><p>然后……TLE $75 pts$ ，我觉得网络流不该 fake ，应该还是老司机的问题，于是下了一组数据，发现我建图的 dfs 没判重！每个点被重复到达了很多次，感觉自己被老司机算计的明明白白</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> L(x) (x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R(x) (x + n)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> U(x) (x + 2 * n)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(x, y) memset(x, y, sizeof x)</span></span><br><span class="line"><span class="keyword">using</span> PII = std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">100</span>, INF = <span class="number">0x3f3f3f3f</span>, M = <span class="number">5e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, to[N][<span class="number">5</span>];</span><br><span class="line">PII a[N]; <span class="comment">//(fi,se)=(x,y)</span></span><br><span class="line"><span class="keyword">namespace</span> DP</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w; &#125; e[M], eb[M]; <span class="comment">//边开足够大</span></span><br><span class="line">    <span class="keyword">int</span> h[N * <span class="number">3</span>], idx = <span class="number">0</span>, hb[N * <span class="number">3</span>], idb = <span class="number">0</span>, nn, d[N * <span class="number">3</span>], ans = -INF, from[N * <span class="number">3</span>], vis[N * <span class="number">3</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++, eb[idb] = &#123;hb[y], x, z&#125;, hb[y] = idb++; &#125;</span><br><span class="line">    std::vector&lt;PII&gt; longway;</span><br><span class="line">    <span class="function">PII <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x &lt;= n ? <span class="built_in">PII</span>(x, <span class="number">0</span>) : (x &lt;= <span class="number">2</span> * n ? <span class="built_in">PII</span>(x - n, <span class="number">1</span>) : <span class="built_in">PII</span>(x - <span class="number">2</span> * n, <span class="number">2</span>)); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">get_to</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">using</span> Three = std::pair&lt;PII, <span class="keyword">int</span>&gt;;</span><br><span class="line">        std::vector&lt;Three&gt; b; <span class="comment">//桶,(fi,se.fi, se.se)=(bid,val,id)</span></span><br><span class="line">        b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;-INF, -INF&#125;, -INF));</span><br><span class="line">        <span class="comment">//向上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(a[i], i));</span><br><span class="line">        std::<span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="keyword">if</span> (b[i + <span class="number">1</span>].fi.fi == b[i].fi.fi) to[b[i].se][<span class="number">0</span>] = b[i + <span class="number">1</span>].se;</span><br><span class="line">        b.<span class="built_in">clear</span>(), b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;-INF, -INF&#125;, -INF));</span><br><span class="line">        <span class="comment">//左上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;a[i].fi + a[i].se, a[i].se&#125;, i));</span><br><span class="line">        std::<span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="keyword">if</span> (b[i + <span class="number">1</span>].fi.fi == b[i].fi.fi) to[b[i].se][<span class="number">1</span>] = b[i + <span class="number">1</span>].se;</span><br><span class="line">        b.<span class="built_in">clear</span>(), b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;-INF, -INF&#125;, -INF));</span><br><span class="line">        <span class="comment">//右上</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;a[i].se - a[i].fi, a[i].se&#125;, i));</span><br><span class="line">        std::<span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="keyword">if</span> (b[i + <span class="number">1</span>].fi.fi == b[i].fi.fi) to[b[i].se][<span class="number">2</span>] = b[i + <span class="number">1</span>].se;</span><br><span class="line">        b.<span class="built_in">clear</span>(), b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;-INF, -INF&#125;, -INF));</span><br><span class="line">        <span class="comment">//向右和向左</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) b.<span class="built_in">push_back</span>(<span class="built_in">Three</span>(&#123;a[i].se, a[i].fi&#125;, i));</span><br><span class="line">        std::<span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="keyword">if</span> (b[i + <span class="number">1</span>].fi.fi == b[i].fi.fi) to[b[i].se][<span class="number">3</span>] = b[i + <span class="number">1</span>].se, to[b[i + <span class="number">1</span>].se][<span class="number">4</span>] = b[i].se;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> t[N][<span class="number">2</span>]; <span class="comment">//辅助计算上行边的权值</span></span><br><span class="line">        <span class="built_in">mem</span>(h, <span class="number">-1</span>), <span class="built_in">mem</span>(hb, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">get_to</span>(); <span class="comment">//找到每个点能到那个点</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(<span class="built_in">R</span>(i), <span class="built_in">U</span>(i), <span class="number">0</span>), <span class="built_in">add</span>(<span class="built_in">L</span>(i), <span class="built_in">U</span>(i), <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (to[i][<span class="number">3</span>]) <span class="built_in">add</span>(<span class="built_in">R</span>(i), <span class="built_in">R</span>(to[i][<span class="number">3</span>]), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">for</span> (<span class="keyword">int</span> j = i, k = <span class="number">1</span>; j; j = to[j][<span class="number">4</span>], ++k) t[j][<span class="number">0</span>] = k; <span class="comment">//右端点向左</span></span><br><span class="line">            <span class="keyword">if</span> (to[i][<span class="number">4</span>]) <span class="built_in">add</span>(<span class="built_in">L</span>(i), <span class="built_in">L</span>(to[i][<span class="number">4</span>]), <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">for</span> (<span class="keyword">int</span> j = i, k = <span class="number">1</span>; j; j = to[j][<span class="number">3</span>], ++k) t[j][<span class="number">1</span>] = k; <span class="comment">//左端点向右</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; ++j) <span class="keyword">if</span> (to[i][j])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (to[to[i][j]][<span class="number">3</span>]) <span class="built_in">add</span>(<span class="built_in">U</span>(i), <span class="built_in">R</span>(to[to[i][j]][<span class="number">3</span>]), t[to[i][j]][<span class="number">1</span>] + <span class="number">1</span>); <span class="comment">//注意下标不要混</span></span><br><span class="line">                <span class="keyword">if</span> (to[to[i][j]][<span class="number">4</span>]) <span class="built_in">add</span>(<span class="built_in">U</span>(i), <span class="built_in">L</span>(to[to[i][j]][<span class="number">4</span>]), t[to[i][j]][<span class="number">0</span>] + <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">add</span>(<span class="built_in">U</span>(i), <span class="built_in">U</span>(to[i][j]), <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">topu</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> du[N * <span class="number">3</span>];</span><br><span class="line">        std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="built_in">mem</span>(d, <span class="number">0xcf</span>); <span class="comment">//是-INF</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; idx; ++i) ++du[e[i].ver];</span><br><span class="line">        du[<span class="built_in">U</span>(n)] = d[<span class="built_in">U</span>(n)] = du[<span class="built_in">R</span>(n)] = d[<span class="built_in">R</span>(n)] = du[<span class="built_in">L</span>(n)] = d[<span class="built_in">L</span>(n)] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= nn; ++i) <span class="keyword">if</span> (!du[i]) q.<span class="built_in">push</span>(i);</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (d[y = e[i].ver] &lt; d[x] + e[i].w)</span><br><span class="line">                &#123;</span><br><span class="line">                    d[y] = d[x] + e[i].w;</span><br><span class="line">                    from[y] = x;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((--du[y]) == <span class="number">0</span>) q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        nn = n * <span class="number">3</span>;</span><br><span class="line">        <span class="built_in">build</span>(), <span class="built_in">topu</span>();</span><br><span class="line">        <span class="comment">//回答前两个询问</span></span><br><span class="line">        STC <span class="keyword">int</span> stk[N], top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ans = std::<span class="built_in">max</span>(ans, d[<span class="built_in">U</span>(i)]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>, y; x &lt;= n; ++x) <span class="keyword">if</span> (d[<span class="built_in">U</span>(x)] == ans)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (x = <span class="built_in">U</span>(x), stk[++top] = x; from[x]; stk[++top] = x) x = from[x]; </span><br><span class="line">            <span class="keyword">for</span> (PII t = <span class="built_in">get</span>(stk[top--]), lt; top;)</span><br><span class="line">            &#123;</span><br><span class="line">                lt = t, t = <span class="built_in">get</span>(stk[top--]);</span><br><span class="line">                <span class="keyword">if</span> (lt.se == t.se) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t.fi);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (t.se == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span> (y = to[t.fi][<span class="number">3</span>]; y; y = to[y][<span class="number">3</span>]) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, y);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t.fi);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (t.se == <span class="number">1</span>) </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span> (y = to[t.fi][<span class="number">4</span>]; y; y = to[y][<span class="number">4</span>]) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, y);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t.fi);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//下面的函数找出最长路,Dinic建边用</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = hb[y], x; ~i; i = eb[i].ne) <span class="keyword">if</span> (d[x = eb[i].ver] + eb[i].w == d[y])</span><br><span class="line">        &#123;</span><br><span class="line">            PII ty = <span class="built_in">get</span>(y), tx = <span class="built_in">get</span>(x);</span><br><span class="line">            <span class="keyword">if</span> (tx.se == <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, tt; j &lt;= <span class="number">2</span>; ++j) <span class="keyword">if</span> (tt = to[tx.fi][j])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (ty.fi == to[tt][<span class="number">3</span>] &amp;&amp; ty.se == <span class="number">1</span>) longway.<span class="built_in">push_back</span>(&#123;tx.fi, tt&#125;);</span><br><span class="line">                    <span class="keyword">if</span> (ty.fi == to[tt][<span class="number">4</span>] &amp;&amp; ty.se == <span class="number">0</span>) longway.<span class="built_in">push_back</span>(&#123;tx.fi, tt&#125;);</span><br><span class="line">                    <span class="keyword">if</span> (ty.fi == tt &amp;&amp; ty.se == <span class="number">2</span>) longway.<span class="built_in">push_back</span>(&#123;tx.fi, tt&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">if</span> (vis[x]) <span class="keyword">continue</span>; <span class="comment">//不加会TLE</span></span><br><span class="line">            vis[x] = <span class="literal">true</span>, <span class="built_in">dfs</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">()</span></span>&#123; <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="keyword">if</span> (d[<span class="built_in">U</span>(i)] == ans &amp;&amp; (vis[<span class="built_in">U</span>(i)] = <span class="literal">true</span>)) <span class="built_in">dfs</span>(<span class="built_in">U</span>(i)); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Dinic</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> ne, ver, w; &#125; e[M]; <span class="comment">//我也不知道边开多大</span></span><br><span class="line">    <span class="keyword">int</span> h[N], idx = <span class="number">0</span>, S, T, ans, cur[N], dep[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; <span class="built_in">add</span>(x, y, z), <span class="built_in">add</span>(y, x, <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">using</span> DP::longway;</span><br><span class="line">        DP::<span class="built_in">find</span>(); <span class="comment">//找到最长路</span></span><br><span class="line">        STC <span class="keyword">int</span> ve[N];</span><br><span class="line">        <span class="built_in">mem</span>(h, <span class="number">-1</span>);</span><br><span class="line">        S = n + <span class="number">1</span>, T = S + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">sort</span>(longway.<span class="built_in">begin</span>(), longway.<span class="built_in">end</span>());</span><br><span class="line">        longway.<span class="built_in">erase</span>(std::<span class="built_in">unique</span>(longway.<span class="built_in">begin</span>(), longway.<span class="built_in">end</span>()), longway.<span class="built_in">end</span>()); <span class="comment">//去重边</span></span><br><span class="line">        <span class="keyword">for</span> (PII lw : longway) <span class="built_in">dad</span>(lw.fi, lw.se, INF), --ve[lw.fi], ++ve[lw.se];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (ve[i] &gt; <span class="number">0</span>) <span class="built_in">dad</span>(S, i, ve[i]), ans += ve[i]; <span class="comment">//一定有解</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ve[i] &lt; <span class="number">0</span>) <span class="built_in">dad</span>(i, T, -ve[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">mem</span>(dep, <span class="number">-1</span>);</span><br><span class="line">        std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (q.<span class="built_in">push</span>(S), dep[S] = <span class="number">0</span>, cur[S] = h[S]; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne) <span class="keyword">if</span> (dep[y = e[i].ver] == <span class="number">-1</span> &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                cur[y] = h[y], dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (y == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> lim)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == T) <span class="keyword">return</span> lim;</span><br><span class="line">        <span class="keyword">int</span> flow = <span class="number">0</span>, t, y;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; ~i &amp;&amp; flow &lt; lim; i = e[i].ne)</span><br><span class="line">        &#123;</span><br><span class="line">            cur[x] = i;</span><br><span class="line">            <span class="keyword">if</span> (dep[y = e[i].ver] == dep[x] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!(t = <span class="built_in">find</span>(y, std::<span class="built_in">min</span>(e[i].w, lim - flow)))) dep[y] = <span class="number">-1</span>;</span><br><span class="line">                e[i].w -= t, e[i ^ <span class="number">1</span>].w += t, flow += t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, flow;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">bfs</span>()) <span class="keyword">while</span> (flow = <span class="built_in">find</span>(S, INF)) res += flow;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123; <span class="built_in">build</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans - <span class="built_in">dinic</span>()); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), a[++n] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;; <span class="comment">//把原点也看作一棵树</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;a[i].fi, &amp;a[i].se);</span><br><span class="line">    DP::<span class="built_in">work</span>(), Dinic::<span class="built_in">work</span>(); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 网络流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4768 [NOI2018] 归程</title>
      <link href="/2022/02/24/luoguP4768-NOI2018-%E5%BD%92%E7%A8%8B/"/>
      <url>/2022/02/24/luoguP4768-NOI2018-%E5%BD%92%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p> 关于 spfa ……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4768">归程</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $n \le 2 \times 10^5$ 个点的图，每条边有海拔 $h_i$ 和长度 $l$ ，有 $q \le 4 \times 10^5$ 次询问，每次给定 $v, p$ ，询问只保留 $h_i \ge p$ 的边的情况下，从 $v$ 出发能走到的点 $u$ 中到点 $1$ 距离最小的点，输出最小距离，强制在线</p><h2 id="关于-spfa"><a href="#关于-spfa" class="headerlink" title="关于 spfa"></a>关于 spfa</h2><p>一位巨佬用血的教训告诉我们，它死了</p><p>所以，我们用 dijkstra 求出点 $1$ 到每个点的最短距离，记作 $dis_i$ ，时间为 $O(m \log n)$ </p><h2 id="kruskal-重构树"><a href="#kruskal-重构树" class="headerlink" title="kruskal 重构树"></a>kruskal 重构树</h2><p>好像说还有可持久化并查集的做法，但我不会，所以用 kruskal 重构树</p><p>考虑我们 kruskal 的过程，每次我们取出边权最小的边，用并查集判断两边的联通性，如果不联通就合并并查集（相当于选边）</p><p>在以上过程中，因为构造最小生成树过程中树的形状和中途选边的顺序对我们来说不重要，所以我们放弃了这些信息，用路径压缩优化了时间</p><p>但现在，如果我们要保留这些信息呢？具体的：</p><ol><li>把所有边排序，记边为 $(x, y, z)$ ，表示 $x \to y$ ，权为 $z$ </li><li>构建 $n$ 个无权点，没有边</li><li>每次取出一条边 $(x, y, z)$ ：<ul><li>若 $x, y$ 联通（在同一棵树），不管它</li><li>否则，新建一个节点 $t$ ，记 $x, y$ 所在树的根为 $r_x, r_y$ ，让 $t$ 的左右儿子分别为 $r_x, r_y$ ，并让 $t$ 的点权为 $z$ </li></ul></li></ol><p>不难发现 kruskal 重构树有如下性质：</p><ol><li>它是一棵二叉树（更进一步，它其实就是个二叉堆），树上除叶子结点以外的点都对应着原来生成树中的边，叶子结点就是原来生成树上的节点</li><li>除叶节点外，儿子节点对应边一定排序在父亲前面，即从每个点到根节点上除叶子结点外按顺序访问到的点的点权是单调的</li><li>对于叶节点 $x, y$ ， $lca(x, y)$ 对应的边就是最小生成树中联通 $x, y$ 的“瓶颈边”（它排序在最后）</li></ol><p> kruskal 重构树的构建可以在 kruskal 的基础上进行，时间 $O(m \log m)$ </p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>那么，我们如何用重构树做本题呢？</p><p>首先，我们把边按 $h_i$ 降序排序（边的长度 $l$ 在我们求出 $dis$ 数组后就没有用了），然后建出重构树</p><p>由重构树的性质，我们知道，对于点 $x, y$ ， $lca(x, y)$ 对应的边就是连接 $x, y$ 的边中海拔最小的，那么对于每次询问 $v$ ，我们就是要找到所有的 $u$ 满足 $h_{lca(u, v)} \ge p$ ，答案就是 $\min(dis_u)$ </p><p>但直接每个点找肯定是不行的，根据重构树的性质， $x$ 子树中的所有点（除了叶子）的海拔都高于 $x$ ，所以如果 $h_x \ge p$ ，那么它的子树一定都高于 $p$ ，我们可以用树上倍增找到 $v$ 的祖宗中最浅的（即子树最大的）满足 $h_x \ge p$ 的 $x$ ，它子树中的任意一个点 $u$ 都是满足 $h_{lca(u, v)} \ge p$ 的，且不在它子树里面的点一定不满足（因为那些点和 $v$ 的 $lca$ 只会在 $x$ 的上面），那么问题就化为了子树 $\min$ ，预先统计即可</p><p>时间 $O(T(m + q) \log m)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> PII = std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, M = <span class="number">4e5</span> + <span class="number">5</span>, D = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> dis[N], h[N], idx, fa[N + M], f[D][N + M];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge1</span>&#123;</span> <span class="keyword">int</span> ne, ver, w; &#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge2</span>&#123;</span> <span class="keyword">int</span> u, v, h; &#125; a[M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span> <span class="keyword">int</span> val, mn; &#125; nd[N + M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">(<span class="keyword">int</span> st)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> vis);</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    std::priority_queue&lt;PII&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (q.<span class="built_in">push</span>(&#123;dis[st] = <span class="number">0</span>, st&#125;); !q.<span class="built_in">empty</span>(); )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (vis[x]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[x] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; ~i; i = e[i].ne)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[y = e[i].ver]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (dis[y] &gt; dis[x] + e[i].w &amp;&amp; (dis[y] = dis[x] + e[i].w)) q.<span class="built_in">push</span>(&#123;-dis[y], y&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">get</span>(fa[x]); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">krukal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::<span class="built_in">sort</span>(a + <span class="number">1</span>, a + m + <span class="number">1</span>, [&amp;](Edge2 x, Edge2 y)&#123; <span class="keyword">return</span> x.h &gt; y.h; &#125;);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) fa[i] = i, nd[++cnt] = &#123;<span class="number">0</span>, dis[i]&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="built_in">get</span>(a[i].u), v = <span class="built_in">get</span>(a[i].v);</span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">continue</span>;</span><br><span class="line">        nd[++cnt] = &#123;a[i].h, std::<span class="built_in">min</span>(nd[u].mn, nd[v].mn)&#125;;</span><br><span class="line">        fa[cnt] = fa[u] = fa[v] = cnt;</span><br><span class="line">        f[<span class="number">0</span>][u] = f[<span class="number">0</span>][v] = cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; D; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i) f[j][i] = f[j - <span class="number">1</span>][f[j - <span class="number">1</span>][i]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; ~i; --i) <span class="keyword">if</span> (f[i][x] &amp;&amp; nd[f[i][x]].val &gt; p) x = f[i][x];</span><br><span class="line">    <span class="keyword">return</span> nd[x].mn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, Q, v, p, K, S, last;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); T--; )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h), idx = last = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a[i].u, &amp;a[i].v, &amp;t, &amp;a[i].h);</span><br><span class="line">            <span class="built_in">add</span>(a[i].u, a[i].v, t), <span class="built_in">add</span>(a[i].v, a[i].u, t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dij</span>(<span class="number">1</span>), <span class="built_in">krukal</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;Q, &amp;K, &amp;S); Q--; )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;v, &amp;p), v = (v + K * last - <span class="number">1</span>) % n + <span class="number">1</span>, p = (p + K * last) % (S + <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, last = <span class="built_in">ask</span>(v, p));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 倍增 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 最短路 </tag>
            
            <tag> 最小生成树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大力分块3</title>
      <link href="/2022/02/19/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%973/"/>
      <url>/2022/02/19/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%973/</url>
      
        <content type="html"><![CDATA[<p> 卡常带师</p><span id="more"></span><h1 id="大力分块3"><a href="#大力分块3" class="headerlink" title="大力分块3"></a>大力分块3</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>上次做毒瘤分块还是上次：<a href="https://dyd-true.github.io/2022/01/25/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%972/#more">大力分块2</a></p><p>这次就是这次了（已经好久没做）</p><p>要问为什么隔了这么远（第六分块过了就是第十四），主要矛盾是我太弱了不会</p><h2 id="第十四分块"><a href="#第十四分块" class="headerlink" title="第十四分块"></a>第十四分块</h2><p><strong>「点缀光辉的第十四分块」</strong></p><p><a href="https://www.luogu.com.cn/problem/P5398">GOSICK</a></p><p>给定一个长度为 $n \le 5 \times 10^5$ 的序列 $a_i \le 5 \times 10^5$ ， $m \le 5 \times 10^5$ 次询问，每次给定 $l, r \in [1, n]$ ，询问满足 $l \le i &lt; j \le r$ 且 $a_i$ 是 $a_j$ 的倍数的 $(i, j)$ 有多少对</p><h3 id="前置知识：二次离线"><a href="#前置知识：二次离线" class="headerlink" title="前置知识：二次离线"></a>前置知识：二次离线</h3><p>不懂的可以康康<a href="https://dyd-true.github.io/2022/02/15/%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F/#more">这个</a>，或者自己去找找网上的资料</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>如果你会了二次离线，那么这题的思路就还算简单了</p><p>考虑数 $x$ 对区间 $[l, r]$ 的贡献（记它为 $f(x, [l ,r])$ ），明显就是 $[l, r]$ 中 $x$ 的倍数的个数 + $x$ 的约数的个数</p><p>考虑莫队，直接维护指针移动时间复杂度过高，我们用二次离线，那么我们要解决的就是 $f(x, [1, x - 1])$ 和 $f([L, R], [1, k])$ </p><p>先考虑贡献中的第一部分，即“ $[l, r]$ 中 $x$ 的倍数的个数”，我们开个桶 $b[t]$ ，表示“区间内 $t$ 的倍数的个数”，每次插入一个数时就枚举其因数跟新 $b$ ，由于一个数的因数个数小于 $\sqrt{n}$ ，所以可做</p><p>再考虑第二部分，即“ $[l, r]$ 中 $x$ 的约数的个数”，这里我们就不能用和第一部分相同的办法了，因为当 $x$ 比较小的时候， $n$ 以内的 $x$ 的倍数可能很多，枚举倍数时间不允许</p><p>但这里的“不允许”是对于计算 $f([L, R], [1, k])$ 来说的，因为它要求插入时间最大 $O(\sqrt{n})$ ，对于 $x \in [L, R]$ 询问 $f(x, [1, k])$ 是 $O(1)$ （或者 $[L, R]$ 整体询问 $O(\sqrt{n})$ ）；而 $f(x, [1, x - 1])$ 不会有这个问题，因为我们可以直接不枚举倍数，去枚举 $x$ 的约数，用 $O(\sqrt{n})$ 的询问解决</p><p>对 $f([L, R], [1, k])$ ，考虑平衡规划，对于 $x \ge V$ 的情况，我们直接枚举倍数，时间为 $\frac{n}{V}$ </p><p>而对于 $x \le V$ 的部分，维护 $ct1[i, j]$ 表示“前 $i$ 个数中有多少个等于 $j$ ”，再维护 $ct2[i, j]$ 表示“前 $i$ 个数中有多少个含约数 $j$ ”（上面的 $j$ 都 $\le V$ ，上面定义就用了前缀和的形式，是为了方便使用）</p><p>于是， $f([L, R], [1, k])$ 就是 $\sum _{j = 1}^V ct1[k, j] \times (ct2[R, j] - ct2[L - 1, j])$ ，不难发现 $[L, R]$ 的整体复杂度为 $O(V)$ ；取 $V = \sqrt{n}$ 时间最优</p><p>另外，由于 lxl 卡空间，我们开不了二维数组，发现 $ct1/2[i, j]$ 我们的式子只用同一个 $j$ ，所以只记 $ct1[i], ct2[i]$ ，把 $j$ 放到最外层枚举，计算完 $ct1, ct2$ 后立刻去跟新贡献，然后再去存下一个 $j$ </p><h3 id="卡常"><a href="#卡常" class="headerlink" title="卡常"></a>卡常</h3><p> lxl 是不会让你轻松过的：</p><ol><li>快读快输、 <code>inline</code> </li><li>把每个数的约数预处理了（只存 $\le \sqrt{n}$ 的）</li><li>卡块长，实测 $V = 50 / 30$ 时比较优秀， $B$ 对本题影响不大，直接取 $\sqrt{n}$ 即可过，但仍然实测 $B = 700 \sim 800$ 时比较优秀</li><li>这个很重要！我们发现如果我们还是直接给 $1 \sim n$ 每个数开一个 <code>vector</code> 来存二次离线的标记的话，理论时间是正确的，但在平衡规划处，由于我们是枚举 $j \in [1, V]$ ，每次计算完 $ct1, ct2$ 后就要马上枚举每个标记去跟新，而 STL 慢的和 shit 一样（主要是因为要枚举所以的 $i \in [1, n]$ 但有的 $i$ 根本没有标记，枚举它是多余的；再就是<strong>空间不连续</strong>，访问时慢的让我想死），所以要手打记录标记的数组（记得开二倍）</li><li>向 lxl 和 luogu 祈祷（<del>折寿</del>）吧</li></ol><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>ps ：不知道为啥有几次提交会报一个什么“致命错误”，但再交就又过了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">namespace</span> FastIO</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> *E, *S, buf[L], out[L];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (E == S ? E = (S = buf) + fread(buf, 1, L, stdin), (E == S ? EOF : *S++) : *S++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> ( ; ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) t |= ch == <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>; ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>; ch = <span class="built_in">gh</span>()) x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        <span class="keyword">if</span> (t) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span>&#123; <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout), l = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">check</span><span class="params">()</span></span>&#123; <span class="keyword">if</span> (l &gt;= L - <span class="number">5</span>) <span class="built_in">flus</span>(); &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span>&#123; out[l++] = x, <span class="built_in">check</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>) <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>, <span class="built_in">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> FastIO::read;</span><br><span class="line"><span class="keyword">using</span> FastIO::flus;</span><br><span class="line"><span class="keyword">using</span> FastIO::putc;</span><br><span class="line"><span class="keyword">using</span> FastIO::write;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, V = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], tp;</span><br><span class="line">LL f[N], ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ques</span>&#123;</span> <span class="keyword">int</span> l, r, id; LL ans; &#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tag</span>&#123;</span> <span class="keyword">int</span> l, r, id, pos; &#125; tag[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; fac[N];</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> cnt[N], b[N], bid[N];</span><br><span class="line"><span class="keyword">int</span> B = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; f[i] += f[i - <span class="number">1</span>] + b[a[i]], ++cnt[a[i]], ++i)</span><br><span class="line">        <span class="keyword">if</span> (fac[a[i]].<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * j &lt;= a[i]; ++j)</span><br><span class="line">                <span class="keyword">if</span> (a[i] % j == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    fac[a[i]].<span class="built_in">push_back</span>(j);</span><br><span class="line">                    ++b[j], f[i] += cnt[j];</span><br><span class="line">                    <span class="keyword">if</span> (j * j != a[i]) ++b[a[i] / j], f[i] += cnt[a[i] / j];</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j : fac[a[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                ++b[j], f[i] += cnt[j];</span><br><span class="line">                <span class="keyword">if</span> (j * j != a[i]) ++b[a[i] / j], f[i] += cnt[a[i] / j];</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) bid[i] = (i - <span class="number">1</span>) / B + <span class="number">1</span>;</span><br><span class="line">    std::<span class="built_in">sort</span>(q + <span class="number">1</span>, q + m + <span class="number">1</span>, [&amp;](Ques a, Ques b)&#123; <span class="built_in"><span class="keyword">return</span></span> (bid[a.l] ^ bid[b.l]) ? a.l &lt; b.l : a.r &lt; b.r; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add_tag</span><span class="params">()</span> <span class="comment">//顺便把预处理的值加了</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, il = <span class="number">1</span>, ir = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (il &gt; q[i].l) q[i].ans -= f[il - <span class="number">1</span>] - f[q[i].l - <span class="number">1</span>], tag[++tp] = &#123;q[i].l, il - <span class="number">1</span>, i, ir&#125;;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (il &lt; q[i].l) q[i].ans += f[q[i].l - <span class="number">1</span>] - f[il - <span class="number">1</span>], tag[++tp] = &#123;il, q[i].l - <span class="number">1</span>, -i, ir&#125;;</span><br><span class="line">        il = q[i].l;</span><br><span class="line">        <span class="keyword">if</span> (ir &lt; q[i].r) q[i].ans += f[q[i].r] - f[ir], tag[++tp] = &#123;ir + <span class="number">1</span>, q[i].r, -i, il - <span class="number">1</span>&#125;;</span><br><span class="line">        <span class="keyword">else</span>  <span class="keyword">if</span> (ir &gt; q[i].r) q[i].ans -= f[ir] - f[q[i].r], tag[++tp] = &#123;q[i].r + <span class="number">1</span>, ir, i, il - <span class="number">1</span>&#125;;</span><br><span class="line">        ir = q[i].r;</span><br><span class="line">    &#125;</span><br><span class="line">std::<span class="built_in">sort</span>(tag + <span class="number">1</span>, tag + tp + <span class="number">1</span>, [&amp;](Tag a, Tag b)&#123; <span class="keyword">return</span> a.pos &lt; b.pos; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">offline</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> b[N], ct1[N], ct2[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, p = <span class="number">0</span>; i &lt;= tp; ++i)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="keyword">while</span> (p &lt; tag[i].pos)</span><br><span class="line">&#123;</span><br><span class="line">++p;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x : fac[a[p]]) ++b[x], b[a[p] / x] += (x * x != a[p]);</span><br><span class="line"><span class="keyword">if</span> (a[p] &gt; V) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * a[p] &lt; N; ++j) ++b[j * a[p]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = tag[i].l, k = tag[i].id &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>; j &lt;= tag[i].r; ++j) q[tag[i].id * k].ans += b[a[j]] * k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= V; ++j) <span class="comment">//平衡规划</span></span><br><span class="line">    &#123;</span><br><span class="line">        ct1[<span class="number">0</span>] = ct2[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ct1[i] = ct1[i - <span class="number">1</span>] + (a[i] == j), ct2[i] = ct2[i - <span class="number">1</span>] + (a[i] % j == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tp; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> k = tag[i].id &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">q[tag[i].id * k].ans += (<span class="built_in">LL</span>(ct2[tag[i].r] - ct2[tag[i].l - <span class="number">1</span>]) * ct1[tag[i].pos]) * k;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">read</span>(q[i].l), <span class="built_in">read</span>(q[i].r), q[i].id = i;</span><br><span class="line">    <span class="built_in">prev</span>(), <span class="built_in">add_tag</span>(), <span class="built_in">offline</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) q[i].ans += q[i - <span class="number">1</span>].ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) ans[q[i].id] = q[i].ans;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">write</span>(ans[i]), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h3><p>强烈推荐去看 GOSICK ，对它每集很文艺的标题和男主“打完这场仗……”的 flag 印象很深</p><h2 id="待续"><a href="#待续" class="headerlink" title="待续"></a>待续</h2><p>但后面都好难啊……</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
            <tag> 莫队 </tag>
            
            <tag> 二次离线 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二次离线莫队</title>
      <link href="/2022/02/15/%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F/"/>
      <url>/2022/02/15/%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p> 但是我莫队都不是很会欸~</p><span id="more"></span><h1 id="二次离线莫队"><a href="#二次离线莫队" class="headerlink" title="二次离线莫队"></a>二次离线莫队</h1><p>顾名思义，就是在原来就离线的莫队上再套一个离线</p><p>由 lxl 大佬发明（ lxl 是多爱根号算法啊）</p><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>莫队都知道吧？众所周知，莫队的时间是 $O(n \sqrt{n})$ 对吧？</p><p>不对！ $O(n \sqrt{n})$ 是在双指针移动跟新答案为 $O(1)$ 的情况下，实际是 $O(n \sqrt{n} \times O(双指针移动跟新答案))$ ，典型的情况是，一个数的贡献为区间内小于它的数的个数（也就是说，一次跟新涉及到一个区间/很多个数），此时每添加/删除一个数的时间就……</p><p>那怎么办呢？我们把莫队指针每次移动当成询问，既然在线（即每次移动立刻跟新）是难以保证时间的，那我们就离线解决（这就是第二次离线），一般用扫描线处理，假设 $O(双指针移动跟新答案) = O(k)$ 那么普通莫队的时间为 $O(n k \sqrt{n})$ ，而二次离线的时间复杂度为 $O(nk + n \sqrt{n})$ （其实时间和二次离线后选择的数据结构有关，但一般这都不是瓶颈）</p><p>但有前提：移动指针对答案的影响可用前缀写成差分的形式</p><h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>设函数 $f(x, [l, r])$ 表示“ $x$ 对区间 $[l, r]$ ”的贡献，这个东西不好搞，我们考虑到 $f(x, [l, r]) = f(x, [1, r]) - f(x, [1, l - 1])$ （这里假设了 $f$ 可以差分，一般题目应该都可以，不行的话……那反正蒟蒻我就不会了），那么我们可以把每次移动指针转化为一个数对一个前缀的贡献</p><p>设当前状态为 $[l, r]$ ，我们分类讨论：</p><ol><li>右端右移，即 $[l, r] \to [l, r + k]$ ，答案改变量为 $\sum _{i = r + 1}^{r + k} f(i, [1, i - 1]) - f(i, [1, l - 1])$ </li><li>右端左移，即 $[l, r] \to [l, r - k]$ ，答案改变量为 $\sum _{i = r - k + 1}^{r} -(f(i, [1, i - 1]) - f(i, [1, l - 1]))$ </li><li>左端左移， 即 $[l, r] \to [l - k, r]$ ，答案改变量为 $\sum _{i = l - k}^{l - 1} f(i, [1, r]) - f(i, [1, i])$ </li><li>左端右移， 即 $[l, r] \to [l + k, r]$ ，答案改变量为 $\sum _{i = l}^{l + k - 1} -(f(i, [1, r]) - f(i, [1, i]))$ </li></ol><p>看起来感觉还是不能直接算（时间复杂度过高）</p><p>我们分开看，第一类， $f(i, [1, i])$ 和 $f(i, [1, i - 1])$ 都是只关于 $i$ 的式子，可以直接预处理</p><p>第二类 $f(i, [1, r])$ 和 $f(i, [1, l - 1])$ 不太好搞，考虑打懒标记，给每个数开一个 <code>vector</code> ，若 $x$ 在数 $k$ 的 <code>vector</code> 里，就代表我们要求 $f(x, [1, k])$ </p><p>由于莫队修改都是连续的，不必真的存一个个的数，而可以存三元组 $(l, r, id)$ 表示“ $\forall x \in [l, r]$ 都要求 $f(x, [1, k])$ 而 $id$ 同时记录符号”</p><p>现在来分析时间复杂度，预处理 $f(i, [1, i])$ 和 $f(i, [1, i - 1])$ 是 $O(nk)$ 的，另外可以把它们做一个前缀和，这样询问这一部分总贡献就可以 $O(1)$ 了（卡常技巧一定要记！）</p><p>另一部分我们先扫一般每个数，用时 $O(n)$ ，当扫到 $[1, i]$ 时，就去把点 $i$ 里面记录的询问全部计算了，由于莫队指针移动次数是 $O(n \sqrt{n})$ 的，所以查询次数是 $O(n \sqrt{n})$ ，我们用某种数据结构维护它，这个数据结构要修改 $O(n)$ 次，询问 $O(n \sqrt{n})$ 次，我们使用一种修改较慢但查询较快的数据结构，可以做到 $O(np + nq\sqrt{n})$ ，其中 $p, q$ 是修改和查询的时间，在大部分题中 $p \le \sqrt{n}$ ， $q$ 约为 $1$ </p><p>综上，二次离线部分时间复杂度为 $O(nk + n\sqrt{n})$ ，加上前面莫队的 $O(n \sqrt{n})$ ，时间复杂度为 $O(nk + n\sqrt{n})$ </p><p>最后注意 $f(x, [l, r])$ 不是答案！是变化量！所以最后要前缀和一下</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P4887">【模板】莫队二次离线（第十四分块(前体)）</a></p><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给定长度为 $n \le 10^5$ 的序列 $a_i &lt; 16384(2^{14})$ ， $m \le 10^5$ 次寻问区间 $[l, r]$ ，查询 $l \le i &lt; j \le r$ 且满足 $a_i \oplus a_j$ 在二进制下恰有 $k &lt; 16384$ 个 $1$ 的二元组 $(i, j)$ 有多少对（这里 $k$ 是一开始就固定的，每次询问都一样）</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>二次离线的板子（从题目就看出来了），考虑二次离线部分：</p><p>考虑预处理 $f(i, [1, i - 1])$ ，另外一个同理，具体地，扫描一遍数列，枚举二进制下有 $k$ 个 $1$ 的数（卡常可以预处理），对于每个 $i$ ，查一下 $cnt[i \oplus x]$ （ $x$ 二进制下有 $k$ 个 $1$ ）即可</p><p>对于第二类，我们就用一个数组 $t[z]$ 表示当前前缀中的数异或 $z$ 后得到的数恰好有 $k$ 个 $1$ 的数的个数，同样直接查，修改和查询都是 $O(1)$ 的</p><p>然后……就结束了！ lxl 这题不卡常，我爱 lxl ！</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, V = (<span class="number">1</span> &lt;&lt; <span class="number">14</span>), B = <span class="number">320</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ques</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id;</span><br><span class="line">    LL ans;</span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tuple</span>&#123;</span> <span class="keyword">int</span> l, r, id; &#125;;</span><br><span class="line">std::vector&lt;Tuple&gt; tag[N];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; xk; <span class="comment">//有k个1的数</span></span><br><span class="line"><span class="keyword">int</span> n, m, k, bid[N], a[N]; <span class="comment">//bid:块号加</span></span><br><span class="line">LL ans[N], f[<span class="number">2</span>][N]; <span class="comment">//f:存第1类,第二类不存,直接</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V; ++i) <span class="keyword">if</span> (__builtin_popcount(i) == k) xk.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) bid[i] = (i - <span class="number">1</span>) / B + <span class="number">1</span>;</span><br><span class="line">    std::<span class="built_in">sort</span>(q + <span class="number">1</span>, q + m + <span class="number">1</span>, [&amp;](Ques a, Ques b)&#123; <span class="keyword">return</span> bid[a.l] == bid[b.l] ? a.r &lt; b.r : a.l &lt; b.l; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_tag</span><span class="params">()</span> <span class="comment">//模拟莫队,给第2类打标记</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, il = q[<span class="number">1</span>].r + <span class="number">1</span>, ir = q[<span class="number">1</span>].r, l, r; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        l = q[i].l, r = q[i].r;</span><br><span class="line">        <span class="keyword">if</span> (il &gt; l) tag[ir].<span class="built_in">push_back</span>(&#123;l, il - <span class="number">1</span>, i&#125;);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (il &lt; l) tag[ir].<span class="built_in">push_back</span>(&#123;il, l - <span class="number">1</span>, -i&#125;);</span><br><span class="line">il = l; <span class="comment">//这里注意il变了</span></span><br><span class="line">        <span class="keyword">if</span> (ir &lt; r) tag[il - <span class="number">1</span>].<span class="built_in">push_back</span>(&#123;ir + <span class="number">1</span>, r, -i&#125;);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ir &gt; r) tag[il - <span class="number">1</span>].<span class="built_in">push_back</span>(&#123;r + <span class="number">1</span>, ir, i&#125;);</span><br><span class="line">ir = r;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">offline</span><span class="params">()</span> <span class="comment">//二次离线求第1、2类</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[V];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        f[<span class="number">0</span>][i] = f[<span class="number">0</span>][i - <span class="number">1</span>] + t[a[i]]; <span class="comment">//这里顺便就前缀和了</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x : xk) ++t[x ^ a[i]];</span><br><span class="line">        f[<span class="number">1</span>][i] = f[<span class="number">1</span>][i - <span class="number">1</span>] + t[a[i]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> tg : tag[i]) <span class="comment">//求第二类</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = tg.l, k = tg.id &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>; j &lt;= tg.r; ++j) q[tg.id * k].ans += t[a[j]] * k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modui</span><span class="params">()</span> <span class="comment">//真的莫队</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, il = q[<span class="number">1</span>].r + <span class="number">1</span>, ir = q[<span class="number">1</span>].r, l, r; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        l = q[i].l, r = q[i].r;</span><br><span class="line">        <span class="keyword">if</span> (il != l) q[i].ans += f[<span class="number">1</span>][l - <span class="number">1</span>] - f[<span class="number">1</span>][il - <span class="number">1</span>];</span><br><span class="line">il = l;</span><br><span class="line">        <span class="keyword">if</span> (ir != r) q[i].ans += f[<span class="number">0</span>][r] - f[<span class="number">0</span>][ir];</span><br><span class="line">ir = r;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; ++i) q[i].ans += q[i - <span class="number">1</span>].ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) ans[q[i].id] = q[i].ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;q[i].l, &amp;q[i].r), q[i].id = i;</span><br><span class="line">    <span class="built_in">prev</span>(), <span class="built_in">add_tag</span>(), <span class="built_in">offline</span>(), <span class="built_in">modui</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>luogu AC $400$ 祭（然鹅只有 <strong>rusun</strong> 巨佬 AC 数的一半）</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 莫队 </tag>
            
            <tag> 二次离线 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP3648 [APIO2014]序列分割</title>
      <link href="/2022/02/15/luoguP3648-APIO2014-%E5%BA%8F%E5%88%97%E5%88%86%E5%89%B2/"/>
      <url>/2022/02/15/luoguP3648-APIO2014-%E5%BA%8F%E5%88%97%E5%88%86%E5%89%B2/</url>
      
        <content type="html"><![CDATA[<p> 练手</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3648">序列分割</a></p><p>刚搞了那么久 dp ，来练练</p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $n \le 10^5$ 个数 $a_i \le 10^4$ ，最初所以数就是一块，每次操作可以选择一个长度超过 $1$ 的块把它分成长度 $\ge 1$ 的两块，得到的分数就是新产生的块的元素和的乘积，求操作 $k \le 200$ 次后的最大得分</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>一看是区间 dp ，但仔细想想，发现最后答案和操作顺序无关：</p><p>如一个区间 $[a, b, c]$ （其中 $a, b, c$ 代表了一段数），我们用两次操作把它们分成 $[a], [b], [c]$ ，不管是 $[a, b, c] \to [a, b], [c] \to [a], [b], [c]$ 还是 $[a, b, c] \to [a], [b, c] \to [a], [b], [c]$ ，你会发现得分都是 $ab + ac + bc$ ，即每个段的得分一定是 $该段和 \times 前面所有数的和$ </p><p>那么直接设 $d[i, k]$ 表示“前 $i$ 个数分成了 $k$ 段的最大得分”（注意最后应该有  $k + 1$ 段），有：<br>$$<br>d[i, k] = \max _{0 \le j &lt; i} (d[j, k - 1] + (sum[i] - sum[j]) * sum[j])<br>$$<br>其中 $sum$ 是前缀和</p><p>明显 $k$ 是外层（且可以滚动），对于内层考虑何时 $j$ 优于 $p$ ：<br>$$<br>\begin{aligned}<br>d[j] + (sum[i] - sum[j]) * sum[j] &amp; \ge d[p] + (sum[i] - sum[p]) * sum[p] \\<br>sum[i] &amp; \ge \frac{(sum[j]^2 - d[j]) - (sum[p]^2 - d[p])}{sum[j] - sum[p]} \\<br>\end{aligned}<br>$$<br> 故形式二为：<br>$$<br>sum[j]^2 - d[j] = sum[i] \times sum[j] - d[i]<br>$$<br>直接上斜率优化即可</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p> 注意代码 $d$ 的两个维度互换了，因为这样内存访问连续，常数小</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, K = <span class="number">200</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, o, a[N], from[K][N], q[N], hh, tt;</span><br><span class="line">LL sum[N], d[<span class="number">2</span>][N];</span><br><span class="line"><span class="function">LL <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> sum[x]; &#125;</span><br><span class="line"><span class="function">LL <span class="title">Y</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> sum[x] * sum[x] - d[o][x]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chkh</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, LL k)</span></span>&#123; <span class="keyword">return</span> (<span class="built_in">Y</span>(a) - <span class="built_in">Y</span>(b)) &lt;= k * (<span class="built_in">X</span>(a) - <span class="built_in">X</span>(b)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chkt</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123; <span class="keyword">return</span> (<span class="built_in">Y</span>(a) - <span class="built_in">Y</span>(b)) * (<span class="built_in">X</span>(b) - <span class="built_in">X</span>(c)) &lt;= (<span class="built_in">Y</span>(b) - <span class="built_in">Y</span>(c)) * (<span class="built_in">X</span>(a) - <span class="built_in">X</span>(b)); &#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= k; ++i, o ^= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (q[hh = tt = <span class="number">1</span>] = i - <span class="number">1</span>, j = i; j &lt;= n; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (; hh &lt; tt &amp;&amp; <span class="built_in">chkh</span>(q[hh + <span class="number">1</span>], q[hh], sum[j]); ++hh);</span><br><span class="line">            d[o ^ <span class="number">1</span>][j] = d[o][(from[i][j] = q[hh])] + (sum[j] - sum[q[hh]]) * sum[q[hh]];</span><br><span class="line">            <span class="keyword">for</span> (; hh &lt; tt &amp;&amp; <span class="built_in">chkt</span>(j, q[tt], q[tt - <span class="number">1</span>]); --tt);</span><br><span class="line">            q[++tt] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, d[o][n]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = k, pos = n; i &gt;= <span class="number">1</span>; --i) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, pos = from[i][pos]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 斜率优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5072 [Ynoi2015] 盼君勿忘</title>
      <link href="/2022/02/14/luoguP5072-Ynoi2015-%E7%9B%BC%E5%90%9B%E5%8B%BF%E5%BF%98/"/>
      <url>/2022/02/14/luoguP5072-Ynoi2015-%E7%9B%BC%E5%90%9B%E5%8B%BF%E5%BF%98/</url>
      
        <content type="html"><![CDATA[<p> 我是傻子</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5072">盼君勿忘</a></p><p>给定一个长度为 $n \le 10^5$ 的序列 $a_i \le 10^5$ ， $m \le 10^5$ 次询问，给定 $l, r, p(1 \le l \le r \le n, p \le 10^9)$ ，求区间 $[l, r]$ 的所有子序列分别去重后的和  $\mod p$ </p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>看出题人想 $\sqrt{n}$ 算法</p><p>先拆贡献，对于区间 $[l, r]$ ，若数字 $x$ 在区间内出现了 $cnt$ 次，那么它的贡献就是 $x * (2^{r - l + 1} - 2^{r - l + 1 - cnt})$ （就是所有子序列 - 不存在 $x$ 的子序列）</p><p>由于要维护动态 $cnt$ ，马上想到莫队（完了，我不擅长莫队 <del>但仔细一想我好像没有擅长的欸</del> ），直接套莫队板子就可以 $O(n \sqrt{n})$ 维护 $cnt$ </p><p>但每次询问我们都要把每个 $x$ 算一个贡献，最坏要把整个区间扫完，就又挂了</p><p>这里有不同的解法， <strong>wfy</strong>巨佬说可以平衡规划，把整个序列出现次数 $\ge \sqrt{n}$ 的数字记下来，然后在莫队中把出现次数相同的数都加到一起（反正它们都要乘 $(2^{r - l + 1} - 2^{r - l + 1 - cnt})$ ），每次计算时不枚举 $x$ 而枚举 $cnt$ ，此时 $cnt$ 必定 $\le \sqrt{n}$ ，因为大于的我们都调记录了，时间就是 $O(n \sqrt{n})$ </p><p>但蒟蒻我比较弱，只能考虑暴力上数据结构，还是把出现次数相同的数都加到一起，然后枚举 $cnt$ ，但发现很多 $cnt$ 里一个数字都没有，于是考虑用一个链表存储有意义的 $cnt$ （不能用 STL 因为它删除是 $O(n)$ 的，建议手写双向链表），这样就不会枚举到无用的 $cnt$ ，考虑到不同的 $cnt$ 最多只有 $\sqrt{n}$ 级（因为 $cnt$ 代表是数的个数，而 $1 + 2 + 3 + … + x = \frac{x (x - 1)}{2} \le n$ ），所以时间就也是 $O(n \sqrt{n})$ </p><p>最后一个问题是 $2^{r - l + 1 - cnt}$ ，快速幂计算显然每次 $O(\log n)$ ，不可接受（ lxl 的题还想 $\log$ 算法？），考虑光速幂，每次询问 $\sqrt{n}$ 预处理， $O(1)$ 解决每次计算（这里注意，由于指数最大是 $n$ ，所以只用处理到 $\sqrt{n}$ ，而不是 $\sqrt{p}$ ，且也不用 $\mod \varphi(p)$ ）</p><p>总时间 $O(n \sqrt{n})$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>我光速幂打挂了三次……，一共就两个函数……（记得 $B \ge \sqrt{n}$ ）</p><p>我的打法常数略大，但反正可过</p><p>如果你被卡常了，这里分享一些卡常技巧：</p><ol><li>快读/快输</li><li>别万能头</li><li> <code>inline</code> </li><li>把答案用 <code>__int128_</code> / <code>long double</code> 存，中间不取模，最后在统一取模（不会爆）</li><li>光速幂用进制拆分</li><li>调块长（但一点要大于 $\sqrt{n}$ ）</li></ol><p>反正我没被卡，就一个都不想用了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(x) ((x - 1) / B + 1)</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>; <span class="comment">//从wfy巨佬那里学来的打法</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, B = <span class="number">316</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ques</span>&#123;</span> <span class="keyword">int</span> id, l, r, p; &#125; q[N];</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="keyword">namespace</span> MD</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">List</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">int</span> l, r, bid; <span class="comment">//bid,指回id,就是cnt</span></span><br><span class="line">            LL sum;</span><br><span class="line">        &#125; nd[N];</span><br><span class="line">        <span class="keyword">int</span> rb[N], top, tot, id[N]; <span class="comment">//rb垃圾桶,回收空间用</span></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">newnd</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> top ? rb[top--] : ++tot; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> x, LL d)</span> <span class="comment">//插入出现次数为x的数d</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!x) <span class="keyword">return</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!id[x]) </span><br><span class="line">            &#123;</span><br><span class="line">                id[x] = <span class="built_in">newnd</span>();</span><br><span class="line">                nd[id[x]] = &#123;<span class="number">0</span>, nd[<span class="number">0</span>].r, x, <span class="number">0</span>&#125;;</span><br><span class="line">                nd[nd[<span class="number">0</span>].r].l = id[x];</span><br><span class="line">                nd[<span class="number">0</span>].r = id[x];</span><br><span class="line">            &#125;</span><br><span class="line">            nd[id[x]].sum += d;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(<span class="keyword">int</span> x, LL d)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!x || !id[x]) <span class="keyword">return</span> ;</span><br><span class="line">            <span class="keyword">if</span> (!(nd[id[x]].sum -= d))</span><br><span class="line">            &#123;</span><br><span class="line">                nd[nd[id[x]].l].r = nd[id[x]].r, nd[nd[id[x]].r].l = nd[id[x]].l;</span><br><span class="line">                rb[++top] = id[x];</span><br><span class="line">                id[x] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; lis;</span><br><span class="line">    <span class="keyword">int</span> cnt[N], il = <span class="number">1</span>, ir = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; lis.<span class="built_in">erase</span>(cnt[x], x), lis.<span class="built_in">ins</span>(cnt[x] += y, x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; il &gt; l; <span class="built_in">upd</span>(a[--il], <span class="number">1</span>)); </span><br><span class="line">        <span class="keyword">for</span> (; ir &lt; r; <span class="built_in">upd</span>(a[++ir], <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (; il &lt; l; <span class="built_in">upd</span>(a[il++], <span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">for</span> (; ir &gt; r; <span class="built_in">upd</span>(a[ir--], <span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> LPow</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> lp[N][<span class="number">2</span>], p;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> x, LL _p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        p = _p, lp[<span class="number">0</span>][<span class="number">1</span>] = lp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B + <span class="number">5</span>; ++i) lp[i][<span class="number">0</span>] = <span class="built_in">LL</span>(lp[i - <span class="number">1</span>][<span class="number">0</span>]) * x % p;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B + <span class="number">5</span>; ++i) lp[i][<span class="number">1</span>] = <span class="built_in">LL</span>(lp[i - <span class="number">1</span>][<span class="number">1</span>]) * lp[B][<span class="number">0</span>] % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lpow</span><span class="params">(<span class="keyword">int</span> y)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">LL</span>(lp[y % B][<span class="number">0</span>]) * lp[y / B][<span class="number">1</span>] % p; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> MD::lis;</span><br><span class="line"><span class="keyword">using</span> MD::calc;</span><br><span class="line"><span class="keyword">using</span> LPow::lpow;</span><br><span class="line"><span class="keyword">using</span> LPow::prev;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;q[i].l, &amp;q[i].r, &amp;q[i].p), q[i].id = i;</span><br><span class="line">    std::<span class="built_in">sort</span>(q + <span class="number">1</span>, q + <span class="number">1</span> + m, [&amp;](Ques a, Ques b)&#123; <span class="keyword">return</span> <span class="built_in">get</span>(a.l) == <span class="built_in">get</span>(b.l) ? a.r &lt; b. r : <span class="built_in">get</span>(a.l) &lt; <span class="built_in">get</span>(b.l);&#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">calc</span>(q[i].l, q[i].r), <span class="built_in">prev</span>(<span class="number">2</span>, q[i].p);</span><br><span class="line">        <span class="keyword">int</span> &amp;as = ans[q[i].id];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = lis.nd[<span class="number">0</span>].r; j; j = lis.nd[j].r)</span><br><span class="line">        &#123;</span><br><span class="line">            MD::List::Node &amp;nd = MD::lis.nd[j];</span><br><span class="line">            as = (as + nd.sum % q[i].p * <span class="built_in">LL</span>(<span class="built_in">lpow</span>(q[i].r - q[i].l + <span class="number">1</span>) - <span class="built_in">lpow</span>(q[i].r - q[i].l + <span class="number">1</span> - nd.bid) + q[i].p) % q[i].p) % q[i].p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
            <tag> 莫队 </tag>
            
            <tag> 光速幂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数的极限</title>
      <link href="/2022/02/12/%E5%87%BD%E6%95%B0%E7%9A%84%E6%9E%81%E9%99%90/"/>
      <url>/2022/02/12/%E5%87%BD%E6%95%B0%E7%9A%84%E6%9E%81%E9%99%90/</url>
      
        <content type="html"><![CDATA[<p> 突然感觉数列的极限有用了（<del>用来“证明略”</del>）</p><span id="more"></span><h1 id="函数的极限"><a href="#函数的极限" class="headerlink" title="函数的极限"></a>函数的极限</h1><h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p>类似于数列的极限</p><h2 id="邻域"><a href="#邻域" class="headerlink" title="邻域"></a>邻域</h2><p>对于实数 $a, \delta$ ：</p><p>定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>邻域</strong>，记做 $U(a, \delta)$ </p><p>定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a 或 a &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心邻域</strong>，记做 $\mathring{U}(a, \delta)$ </p><p> 定义数集 $\{x \in R \mid a - \delta &lt; x &lt; a\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心左邻域</strong>，记做 $\mathring{U} _- (a, \delta)$ </p><p> 定义数集 $\{x \in R \mid a &lt; x &lt; a + \delta\}$ 为 $a$ 以 $\delta$ 为半径的<strong>去心右邻域</strong>，记做 $\mathring{U} _+ (a, \delta)$ </p><h2 id="函数的极限-1"><a href="#函数的极限-1" class="headerlink" title="函数的极限"></a>函数的极限</h2><p>对于一个<strong>连续</strong>函数 $f(x)$ ，若 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists M, s.t. \forall x &gt; M , \mid f(x) - a \mid &lt; \epsilon$ ，我们就称 $a$ 为<strong>函数 $f(x)$ 的极限</strong>，记作 $\lim \limits _{x \to + \infty} f(x) = a$ ，也可简记为 $f(x) \to a(x \to + \infty)$ </p><p>注意到函数 $x$ 可负，故对于一个<strong>连续</strong>函数 $f(x)$ ，若 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists M, s.t. \forall x &lt; M , \mid f(x) - a \mid &lt; \epsilon$ ，我们也称 $a$ 为<strong>函数 $f(x)$ 的极限</strong>，记作 $\lim \limits _{x \to - \infty} f(x) = a$ </p><p>如果 $a$ 两个都满足，可记作 $\lim \limits _{x \to \infty} f(x) = a$ </p><p>对于一个<strong>连续</strong>函数 $f(x)$ ，若它在 $\mathring{U}(x _0, M)$ 上有定义，且 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists \delta, s.t. \forall x \in \mathring{U}(x _0, \delta), \mid f(x) - a \mid &lt; \epsilon$ ，我们就称 $a$ 为<strong>函数 $f(x)$ 的点极限</strong>，记作 $\lim \limits _{x \to x _0} f(x) = a$ </p><p>对于一个<strong>连续</strong>函数 $f(x)$ ，若它在 $\mathring{U} _- (x _0, M)$ 上有定义，且 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists \delta, s.t. \forall x \in \mathring{U} _- (x _0, \delta), \mid f(x) - a \mid &lt; \epsilon$ ，我们就称 $a$ 为<strong>函数 $f(x)$ 的左极限</strong>，记作 $\lim \limits _{x \to {x _0}^-} f(x) = a$ </p><p>对于一个<strong>连续</strong>函数 $f(x)$ ，若它在 $\mathring{U} _+ (x _0, M)$ 上有定义，且 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists \delta, s.t. \forall x \in \mathring{U} _+ (x _0, \delta), \mid f(x) - a \mid &lt; \epsilon$ ，我们就称 $a$ 为<strong>函数 $f(x)$ 的右极限</strong>，记作 $\lim \limits _{x \to {x _0}^+} f(x) = a$ </p><p>函数的左极限和右极限统称为<strong>单侧极限</strong></p><p>明显， $\lim \limits _{x \to {x _0}^+} f(x) = a$ 且 $\lim \limits _{x \to {x _0}^-} f(x) = a$ 与 $\lim \limits _{x \to x _0} f(x) = a$ 互为充要条件</p><h2 id="连续函数"><a href="#连续函数" class="headerlink" title="连续函数"></a>连续函数</h2><p>以下认为自变量都在定义域内</p><p>若 $\lim \limits _{x \to x _0} f(x) = f(x _0)$ 我们就称 <strong>$f(x)$ 在点 $x$ 处连续</strong></p><p>若 $\forall x_0 \in (l, r)$ ，$f(x)$ 在 $x _0$ 处都连续，我们就称 $f(x)$ <strong>在区间 $(l, r)$ 连续</strong></p><h1 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h1><h2 id="唯一性"><a href="#唯一性" class="headerlink" title="唯一性"></a>唯一性</h2><p>若 $f(x) \to a(x \to r)$ 且 $f(x) \to b (x \to r)$ ，则 $a = b$ </p><p>证明类似数列极限，这里略</p><h2 id="局部有界"><a href="#局部有界" class="headerlink" title="局部有界"></a>局部有界</h2><p>若 $f(x) \to a(x \to x _0)$ 则 $\exists \delta &gt; 0, M &gt; 0, s.t. \forall x \in \mathring{U}(x_0, \delta), \mid f(x) \mid \le M$  </p><p>点连续/区间连续同样有局部有界性</p><p>证明略</p><h2 id="局部保号"><a href="#局部保号" class="headerlink" title="局部保号"></a>局部保号</h2><p>若 $f(x) \to a(x \to x _0)$  且 $a &lt; a’$ 则 $\exists \delta &gt; 0, s.t. \forall x \in \mathring{U}(x_0, \delta), f(x) &lt; a’$  </p><p>点连续/区间连续同样有局部保号性</p><p>证明略</p><h2 id="迫敛性"><a href="#迫敛性" class="headerlink" title="迫敛性"></a>迫敛性</h2><p>若 $f(x) \to a(x \to x_0)$ ， $g(x) \to a (x \to x_0)$ ，且有 $\exists \delta &gt; 0, s.t. \forall x \in \mathring{U}(x_0, \delta), f(x) \le h(x) \le g(x)$ 则 $h(x) \to a(x \to x_0)$ </p><p>点连续/区间连续同样有迫敛性，即</p><p>若 $f(x), g(x)$ 在点 $x _0$ 处连续，且有 $f(x_0) = g(x _0)$ ， $f(x) \le h(x) \le g(x)$ ，则 $h(x)$ 在 $x_0$ 处连续 </p><p>证明略</p><h2 id="局部保不等式"><a href="#局部保不等式" class="headerlink" title="局部保不等式"></a>局部保不等式</h2><p>若 $f(x) \to a(x \to x_0)$ ， $g(x) \to b (x \to x_0)$ ，且有 $\exists \delta &gt; 0, s.t. \forall x \in \mathring{U}(x_0, \delta), f(x) &lt;  g(x)$ 则 $a &lt; b$  </p><p>点连续/区间连续同样有局部不等式性</p><p>证明：</p><p>反设 $a &gt; b$ ，则有 $a &gt; \frac{a + b}{2} &gt; b$ </p><p>由局部保号， $\forall x \in \mathring{U}(x_0, \delta_1), f(x) &gt; \frac{a + b}{2}$ ，  $\forall x \in \mathring{U}(x_0, \delta_2), g(x) &lt; \frac{a + b}{2}$ </p><p>故 $\forall x \in \mathring{U}(x_0, \delta_1) \land \mathring{U}(x_0, \delta_2), f(x) &gt; \frac{a + b}{2} &gt; g(x)$ 与题设矛盾</p><p>QED</p><h2 id="极限的四则运算"><a href="#极限的四则运算" class="headerlink" title="极限的四则运算"></a>极限的四则运算</h2><p>设下面的取值都落在定义域内：</p><p>若 $f(x) \to a(x \to x_0)$ ， $g(x) \to b (x \to x_0)$ ，且 $h(x) = f(x) \odot g(x)$ （  $\odot$ 代表 $+, - , \times, \div$ ，若为 $\div$ 则保证 $g(x) \ne 0$ ） ，则 $h(x) \to a \odot b (x \to x_0)$ </p><p>点连续/区间连续同理</p><p>证明太长且类似于数列，就略了</p><h2 id="归结定理（海涅定理）"><a href="#归结定理（海涅定理）" class="headerlink" title="归结定理（海涅定理）"></a>归结定理（海涅定理）</h2><p> $f(x) \to a(x \to x_0)$ 的充要条件是：对于任意的数列 $\{x _n\} _{n = 1}^{+ \infty}$ ，满足 $x _n \to x _0$ 有数列 $\{f(x _n)\} _{n = 1}^{+ \infty}$ 的极限为 $a$ </p><p>证明较繁琐，这里略</p><h2 id="区间有界"><a href="#区间有界" class="headerlink" title="区间有界"></a>区间有界</h2><p>若 $f(x)$ 在 $[l, r]$ 连续，则 $f(x)$ 在 $[l, r]$ 上有界</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 其它 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优化dp3</title>
      <link href="/2022/02/12/%E4%BC%98%E5%8C%96dp3/"/>
      <url>/2022/02/12/%E4%BC%98%E5%8C%96dp3/</url>
      
        <content type="html"><![CDATA[<p> 然而我 dp 废的一比（四大皆空）</p><span id="more"></span><h1 id="优化dp3"><a href="#优化dp3" class="headerlink" title="优化dp3"></a>优化dp3</h1><p>书接上回：<a href="https://dyd-true.github.io/2022/02/09/%E4%BC%98%E5%8C%96dp2/#more">优化dp2</a></p><h1 id="四边形不等式优化"><a href="#四边形不等式优化" class="headerlink" title="四边形不等式优化"></a>四边形不等式优化</h1><p>以下未特殊说明，就认为 $w(x, y)$ 是定义在整数集合上的二元函数，下面的 $\ge, &gt;$ 是对于 $\min$ 形转移来说的，如果 dp 方程要求的是 $\max$ ，则应该反过来（但其实你定义函数时取个负也行）</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>对于任意的 $a \le b \le c \le d$ ，若有 $w(a, d) + w(b, c) \ge w(a, c) + w(b, d)$ ，则称 $w(x, y)$ 满足<strong>四边形不等式</strong>（蒟蒻个人的记忆方法为“两边加中间大于错位相加”）</p><p>对于任意的 $l \le l’ \le r’ \le r$ ，若有 $w(l, r) \ge w(l’, r’)$ ，就称 $w(x, y)$ 满足<strong>区间包含单调性</strong>（蒟蒻个人的记忆方法为“大区间大于小区间”）</p><h3 id="判定定理"><a href="#判定定理" class="headerlink" title="判定定理"></a>判定定理</h3><p>这里有一个定理（或者说是四边形不等式的另外一个形式）：</p><p>$w(x, y)$ 满足四边形不等式的充要条件是：对于任意的 $a &lt; b$ （注意这里不取等），有 $w(a, b + 1) + w(a + 1, b) \ge w(a, b) + w(a + 1, b + 1)$ （蒟蒻个人的记忆方法为“分开加大于同进退”）</p><p>必要性显然，下面证明充分性：</p><p>对于 $a &lt; c$ 有 $w(a, c + 1) + w(a + 1, c) \ge w(a, c) + w(a + 1, c + 1)$ </p><p>对于 $a + 1 &lt; c$ 有 $w(a + 1, c + 1) + w(a + 2, c) \ge w(a + 1, c) + w(a + 2, c + 1)$ </p><p>两式相加，得 $w(a, c + 1) + w(a + 2, c) \ge w(a, c) + w(a + 2, c + 1)$ </p><p>以此类推，对于任意的 $a \le b \le c$ 有 $w(a, c + 1) + w(b, c) \ge w(a, c) + w(b , c + 1)$ </p><p>同理，对于任意的 $a \le b \le c \le d$ 有 $w(a, d) + w(b, c) \ge w(a, c) + w(b, d)$ </p><p>QED</p><h2 id="1D-1D-的四边形不等式优化"><a href="#1D-1D-的四边形不等式优化" class="headerlink" title="1D/1D 的四边形不等式优化"></a>1D/1D 的四边形不等式优化</h2><p>还是来看 1D/1D 型 dp 方程：<br>$$<br>d[i] = \min_{l(i) \le j \le r(i)} (d[j] + val(i, j))<br>$$<br>我们记 $bp[i]$ （ best pos ）表示 $d[i]$ 的最优决策点，即使 $d[i]$ 取得最小的 $j$ 的值，若 $bp$ 单调（不要求严格）且 $l(i), r(i)$ 也单调，则称 $d$ 具有<strong>决策单调性</strong></p><h3 id="1D-决策单调性定理"><a href="#1D-决策单调性定理" class="headerlink" title="1D 决策单调性定理"></a>1D 决策单调性定理</h3><p>对于 1D/1D 型 dp 方程： $d[i] = \min_{l(i) \le j \le r(i)} (d[j] + val(i, j))$ ，若 $val(i, j)$ 满足四边形不等式，且 $r(i) \le i$ ，则 $d$ 具有决策单调性</p><p>证明：<br>$$<br>\begin{aligned}<br>&amp; \forall i \in [1, n], \forall j \in [l(i), bp[i] - 1]由 bp[i] 的最优性可得: \\<br>&amp; d[bp[i]] + val(i, bp[i]) \le d[j] + val(i, j) &amp; (1) \\<br>&amp; \forall k \in [i + 1, n], 由四边形不等式得: \\<br>&amp; val(k, j) + val(i, bp[i]) \ge val(i, j) + val(k, bp[i]) \\<br>&amp; val(k, bp[i]) - val(i, bp[i]) \le val(k, j) - val(i, j) &amp; (2) \\<br>(1) + (2) 得: \\<br>&amp; d[bp[i]] + val(k, bp[i]) \le d[j] + val(k, j)<br>\end{aligned}<br>$$<br>也就是说， $\forall k &gt; i$ ，以 $bp[i]$ 做为决策一定比以 $j &lt; bp[i]$ 作为决策优（或者相等），所以 $k$ 的最优决策不可能小于 $bp[i]$ ，即 $bp[k] \ge bp[i]$ ，则 $bp$ 单调递增，故 $d$ 具有决策单调性（但这里一定要有 $l(i), r(i)$ 也单调，否则可能出现 $bp[i]$ 不能做 $k$ 的决策，但 $j$ 可以的情况）</p><p>QED</p><p>所以，四边形不等式优化 1D/1D dp 的方法其实就是推出决策单调性，然后用单调性维护（这里有一个蒟蒻专用技巧，那就是直接猜它有单调性，这样就可以直接做了 <del>蒟蒻的挣扎</del> ，不行还可以先打个暴力 dp 然后把最优决策输出来看看有没有单调性）当 $d$ 具有决策单调性时，我们可以把 $O(n^2)$ 的 1D/1D dp 优化到 $O(n \log n)$ （这里未考虑计算 $val$ 的时间）</p><h3 id="队列-二分"><a href="#队列-二分" class="headerlink" title="队列 + 二分"></a>队列 + 二分</h3><p>一般可以用<strong>队列 + 二分</strong>：</p><p>考虑对于 $bp$ 进行维护，我们每次直接修改 $bp$ 数组是很低效的，我们维护若干个三元组 $(j, l, r)$ ，表示“在 $i \in [l, r]$ 时， $j$ 是最优决策，即 $bp[l \sim r] = j$ ”然后用队列维护，对于每个 $i$ ，进行如下操作：</p><ul><li>检查队头三元组 $(j _0, l _0, r _0)$ ，若 $r _0 &lt; i$ 删除队头，否则令 $l_0 = i$ </li><li>取队头的 $j$ 为最优决策进行转移</li><li>尝试插入决策 $i$ ，初始化 $pos = r_t + 1$ ，其中 $r_t$ 为队尾三元组执行如下步骤：<ol><li>取出队尾，记为 $(j _t, l _t, r _t)$ </li><li>若对于 $d[l _t]$ 决策 $i$ 优于 $j$ ，删除队尾，记 $pos = l _t$ ，回到第 $1$ 步</li><li>否则，若对于 $d[r _t]$ ， $j$ 优于 $i$ ，去向第 $5$ 步</li><li>否则，在 $[l _t, r _t]$ 上二分一个位置 $pos$ ，把 $r _t$ 赋为 $pos - 1$ ，去第 $5$ 步</li><li>把三元组 $(i, pos, n)$ 插入队尾</li></ol></li></ul><p>不难发现每个 $i$ 最多出/如队一次， $\log n$ 消耗在二分上</p><h3 id="分治"><a href="#分治" class="headerlink" title="分治"></a>分治</h3><p>有一种特殊情况，如果 dp 方程是与 $d[j]$ 无关的，即：<br>$$<br>d[i] = \min_{l(i) \le j \le r(i)} (val(i, j))<br>$$<br>其中 $val(i, j)$ 不含有关 $d[j]$ 的项，那么我们可以用分治</p><p>要注意，这里的“无关于 $d[j]$ ”指的是“无关于本层的 $d[j]$ ”，如果 dp 状态还有几维，而在把外层变量当常量后，前几层的 $d[j]$ 已经计算完毕，也是常量，就可以用了（关于为什么，可以看下面）</p><p>设函数 <code>sol(l, r, L, R)</code> 表示“当然正在处理 $d[l \sim r]$ ，最优决策存在于区间 $[L, R]$ ”，函数伪代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sol(l, r, L, R)</span><br><span class="line">if (l &gt; r || L &gt; R) return </span><br><span class="line">mid &lt;- l + r &gt;&gt; 1</span><br><span class="line">for i : L -&gt; R</span><br><span class="line">找到最优决策点 pos </span><br><span class="line">end for</span><br><span class="line">用 pos 跟新 d[mid]</span><br><span class="line">sol(l, mid - 1, L, pos)</span><br><span class="line">sol(mid + 1, r, pos, R)</span><br><span class="line">end sol</span><br></pre></td></tr></table></figure><p>很明显（<del>分治好打的多</del>）共会递归 $\log n$ 层，每层一共会扫一个 $n$ ，总共是 $O(n \log n)$ </p><p>现在我们来看为什么要保证方程无关于本层的 $d[j]$ ，其实这很明显，我们是跟新完 $d[mid]$ 再去求 $d[l \sim mid - 1]$ 和 $d[mid + 1 \sim r]$ 的，所以我们跟新 $d[mid]$ 时，本层其它的 $d$ 根本还没算，怎么能用呢？</p><p>由此可以看出，队列 + 二分的方法泛用性更广，但考虑到分治的过程中可以同时计算一些信息（如 $val$ 或者题目中的其它问题）有些题用分治会更好</p><h2 id="例题九"><a href="#例题九" class="headerlink" title="例题九"></a>例题九</h2><p><a href="https://www.luogu.com.cn/problem/P1912">诗人小G</a></p><p>老经典题了</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>首先记 $len[i]$ 为第 $i$ 句诗的长度， $sum[i]$ 为 $len[i]$ 的前缀和，设 $d[i]$ 表示“前 $i$ 句诗的最小不协调度”，有：<br>$$<br>d[i] = \min _{0 \le j &lt; i} (d[j] + (\mid sum[i] - sum[j] + i - j - 1 - L \mid)^P)<br>$$<br>其中 $i - j - 1$ 是空格的个数</p><p>典型的 1D/1D ，为简单记 $f(i) = sum[i] + i$ ，有 $val(i, j) = (\mid f(i) - f(j) - (1 + L) \mid)^P$ 很明显由于次数过高，无法斜率优化，考虑四边形不等式</p><p>用判定定理， $\forall a &lt; b$ ，我们要证明 $val(a, b + 1) + val(a + 1, b) \ge val(a, b) + val(a + 1, b + 1)$ </p><p>变形：<br>$$<br>\begin{aligned}<br>val(a, b + 1) + val(a + 1, b) &amp; \ge val(a, b) + val(a + 1, b + 1) \\<br>(\mid f(a) - f(b + 1) - (1 + L) \mid)^P + (\mid f(a + 1) - f(b) - (1 + L) \mid)^P &amp; \ge (\mid f(a) - f(b) - (1 + L) \mid)^P + (\mid f(a + 1) - f(b + 1) - (1 + L) \mid)^P \\<br>因为 f(x + 1) &amp; = f(x) + len[x + 1] + 1 \\<br>故化为: \\<br>(\mid f(a) - f(b + 1) - (1 + L) \mid)^P + (\mid f(a) - f(b) - (1 + L) + len[a + 1] + 1 \mid)^P &amp; \ge (\mid f(a) - f(b) - (1 + L) \mid)^P + (\mid f(a) - f(b + 1) - (1 + L) + len[a + 1] + 1 \mid)^P \\<br>记 u = f(a) - f(b) - (1 + L), v = f(a) - f(b + 1) &amp;- (1 + L) , t = len[a + 1] + 1\\<br>明显有 v = u - len[b + 1] - 1 &amp; &lt; u \\<br>于是原式化为: \\<br>(\mid v \mid)^P + (\mid u + t\mid)^P &amp; \ge (\mid u \mid)^P + (\mid v + t \mid)^P \\<br>(\mid v \mid)^P - (\mid v + t \mid)^P &amp; \ge (\mid u \mid)^P - (\mid u + t\mid)^P \\<br>\end{aligned}<br>$$<br>那么，我们只要证明函数 $g(x) = (\mid x \mid)^P - (\mid x + c \mid)^P$ （其中 $P, c$ 是常数）为减函数，则四边形不等式得证</p><p>而证明减函数只要分类讨论去掉绝对值，然后求导就可以了（分类讨论太长，这里就不打了）</p><p>无论如何，我们证得原函数满足四边形不等式，可得决策单调性</p><p>至于维护，本题方程中用到了本层的其它 $d$ （<del>废话，一共只有一层啊</del>），所以<strong>不能分治</strong>，我们<strong>采用队列 + 二分</strong></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>细节颇多，输出格式尤其要注意（行末没有空格！）</p><p>另外中间转移时会炸 <code>long long</code> 开 <code>__int128</code> 也不行，只能开 <code>long double</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, S = <span class="number">35</span>;</span><br><span class="line"><span class="keyword">const</span> LD INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> n, L, P, sum[N], h, t, from[N];</span><br><span class="line"><span class="keyword">char</span> s[N][S];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Date</span>&#123;</span> <span class="keyword">int</span> bp, l, r; &#125; q[N];</span><br><span class="line">LD d[N];</span><br><span class="line"><span class="function">LD <span class="title">qpow</span><span class="params">(LD x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LD res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; y; x *= x, y &gt;&gt;= <span class="number">1</span>) <span class="keyword">if</span> (y &amp; <span class="number">1</span>) res *= x;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LD <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span>&#123; <span class="keyword">return</span> d[j] + <span class="built_in">qpow</span>(<span class="built_in">abs</span>(sum[i] - sum[j] + i - j - <span class="number">1</span> - L), P); &#125; <span class="comment">//dp方程</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l != <span class="number">1</span>) <span class="built_in">print</span>(from[l - <span class="number">1</span>] + <span class="number">1</span>, l - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%s &quot;</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, s[r] + <span class="number">1</span>); <span class="comment">//行末不空格</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); T--; <span class="built_in">puts</span>(<span class="string">&quot;--------------------&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;L, &amp;P);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s[i] + <span class="number">1</span>), sum[i] = <span class="built_in">strlen</span>(s[i] + <span class="number">1</span>) + sum[i - <span class="number">1</span>];</span><br><span class="line">        q[h = t = <span class="number">1</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, n&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, pos; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (; h &lt;= t &amp;&amp; q[h].r &lt; i; ++h);</span><br><span class="line">            d[i] = <span class="built_in">calc</span>(i, q[h].bp), from[i] = q[h].bp;</span><br><span class="line">            <span class="keyword">for</span> (pos = n + <span class="number">1</span>; h &lt;= t &amp;&amp; <span class="built_in">calc</span>(q[t].l, i) &lt;= <span class="built_in">calc</span>(q[t].l, q[t].bp); pos = q[t--].l);</span><br><span class="line">            <span class="keyword">if</span> (h &lt;= t &amp;&amp; <span class="built_in">calc</span>(q[t].r, i) &lt;= <span class="built_in">calc</span>(q[t].r, q[t].bp))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> l = q[t].l, r = q[t].r, mid;</span><br><span class="line">                <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">                &#123;</span><br><span class="line">                    mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    <span class="built_in">calc</span>(mid, i) &lt;= <span class="built_in">calc</span>(mid, q[t].bp) ? r = (pos = mid) - <span class="number">1</span> : l = mid + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                q[t].r = pos - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pos &lt;= n) q[++t] = &#123;i, pos, n&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (d[n] &gt; INF) <span class="built_in">puts</span>(<span class="string">&quot;Too hard to arrange&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%.0Lf\n&quot;</span>, d[n]), <span class="built_in">print</span>(from[n] + <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题十"><a href="#例题十" class="headerlink" title="例题十"></a>例题十</h2><p><a href="https://codeforces.com/contest/321/problem/E">Ciel and Gondolas</a></p><h3 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h3><p>有 $n \le 10^5$ 个数（记为 $a_i$ ），要将它们划分成连续的 $k \le 20$ 段，每段的代价是该段中相同元素的对数，求所有子段的费用之和的最小值</p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>明显的区间 dp ，先写方程，设 <code>d[i, j]</code> 表示“前 $i$ 个数分成 $j$ 段的最小代价”，明显，设 $val(l, r)$ 表示“ $[l, r]$ 中相同的数的对数”，有：<br>$$<br>d[i, j] = \min _{0 \le k &lt; i} (d[k, j - 1] + val(k + 1, i))<br>$$<br>如果直接 dp ，时间明显是 $O(n^2 k * O(计算val(k + 1, i)))$ </p><p>呃呃，先把 $O(计算val(k + 1, i))$ 放一下，因为在如何 dp 不确定的情况下，我们也不太好考虑如何计算 $val$ （当然，暴力计算挂的死死的）</p><p>明显 $j$ 做外层循环，这就又是个 1D/1D ，我们连如何算 $val$ 都不知道，当然没法斜率优化，考虑四边形不等式</p><p>我们要证明，对于任意的 $i &lt; j$ ，有 $val(i, j + 1) + val(i + 1, j) \ge val(i, j) + val(i + 1, j + 1)$ </p><p>设区间 $[i + 1, j]$ 中有 $x$ 个数与 $a_i$ 相同，有 $y$ 个数与 $a_{j + 1}$ 相同</p><p>我们要证：<br>$$<br>(x + y + [a_i == a_{j + 1}] + val(i + 1, j)) + val(i + 1, j) \ge (x + val(i + 1, j)) + (y + val(i + 1, j))<br>$$<br>（其中 $[…]$ 表示“当 $…$ 成立时为 $1$ ”）</p><p>而上式正确性显然，故 $val$ 满足四边形不等式，决策具有单调性，理论上来讲，我们可以把 dp 的时间从 $O(n^2 k)$ 优化到 $O(n k \log n)$ ，观察数据范围，我们希望 $O(计算val(k + 1, i))$ 要做到 $O(1)$ </p><p>预处的想法是不行的，因为 $n \le 10^5$ 太大了存不下，所以我们只能每次直接求，但每次扫区间很明显是挂了的，我们考虑用上次的 $val$ 计算这次的 $val$ ，发现“统计区间内”是莫队的经典问题，考虑像莫队一样维护双指针，但莫队的时间复杂度有保证是因为调整了询问的顺序，所以我们也想到调整 dp 顺序</p><p>观察方程，不难发现，  $d[i, j]$ 与 $d[k, j]$ 无关（只由 $d[k, j - 1]$ 转移），于是<strong>可以用分治</strong>的方法，而选择分治的好处在于<strong>分治的计算顺序恰好可以保证莫队的时间复杂度</strong>，简证如下：</p><p>首先，对于分治的每一层单独来看（就不考虑进入下一层的情况，直接把本层的连起来，类似 <code>sort</code> 的分析方法），会发现两个指针在每一层一定<strong>最多扫过每个元素各一遍</strong>（因为在每一层，两个指针都是单调的），有 $\log n$ 层，故层内指针总共移动 $O(n \log n)$ 次</p><p>再考虑进入下一层/从下一层返回的额外移动，设 $(l, r, L, R)$ 表示当前计算区间为 $d[l \sim r]$ ，最优决策存在于区间 $[L, R]$ ，设最优决策为 $pos$ ，设 $mid = l + r &gt;&gt; 1$ ，设双指针为 $il, ir$ 在这个区间计算完成后，一定有 $il = pos + 1, ir = mid$ （ $il$ 要加一，原因自己去看方程），而下一层 $(l, mid - 1, L, pos)$ 开始时会把指针移动到 $il = L + 1, ir = (l + mid - 1) &gt;&gt; 1$ ，两个指针移动的距离都小于等于当前区间长度 $r - l + 1$ ，从左区间回来时先把两个指针移回（显然耗时与移去相同），再进入右区间 $(mid + 1, r, pos, R)$ ，开始时会把指针移动到 $il = pos, ir = (mid + 1 + r) &gt;&gt; 1$  两个指针移动的距离也都小于等于当前区间长度 $r - l + 1$ ，故对于当前区间，进入下一层/从下一层返回的额外移动是 $O(r - l + 1)$ 级的；每层区间的长度加起来等于 $n$ ，故每层进入下一层/从下一层返回的额外移动是 $O(n)$ 级的，而一共有 $\log n$ 层，故额外的移动总时间也是 $O(n \log n)$ 的</p><p>本题就体现了分治的优势，在题目转移顺序<strong>允许分治</strong>的情况下，分治的计算顺序为我们计算额外信息提供便利，且代码也好打</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p>明显 $j$ 可以滚动压掉</p><p>注意转移时用的是 $val(k + 1, i)$ ，而决策点是 $k$ ，所以注意 $0 \le k &lt; i$ </p><p>关于 $0$ ，要注意 <code>d[0][0] = 0</code> ，而其它 <code>d[i][0] = INF</code> （明显把 $i$ 个人分成 $0$ 段方案不存在）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], n, k, o;</span><br><span class="line">LL d[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">namespace</span> MD <span class="comment">//莫队</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt[N], il = <span class="number">1</span>, ir = <span class="number">0</span>;</span><br><span class="line">    LL val;</span><br><span class="line">    <span class="function">LL <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> <span class="comment">//把指针移动到[l, r]</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; il &lt; l; val -= --cnt[a[il++]]);</span><br><span class="line">        <span class="keyword">for</span> (; il &gt; l; val += cnt[a[--il]]++);</span><br><span class="line">        <span class="keyword">for</span> (; ir &lt; r; val += cnt[a[++ir]]++);</span><br><span class="line">        <span class="keyword">for</span> (; ir &gt; r; val -= --cnt[a[ir--]]);</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sol</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r || L &gt; R) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>, pos = L;</span><br><span class="line">    LL t;</span><br><span class="line">    d[mid][o ^ <span class="number">1</span>] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = L, Rr = <span class="built_in">min</span>(R, mid - <span class="number">1</span>); i &lt;= Rr; ++i)</span><br><span class="line">        <span class="keyword">if</span> ((t = d[i][o] + MD::<span class="built_in">calc</span>(i + <span class="number">1</span>, mid)) &lt; d[mid][o ^ <span class="number">1</span>]) d[mid][o ^ <span class="number">1</span>] = t, pos = i;</span><br><span class="line">    <span class="built_in">sol</span>(l, mid - <span class="number">1</span>, L, pos), <span class="built_in">sol</span>(mid + <span class="number">1</span>, r, pos, R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), d[i][<span class="number">0</span>] = d[i][<span class="number">1</span>] = INF;</span><br><span class="line">    d[<span class="number">0</span>][o] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i, o ^= <span class="number">1</span>) <span class="built_in">sol</span>(<span class="number">1</span>, n, <span class="number">0</span>, n - <span class="number">1</span>); <span class="comment">//这里减1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, d[n][o]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2D-1D-的四边形不等式优化"><a href="#2D-1D-的四边形不等式优化" class="headerlink" title="2D/1D 的四边形不等式优化"></a>2D/1D 的四边形不等式优化</h2><p>如果只是优化 1D/1D dp，四边形不等式显然不是很强，所以我们来看看更高维的 dp </p><p> 2D/1D dp 的方程模型如下：<br>$$<br>d[i, j] = \min_{l(i, j) \le k \le r(k, j)} (d[i, k] + d[k + 1, j] + val(i, j))<br>$$<br>其中 2D 指枚举的状态数， 1D 指枚举的决策数，最典型的是区间 dp ，明显，直接 dp 时间为 $O(n^3)$ （一定要注意 $val(i, j)$ 与 $k$ 无关）</p><p><strong>警告！下面的证明都很繁琐且没啥用（完全不影响做题），可以只记结论</strong></p><h3 id="2D-状态四边形不等式判定"><a href="#2D-状态四边形不等式判定" class="headerlink" title="2D 状态四边形不等式判定"></a>2D 状态四边形不等式判定</h3><p>对于 2D/1D dp 的方程：<br>$$<br>d[i, j] = \min_{l(i, j) \le k \le r(k, j)} (d[i, k] + d[k + 1, j] + val(i, j))<br>$$<br>若 $val$ 满足<strong>四边形不等式</strong>和<strong>区间包含单调性</strong>（忘了的回去翻定义）， $d$ 满足 $d[i, i] =  val(i, i) = 0$ ，且 $i \le l(i, j) \le r(i, j) &lt; j$ 则 $d[i, j]$ 满足四边形不等式</p><p>证明（又臭又长）：</p><p>当 $j = i + 1$ 时， $d[i, j + 1] + d[i + 1, j] = d[i, i + 2] + d[i + 1, i + 1]$ ，又因为 $d[i + 1, i + 1] = 0$ ，故 $d[i, j + 1] + d[i + 1, j] = d[i, i + 2]$ </p><p>由于 $i \le l(i, j) \le r(i, j) &lt; j$ ， $d[i, i + 2]$ 的决策最多只有 $i$ 和 $i + 1$ </p><ol><li><p>若 $d[i, i + 2]$ 的最优决策为 $i + 1$ ，则<br>$$<br>d[i, i + 2] = d[i, i + 1] + d[i + 2, i + 2] + val(i, i + 2) = d[i, i + 1] + val(i, i + 2)<br>$$<br> ，发现 $d[i, i + 1]$ 的决策只有 $i$ ，故 $d[i, i + 1] = d[i, i] + d[i + 1, i + 1] + val(i, i + 1) = val(i, i + 1)$ ，综合两式，有 $d[i, i + 2] = val(i, i + 1) + val(i, i + 2) = d[i, j + 1] + d[i + 1, j]$  </p><p>同样因为 $d[i, i] = 0$ ，有 $d[i, i + 1] + d[i + 1, i + 2] = val(i, i + 2) + val(i + 1, i + 2) = d[i, j] + d[i + 1, j + 1]$ </p><p>由于 $val$ 满足四边形不等式，有 $val(i, i + 1) + val(i, i + 2) \ge val(i, i + 1) + val(i + 1, i + 2)$ </p><p>故 $d[i, j + 1] + d[i + 1, j] \ge d[i, j] + d[i + 1, j + 1]$ ，即 $d$ 满足四边形不等式</p></li><li><p>若 $d[i, i + 2]$ 的最优决策为 $i$  ，同理有<br>$$<br>d[i, i + 2] = d[i, i] + d[i + 1, i + 2] + val(i, i + 2) = d[i + 1, i + 2] + val(i, i + 2) = val(i + 1, i + 2) + val(i, i + 2)<br>$$<br>$d[i + 1, i + 2] + d[i, i + 1] = val(i + 1, i + 2) + val(i, i + 1) = d[i + 1, j + 1] + d[i, j]$ </p><p>同样由 $val$ 满足四边形不等式，得 $d[i, j + 1] + d[i + 1, j] \ge d[i, j] + d[i + 1, j + 1]$ </p></li></ol><p>综上，当 $j = i + 1$ ，即 $j - i = 1$ 时， $d$ 满足四边形不等式</p><p>假设当 $j - i &lt; k$ 时四边形不等式成立，下面证明 $j - i = k$ 时成立</p><p>设 $d[i, j + 1]$ 最优决策为 $x$ ， $d[i + 1, j]$ 最优决策为 $y$  </p><p>有等式 $(1)$ ：<br>$$<br>d[i, j + 1] + d[i + 1, j] = d[i, x] + d[x + 1, j + 1] + val(i, j + 1) + d[i + 1, y] + d[y + 1, j] + val(i + 1, j)<br>$$<br>而对于 $d[i, j]$ 和 $d[i + 1, j + 1]$ ，  $x, y$ 就不一定是最优决策了</p><p>当 $x \le y$ 时，取 $x$ 为 $d[i, j]$ 的决策， $y$ 为 $d[i + 1, j + 1]$ 的决策，由不优得不等式 $(2)$ ：<br>$$<br>d[i, x] + d[x + 1, j] + val(i, j) + d[i + 1, y] + d[y + 1, j + 1] + val(i + 1, j + 1) \ge d[i, j] + d[i + 1, j + 1]<br>$$<br> $(1) + (2)$ 得 $(3)$ ：<br>$$<br>\begin{aligned}<br>d[i, x] + d[x + 1, j] + val(i, j) + d[i + 1, y] + d[y + 1, j + 1] + val(i + 1, j + 1) + d[i, j + 1] + d[i + 1, j] &amp; \ge d[i, j] + d[i + 1, j + 1] + d[i, x] + d[x + 1, j + 1] + val(i, j + 1) + d[i + 1, y] + d[y + 1, j] + val(i + 1, j) \\<br>d[x + 1, j] + d[i + 1, y] + d[y + 1, j + 1] + d[i, j + 1] + d[i + 1, j] + val(i, j) + val(i + 1, j + 1) &amp; \ge d[i, j] + d[i + 1, j + 1] + d[x + 1, j + 1] + d[y + 1, j] + val(i, j + 1) + val(i + 1, j) \\<br>\end{aligned}<br>$$<br>有 $x + 1 \le y + 1 \le j &lt; j + 1$ ，由归纳假设，有 $d[x + 1, j + 1] + d[y + 1, j] \ge d[x + 1, j] + d[y + 1, j + 1]$ ，结合 $val$ 满足四边形不等式，与 $(3)$ 比较得：<br>$$<br>d[i, j + 1] + d[i + 1, j] \ge d[i, j] + d[i + 1, j + 1]<br>$$<br>则 $j - i = k$ 时满足四边形不等式；</p><p>当 $x \ge y$ 时，取 $y$ 为 $d[i, j]$ 的决策， $x$ 为 $d[i + 1, j + 1]$ 的决策，同理可证得 $j - i = k$ 时满足四边形不等式</p><p>由数学归纳法原理，原命题得证</p><p>QED</p><h3 id="2D-决策单调性定理"><a href="#2D-决策单调性定理" class="headerlink" title="2D 决策单调性定理"></a>2D 决策单调性定理</h3><p>对于 2D/1D dp 的方程：<br>$$<br>d[i, j] = \min_{l(i, j) \le k \le r(k, j)} (d[i, k] + d[k + 1, j] + val(i, j))<br>$$<br>记 $d[i, j]$ 的最优决策点为 $bp[i, j]$ ，若 $\forall i &lt; j$ 有 $bp[i, j - 1] \le bp[i, j] \le bp[i + 1, j]$ ，则称 $d$ 具有决策单调性</p><p>若 $d$ 满足 $d[i, i] =  val(i, i) = 0$ ， $i \le l(i, j) \le r(i, j) &lt; j$ ，且 $d$ 满足四边形不等式，则 $d$ 具有决策单调性</p><p>证明：</p><p>记 $p = bp[i, j]$ ，则 $\forall i &lt; k \le p$ ，因为 $d$ 满足四边形不等式，有：<br>$$<br>\begin{aligned}<br>d[i, p] + d[i + 1, k] &amp; \ge d[i, k] + d[i + 1, p] \\<br>d[i + 1, k] - d[i + 1, p] &amp; \ge d[i, k] - d[i, p] \\<br>\end{aligned}<br>$$<br>又由 $p$ 的最优性（带 dp 方程消去 $val$ 可得）：<br>$$<br>\begin{aligned}<br>d[i, k] + d[k + 1, j] &amp; \ge d[i, p] + d[p + 1, j] \\<br>d[i, k] - d[i, p] + d[k + 1, j] - d[p + 1, j] &amp; \ge 0 \\<br>\end{aligned}<br>$$<br>考虑对于 $d[i + 1, j]$ 用 $k$ 为决策减用 $p$ 为决策：<br>$$<br>\begin{aligned}<br>&amp; (d[i + 1, k] + d[k + 1, j] + val(i + 1, j)) - (d[i + 1, p] + d[p + 1, j] + val(i + 1, j)) \\<br>= &amp; (d[i + 1, k] - d[i + 1, p]) + (d[k + 1, j] - d[p + 1, j]) \\<br>\ge &amp; (d[i, k] - d[i, p]) + (d[k + 1, j] - d[p + 1, j]) \\<br>\ge &amp; 0<br>\end{aligned}<br>$$<br>也就是说，对于 $d[i + 1, j]$ ， $p$ 比任意 $k \le p$ 更优，故 $bp[i + 1, j] \ge bp[i, j]$ ，同理可证明 $bp[i, j - 1] \le bp[i, j]$ </p><p>QED</p><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p> 2D/1D 的实现没有 1D/1D 那么花里胡哨，就是直接记录 $bp$ ，对于 $d[i, j]$ ，只在 $bp[i, j - 1] \le k \le bp[i + 1, j]$ 的范围枚举 $k$ 维护 $d, bp$ </p><p>时间也很好分析：<br>$$<br>\begin{aligned}<br>&amp; \sum _{i = 1}^{n - 1} \sum _{j = i + 1}^{n} (bp[i + 1, j] - bp[i, j - 1] + 1) \\<br>= &amp; \sum _{i = 1} ^ {n - 1} (bp[i + 1, n] - bp[1, n - i] + n - i) \\<br>\le &amp; n^2<br>\end{aligned}<br>$$<br>故时间复杂度优化到了 $O(n^2)$ </p><p>你可能觉得似乎没有 1D/1D 优化的厉害，但其实， 1D/1D 状态数是 $O(n)$ 的，四边形不等式把转移从 $O(n)$ 优化到了 $O(\log n)$ （斜率优化在最简单的情况下可以优化到 $O(1)$ ，最麻烦情况下只有 $O(\log^2 n)$ ）；而 2D/1D 状态数是 $O(n^2)$ 的，四边形不等式把转移从 $O(n)$ 直接优化到 $O(1)$ ，作为<strong>对转移的优化</strong>，已经非常优秀了（事实上，如果你不考虑重新设计状态/排除无用状态， $O(n^2)$ 已经是最好复杂度了）</p><p>最后提醒一点：以上的复杂度分析都没有考虑计算 $val$ 的复杂度！（这一点从例题十中也能看出）</p><h2 id="例题十一"><a href="#例题十一" class="headerlink" title="例题十一"></a>例题十一</h2><p><a href="https://www.acwing.com/problem/content/307/">一个古老的石头游戏</a></p><p>题意同“石子合并”，但要求 $O(n^2)$ ，太经典了，就是板子</p><p>话说好像有 $O(n \log n)$ 做法，但那和我们要讲的没关系了……</p><p>艹，好像数据加强了， $O(n^2)$ 过不了了！ shit ！</p><h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>呃呃，还要思路吗？</p><p>写个方程吧：设 $d[i, j]$ 表示“合并区间 $[i, j]$ 的最小代价”，转移有：<br>$$<br>d[i, j] = \min _{i \le k &lt; j} (d[i, k] + d[k + 1, j]) + \sum _{t = i}^j a _t<br>$$<br> $val(i, j)$ 显然可以前缀和做到 $O(1)$ </p><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>, INF = <span class="number">1e9</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N], d[N][N], bp[N][N];</span><br><span class="line">LL sum[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), n; sum[<span class="number">0</span>] = <span class="number">0</span>, <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, d[<span class="number">1</span>][n]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), sum[i] = sum[i - <span class="number">1</span>] + a[i], d[i][i] = <span class="number">0</span>, bp[i][i] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">2</span>; len &lt;= n; ++len)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j, k; i &lt;= n; ++i)</span><br><span class="line">                <span class="keyword">for</span> (d[i][j = i + len - <span class="number">1</span>] = INF, k = bp[i][j - <span class="number">1</span>]; k &lt;= bp[i + <span class="number">1</span>][j] &amp;&amp; k &lt; j; ++k)</span><br><span class="line">                    <span class="keyword">if</span> (d[i][k] + d[k + <span class="number">1</span>][j] + sum[j] - sum[i - <span class="number">1</span>] &lt; d[i][j]) d[i][j] = d[i][bp[i][j] = k] + d[k + <span class="number">1</span>][j] + sum[j] - sum[i - <span class="number">1</span>];</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2D-1D-的另一种形式"><a href="#2D-1D-的另一种形式" class="headerlink" title="2D/1D 的另一种形式?"></a>2D/1D 的另一种形式?</h2><p>如下<br>$$<br>d[i, j] = \min (d[k, j - 1] + val(k + 1, i))<br>$$<br>你会发现其实就是例题十，优化方式也一样，但有些地方把它归类为 2D/1D 优化，可能是因为状态是 $O(n^2)$ 的，但这里还是决定把它归为 1D/1D ，因为外层的 $j$ 我们是当常量的，优化方式也更像（或者说就是） 1D/1D 型</p><h1 id="废话-待续"><a href="#废话-待续" class="headerlink" title="废话 + 待续"></a>废话 + 待续</h1><p>解决完四边形不等式，就还剩凸优化一个大点和其它一些小点了，慢慢搞吧</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分治 </tag>
            
            <tag> dp </tag>
            
            <tag> 二分 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 四边形不等式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AtCoder AGC015 D</title>
      <link href="/2022/02/12/AtCoder-AGC015-D/"/>
      <url>/2022/02/12/AtCoder-AGC015-D/</url>
      
        <content type="html"><![CDATA[<p> 日本オリジナル輸入問題</p><span id="more"></span><p><a href="https://atcoder.jp/contests/AGC015/tasks/agc015_d">A or…or B Problem</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $L, R \le 2^{60}$ ，求在区间 $[L, R]$ 中选若干个或起来有多少种取值</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>首先 <del>打个表</del> 通过充分的思考，我们可以发现<strong>其实选超过 $2$ 个数和选 $2$ 个数答案是一样的</strong>，简证 <del>口胡</del> 如下：</p><p>对于一种选法，假设我们选了数 $a_1, a_2, …, a_n$ ，且 $a_1 or a_2 or … or a_n = A$ ，我们找到<strong>二进制下最高的一个不全相同的位置</strong>，如图：</p><p><img src="https://s2.loli.net/2022/02/12/NAOJXZrtsoDVuyP.png" alt="高 to 低"></p><p>前面的高位（蓝色）每个 $a_i$ 都相同，后面的低位（橘色）我们不管，绿色框住的就是最高不同位</p><p>我们任取一个 $a_i$ 该位为 $1$ （如图中 $a_1$ ），再取一个 $a_j$ 该位为 $0$ （如图中 $a_2$ ），然后，我们把 $a_i$ 后面的低位（橘色）全赋为 $0$ ，记为 $a_i’$，赋完后 $a_i’$ 该位仍然为 $1$ ，则有 $a_j &lt; a_i’ \le a_i$ ，由于 $a_i, a_j \in [L, R]$ ，故 $a_i’ \in [L, R]$ ；类似的，我们把 $a_j$ 后面的低位（橘色）赋值为和 $A$ 相同（仅橘色部分相同），有 $a_j \le a_j’ &lt; a_i$ ，即 $a_j’ \in [L, R]$ ；最后，我们用 $a_i’ or a_j’ = A$ 来替代这 $n$ 个数</p><p>综上， 选超过 $2$ 个数和选 $2$ 个数答案是一样</p><p>然后考虑从 $[L, R]$ 中选一个或两个数有多少种取值，我们找到 $L, R$ 的二进制下最高的不同位，记为 $bit$ （很明显 $R$ 该位为 $1$ ），再取 $t$ 是前 $bit$ 位都和 $R$ 相同，后面全为 $0$ ，如图</p><p><img src="https://s2.loli.net/2022/02/12/EsG8VkPCoyeMz9n.png" alt="LR"></p><p>绿色是第 $bit$ 位，蓝色部分都相同， $L, R$ 的橙色部分不确定，但 $t$ 的橙色部分全为 $0$ ，显然 $L &lt; t \le R$ ，我们把区间 $[L, R]$ 分成 $[L, t)$ ， $[t, R]$ 两段分类讨论，最后取并集即可，不妨设我们选的数为 $x, y$ 且 $x &lt; y$ （若只选了一个，就设选的为 $x$ ）：</p><h3 id="1）-x-y-in-L-t"><a href="#1）-x-y-in-L-t" class="headerlink" title="1） $x, y \in [L, t)$"></a>1） $x, y \in [L, t)$</h3><p>此时 $x or y$ 一定属于 $[L, t)$ （或运算不会变小，且或后第 $bit$ 一定为 $0$ ），而且，注意到可以只选一个，所以一定可以取遍 $[L, t)$ </p><h3 id="2）-x-y-in-t-R"><a href="#2）-x-y-in-t-R" class="headerlink" title="2） $x, y \in [t, R]$"></a>2） $x, y \in [t, R]$</h3><p>你会发现这个问题就是原问题，只不过 $L$ 变成了 $t$ ，但 $t$ 比 $L$ 多一个关键性质：  $t$ 的 $bit$ 位以后都是 $0$ ，这意味着，若 $R$ 在 $bit$ 位以后最高的 $1$ 在第 $k$ 位，那么 $x or y$ 或者 $x$ 在 $bit$ 位以后最高的 $1$ 在最高也只能在第 $k$ 位，而 $k$ 位以后都可以为 $1$ ，因为区间 $[t, R]$ 是连续的，而 $t$ 的第 $k$ 位即以后都是 $0$ ，每次加 $1$ ，要变到 $R$ ，即第 $k$ 位为 $1$ ，则 $k$ 以下的位置一定是出现过为 $1$ 的情况的，于是，构造 $p$ 如下：</p><p><img src="https://s2.loli.net/2022/02/12/MNpsxZgXv5meQKz.png" alt="p"></p><p>蓝色高位都相同，绿色是第 $bit$ 位，紫色部分都为 $0$ ，红色部分都为 $1$ ，橙色部分任意， $R$ 未被框起来的是第 $k$ 位</p><p>于是 $x or y$ 就取值于 $[t, p]$ （ $x$ 取值为 $[t, R]$ 被包含了）</p><h3 id="3）-x-in-L-t-y-in-t-R"><a href="#3）-x-in-L-t-y-in-t-R" class="headerlink" title="3） $x \in [L, t), y \in [t, R]$"></a>3） $x \in [L, t), y \in [t, R]$</h3><p>此时一定是取了两个数的情况</p><p>下限很好求，就是 $L or t$ ，对于上限，由于前 $bit$ 位最大也只能和 $R$ 一样，而那么最大就是 $bit$ 位以后全为 $1$ ，构造也很简单，就是 $x = t - 1, y = t$ 即可，由于两个区间都是连续的，所以 $x or y \in [L or t, t or (t - 1)]$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>不难发现前两个情况可以连起来，记得特判区间长度只有 $1$ 的情况</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL l, r, t, ans;</span><br><span class="line">    <span class="keyword">int</span> bit;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; <span class="built_in"><span class="keyword">bool</span></span>(r &gt;&gt; i); ++i) <span class="keyword">if</span> (((l &gt;&gt; i) &amp; <span class="number">1</span>) != ((r &gt;&gt; i) &amp; <span class="number">1</span>)) bit = i;</span><br><span class="line">    t = (r &gt;&gt; bit) &lt;&lt; bit;</span><br><span class="line">    LL l1 = l, r1 = t, l2 = l | t, r2 = t | (t - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = bit - <span class="number">1</span>; ~i &amp;&amp; r1 == t; --i) <span class="keyword">if</span> ((r &gt;&gt; i) &amp; <span class="number">1</span>) r1 |= (<span class="number">1ll</span> &lt;&lt; (i + <span class="number">1</span>)) - <span class="number">1</span>;</span><br><span class="line">    ans = r1 &lt; l2 ? r1 - l1 + <span class="number">1</span> + r2 - l2 + <span class="number">1</span> : r2 - l1 + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 找规律 </tag>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数列与极限</title>
      <link href="/2022/02/10/%E6%95%B0%E5%88%97%E4%B8%8E%E6%9E%81%E9%99%90/"/>
      <url>/2022/02/10/%E6%95%B0%E5%88%97%E4%B8%8E%E6%9E%81%E9%99%90/</url>
      
        <content type="html"><![CDATA[<p> 然而感觉并无卵用</p><span id="more"></span><h1 id="数列与极限"><a href="#数列与极限" class="headerlink" title="数列与极限"></a>数列与极限</h1><p>稍微学了一下数学，感觉数学过于严谨了</p><h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p>一些定义</p><h2 id="数列"><a href="#数列" class="headerlink" title="数列"></a>数列</h2><p>定义一种从自然数（有时候是正整数）到实数（有时候是其它域）的映射 $f : \mathbb{N} \to \mathbb{R}$ ，我们称它为一个<strong>数列</strong>，一般的，设 $a_n = f(n)$ ，则该数列可记为 $\{a_n\}_{n = 0}^{+ \infty}$ </p><p>定义一个数列 $f : \mathbb{N} \to \mathbb{R}$ 的<strong>子数列</strong>为一个数列 $g : L \to \mathbb{R}$ 满足 $L \subseteq  \mathbb{N} \wedge \forall n \in L , g(n) = f(n) \wedge \mid L \mid = + \infty$ </p><h2 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h2><p>对于一个数列 $\{a_n\}_{n = 1}^{+ \infty}$ ，若 $\exists a \in R, s.t. \forall \epsilon &gt; 0, \exists N &gt; 0 \wedge N \in \mathbb{N}^+, s.t. \forall n &gt; N , \mid a_n - a \mid &lt; \epsilon$ ，我们就称 $a$ 为数列的<strong>极限</strong>，记作 $\lim\limits _{n \to + \infty} a_n = a$ ，或者 $a_n \to a(n \to + \infty)$ ，有时候括号内的可以省略（上面的 $s.t$ 指 “使得”）</p><p>对于一个数列，如果它存在极限，我们就称这个数列<strong>收敛</strong>，否则就称其<strong>发散</strong></p><h2 id="柯西列"><a href="#柯西列" class="headerlink" title="柯西列"></a>柯西列</h2><p>对于数列 $\{a_n\} _{n = 1}^{+ \infty}$ ，若 $\forall \epsilon &gt; 0, \exists N &gt; 0, s.t. \forall n, m &gt; N, \mid a_n - a_m \mid &lt; \epsilon$ ，我们即称 $\{a_n\} _{n = 1}^{+ \infty}$ 为<strong>柯西列</strong></p><h2 id="界"><a href="#界" class="headerlink" title="界"></a>界</h2><p>对于一个<strong>数集</strong> $S$ ，若 $\exists M \in \mathbb{R}^+, s.t. \forall a_n \in S, \mid a_n \mid \le M$ ，我们就称 $S$ <strong>有界</strong>，其中 $M$  为<strong>上界</strong>， $-M$ 为<strong>下界</strong></p><p>对于一个有上界的数集 $S$ 我们成使得 $a_n \le M$ 的最小 $M$ 为 $S$ 的<strong>上确界</strong>，记作 $sup(S)$ ；类似的，对于一个有下界的数集 $S$ 我们成使得 $a_n \ge M$ 的最大 $M$ 为 $S$ 的<strong>下确界</strong>，记作 $inf(S)$ ，<strong>可以证明</strong>，一个非空有上下界数集必有上下确界（<strong>确界原理</strong>）</p><h2 id="无穷大量"><a href="#无穷大量" class="headerlink" title="无穷大量"></a>无穷大量</h2><p>对于一个数列 $\{a_n\} _{n = 1}^{+ \infty}$ ，若 $\forall M, \exists N &gt; 0, s.t. \forall n &gt; N, \mid a_n \mid &gt; M$ ，则称 $\{a_n\} _{n = 1}^{+ \infty}$ 为<strong>无穷大量</strong>（注意，这里可能向 $+ \infty$ 也可能向 $- \infty$ 也可能同时向二者）</p><h2 id="无穷小量"><a href="#无穷小量" class="headerlink" title="无穷小量"></a>无穷小量</h2><p>对于一个数列 $\{a_n\} _{n = 1}^{+ \infty}$ ，若 $\lim \limits _{n \to + \infty} a_n = 0$ ，则称 $\{a_n\} _{n = 1}^{+ \infty}$ 为<strong>无穷小量</strong></p><p>不难发现，若 $\{a_n\} _{n = 1}^{+ \infty}$ 为无穷小量，则 $\{\frac{1}{a_n}\} _{n = 1}^{+ \infty}$  为无穷大量，反之亦然</p><h2 id="级数"><a href="#级数" class="headerlink" title="级数"></a>级数</h2><p><strong>级数</strong>是指将数列的项依次用加号连接起来的函数，用 OIer 的话来说就是数列的前缀和，即对于数列 $\{s _n\} _{n = 1}^{+ \infty}$ ，有 $s _n = \sum _{i = 1}^n a _i$ </p><h2 id="数列的和"><a href="#数列的和" class="headerlink" title="数列的和"></a>数列的和</h2><p>对于数列 $\{a _n\} _{n = 1}^{+ \infty}$ ，它的和 $\sum _{n = 1}^{+ \infty} a _n$ 有意义，当且仅当它的级数数列  $\{s _n\} _{n = 1}^{+ \infty}$ 收敛</p><p>正确性显然</p><p>这里补充一个等比数列求和公式（设公比为 $q$ ）： $(1 - q)(1 + q + q^2 + … + q^n) = 1 - q^{n + 1}$ </p><h1 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h1><h2 id="收敛数列"><a href="#收敛数列" class="headerlink" title="收敛数列"></a>收敛数列</h2><h3 id="迫敛性（夹逼定理）"><a href="#迫敛性（夹逼定理）" class="headerlink" title="迫敛性（夹逼定理）"></a>迫敛性（夹逼定理）</h3><p>设 $a_n \le b_n \le c_n$ ，且 $\lim \limits _{n \to + \infty} a_n = \lim \limits _{n \to + \infty} c_n = t$ ，则 $\lim \limits _{n \to + \infty} b_n = t$ </p><p>证明：<br>$$<br>\begin{aligned}<br>有:<br>&amp; \mid a_n - t \mid &lt; \epsilon \\<br>即:<br>&amp; t - \epsilon &lt; a_n &lt; t + \epsilon \\<br>同理:<br>&amp; t - \epsilon &lt; c_n &lt; t + \epsilon \\<br>又因为:<br>&amp; a_n \le b_n \le c_n \\<br>得:<br>&amp; t - \epsilon &lt; b_n &lt; t + \epsilon \\<br>即:<br>&amp; \mid b_n - t \mid &lt; \epsilon \\<br>\end{aligned}<br>$$<br>QED</p><h3 id="有界性"><a href="#有界性" class="headerlink" title="有界性"></a>有界性</h3><p>收敛的数列一定有界</p><p>证明：</p><p>任取一个 $\epsilon &gt; 0$ ，一定存在 $N &gt; 0$ 使得 $\forall n &gt; N$ 有 $\mid a_n - a \mid &lt; \epsilon$ （收敛的定义），则 $\forall n &gt; N, \mid a_n \mid &lt; \mid a \mid + \epsilon$  ，又因为 $n \le N$ 的 $a_n$ 只有有限个，记它们的最大值为 $A = \max_{1 \le i \le N} (a_i)$ ，则对于任意 $n$ 有 $\mid a_n \mid \le \max(\mid A \mid, \mid a \mid + \epsilon)$ ，即 $\{a _n\} _{n = 1}^{+ \infty}$ 有界</p><p>QED</p><h3 id="单调有界定理"><a href="#单调有界定理" class="headerlink" title="单调有界定理"></a>单调有界定理</h3><p>若一个数列单调且有界，则这个数列收敛，且收敛到它的确界</p><p>注意只有“一个数列有界”是无法推得“这个数列收敛”的</p><h3 id="柯西收敛准则"><a href="#柯西收敛准则" class="headerlink" title="柯西收敛准则"></a>柯西收敛准则</h3><p>一个数列收敛的<strong>充要条件</strong>为这个数列是柯西列</p><p>必要性显然，充分性不好证明，其实，柯西收敛准则、单调有界定理和确界原理是互相等价的，它们也都等价于<strong>实数的完备性</strong></p><h2 id="极限-1"><a href="#极限-1" class="headerlink" title="极限"></a>极限</h2><h3 id="极限的唯一性"><a href="#极限的唯一性" class="headerlink" title="极限的唯一性"></a>极限的唯一性</h3><p>下面证明极限的唯一性，即：若 $a_n \to b, a_n \to c$ 则 $b = c$ </p><p>有：<br>$$<br>\begin{aligned}<br>\forall \epsilon &gt; 0, \exists N_b &gt; 0, s.t. \forall n &gt; N_b, \mid a_n - b \mid &lt; \epsilon \\<br>\forall \epsilon &gt; 0, \exists N_c &gt; 0, s.t. \forall n &gt; N_c, \mid a_n - c \mid &lt; \epsilon \\<br>\end{aligned}<br>$$<br> 记 $N = \max(N_b, N_c)$ 有：<br>$$<br>\forall n &gt; N, \mid a_n - c \mid + \mid a_n - b \mid &lt; 2 \epsilon<br>$$<br>由三角不等式 $\mid a \mid - \mid b \mid \le \mid a \pm b \mid \le \mid a \mid + \mid b \mid$ 得：<br>$$<br>\mid b - c \mid &lt; 2 \epsilon<br>$$<br>由于 $\epsilon$ 可以无限小，故有 $b = c$ </p><p>QED</p><h3 id="子数列的极限"><a href="#子数列的极限" class="headerlink" title="子数列的极限"></a>子数列的极限</h3><p>对于一个数列 $\{a _n\} _{n = 1}^{+ \infty}$ 的子数列  $\{a _{n _k}\} <em>{k = 1}^{+ \infty}$ ，若 $a_n \to a$ ，则 $a</em>{n_k} \to a$ </p><p>证明：</p><p>对于所有 $k$ ，有 $n_k \ge k$ ，又因为 $\forall \epsilon &gt; 0, \exists N &gt; 0, s.t. \forall n &gt; N, \mid a_n - b \mid &lt; \epsilon$</p><p>故 $\forall \epsilon &gt; 0$ ，取 $K = N$ ，有 $\forall k &gt; K, n_k \ge k &gt; K = N$ ，故 $\mid a_{n_k} - b \mid &lt; \epsilon$ ，即 $a_{n_k} \to a$ </p><p>QED</p><h3 id="极限的线性可加性"><a href="#极限的线性可加性" class="headerlink" title="极限的线性可加性"></a>极限的线性可加性</h3><p>设 $a_n \to a, b_m \to b$ ，则 $\lim \limits _{n \to + \infty} (\alpha a_n + \beta b_n) = \alpha a + \beta b$ </p><p>证明：<br>$$<br>\begin{aligned}<br>&amp; \mid \alpha a _n + \beta b _n  - (\alpha a + \beta b) \mid \\<br>\le &amp; \mid \alpha \mid \mid a _n - a \mid + \mid \beta \mid \mid b _n - b \mid \\<br>&amp; = \mid \alpha \mid \epsilon ‘ + \mid \beta \mid \epsilon ‘<br>\end{aligned}<br>$$</p><p>现在，对于任意的 $\epsilon &gt; 0$ ，一定可得 $\epsilon ‘ = \frac{\epsilon}{\mid \alpha \mid + \mid \beta \mid}$ ，它对应的 $N$ ，使得 $\forall n &gt; N$ ， $\mid \alpha a _n + \beta b _n  - (\alpha a + \beta b) \mid &lt; \epsilon$ </p><p>QED</p><h3 id="极限的可乘性"><a href="#极限的可乘性" class="headerlink" title="极限的可乘性"></a>极限的可乘性</h3><p>设 $a_n \to a, b_m \to b$ ，则 $\lim \limits _{n \to + \infty} (a_n b_n) = a b$ </p><p>证明：</p><p>因为 $a _n \to a, b _n \to b$ ，则 $\{b _n\} _{n = 1}^{+ \infty} $ 一定有界设 $\mid b _n \mid \le B$<br>$$<br>\begin{aligned}<br>&amp; \mid a _n b _n - a b \mid \\<br>= &amp; \mid a _n b _n - a b _n + a b _n - a b \mid \\<br>\le &amp; \mid a _n b _n - a b _n \mid + \mid a b _n - a b \mid \\<br>= &amp; \mid b _n \mid \mid a _n - a \mid + \mid a \mid \mid b _n - b \mid \\<br>\le &amp; B \epsilon + \mid a \mid \epsilon<br>\end{aligned}<br>$$<br>QED</p><h3 id="极限的可除性"><a href="#极限的可除性" class="headerlink" title="极限的可除性"></a>极限的可除性</h3><p>已知 $a_n \to a$ ，  $a_n \ne 0, a \ne 0$ ，则有 $\frac{1}{a _n} \to \frac{1}{a}$ </p><p>证明：</p><p> $\exists N _1 &gt; 0, s.t. \forall n &gt; N _1, \mid a _n - a \mid &lt; \frac{\mid a \mid}{2}$  </p><p>又因为 $\mid a \mid - \mid a _n \mid \le \mid a _n - a \mid$ </p><p> 故： $\mid a \mid - \mid a _n \mid &lt; \frac{\mid a \mid}{2}$ ，即 $\mid a _n \mid &gt;  \frac{\mid a \mid}{2}$ 又即 $\frac{1}{\mid a _n \mid} &lt; \frac{2}{\mid a \mid}$  </p><p> $\forall \epsilon  &gt; 0$ ， $\exists N _2 &gt; 0$ ，使 $\forall n &gt; N _2$ ，   $\mid a _n - a \mid &lt;  \frac{(\mid a \mid)^2 * \epsilon}{2}$ </p><p>取 $N = \max(N _1, N _2)$ ， $\forall n &gt; N$ ，有：<br>$$<br>\begin{aligned}<br>&amp; \mid \frac{1}{a _n} - \frac{1}{a} \mid \\<br>= &amp; \mid \frac{a - a _n}{a _n a} \mid \\<br>\le &amp; \frac{\mid a - a _n \mid}{\mid a _n \mid \mid a \mid} \\<br>= &amp; \frac{\mid a _n - a \mid}{\mid a _n \mid \mid a \mid} \\<br>\le &amp; \frac{2 (\mid a \mid)^2 * \epsilon}{2 \mid a \mid * \mid a \mid} \\<br>= &amp; \epsilon<br>\end{aligned}<br>$$<br>QED</p><h3 id="保号性"><a href="#保号性" class="headerlink" title="保号性"></a>保号性</h3><p>若 $a _n \to a, \forall a’ &lt; a, \exists N &gt; 0, s.t. \forall n &gt; N$ 有 $a ‘ &lt; a _n$  </p><p>证明：</p><p>$a - \epsilon &lt; a _n$ ，对于 $a’$ ，取一个使得 $a - \epsilon &gt; a’$ 即可</p><p>QED</p><h1 id="典例"><a href="#典例" class="headerlink" title="典例"></a>典例</h1><h2 id="T1：求证-lim-limits-n-to-infty-1-frac-1-n-n-存在"><a href="#T1：求证-lim-limits-n-to-infty-1-frac-1-n-n-存在" class="headerlink" title="T1：求证 $\lim \limits _{n \to + \infty} (1 + \frac{1}{n})^n$ 存在"></a>T1：求证 $\lim \limits _{n \to + \infty} (1 + \frac{1}{n})^n$ 存在</h2><p>首先证明 $\{(1 + \frac{1}{n})^n \} _{n = 1}^{+ \infty}$ 有上界：<br>$$<br>\begin{aligned}<br>(1 + \frac{1}{n})^n<br>&amp; = \sum _{k = 0}^n \binom{n}{k} (\frac{1}{n})^k \\<br>&amp; = 1 + n * \frac{1}{n} + \frac{n (n - 1)}{2!} * \frac{1}{n^2} + … + \frac{n (n - 1) (n - 2) … 1}{n!} * \frac{1}{n^n} \\<br>&amp; = 1 + 1 + \frac{1}{2!}(\frac{n - 1}{n}) + … + \frac{1}{n!}(\frac{(n - 1)(n - 2) … 1}{n^{n - 1}}) \\<br>&amp; = 1 + 1 + \frac{1}{2!}(\frac{n - 1}{n}) + … + \frac{1}{n!}(\frac{n - 1}{n} * \frac{n - 2}{n} * … * \frac{1}{n}) \\<br>\end{aligned}<br>$$<br>由于 $\frac{n - 1}{n}, \frac{n - 2}{n} … \frac{1}{n} &lt; 1$ ，我们有：<br>$$<br>\begin{aligned}<br>(1 + \frac{1}{n})^n<br>&amp; = 1 + 1 + \frac{1}{2!}(\frac{n - 1}{n}) + … + \frac{1}{n!}(\frac{(n - 1)(n - 2) … 1}{n^{n - 1}}) \\<br>&amp; &lt; 2 + \frac{1}{2!} + \frac{1}{3!} + … + \frac{1}{n!} \\<br>\end{aligned}<br>$$<br>又因为 $\frac{1}{2!} \le \frac{1}{2}, \frac{1}{3!} \le \frac{1}{2^2} … \frac{1}{n!} \le \frac{1}{2^{n - 1}}$ ，故：<br>$$<br>\begin{aligned}<br>(1 + \frac{1}{n})^n<br>&amp; &lt; 2 + \frac{1}{2!} + \frac{1}{3!} + … + \frac{1}{n!} \\<br>&amp; \le 2 + \frac{1}{2} + … + \frac{1}{2^{n - 1}} \\<br>&amp; = 3 - \frac{1}{2^{n - 1}} \\<br>&amp; &lt; 3<br>\end{aligned}<br>$$<br>综上， $\{(1 + \frac{1}{n})^n\} _{n = 1}^{+ \infty}$ 的上界存在</p><p>然后我们对 $n + 1$ 同上变换，有：<br>$$<br>\begin{aligned}<br>(1 + \frac{1}{n + 1})^{n + 1}<br>&amp; = 1 + 1 + \frac{1}{2!}(\frac{n}{n + 1}) + … + \frac{1}{n!}(\frac{n}{n + 1} * \frac{n - 1}{n + 1} * … * \frac{2}{n + 1}) +  \frac{1}{(n + 1)!}(\frac{n}{n + 1} * \frac{n - 1}{n + 1} * … * \frac{2}{n + 1} * \frac{1}{n + 1})\\<br>\end{aligned}<br>$$<br>不难发现， $n + 1$ 比 $n$ 多一项 $\frac{1}{(n + 1)!}(\frac{n}{n + 1} * \frac{n - 1}{n + 1} * … * \frac{2}{n + 1} * \frac{1}{n + 1}) &gt; 0$ 而其它项逐项对比，有 $\frac{n}{n + 1} \ge \frac{n - 1}{n}, \frac{n - 1}{n + 1} \ge \frac{n - 2}{n} … \frac{2}{n + 1} \ge \frac{1}{n}$ ，故有：<br>$$<br>(1 + \frac{1}{n + 1})^{n + 1} &gt; (1 + \frac{1}{n})^{n}<br>$$<br>因此， $\{(1 + \frac{1}{n})^n\} _{n = 1}^{+ \infty}$ 单调递增且存在下界 $ = (1 + \frac{1}{1})^1 = 2$ </p><p>由单调有界定理， $\{(1 + \frac{1}{n})^n\} _{n = 1}^{+ \infty}$ 收敛，则 $\lim \limits _{n \to + \infty} (1 + \frac{1}{n})^n$ </p><p>QED</p><p>其实 $\lim \limits _{n \to + \infty} (1 + \frac{1}{n})^n = e$ ，这就是自然常数的定义</p><h2 id="T2：求证-lim-limits-x-to-0-frac-sin-x-x-1"><a href="#T2：求证-lim-limits-x-to-0-frac-sin-x-x-1" class="headerlink" title="T2：求证 $\lim \limits _{x \to 0} \frac{\sin x}{x} = 1$"></a>T2：求证 $\lim \limits _{x \to 0} \frac{\sin x}{x} = 1$</h2><p> 首先，有 $\sin x &lt; x &lt; \tan x$ （由三角函数线可证），故 $1 &lt; \frac{x}{\sin x} &lt; \frac{1}{\cos x}$ ，即 $1 &gt; \frac{\sin x}{x} &gt; \cos x$ </p><p>又因为 $\lim \limits _{x \to 0} \cos x = 1$ ，由迫敛性可知 $\lim \limits _{x \to 0} \frac{\sin x}{x} = 1$ </p><p>QED</p><h2 id="T3：求-lim-limits-n-to-infty-sqrt-n-n"><a href="#T3：求-lim-limits-n-to-infty-sqrt-n-n" class="headerlink" title="T3：求 $\lim \limits _{n \to + \infty} \sqrt[n]{n}$"></a>T3：求 $\lim \limits _{n \to + \infty} \sqrt[n]{n}$</h2><p>解：</p><p>因为 $\sqrt[n]{n} \ge 1$ 设 $\sqrt[n]{n} = 1 + r_n, r _n \ge 0$ ，有：<br>$$<br>\begin{aligned}<br>n<br>&amp; = (1 + r _n)^n \\<br>&amp; = \sum _{k = 0}^n \binom{n}{k} r _n^k \\<br>&amp; \ge \binom{n}{2} r _n^2 \\<br>&amp; = \frac{n (n - 1)}{2} r _n^2<br>\end{aligned}<br>$$<br>则有 $0 \le r _n \le \sqrt{\frac{2}{n - 1}}$ </p><p>又因为 $\sqrt{\frac{2}{n - 1}} \to 0$ ，由迫敛性可得 $r_n \to 0$ </p><p>由极限的线性可加性， $\lim \limits _{n \to + \infty} \sqrt[n]{n} = 1$  </p><h2 id="T6：求证：当-a-m-gt-0-时-lim-limits-n-to-infty-a-m-n-m-a-m-1-n-m-1-…-a-1-n-a-0-infty"><a href="#T6：求证：当-a-m-gt-0-时-lim-limits-n-to-infty-a-m-n-m-a-m-1-n-m-1-…-a-1-n-a-0-infty" class="headerlink" title="T6：求证：当 $a _m &gt; 0$ 时 $\lim \limits _{n \to + \infty} a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0 = + \infty$"></a>T6：求证：当 $a _m &gt; 0$ 时 $\lim \limits _{n \to + \infty} a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0 = + \infty$</h2><p>记 $A = \max(\mid a_i \mid)$<br>$$<br>\begin{aligned}<br>&amp; a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0 \\<br>\ge &amp; a _m n^m - A n^{m - 1} * (m - 1) \\<br>= &amp; n^{m - 1} * (a _m * n - A(m - 1))<br>\end{aligned}<br>$$<br>由于 $n^{m - 1} \to + \infty$ ， $a _m n \to + \infty$ ，而 $A(m - 1)$ 为常数，故 $n^{m - 1} * (a _m * n - A(m - 1)) \to + \infty$ </p><p>又因为 $a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0 \le A n^m m$ ，且 $A n^m m \to + \infty$ ，由迫敛性可知 $\lim \limits _{n \to + \infty} a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0 = + \infty$ </p><p>QED</p><h2 id="T5：求-lim-limits-n-to-infty-frac-b-l-n-l-b-l-1-n-l-1-…-b-1-n-b-0-a-m-n-m-a-m-1-n-m-1-…-a-1-n-a-0"><a href="#T5：求-lim-limits-n-to-infty-frac-b-l-n-l-b-l-1-n-l-1-…-b-1-n-b-0-a-m-n-m-a-m-1-n-m-1-…-a-1-n-a-0" class="headerlink" title="T5：求 $\lim \limits _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0}$"></a>T5：求 $\lim \limits _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0}$</h2><p>解 ：</p><p>分类讨论：</p><h3 id="1）-l-lt-m-时"><a href="#1）-l-lt-m-时" class="headerlink" title="1） $l &lt; m$ 时"></a>1） $l &lt; m$ 时</h3><p>$$<br>\begin{aligned}<br>原式<br>&amp; = \frac{b _l + b _{l - 1} n^{- 1} + … + b _1 n^{1 - l} + b _0 n^{-l}}{a _m n^{m - l} + a _{m - 1} n^{m - l - 1} + … + a_k n^0 + … + a _1 n^{1 - l} + a _0 n^{-l}}<br>\end{aligned}<br>$$</p><p>又因为当 $k &lt; 0$ 时 $n^k \to 0$ ，由极限的线性可加性和可乘性，有：<br>$$<br>\begin{aligned}<br>&amp;\lim _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0} \\<br>= &amp; \lim _{n \to + \infty} \frac{b _l + 0 + … + 0}{a _m n^{m - l} + a _{m - 1} n^{m - l - 1} + … + a _{k + 1} n + 1 + 0 + … + 0} \\<br>= &amp; \lim _{n \to + \infty} \frac{b _l}{a _m n^{m - l} + a _{m - 1} n^{m - l - 1} + … + a _{k + 1} n + 1} \\<br>= &amp; 0<br>\end{aligned}<br>$$<br>故 $l &lt; m$ 时， $\lim \limits _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0} = 0$ </p><h3 id="2）-l-gt-m-时"><a href="#2）-l-gt-m-时" class="headerlink" title="2） $l &gt; m$ 时"></a>2） $l &gt; m$ 时</h3><p>由 $1)$ 可知，原式的倒数极限为 $0$ 即为无穷小量，那么原式为无穷大量（其正负由 $b_l$ 决定）</p><h3 id="3）-l-m-时"><a href="#3）-l-m-时" class="headerlink" title="3） $l = m$ 时"></a>3） $l = m$ 时</h3><p>$$<br>\begin{aligned}<br>原式<br>&amp; = \frac{b _l + b _{l - 1} n^{- 1} + … + b _1 n^{1 - l} + b _0 n^{-l}}{a _m + a _{m - 1} n^{-1} + … + a _1 n^{1 - l} + a _0 n^{-l}}<br>\end{aligned}<br>$$</p><p>类似于 $1)$ ，有：<br>$$<br>\begin{aligned}<br>&amp;\lim _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0} \\<br>= &amp; \lim _{n \to + \infty} \frac{b _l + 0 + … + 0}{a _m + 0 + … + 0} \\<br>= &amp; \lim _{n \to + \infty} \frac{b _l}{a _m} \\<br>= &amp; \frac{b _l}{a _m}<br>\end{aligned}<br>$$<br>故 $l = m$ 时， $\lim \limits _{n \to + \infty} \frac{b _l n^l + b _{l - 1} n^{l - 1} + … + b _1 n + b _0}{a _m n^m + a _{m - 1} n^{m - 1} + … + a _1 n + a _0} = \frac{b _l}{a _m} $ </p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 其它 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优化dp2</title>
      <link href="/2022/02/09/%E4%BC%98%E5%8C%96dp2/"/>
      <url>/2022/02/09/%E4%BC%98%E5%8C%96dp2/</url>
      
        <content type="html"><![CDATA[<p> 然而我 dp 废的一比（三羊开泰）</p><span id="more"></span><h1 id="优化dp2"><a href="#优化dp2" class="headerlink" title="优化dp2"></a>优化dp2</h1><p>上回链接：<a href="https://dyd-true.github.io/2022/02/08/%E4%BC%98%E5%8C%96dp/#more">优化dp</a></p><p>这次目标主要介绍斜率优化，它是利用<strong>单调性</strong>对<strong>转移</strong>进行优化</p><h1 id="斜率优化"><a href="#斜率优化" class="headerlink" title="斜率优化"></a>斜率优化</h1><p>歪果仁喜欢叫凸包/凸壳优化（ convex hull trick ）</p><p>上次我我们说了，对于 1D/1D 模型：<br>$$<br>d[i] = \min_{l(i) \le j \le r(i)} (d[j] + val(i, j))<br>$$<br>如果 $val(i, j)$ 的的每一项仅与 $i, j$ 中一个有关，就可以考虑单调队列，那么，如果 <strong>$val(i, j)$ 包括了 $i, j$ 的乘积（即和它们同时相关的量）</strong>，我们就可以考虑斜率优化</p><p>斜率优化有两种形式，就我个人而言，比较喜欢先把 dp 方程写出来，然后考虑决策 $j$ 优于决策 $k$ 的条件，把条件化成<br>$$<br>\frac{y(j) - y(k)}{x(j) - x(k)} &lt; k<br>$$<br>这里 $&lt;$ 可以换，把外层循环都当常量， $k$ 是常数， $x(t), y(t)$ 是仅和 $t$ 有关的函数，这个就是斜率优化的第一种形式，如果是巨佬，一眼就可以看出（或者带几个点算出）它是上凸/下凸然后打代码了</p><p>但我比较弱，这个只能用来帮助打代码，只好继续化，在得到了形式一后，我们反回去看 dp 方程，把  $\min (\max)$ 去掉，化为斜率优化的第二种形式<br>$$<br>y(j) = k \times x(j) + d[i]’<br>$$<br>这里 $d[i]’$ 是只关于 $d[i]$ 的东西（可以通过它直接得到 $d[i]$ ）， $y(t), x(t), k$ 就和形式一一样（所以我化出形式一的目的其实就是为了指导如何化形式二，因为蒟蒻一般无法一眼看穿如何化形式二），然后我就用形式二来斜率优化</p><p>具体地，把问题化为对一条斜率为 $k$ 的直线尝试去过点 $(x(j), y(j))$ ，最大/小化直线的截距，我们发现只要维护点集的凸包即可，一般用单调队列实现</p><p>实现代码时最好看着这两个形式打（利用它们帮助你明确细节、条件），然后期待自己 rp 够好吧（<del>如果您是巨佬当我没说</del>）</p><p>值得一提的是，对于形式一，巨佬可以直接取几个点就看出上凸/下凸/无法优化，但对于用形式二的蒟蒻来说，只好记结论了：</p><p><strong>可以简单斜率优化的条件是形式二中的 $k$ 和 $x(t)$ 单调，单调递增/递减（或者 $\min$ / $\max$ ）对应下凸/上凸</strong>，这样有一个 $O(n)$ 就可以优化为 $O(1)$ ；而当 $k$ 和 $x(t)$ 有一者不单调时，我们优先考虑改方程（倒着 dp ，重设状态等）来<strong>保证 $x(t)$ 单调</strong>（要保证新决策横坐标大于/小于之前所有决策），并用二分，将 $O(n)$ 优化为 $O(\log n)$ ；最麻烦的是 $k$ 和 $x(t)$ 都不单调，这就只有动态维护，时间和题目要求以及选取的数据结构有关，具体可以看下面的例题</p><h2 id="例题六"><a href="#例题六" class="headerlink" title="例题六"></a>例题六</h2><p><a href="https://codeforces.com/problemset/problem/311/B">Cats Transport</a></p><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>有 $m \le 10^5$ 只猫分布在 $n \le 10^5$ 座山上，第 $i$ 只猫在山 $h_i$ 且会在 $t_i \le 10^9$ 时间下到山脚，然后一直等着，两个山之间的距离已知且 $\le 10^4$ ，现在在第一座山脚有 $p \le 100$ 个铲屎官，速度为 $1$ ，每个铲屎官在你安排的时间出发（每个人出发时间可以不同，出发时间可以为负数），从山 $1$ 走到山 $n$ ，中通遇到在山脚的猫就带走它，要求你最小化猫的等待时间</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>首先，什么距离、速度、时间很麻烦，我们先对每只猫计算一个 $a_i = t_i - \sum_{j = 1}^{h_i} d_j$ ，表示“如果一个铲屎官想接走第 $i$ 只猫，它必须在 $a_i$ 时刻之后出发”，不难发现如果出发时间为 $x$ ，猫就会等待 $x - a_i$ 的时间，然后就不管题目中的 $d, t$ 和 $h$  了</p><p>我们先对 $a_i$ 从小到大排序，排完后铲屎官接走的猫一定是连续的，贪心可知，一定存在一种最优解满足每位铲屎官都对应一只刚好接走的猫，即对应一个 $a_i$ （简证 <del>口胡</del> ：若有为铲屎官没有刚好接走的猫，就让它早点出发，使他接的最后一只猫使被刚好接走，这样答案一定不会变差）</p><p>于是考虑第 $x$ 个铲屎官刚好接走猫 $i$ （即在 $a_i$ 出发），上一个人搞好接走猫 $j$ ，那么这个人可以接走猫 $j + 1 \sim i$ ，代价为 $\sum_{k = j + 1}^i a_i - a_k$ ，不妨对 $a_i$ 求个前缀和，然后 $\sum_{k = j + 1}^i a_i - a_k = (i - j)a_i - (sum[i] - sum[j])$ ，设 <code>f[i, j]</code> （ <del>$d$ 又被用了呜呜呜</del>）表示“前 $i$ 个铲屎官带走了前 $j$ 只猫，最小的等待时间”，易得：<br>$$<br>f[i, j] = \min_{0 \le k &lt; j} (f[i - 1, k] + (j - k) * a_j - (sum[j] - sum[k]))<br>$$<br>直接转移是 $O(pm^2)$ 的，外层 $i$ 当常量就是一个 1D/1D ，有 $val(j, k) = (j - k) * a_j - sum[j] + sum[k]$ ，发现存在乘积量 $(j - k) * a_j$ ，考虑斜率优化</p><p>巨佬们可以一眼看穿的就跳过吧，这里是蒻蒟痛苦的推式子：</p><p>考虑决策 $q$ 优于决策 $k$ 的条件（下面省略第一维）：<br>$$<br>\begin{aligned}<br>&amp; f[k] + (j - k) * a_j - sum[j] + sum[k] &gt; f[q] + (j - q) * a_j - sum[j] + sum[q] \\<br>\Rightarrow &amp; f[k] + -k * a_j + sum[k] &gt; f[q] + -q * a_j + sum[q] \\<br>\Rightarrow &amp; a_j &gt; \frac{(f[q] + sum[q]) - (f[k] + sum[k])}{q - k}<br>\end{aligned}<br>$$<br>于是形式一就有了，然后再化方程就简单了：<br>$$<br>\begin{aligned}<br>&amp; f[i, j] = \min_{0 \le k &lt; j} (f[i - 1, k] + (j - k) * a_j - (sum[j] - sum[k])) \\<br>\Rightarrow &amp; f[i, j] = f[i - 1, k] + j * a_j - k * a_j - sum[j] + sum[k] \\<br>\Rightarrow &amp; (f[i - 1, k] + sum[k]) = (a_j) \times (k) + (f[i, j] - a_j * j + sum[j]) \\<br>\end{aligned}<br>$$<br>大家可以对比两个形式和上面给的两个形式的一般式，不难发现它们间的联系</p><p>无论如何，式子是推出来了，现在来看单调性，首先 $a_j$ 是排好序的，显然单调递增，而那个 $k$ 是我们顺序枚举的，单调性也显然，剩下的就是打代码了……时间复杂度 $O(pm)$ </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><ol><li>仔细看看代码是不是有很多地方和形式一/二有点像？这就是我说的“帮助代码实现”</li><li>为了提高精度建议开 <code>double</code> ，也可以化除为乘</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, P = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, p, q[N];</span><br><span class="line">LL f[P][N], sum[N], a[N], d[N];</span><br><span class="line"><span class="function">LL <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> f[i][x] + sum[x]; &#125;</span><br><span class="line"><span class="function">LL <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x; &#125;</span><br><span class="line"><span class="function">LL <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> k)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">Y</span>(i, k) - <span class="built_in">X</span>(a[j]) * k; &#125; <span class="comment">//计算截距i,j,k含义类似形式二</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123; <span class="keyword">return</span> (<span class="built_in">Y</span>(i, b) - <span class="built_in">Y</span>(i, c)) * (<span class="built_in">X</span>(a) - <span class="built_in">X</span>(b)) &gt; (<span class="built_in">Y</span>(i, a) - <span class="built_in">Y</span>(i, b)) * (<span class="built_in">X</span>(b) - <span class="built_in">X</span>(c)); &#125; <span class="comment">//检查a优于b,类似形式一,化乘为除</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;p);</span><br><span class="line">    <span class="keyword">if</span> (p &gt;= m) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;d[i]), d[i] += d[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, h, t; i &lt;= m; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;h, &amp;t), a[i] = t - d[h];</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) f[<span class="number">1</span>][i] = a[i] * i - sum[i]; <span class="comment">//先把1算了</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j, l, r; i &lt;= p; ++i)</span><br><span class="line">        <span class="keyword">for</span> (q[l = r = <span class="number">1</span>] = <span class="number">0</span>, j = <span class="number">1</span>; j &lt;= m; ++j) <span class="comment">//0也是一个决策点</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (; l &lt; r &amp;&amp; <span class="built_in">calc</span>(i - <span class="number">1</span>, j, q[l + <span class="number">1</span>]) &lt; <span class="built_in">calc</span>(i - <span class="number">1</span>, j, q[l]); ++l); <span class="comment">//不优排除，注意至少要保证队列中有一个数,故l&lt;r</span></span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][q[l]] + a[j] * (j - q[l]) - (sum[j] - sum[q[l]]);</span><br><span class="line">            <span class="keyword">for</span> (; l &lt; r &amp;&amp; <span class="built_in">check</span>(i - <span class="number">1</span>, j, q[r], q[r - <span class="number">1</span>]); --r); <span class="comment">//保留斜率更优的</span></span><br><span class="line">            q[++r] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[p][m]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题七"><a href="#例题七" class="headerlink" title="例题七"></a>例题七</h2><p><a href="https://www.acwing.com/problem/content/description/304/">任务安排3</a></p><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>给定 $n \le 3 \times 10^5$ 个任务，要求从时刻 $0$ 开始顺序执行，第 $i$ 个任务耗时 $-512 \le t_i \le 512$ ，有一个机器执行任务，将任务分成若干段，每一段完成耗时就是该段 $t_i$ 之和，而机器开始每段之前要消耗 $S \le 512$ 的启动时间，<strong>一个任务的完成时刻就是所在段的完成时刻</strong>，最后的费用就是每个任务的完成时刻乘一个系数 $c_i \le 512$ 然后求和，现在求最小费用</p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>首先求出 $t_i$ ， $c_i$ 的前缀和记为 $sum_t[], sum_c[]$ ，定义 <code>d[i, j]</code> 表示“把前 $i$ 个任务分成 $j$ 段最小费用”，方程显然：<br>$$<br>d[i, j] = \min_{0 \le k &lt; i} (d[k, j - 1] + (S * j + sum_t[i]) * (sum_c[i] - sum_c[k]))<br>$$<br>时间为 $O(n^3)$ ，完全无法接受，考虑到就算把 1D/1D 优化为 $O(1)$ 时间也无法接受，说明要剪去一维状态</p><p>我们发现题目并没有要求分成多少段，我们在状态中记录段数完全是为了计算代价，而每一次启动的代价都会累计到此后所有的任务中，用<strong>费用提前计算</strong>的思想，直接在启动时就把后面的代价累计了，这样就剪去了一维，定义 <code>d[i]</code> 表示“把前 $i$ 个任务分成若干段最小费用”，方程：<br>$$<br>d[i] = \min_{0 \le j &lt; i} (d[j] + sum_t[i] * (sum_c[i] - sum_c[j]) + S * (sum_c[n] - sum_c[j]))<br>$$<br>时间为 $O(n^2)$ ，考虑 1D/1D 优化， $val(i, j) = sum_t[i] * (sum_c[i] - sum_c[j]) + S * (sum_c[n] - sum_c[j])$ 包含 $i, j$ 乘积，考虑斜率优化，设决策 $k$ 优于 $j$ 有：<br>$$<br>\begin{aligned}<br>&amp; d[j] + sum_t[i] * (sum_c[i] - sum_c[j]) + S * (sum_c[n] - sum_c[j]) &gt; d[k] + sum_t[i] * (sum_c[i] - sum_c[k]) + S * (sum_c[n] - sum_c[k]) \\<br>&amp; d[j] - (S + sum_t[i]) *  sum_c[j] &gt; d[k] - (S + sum_t[i]) * sum_c[k] \\<br>&amp; (S + sum_t[i]) &gt; \frac{d[k] - d[j]}{sum_c[k] - sum_c[j]}<br>\end{aligned}<br>$$<br>于是得到形式二为：<br>$$<br>(d[j]) = (S + sum_t[i]) \times (sum_c[j]) + (d[i] - sum_t[i] * sum_c[i] - S * sum_c[n])<br>$$<br>现在来看单调性， $sum_c[j]$ 的单调性显然，但是由于 $t_i$ 可以为负数， $S + sum_t[i]$ <strong>不具有单调性</strong>，完蛋，这就是 $k$ 不单调但 $x(t)$ 单调的情况啊</p><p>但幸好 $x(t)$ 还是单调的，我们来思考 $k$ 不单调的影响：如果 $k$ 是单调的，由形式一可知我们只需保留凸壳上两点连线斜率大于 $k$ 的部分，而最优决策就一定是队头，因为队头的下一个点被删去，说明它的斜率由 $&lt;k$ 变为 $&gt;k$ ，则队头就是变化点，也就是最优决策点；但是 $k$ 不单调了，所以我们不能只保留凸壳上两点连线斜率大于 $k$ 的部分，而要维护整个凸壳，并最优决策点也不在是队头了，需要在队列中二分一个点，使得它和左侧点斜率 $&lt;k$ ，而和右侧点斜率 $&gt;k$ </p><p>时间复杂度 $O(n \log n)$ </p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p>注意 <code>long long</code> 相乘要开 <code>int128</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I128 __int128</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line">LL sumc[N], sumt[N], d[N];</span><br><span class="line"><span class="keyword">int</span> q[N], l, r;</span><br><span class="line"><span class="function">LL <span class="title">Y</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> d[x]; &#125;</span><br><span class="line"><span class="function">LL <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> sumc[x]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, LL k)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">Y</span>(a) - <span class="built_in">Y</span>(b) &gt;= <span class="built_in">I128</span>(k) * (<span class="built_in">X</span>(a) - <span class="built_in">X</span>(b)); &#125; <span class="comment">//判断a,b的斜率大于等于k</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check2</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">I128</span>(<span class="built_in">Y</span>(b) - <span class="built_in">Y</span>(a)) * (<span class="built_in">X</span>(c) - <span class="built_in">X</span>(b)) &gt;= <span class="built_in">I128</span>(<span class="built_in">Y</span>(c) - <span class="built_in">Y</span>(b)) * (<span class="built_in">X</span>(b) - <span class="built_in">X</span>(a)); &#125; <span class="comment">//比较斜率,维护凸包</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> i, LL k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> q[l];</span><br><span class="line">    <span class="keyword">int</span> ll = l, rr = r, mid, res;</span><br><span class="line">    <span class="keyword">while</span> (ll &lt;= rr)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = ll + rr &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check1</span>(q[mid + <span class="number">1</span>], q[mid], k)) rr = (res = mid) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> ll = mid + <span class="number">1</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> q[res];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, s;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t, c; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;t, &amp;c);</span><br><span class="line">        sumc[i] = sumc[i - <span class="number">1</span>] + c, sumt[i] = sumt[i - <span class="number">1</span>] + t;</span><br><span class="line">    &#125;</span><br><span class="line">    q[l = r = <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, p; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        d[i] = d[p = <span class="built_in">find</span>(i, s + sumt[i])] - (s + sumt[i]) * sumc[p] + sumt[i] * sumc[i] + s * sumc[n];</span><br><span class="line">        <span class="keyword">for</span> (; l &lt; r &amp;&amp; <span class="built_in">check2</span>(q[r - <span class="number">1</span>], q[r], i); --r);</span><br><span class="line">        q[++r] = i; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, d[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题八"><a href="#例题八" class="headerlink" title="例题八"></a>例题八</h2><p><a href="https://www.luogu.com.cn/problem/P4027">货币兑换</a></p><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>有两种金卷 $A, B$ ，已知接下来 $n \le 10^5$ 天每天两种金卷的价格 $A_i, B_i \le 10$ ，用户的账户上有三个<strong>实数</strong>： $a, b, c$ ，分别表示金卷 $A, B$ 的数量和 RMB （软妹币）的数量，用户可以进行两种操作（同一天可以多次操作）：</p><ol><li>提供一个实数 $op \in [0, 100]$ ，然后将 $op\%$ 的 $A, B$ 卷按当天的价格换成 RMB </li><li>提供一个实数 $op$ 表示用 $op$ 元 RMB 买入 $A, B$ 卷，第 $i$ 天买入的 $A, B$ 卷比为 $R_i \in (0, 100]$ </li></ol><p>现在，假设你第一天有 $S \le 10^9$ 元且没有任何金卷，问第 $n$ 天时你账户中最多有多少 RMB ，保证最后答案 $\le 10^9$ 保留 $3$ 位小数 </p><h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p>首先明确一个点：必然存在一种最优的买卖方案，使得每次买进操作使用完所有的人民币，每次卖出操作卖出所有的金券</p><p>证明很简单，如果最优解在某天买入了一部分卷，一定是因为买它最优，而继续买和买入一部分的“优越性”相同（因为参数都没变），所有继续买一定优于其它决策；卖出同理</p><p>然后我们来考虑 dp ，由于实数不好作为状态，定义 <code>d[i]</code> 为“第 $i$ 天最多得到的钱数”，把实数放到转移里，转移分两种：</p><ol><li><p>第 $i$ 天不卖出金卷，则 <code>d[i] = max(d[i], d[i - 1])</code> </p></li><li><p>第 $i$ 天卖出金卷，设上一次买入（一定是花完了所有 RMB 的）是在第 $j$ 天，有：<br>$$<br>d[i] = \max _{1 \le j &lt; i} (\frac{d[j]}{A _j * R _j + B _j} * R _j * A _i + \frac{d[j]}{A _j * R _j + B _j} * B _i)<br>$$</p></li></ol><p>第一种转移很好搞，问题在第二种，发现包含 $i, j$ 的乘积，于是考虑斜率优化</p><p>决策 $k$ 优于决策 $j$ 当且仅当：<br>$$<br>\begin{aligned}<br>&amp; \frac{d[j]}{A _j * R _j + B _j} * R _j * A _i + \frac{d[j]}{A _j * R _j + B _j} * B _i &lt; \frac{d[k]}{A _k * R _k + B _k} * R _k * A _i + \frac{d[k]}{A _k * R _k + B _k} * B _i \\<br>&amp; \frac{d[j] * R _j}{A _j * R _j + B _j} * \frac{A _i}{B _i} + \frac{d[j]}{A _j * R _j + B _j} &lt; \frac{d[k] * R _k}{A _k * R _k + B _k} * \frac{A _i}{B _i} + \frac{d[k]}{A _k * R _k + B _k} \\<br>&amp; \frac{d[j]}{A _j * R _j + B _j} - \frac{d[k]}{A _k * R _k + B _k} &lt; (\frac{d[k] * R _k}{A _k * R _k + B _k} -  \frac{d[j] * R _j}{A _j * R _j + B _j}) * \frac{A _i}{B _i} \\<br>&amp; \frac{\frac{d[j]}{A _j * R _j + B _j} - \frac{d[k]}{A _k * R _k + B _k}}{\frac{d[k] * R _k}{A _k * R _k + B _k} -  \frac{d[j] * R _j}{A _j * R _j + B _j}} &lt; \frac{A _i}{B _i} \\<br>&amp; \frac{\frac{d[k]}{A _k * R _k + B _k} - \frac{d[j]}{A _j * R _j + B _j}}{\frac{d[k] * R _k}{A _k * R _k + B _k} -  \frac{d[j] * R _j}{A _j * R _j + B _j}} &gt; - \frac{A _i}{B _i} \\<br>\end{aligned}<br>$$<br>相信你和我一样看见这个式子就脑壳疼，所以我们设 $Y(t) = \frac{d[t]}{A _t * R _t + B _t}, X(t) = \frac{d[t] * R _t}{A _t * R _t + B _t}$ ，就很明显是形式一了：<br>$$<br>\frac{Y(k) - Y(j)}{X(k) - X(j)} &gt; - \frac{A _i}{B _i}<br>$$<br>于是就推得形式二：<br>$$<br>Y(j) = - \frac{A _i}{B _i} \times X(j) + \frac{d[i]}{B _i}<br>$$<br>奈斯~，似乎维护一个最大截距就结束了（注意本题是维护上凸壳了，上两题都是下凸壳）？来检查一下单调性， what’s up ， $X(j) = \frac{d[j] * R _j}{A _j * R _j + B _j}$ 有个寂寞的单调性，再看 $- \frac{A _i}{B _i}$ ，更没有了，我们遇到了两个都没有单调性的情况</p><p>这下完蛋，  $k = - \frac{A _i}{B _i}$ 不具有单调性还好，可以像例七一样二分决策位置，但 $X(j)$ 没有单调性，这意味着我们凸包上的点不是按照横坐标排好序的，当前点可能不是插在凸包最右（左）边，而是插到凸包的中间已经维护好的部分里，这意味着我们必须动态维护凸包，<strong>对于本题来</strong>，说如果对于点 $j$ 左边的线斜率小于当前 $k$ ，显然用左边的点截距更大（画图一下就看出来了）；如果右边的线斜率大于当前 $k$ ，那么用右边的点更优；最后最优决策点左边直线斜率 $&gt; k$ （在爬升），右边斜率直线斜率 $&lt; k$ （在下降）</p><p>下面介绍三种不同数据结构维护这个凸包，其中前两种比较常用，各有优劣，第三种不太常见，但有些题目用上会有奇效</p><h3 id="平衡树维护"><a href="#平衡树维护" class="headerlink" title="平衡树维护"></a>平衡树维护</h3><p>把凸包上的点维护成一棵按照 $X(j)$ 排序的平衡树，每个点维护其在凸包上左边直线的斜率 $lk$ 和右边的直线斜率 $rk$ 每次插入新点 $x$ 时：</p><ol><li>先将新点旋转到根</li><li>寻找其左边最后一个可以与其构成凸包的点，并把之间的不能构成凸包的点删除（直接把该点旋转到 $x$ 下面，然后删除该点的左/右儿子即可），计算出 $lk$ （如何判断是否构成凸包：对于当前找到的点 $t$ ，如果 $lk(t)$ 大于直线 $t - x$ 的斜率，并且点 $t, x$ 之间有不在凸包内的节点，就说明要找的点在 $t, x$ 之间，就往右走）</li><li>同理维护右边</li><li>如果发现这个点在原来的凸包内，即 $lk(x) &lt; rk(x)$ ，直接删除该点</li></ol><p>平衡树的有点是好想、好理解，且时间好算，缺点当然是码量和常数（但其实三种方法的常数差不多）</p><p>为了方便拓展和迁移，不用常数小的 SBT 而用拓展性强（并且不用打 <code>push_up</code> ）的 splay 打代码前，我又想起蒟蒻我当初打脸的话：<strong>“我的 splay 常数小”</strong></p><p>时间复杂度 $O(n \log n)$ </p><p>代码：</p><p>其实为了卡常可以存下 $X(j), Y(j)$ ，防止每次都算，但我懒</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-9</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">DB d[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Day</span>&#123;</span> DB a, b, r; &#125;day[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(x - y) &lt; eps ? <span class="number">0</span> : (x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line"><span class="function">DB <span class="title">Y</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> d[x] / (day[x].a * day[x].r + day[x].b); &#125;</span><br><span class="line"><span class="function">DB <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">Y</span>(x) * day[x].r; &#125;</span><br><span class="line"><span class="function">DB <span class="title">K</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> !<span class="built_in">cmp</span>(<span class="built_in">X</span>(a), <span class="built_in">X</span>(b)) ? -INF : (<span class="built_in">Y</span>(b) - <span class="built_in">Y</span>(a)) / (<span class="built_in">X</span>(b) - <span class="built_in">X</span>(a)); &#125;</span><br><span class="line"><span class="keyword">namespace</span> Splay</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> rt, tot;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> fa, ch[<span class="number">2</span>], id;</span><br><span class="line">        DB lk, rk;</span><br><span class="line">    &#125; tr[N];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> fa(x) tr[(x)].fa</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ch(x) tr[(x)].ch</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lk(x) tr[(x)].lk</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rk(x) tr[(x)].rk</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> id(x) tr[(x)].id</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rot</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y), k = <span class="built_in">ch</span>(y)[<span class="number">1</span>] == x;</span><br><span class="line">        <span class="built_in">ch</span>(z)[y == <span class="built_in">ch</span>(z)[<span class="number">1</span>]] = x, <span class="built_in">fa</span>(x) = z;</span><br><span class="line">        <span class="built_in">ch</span>(y)[k] = <span class="built_in">ch</span>(x)[k ^ <span class="number">1</span>], <span class="built_in">fa</span>(<span class="built_in">ch</span>(x)[k ^ <span class="number">1</span>]) = y;</span><br><span class="line">        <span class="built_in">ch</span>(x)[k ^ <span class="number">1</span>] = y, <span class="built_in">fa</span>(y) = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> y, z; <span class="built_in">fa</span>(x) != k; <span class="built_in">rot</span>(x)) <span class="keyword">if</span> ((z = <span class="built_in">fa</span>(y = <span class="built_in">fa</span>(x))) != k) (<span class="built_in">ch</span>(y)[<span class="number">1</span>] == x) ^ (<span class="built_in">ch</span>(z)[<span class="number">1</span>] == y) ? <span class="built_in">rot</span>(x) : <span class="built_in">rot</span>(y);</span><br><span class="line">        <span class="keyword">if</span> (!k) rt = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, DB k)</span> <span class="comment">//寻找最优解,当前斜率为k</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!x || <span class="built_in">cmp</span>(<span class="built_in">lk</span>(x), k) == <span class="number">1</span> &amp;&amp; <span class="built_in">cmp</span>(<span class="built_in">rk</span>(x), k) == <span class="number">-1</span>) <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">cmp</span>(<span class="built_in">lk</span>(x), k) == <span class="number">-1</span> ? <span class="built_in">find</span>(<span class="built_in">ch</span>(x)[<span class="number">0</span>], k) :  <span class="built_in">find</span>(<span class="built_in">ch</span>(x)[<span class="number">1</span>], k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y, res;</span><br><span class="line">        <span class="keyword">for</span> (y = <span class="built_in">ch</span>(x)[<span class="number">0</span>], res = y; y; )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">cmp</span>(<span class="built_in">lk</span>(y), <span class="built_in">K</span>(<span class="built_in">id</span>(y), <span class="built_in">id</span>(x))) &gt;= <span class="number">0</span>) res = y, y = <span class="built_in">ch</span>(y)[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span> y = <span class="built_in">ch</span>(y)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">suf</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y, res;</span><br><span class="line">        <span class="keyword">for</span> (y = <span class="built_in">ch</span>(x)[<span class="number">1</span>], res = y; y; )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">cmp</span>(<span class="built_in">rk</span>(y), <span class="built_in">K</span>(<span class="built_in">id</span>(x), <span class="built_in">id</span>(y))) &lt;= <span class="number">0</span>) res = y, y = <span class="built_in">ch</span>(y)[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span> y = <span class="built_in">ch</span>(y)[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">splay</span>(x, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ch</span>(x)[<span class="number">0</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">splay</span>(t = <span class="built_in">pre</span>(x), x), <span class="built_in">ch</span>(t)[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">//删去凸包内的</span></span><br><span class="line">            <span class="built_in">lk</span>(x) = <span class="built_in">rk</span>(t) = <span class="built_in">K</span>(<span class="built_in">id</span>(t), <span class="built_in">id</span>(x));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">lk</span>(x) = INF; <span class="comment">//保证不往左,下面同理</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ch</span>(x)[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">splay</span>(t = <span class="built_in">suf</span>(x), x), <span class="built_in">ch</span>(t)[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">rk</span>(x) = <span class="built_in">lk</span>(t) = <span class="built_in">K</span>(<span class="built_in">id</span>(x), <span class="built_in">id</span>(t));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">rk</span>(x) = -INF;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(<span class="built_in">lk</span>(x), <span class="built_in">rk</span>(x)) &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            rt = <span class="built_in">ch</span>(x)[<span class="number">0</span>], <span class="built_in">ch</span>(rt)[<span class="number">1</span>] = <span class="built_in">ch</span>(x)[<span class="number">1</span>], <span class="built_in">fa</span>(<span class="built_in">ch</span>(x)[<span class="number">1</span>]) = rt, <span class="built_in">fa</span>(rt) = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">lk</span>(rt) = <span class="built_in">rk</span>(<span class="built_in">ch</span>(rt)[<span class="number">1</span>]) = <span class="built_in">K</span>(<span class="built_in">id</span>(rt), <span class="built_in">id</span>(<span class="built_in">ch</span>(rt)[<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = rt, ff = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (u &amp;&amp; <span class="built_in">id</span>(u) != id) u = <span class="built_in">ch</span>(ff = u)[(<span class="built_in">cmp</span>(<span class="built_in">X</span>(id), <span class="built_in">X</span>(<span class="built_in">id</span>(u))) &lt;= <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>)];</span><br><span class="line">        <span class="keyword">if</span> (u) <span class="keyword">return</span> ;</span><br><span class="line">        u = ++tot;</span><br><span class="line">        <span class="keyword">if</span> (ff) <span class="built_in">ch</span>(ff)[(<span class="built_in">cmp</span>(<span class="built_in">X</span>(id), <span class="built_in">X</span>(<span class="built_in">id</span>(ff))) &lt;= <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>)] = u;</span><br><span class="line">        <span class="built_in">id</span>(u) = id, <span class="built_in">fa</span>(u) = ff, <span class="built_in">ch</span>(u)[<span class="number">0</span>] = <span class="built_in">ch</span>(u)[<span class="number">1</span>] = <span class="number">0</span>, <span class="built_in">check</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %lf&quot;</span>, &amp;n, &amp;d[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= n; Splay::<span class="built_in">ins</span>(i), ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;day[i].a, &amp;day[i].b, &amp;day[i].r);</span><br><span class="line">        j = Splay::<span class="built_in">find</span>(Splay::rt, -(day[i].a / day[i].b));</span><br><span class="line">        d[i] = <span class="built_in">max</span>(d[i - <span class="number">1</span>], <span class="built_in">X</span>(j) * day[i].a + <span class="built_in">Y</span>(j) * day[i].b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, d[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CDQ分治"><a href="#CDQ分治" class="headerlink" title="CDQ分治"></a>CDQ分治</h3><p>直接 CDQ 的话伪代码如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cdq(l, r)</span><br><span class="line">if (l = r) 用 d[i - 1] 跟新 d[i] </span><br><span class="line">cdq(l, mid)</span><br><span class="line">将 [l, mid] 按 X 排序, 将 [mid + 1, r] 按 k 排序</span><br><span class="line">用正常的斜率优化 O(n) 把左区间转移到右区间</span><br><span class="line">cdq(mid + 1, r)</span><br><span class="line">end dcq</span><br></pre></td></tr></table></figure><p>不难发现这样是 $O(n \log^2 n)$ 的，虽然可过，但这样显得 CDQ 不优于平衡树，其实 CDQ 的归并和归并排序有点像，可以利用它排序</p><p>具体地，我们先在进入 CDQ 前把原序列按 $k$ 排序，并同时记下每个数在原序列中的位置，在区间 $[l, r]$ 中，把在原序列中位置 $&lt; mid$ 的全部放在左边， $&gt; mid$ 的全部放在右边（保证左右仍然按 $k$ 有序） ，然后去归并</p><p>我们希望一个区间归并回来后是按 $X$ 排序的，于是在 CDQ 的最后做归并排序即可</p><p>另外，其实上面的 $k, X$ 可以互换，只要改动分治顺序即可</p><p>不难发现，相比平衡树， CDQ 有码量小，轻便的优点，但缺点是如果要保证时间复杂度的话需要一些冗余操作，且个人觉得思维量比平衡树大，另外 CDQ 是离线的，我也不知道这是优点还是缺点</p><p>时间复杂度 $O(n \log n)$ </p><p>代码：</p><p>中间分两边的步骤可以自己开临时数组做，别用 <code>nth_element</code> （它不稳定），另外，平衡树中说的记录下 $X, Y$ 的卡常在本题中很优秀，但我懒</p><p>（<del>话说 CDQ 是真的短</del>）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-12</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, p[N];</span><br><span class="line">DB d[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Day</span>&#123;</span> DB a, b, r; &#125;day[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(x - y) &lt; eps ? <span class="number">0</span> : (x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line"><span class="function">DB <span class="title">Y</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> d[x] / (day[x].a * day[x].r + day[x].b); &#125;</span><br><span class="line"><span class="function">DB <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">Y</span>(x) * day[x].r; &#125;</span><br><span class="line"><span class="function">DB <span class="title">K</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123; <span class="keyword">return</span> !<span class="built_in">cmp</span>(<span class="built_in">X</span>(a), <span class="built_in">X</span>(b)) ? -INF : (<span class="built_in">Y</span>(b) - <span class="built_in">Y</span>(a)) / (<span class="built_in">X</span>(b) - <span class="built_in">X</span>(a)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> q[N], tmp[N];</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> <span class="built_in"><span class="keyword">void</span></span>(d[l] = <span class="built_in">max</span>(d[l], d[l - <span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>, ll = <span class="number">1</span>, rr = <span class="number">0</span>, lp = l - <span class="number">1</span>, rp = mid, tp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i) p[i] &lt;= mid ? tmp[++lp] = p[i] : tmp[++rp] = p[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i) p[i] = tmp[i];</span><br><span class="line">    <span class="built_in">cdq</span>(l, mid);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= mid; q[++rr] = i++)</span><br><span class="line">        <span class="keyword">for</span> (; ll &lt; rr &amp;&amp; <span class="built_in">cmp</span>(<span class="built_in">K</span>(p[q[rr]], p[i]), <span class="built_in">K</span>(p[q[rr - <span class="number">1</span>]], p[q[rr]])) == <span class="number">1</span>; --rr);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">1</span>; i &lt;= r; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (; ll &lt; rr &amp;&amp; <span class="built_in">cmp</span>(<span class="built_in">K</span>(p[q[ll]], p[q[ll + <span class="number">1</span>]]), -(day[p[i]].a / day[p[i]].b)) == <span class="number">1</span>; ++ll);</span><br><span class="line">        d[p[i]] = <span class="built_in">max</span>(d[p[i]], <span class="built_in">X</span>(p[q[ll]]) * day[p[i]].a + <span class="built_in">Y</span>(p[q[ll]]) * day[p[i]].b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cdq</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">for</span> (lp = tp = l, rp = mid + <span class="number">1</span>; lp &lt;= mid &amp;&amp; rp &lt;= r; ) tmp[tp++] = (<span class="built_in">cmp</span>(<span class="built_in">X</span>(p[lp]), <span class="built_in">X</span>(p[rp])) == <span class="number">-1</span> ? p[lp++] : p[rp++]);</span><br><span class="line">    <span class="keyword">for</span> (; lp &lt;= mid; tmp[tp++] = p[lp++]); </span><br><span class="line">    <span class="keyword">for</span> (; rp &lt;= r; tmp[tp++] = p[rp++]); </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i) p[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %lf&quot;</span>, &amp;n, &amp;d[<span class="number">0</span>]); <span class="comment">//都先初始化为s</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; d[i] = d[<span class="number">0</span>], p[i] = i, ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;day[i].a, &amp;day[i].b, &amp;day[i].r);</span><br><span class="line">    <span class="built_in">sort</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n, [&amp;](<span class="keyword">int</span> a, <span class="keyword">int</span> b)&#123; <span class="keyword">return</span> -(day[a].a / day[a].b) &gt; -(day[b].a / day[b].b); &#125;);</span><br><span class="line">    <span class="built_in">cdq</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, d[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="李超线段树"><a href="#李超线段树" class="headerlink" title="李超线段树"></a>李超线段树</h3><p>这个就是邪教了</p><p>看到形式二：<br>$$<br>Y(j) = - \frac{A _i}{B _i} \times X(j) + \frac{d[i]}{B _i}<br>$$<br>我们把它化回去（是的，倒退，但不完全退）：<br>$$<br>\frac{d[i]}{B_i} = \max (X(j) * \frac{A _i}{B _i} + Y(j))<br>$$<br>我们明确一下我们要干嘛：对于一个 $i$ ，我们找到一个最优的 $j$ 使得上式最小</p><p>设 $t = \frac{A _i}{B _i}$ ，不再把每个 $j$ 当作点而是把它当作线段 $y = X(j) * x + Y(j)$ （即 $y = k * x + b$ 的形式），问题转化为对于每个 $t$ ，在一堆直线中找到当 $x = t$ 时，使得 $y$ 最大的一个，这很像李超线段树的板子，只是 $x = t$ 为小数，当然也可以就用小数直接查（动态开点），但这样精度要开很大，常数也很大，更优秀的方法是将 $x$ 离散化，这样也可以保证时间复杂度</p><p>说实话这已经不算斜率优化了，但这种方法可以也解决很大一部分斜率优化题，所以也写这里</p><p>时间复杂度 $O(n \log n)$ </p><p>代码：</p><p>也算短吧（主要数据结构部分长，不好压）？但李超线段树不常打，另外其实这种方法 <code>d[i]</code> 只由 <code>d[i - 1]</code> 转移，可以压掉，但那样就要记录 $X, Y$ ，我懒（艹）</p><p>有一个小点是要注意离散化后下标要从 $1$ 开始，因为建树是建在 $[1, n]$ 上的（这是值域线段树，离散化后值域应该是 $[1, n]$ ）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-9</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">DB d[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Day</span>&#123;</span> DB a, b, r, x; &#125;day[N];</span><br><span class="line">vector&lt;DB&gt; xx;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(x - y) &lt; eps ? <span class="number">0</span> : (x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line"><span class="function">DB <span class="title">Y</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> d[x] / (day[x].a * day[x].r + day[x].b); &#125;</span><br><span class="line"><span class="function">DB <span class="title">X</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">Y</span>(x) * day[x].r; &#125;</span><br><span class="line"><span class="keyword">namespace</span> LC</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        DB k, b, l, r;</span><br><span class="line">        <span class="function">DB <span class="title">calc</span><span class="params">(<span class="keyword">int</span> xid)</span></span>&#123; <span class="keyword">return</span> ((xid &gt; r || xid &lt; l) ? -INF : xx[xid] * k + b); &#125;</span><br><span class="line">    &#125; li[N];</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> l, r, id;</span><br><span class="line">    &#125; tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) tr[(x)].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) tr[(x)].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> id(x) tr[(x)].id</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> Mid (tr[u].l + tr[u].r &gt;&gt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">cmp</span>(li[a].<span class="built_in">calc</span>(x), li[b].<span class="built_in">calc</span>(x)) &lt;= <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tr[u] = &#123;l, r, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (l == r) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= <span class="built_in">l</span>(u) &amp;&amp; r &gt;= <span class="built_in">r</span>(u))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, mid)) <span class="built_in">swap</span>(<span class="built_in">id</span>(u), d);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, <span class="built_in">l</span>(u))) <span class="built_in">upd</span>(lc, <span class="built_in">l</span>(u), <span class="built_in">r</span>(u), d);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, <span class="built_in">r</span>(u))) <span class="built_in">upd</span>(rc, <span class="built_in">l</span>(u), <span class="built_in">r</span>(u), d);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= mid) <span class="built_in">upd</span>(lc, l, r, d);</span><br><span class="line">        <span class="keyword">if</span> (r &gt; mid) <span class="built_in">upd</span>(lc, l, r, d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(Line x)</span></span>&#123; li[++cnt] = x, <span class="built_in">upd</span>(<span class="number">1</span>, <span class="number">1</span>, n, cnt); &#125;</span><br><span class="line">    <span class="function">DB <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">l</span>(u) == <span class="built_in">r</span>(u)) <span class="keyword">return</span> li[<span class="built_in">id</span>(u)].<span class="built_in">calc</span>(x);</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        DB res = (x &lt;= mid ? <span class="built_in">ask</span>(lc, x) : <span class="built_in">ask</span>(rc, x));</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(res, li[<span class="built_in">id</span>(u)].<span class="built_in">calc</span>(x));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lsh</span><span class="params">()</span></span>&#123; xx.<span class="built_in">push_back</span>(-INF); <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) xx.<span class="built_in">push_back</span>(day[i].x);<span class="built_in">sort</span>(xx.<span class="built_in">begin</span>(), xx.<span class="built_in">end</span>()); &#125; <span class="comment">//这里就不必去重了,因为是实数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %lf&quot;</span>, &amp;n, &amp;d[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;day[i].a, &amp;day[i].b, &amp;day[i].r), day[i].x = day[i].a / day[i].b;</span><br><span class="line">    <span class="built_in">lsh</span>(), LC::<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, xx.<span class="built_in">size</span>() - <span class="number">1</span>); <span class="comment">//注意是size-1,因为xx多插了一个-INF,多建点会RE</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= n; LC::<span class="built_in">ins</span>(&#123;<span class="built_in">X</span>(i), <span class="built_in">Y</span>(i), <span class="number">1</span>, <span class="built_in">DB</span>(n)&#125;), ++i) d[i] = <span class="built_in">max</span>(d[i - <span class="number">1</span>], day[i].b * LC::<span class="built_in">ask</span>(<span class="number">1</span>, <span class="built_in">lower_bound</span>(xx.<span class="built_in">begin</span>(), xx.<span class="built_in">end</span>(), day[i].x) - xx.<span class="built_in">begin</span>()));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf&quot;</span>, d[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="待续"><a href="#待续" class="headerlink" title="待续"></a>待续</h1><p>话说我好懒啊，记录卡常一直懒得打，另外代码有点压行非常抱歉</p><p>其它的下次再写，会挂链接的</p><p><a href="https://dyd-true.github.io/2022/02/12/%E4%BC%98%E5%8C%96dp3/#more">优化dp3</a></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> dp </tag>
            
            <tag> 斜率优化 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> splay </tag>
            
            <tag> 笔记 </tag>
            
            <tag> CDQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优化dp</title>
      <link href="/2022/02/08/%E4%BC%98%E5%8C%96dp/"/>
      <url>/2022/02/08/%E4%BC%98%E5%8C%96dp/</url>
      
        <content type="html"><![CDATA[<p> 然而我 dp 废的一比（梅开二度）</p><span id="more"></span><h1 id="优化-dp"><a href="#优化-dp" class="headerlink" title="优化 dp"></a>优化 dp</h1><p>作为 dp 废物，这里记录一下（<del>反正我不会的</del>） dp 优化方法</p><p> dp 的关键有：状态、初始化、转移、循环</p><h1 id="倍增优化"><a href="#倍增优化" class="headerlink" title="倍增优化"></a>倍增优化</h1><p>倍增是一种很优美的思想，大部分动态规划的都是采用阶段的线性增长，而在有些题中，可以考虑倍增增长（类似 ST 表的预处理），而这种优化常常会把 $2^k$ 中的 $k$ 记入<strong>状态</strong>中，类似区间 dp ，关于 $k$ 的循环往往在外层</p><p>而倍增优化的 dp 往往是这类问题的第一部分（也是最难的部分），通过 dp 我们得到若干与 $2$ 的整次幂相关的状态；在第二部分，我们会用这些状态<strong>“拼凑”</strong>（一般基于二进制拆分）出最后答案</p><h2 id="例一"><a href="#例一" class="headerlink" title="例一"></a>例一</h2><p><a href="https://www.luogu.com.cn/problem/P1081">开车旅行</a></p><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给定 $n \le 10^5$ 个不同的数 $\mid h_i \mid \le 10^9$ ，记 $dis(i, j) = \mid h_i - h_j \mid$ ，两种操作<strong>轮流进行</strong>，设当前在 $i$ ，第一种会找到满足 $j &gt; i$ 且使  $dis(i, j)$ 取<strong>次小值</strong>（相等则认为 $h_j$ 小的小，下同）的 $j$ ，并以 $dis(i, j)$ 的代价到达 $j$ ；第二种会找到满足 $j &gt; i$ 且使  $dis(i, j)$ 取<strong>最小值</strong>的 $j$ ，并以 $dis(i, j)$ 的代价到达 $j$ ，但无论如何，总代价不能大于 $X \le 10^9$ ，当操作无法进行下去时就结束，现在有两个问题：</p><ol><li>对于给定的 $X= X_0$ ，求从那个数出发，操作一耗费的代价与操作二耗费的代价比值最小，若有多个答案，输出 $h_i$ 最大的</li><li>给出 $m \le 10^5$ 次询问，每次给定 $X = X_i$ 和出发点 $st_i$ ，分别求两种操作耗费的代价</li></ol><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>首先预处理出从每个 $i$ 出发，两种操作会到达的点，记为 $g[0/1, i]$ ，用一个 <code>set</code> 倒序扫描即可</p><p>本题信息有三个：位置、操作次数、代价，如果直接以其为状态，复杂度过高，注意到操作是轮流进行的，考虑倍增优化，设 $d[0/1, i, j, 0/1]$ 表示“对于操作一/二，从 $j$ 出发先做操作一/二，操作 $2^i$ 次后的代价”，初始化和转移比较明显：<br>$$<br>\begin{aligned}<br>&amp; &amp; d[0, 0, j, 0] = dis(j, g[0, i]), d[0, 0, j, 1] = 0 \\<br>&amp; if (i = 1) &amp; d[0, 1, j, k] = d[0, 0, j, k] + d[0, 0, x, k \oplus 1] \\<br>&amp; else &amp; d[0, i, j, k] = d[0, i - 1, j, k] + d[0, i - 1, x, k] \\<br>\end{aligned}<br>$$<br>这里一定要单独考虑 $i = 1$ 的情况，因为只有 $2^0 = 1$ 是奇数， $d[1]$ 类似</p><p>不难发现状态数是 $O(2 * \log n * n * 2) = O(4 n \log n)$ （这里先把常数留一下），所以留给转移的时间最多是 $O(\log n)$ ，而转移的关键在于上面方程中的 $x$ ，它的含义是“前面那步走到的城市”，如在 $i \ne 1$ 时， $x$ 指“从 $j$ 出发先做操作 $k$ ，进行 $2^{i - 1}$ 次操作到达的城市”，这个东西可以 dp 预处理，具体地，设 <code>f[i, j, 0/1]</code> 表示“从 $j$ 出发先做操作一/二，进行 $2^{i}$ 次操作到达的城市”，初始化和转移如下：<br>$$<br>\begin{aligned}<br>&amp; &amp; f[0, j, 0] = g[0, j], f[0, j, 1] = g[1, j] \\<br>&amp; if (i = 1) &amp; f[1, j, k] = f[0, f[0, j, k], k \oplus 1] \\<br>&amp; else &amp; f[i, j, k] = f[i - 1, f[i - 1, j, k], k] \\<br>\end{aligned}<br>$$<br>预处理时间明显 $O(n \log n)$ ，然后 $d$ 的转移可以做到 $O(1)$ </p><p>于是我们在 $O(n \log n)$ 的时间内完成了计算所有操作次数为 $2^i$ 形式的信息，现在，对于问题二，类似 lca 倒序枚举 $i$ 移动即可，时间为 $O(\log n)$ ，而对于问题一，直接枚举起点转化成问题二即可，故总的时间为 $O(n \log n + 4 n \log n + n \log n + m \log n) = O(n \log n)$ 常数在 $10$ 左右，完全可以过</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>马蜂毒牛（ <del>dp 码风重拳出击，数据结构唯唯诺诺</del>）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SPT set<span class="meta-string">&lt;PII&gt;</span>::iterator</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, D = <span class="number">20</span>, INF = <span class="number">2e9</span> + <span class="number">7</span>; <span class="comment">//这里INF要足够大</span></span><br><span class="line"><span class="keyword">int</span> n, h[N], d[<span class="number">2</span>][D][N][<span class="number">2</span>], f[D][N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    h[<span class="number">0</span>] = INF, h[n + <span class="number">1</span>] = -INF;</span><br><span class="line">    set&lt;PII&gt; s;</span><br><span class="line">    s.<span class="built_in">insert</span>(&#123;h[<span class="number">0</span>], <span class="number">0</span>&#125;), s.<span class="built_in">insert</span>(&#123;h[<span class="number">0</span>] + <span class="number">1</span>, <span class="number">0</span>&#125;), s.<span class="built_in">insert</span>(&#123;h[n + <span class="number">1</span>], n + <span class="number">1</span>&#125;), s.<span class="built_in">insert</span>(&#123;h[n + <span class="number">1</span>] - <span class="number">1</span>, n + <span class="number">1</span>&#125;); <span class="comment">//set不能插入重复元素</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n, ga, gb; i; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        s.<span class="built_in">insert</span>(&#123;h[i], i&#125;);</span><br><span class="line">        SPT il = s.<span class="built_in">lower_bound</span>(&#123;h[i], i&#125;), ir = il;</span><br><span class="line">        --il, ++ir;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span>(h[i] - il-&gt;fi) &lt;= <span class="built_in">abs</span>(h[i] - ir-&gt;fi))</span><br><span class="line">        &#123;</span><br><span class="line">            gb = il-&gt;se, --il;</span><br><span class="line">            ga = (<span class="built_in">abs</span>(h[i] - il-&gt;fi) &lt;= <span class="built_in">abs</span>(h[i] - ir-&gt;fi) ? il-&gt;se : ir -&gt; se);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            gb = ir-&gt;se, ++ir;</span><br><span class="line">            ga = (<span class="built_in">abs</span>(h[i] - il-&gt;fi) &lt;= <span class="built_in">abs</span>(h[i] - ir-&gt;fi) ? il-&gt;se : ir -&gt; se);</span><br><span class="line">        &#125;</span><br><span class="line">        f[<span class="number">0</span>][i][<span class="number">0</span>] = ga, f[<span class="number">0</span>][i][<span class="number">1</span>] = gb;</span><br><span class="line">        d[<span class="number">0</span>][<span class="number">0</span>][i][<span class="number">0</span>] = <span class="built_in">abs</span>(h[i] - h[ga]), d[<span class="number">0</span>][<span class="number">0</span>][i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        d[<span class="number">1</span>][<span class="number">0</span>][i][<span class="number">1</span>] = <span class="built_in">abs</span>(h[i] - h[gb]), d[<span class="number">1</span>][<span class="number">0</span>][i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; D; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">1</span>; ++k) f[i][j][k] = f[i - <span class="number">1</span>][f[i - <span class="number">1</span>][j][k]][k ^ (i == <span class="number">1</span> ? <span class="number">1</span> : <span class="number">0</span>)];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">0</span>; o &lt;= <span class="number">1</span>; ++o)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; D; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">1</span>; ++k) d[o][i][j][k] = d[o][i - <span class="number">1</span>][j][k] + d[o][i - <span class="number">1</span>][f[i - <span class="number">1</span>][j][k]][k ^ (i == <span class="number">1</span> ? <span class="number">1</span> : <span class="number">0</span>)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">PII <span class="title">work</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> la = <span class="number">0</span>, lb = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; ~i; --i) <span class="keyword">if</span> (f[i][p][<span class="number">0</span>] &amp;&amp; la + lb + d[<span class="number">0</span>][i][p][<span class="number">0</span>] + d[<span class="number">1</span>][i][p][<span class="number">0</span>] &lt;= x) la += d[<span class="number">0</span>][i][p][<span class="number">0</span>], lb += d[<span class="number">1</span>][i][p][<span class="number">0</span>], p = f[i][p][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> &#123;la, lb&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(PII x, PII y)</span> <span class="comment">//应对分母为0的情况,化除为乘,-1代表相等,1代表x大,0代表y大</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x.se &amp;&amp; !y.se) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!x.se || !y.se) <span class="keyword">return</span> x.se != <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (LL)x.fi * y.se == (LL)y.fi * x.se ? <span class="number">-1</span> : (LL)x.fi * y.se &lt; (LL)y.fi * x.se;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, st, ans, m;</span><br><span class="line">    PII as = &#123;INF, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;h[i]);</span><br><span class="line">    <span class="built_in">dp</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, tt; i &lt;= n; ++i)</span><br><span class="line">    &#123;    </span><br><span class="line">        PII t = <span class="built_in">work</span>(i, x); </span><br><span class="line">        <span class="keyword">if</span> ((tt = <span class="built_in">cmp</span>(t, as)) == <span class="number">1</span> || (tt == <span class="number">-1</span> &amp;&amp; h[i] &gt; h[ans])) ans = i, as = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m); m--; <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, as.fi, as.se)) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;st, &amp;x), as = <span class="built_in">work</span>(st, x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例二"><a href="#例二" class="headerlink" title="例二"></a>例二</h2><p><a href="https://www.acwing.com/problem/content/296/">Count The Repetitions</a></p><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>多组数据，定义 <code>conn(s, n)</code> 为 $n$ 个字符串 $s$ 形成的字符串，如 <code>conn(&quot;abc&quot;, 2) = &quot;abcabc&quot;</code> ，每次给定长度 $\le 100$ 的字符串 $s_1, s_2$ 和两个整数 $n_1, n_2 \le 10^6$ ，求一个最大的 $m$ 使得 $conn(conn(s_2, n_2), m)$ 为 $conn(s_1, n_1)$ 的子串</p><h3 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h3><p>首先， $conn(conn(s_2, n_2), m) = conn(s_2, n_2 * m)$ ，现在问题转化为求 $m’ = n_2 * m$ </p><p>注意到 $m’ \le N = \frac{\mid s_1 \mid * n_1}{\mid s_2 \mid}$ ，而  $N \le 10^8$ 过大，不好直接枚举，考虑将 $m’$ 二进制拆分，设 $m’ = 2^{p_0} + 2^{p_1} + … + 2^{p_{t - 1}}$ ，则 $conn(s_2, m’)$ 可看作 $conn(s_2, 2^{p_0}), conn(s_2, 2^{p_1}), …, conn(s_2, 2^{p_{t - 1}})$ 着 $t$ 个串首尾衔接得到，考虑对于每个 $k \in [0, \log N]$ ，求出 $conn(s_1, n_1)$ <strong>从每个位置开始</strong>，最少要多少个字符才能和 $conn(s_2, 2^{k})$ 匹配上（就是含有该子串），这样我们就又可以用类似 lca 的方法拼凑出答案，但 $cons(s_1, n_1)$ 也很长，不妨当成 $conn(s_1, \infty)$ ，但只算从 $s_1$ 的各个位置开始的情况</p><p>综上，定义 <code>d[i, j]</code> 表示“从 $s_1[i]$ 开始，至少要多少个字符，才能匹配 $conn(s_2, 2^j)$ ”，则转移方程为：<br>$$<br>d[i, j] = d[i, j - 1] + d[(i + d[i, j - 1]) \mod \mid s_1 \mid, j - 1]<br>$$<br>初始化 $d[i, 0]$ 可以暴力计算， dp 的总时间复杂度为 $O(\mid s_1 \mid \log N)$ </p><p>然后用得到的状态拼凑答案，类似于 lca ，具体见代码</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p>要注意的地方是：</p><ol><li> <code>d</code> 要开 <code>long long</code> </li><li>第 $18$ 行是 <code>x + 1</code> ，因为我下标从 $1$ 开始的</li><li>本题输入非常毒瘤，如果用 <code>cin</code> 一点问题没有，但如果用 <code>scanf</code> 因为数据最后有个换行所以会 TLE ，不过可以利用 <code>scanf</code> 返回值解决</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(x) (((x) - 1) % l1 + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">100</span> + <span class="number">5</span>, D = <span class="number">32</span>;</span><br><span class="line"><span class="keyword">char</span> s1[L], s2[L];</span><br><span class="line"><span class="keyword">int</span> n1, n2, l1, l2, ans;</span><br><span class="line">LL d[L][D];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ans = <span class="number">0</span>, <span class="built_in">memset</span>(d, <span class="number">0</span> , <span class="keyword">sizeof</span> d);</span><br><span class="line">    l1 = <span class="built_in">strlen</span>(s1 + <span class="number">1</span>), l2 = <span class="built_in">strlen</span>(s2 + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, pos, j, ct; i &lt;= l1; ++i)</span><br><span class="line">        <span class="keyword">for</span> (pos = i, j = <span class="number">1</span>; j &lt;= l2; ++j, pos = <span class="built_in">get</span>(pos + <span class="number">1</span>), d[i][<span class="number">0</span>] += ct + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> (ct = <span class="number">0</span>; s1[pos] != s2[j]; pos = <span class="built_in">get</span>(pos + <span class="number">1</span>)) <span class="keyword">if</span> (++ct &gt; l1) <span class="keyword">return</span> ans = <span class="number">0</span>, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; D; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l1; ++i) d[i][j] = d[i][j - <span class="number">1</span>] + d[<span class="built_in">get</span>(i + d[i][j - <span class="number">1</span>])][j - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = D - <span class="number">1</span>, x = <span class="number">0</span>; k &gt;= <span class="number">0</span>; --k) <span class="keyword">if</span> (x + d[<span class="built_in">get</span>(x + <span class="number">1</span>)][k] &lt;= l1 * n1) x += d[<span class="built_in">get</span>(x + <span class="number">1</span>)][k], ans += (<span class="number">1</span> &lt;&lt; k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; <span class="built_in">scanf</span>(<span class="string">&quot;%s %d %s %d&quot;</span>, s2 + <span class="number">1</span>, &amp;n2, s1 + <span class="number">1</span>, &amp;n1) == <span class="number">4</span>; <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans / n2)) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="数据结构优化"><a href="#数据结构优化" class="headerlink" title="数据结构优化"></a>数据结构优化</h1><p>对于大部分 dp 高效的<strong>转移</strong>非常重要，通过选取适当的数据结构，可以大大提高 dp 效率</p><p>这类问题的难点一般不在数据结构上，它仅仅做一个辅助转移的工具，关于工具的选取还要看题目本身的性质</p><p>当然有时候我们会需要在数据结构上 dp ，这种情况本质上并不是优化 dp 这里就不再做讨论</p><h2 id="例题三"><a href="#例题三" class="headerlink" title="例题三"></a>例题三</h2><p>还是看到题： <a href="https://www.acwing.com/problem/content/299/">赤壁之战</a></p><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>给定长度为 $n \le 1000$ 的序列 $a_i$ ，求 $a_i$ 有多少个长度为 $m$ 严格递增子序列，多组数据，答案对 $10^9 + 7$ 取模</p><h3 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h3><p> dp 方程一眼就出来： <code>d[i, j]</code> 表示以 $j$ 结尾的长度为 $i$ 的严格递增子序列的个数，有  $d[i, j] \gets d[i - 1, k] (k &lt; j \wedge a_k &lt; a_j)$ </p><p>仔细一看， $n \le 10^7$ ，直接 dp 是 $O(n^2m)$ 的，这不完蛋，但，先打出来看看</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; j; ++k) <span class="keyword">if</span> (a[k] &lt; a[j]) d[i][j] += d[i - <span class="number">1</span>][k];</span><br></pre></td></tr></table></figure><p>在枚举 $j, k$ 时，可以把最外层的 $i$ 当作定值不管，发现当 $j$ 加 $1$ 后， $k$ 的范围也仅变化了 $1$ ，但决策是变化了不知道多少的，因为条件 <code>a[k] &lt; a[j]</code> 中的 <code>a[j]</code> 变了，考虑用树状数组，把 $a_i$ 离散化，每次查询前缀和并插入一个数，于是第三层循环的 $n$ 变成 $\log n$ ，总时间为 $O(m n \log n)$ </p><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, ans;</span><br><span class="line"><span class="keyword">int</span> d[N][N], a[N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; aa;</span><br><span class="line"><span class="keyword">namespace</span> BIT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; -(x))</span></span><br><span class="line">    <span class="keyword">int</span> c[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123; <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span> c); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; <span class="keyword">for</span> (; x &lt;= n; x += <span class="built_in">lowbit</span>(x)) c[x] = (c[x] + y) % P; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x; x -= <span class="built_in">lowbit</span>(x)) res = (res + c[x]) % P;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lsh</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    aa.<span class="built_in">push_back</span>(- INF - <span class="number">1</span>); <span class="comment">//树状数组不能有下标为0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) aa.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">    <span class="built_in">sort</span>(aa.<span class="built_in">begin</span>(), aa.<span class="built_in">end</span>());</span><br><span class="line">    aa.<span class="built_in">erase</span>(<span class="built_in">unique</span>(aa.<span class="built_in">begin</span>(), aa.<span class="built_in">end</span>()), aa.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) a[i] = <span class="built_in">lower_bound</span>(aa.<span class="built_in">begin</span>(), aa.<span class="built_in">end</span>(), a[i]) - aa.<span class="built_in">begin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); t &lt;= T; aa.<span class="built_in">clear</span>(), <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span> d), ans = <span class="number">0</span>, ++t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        a[<span class="number">0</span>] = -INF;</span><br><span class="line">        <span class="built_in">lsh</span>();</span><br><span class="line">        d[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            BIT::<span class="built_in">clear</span>();</span><br><span class="line">            BIT::<span class="built_in">add</span>(a[<span class="number">0</span>], d[i - <span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) d[i][j] = BIT::<span class="built_in">ask</span>(a[j] - <span class="number">1</span>), BIT::<span class="built_in">add</span>(a[j], d[i - <span class="number">1</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ans = (ans + d[m][i]) % P;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %d\n&quot;</span>, t, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="单调队列优化"><a href="#单调队列优化" class="headerlink" title="单调队列优化"></a>单调队列优化</h1><p>从这里开始是对于<strong>转移</strong>的优化</p><p>在 dp 中，我们常常遇到这种方程（有时候不尽相同，但通过把外层变量当定值等方法可以化成这样）：<br>$$<br>d[i] = \min_{l(i) \le j \le r(i)} (d[j] + val(i, j))<br>$$<br>其中 $\min$ 可换成 $\max$ ， $val(i, j)$ 是关于 $i, j$ 的多项式函数（通常<strong>它是决定优化方式的关键</strong>）， $l(i), r(i)$ 限制了 $j$ 的决策范围且保证<strong>上下界变化具有单调性</strong>，上述问题被称作 <strong>1D/1D 动态规划</strong>，因为它的状态和转移都是 $O(n)$ 的</p><p>如果上面方程中，满足 <strong>$val(i, j)$ 中的每一项仅与 $i, j$ 中一个有关</strong>，我们就可以考虑把关于 $i, j$ 的项分开，对于关于 $i$ 的部分，它与 $j$ 无关，可以每次跟新 $i$ 后再计算；对于关于 $j$ 的部分，由于 $l(i), r(i)$ 的单调性，可以用<strong>单调队列优化</strong></p><h2 id="例题四"><a href="#例题四" class="headerlink" title="例题四"></a>例题四</h2><p><a href="https://www.acwing.com/problem/content/301/">Cut the Sequence</a></p><h3 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h3><p>给定长度为 $n \le 10^5$ 的序列 $0 \le a_i \le 10^6$ ，要求把序列分成若干段，在满足“每段的和不超过 $m \le 10^{11}$ ”的前提下，让“每段的最大值之和”最小，求最小值</p><h3 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h3><p>照着题意设方程，定义 <code>d[i]</code> 表示“把前 $i$ 个数分成若干段，在保证每段和不超过 $m$ 的前提下，每段最大值之和的最小值”，转移方程：<br>$$<br>d[i] = \min_{0 \le j &lt; i \wedge \sum_{k = j + 1}^i a_k \le m} (d[j] + \max_{j + 1 \le k \le i} (a_k))<br>$$<br>直接转移明显 $O(n^2)$ ，并且 $val(i, j) = \max_{j + 1 \le k \le i} (a_k)$ 似乎很难用多项式表示，思考转移优化的指导思想：<strong>及时排除不可能的决策，保持候选决策集合的秩序性和有效性</strong>，我们来看看何时决策 $j$ 是必要的</p><p>引理：</p><p>决策 $j(0 \le j &lt; i \wedge \sum_{k = j + 1}^i a_k \le m)$ 是最优策略的必要条件是它至少满足下面两个式子<strong>之一</strong>：</p><ol><li> $a_j = \max_{j \le k \le i} (a_k)$ </li><li> $\sum_{k = j}^i a_k &gt; m$ 或者说 $j$ 是最小的满足 $\sum_{k = j + 1}^i a_k \le m$ 的数</li></ol><p>证明：</p><p>设 $j$ 两个条件都不满足，则由条件 $1$ 有 $\max_{j \le k \le i} (a_k) = \max_{j + 1 \le k \le i} (a_k)$ ，再由条件 $2$ 可知决策 $j - 1$ 合法，又因为明显 $d[j - 1] \le d[j]$ ，有 $d[j - 1] + \max_{j \le k \le i} (a_k) \le d[j] + \max_{j + 1 \le k \le i} (a_k)$ ，即决策 $j - 1$ 优于决策 $j$ </p><p>QED</p><p> 那么，现在来看看引理如何指导 dp ，首先是条件 $2$ ，可以直接对每个 $i$ 预处理出最小的 $j$ ，然后直接进行一次转移即可（然而后面会有更简单的实现方法）；而对于条件 $1$ ，考虑优先队列，当一个新决策 $k$ 入队时，若队尾决策 $j$ 满足 $j &lt; k (这个条件显然) \wedge a_j \le a_k$ 那么 $j$ 一定不优于 $k$ ，这样看来只要维护一个 $a_i$ 单调递减的队列，就可以做到 $O(n)$ 的 dp 了……吗？</p><p>发现我们只能保证<strong>队列中的元素可能为最优决策</strong>，但队头不一定是令 $d[j] + \max_{j + 1 \le k \le i} (a_k)$ 取得最小值的 $j$ ，如果直接扫描队列时间又变回 $O(n^2)$ 了，故我们要快速找到队列中的最优解，考虑数据结构，它要支持查询最小、插入、删除——这不平衡树吗（好像二叉堆 + 懒惰删除也行）？直接维护一个内部元素于单调队列相同的平衡树即可，总时间 $O(n \log n)$ </p><p>最后一个小问题：  $\max_{j + 1 \le k \le i} (a_k)$ 可以用 ST 表做到 $O(1)$ ，但其实仔细思考可以发现，队列中某一项的 $\max_{j + 1 \le k \le i} (a_k)$ 就是它下一项的 $a_i$ </p><h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><ol><li>特判无解的情况</li><li>关于条件 $2$ 的实现，可以不必预处理，记录一个当前  $sum$ 和对应最小的 $j$ ，即 $L$ 当队列中只有一个元素时就用 $L$ 转移，同时 $L$ 还可以帮助维护队头</li><li> 虽然队列中某一项的 $\max_{j + 1 \le k \le i} (a_k)$ 就是它下一项的 $a_i$ ，但我们的队列（同时对应平衡树）维护的是 $a_i$ ，所以应该是从当前项找到上一项的 $d$ （具体见代码的 <code>calc()</code> 函数），而排除/调用最优时要的是 $d$ ，所以要减 $1$ </li><li>本题一定要先插入再转移，原因同 $3$ ，我们维护的是 $a$ ，而转移时调用的是 $d$ ，它可能刚好是当然插入 $a$ 的前一个（另，关于队列的写法，这边建议都写成先插入再转移的）</li><li>如果你实在觉得这细节来细节去的太麻烦，可以考虑用预处理的方式实现条件 $2$ ，并明确下标，就不必管 $2 \sim 4$ 了（<del>但代码会变长</del>）</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line">LL m, d[N] ,sum;</span><br><span class="line"><span class="keyword">int</span> q[N], l, r, L;</span><br><span class="line">multiset&lt;LL&gt; s;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> d[q[x - <span class="number">1</span>]] + a[q[x]]; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %lld&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; m) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    l = L = <span class="number">1</span>, r = sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (; l &lt;= r &amp;&amp; a[i] &gt;= a[q[r]]; --r) <span class="keyword">if</span> (l &lt; r) s.<span class="built_in">erase</span>(s.<span class="built_in">find</span>(<span class="built_in">calc</span>(r)));</span><br><span class="line">        q[++r] = i;</span><br><span class="line">        <span class="keyword">if</span> (l &lt; r) s.<span class="built_in">insert</span>(<span class="built_in">calc</span>(r));</span><br><span class="line">        sum += a[i];</span><br><span class="line">        <span class="keyword">for</span> (; sum &gt; m; sum -= a[L++]); </span><br><span class="line">        <span class="keyword">for</span> (; l &lt;= r &amp;&amp; q[l] &lt; L; ++l) <span class="keyword">if</span> (l &lt; r) s.<span class="built_in">erase</span>(s.<span class="built_in">find</span>(<span class="built_in">calc</span>(l + <span class="number">1</span>)));</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= r) d[i] = d[L - <span class="number">1</span>] + a[q[l]];</span><br><span class="line">        <span class="keyword">if</span> (l &lt; r) d[i] = <span class="built_in">min</span>(d[i], *s.<span class="built_in">begin</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, d[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题五"><a href="#例题五" class="headerlink" title="例题五"></a>例题五</h2><p>下面来看一个经典问题，多重背包问题：<a href="https://www.luogu.com.cn/problem/P1782">旅行商的背包</a></p><h3 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h3><p>给定 $n \le 10^4$ 种物品，每种物品有 $d_i \le 1000$  个，体积为 $v_i \le 1000$ ，价值为 $w_i \le 1000$ ，又给定 $m \le 5$ 个特殊物品，第 $i$ 个特殊物品的价值 $y_i$ 与取走的体积 $x_i$ 满足 $y_i = a_i x_i^2 + b_i x_i + c_i$  ，其中 $\mid a_i, b_i, c_i \mid \le 1000$ ，现有一个容量为 $c \le 10^4$ 的背包，求最大价值</p><h2 id="思路-4"><a href="#思路-4" class="headerlink" title="思路"></a>思路</h2><p>由于 $m \le 5$ 很小，可以完全背包暴力做，问题就转化为多重背包的板子，用二进制拆分法的时间复杂度为 $O(n c \log d )$ 可过，但卡的有点死，实际上，用单调队列可以优化到 $O(nc)$ </p><p>先考虑原来的朴素方程： <code>f[j]</code> （题目已经有 $d$ 了，这里就用 $f$ ）表示“从前 $i$ 个物品中选体积和为 $j$ 的物品的最大价值”（ $i$ 那一维被<strong>倒序循环</strong>压缩掉了），在转移时，考虑第 $i$ 个物品选了 $cnt$ 个：<br>$$<br>f[j] = \max_{1 \le cnt \le d_i} (f[j - cnt * v_i] + cnt * w_i)<br>$$<br>考虑状态 $j$ （注意 $j$ 是状态， $cnt$ 才是决策），它的决策集合就是 $\{j - cnt * v_i \mid 1 \le cnt \le d_i \}$ ，不难发现这个集合相比状态 $j - v_i$ 的决策集合 $\{j - v_i - cnt * v_i \mid 1 \le cnt \le d_i \}$ 只变化了一个数，这启发我们把 $j$ 按照 $\mod v_i$ 的余数分组</p><p>为了简单，我们完全不必枚举 $j$ ，改为枚举余数 $u \in [0, v_i)$ ，再枚举（这里就正序了） $p = 0 \sim \lfloor \frac{c - u}{v_i} \rfloor$ ，这样就可以计算出 $j = u + p * v_i$ ，故 $j$ 的决策集合就是 $\{u + k * p_i \mid p - d_i \le k \le p - 1 \}$ ，于是方程变为：<br>$$<br>f[u + p * v_i] = \max_{p - d_i \le k \le p - 1} (f[u + k * v_i] + (p - k) * w_i)<br>$$<br>这里的 $val(p, k) = (p - k) * w_i$ 明显可以分成两部分 $p * w_i$ 和 $-k * w_i$ ，且当 $p$ 减 $1$ 时，上下界 $p - d_i, p - 1$ 都单调变化，这就是典型的单调队列优化模型，我们建立一个决策点 $k$ 递减， $f[u + k * v_i] - k * w_i$ 递减的单调队列，每次取队头跟新即可，时间复杂度 $O(nc)$ </p><h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><p>本题卡常，吸氧或者加快读可过（我懒就吸氧了）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PIL pair<span class="meta-string">&lt;int, LL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, C;</span><br><span class="line">LL f[N];</span><br><span class="line">PIL q[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;m, &amp;C);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, v, w, d, u; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;v, &amp;w, &amp;d), u = <span class="number">0</span>; u &lt; v; ++u)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>, p = <span class="number">0</span>, j; (j = p * v + u) &lt;= C; ++p)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (; l &lt;= r &amp;&amp; f[j] - w * p &gt; q[r].se; --r);</span><br><span class="line">                q[++r] = &#123;p, f[j] - w * p&#125;;</span><br><span class="line">                <span class="keyword">for</span> (; l &lt;= r &amp;&amp; q[l].fi &lt; p - d; ++l); <span class="comment">//其实这里if也行,因为每次只有一个数出队</span></span><br><span class="line">                f[j] = q[l].se + w * p;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b, c, j; i &lt;= m; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c), j = C; j; --j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= j; ++k) f[j] = <span class="built_in">max</span>(f[j], f[j - k] + (LL)(a * k + b) * k + c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[C]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="待续"><a href="#待续" class="headerlink" title="待续"></a>待续</h1><p>没想到这么长，打算分成三篇写，会挂链接的</p><p><a href="https://dyd-true.github.io/2022/02/09/%E4%BC%98%E5%8C%96dp2/#more">优化dp2</a></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> dp </tag>
            
            <tag> 倍增 </tag>
            
            <tag> 单调队列 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP7519 [省选联考 2021 A/B 卷] 滚榜</title>
      <link href="/2022/02/08/luoguP7519-%E7%9C%81%E9%80%89%E8%81%94%E8%80%83-2021-A-B-%E5%8D%B7-%E6%BB%9A%E6%A6%9C/"/>
      <url>/2022/02/08/luoguP7519-%E7%9C%81%E9%80%89%E8%81%94%E8%80%83-2021-A-B-%E5%8D%B7-%E6%BB%9A%E6%A6%9C/</url>
      
        <content type="html"><![CDATA[<p> too difficult for 蒟蒻</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P7519">滚榜</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>已知有 $n \le 13$ 个数 $a_i \le 10^4$ ，按 $1 \sim n$ 编号，每次选一个数给他加上 $b_i$ ，要保证加的 $b_i$ 不小于上次加的，且加完后该数排名第一（大小相同的比编号），已知 $\sum b_i = m \le 500$ ，求最后 $n$ 个数的排名情况有多少种</p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>看 $n \le 13$ 考虑状态压缩，设 <code>d[s][i][j][k]</code> 表示“已加的数集合为 $s$ ，上一个加的为 $i$ ，当前 $\sum b_i = j$ 且上一个 $b_i = k$ 的方案数”，有 $d[s][i][j][k] \to d[s + \{p\}][p][j + q][q]$ （满足 $a_p + q &gt; / \ge a_i + b_i, j + q &lt; m, q \ge k$ ）时间复杂度为 $O(2^n n^2 m^2)$ 呃呃……</p><p>考虑把状态的维度剪掉，当然是剪一个 $m$ （剪 $n$ 没用啊），发现我们不必要上一个 $b_i$ ，考虑用别的前几维的信息得到 $b_i$ ，发现不是很好表示</p><p>考虑预处理，首先，我们发现数 $a_i$ 要变成最大的， $b_i$ 就要比 $b_j$ 大至少 $a_j - a_i$ （假设 $j$ 先于 $i$ ），不妨设它为 $dt[i][j]$ ，计算它要用 $O(n^2)$ </p><p>其次，由于 $b$ 按出现的顺序单调不降，不妨考虑差分，设差分数组为 $c$ ，有 $b_i = \sum_{j = 1}^i c_i$  （这里假设 $b_i$ 按出现顺序排序了， $b_i$ 的 $i$ 已经不对应 $a_i$ 了），故 $\sum b_i = \sum c_i * (n - i + 1) = m$ ，所以 $c_i$ 对 $m$ 的贡献就要乘 $n - i + 1$ ，只需保证 $c_i \ge 0$ 即可，而 $c_i$ 的最小值就是 $dt[i][j]$ （ $j$ 先于 $i$ 一个）</p><p>再次定义 <code>d[s][i][j]</code> 为“已加的数集合为 $s$ ，上一个加的为 $i$ ，当前 $\sum b_i = j$ 的方案数”，设 $t = s - \{i\}$ ，有 $d[s][i][j] \gets d[t][k][j - dt[i][k] * (n - \mid A \mid)]$ ，时间为 $O(2^n n m)$ ，常数小可过</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15</span>, NN = (<span class="number">1</span> &lt;&lt; <span class="number">13</span>) + <span class="number">5</span>, M = <span class="number">500</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, nn;</span><br><span class="line">LL ans;</span><br><span class="line"><span class="keyword">int</span> a[N], dt[N][N], d[NN][N][M], si[NN]; <span class="comment">//si[s]:集合s的大小</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m), nn = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) dt[i][j] = <span class="built_in">max</span>(<span class="number">0</span>, a[j] - a[i] + (i &gt; j)), dt[i][<span class="number">0</span>] = <span class="built_in">max</span>(dt[i][j], dt[i][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nn; ++i) si[i] = si[i &gt;&gt; <span class="number">1</span>] + (i &amp; <span class="number">1</span>);</span><br><span class="line">    d[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span>, t, num; s &lt; nn; ++s)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= n; ++i) <span class="keyword">if</span> (s &gt;&gt; i - <span class="number">1</span> &amp; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> (t = s ^ <span class="number">1</span> &lt;&lt; i - <span class="number">1</span>, num = n - si[t], j = si[t] ? <span class="number">1</span> : <span class="number">0</span>; j &lt;= n; ++j) <span class="keyword">if</span> (!j || t &gt;&gt; j - <span class="number">1</span> &amp; <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = dt[i][j] * num; k &lt;= m; ++k) d[s][i][k] += d[t][j][k - dt[i][j] * num];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) ans += d[nn - <span class="number">1</span>][i][j];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4067 [SDOI2016]储能表</title>
      <link href="/2022/02/07/luoguP4067-SDOI2016-%E5%82%A8%E8%83%BD%E8%A1%A8/"/>
      <url>/2022/02/07/luoguP4067-SDOI2016-%E5%82%A8%E8%83%BD%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p> 这就是我和巨佬的差距</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4067">储能表</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p> $T \le 5000$ 组数据，每次给定 $n, m, k \le 10^{18}$ ，求：<br>$$<br>\sum_{i = 0}^{n - 1} \sum_{j = 0}^{m - 1} \max((i \oplus j) - k, 0)<br>$$<br> 答案对 $p \le 10^9$ 取模</p><h2 id="蒻蒟的挣扎"><a href="#蒻蒟的挣扎" class="headerlink" title="蒻蒟的挣扎"></a>蒻蒟的挣扎</h2><p>一看见 $5000, 10^{18}$ 吓了一跳，后来发现是数位 dp</p><p>首先原式里面一个 $\max$ 很不有好（因为它是为了保证非负），不妨考虑只管异或值大于 $k$ 的数对 $(i, j)$ ，就不用管 $\max$ 了，更具体的，我们求出“异或值大于 $k$ 的数对的个数 $A$ ”和“所以异或值大于 $k$ 的数对的异或值之和 $B$ ”，那么 $Ans = B - A * k$ </p><p>考虑分别求 $A, B$ ，定义 <code>d[0/1][i][0/1][0/1][0/1]</code> ，让 $d[0]$ 表示“<strong>从高到低</strong>到了二进制的第 $i$ 位，已经考虑的位数是/否到达 $n$ 的上界，是/否到达 $m$ 的上界，是/否到达 $k$ 的下界，此时的合法个数”， $d[1]$ 类似，但表示的是“异或值之和”</p><p>实现用记忆化搜索，慢一点点但好打的多</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">70</span>;</span><br><span class="line">LL n, m, k;</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">2</span>][N][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>], p, mxl;</span><br><span class="line"><span class="keyword">bool</span> vis[N][<span class="number">2</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> len, <span class="keyword">int</span> fn, <span class="keyword">int</span> fm, <span class="keyword">int</span> fk, <span class="keyword">int</span> &amp;as0, <span class="keyword">int</span> &amp;as1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> &amp;f = d[<span class="number">0</span>][len][fn][fm][fk], &amp;g = d[<span class="number">1</span>][len][fn][fm][fk];</span><br><span class="line">    <span class="keyword">if</span> (len &gt; mxl) <span class="keyword">return</span> as0 = <span class="number">1</span>, as1 = <span class="number">0</span>, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">if</span> (vis[len][fn][fm][fk]) <span class="keyword">return</span> as0 = f, as1 = g, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    vis[len][fn][fm][fk] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> pn = (n &gt;&gt; mxl - len) &amp; <span class="number">1</span>, pm = (m &gt;&gt; mxl - len) &amp; <span class="number">1</span>, pk = (k &gt;&gt; mxl - len) &amp; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= (fn ? pn : <span class="number">1</span>); ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, pf, pg; j &lt;= (fm ? pm : <span class="number">1</span>); ++j) <span class="keyword">if</span> (!fk || (i ^ j) &gt;= pk)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">dp</span>(len + <span class="number">1</span>, fn &amp;&amp; (i == pn), fm &amp;&amp; (j == pm), fk &amp;&amp; ((i ^ j) == pk), pf, pg);</span><br><span class="line">            f = (f + pf) % p, g = ((LL)g + (<span class="number">1ll</span> &lt;&lt; mxl - len) * (i ^ j) % p * pf + pg) % p;</span><br><span class="line">        &#125;</span><br><span class="line">    as0 = f, as1 = g;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, ct, ans[<span class="number">2</span>];</span><br><span class="line">    LL t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T); T--; <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span> vis), <span class="built_in">memset</span>(d, <span class="number">0</span>, <span class="keyword">sizeof</span> d), mxl = <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld %lld %d&quot;</span>, &amp;n, &amp;m, &amp;k, &amp;p), --n, --m;</span><br><span class="line">        <span class="keyword">for</span> (ct = <span class="number">0</span>, t = n; t; ++ct, t &gt;&gt;= <span class="number">1</span>);mxl = <span class="built_in">max</span>(mxl, ct);</span><br><span class="line">        <span class="keyword">for</span> (ct = <span class="number">0</span>, t = m; t; ++ct, t &gt;&gt;= <span class="number">1</span>);mxl = <span class="built_in">max</span>(mxl, ct);</span><br><span class="line">        <span class="keyword">for</span> (ct = <span class="number">0</span>, t = k; t; ++ct, t &gt;&gt;= <span class="number">1</span>);mxl = <span class="built_in">max</span>(mxl, ct);</span><br><span class="line">        <span class="built_in">dp</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, ans[<span class="number">0</span>], ans[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ((LL)ans[<span class="number">1</span>] - k % p * ans[<span class="number">0</span>] % p + p) % p); <span class="comment">//这里太坑了,k是LL,一定要先模一下</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="巨佬的-show-time"><a href="#巨佬的-show-time" class="headerlink" title="巨佬的 show time"></a>巨佬的 show time</h2><p>有巨佬用打表 + 模拟过了……</p><p>思路和<a href="https://www.luogu.com.cn/blog/youxiudezzy/solution-p4067">这位</a>差不多</p><h2 id="巨佬的代码"><a href="#巨佬的代码" class="headerlink" title="巨佬的代码"></a>巨佬的代码</h2><p>懒得打了，直接贴同机房巨佬的代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">ll n, m, k, p, tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> ch;</span><br><span class="line"><span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span>((ch = <span class="built_in">getchar</span>()) &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>) flag = <span class="literal">true</span>;</span><br><span class="line">x = ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= (ch = <span class="built_in">getchar</span>()) &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) x = x * <span class="number">10</span> + (ch - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (flag) x = -x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sum</span><span class="params">(ll x, ll y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &lt; <span class="number">0</span>) x = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (y &lt; <span class="number">0</span>) y = <span class="number">0</span>;</span><br><span class="line">ll res = y - x + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (res &amp; <span class="number">1</span>) <span class="keyword">return</span> (res % p) * ((x + y &gt;&gt; <span class="number">1</span>) % p) % p;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> ((res + <span class="number">1</span> &gt;&gt; <span class="number">1</span>) % p) * ((x + y) % p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getans</span><span class="params">(ll x, ll y, ll z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">max</span>(((n - <span class="number">1</span>) ^ (m - <span class="number">1</span>)) - k, tmp) % p;</span><br><span class="line"><span class="keyword">if</span> (x &lt; y) <span class="built_in">swap</span>(x, y);</span><br><span class="line">ll l =<span class="number">0</span>, t;</span><br><span class="line"><span class="keyword">while</span>((<span class="number">1ll</span> &lt;&lt; l) &lt;= x + <span class="number">1</span>) l++;</span><br><span class="line">l--;</span><br><span class="line">t = (<span class="number">1ll</span> &lt;&lt; l) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (t &lt;= y) <span class="keyword">return</span> ((t + <span class="number">1</span>) % p * <span class="built_in">sum</span>(-z, t - z) % p + (x - t + y - t) % p * <span class="built_in">sum</span>(t + <span class="number">1</span> - z, t * <span class="number">2</span> + <span class="number">1</span> - z) % p + <span class="built_in">getans</span>(x - t - <span class="number">1</span>, y - t - <span class="number">1</span>, z)) % p;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> ((y + <span class="number">1</span>) % p * <span class="built_in">sum</span>(<span class="built_in">max</span>(-z, tmp), <span class="built_in">max</span>(tmp, t - z)) % p + <span class="built_in">getans</span>(x - t - <span class="number">1</span>, y, z - t - <span class="number">1</span>)) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">read</span>(T);</span><br><span class="line"><span class="keyword">while</span>(T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(k), <span class="built_in">read</span>(p);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">getans</span>(n - <span class="number">1</span>, m - <span class="number">1</span>, k));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> 模拟 </tag>
            
            <tag> 打表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5503 [JSOI2016]灯塔</title>
      <link href="/2022/02/07/luoguP5503-JSOI2016-%E7%81%AF%E5%A1%94/"/>
      <url>/2022/02/07/luoguP5503-JSOI2016-%E7%81%AF%E5%A1%94/</url>
      
        <content type="html"><![CDATA[<p> 明明 $O(n \sqrt{n})$ 可以的……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5503">灯塔</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $n \le 10^5$ 个数 $0 \le h_i \le 10^9$ ，对于每个数求出一个最小的 $p_i$ 使得 $h_j \le h_i + p_i - \sqrt{\mid i - j \mid}$ 对任意 $h_j$ 成立</p><h2 id="正常做法"><a href="#正常做法" class="headerlink" title="正常做法"></a>正常做法</h2><p>化式子为 $h_j - h_i + \sqrt{\mid i - j \mid} \le p_i$ ，直接暴力是 $n^2$ 的，麻烦点是那个根号，考虑枚举 $k = \sqrt{\mid i - j \mid}$ ，对于枚举到的每个 $k$ ，扫描整个数列，对于当前点 $i$ ，找到满足条件的最大 $h_j$ （用 ST 表可以做到 $O(1)$ ），跟新答案，时间复杂度为 $O(n \sqrt{n})$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, D = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">namespace</span> ST</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> lg2[N], mx[N][D];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        lg2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= len; ++i) lg2[i] = lg2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) mx[i][<span class="number">0</span>] = x[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; D; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) mx[i][j] = <span class="built_in">max</span>(mx[i][j - <span class="number">1</span>], mx[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = lg2[r - l + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(mx[l][k], mx[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    STC <span class="keyword">int</span> h[N], p[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;h[i]);</span><br><span class="line">    ST::<span class="built_in">prev</span>(h, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, t = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(n)); k &lt;= t; ++k)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l, r; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            l = (k - <span class="number">1</span>) * (k - <span class="number">1</span>) + i + <span class="number">1</span>, r = <span class="built_in">min</span>(k * k + i, n);</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= r) p[i] = <span class="built_in">max</span>(p[i], ST::<span class="built_in">ask</span>(l, r) - h[i] + k);</span><br><span class="line">            l = <span class="built_in">max</span>(i - k * k, <span class="number">1</span>), r = i - (k - <span class="number">1</span>) * (k - <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= r) p[i] = <span class="built_in">max</span>(p[i], ST::<span class="built_in">ask</span>(l, r) - h[i] + k);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, p[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>蒟蒻我到这就结束了，但总有巨佬觉得时间还可以再优</p><h2 id="巨佬的时间"><a href="#巨佬的时间" class="headerlink" title="巨佬的时间"></a>巨佬的时间</h2><p>某位巨佬想出了 $O(n \log n)$ 的做法</p><p>首先去掉绝对值，只考虑 $j &lt; i$ 的情况，设 <code>d[i]</code> 表示“第 $i$ 个数对所有 $j \le i$ 满足条件的最小 $p_i$ ”，然后倒过来再做一遍即可，显然 $d[i] = \max(h_j - h_i + \sqrt{i - j})$ </p><p>然后，考虑根号，注意到这是典型的 $d[i] = \max_{j = 1}^{i - 1} (d[j] + w(j, i))$ 的形式，考虑四边形不等式，那么就要证明 $\forall a &lt; b, w(a, b + 1) + w(a + 1, b) \le w(a, b) + w(a + 1, b + 1)$ （这里因为 $\max$ 所以符号和 $\min$ 相反），对于本题来说 $\sqrt{(b + 1) - a} + \sqrt{b - (a + 1)} \ge \sqrt{b - a} + \sqrt{(b + 1) - (a + 1)}$ 即 $\sqrt{b - a + 1} + \sqrt{b - a - 1} \ge 2\sqrt{b - a}$ 设 $t = b - a$ ，我们要证明 $\sqrt{t + 1} + \sqrt{t - 1} \ge 2 \sqrt{t}$ ，两边平方即可</p><p>因此决策具有单调性，直接用队列 + 二分维护三元组即可，巨佬说因为转移顺序没有要求，所以可以分治，但是我不会，不管如何实现，时间为 $O(n \log n)$ </p><h2 id="贺的巨佬的代码"><a href="#贺的巨佬的代码" class="headerlink" title="贺的巨佬的代码"></a>贺的巨佬的代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(i, j) (h[j] + sqrt(i - j))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, h[N];</span><br><span class="line">DB p[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span> <span class="keyword">int</span> l, r, x; &#125; stk[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> <span class="comment">//找到i比j更优的最后一个点 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="built_in">max</span>(i, j), r = n, res = <span class="number">-1</span>, mid;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(mid, i) &gt;= <span class="built_in">get</span>(mid, j)) res = mid, l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    stk[l = r = <span class="number">1</span>] = &#123;<span class="number">1</span>, n ,<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; stk[l].r &lt; i) ++l;</span><br><span class="line">        p[i] = <span class="built_in">max</span>(<span class="built_in">get</span>(i, stk[l].x), p[i]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(n, i) &lt;= <span class="built_in">get</span>(n, stk[l].x)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; <span class="built_in">get</span>(stk[r].l, stk[r].x) &lt;= <span class="built_in">get</span>(stk[r].l, i)) --r;</span><br><span class="line">        stk[r].r = <span class="built_in">find</span>(stk[r].x, i), stk[++r] = &#123;stk[r - <span class="number">1</span>].r + <span class="number">1</span>, n, i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;h[i]);</span><br><span class="line">    <span class="built_in">work</span>();</span><br><span class="line">    <span class="built_in">reverse</span>(h + <span class="number">1</span>, h + <span class="number">1</span> + n), <span class="built_in">reverse</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n);</span><br><span class="line">    <span class="built_in">work</span>();</span><br><span class="line">    <span class="built_in">reverse</span>(h + <span class="number">1</span>, h + <span class="number">1</span> + n), <span class="built_in">reverse</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">max</span>((<span class="keyword">int</span>)<span class="built_in">ceil</span>(p[i]) - h[i], <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> ST表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4072 [SDOI2016]征途</title>
      <link href="/2022/02/07/luoguP4072-SDOI2016-%E5%BE%81%E9%80%94/"/>
      <url>/2022/02/07/luoguP4072-SDOI2016-%E5%BE%81%E9%80%94/</url>
      
        <content type="html"><![CDATA[<p> 被 K-D Tree 虐了一天后继续来 dp 受苦</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4072">征途</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $n$ 个数，分成 $m$ 组，使得每组之和构成的数组方差最小，输出方差 $\times m^2$ ， $n \le 3000$ </p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>考虑把方差转化推式子：<br>$$<br>\begin{aligned}<br>s^2<br>&amp; = \frac{\sum_{i = 1}^{m} (v_i - \overline{v})^2}{m} \\<br>&amp; = \frac{m (\overline{v})^2 - 2 \overline{v} \sum_{i = 1}^{m} v_i + \sum_{i = 1}^{m} v_i^2}{m} \\<br>又有:\overline{v} &amp; = \frac{\sum_{i = 1}^{m} v_i}{m} \\<br>代入得 s^2<br>&amp; = \frac{m (\frac{\sum_{i = 1}^{m} v_i}{m})^2 - 2 \frac{\sum_{i = 1}^{m} v_i}{m} \sum_{i = 1}^{m} v_i + \sum_{i = 1}^{m} v_i^2}{m} \\<br>&amp; = \frac{\frac{(\sum_{i = 1}^{m} v_i)^2}{m} - 2 \frac{(\sum_{i = 1}^{m} v_i)^2}{m}  + \sum_{i = 1}^{m} v_i^2}{m} \\<br>故 Ans<br>&amp; = s^2 \times m^2 \\<br>&amp; = m \sum_{i = 1}^{m} v_i^2 -(\sum_{i = 1}^{m} v_i)^2 \\<br>&amp; = m \sum_{i = 1}^{m} v_i^2 -(\sum_{i = 1}^{n} x_i)^2 \\<br>\end{aligned}<br>$$<br>发现减号右边的值是恒定的，现在要最小化 $\sum_{i = 1}^{m} v_i^2$ </p><p>考虑 dp ，设 <code>d[i][j]</code> 表示“把前 $i$ 个数分成 $j$ 段的最小平方和”，转移就预处理前缀和， $O(n)$ 枚举最后一段的长度，时间复杂度为 $O(n^2 m)$ ， TLE $80pts$ </p><p>观察 dp 方程： $d[i][j] = min(d[k][j - 1] + (sum[i] - sum[k])^2)$ ，考虑斜率优化，设 $t$ 比 $k$ 优，则：<br>$$<br>\begin{aligned}<br>d[t][j - 1] + (sum[i] - sum[t])^2 &amp; &lt; d[k][j - 1] + (sum[i] - sum[k])^2 \\<br>d[t][j - 1] + sum[t]^2 - d[k][j - 1] - sum[k]^2 &amp; &lt; 2 sum[i] (sum[t] - sum[k]) \\<br>\frac{(d[t][j - 1] + sum[t]^2) - (d[k][j - 1] + sum[k]^2)}{(sum[t] - sum[k])} &amp; &lt; 2 sum[i]<br>\end{aligned}<br>$$<br>换句话说，把二元组 $(sum[x], d[x][j - 1] + sum[x]^2)$ 看作平面上的点，则点 $(sum[t], d[t][j - 1] + sum[t]^2)$ 比 $(sum[k], d[k][j - 1] + sum[k]^2)$ 优的充要条件（因为以上推导显然可以反向）是两点连线（ $k \to t$ ）的斜率小于 $2 sum[i]$ ，则启发我们将式子化为：<br>$$<br>\begin{aligned}<br>(d[k][j - 1] + sum[k]^2) &amp; = (2sum[i]) \times (sum[k]) + (d[i][j] - sum[i]^2) \\<br>y &amp; = k \times x + b<br>\end{aligned}<br>$$<br>要想斜率优化，还要保证 $k, x$ <strong>单调递增</strong>，而它们都是前缀和，单调性显然，于是就可以（<del>痛苦</del>）快乐的用斜率优化，维护一个凸包，把第二维滚动压掉（只会从 $j - 1$ 到 $j$ ），以第二维为最外层循环，枚举第一维，用单调队列维护凸包，转移时直接取队头，时间复杂度为 $O(mn)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, l, r, o = <span class="number">0</span>;</span><br><span class="line">LL a[N], sum[N], d[N][<span class="number">2</span>], q[N]; </span><br><span class="line"><span class="function">DB <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (DB)((d[y][k] + sum[y] * sum[y]) - (d[x][k] + sum[x] * sum[x])) / (DB)(sum[y] - sum[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a[i]), sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) d[i][o] = sum[i] * sum[i]; <span class="comment">//这里不能初始化为0,所以先把m=1算出来</span></span><br><span class="line">    o ^= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j; i &lt;= m; ++i, o ^= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (j = i, l = r = <span class="number">1</span>, q[l] = i - <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; r &amp;&amp; <span class="built_in">get_k</span>(q[l], q[l + <span class="number">1</span>], o ^ <span class="number">1</span>) &lt; <span class="number">2</span> * sum[j]) ++l;</span><br><span class="line">            d[j][o] = d[q[l]][o ^ <span class="number">1</span>] + (sum[j] - sum[q[l]]) * (sum[j] - sum[q[l]]);</span><br><span class="line">            <span class="keyword">while</span> (l &lt; r &amp;&amp; <span class="built_in">get_k</span>(q[r - <span class="number">1</span>], q[r], o ^ <span class="number">1</span>) &gt; <span class="built_in">get_k</span>(q[r], j, o ^ <span class="number">1</span>)) --r;</span><br><span class="line">            q[++r] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, d[n][o ^ <span class="number">1</span>] * m - sum[n] * sum[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 斜率优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>K-D Tree</title>
      <link href="/2022/02/06/K-D-Tree/"/>
      <url>/2022/02/06/K-D-Tree/</url>
      
        <content type="html"><![CDATA[<p> 三维生物瑟瑟发抖</p><span id="more"></span><h1 id="K-D-Tree"><a href="#K-D-Tree" class="headerlink" title="K-D Tree"></a>K-D Tree</h1><p>K-D Tree（k-Dimension Tree，k 维树），是一种<strong>高效处理 $k$ 维空间信息</strong>的（<del>JO级生物</del>）数据结构，在节点数远大于 $2^k$ 时效率很高</p><h2 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h2><p>K-D Tree 具有二叉搜索树的形态，通过以下伪代码可以将 $n$ 个 $k$ 维的点建出一棵K-D Tree ：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function build (点集 S)</span><br><span class="line">if (S 只有一个点) return 该点</span><br><span class="line">选择一个维度 k ，选择一个切割点 a </span><br><span class="line">以点 a 的第 k 维为标准，所有第 k 维小于 a 的点归入集合 L ，其余归入 R</span><br><span class="line">以点 a 为父节点，用 L 建左子树， R 建右子树</span><br><span class="line">维护一些信息</span><br><span class="line">end function</span><br></pre></td></tr></table></figure><p>可以发现这个树的结构取决于选择的维度和切割点，我们按以下标准选择：</p><ol><li>选择的维度要满足其内部点的分布的差异度最大，即每次选择的切割维度是<strong>方差最大</strong>的维度</li><li>每次在维度上选择切割点时选择该维度上的<strong>中位数</strong>，这样可以保证每次分成的左右子树大小尽量相等</li></ol><p>可以发现这样建出的 K-D Tree 高度最大为 $O(\log n)$ </p><p>考虑建树的时间，每次找中位数时，用 <code>sort</code> 总时间是 $O(n \log^2 n)$ 的，这显然不必要，因为我们不必每次给整个序列排序，只要中位数在正确位置，且左边都小于它，右边大于它即可，在 <code>algorithm</code> 库中的  <code>nth_element()</code> 函数可以支持该操作，它的均摊复杂度为 $O(n)$ 于是建树就变了 $O(n \log n)$ </p><h2 id="插入-删除"><a href="#插入-删除" class="headerlink" title="插入/删除"></a>插入/删除</h2><p>数据结构大部分都要求支持插入和删除，但注意到 K-D Tree 具有二叉搜索树的形态，可它又不支持旋转（或者说很难支持旋转），而 FHQ Treap 的随机优先级思想也不能保证其复杂度，我们考虑用替罪羊树的重构思想</p><p>引入重构常数 $\alpha$ ，对于节点 $x$ 如果它的一个子树的结点数占比大于 $\alpha$ ，或者未删除的结点数在以 $x$ 为根的子树中的占比小于 $\alpha$ 时，我们就重构它</p><p>在插入一个点时，先根据记录的分割维度和分割点判断应该继续插入到左子树还是右子树，如果到达了空结点，新建一个结点代替这个空结点，成功插入结点后回溯插入的过程，维护结点的信息，如果发现当前的子树不平衡，则重构当前子树</p><p>在删除一个点时，先找到它，然后打上懒标记即可</p><p>类似于替罪羊树，带重构的 K-D Tree 的树高仍然是 $O(\log n)$ 的，当然，最好是把操作离线了</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P4148">简单题</a></p><p>$20 MB$ 卡掉树套树，强制在线卡了 CDQ ，于是用 K-D Tree （略微卡常）</p><p>对于修改，直接删除再插入即可，对于询问，记录子树每一维的最大和最小值，可以证明，这样查询 $k$ 维的最坏时间为 $O(n^{1 - \frac{1}{k}})$ ，对于本题，就是 $O(\sqrt{n})$ ，本题可以插入重复元素，然后就不需要删除</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span> + <span class="number">5</span>, D = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x[D], w;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">namespace</span> KDT <span class="comment">//K-D Tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> DB a = <span class="number">0.725</span>;</span><br><span class="line">    <span class="keyword">int</span> rt, top, rub[M], cur, tot; <span class="comment">//rub:回收空间</span></span><br><span class="line">    Point p[M];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> mn[D], mx[D], sum, lc, rc, si, k;</span><br><span class="line">        Point p;</span><br><span class="line">    &#125; tr[M];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mn(x) tr[(x)].mn</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mx(x) tr[(x)].mx</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[(x)].sum</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc(x) tr[(x)].lc</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc(x) tr[(x)].rc</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> si(x) tr[(x)].si</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> k(x) tr[(x)].k</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> p(x) tr[(x)].p</span></span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (top) <span class="keyword">return</span> rub[top--];</span><br><span class="line">        <span class="keyword">return</span> ++cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ls = <span class="built_in">lc</span>(u), rs = <span class="built_in">rc</span>(u);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">mn</span>(u)[i] = <span class="built_in">mx</span>(u)[i] = <span class="built_in">p</span>(u).x[i];</span><br><span class="line">            <span class="keyword">if</span> (ls) <span class="built_in">mn</span>(u)[i] = <span class="built_in">min</span>(<span class="built_in">mn</span>(u)[i], <span class="built_in">mn</span>(ls)[i]), <span class="built_in">mx</span>(u)[i] = <span class="built_in">max</span>(<span class="built_in">mx</span>(u)[i], <span class="built_in">mx</span>(ls)[i]);</span><br><span class="line">            <span class="keyword">if</span> (rs) <span class="built_in">mn</span>(u)[i] = <span class="built_in">min</span>(<span class="built_in">mn</span>(u)[i], <span class="built_in">mn</span>(rs)[i]), <span class="built_in">mx</span>(u)[i] = <span class="built_in">max</span>(<span class="built_in">mx</span>(u)[i], <span class="built_in">mx</span>(rs)[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sum</span>(u) = <span class="built_in">sum</span>(ls) + <span class="built_in">sum</span>(rs) + <span class="built_in">p</span>(u).w, <span class="built_in">si</span>(u) = <span class="built_in">si</span>(ls) + <span class="built_in">si</span>(rs) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>, u = <span class="built_in">newnode</span>();</span><br><span class="line">        <span class="built_in">nth_element</span>(p + l, p + mid, p + r + <span class="number">1</span>, [&amp;](Point a, Point b)&#123; <span class="keyword">return</span> a.x[k] &lt; b.x[k]; &#125;);</span><br><span class="line">        <span class="built_in">k</span>(u) = k, <span class="built_in">p</span>(u) = p[mid], <span class="built_in">lc</span>(u) = <span class="built_in">build</span>(l, mid - <span class="number">1</span>, k ^ <span class="number">1</span>), <span class="built_in">rc</span>(u) = <span class="built_in">build</span>(mid + <span class="number">1</span>, r, k ^ <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">up</span>(u), u;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">get_p</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!u) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="built_in">get_p</span>(<span class="built_in">lc</span>(u)), p[++tot] = <span class="built_in">p</span>(u), rub[++top] = u, <span class="built_in">get_p</span>(<span class="built_in">rc</span>(u));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> &amp;u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">si</span>(u) * a &lt; <span class="built_in">max</span>(<span class="built_in">si</span>(<span class="built_in">lc</span>(u)), <span class="built_in">si</span>(<span class="built_in">rc</span>(u)))) tot = <span class="number">0</span>, <span class="built_in">get_p</span>(u), u = <span class="built_in">build</span>(<span class="number">1</span>, tot, <span class="built_in">k</span>(u));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> &amp;u, Point x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!u)</span><br><span class="line">        &#123;</span><br><span class="line">            u = <span class="built_in">newnode</span>();</span><br><span class="line">            <span class="built_in">lc</span>(u) = <span class="built_in">rc</span>(u) = <span class="built_in">k</span>(u) = <span class="number">0</span>, <span class="built_in">p</span>(u) = x;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">up</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x.x[<span class="built_in">k</span>(u)] &lt;= <span class="built_in">p</span>(u).x[<span class="built_in">k</span>(u)]) <span class="built_in">ins</span>(<span class="built_in">lc</span>(u), x);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">ins</span>(<span class="built_in">rc</span>(u), x);</span><br><span class="line">        <span class="built_in">up</span>(u), <span class="built_in">check</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">bool</span> <span class="title">in</span><span class="params">(<span class="keyword">int</span> mx[D], <span class="keyword">int</span> mn[D], <span class="keyword">int</span> l[D], <span class="keyword">int</span> r[D])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i) <span class="keyword">if</span> (r[i] &lt; mx[i] || l[i] &gt; mn[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">bool</span> <span class="title">out</span><span class="params">(<span class="keyword">int</span> mx[D], <span class="keyword">int</span> mn[D], <span class="keyword">int</span> l[D], <span class="keyword">int</span> r[D])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i) <span class="keyword">if</span> (l[i] &gt; mx[i] || r[i] &lt; mn[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l[D], <span class="keyword">int</span> r[D])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!u || <span class="built_in">out</span>(<span class="built_in">mx</span>(u), <span class="built_in">mn</span>(u), l, r)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">in</span>(<span class="built_in">mx</span>(u), <span class="built_in">mn</span>(u), l, r)) <span class="keyword">return</span> <span class="built_in">sum</span>(u);</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">in</span>(<span class="built_in">p</span>(u).x, <span class="built_in">p</span>(u).x, l, r) ? <span class="built_in">p</span>(u).w : <span class="number">0</span>) + <span class="built_in">ask</span>(<span class="built_in">lc</span>(u), l, r) + <span class="built_in">ask</span>(<span class="built_in">rc</span>(u), l, r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> op, x[D], y[D], last = <span class="number">0</span>; <span class="built_in">read</span>(op), op != <span class="number">3</span>; )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(x[<span class="number">0</span>]), <span class="built_in">read</span>(x[<span class="number">1</span>]), <span class="built_in">read</span>(y[<span class="number">0</span>]), x[<span class="number">0</span>] ^= last, x[<span class="number">1</span>] ^= last, y[<span class="number">0</span>] ^= last;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) KDT::<span class="built_in">ins</span>(KDT::rt, &#123;x[<span class="number">0</span>], x[<span class="number">1</span>], y[<span class="number">0</span>]&#125;);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">read</span>(y[<span class="number">1</span>]), y[<span class="number">1</span>] ^= last, <span class="built_in">write</span>(last = KDT::<span class="built_in">ask</span>(KDT::rt, x, y)), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><p>个人觉得 K-D Tree 难写、跑得慢且没太大用，不建议打</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> K-D Tree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1523F Favorite Game</title>
      <link href="/2022/02/06/CF1523F-Favorite-Game/"/>
      <url>/2022/02/06/CF1523F-Favorite-Game/</url>
      
        <content type="html"><![CDATA[<p> 3300</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1523/F">Favorite Game</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>在平面直角坐标系 $xoy(\mid x, y \mid \le 10^6)$ 玩一个游戏， $0$ 时刻玩家出现在选则的点上，每秒可以走一步或者不动，有 $n \le 14$ 个传送门，初始时未激活，到达一个传送门时此传送门激活，之后可瞬移（不耗时）到这个传送门，有 $m \le 100$ 个任务要求玩家在 $t_i \le 10^9$ 时刻出现在 $(x_i, y_i)$ ，求最多可以完成几个任务</p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>明显，把传送门的状态压了，任务先按时间排序</p><p>分别考虑传送门和任务，令 <code>g[s][i]</code> 表示“传送门状态为 $s$ 完成了 $i$ 个任务，现在身处某一个传送门的最小时间”，令 <code>f[s][i]</code> 表示“传送门状态为 $s$ 刚完成了任务 $i$ 时可以完成的最大任务数”</p><p>对于每种传送门状态，预处理出它到每个地点（传送门和任务）的最短路程，分四种情况转移：</p><ul><li>传送门到传送门，直接用预处理</li><li>传送门到任务，判断可行后用预处理</li><li>任务到传送门，要么直接走要么用传送</li><li>任务到任务，要么直接走要么用传送，要判断可行</li></ul><p>时间为 $O(2^n m^2)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) (x &amp; -x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dis(a, b) (abs(a.x - b.x) + abs(a.y - b.y))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">14</span> + <span class="number">5</span>, M = <span class="number">100</span> + <span class="number">5</span>, NN = (<span class="number">1</span> &lt;&lt; <span class="number">14</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, nn, ans = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Door</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">&#125; d[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Task</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, t;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Task&amp; task) <span class="keyword">const</span> &#123; <span class="keyword">return</span> t &lt; task.t; &#125;</span><br><span class="line">&#125; ta[M];</span><br><span class="line"><span class="keyword">int</span> td[NN][N], tt[NN][M]; <span class="comment">//td:to_door,tt:to_task</span></span><br><span class="line"><span class="keyword">int</span> f[NN][M], g[NN][M], lg2[NN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m), nn = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;d[i].x, &amp;d[i].y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;ta[i].x, &amp;ta[i].y, &amp;ta[i].t);</span><br><span class="line">    <span class="built_in">sort</span>(ta + <span class="number">1</span>, ta + <span class="number">1</span> + m);</span><br><span class="line">    <span class="built_in">memset</span>(td, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> td), <span class="built_in">memset</span>(tt, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> tt);</span><br><span class="line">    lg2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= nn; ++i) lg2[i] = lg2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span>, j = <span class="built_in">lowbit</span>(s); s &lt; nn; ++s, j = <span class="built_in">lowbit</span>(s))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) td[s][i] = <span class="built_in">min</span>(td[s ^ j][i], <span class="built_in">dis</span>(d[lg2[j] + <span class="number">1</span>], d[i]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) tt[s][i] = <span class="built_in">min</span>(tt[s ^ j][i], <span class="built_in">dis</span>(d[lg2[j] + <span class="number">1</span>], ta[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0xcf</span>, <span class="keyword">sizeof</span> f), <span class="built_in">memset</span>(g, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> g);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) g[<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>)][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) f[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; nn; ++s)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="keyword">if</span> (!((s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>)) g[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][i] = <span class="built_in">min</span>(g[s][i] + td[s][j], g[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][i]); <span class="comment">//door to door</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) <span class="keyword">if</span> (g[s][i] + tt[s][j] &lt;= ta[j].t) f[s][j] = <span class="built_in">max</span>(i + <span class="number">1</span>, f[s][j]); <span class="comment">//door to task</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="keyword">if</span> (!((s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>) &amp;&amp; f[s][i] &gt; <span class="number">0</span>) g[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][f[s][i]] = <span class="built_in">min</span>(ta[i].t + <span class="built_in">min</span>(td[s][j], <span class="built_in">dis</span>(ta[i], d[j])), g[s ^ (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][f[s][i]]); <span class="comment">//task to door</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= m; ++j) <span class="keyword">if</span> (ta[i].t + <span class="built_in">min</span>(<span class="built_in">dis</span>(ta[i], ta[j]), tt[s][j]) &lt;= ta[j].t) f[s][j] = <span class="built_in">max</span>(f[s][j], f[s][i] + <span class="number">1</span>); <span class="comment">//task to task</span></span><br><span class="line">            ans = <span class="built_in">max</span>(ans, f[s][i]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1530F Bingo</title>
      <link href="/2022/02/06/CF1530F-Bingo/"/>
      <url>/2022/02/06/CF1530F-Bingo/</url>
      
        <content type="html"><![CDATA[<p> 最讨厌期望了</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1530/F">Bingo</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给 $n \times n$ 的矩阵，每个点有 $p_{i, j} \times 10^{-4}$ 的概率为 $1$ ，否则为 $0$ ，求存在某一行或者一列或者一条对角线全为 $1$ 的概率， $n \le 21$ </p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>先想暴力，设集合 $l_1, l_2, …, l_n$ 表示每一行的点集， $l_{n + 1}, …, l_{2n}$ 表示每一列的点集， $l_{2n + 1}, l_{2n + 2}$ 表示对角线，令 $P(l_i)$ 表示点集 $l_i$ 全为 $1$ 的概率， $P(\overline{l_i})$ 表示点集 $l_i$ 不全为 $1$ 的概率</p><p>明显可以用容斥 $O(2^{2n + 2})$ 暴力统计答案，但当然 TLE</p><p>先来看几条正确性显然的性质：</p><ol><li> $P(l_i) + P(\overline{l_i}) = 1$ </li><li> $P(A \wedge B) = P(B) P(A \mid B)$ ，其中 $A \mid B$ 表示在事件 $B$ 发生的条件下发生事件 $A$ </li><li> $P(\overline{A} \wedge B) + P (A \wedge B) = P(B)$ </li></ol><p>发现我们要求的就是 $P(l_1 \vee l_2 \vee … \vee l_{2n + 2}) = 1 - P(\overline{l_1} \wedge \overline{l_2} \wedge … \wedge \overline{l_{2n + 2}})$ ，然后变形：<br>$$<br>\begin{aligned}<br>&amp; P(\overline{l_1} \wedge \overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) + P(l_1 \wedge \overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) = P(\overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) &amp; (1) \\<br>&amp; P(l_1 \wedge \overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) = P(l_1) P(\overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) &amp; (2) \\<br>&amp; 由 (1) (2) 得: \\<br>&amp; P(\overline{l_1} \wedge \overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) = P(\overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) - P(l_1) P(\overline{l_2} \wedge … \wedge \overline{l_{2n + 2}}) &amp; (3) \\<br>\end{aligned}<br>$$<br>可以容斥来解释</p><p>考虑 dp ，定义 $d(i, S)$ 表示 $P(\overline{l_i} \wedge … \wedge \overline{l_{2n + 2}} \mid l_{s_1} \wedge … \wedge l_{s_k})$ ，即直线 $s \in S$ 全为 $1$ 而直线 $l_{i \sim 2n + 2}$ 不全为 $1$ 的概率，那么 $(3)$ 式可化为：<br>$$<br>\begin{aligned}<br>&amp; d(i, S) = d(i + 1, S) - d(i + 1, S \vee \{i\}) P(l_i \mid l_{s_1} \wedge … \wedge l_{s_k}) &amp; (4) \\<br>\end{aligned}<br>$$<br>观察这个式子， $P(l_i \mid l_{s_1} \wedge … \wedge l_{s_k})$ 可以 $O(n)$ 求，初始化为 $d(2n + 3, S) = 1$ ，答案就是 $1 - d(1, 0)$ ，时间为 $O(n \times (2n + 2) \times 2^{2n + 2})$ ，这不爆炸，还不如暴力</p><p>看来还得加点容斥，我们暴力枚举行的情况，有 $2^n$ 种（要么 $l_i$ 要么 $\overline{l_i}$ ），然后考虑列（下面的 $i$ 就只代表列了）， $(4)$ 式可化为：<br>$$<br>\begin{aligned}<br>&amp; d(i, S) = d(i + 1, S) - d(i + 1, S) P(l_i \mid l_{s_1} \wedge … \wedge l_{s_k}) \\<br>\end{aligned}<br>$$<br>这是因为我们现在只考虑列，把当前列加入 $S$ 对后面的列没有影响，所有可以干脆不加，则 $S$ 中始终只有我们枚举出的行（要注意此时求出的 $d$ 已经不一样了，因为行我们是枚举的，其概率还没加到 $d$ 中），这样，在枚举了行后，列可以 $O(n^2)$ 计算，这里有一个 $n$ 是求 $P(l_i \mid l_{s_1} \wedge … \wedge l_{s_k})$ 的，这可以预处理成 $O(1)$ ，具体地，设 $mul(i, S)$ 表示“对于第 $i$ 列，行选则情况为 $S$ 的时候，这些行与第 $i$ 列的相交的格子的乘积”，且设 $U$ 为行集合的全集，则有：<br>$$<br>\begin{aligned}<br>&amp; d(i, S) = d(i + 1, S) - d(i + 1, S) \times mul(i, U - S) \\<br>\end{aligned}<br>$$<br>但上面说了，时求出的 $d$ 已经不一样了，为了加上行选择的情况的概率，还要乘一个 $mul(i, S)$ ，同时，发现第一维完全可以省略，即：<br>$$<br>\begin{aligned}<br>&amp; d(S) = (d(S) - d(S) \times mul(i, U - S)) \times nul(i, S) \\<br>&amp; d(S) = (1 - mul(i, U - S)) \times mul(i, S) \times d(S) &amp; (5) \\<br>\end{aligned}<br>$$<br>这样，列的 dp 就是 $O(n)$ 的了</p><p>然后我们再明确一下行的影响，行是枚举的，计算时要用容斥，就是： $1 - d(至少 1 行全为 1) + d(至少 2 行全为 1) - …$ ， dp 贡献时加个系数即可</p><p>最后考虑一下对角线，由于只有两条，可以和行一样枚举它们的情况，把它当成一种特殊的行（具体见代码）</p><p>考虑时间，枚举容斥是 $O(2^{n + 2})$ ， dp 是 $O(n)$ 的，最后就是 $O(n 2^{n + 2})$ </p><p>ps：模数 $31607$ 是质数， $10^4$ 在其意义下的逆元为 $3973$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; -(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">21</span> + <span class="number">5</span>, P = <span class="number">31607</span>, INV = <span class="number">3973</span>, NN = (<span class="number">1</span> &lt;&lt; <span class="number">21</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, nn, p[N][N], ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> lg2[NN], mul[N][NN];</span><br><span class="line"><span class="keyword">int</span> d[NN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lg2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= nn; ++i) lg2[i] = lg2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, s, j; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (mul[i][<span class="number">0</span>] = <span class="number">1</span>, s = <span class="number">1</span>; s &lt; nn; ++s) mul[i][s] = (LL)mul[i][s ^ (j = <span class="built_in">lowbit</span>(s))] * p[lg2[j] + <span class="number">1</span>][i]% P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cntbit</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res; </span><br><span class="line">    <span class="keyword">for</span> (res = <span class="number">1</span>; x; x &amp;= (x - <span class="number">1</span>), ++res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), nn = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;p[i][j]), p[i][j] = (LL)p[i][j] * INV % P;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt;= <span class="number">3</span>; ++t) <span class="comment">//t枚举对角线的情况</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; nn; ++s) d[s] = (<span class="built_in">cntbit</span>(s) + <span class="built_in">cntbit</span>(t)) &amp; <span class="number">1</span> ? <span class="number">-1</span> : <span class="number">1</span>; <span class="comment">//容斥系数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>, _s; s &lt; nn; ++s)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//加上对角线</span></span><br><span class="line">                _s = s;</span><br><span class="line">                <span class="keyword">if</span> (t &amp; <span class="number">1</span>) _s |= <span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (t &amp; <span class="number">2</span>) _s |= <span class="number">1</span> &lt;&lt; (n - i);</span><br><span class="line">                d[s] = (LL)d[s] * mul[i][_s] % P * (<span class="number">1</span> - mul[i][(nn - <span class="number">1</span>) ^ _s] + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">0</span>; s &lt; nn; ++s) ans = (ans + d[s]) % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="number">1</span> - ans + P) % P);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> CF </tag>
            
            <tag> 容斥 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1584F Strange LCS</title>
      <link href="/2022/02/06/CF1584F-Strange-LCS/"/>
      <url>/2022/02/06/CF1584F-Strange-LCS/</url>
      
        <content type="html"><![CDATA[<p> CF来到2600</p><span id="more"></span><p> <a href="https://codeforces.com/problemset/problem/1584/F">Strange LCS</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>$T \le 5$ 组数据，给定 $n \le 10$ 个字符串，字符集为大、小写字母且每个字符在同一个串中最多出现两次，求它们的LCS（最长公共子串）</p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>暴力做法就类似两个串的LCS，直接 $10$ 维dp，时间……</p><p>发现有信息没用：字符集为大、小写字母且<strong>每个字符在同一个串中最多出现两次</strong></p><p>先考虑如果每个字符只出现一次怎么办，由于字符集不大，可以考虑设计状态为 <code>d[ch]</code> 表示“以**字符 $ch$ **结尾的前缀子串的LCS”，方程明显为 $d[i] = \max(d[j]) + 1$  ，这里要保证在所有串中字符 $j$ 都在字符 $i$ 的前面，关于字符的位置可以预处理</p><p>现在，字符出现了两次，当然可以延续上面的做法，预处理字符的位置，把状态设计为“以字符 $ch$ 结尾的前缀子串的LCS”，但同时我们必须知道这个字符在每个串中是第几次出现，考虑状压，用一个二进制数 $s$ 表示在每个串中是第几次出现，则状态 <code>d[ch][s]</code> 表示“以字符 $ch$ 在第 $i$ 个串中第 $k_i$ 次出现结尾的前缀子串的LCS”，其中 $k_i$  是 $s$ 中压缩的信息， $k_i = 0 / 1$  表示第 $1 / 2$ 次出现</p><p>转移的时候有个贪心：可以从 $k_i = 1$ 转移就不必从 $k_i = 0$ 转移，因为第 $2$ 次出现一定在第 $1$ 次后面，以它结尾的前缀子串一定包含了第 $1$ 次，所以转移时，设当前转移为 $d[ch][s] \gets d[j][t]$ ，直线枚举字符 $j$ ，若在串 $i$ 中字符 $ch$ 前有两个 $j$ 就从 $k_i = 1$ 转移，有一个就从 $k_i = 0$ 转移，换句话说，我们在枚举 $j$ 时就确定了 $t$ </p><p>考虑时间，设字符集大小为 $V$ 状态有 $V \times 2^n$ 个，每次转移要枚举字符 $j$ 并 $O(n)$ 得到 $t$ ，故时间为 $O(V \times 2^n \times V \times n) = O(V^2 2^n n)$ </p><p>由于判断较多，具体实现可以考虑记忆化搜索</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>稍微压了压行</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10</span> + <span class="number">5</span>, NN = (<span class="number">1</span> &lt;&lt; <span class="number">10</span>) + <span class="number">5</span>, V = <span class="number">52</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, pos[N][V][<span class="number">2</span>], d[V][NN], fr1[V][NN], fr2[V][NN]; <span class="comment">//fr记录来向</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> ch, <span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d[ch][s] != <span class="number">-1</span>) <span class="keyword">return</span> d[ch][s];</span><br><span class="line">    <span class="keyword">int</span> mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j, t; i &lt; V; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span>, t = <span class="number">0</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="keyword">if</span> (pos[j][i][<span class="number">0</span>] &gt;= pos[j][ch][(s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>]) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (pos[j][i][<span class="number">1</span>] &lt; pos[j][ch][(s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>]) t |= <span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (j &gt; n &amp;&amp; <span class="built_in">dp</span>(i, t) &gt;= mx) mx = d[i][t] + <span class="number">1</span>, fr1[ch][s] = i, fr2[ch][s] = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d[ch][s] = mx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(<span class="keyword">int</span> id1, <span class="keyword">int</span> id2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fr1[id1][id2] != <span class="number">-1</span>) <span class="built_in">out</span>(fr1[id1][id2], fr2[id1][id2]);</span><br><span class="line">    <span class="keyword">if</span> (id1 &lt; <span class="number">26</span>) <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, id1 + <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, id1 + <span class="string">&#x27;A&#x27;</span> - <span class="number">26</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, mx, mxid1, mxid2;</span><br><span class="line">    STC <span class="keyword">char</span> s[V &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        mx = <span class="number">0</span>, mxid1 = mxid2 = <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">//这里要是极大</span></span><br><span class="line">        <span class="built_in">memset</span>(pos, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> pos), <span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span> d), <span class="built_in">memset</span>(fr1, <span class="number">-1</span>, <span class="keyword">sizeof</span> fr1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j, len; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>), j = <span class="number">1</span>, len = <span class="built_in">strlen</span>(s + <span class="number">1</span>); j &lt;= len; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[j] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; s[j] &lt;= <span class="string">&#x27;z&#x27;</span>) s[j] -= <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                <span class="keyword">else</span> s[j] += <span class="number">26</span> - <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (pos[i][s[j]][<span class="number">0</span>] &gt;= INF) pos[i][s[j]][<span class="number">0</span>] = j;</span><br><span class="line">                <span class="keyword">else</span> pos[i][s[j]][<span class="number">1</span>] = j;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j, t; i &lt; V; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span>, t = <span class="number">0</span>; j &lt;= n; ++j)</span><br><span class="line">                <span class="keyword">if</span> (pos[j][i][<span class="number">0</span>] &gt;= INF) <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (pos[j][i][<span class="number">1</span>] &lt; INF) t |= <span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (j &gt; n &amp;&amp; <span class="built_in">dp</span>(i, t) &gt;= mx) mx = d[i][t] + <span class="number">1</span>, mxid1 = i, mxid2 = t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, mx);</span><br><span class="line">        <span class="keyword">if</span> (mxid1 != <span class="number">-1</span>) <span class="built_in">out</span>(mxid1, mxid2);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguAT2390 [AGC016F] Games on DAG</title>
      <link href="/2022/02/06/luoguAT2390-AGC016F-Games-on-DAG/"/>
      <url>/2022/02/06/luoguAT2390-AGC016F-Games-on-DAG/</url>
      
        <content type="html"><![CDATA[<p> 万能的高橋君</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/AT2390">Games on DAG</a></p><p>明显的博弈论，考虑 SG 函数，结论是当初始局面的 SG 为 $0$ 时先手必败，而初始局面的 $SG = SG(1) \oplus SG(2)$ </p><p>于是考虑计算 $SG(1) = SG(2)$ 的方案数，最后减掉，由于 $n \le 15$ ，可以枚举点集 $S$ ，设 $T$ 是 $S$ 的子集且 $\forall x \in T, SG(x) \ne 0$ （即 $T$ 为必胜点），设 $U = S - T$ （即 $U$ 为必败点， $SG = 0$ ），对于记当前点集 $S$ 满足 $SG(1) = SG(2)$ 的方案数为 $d[S]$ </p><p>由于 SG 函数定义在 mex 上，有：</p><ul><li> $U$ 中的点间互相不连边</li><li> $T$ 中的每个点至少有一条边连向 $U$ </li><li> $U$ 中的点连向 $T$ 是没有限制的</li></ul><p>那么怎么转移呢？考虑 $S$ 的连边方案， $U$ 中的点间没边， $U, T$ 间连边的方案数设为 $tmp$ 可以算，对于 $T$ 间的边，不难发现方案数就是 $d[T]$ （这是因为原来 $d[T]$ 上的每个点都向 $U$ 连边，构成的方案一定合法；而所有点集 $S$ 的合法方案去掉 SG 为 $0$ 的点后也一定会得到一个点集 $T$ 的合法方案），故有 $d[S] \gets d[T] * tmp$  </p><p> 还有一个小知识点：统计一个数的二进制中有多少个 $1$ </p><p>直接统计当然是 $\log n$ 的，但还有一个小技巧，就是每次让 <code>n = n &amp; (n - 1)</code> 不难发现这样操作 $1$ 次后 $n$ 二进制下最低的一个 $1$ 变成了 $0$ ，于是时间为 $O(k)$ ，其中 $k$ 是二进制下 $1$ 的个数</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(x, o) (((x) &gt;&gt; (o - 1)) &amp; 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>, M = <span class="number">15</span> * <span class="number">7</span> + <span class="number">5</span>,  NN = (<span class="number">1</span> &lt;&lt; <span class="number">15</span>) + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">countbit</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res;</span><br><span class="line">    <span class="keyword">for</span> (res = <span class="number">0</span>; x; x &amp;= (x - <span class="number">1</span>), ++res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, nn;</span><br><span class="line">    STC <span class="keyword">int</span> e[N], d[NN], pow2[M];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    nn = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">    d[<span class="number">0</span>] = pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) <span class="comment">//预处理2^i</span></span><br><span class="line">        pow2[i] = (pow2[i - <span class="number">1</span>] &lt;&lt; <span class="number">1</span>) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v), e[u] |= (<span class="number">1</span> &lt;&lt; (v - <span class="number">1</span>)); </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span>, tmp; s &lt; nn; ++s)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(s, <span class="number">1</span>) == <span class="built_in">get</span>(s, <span class="number">2</span>)) <span class="comment">//保证1和2的点的状态相同</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> u = s; u; u = s &amp; (u - <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">get</span>(u, <span class="number">1</span>) == <span class="built_in">get</span>(u, <span class="number">2</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    tmp = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">get</span>(s, i))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> (<span class="built_in">get</span>(u, i))</span><br><span class="line">                                tmp = (LL)tmp * pow2[<span class="built_in">countbit</span>(e[i] &amp; (s ^ u))] % P;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                tmp = (LL)tmp * (pow2[<span class="built_in">countbit</span>(e[i] &amp; u)] - <span class="number">1</span>) % P;</span><br><span class="line">                        &#125;</span><br><span class="line">                    d[s] = (d[s] + (LL)d[s ^ u] * tmp % P) % P;</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (pow2[m] - d[nn - <span class="number">1</span>] + P) % P);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> AtCoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5243 [USACO19FEB]Moorio Kart P</title>
      <link href="/2022/02/05/luoguP5243-USACO19FEB-Moorio-Kart-P/"/>
      <url>/2022/02/05/luoguP5243-USACO19FEB-Moorio-Kart-P/</url>
      
        <content type="html"><![CDATA[<p> 过年玩疯了，来做个题</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5243">Moorio Kart P</a></p><h2 id="简化题意"><a href="#简化题意" class="headerlink" title="简化题意"></a>简化题意</h2><p>给 $n$ 个点 $m$ 条边的森林，边有权，设有 $k$ 棵树，现在要添加 $k$ 条权为 $x$ 的边，使图上形成一个权值和大于 $y$ 的环，且原森林中的每棵树在该环上<strong>至少</strong>有一条边，求方案数，对 $10^9 + 7$ 取模， $n \le 1500, m \le n - 1, x, y \le 2500$ </p><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>由于树上两点间有唯一路径，所以考虑统计出每棵树上所以的路径，然后就转化成了背包</p><p>设 <code>d[i][0/1]</code> 表示“构成权值和为 $i$ 的环的方案数/长度和”， <code>g[i][0/1]</code> 表示“当前小树内长度为 $i$ 的路径数/长度和”，有：<br>$$<br>\begin{aligned}<br>&amp; d[i + j][0] \gets d[i][0] * g[j][0] \\<br>&amp; d[i + j][1] \gets d[i][0] * g[j][1] + d[i][1] * g[j][0]<br>\end{aligned}<br>$$<br>直接dp，时间为……我也不造？卡卡能过</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1500</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>, V = <span class="number">2500</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, X, Y;</span><br><span class="line"><span class="keyword">int</span> fa[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Egde</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>, bel[N];</span><br><span class="line"><span class="keyword">int</span> g[N][V][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> d[V][<span class="number">2</span>], last[V][<span class="number">2</span>];</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dfscol</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> ff, <span class="keyword">int</span> col)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    bel[x] = col;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">        <span class="keyword">if</span> (e[i].ver != ff)</span><br><span class="line">            <span class="built_in">dfscol</span>(e[i].ver, x, col);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dfslen</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> ff, <span class="keyword">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ff != <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        g[bel[x]][<span class="built_in">min</span>(Y, l)][<span class="number">1</span>] += l;</span><br><span class="line">        g[bel[x]][<span class="built_in">min</span>(Y, l)][<span class="number">1</span>] %= P;</span><br><span class="line">        ++g[bel[x]][<span class="built_in">min</span>(Y, l)][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">        <span class="keyword">if</span> (e[i].ver != ff)</span><br><span class="line">            <span class="built_in">dfslen</span>(e[i].ver, x, l + e[i].w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">fac</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x; ++i)</span><br><span class="line">        res = (LL)res * i % P;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m), <span class="built_in">read</span>(X), <span class="built_in">read</span>(Y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        fa[i] = i, h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(u), <span class="built_in">read</span>(v), <span class="built_in">read</span>(w);</span><br><span class="line">        <span class="built_in">add</span>(u, v, w), <span class="built_in">add</span>(v, u, w);</span><br><span class="line">        fa[<span class="built_in">find</span>(u)] = <span class="built_in">find</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(i) == i)</span><br><span class="line">            ++cnt, <span class="built_in">dfscol</span>(i, <span class="number">-1</span>, cnt);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">dfslen</span>(i, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> st = <span class="built_in">min</span>(X * cnt, Y);</span><br><span class="line">    d[st][<span class="number">0</span>] = <span class="number">1</span>, d[st][<span class="number">1</span>] = X * cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = st; j &lt;= Y; ++j)</span><br><span class="line">            last[j][<span class="number">0</span>] = d[j][<span class="number">0</span>], last[j][<span class="number">1</span>] = d[j][<span class="number">1</span>], d[j][<span class="number">0</span>] = d[j][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= Y; ++j)</span><br><span class="line">            <span class="keyword">if</span> (g[i][j][<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = st; k &lt;= Y; ++k)</span><br><span class="line">                    <span class="keyword">if</span> (last[k][<span class="number">0</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        d[<span class="built_in">min</span>(j + k, Y)][<span class="number">0</span>] = (d[<span class="built_in">min</span>(j + k, Y)][<span class="number">0</span>] + (LL)last[k][<span class="number">0</span>] * g[i][j][<span class="number">0</span>]) % P;</span><br><span class="line">                        d[<span class="built_in">min</span>(j + k, Y)][<span class="number">1</span>] = (d[<span class="built_in">min</span>(j + k, Y)][<span class="number">1</span>] + (LL)last[k][<span class="number">0</span>] * g[i][j][<span class="number">1</span>] + (LL)last[k][<span class="number">1</span>] * g[i][j][<span class="number">0</span>]) % P;</span><br><span class="line">                    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, (LL)d[Y][<span class="number">1</span>] * <span class="built_in">fac</span>(cnt - <span class="number">1</span>) % P * ((P + <span class="number">1</span>) / <span class="number">2</span>) % P);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> USACO </tag>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gcd</title>
      <link href="/2022/02/05/gcd/"/>
      <url>/2022/02/05/gcd/</url>
      
        <content type="html"><![CDATA[<p> 黑科技？</p><span id="more"></span><h1 id="gcd"><a href="#gcd" class="headerlink" title="gcd"></a>gcd</h1><h2 id="辗转相除法"><a href="#辗转相除法" class="headerlink" title="辗转相除法"></a>辗转相除法</h2><p>求 $2$ 个数的gcd时间为 $O(\log{\frac{\min(a, b)}{\gcd(a, b)}})$ </p><p>求 $n$ 个数的gcd时间为 $O(n + \log V)$ </p><h2 id="高精-取模"><a href="#高精-取模" class="headerlink" title="高精+取模"></a>高精+取模</h2><ol><li>若 $2 \mid a \wedge 2 \mid b$ ，则 $\gcd(a, b) = 2 \gcd(\frac{a}{2}, \frac{b}{2})$ </li><li>若 $2 \mid a \wedge 2 \not\mid b(2 \not\mid a \wedge 2 \mid b)$ ，则 $\gcd(a, b) = \gcd(\frac{a}{2}, b)$ </li><li> 若 $2 \not\mid a \wedge 2 \not\mid b$ ，则 $\gcd(a, b) = \gcd(a - b, b)$ </li></ol><p>不难发现时间为 $O(\log n)$ </p><h2 id="正题：预处理法"><a href="#正题：预处理法" class="headerlink" title="正题：预处理法"></a>正题：预处理法</h2><p>$O(n)$ 预处理， $O(1)$ 查询小于等于 $n$ 的gcd</p><h3 id="引理"><a href="#引理" class="headerlink" title="引理"></a>引理</h3><p>对于任意数 $n$ 存在分解 $n = abc$ 满足 $a, b, c$ 要么是质数，要么 $\le \sqrt{n}$ </p><p>证明：</p><ol><li>若 $n$ 存在一个 $&gt; \sqrt{n}$ 的质因数，显然成立</li><li>若 $n$ 的质因数全都 $\le \sqrt{n}$ ，取出 $n$ 的最小质因数 $p$ ：<ul><li>若 $p &gt; \sqrt[4]{n}$ ，显然 $n$ 的其它质因数也 $&gt; \sqrt[4]{n}$ ，那么只要把 $n$ 分解质数即可（ $n$ 决不会有大于 $3$ 个质因数）</li><li>否则我们求出  $\frac{n}{p}$ 的分解 $a’, b’, c’$ ，设其中最小的是 $a’$ （明显它 $\le \sqrt[3]{\frac{n}{p}}$ ），可得 $a’p \le \sqrt[3]{\frac{n}{p}} p = \sqrt[3]{np^2} \le \sqrt[3]{n \sqrt{n}} = \sqrt{n}$ ，则 $n$ 的分解为 $a’p, b’, c’$ </li></ul></li></ol><p>证明同时也给出了分解的求法</p><h3 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h3><p>求出 $\le \sqrt{n}$ 的所有数的两两的gcd，具体的， <code>g[a][b] = g[b][a % b]</code> ，可以做到 $O((\sqrt{n})^2) = O(n)$ </p><p>还要求出所有数的分解，这可以先线性筛，然后用证明的方法求</p><h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p>设求 $x = abc, y$ 的gcd，可以把 $a, b, c$ 和 $y$ 合并，以 $a$ 为例：</p><ol><li>若 $a &gt; \sqrt{n}$  ，则 $a$ 为质数，去 $2$ </li><li>若 $a$ 为质数，判 <code>y % a</code> 即可</li><li>否则， $\gcd(y, a) = \gcd(y \mod a, a)$ 直接调用预处理</li></ol><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://darkbzoj.tk/problem/4454">C Language Practice</a></p><p>然而因为卡空间，这份代码并不能过（要把 <code>fen</code> 的下标改成从 $0$  开始）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2000</span> + <span class="number">5</span>, V = <span class="number">1000000</span> + <span class="number">5</span>, W = <span class="number">1000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> g[W][W], fen[V][<span class="number">4</span>];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; pri;</span><br><span class="line"><span class="keyword">int</span> num[V];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; W; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j)</span><br><span class="line">            g[i][j] = g[j][i] = ((i &amp;&amp; j) ? g[j][i % j] : (i | j));</span><br><span class="line">    num[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; V; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!num[i])</span><br><span class="line">            pri.<span class="built_in">push_back</span>(i), num[i] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j : pri)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; num[i] || j * i &gt;= V)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            num[i * j] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fen[<span class="number">1</span>][<span class="number">1</span>] = fen[<span class="number">1</span>][<span class="number">2</span>] = fen[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; V; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        fen[i][<span class="number">1</span>] = fen[i / num[i]][<span class="number">1</span>];</span><br><span class="line">        fen[i][<span class="number">2</span>] = fen[i / num[i]][<span class="number">2</span>];</span><br><span class="line">        fen[i][<span class="number">3</span>] = fen[i / num[i]][<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span> (fen[i][<span class="number">1</span>] * num[i] &lt; W)</span><br><span class="line">            fen[i][<span class="number">1</span>] *= num[i];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (fen[i][<span class="number">2</span>] * num[i] &lt; W)</span><br><span class="line">            fen[i][<span class="number">2</span>] *= num[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            fen[i][<span class="number">3</span>] *= num[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> _gcd(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; W &amp;&amp; y &lt; W)</span><br><span class="line">        <span class="keyword">return</span> g[x][y];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!x || !y)</span><br><span class="line">        <span class="keyword">return</span> x | y;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= <span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (fen[x][i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> ((t = fen[x][i]) == num[t])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y % t == <span class="number">0</span>)</span><br><span class="line">                y /= t, res *= t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            t = g[t][y % t], y /= t, res *= t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="keyword">int</span> T, n, m;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> ans;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">                ans += _gcd(a[i], b[j]) ^ (i - <span class="number">1</span>) ^ (j - <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%u\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>松氏基排</title>
      <link href="/2022/01/26/%E6%9D%BE%E6%B0%8F%E5%9F%BA%E6%8E%92/"/>
      <url>/2022/01/26/%E6%9D%BE%E6%B0%8F%E5%9F%BA%E6%8E%92/</url>
      
        <content type="html"><![CDATA[<p> 递归式学习3</p><span id="more"></span><h1 id="松氏基排"><a href="#松氏基排" class="headerlink" title="松氏基排"></a>松氏基排</h1><h2 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h2><p>基数排序（Radix sort）是一种非比较型的排序算法，它的工作原理是将待排序的元素拆分为 $k$ 个关键字（比较两个元素时，先比较第一关键字，如果相同再比较第二关键字……），然后先对第 $k$ 关键字进行稳定排序，再对第 $k - 1$ 关键字进行稳定排序，再对第 $k - 2$ 关键字进行稳定排序……最后对第一关键字进行稳定排序，这样就完成了对整个待排序序列的稳定排序</p><p><img src="https://s2.loli.net/2022/01/26/FDZeXLCouKpSnWq.png" alt="radix sort"></p><p>如图，要对这些数字排序，我们以百位为第一关键字，十位为第二关键字，个位为第三关键字</p><p>先用第三关键字（个位）稳定排序，再用十位、百位，最后就得出答案</p><p>基数排序需要借助一种<strong>稳定算法</strong>完成内层对关键字的排序，一般是桶排</p><p>当然，一般来说可不会以 $10$ 为基数，因为这样一个 <code>int</code> 要排 $9$ 遍，太麻烦</p><h2 id="松式基排"><a href="#松式基排" class="headerlink" title="松式基排"></a>松式基排</h2><p>那基数取多少好呢？</p><p>一般基排取的是 $65536$ （ $2^{16}$ ），空间开的下，只用排两遍</p><p>可wys大佬说，取 $256$ ，用位运算把一个数拆成四部分，要排四遍，但这样的话 <code>cnt</code> 数组刚好能装进 $L1$ 高速缓存（我也不知道那是啥）</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> geted(x, d) (((x) &gt;&gt; ((d) * Bit)) &amp; (R - 1))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Bit = <span class="number">8</span>, R = <span class="number">256</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">radix_sort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> cnt[R], t[N];</span><br><span class="line">    <span class="keyword">int</span> *x = a, *y = t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">0</span>; d &lt; <span class="number">4</span>; ++d)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; ++i)</span><br><span class="line">            cnt[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            ++cnt[<span class="built_in">geted</span>(x[i], d)];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; R; ++i)</span><br><span class="line">            cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">            y[--cnt[<span class="built_in">geted</span>(x[i], d)]] = x[i];</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        a[i] = x[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">radix_sort</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 排序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jarvis步进法</title>
      <link href="/2022/01/26/jarvis%E6%AD%A5%E8%BF%9B%E6%B3%95/"/>
      <url>/2022/01/26/jarvis%E6%AD%A5%E8%BF%9B%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p> 递归式学习2</p><span id="more"></span><h1 id="jarvis步进法"><a href="#jarvis步进法" class="headerlink" title="jarvis步进法"></a>jarvis步进法</h1><p>又名卷包裹法，是一种求凸包的算法，时间为 $O(n H)$ （ $H$ 为凸包上的点数）</p><p>一般来说很不常用，但总有些毒瘤要考</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>卷包裹就行了，从左下角（一定在凸包内的点）开始，想象一条线，线的一端固定在当前点上，把线竖直向凸包外拉使其绷紧（此时线上只有左下角的点），再逆时针旋转直到碰到一个点，这个点就是新的当前点，一直下去直到线包裹整个图形</p><p>代码就咕了，反正也几乎用不到，我要回溯了</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 凸包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闵可夫斯基和</title>
      <link href="/2022/01/26/%E9%97%B5%E5%8F%AF%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%92%8C/"/>
      <url>/2022/01/26/%E9%97%B5%E5%8F%AF%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<p> 递归式学习</p><span id="more"></span><h1 id="闵可夫斯基和"><a href="#闵可夫斯基和" class="headerlink" title="闵可夫斯基和"></a>闵可夫斯基和</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>比较严谨的定义：两个图形 $A, B$ 的闵可夫斯基和 $C = \{a + b |a \in A, b \in B \}$ </p><p>我的李姐：对于图形 $A$ 中每个点和图形 $B$ 中每个点两两求和（ $(x_a, y_a) + (x_b, y_b) = (x_a + x_b, y_a + y_b)$ ）</p><p>盗张图：<img src="https://s2.loli.net/2022/01/26/LEFlZoq7YCzudve.png" alt="闵可夫斯基和"></p><p>粉色区域是三角形和一个不规则四边形的闵可夫斯基和</p><h2 id="有啥用"><a href="#有啥用" class="headerlink" title="有啥用"></a>有啥用</h2><p>当然说有用我才来递归式学习的了</p><p>一般用在求凸包上，就以我学这个东西的目的为例吧（顺便说说凸包有啥用）</p><p>比如，我们维护了区间和，区间最大后缀和，区间最大前缀和，区间最大子段和分别取名叫 $sum, lmx, rmx, mx$ </p><p>现在我们要区间加 $k$ ，怎么维护？最简单的是 $sum$  就不管了</p><p>较难的是 $lmx, rmx$ ，以 $rmx$ 为例（注意它是区间最大<strong>前缀和</strong>，取名为 $r$ 只是因为它在右子树），我们要维护函数 $y = pre(x) + k * x$ 的最大值，其中 $pre(x)$  代表 $[l, x]$ 的和（前缀和）；考虑斜率优化，我们将函数化为 $pre(x) = kx + y$ ，就是把 $(x, pre(x))$ 看做是一个个点，把斜率为 $k$ 的直线带入这一个个点中，最大化截距，不难发现这就是在凸包上二分切点，因为此时凸包中的所有点都在直线的一侧，自然是在直线上的点代进去之后截距最大</p><p>而最毒瘤的就是 $mx$ 了，仿造上面，写出式子： $y = as(x) + k * x$ ，其中 $as(x)$ 代表长度为 $x$ 的最大子段和，但是，求出 $as(x)$ 是 $n^2$ 的，有救吗？有救</p><p>考虑分治，我们关心的就是 $(x, as(x))$ 这个点集构成的凸包，不妨来看看 $mx$ 的推导式（在线段树上用过无数次的那个）： <code>mx[l][r] = max(mx[l][mid], mx[mid + 1][r], lmx[l][mid] + r[mid + 1][r])</code> ，发现前两个可以直接递归求 $[l, mid]$ 和 $[mid + 1, r]$ 的凸包解决，麻烦的是最后那个求和的式子，不难发现它代表的是“跨过 $mid$ 的区间”</p><p>考虑我们要求的是什么，是 $(x, as(x))$ 的凸包，将，每个跨过 $mid$ 的区间化作一个点 $(x, y)$ ， $x$ 代表区间长度， $y$  代表区间和，就是求这个点集（设为 $C$ ）的凸包</p><p>点集大小是 $O(n^2)$ 的，当然不能直接求，设点集 $A = \{(x, y) | x \in [l, mid], y = suf(x)\}$ ，其中 $suf(x)$ 表示区间 $[l, mid]$  的后缀和；再设 $B = \{(x, y) | x \in [mid + 1, r], y = pre(x)\}$ ，其中 $pre(x)$ 表示区间 $[mid + 1, r]$  的前缀和；那么， $C = \{(x, y) | x = x_A + x_B, y = y_A + y_B\}$ ，这就是闵可夫斯基和呀</p><p>而用闵可夫斯基和，我们可以 $O(n)$  归并出点集 $C$  的凸包</p><h2 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h2><p>那怎么合并呢？再看图（回去翻那张）</p><p>我们（<del>baidu得</del>）发现发现新的凸包就是原来的两个凸包的边重新极角排序一边，证明？咕咕咕</p><p>于是我们得到了一个很有用的结论，求凸包只需要求原来的凸包，然后在一起重新排序就可以了。</p><p>但直接重排有点浪费，由于原来两个凸包都已经求好了，于是可以类似归并排序，重新归并一次</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>例题就不讲了，我要回溯去递归下一条路径了（dfs式学习，艹）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LL x, y;</span><br><span class="line">    <span class="comment">//friend老香了</span></span><br><span class="line">    IL FR Point <span class="keyword">operator</span> + (Point x, Point y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x.x + y.x, x.y + y.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    IL FR Point <span class="keyword">operator</span> - (Point x, Point y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x.x - y.x, x.y - y.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    IL FR <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (Point x, Point y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x.y * y.x &lt;= x.x * y.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hull</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point *st;</span><br><span class="line">    <span class="keyword">int</span> top, now;</span><br><span class="line">    IL Point&amp; <span class="keyword">operator</span> [] (<span class="keyword">const</span> <span class="keyword">int</span>&amp; x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> st[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">const</span> Point&amp; x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        st[x.x].y = <span class="built_in">max</span>(st[x.x].y, x.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">push_back</span><span class="params">(<span class="keyword">const</span> Point&amp; x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        st[++top] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> len)</span> <span class="comment">//预处理,长度为x的答案对应其位置,方便ins</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">            st[i] = &#123;i, -INF&#125;;</span><br><span class="line">        top = len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">convex</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (top &lt;= <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>, len = top, top = <span class="number">2</span>; i &lt;= len; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (st[i].y == -INF)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; (st[top] - st[top - <span class="number">1</span>]) &lt;= (st[i] - st[top - <span class="number">1</span>]))</span><br><span class="line">                --top;</span><br><span class="line">            st[++top] = st[i];</span><br><span class="line">        &#125;</span><br><span class="line">        now = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL LL <span class="title">maxv</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (now != top &amp;&amp; (-tag) * (st[now + <span class="number">1</span>].x - st[now].x) &lt; (st[now + <span class="number">1</span>].y - st[now].y))</span><br><span class="line">            ++now;</span><br><span class="line">        <span class="keyword">return</span> tag * st[now].x + st[now].y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">minkowski</span><span class="params">(Hull&amp; c, Hull&amp; a, Hull&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>;</span><br><span class="line">    c.<span class="built_in">ins</span>(a[i] + b[j]);</span><br><span class="line">    <span class="keyword">while</span> (i != a.top &amp;&amp; j != b.top)</span><br><span class="line">    &#123;</span><br><span class="line">        (a[i + <span class="number">1</span>] - a[i]) &lt;= (b[j + <span class="number">1</span>] - b[j]) ? ++j : ++i;</span><br><span class="line">        c.<span class="built_in">ins</span>(a[i] + b[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i != a.top)</span><br><span class="line">        c.<span class="built_in">ins</span>(a[++i] + b[j]);</span><br><span class="line">    <span class="keyword">while</span> (j != b.top)</span><br><span class="line">        c.<span class="built_in">ins</span>(a[i] + b[++j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个板子优点是快，缺点是指针需要人工分配内存</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 凸包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大力分块2</title>
      <link href="/2022/01/25/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%972/"/>
      <url>/2022/01/25/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%972/</url>
      
        <content type="html"><![CDATA[<p> 再续前缘</p><span id="more"></span><h1 id="大力分块2"><a href="#大力分块2" class="headerlink" title="大力分块2"></a>大力分块2</h1><p>又来找虐</p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>可以见<a href="https://dyd-true.github.io/2022/01/24/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%97/#more">大力分块</a>，这是它的续</p><p>开始之前，大喊一声：我爱lxl！</p><h2 id="第六分块"><a href="#第六分块" class="headerlink" title="第六分块"></a>第六分块</h2><p><strong>「深浅值藏的第六分块」</strong>（<del>让luogu臭名昭著的研究珂学最佳方式</del>）</p><p><a href="https://www.luogu.com.cn/problem/P4118">末日时在做什么？有没有空？可以来拯救吗？</a></p><p>维护一个序列，支持两种操作：把区间 $[l, r]$ 加 $x$ ；查询区间 $[l, r]$ 最大子段和， $n, m \le 10^5$ ，任意时刻 $|a| \le 2 \times 10^9$ ， $1s, 64MB$ </p><p>下面是我脑内的处理过程：</p><h3 id="dfs预处理"><a href="#dfs预处理" class="headerlink" title="dfs预处理"></a>dfs预处理</h3><p>额……前置知识有点多，等我去递归式学习一手</p><p>尴尬了，递归了一会发现自己爆栈了……我太弱了！！！</p><p>但硬着头皮想（he）一（ti）想（jie）吧</p><h3 id="弱化版"><a href="#弱化版" class="headerlink" title="弱化版"></a>弱化版</h3><p>先想一个弱化的问题：没有修改，求区间最大子段和，这就是猫树的板子（线段树也行），不管了</p><p>稍微强一点的：全局修改，求区间最大子段和</p><p>猫树直接爆炸，考虑线段树，线段树上维护 $sum, suf, pre, as$ ，表示区间和、区间最大后缀和、区间最大前缀和、区间最大子段和，在全局加的情况下，我们如何维护这几个数字呢？</p><p> $sum$ 直接加即可</p><p> $pre$ 可以维护一个凸函数 $f(x)$ 表示长度为 $x$ 的前缀和，最大化 $pre = f(x) + d * x$ ，改写为 $f(x) = d * x + pre$ ， $f(x)$ 可以 $O(n)$  求，然后斜率优化，二分凸包最大化截距即可； $suf$ 同理维护 $g(x)$ </p><p> $as$ 也尝试维护一个凸函数 $h(x)$ 表示长度为 $x$ 的大子段和，也去凸包二分……但 $h(x)$ 可没法 $O(n)$ 求啊</p><p>考虑用下一层节点的信息，取子节点的 $g_l, f_r, h_l, h_r$ ，有 $h(x + y) = \max(h_l(x + y), h_r(x + y), g_l(x) + f_r(y))$ ，前两项直接继承，第三项闵可夫斯基和解决，都是线性的</p><p>终于，我们有了 $O(n \log n)$ 建树，求答案时对线段树每一个凸包二分，是 $O(\log^2 n)$ </p><h3 id="TLE版"><a href="#TLE版" class="headerlink" title="TLE版"></a>TLE版</h3><p>好，那区间修改怎么办？我们上面的做法可不支持区间修改呀！</p><p>考虑分块暴力，对每一块建一棵线段树，整块直接修改，散点直接重构，查询时整块在根节点二分凸包，散点就当线段树查询</p><p>设块长为 $B$ ，整块修改 $O(1)$ ，散点重构 $O(B \log B)$ ，整块查询 $O(\log B)$ ，散点查询 $O(\log^2 B)$ ，每次操作最多涉及 $\frac{n}{B}$ 个整块和两个散点，取 $B = \sqrt{n}$ ，时间复杂度为 $O(m \sqrt{n} \log \sqrt{n})$ ，还有个大常数，这不T上天，而且空间也上天了</p><p>空间可以离线逐块处理，时间上，一看是lxl的题，当然选择保留 $\sqrt{n}$ ，优化掉 $\log \sqrt{n}$ ，发现复杂度的 $\log$ 存在于两个地方：散点的重构和整块的查询（散点查询每次操作最多做两次，不是瓶颈）</p><h3 id="散点优化"><a href="#散点优化" class="headerlink" title="散点优化"></a>散点优化</h3><p>重构整棵线段树当然是 $B \log B$ ，但真的需要重构整棵吗？</p><p>我们重构的原因是本题中线段树只支持整体修改，不支持某一段修改，那么，当我们递归到某一段 $[l ,r]$ 已经完全被修改区间包含，为什么不直接打懒标记呢？</p><p>为了让这个懒标记区别于原来的懒标记，我们把它打在凸包上<strong>不下放</strong>，取凸包内节点的时候考虑叠加的正比例函数对点的位置的影响即可，而把原来的不打在树上，开一个变量单独存</p><p>因为每层只有一个节点（最左or最右）没完全被包含，所以每层只有 $O(1)$ 的节点被重构，这层的 $1$ 个节点对应下面的 $2$ 个，再下面 $4$ 个……等比数列求和，总的是 $O(B)$ 的</p><h3 id="整块优化"><a href="#整块优化" class="headerlink" title="整块优化"></a>整块优化</h3><p>首先，整体查询一定是提取线段树根上面那个凸包，而因为整体修改的标记在一个全块共用的变量上，所以根上一定是没有标记的；其次由于我们逐块处理，两个修改间的查询顺序是任意的，综上，我们考虑把所有查询按照查询时整体加标记的值升序排序，然后转换成整体加只加正数（先把标记减了就好）</p><p>这里我不是很李姐，巨佬们说由于区间加的都是正数，可以维护一个当前的最优决策点 $p$ ，决策点只会向右移动，暴力的向右爬一下即可，散点修改重构凸包的时候，直接把指针重置</p><p>这样处理询问的均摊复杂度是 $O(B)$ ，简证（<del>口胡</del>）：</p><p>定义一个块的 $E$ 为根上面的指针距离块右端点的距离，显然最开始的时候，所以块的 $E$ 和 $sum_E = n$ ，每次操作，最多有 $2$ 个散点所在块被重构，导致这两个块指针重置， $sum_E$ 增加 $2B$ ，所以总的 $sum_E$ 在过程中增加最多 $2mB$ ，而让 $sum_E$ 减少的唯一方法就是爬指针，每次减少至少 $1$ ，当 $sum_E = 0$ 时指针显然不会再爬（都到了右端点，不能再往右了），所以指针最多移动 $\frac{n + 2mB}{1}$ 次，时间为 $O(mB)$ ，均摊到每一次操作，就是 $O(B)$ </p><p>一个小点：排序时用基数排序，把总排序时间从 $O(m B \log m)$ 优化到 $O(mB)$ </p><p>到此为止，散点修改 $O(B)$ ，散点查询 $O(\log^2 B)$ ，整块修改 $O(1)$ ，整块查询 $O(B)$ （这里整块查询指一次操作中的所有整块时间和），取  $B = \sqrt{n}$ ，时间复杂度为 $O(m \sqrt{n})$ ，似乎行了？可能吗，这可是lxl啊</p><h3 id="卡常"><a href="#卡常" class="headerlink" title="卡常"></a>卡常</h3><ol><li>快读快输</li><li>基数排序用松氏基排，个数较小时用快排</li><li>维护凸包时别开 <code>vector</code> ，自己分配内存（就像我闵可夫斯基和博客里写的一样）</li><li>由于在块长不变的时候内存分配情况一定不会变，所以只需要在第一个和最后一块分配一下内存，不需要每次都重新分配</li><li>最终优化，调块长吧，多试几次</li></ol><h3 id="受苦"><a href="#受苦" class="headerlink" title="受苦"></a>受苦</h3><p>啊啊啊不想打啊！</p><ul><li> $2022/1/26$ $7:30$ 开始本题</li><li> $2022/1/26$ $1:27$ 开打 </li><li> $2022/1/26$ $16:30$ 打完开调</li><li> $2022/1/26$ $18:17$ 过样例了 </li><li> $2022/1/26$ $18:30$ 第一次提交，TLE + RE $0pts$ </li><li> $2022/1/26$ $19:18$ 改过RE了（二分打挂了），TLE + WA $0pts$ </li><li> $2022/1/26$ $19:33$ 不WA了，TLE  $0pts$ </li><li> $2022/1/26$ $19:33$ 本着宁WA不T的原则卡块长，发现当 $B = 1148$ 时最好（然鹅还是TLE一个点）WA  $0pts$ </li><li> $2022/1/26$ $21:56$ 发现把 $bn$ 打成 $n$ 了，改了后TLE $80pts$ ，啊啊啊，我的打法常数大了！</li><li> $2022/1/27$ $9:45$ 把网上能找到的代码（包括所有的题解）都交了一遍，全TLE（好像lxl加强了），心态爆炸</li><li> $2022/1/27$ $10:00$ 猛然发现一篇分类讨论的 $36pts$ 的代码刚好AC了我TLE的点（他特别猛，就手玩），于是决定高素质……</li><li> $2022/1/27$ $10:37$  高素质过了！决定加点注释，压压行</li><li> $2022/1/27$ $11:08$  搞定</li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>超长警告！不压行 $737$ 行，压了后 $649$ 行！lxl太毒瘤了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2022/1/27 11:08</span></span><br><span class="line"><span class="comment">by Dyd</span></span><br><span class="line"><span class="comment">由于代码很长,稍微压了一下行</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Max(x, y) ((x) &gt; (y) ? (x) : (y))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Min(x, y) ((x) &lt; (y) ? (x) : (y))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> got(x, len) (((x) - 1) / (len) + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LB(x, len) (((x) - 1) * (len) + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RB(x, len) Min(((x) * (len)), n)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span> </span>&#123; <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout), l = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123; out[l++] = x; &#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> B = <span class="number">1148</span>, N = <span class="number">1e5</span> + B + <span class="number">5</span>, R = <span class="number">256</span>, Bit = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">const</span> LL MINF = <span class="number">-0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op = <span class="number">0</span>, l = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">    LL v = <span class="number">0</span>;</span><br><span class="line">&#125; que[N];</span><br><span class="line"><span class="comment">//我的程序(80pts,最后一个点会TLE)</span></span><br><span class="line"><span class="keyword">namespace</span> My</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//bl,br,pos卡常,记录LB,RB,got;tot:分配空间</span></span><br><span class="line">    <span class="keyword">int</span> bl[N / B + <span class="number">5</span>], br[N / B + <span class="number">5</span>], pos[N], tot;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        LL x, y;</span><br><span class="line">        IL Point <span class="keyword">operator</span> + (<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123; <span class="keyword">return</span> &#123;x + b.x, y + b.y&#125;; &#125;</span><br><span class="line">        IL Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123; <span class="keyword">return</span> &#123;x - b.x, y - b.y&#125;; &#125;</span><br><span class="line">        IL <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123; <span class="keyword">return</span> x * b.y &gt;= y * b.x; &#125;</span><br><span class="line">    &#125; pool[N];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Hull</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Point *vc;</span><br><span class="line">        <span class="keyword">int</span> si, mxid;</span><br><span class="line">        LL tag;</span><br><span class="line">        IL Point <span class="keyword">operator</span> [] (<span class="keyword">const</span> <span class="keyword">int</span> x) &#123; <span class="keyword">return</span> &#123;vc[x].x, vc[x].y + tag * vc[x].x&#125;; &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(Point x)</span> </span>&#123; vc[x.x].y = <span class="built_in">Max</span>(vc[x.x].y, x.y); &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">push_back</span><span class="params">(Point x)</span> </span>&#123; vc[si++] = x; &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> len)</span> <span class="comment">//预留len的空间(赋为MINF以待跟新)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            vc[<span class="number">0</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, si = len + <span class="number">1</span>, tag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i) vc[i] = &#123;i, MINF&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">jarvis</span><span class="params">()</span> <span class="comment">//求凸包</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (si &lt;= <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">int</span> top = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; si; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (vc[i].y == MINF) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">while</span> (top &gt;= <span class="number">1</span> &amp;&amp; (vc[top] - vc[top - <span class="number">1</span>]) &lt;= (vc[i] - vc[top - <span class="number">1</span>])) --top;</span><br><span class="line">                vc[++top] = vc[i];</span><br><span class="line">            &#125;</span><br><span class="line">            si = top + <span class="number">1</span>, tag = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, LL addv)</span> </span>&#123; <span class="keyword">return</span> (vc[x + <span class="number">1</span>].x - vc[x].x) * (tag + addv) + vc[x + <span class="number">1</span>].y - vc[x].y &gt; <span class="number">0</span>; &#125;</span><br><span class="line">        <span class="function">IL LL <span class="title">maxv</span><span class="params">(LL addv)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (mxid &lt; si - <span class="number">1</span> &amp;&amp; <span class="built_in">check</span>(mxid, addv)) ++mxid;</span><br><span class="line">            <span class="keyword">return</span> vc[mxid].x * (tag + addv) + vc[mxid].y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL LL <span class="title">bs</span><span class="params">(LL addv)</span> <span class="comment">//凸包上二分</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> l = <span class="number">-1</span>, r = si - <span class="number">1</span>, mid;</span><br><span class="line">            <span class="keyword">for</span> (mid = l + r &gt;&gt; <span class="number">1</span>; l &lt; r - <span class="number">1</span>; mid = l + r &gt;&gt; <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">check</span>(mid, addv)) l = mid;</span><br><span class="line">                <span class="keyword">else</span> r = mid;</span><br><span class="line">            mxid = r;</span><br><span class="line">            <span class="keyword">return</span> vc[mxid].x * (tag + addv) + vc[mxid].y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Ans</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        LL pre, suf, as, sum;</span><br><span class="line">        IL Ans <span class="keyword">operator</span> + (<span class="keyword">const</span> Ans &amp;b) <span class="keyword">const</span> &#123; <span class="keyword">return</span> &#123;<span class="built_in">Max</span>(pre, sum + b.pre), <span class="built_in">Max</span>(suf + b.sum, b.suf), <span class="built_in">Max</span>(<span class="built_in">Max</span>(as, b.as), suf + b.pre), sum + b.sum&#125;; &#125;</span><br><span class="line">    &#125; ans[N];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Hull pre[B &lt;&lt; <span class="number">2</span>], suf[B &lt;&lt; <span class="number">2</span>], as[B &lt;&lt; <span class="number">2</span>];</span><br><span class="line">        LL sum[B &lt;&lt; <span class="number">2</span>], tag[B &lt;&lt; <span class="number">2</span>];</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> Mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> <span class="comment">//预分配空间</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            pre[u].vc = pool + tot, tot += r - l + <span class="number">3</span>;</span><br><span class="line">            suf[u].vc = pool + tot, tot += r - l + <span class="number">3</span>;</span><br><span class="line">            as[u].vc = pool + tot, tot += r - l + <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="built_in">prev</span>(lc, l, mid), <span class="built_in">prev</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">pre_suf_merge</span><span class="params">(Hull &amp;c, Hull &amp;a, Hull &amp;b, Point addb)</span> <span class="comment">//普通合并</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t = a.si; i &lt; t; ++i) c.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t = b.si; i &lt; t; ++i) c.<span class="built_in">push_back</span>(addb + b[i]);</span><br><span class="line">            c.<span class="built_in">jarvis</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">minkowski</span><span class="params">(Hull &amp;c, Hull &amp;a, Hull &amp;b)</span> <span class="comment">//闵可夫斯基和</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, sa = a.si - <span class="number">1</span>, sb = b.si - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (c.<span class="built_in">ins</span>(a[i] + b[j]); i &lt; sa &amp;&amp; j &lt; sb; c.<span class="built_in">ins</span>(a[i] + b[j])) a[i + <span class="number">1</span>] - a[i] &lt;= b[j + <span class="number">1</span>] - b[j] ? ++j : ++i;</span><br><span class="line">            <span class="keyword">while</span> (i &lt; sa) c.<span class="built_in">ins</span>(a[++i] + b[j]);</span><br><span class="line">            <span class="keyword">while</span> (j &lt; sb) c.<span class="built_in">ins</span>(a[i] + b[++j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="built_in">pre_suf_merge</span>(pre[u], pre[lc], pre[rc], &#123;mid - l + <span class="number">1</span>, sum[lc]&#125;);</span><br><span class="line">            <span class="built_in">pre_suf_merge</span>(suf[u], suf[rc], suf[lc], &#123;r - mid, sum[rc]&#125;);</span><br><span class="line">            as[u].<span class="built_in">prev</span>(r - l + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t = as[lc].si; i &lt; t; ++i) as[u].<span class="built_in">ins</span>(as[lc][i]);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t = as[rc].si; i &lt; t; ++i) as[u].<span class="built_in">ins</span>(as[rc][i]);</span><br><span class="line">            <span class="built_in">minkowski</span>(as[u], suf[lc], pre[rc]);</span><br><span class="line">            as[u].<span class="built_in">jarvis</span>();</span><br><span class="line">            pre[u].mxid = suf[u].mxid = as[u].mxid = <span class="number">0</span>;</span><br><span class="line">            sum[u] = sum[lc] + sum[rc];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//添加标记,同时修改</span></span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, LL d)</span> </span>&#123; tag[u] += d, pre[u].tag += d, suf[u].tag += d, as[u].tag += d, sum[u] += d * (r - l + <span class="number">1</span>); &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">down</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l == r || !tag[u]) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="built_in">add</span>(lc, l, mid, tag[u]), <span class="built_in">add</span>(rc, mid + <span class="number">1</span>, r, tag[u]);</span><br><span class="line">            tag[u] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> bid)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l == r)</span><br><span class="line">            &#123;</span><br><span class="line">                sum[u] = a[l + bl[bid] - <span class="number">1</span>];</span><br><span class="line">                pre[u].<span class="built_in">push_back</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;), pre[u].<span class="built_in">push_back</span>(&#123;<span class="number">1</span>, sum[u]&#125;);</span><br><span class="line">                suf[u].<span class="built_in">push_back</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;), suf[u].<span class="built_in">push_back</span>(&#123;<span class="number">1</span>, sum[u]&#125;);</span><br><span class="line">                as[u].<span class="built_in">push_back</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;), as[u].<span class="built_in">push_back</span>(&#123;<span class="number">1</span>, sum[u]&#125;);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="built_in">build</span>(lc, l, mid, bid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r, bid);</span><br><span class="line">            <span class="built_in">up</span>(u, l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">clear</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            pre[u].si = suf[u].si = as[u].si = <span class="number">0</span>;</span><br><span class="line">            pre[u].mxid = suf[u].mxid = as[u].mxid = <span class="number">0</span>;</span><br><span class="line">            pre[u].tag = suf[u].tag = as[u].tag = <span class="number">0</span>;</span><br><span class="line">            tag[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="built_in">clear</span>(lc, l, mid), <span class="built_in">clear</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, LL d)</span> <span class="comment">//散点修改</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l == ql &amp;&amp; r == qr) <span class="keyword">return</span> <span class="built_in">add</span>(u, l, r, d);</span><br><span class="line">            <span class="built_in">down</span>(u, l, r);</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="keyword">if</span> (qr &lt;= mid) <span class="built_in">change</span>(lc, l, mid, ql, qr, d);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ql &gt; mid) <span class="built_in">change</span>(rc, mid + <span class="number">1</span>, r, ql, qr, d);</span><br><span class="line">            <span class="comment">//注意这里ql,qr改变了</span></span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">change</span>(lc, l, mid, ql, mid, d), <span class="built_in">change</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr, d);</span><br><span class="line">            pre[u].si = suf[u].si = as[u].si = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">up</span>(u, l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//整块询问</span></span><br><span class="line">        <span class="function">IL Ans <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, LL addv)</span> </span>&#123; <span class="keyword">return</span> &#123;pre[<span class="number">1</span>].<span class="built_in">maxv</span>(addv), suf[<span class="number">1</span>].<span class="built_in">maxv</span>(addv), as[<span class="number">1</span>].<span class="built_in">maxv</span>(addv), sum[<span class="number">1</span>] + (r - l + <span class="number">1</span>) * addv&#125;; &#125;</span><br><span class="line">        <span class="function">IL Ans <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr, LL addv)</span> <span class="comment">//散点询问</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l == ql &amp;&amp; r == qr) <span class="keyword">return</span> u == <span class="number">1</span> ? <span class="built_in">query</span>(ql, qr, addv) : (Ans)&#123;pre[u].<span class="built_in">bs</span>(addv), suf[u].<span class="built_in">bs</span>(addv), as[u].<span class="built_in">bs</span>(addv), sum[u] + (qr - ql + <span class="number">1</span>) * addv&#125;;</span><br><span class="line">            <span class="built_in">down</span>(u, l, r);</span><br><span class="line">            <span class="keyword">int</span> mid = Mid;</span><br><span class="line">            <span class="keyword">if</span> (qr &lt;= mid) <span class="keyword">return</span> <span class="built_in">ask</span>(lc, l, mid, ql, qr, addv);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (ql &gt; mid) <span class="keyword">return</span> <span class="built_in">ask</span>(rc, mid + <span class="number">1</span>, r, ql, qr, addv);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ask</span>(lc, l, mid, ql, mid, addv) + <span class="built_in">ask</span>(rc, mid + <span class="number">1</span>, r, mid + <span class="number">1</span>, qr, addv);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">QuestionForBlock</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>, id = <span class="number">0</span>;</span><br><span class="line">        LL v = <span class="number">0</span>, typ = <span class="number">0</span>;</span><br><span class="line">        IL <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> QuestionForBlock &amp;b) <span class="keyword">const</span> &#123; <span class="keyword">return</span> v &lt; b.v; &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Block</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        LineTree lt;</span><br><span class="line">        <span class="comment">//cnt,tmp,val,valt都是基数排序用的,为了卡常在这里定</span></span><br><span class="line">        <span class="keyword">int</span> bid, bn, bm, cnt[R];</span><br><span class="line">        QuestionForBlock bq[N], tmp[N];</span><br><span class="line">        LL tag, valt[N], val[N];</span><br><span class="line">        <span class="comment">//整体修改</span></span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">modify</span><span class="params">(LL d)</span> </span>&#123; tag += d; &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, LL d)</span> <span class="comment">//散点修改</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (d == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (l == <span class="number">1</span> &amp;&amp; r == bn) <span class="keyword">return</span> tag += d, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">            bq[bm++] = &#123;l, r, <span class="number">0</span>, tag, d&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//整体查询</span></span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span> </span>&#123; bq[bm++] = &#123;l, r, id, tag, <span class="number">0</span>&#125;; &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> geted(x, d) (((x) &gt;&gt; ((d)*Bit)) &amp; (R - 1))</span></span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">radix_sort</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> <span class="comment">//松氏基排</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (r - l &lt;= <span class="number">1500</span>) <span class="keyword">return</span> <span class="built_in">sort</span>(bq + l, bq + r); <span class="comment">//小优化</span></span><br><span class="line">            LL *x = val, *y = valt;</span><br><span class="line">            <span class="keyword">int</span> tt = r - l;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) x[i - l] = y[i - l] = bq[i].v | ((<span class="number">1ll</span> * i) &lt;&lt; <span class="number">35</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">0</span>; d &lt; <span class="number">4</span>; ++d)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; ++i) cnt[i] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tt; ++i) ++cnt[<span class="built_in">geted</span>(x[i], d)];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; R; ++i) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = tt - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) y[--cnt[<span class="built_in">geted</span>(x[i], d)]] = x[i];</span><br><span class="line">                <span class="built_in">swap</span>(x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) tmp[i - l] = bq[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) bq[i] = tmp[(x[i - l] &gt;&gt; <span class="number">35</span>) - l];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span> <span class="comment">//预处理(修改化为正数,建树,排序)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            LL mintag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bm; ++i) mintag = <span class="built_in">Min</span>(mintag, bq[i].v);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bm; ++i) bq[i].v -= mintag;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = bl[bid], t = br[bid]; i &lt;= t; ++i) a[i] += mintag;</span><br><span class="line">            lt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, bn, bid);</span><br><span class="line">            <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bm; ++i) <span class="keyword">if</span> (bq[i].typ)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (i != last) <span class="built_in">radix_sort</span>(last, i);</span><br><span class="line">                last = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (last != bm) <span class="built_in">radix_sort</span>(last, bm);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bm; ++i)</span><br><span class="line">                <span class="keyword">if</span> (!bq[i].typ)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i &amp;&amp; bq[i - <span class="number">1</span>].typ) lt.pre[<span class="number">1</span>].<span class="built_in">bs</span>(bq[i].v), lt.suf[<span class="number">1</span>].<span class="built_in">bs</span>(bq[i].v), lt.as[<span class="number">1</span>].<span class="built_in">bs</span>(bq[i].v);</span><br><span class="line">                    ans[bq[i].id] = ans[bq[i].id] + lt.<span class="built_in">ask</span>(<span class="number">1</span>, <span class="number">1</span>, bn, bq[i].l, bq[i].r, bq[i].v);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> lt.<span class="built_in">change</span>(<span class="number">1</span>, <span class="number">1</span>, bn, bq[i].l, bq[i].r, bq[i].typ);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; bm = tag = <span class="number">0</span>, lt.<span class="built_in">clear</span>(<span class="number">1</span>, <span class="number">1</span>, bn); &#125;</span><br><span class="line">    &#125; blk;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">int</span> qcnt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) pos[i] = <span class="built_in">got</span>(i, B);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pos[n]; ++i) bl[i] = <span class="built_in">LB</span>(i, B), br[i] = <span class="built_in">RB</span>(i, B);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= pos[n]; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            qcnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//这里一定要先加了在判continue,否则输出会不够</span></span><br><span class="line">                <span class="keyword">if</span> (que[j].op == <span class="number">2</span>) ++qcnt;</span><br><span class="line">                <span class="keyword">if</span> (que[j].l &gt; br[i] || que[j].r &lt; bl[i]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (que[j].op == <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (que[j].l &lt;= bl[i] &amp;&amp; que[j].r &gt;= br[i]) blk.<span class="built_in">modify</span>(que[j].v);</span><br><span class="line">                    <span class="keyword">else</span> blk.<span class="built_in">change</span>(<span class="built_in">Max</span>(que[j].l, bl[i]) - bl[i] + <span class="number">1</span>, <span class="built_in">Min</span>(que[j].r, br[i]) - bl[i] + <span class="number">1</span>, que[j].v);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> blk.<span class="built_in">query</span>(<span class="built_in">Max</span>(que[j].l, bl[i]) - bl[i] + <span class="number">1</span>, <span class="built_in">Min</span>(que[j].r, br[i]) - bl[i] + <span class="number">1</span>, qcnt);</span><br><span class="line">            &#125;</span><br><span class="line">            blk.bid = i, blk.bn = br[i] - bl[i] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span> || i == pos[n]) tot = <span class="number">0</span>, blk.lt.<span class="built_in">prev</span>(<span class="number">1</span>, <span class="number">1</span>, blk.bn);</span><br><span class="line">            blk.<span class="built_in">prev</span>(), blk.<span class="built_in">solve</span>(), blk.<span class="built_in">clear</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= qcnt; ++i) <span class="built_in">write</span>(ans[i].as), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//高素质嫖别人的(36pts,但最后一个点AC了)</span></span><br><span class="line"><span class="keyword">namespace</span> GaoSuZhi</span><br><span class="line">&#123;</span><br><span class="line">    LL check[<span class="number">5000005</span>], nowu, cnt1, cnt2, c[<span class="number">1000005</span>], qf[<span class="number">1000005</span>];</span><br><span class="line">    <span class="keyword">bool</span> check1, hmz;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(LL now, LL v)</span></span>&#123; <span class="keyword">for</span> (; now &lt;= n; now += now &amp; -now) c[now] += v; &#125;</span><br><span class="line">    <span class="function">IL LL <span class="title">sum</span><span class="params">(LL tmp)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LL s = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; tmp &gt; <span class="number">0</span>; tmp -= tmp &amp; -tmp) s += c[tmp];</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span>;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid1</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span>;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid2</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span>;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmn</span><span class="params">(LL pos, LL l, LL r)</span></span>;</span><br><span class="line">    <span class="keyword">namespace</span> work1</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            LL l, r, mid, sum, maxx, minn, tag;</span><br><span class="line">            <span class="keyword">bool</span> need;</span><br><span class="line">            <span class="built_in">node</span>() &#123;&#125;</span><br><span class="line">            <span class="built_in">node</span>(LL _l, LL _r, LL _mid, LL _sum, LL _maxx, LL _minn, LL _tag) &#123; l = _l, r = _r, mid = _mid, sum = _sum, maxx = _maxx, minn = _minn, tag = _tag, need = <span class="number">0</span>; &#125;</span><br><span class="line">        &#125; tree[<span class="number">5000005</span>];</span><br><span class="line">        <span class="function">IL node <span class="title">merge</span><span class="params">(node x, node y)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">node</span>(<span class="built_in">Max</span>(x.l, x.sum + y.l), <span class="built_in">Max</span>(y.r, y.sum + x.r), <span class="built_in">Max</span>(<span class="built_in">Max</span>(x.mid, y.mid), x.r + y.l), x.sum + y.sum, <span class="built_in">Max</span>(x.maxx, y.maxx), <span class="built_in">min</span>(x.minn, y.minn), <span class="number">0ll</span>); &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(LL now, LL l, LL r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (tree[now].tag != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].sum += (mid - l + <span class="number">1</span>) * tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum += (r - mid) * tree[now].tag;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].tag += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].tag += tree[now].tag;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].maxx += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].maxx += tree[now].tag;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].minn += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].minn += tree[now].tag;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].l = tree[now &lt;&lt; <span class="number">1</span>].r = tree[now &lt;&lt; <span class="number">1</span>].mid = <span class="built_in">Max</span>(tree[now &lt;&lt; <span class="number">1</span>].sum, <span class="number">0ll</span>), tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].l = tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].r = tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].mid = <span class="built_in">Max</span>(tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum, <span class="number">0ll</span>);</span><br><span class="line">                tree[now].tag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tree[now].need &amp;&amp; l != r)</span><br><span class="line">            &#123;</span><br><span class="line">                tree[now &lt;&lt; <span class="number">1</span>].need = <span class="literal">true</span>, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].need = <span class="literal">true</span>;</span><br><span class="line">                <span class="built_in">getmid</span>(now &lt;&lt; <span class="number">1</span>, l, mid, <span class="literal">true</span>), <span class="built_in">getmid</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, <span class="literal">true</span>);</span><br><span class="line">                tree[now].need = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(LL now, LL l, LL r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l == r)</span><br><span class="line">            &#123;</span><br><span class="line">                tree[now].need = <span class="literal">false</span>;</span><br><span class="line">                tree[now].l = tree[now].r = tree[now].mid = <span class="built_in">Max</span>(a[l], <span class="number">0ll</span>);</span><br><span class="line">                tree[now].sum = tree[now].minn = tree[now].maxx = a[l];</span><br><span class="line">                tree[now].tag = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            tree[now].need = <span class="literal">false</span>;</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">build</span>(now &lt;&lt; <span class="number">1</span>, l, mid), <span class="built_in">build</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">update</span><span class="params">(LL now, LL l, LL r, LL x, LL y, LL w)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; y || r &lt; x) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (x &lt;= l &amp;&amp; r &lt;= y)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (tree[now].maxx + w &lt;= <span class="number">0</span> || tree[now].minn + w &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    tree[now].sum += (r - l + <span class="number">1</span>) * w;</span><br><span class="line">                    tree[now].tag += w, tree[now].maxx += w, tree[now].minn += w;</span><br><span class="line">                    tree[now].l = tree[now].r = tree[now].mid = <span class="built_in">Max</span>(tree[now].sum, <span class="number">0ll</span>);</span><br><span class="line">                    tree[now].need = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> ((!check1 &amp;&amp; r - l + <span class="number">1</span> &lt;= <span class="number">500</span>) || (check1 &amp;&amp; r - l + <span class="number">1</span> &lt;= <span class="number">5000</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    tree[now].sum += (r - l + <span class="number">1</span>) * w;</span><br><span class="line">                    tree[now].tag += w, tree[now].maxx += w, tree[now].minn += w;</span><br><span class="line">                    tree[now].need = <span class="literal">true</span>;</span><br><span class="line">                    <span class="built_in">getmid</span>(now, l, r, <span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (r - l + <span class="number">1</span> &lt;= <span class="number">500</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">getmn</span>(now, l, r);</span><br><span class="line">                <span class="keyword">if</span> (tree[now].maxx &lt;= <span class="number">0</span> || tree[now].minn &gt;= <span class="number">0</span>) tree[now].mid = tree[now].l = tree[now].r = <span class="built_in">Max</span>(<span class="number">0ll</span>, tree[now].sum);</span><br><span class="line">                <span class="keyword">else</span> <span class="built_in">getmid</span>(now, l, r, <span class="literal">true</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">push_down</span>(now, l, r);</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">update</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y, w), <span class="built_in">update</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y, w);</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL node <span class="title">query</span><span class="params">(LL now, LL l, LL r, LL x, LL y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (x &lt;= l &amp;&amp; r &lt;= y) <span class="keyword">return</span> tree[now];</span><br><span class="line">            <span class="keyword">if</span> (l &lt;= x &amp;&amp; r &lt;= y &amp;&amp; (r - x + <span class="number">1</span>) &lt;= <span class="number">700</span> &amp;&amp; (tree[now].need || r - x &lt;= <span class="number">500</span>)) <span class="keyword">return</span> <span class="built_in">getmid</span>(<span class="number">0</span>, x, r, <span class="literal">true</span>), tree[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (l &gt;= x &amp;&amp; r &gt;= y &amp;&amp; (y - l + <span class="number">1</span>) &lt;= <span class="number">700</span> &amp;&amp; (tree[now].need || y - l &lt;= <span class="number">500</span>)) <span class="keyword">return</span> <span class="built_in">getmid</span>(<span class="number">0</span>, l, y, <span class="literal">true</span>), tree[<span class="number">0</span>];</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">push_down</span>(now, l, r);</span><br><span class="line">            node ans;</span><br><span class="line">            <span class="keyword">if</span> (x &gt; mid) ans = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (y &lt;= mid) ans = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                node resa = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y), resb = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y);</span><br><span class="line">                ans = <span class="built_in">node</span>(<span class="built_in">Max</span>(resa.l, resa.sum + resb.l), <span class="built_in">Max</span>(resb.r, resb.sum + resa.r), <span class="built_in">Max</span>(resa.mid, <span class="built_in">Max</span>(resb.mid, resa.r + resb.l)), resa.sum + resb.sum, <span class="number">0ll</span>, <span class="number">0ll</span>, <span class="number">0ll</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span> work2 <span class="comment">//实测用不到,但为了保持他代码的完整性,方便我以后理解他的思路,还是留下</span></span><br><span class="line">    &#123;</span><br><span class="line">        LL eps;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            LL l, r, mid, sum, maxx, minn, tag;</span><br><span class="line">            <span class="keyword">bool</span> check;</span><br><span class="line">        &#125; tree[<span class="number">1000005</span>];</span><br><span class="line">        <span class="function">IL <span class="keyword">bool</span> <span class="title">get</span><span class="params">(node now, LL len)</span></span>&#123; <span class="keyword">return</span> (now.maxx &lt;= <span class="number">0</span> || now.minn &gt;= <span class="number">0</span>); &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">void</span> <span class="title">push_down</span><span class="params">(LL now, LL l, LL r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            tree[now &lt;&lt; <span class="number">1</span>].sum += (mid - l + <span class="number">1</span>) * tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].sum += (r - mid) * tree[now].tag;</span><br><span class="line">            tree[now &lt;&lt; <span class="number">1</span>].tag += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].tag += tree[now].tag;</span><br><span class="line">            tree[now &lt;&lt; <span class="number">1</span>].maxx += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].maxx += tree[now].tag;</span><br><span class="line">            tree[now &lt;&lt; <span class="number">1</span>].minn += tree[now].tag, tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].minn += tree[now].tag;</span><br><span class="line">            tree[now &lt;&lt; <span class="number">1</span>].check = <span class="built_in">get</span>(tree[now &lt;&lt; <span class="number">1</span>], mid - l + <span class="number">1</span>), tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].check = <span class="built_in">get</span>(tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], r - mid);</span><br><span class="line">            tree[now].tag = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">node <span class="title">merge</span><span class="params">(node x, node y, LL len)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            node ans = &#123;<span class="built_in">Max</span>(x.l, x.sum + y.l), <span class="built_in">Max</span>(y.r, y.sum + x.r), <span class="built_in">Max</span>(<span class="built_in">Max</span>(x.mid, y.mid), x.r + y.l), x.sum + y.sum, <span class="built_in">Max</span>(x.maxx, y.maxx), <span class="built_in">min</span>(x.minn, y.minn)&#125;;</span><br><span class="line">            <span class="keyword">if</span> (x.check || y.check) ans.check = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> ans.check = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(LL now, LL l, LL r)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            tree[now].tag = <span class="number">0</span>, tree[now].check = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (l == r)</span><br><span class="line">            &#123;</span><br><span class="line">                tree[now].maxx = tree[now].minn = tree[now].sum = a[l];</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">build</span>(now &lt;&lt; <span class="number">1</span>, l, mid), <span class="built_in">build</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], r - l + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(LL now, LL l, LL r, LL x, LL y, LL w)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; y || r &lt; x) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (x &lt;= l &amp;&amp; r &lt;= y)</span><br><span class="line">            &#123;</span><br><span class="line">                tree[now].sum += (r - l + <span class="number">1</span>) * w;</span><br><span class="line">                tree[now].maxx += w, tree[now].minn += w, tree[now].tag += w;</span><br><span class="line">                <span class="keyword">if</span> ((tree[now].maxx &lt;= <span class="number">0</span> || tree[now].minn &gt;= <span class="number">0</span>) &amp;&amp; r - l + <span class="number">1</span> &gt;= eps) tree[now].check = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">else</span> tree[now].check = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">push_down</span>(now, l, r);</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">update</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y, w), <span class="built_in">update</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y, w);</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], r - l + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">node <span class="title">query</span><span class="params">(LL now, LL l, LL r, LL x, LL y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            tree[now].check = <span class="built_in">get</span>(tree[now], r - l + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (l &gt; y || r &lt; x) <span class="keyword">return</span> node&#123;<span class="number">-10000000</span>, <span class="number">-10000000</span>, <span class="number">-10000000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">if</span> (x &lt;= l &amp;&amp; r &lt;= y)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (tree[now].maxx &lt;= <span class="number">0</span> || tree[now].minn &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    tree[now].l = tree[now].r = tree[now].mid = <span class="built_in">Max</span>(tree[now].sum, <span class="number">0ll</span>);</span><br><span class="line">                    <span class="keyword">return</span> tree[now];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (r - l + <span class="number">1</span> &lt;= <span class="number">300</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">getmid</span>(now, l, r, <span class="literal">false</span>);</span><br><span class="line">                    <span class="keyword">return</span> tree[now];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            node ans;</span><br><span class="line">            <span class="built_in">push_down</span>(now, l, r);</span><br><span class="line">            LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; mid) ans = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (r &lt;= mid) ans = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                node a = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span>, l, mid, x, y), b = <span class="built_in">query</span>(now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, x, y);</span><br><span class="line">                ans = &#123;<span class="built_in">Max</span>(a.l, a.sum + b.l), <span class="built_in">Max</span>(b.r, b.sum + a.r), <span class="built_in">Max</span>(<span class="built_in">Max</span>(a.mid, b.mid), a.r + b.l), a.sum + b.sum, <span class="built_in">Max</span>(a.maxx, b.maxx), <span class="built_in">min</span>(a.minn, b.minn)&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            tree[now] = <span class="built_in">merge</span>(tree[now &lt;&lt; <span class="number">1</span>], tree[now &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], r - l + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LL l, r, w;</span><br><span class="line">        <span class="keyword">double</span> p = cnt1 * <span class="number">1.0</span> / <span class="number">1e10</span>;</span><br><span class="line">        check1 = (p &lt; <span class="number">0.8</span> &amp;&amp; p &gt;= <span class="number">0.7</span>);</span><br><span class="line">        work2::eps = n / <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> LL i = <span class="number">1</span>; i &lt;= n; ++i) qf[i] = a[i] - a[i - <span class="number">1</span>], <span class="built_in">add</span>(i, qf[i]);</span><br><span class="line">        <span class="keyword">bool</span> hmz = (cnt1 &lt;= <span class="number">2e9</span>);</span><br><span class="line">        work1::<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">        <span class="keyword">for</span> (LL k = <span class="number">1</span>; k &lt;= m; ++k)</span><br><span class="line">        &#123;</span><br><span class="line">            l = que[k].l, r = que[k].r, w = que[k].v;</span><br><span class="line">            <span class="keyword">if</span> (!l) ++l;</span><br><span class="line">            nowu = l;</span><br><span class="line">            <span class="keyword">if</span> (!hmz)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (que[k].op == <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    qf[l] += w, qf[r + <span class="number">1</span>] -= w;</span><br><span class="line">                    <span class="built_in">add</span>(l, w), <span class="built_in">add</span>(r + <span class="number">1</span>, -w);</span><br><span class="line">                    work1::<span class="built_in">update</span>(<span class="number">1</span>, <span class="number">1</span>, n, que[k].l, que[k].r, que[k].v);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (r - l + <span class="number">1</span> &lt;= <span class="number">50000</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        LL ans = <span class="number">0</span>, now = <span class="number">0</span>, ql = <span class="built_in">sum</span>(l), i;</span><br><span class="line">                        <span class="keyword">for</span> (i = l; i &lt;= r - <span class="number">11</span>; i += <span class="number">12</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">1</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">2</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">3</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">4</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">5</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">6</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">7</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">8</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">9</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">10</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">11</span>],</span><br><span class="line">                            now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[i + <span class="number">12</span>];</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">while</span> (i &lt;= r) now = (now &lt; <span class="number">0</span> ? <span class="number">0</span> : now) + ql, ans = (ans &gt; now ? ans : now), ql += qf[++i];</span><br><span class="line">                        <span class="built_in">write</span>(ans), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="built_in">write</span>(work1::<span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, n, que[k].l, que[k].r).mid), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//这里本来还有一个else但用不到,为了代码简洁就不放了</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!pos || !vis || !check1 || (l != nowu &amp;&amp; work1::tree[pos].maxx &gt;= <span class="number">1e8</span> + <span class="number">1e5</span>)) <span class="built_in">getmid1</span>(pos, l, r, vis);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">getmid2</span>(pos, l, r, vis);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid1</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LL ans[<span class="number">3</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, now[<span class="number">3</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, ql = <span class="built_in">sum</span>(l), i;</span><br><span class="line">        <span class="keyword">for</span> (i = l; i &lt;= r - <span class="number">3</span>; i += <span class="number">4</span>)</span><br><span class="line">            now[<span class="number">1</span>] += ql, ans[<span class="number">1</span>] = (ans[<span class="number">1</span>] &gt; now[<span class="number">1</span>] ? ans[<span class="number">1</span>] : now[<span class="number">1</span>]),</span><br><span class="line">                          now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">1</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">                          now[<span class="number">1</span>] += ql, ans[<span class="number">1</span>] = (ans[<span class="number">1</span>] &gt; now[<span class="number">1</span>] ? ans[<span class="number">1</span>] : now[<span class="number">1</span>]),</span><br><span class="line">                          now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">2</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">                          now[<span class="number">1</span>] += ql, ans[<span class="number">1</span>] = (ans[<span class="number">1</span>] &gt; now[<span class="number">1</span>] ? ans[<span class="number">1</span>] : now[<span class="number">1</span>]),</span><br><span class="line">                          now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">3</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">                          now[<span class="number">1</span>] += ql, ans[<span class="number">1</span>] = (ans[<span class="number">1</span>] &gt; now[<span class="number">1</span>] ? ans[<span class="number">1</span>] : now[<span class="number">1</span>]),</span><br><span class="line">                          now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">4</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= r)</span><br><span class="line">            now[<span class="number">1</span>] += ql, ans[<span class="number">1</span>] = (ans[<span class="number">1</span>] &gt; now[<span class="number">1</span>] ? ans[<span class="number">1</span>] : now[<span class="number">1</span>]),</span><br><span class="line">                          now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">1</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">                          ++i;</span><br><span class="line">        <span class="keyword">if</span> (vis) work1::tree[pos].l = ans[<span class="number">1</span>], work1::tree[pos].r = now[<span class="number">2</span>], work1::tree[pos].mid = ans[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">else</span> work2::tree[pos].l = ans[<span class="number">1</span>], work2::tree[pos].r = now[<span class="number">2</span>], work2::tree[pos].mid = ans[<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmid2</span><span class="params">(LL pos, LL l, LL r, <span class="keyword">bool</span> vis)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LL now[<span class="number">3</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, ql = <span class="built_in">sum</span>(l), i, ans[<span class="number">3</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (i = l; i &lt;= r - <span class="number">12</span>; i += <span class="number">13</span>)</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">1</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">2</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">3</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">4</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">5</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">6</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">7</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">8</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">9</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">10</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">11</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">12</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">13</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= r)</span><br><span class="line">            now[<span class="number">2</span>] = (now[<span class="number">2</span>] &lt; <span class="number">0</span> ? <span class="number">0</span> : now[<span class="number">2</span>]) + ql, ql += qf[i + <span class="number">1</span>], ans[<span class="number">2</span>] = (ans[<span class="number">2</span>] &gt; now[<span class="number">2</span>] ? ans[<span class="number">2</span>] : now[<span class="number">2</span>]),</span><br><span class="line">            ++i;</span><br><span class="line">        <span class="keyword">if</span> (vis) work1::tree[pos].l = ans[<span class="number">1</span>], work1::tree[pos].r = now[<span class="number">2</span>], work1::tree[pos].mid = ans[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">else</span> work2::tree[pos].l = ans[<span class="number">1</span>], work2::tree[pos].r = now[<span class="number">2</span>], work2::tree[pos].mid = ans[<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">getmn</span><span class="params">(LL pos, LL l, LL r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        LL i, su = <span class="number">0</span>, maxx = <span class="number">-1e10</span>, minn = <span class="number">1e10</span>, ql = <span class="built_in">sum</span>(l);</span><br><span class="line">        <span class="keyword">for</span> (i = l; i &lt;= r - <span class="number">11</span>; i += <span class="number">12</span>)</span><br><span class="line">            su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">1</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">2</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">3</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">4</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">5</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">6</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">7</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">8</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">9</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">10</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">11</span>],</span><br><span class="line">                      su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[i + <span class="number">12</span>];</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= r)</span><br><span class="line">            su += ql, maxx = (maxx &lt; ql ? ql : maxx), minn = (minn &lt; ql ? minn : ql), ql += qf[++i];</span><br><span class="line">        work1::tree[pos].sum = su, work1::tree[pos].maxx = maxx, work1::tree[pos].minn = minn;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(que[i].op), <span class="built_in">read</span>(que[i].l), <span class="built_in">read</span>(que[i].r);</span><br><span class="line">        <span class="keyword">if</span> (que[i].op == <span class="number">1</span>) <span class="built_in">read</span>(que[i].v);</span><br><span class="line">        <span class="keyword">else</span> GaoSuZhi::cnt1 += que[i].r - que[i].l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">double</span> p = GaoSuZhi::cnt1 * <span class="number">1.0</span> / <span class="number">1e10</span>;</span><br><span class="line">    GaoSuZhi::check1 = (p &lt; <span class="number">0.8</span> &amp;&amp; p &gt;= <span class="number">0.7</span>);</span><br><span class="line">    GaoSuZhi::hmz = (GaoSuZhi::cnt1 &lt;= <span class="number">2e9</span>);</span><br><span class="line">    <span class="comment">//不要问我是怎么知道最后一个点a[1]=-1的</span></span><br><span class="line">    <span class="keyword">if</span> (!GaoSuZhi::hmz &amp;&amp; a[<span class="number">1</span>] == <span class="number">-1</span>) GaoSuZhi::<span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">else</span> My::<span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">flus</span>(), <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>其实我对末日三问不是很感冒，感觉就是一般般的感动吧，当然确实挺好看的，但有点带入不了男女的立场，可能是我的理解有点不同吧</p><h2 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h2><p>上次三道题才 $7000$ 字，这一道题就 $7000$ 了！</p><p>学校马上要放假了，以后再更吧，还是一样，会挂链接的</p><p>最后首尾呼应一下：lxl太可爱了，我爱lxl！！！</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>猫树</title>
      <link href="/2022/01/25/%E7%8C%AB%E6%A0%91/"/>
      <url>/2022/01/25/%E7%8C%AB%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 喵~</p><span id="more"></span><h1 id="猫树"><a href="#猫树" class="headerlink" title="猫树"></a>猫树</h1><p>你肯定想知道它为什么要叫猫树（Cat Tree），其实就像珂朵莉树（Old Driver Tree）一样，只是创造的人喜欢罢了</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>先看猫树用来解决什么问题，一句话说，就是不带修改的线段树</p><p>线段树的时间为 $O(n) + O(\log n)$ （预处理 + 单次询问），而猫树可以做到 $O(n \log n) + O(1)$ ，但是<strong>不带修改</strong>（感觉好没用啊），一般用于优化dp之类的</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>思路非常简单：由于不带修改，可以线段树上每一段信息统计出来，直接调用</p><h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2><p>先看预处理，类似线段树的 <code>build</code> ，我们用递归的方式预处理</p><p>设处理到区间 $[l, r]$ ，就维护好其信息（这个信息不同于线段树的整体，而是更细致的信息，且一般以 $mid$ 为界，比如线段树维护“区间和”，猫树这里就应统计 $[l, mid]$ 的后缀和与 $[mid + 1, r]$ 的前缀和），然后进入左右段，时空明显 $O(n \log n)$ （假设统计信息是 $O(n)$ 的）</p><h2 id="询问"><a href="#询问" class="headerlink" title="询问"></a>询问</h2><p>这才是精髓，看看它是如何做到 $O(1)$ 的</p><p>如果只是预处理了，它的询问还是要递归，这不还是 $O(\log n)$ ？这可不行</p><p>我们逆向思考，如果是从叶节点 $[x, x]$ 和 $[y, y]$ 向上走，那它们第一次相遇于LCA处时，对应的区间就是唯一一个满足 $l \le x \le mid \le y \le r$ 的区间，而我们在这个区间统计的信息就足以回答询问了（比如“区间和”，我们统计的前后缀足以回答 $[x, y]$ 的和）</p><p>那么问题变成树上LCA，而且是完全二叉树，倍增是 $O(\log \log n)$ ，ST表可以做到 $O(1)$ ，但如果只是这样，似乎略显麻烦，体现不出猫树的优势啊</p><p>注意到，猫树它和线段树一样，采用“父子二倍”标号，而 $(110101)_2$ 和 $(110011)_2$ 的LCA就是最长公共前缀 $(110)_2$ ，大家可以手玩验证一下</p><p>那么怎么快速求出两个数的二进制的最长公共前缀？</p><p>求法是有的，但都不是很简单（太麻烦了还不如用ST表），我们退而求其次</p><p>设两个数的二进制的最长公共前缀长度为 $len$ （二进制下），发现两个数异或之后，最高位右移了 $len$ 位，而一个数的二进制长度就是 $\log n + 1$ ，可以预处理出 $\log$ $O(1)$ 得LCA的二进制长度</p><p>那长度有啥用呢？别忘了，在“父子二倍”标号下，长度就是层数啊！我们求得了LCA在树上是第几层</p><p>那有什么用呢？别忘了我们还知道查询的端点 $x, y$ ，考虑在预处理时把同一层的信息直接存在同一个数组里，如让 <code>sum[x][i]</code> 代表第 $x$ 层的前缀（ $i &gt; mid$ ）/后缀（ $i \le mid$ ）和，由于一层的节点没有重复覆盖，这是可以做到的</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>还是给道题：<a href="https://www.luogu.com.cn/problem/SP2916">GSS5</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, D = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">int</span> log_2[N &lt;&lt; <span class="number">2</span>], a[N], len;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CatTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//记录对应叶节点</span></span><br><span class="line">    <span class="keyword">int</span> pos[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//sum前/后缀和,mmx端点为mid最大子段和,mx最大子段和,imx端点为i的最大子段段和</span></span><br><span class="line">    <span class="keyword">int</span> sum[D][N &lt;&lt; <span class="number">1</span>], mmx[D][N &lt;&lt; <span class="number">1</span>], mx[D][N &lt;&lt; <span class="number">1</span>], imx[D][N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> pos[l] = u, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">        <span class="keyword">int</span> t, tt, mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        sum[d][mid] = mmx[d][mid] = mx[d][mid] = imx[d][mid] = t = tt = a[mid], tt = <span class="built_in">max</span>(tt, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = mid - <span class="number">1</span>; i &gt;= l; --i)</span><br><span class="line">        &#123;</span><br><span class="line">            t += a[i], tt += a[i];</span><br><span class="line">            sum[d][i] = t, imx[d][i] = tt;</span><br><span class="line">            mmx[d][i] = <span class="built_in">max</span>(mmx[d][i + <span class="number">1</span>], t);</span><br><span class="line">            mx[d][i] = <span class="built_in">max</span>(mx[d][i + <span class="number">1</span>], tt);</span><br><span class="line">            tt = <span class="built_in">max</span>(tt, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        sum[d][mid + <span class="number">1</span>] = mmx[d][mid + <span class="number">1</span>] = mx[d][mid + <span class="number">1</span>] = imx[d][mid + <span class="number">1</span>] = t = tt = a[mid + <span class="number">1</span>], tt = <span class="built_in">max</span>(tt, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = mid + <span class="number">2</span>; i &lt;= r; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            t += a[i], tt += a[i];</span><br><span class="line">            sum[d][i] = t, imx[d][i] = tt;</span><br><span class="line">            mmx[d][i] = <span class="built_in">max</span>(mmx[d][i - <span class="number">1</span>], t);</span><br><span class="line">            mx[d][i] = <span class="built_in">max</span>(mx[d][i - <span class="number">1</span>], tt);</span><br><span class="line">            tt = <span class="built_in">max</span>(tt, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span>, l, mid, d + <span class="number">1</span>), <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, d + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//typ:1sum 2pre 3suf 4mid</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> typ)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> a[l];</span><br><span class="line">        <span class="keyword">int</span> d = log_2[pos[l]] - log_2[pos[l] ^ pos[r]];</span><br><span class="line">        <span class="keyword">if</span> (typ == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> sum[d][l] + sum[d][r];</span><br><span class="line">        <span class="keyword">if</span> (typ == <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(sum[d][l] + mmx[d][r], imx[d][l]);</span><br><span class="line">        <span class="keyword">if</span> (typ == <span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(mmx[d][l] + sum[d][r], imx[d][r]);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">max</span>(mx[d][l], mx[d][r]), mmx[d][l] + mmx[d][r]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ct;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    log_2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, t = N &lt;&lt; <span class="number">2</span>; i &lt; t; ++i)</span><br><span class="line">        log_2[i] = log_2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l1, <span class="keyword">int</span> r1, <span class="keyword">int</span> l2, <span class="keyword">int</span> r2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (r1 &lt; l2)</span><br><span class="line">        <span class="keyword">return</span> ct.<span class="built_in">ask</span>(l1, r1, <span class="number">3</span>) + ct.<span class="built_in">ask</span>(r1 + <span class="number">1</span>, l2 - <span class="number">1</span>, <span class="number">1</span>) + ct.<span class="built_in">ask</span>(l2, r2, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> res;</span><br><span class="line">    res = <span class="built_in">max</span>(ct.<span class="built_in">ask</span>(l2, r1, <span class="number">4</span>), ct.<span class="built_in">ask</span>(l1, l2, <span class="number">3</span>) + ct.<span class="built_in">ask</span>(l2, r2, <span class="number">2</span>) - a[l2]);</span><br><span class="line">    res = <span class="built_in">max</span>(res, ct.<span class="built_in">ask</span>(l1, r1, <span class="number">3</span>) + ct.<span class="built_in">ask</span>(r1, r2, <span class="number">2</span>) - a[r1]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, n, m, l1, r1, l2, r2;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        <span class="comment">//要保证满二叉树</span></span><br><span class="line">        <span class="keyword">for</span> (len = <span class="number">2</span>; len &lt; n; len &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">        ct.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, len, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">        <span class="keyword">while</span> (m--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;l1, &amp;r1, &amp;l2, &amp;r2);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(l1, r1, l2, r2));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>大力分块</title>
      <link href="/2022/01/24/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%97/"/>
      <url>/2022/01/24/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<p> lxl是yyds</p><span id="more"></span><h1 id="大力分块"><a href="#大力分块" class="headerlink" title="大力分块"></a>大力分块</h1><p>我估计会长的一比</p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>众所周知，lxl喜欢数据结构</p><p>众所周知，lxl很毒瘤</p><p>众所周知，lxl有点中二+宅</p><p>于是lxl出了Yn（由乃）oi的大分块题目，把以上三者结合了起来</p><p>然后，就让我们来大力分块吧！</p><h2 id="最初分块"><a href="#最初分块" class="headerlink" title="最初分块"></a>最初分块</h2><p><strong>「望月悲叹的最初分块」</strong></p><p><a href="https://www.luogu.com.cn/problem/P4119">未来日记</a></p><p>维护一个序列，支持区间修改（把所有的 $x$ 变成 $y$ ）和区间第 $k$ 小， $n, m, a \le 10^5$ </p><h3 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h3><p>当然考虑分块</p><p>先设块长为 $B = \sqrt{n}$ ，考虑询问，先找到询问的区间，这个区间必定是由整块+散点组成，而这步寻找可以 $O(1)$ 找到</p><p>注意到 $a \le 10^5$ ，值域与 $n$ 同级，考虑对值域也分块（为区分称其为值块），设块长为 $V = \sqrt{n}$ ，记 <code>cnt[i][j]</code> 表示第 $i$ 块内的数值在第 $j$ 值块内的有几个</p><p>但是这个区间最多有 $\sqrt{n}$ 个块，又最多要枚举 $\sqrt{n}$ 个值块，这显然不可接受，由于对于单次询问，包括的块不变，考虑对块进行<strong>前缀和</strong>，设 <code>cnt[i][j]</code> 表示前 $i$ 块内的数值在第 $j$ 值块内的有几个，再开一个临时数组 <code>tcnt[j]</code> 表示散点中数值在第 $j$ 值块内的有几个，枚举可得答案所在值块，我们发现同理可得答案，具体的，设 <code>rel[i][j]</code> 表示前 $i$ 块内的数值是 $j$ 的有几个， <code>trel[j]</code> 同理，枚举可得答案，注意到枚举 <code>cnt[i][j]</code> 的时间是 $O(\sqrt{n})$ 的（只用枚举 $j$ ），枚举 <code>rel[i][j]</code> 也是 $O(\sqrt{n})$ 的，于是，我们用单次 $O(\sqrt{n})$ 的时间（目前看来）， $O(n \sqrt{n})$ 的空间（ <code>rel</code> 数组）解决了询问</p><p>考虑修改，先看散点，明显暴力就行了，修改的区间也可以 $O(1)$ 找到，对于整块每次修改需要一并修改 <code>cnt</code> 和 <code>rel</code> ，并且由于他们是“前缀和”，必须要把后面的每个块都改了，时间是 $O(\sqrt{n})$ （注意这里不要每个块都去修改后面，那样是 $O(n)$ 的，应该记一个修改量的前缀和），就……行了？</p><p>行个鬼啊！区间在修改完后一定要打上懒标记，不然下一次单点修改时查到的就是错误的值啊！</p><p>发现区间修改有一个优美的性质：值相等的点无论如何一定相等，这启发我们打<strong>并查集</strong>（对每一块开一个），把相等的点直接并到一起，这样，区间的标记可以 $O(\log \sqrt{n})$ 解决，但是，副作用是：单点修改的时候怎么办？不能直接更改这个点的 $fa$ ，因为它下面可能还有点，直接重构其实是可以的办法（因为每次散点只在两个块，最多 $2\sqrt{n}$ 个点），但我们还有别的办法</p><p>考虑建一些<strong>辅助点</strong>，设点 <code>nd[i][j]</code> 代表第 $i$ 块值为 $j$ ，对于一个块里的点，把他们全都并到 $nd$ 上去（换句话说，只有 $nd$ 有儿子），这样，散点就直接改就行了，而整块可以让 <code>nd[i][x]</code> 的 $fa$ 改为 <code>nd[i][y]</code> ，并让 <code>nd[i][x] = 0</code> （这代表这个区间没有值为 $x$ 的点），特殊情况是 <code>nd[i][y] == 0</code> ，这个时候就新建一个节点（<del>浪费空间ing</del>）</p><p>考虑空间， $nd$ 数组大小为 $O(n \sqrt{n})$ ，因为最初有 $n$ 个点（它们不做父亲），每一块最多有 $\sqrt{n}$ 个值，每次操作最多加 $\sqrt{n}$ 个辅助点（每块一个），并查集的节点数最多是 $n + \sqrt{n} * \sqrt{n} + m * \sqrt{n}$ 可以看作 $O(n \sqrt{n})$ 的空间；而对于时间，并查集的修改都是 $O(1)$ 的，单点的查询是 $O(\log \sqrt{n})$ （这个 $\log \sqrt{n}$ 非常解决于 $1$ ，因为并查集的深度只有辅助点个数，加上有路径压缩），散点是 $O(\sqrt{n})$ 个，块是 $O(\sqrt{n})$ 个，而修改那两个数组要用 $O(\sqrt{n})$ ，单次修改的总时间为 $O(\sqrt{n} \log \sqrt{n})$ ，而由于单点的查询是 $O(\log \sqrt{n})$ ，上面的单次询问也变成了 $O(\sqrt{n} \log \sqrt{n})$ </p><p>额……先打出来</p><p>（受苦了一下午以后……）</p><p>好，TLE $0pts$ ，<del>wtm**lxl！！！</del>，我只能望月悲叹</p><p>吃了个饭，回来尝试卡块长，发现 $B = 500, V = 317$ 是既不会TLE，也不会MLE，只是WA了，貌似有戏……？</p><p>开始调试<del>受苦</del>（这记着是为了防止我忘了，可以跳过不看） ：</p><ul><li><p> $2022/1/24$ $18:00 \sim 20:50$ 自以为操作 $2$ 基本调试完毕</p></li><li><p> $2022/1/24$ $20:55$ 自以为调完然后交（<del>谁给我的自信</del>），WA  $10pts$ ，WA的点都是输出了负数，不知为何（疑似炸 <code>int</code> ？）</p></li><li><p>  $2022/1/24$ $21:00$ 发现负数是我调试的时候把范围改了没改回去，修正后手造大样例，结果WA了（幸好没交） </p></li><li><p> $2022/1/24$ $21:20$ 发现我的make date不够严谨，而且在大数据下操作 $2$ 也挂了</p></li><li><p> $2022/1/24$ $21:30$ 发现操作 $2$ 挂在没特判同块</p></li><li><p> $2022/1/24$ $21:51$ 同机房<strong>wfy</strong>巨佬帮我调出了一个很难的RE，这次应该是真的吧操作 $2$ 调好了</p></li><li><p> $2022/1/24$ $22:00$  $73pts$ 该睡觉了</p></li><li><p>话说我昨晚睡觉时想到，并查集上加一个按秩合并，可以优化到单次 $O(\sqrt{n} \alpha(n))$ </p></li><li><p> $2022/1/25$ $8:00$ AC了！！！</p></li></ul><p>做法如果还有不懂的可以看<a href="https://dydbenren.blog.luogu.org/solution-p4119">这个</a></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="comment">//求块号</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(x, len) (((x) - 1) / (len) + 1)</span></span><br><span class="line"><span class="comment">//块左端点</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LB(x, len) (((x) - 1) * (len) + 1)</span></span><br><span class="line"><span class="comment">//块右端点</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RB(x, len) ((x) * (len))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast <span class="comment">//长的和shit一样的快读</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">10000</span> + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="comment">//B:点块长,N:注意要多开一个B的大小,V:值块长,NB:开空间用</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>  B = <span class="number">500</span>, N = <span class="number">1e5</span> + B + <span class="number">1</span>, V = <span class="number">317</span>, NB = B + <span class="number">5</span>;</span><br><span class="line"><span class="comment">//num:块数,wi:最大值</span></span><br><span class="line"><span class="keyword">int</span> num, wi;</span><br><span class="line"><span class="comment">//如题</span></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Block</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//cnt:块值前缀和,rel:真实值前缀和</span></span><br><span class="line">    <span class="keyword">int</span> cnt[NB], rel[N];</span><br><span class="line">    <span class="comment">//b[i].nd[j]:第i块值为j的并查集根</span></span><br><span class="line">    <span class="keyword">int</span> nd[N];</span><br><span class="line">&#125; b[NB];</span><br><span class="line"><span class="comment">//并查集:父亲,大小,值(仅当为根时有意义)</span></span><br><span class="line"><span class="keyword">int</span> fa[N * NB + N * <span class="number">2</span>], si[N * NB + N * <span class="number">2</span>], val[N * NB + N * <span class="number">2</span>], tot = <span class="number">0</span>;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//路径压缩</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">newnd</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> v)</span> <span class="comment">//新建并查集根节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = ++tot, fa[x] = x, si[x] = <span class="number">0</span>, val[x] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span> <span class="comment">//按秩合并,把x并给y</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (si[x] &gt; si[y])</span><br><span class="line">    &#123;</span><br><span class="line">        val[x] = val[y];</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    fa[x] = y, si[y] += si[x], x = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">va</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//返回点x的真实值</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> val[<span class="built_in">find</span>(x)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//栈用于还原tcnt和trel</span></span><br><span class="line">    STC <span class="keyword">int</span> tcnt[NB], trel[N], stk[NB &lt;&lt; <span class="number">1</span>], top;</span><br><span class="line">    STC <span class="keyword">int</span> t, tt, x;</span><br><span class="line">    <span class="comment">//特判同块</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get</span>(l, B) == <span class="built_in">get</span>(r, B))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (; l &lt;= r; ++l)</span><br><span class="line">        &#123;</span><br><span class="line">            x = <span class="built_in">va</span>(l);</span><br><span class="line">            ++tcnt[<span class="built_in">get</span>(x, V)], ++trel[x];</span><br><span class="line">            stk[++top] = x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>, t = <span class="number">1</span>, tt = <span class="built_in">get</span>(wi, V); t &lt;= tt; ++t)</span><br><span class="line">            <span class="keyword">if</span> ((x += tcnt[t]) &gt;= k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (tt = <span class="built_in">RB</span>(t, V); ; --tt)</span><br><span class="line">                    <span class="keyword">if</span> ((x -= trel[tt]) &lt; k)</span><br><span class="line">                    &#123;</span><br><span class="line">                        t = tt;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//处理散点</span></span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(l - <span class="number">1</span>, B) == (t = <span class="built_in">get</span>(l, B))) <span class="comment">//这里虽然第一块多了个点0但不影响答案</span></span><br><span class="line">            <span class="keyword">for</span> (; <span class="built_in">get</span>(l, B) == t; ++l)</span><br><span class="line">            &#123;</span><br><span class="line">                x = <span class="built_in">va</span>(l);</span><br><span class="line">                ++tcnt[<span class="built_in">get</span>(x, V)], ++trel[x];</span><br><span class="line">                stk[++top] = x;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(r + <span class="number">1</span>, B) == (t = <span class="built_in">get</span>(r, B)))</span><br><span class="line">            <span class="keyword">for</span> (; <span class="built_in">get</span>(r, B) == t; --r)</span><br><span class="line">            &#123;</span><br><span class="line">                x = <span class="built_in">va</span>(r);</span><br><span class="line">                ++tcnt[<span class="built_in">get</span>(x, V)], ++trel[x];</span><br><span class="line">                stk[++top] = x;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//找到答案(这里假设答案一定存在)</span></span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>, t = <span class="number">1</span>, l = <span class="built_in">get</span>(l, B), r = <span class="built_in">get</span>(r, B), tt = <span class="built_in">get</span>(wi, V); t &lt;= tt; ++t)</span><br><span class="line">            <span class="keyword">if</span> ((x += tcnt[t] + b[r].cnt[t] - b[l - <span class="number">1</span>].cnt[t]) &gt;= k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (tt = <span class="built_in">RB</span>(t, V); ; --tt)</span><br><span class="line">                    <span class="keyword">if</span> ((x -= trel[tt] + b[r].rel[tt] - b[l - <span class="number">1</span>].rel[tt]) &lt; k)</span><br><span class="line">                    &#123;</span><br><span class="line">                        t = tt;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//还原</span></span><br><span class="line">    <span class="keyword">while</span> (top)</span><br><span class="line">    &#123;</span><br><span class="line">        x = stk[top--];</span><br><span class="line">        --tcnt[<span class="built_in">get</span>(x, V)], --trel[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == y)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    wi = <span class="built_in">max</span>(wi, y);</span><br><span class="line">    STC <span class="keyword">int</span> t, tt, xx, yy, ll;</span><br><span class="line">    <span class="comment">//记录l用于还原</span></span><br><span class="line">    ll = l;</span><br><span class="line">    xx = <span class="built_in">get</span>(x, V), yy = <span class="built_in">get</span>(y, V);</span><br><span class="line">    <span class="comment">//还原前缀和</span></span><br><span class="line">    <span class="keyword">for</span> (t = num, tt = <span class="built_in">get</span>(ll, B); t &gt;= tt; --t)</span><br><span class="line">    &#123;</span><br><span class="line">        b[t].cnt[xx] -= b[t - <span class="number">1</span>].cnt[xx];</span><br><span class="line">        b[t].rel[x] -= b[t - <span class="number">1</span>].rel[x];</span><br><span class="line">        b[t].cnt[yy] -= b[t - <span class="number">1</span>].cnt[yy];</span><br><span class="line">        b[t].rel[y] -= b[t - <span class="number">1</span>].rel[y];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//特判同块</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get</span>(l, B) == (t = <span class="built_in">get</span>(r, B)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b[t].rel[x] &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!b[t].nd[y])</span><br><span class="line">                <span class="built_in">newnd</span>(b[t].nd[y], y);</span><br><span class="line">            <span class="keyword">for</span> (; l &lt;= r; ++l)</span><br><span class="line">                <span class="keyword">if</span> ((tt = <span class="built_in">va</span>(l)) == x)</span><br><span class="line">                &#123;</span><br><span class="line">                    fa[l] = b[t].nd[y];</span><br><span class="line">                    <span class="comment">//注意同时跟新大小</span></span><br><span class="line">                    ++si[b[t].nd[y]];</span><br><span class="line">                    --si[b[t].nd[x]];</span><br><span class="line">                    --b[t].cnt[xx], --b[t].rel[x];</span><br><span class="line">                    ++b[t].cnt[yy], ++b[t].rel[y];</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//处理散点</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(l - <span class="number">1</span>, B) == (t = <span class="built_in">get</span>(l, B)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (b[t].rel[x] &lt;= <span class="number">0</span>)</span><br><span class="line">                l = <span class="built_in">LB</span>(t + <span class="number">1</span>, B); </span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!b[t].nd[y])</span><br><span class="line">                    <span class="built_in">newnd</span>(b[t].nd[y], y);</span><br><span class="line">                <span class="keyword">for</span> (; <span class="built_in">get</span>(l, B) == t; ++l)</span><br><span class="line">                    <span class="keyword">if</span> ((tt = <span class="built_in">va</span>(l)) == x)</span><br><span class="line">                    &#123;</span><br><span class="line">                        fa[l] = b[t].nd[y];</span><br><span class="line">                        ++si[b[t].nd[y]];</span><br><span class="line">                        --si[b[t].nd[x]];</span><br><span class="line">                        --b[t].cnt[xx], --b[t].rel[x];</span><br><span class="line">                        ++b[t].cnt[yy], ++b[t].rel[y];</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">get</span>(r + <span class="number">1</span>, B) == (t = <span class="built_in">get</span>(r, B)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (b[t].rel[x] &lt;= <span class="number">0</span>)</span><br><span class="line">                r = <span class="built_in">RB</span>(t - <span class="number">1</span>, B); </span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!b[t].nd[y])</span><br><span class="line">                    <span class="built_in">newnd</span>(b[t].nd[y], y);</span><br><span class="line">                <span class="keyword">for</span> (; <span class="built_in">get</span>(r, B) == t; --r)</span><br><span class="line">                    <span class="keyword">if</span> ((tt = <span class="built_in">va</span>(r)) == x)</span><br><span class="line">                    &#123;</span><br><span class="line">                        fa[r] = b[t].nd[y];</span><br><span class="line">                        ++si[b[t].nd[y]];</span><br><span class="line">                        --si[b[t].nd[x]];</span><br><span class="line">                        --b[t].cnt[xx], --b[t].rel[x];</span><br><span class="line">                        ++b[t].cnt[yy], ++b[t].rel[y];</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//处理整块</span></span><br><span class="line">        <span class="keyword">for</span> (l = <span class="built_in">get</span>(l, B), r = <span class="built_in">get</span>(r, B); l &lt;= r; ++l)</span><br><span class="line">            <span class="keyword">if</span> (b[l].rel[x] &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!b[l].nd[y])</span><br><span class="line">                    <span class="built_in">newnd</span>(b[l].nd[y], y);</span><br><span class="line">                <span class="built_in">merge</span>(b[l].nd[x], b[l].nd[y]);</span><br><span class="line">                b[l].cnt[yy] += b[l].rel[x];</span><br><span class="line">                b[l].rel[y] += b[l].rel[x];</span><br><span class="line">                b[l].cnt[xx] -= b[l].rel[x];</span><br><span class="line">                b[l].rel[x] -= b[l].rel[x];</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//再求前缀和</span></span><br><span class="line">    <span class="keyword">for</span> (t = <span class="built_in">get</span>(ll, B); t &lt;= num; ++t)</span><br><span class="line">    &#123;</span><br><span class="line">        b[t].cnt[xx] += b[t - <span class="number">1</span>].cnt[xx];</span><br><span class="line">        b[t].rel[x] += b[t - <span class="number">1</span>].rel[x];</span><br><span class="line">        b[t].cnt[yy] += b[t - <span class="number">1</span>].cnt[yy];</span><br><span class="line">        b[t].rel[y] += b[t - <span class="number">1</span>].rel[y];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    num = <span class="built_in">get</span>(n, B), wi = <span class="number">0</span>;</span><br><span class="line">    tot = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(a);</span><br><span class="line">        wi = <span class="built_in">max</span>(wi, a);</span><br><span class="line">        <span class="keyword">auto</span> &amp;t = b[<span class="built_in">get</span>(i, B)];</span><br><span class="line">        <span class="keyword">if</span> (!t.nd[a])</span><br><span class="line">            <span class="built_in">newnd</span>(t.nd[a], a);</span><br><span class="line">        fa[i] = t.nd[a];</span><br><span class="line">        ++si[t.nd[a]];</span><br><span class="line">        ++t.cnt[<span class="built_in">get</span>(a, V)], ++t.rel[a];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, t = <span class="built_in">get</span>(wi, V); j &lt;= t; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num; ++i)</span><br><span class="line">            b[i].cnt[j] += b[i - <span class="number">1</span>].cnt[j];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= wi; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num; ++i)</span><br><span class="line">            b[i].rel[j] += b[i - <span class="number">1</span>].rel[j];</span><br><span class="line">    <span class="keyword">int</span> op, l, r, x, y;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">read</span>(y), <span class="built_in">modify</span>(l, r, x, y);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">write</span>(<span class="built_in">ask</span>(l, r, x)), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">flus</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>我用于喜欢我妻由乃！</p><h2 id="第二分块"><a href="#第二分块" class="headerlink" title="第二分块"></a>第二分块</h2><p><strong>「突刺贯穿的第二分块」</strong></p><p>好，我们乘胜追击！</p><p><a href="https://www.luogu.com.cn/problem/P4117">五彩斑斓的世界</a></p><p>维护一个序列，支持区间修改（把所有大于 $x$ 的数减去 $x$ ）和查询区间中 $x$ 的出现次数， $n \le 10^5, m \le 5 \times 10^5, a \le 10^5 + 1$  ，时限 $7.5s$ ，空间 $64MB$ </p><h3 id="做题-1"><a href="#做题-1" class="headerlink" title="做题"></a>做题</h3><p>不难发现，如果不是那<del>sm</del>的空间，可以用最初分块解决，但这空间，  $O(n \sqrt{n})$ 都开不出来</p><p>那看看着题和最初分块的不同呢？发现询问是出现次数，而不是排名，这个显然可以直接记录，就不必要前缀和了，注意，这意味着分块后<strong>每个块之间的信息毫无关联</strong>，并且答案就是<strong>区间包含的所有答案的累加</strong>于是有一个控制空间的方法：</p><p>把操作离线下来，对每个块都按顺序处理一遍所有的操作，然后把询问的答案累加即可，空间是 $O(n + m)$ 的了（也许开 <code>short</code>  也行，没试过）</p><p>那么该如何修改呢？注意到由于我们离线了，所以要枚举 $\sqrt{n}$ 块，每一块又要枚举 $m$ 个操作，所以对于每个操作我们要做到 $O(1)$ ，或者所有操作加起来共用 $O(n)$ </p><p>这……直接瞟一眼<a href="https://olddrivertree.blog.uoj.ac/blog/4715">出题人的题解</a>，发现可以这样懒标记+并查集维护，具体的，设当前块最大值为 $mx$ ：</p><ul><li>若 $mx \le 2x$ ，就直接枚举大于 $x$ 的数，让它们减去 $x$ </li><li>若 $mx &gt; 2x$ ，就直接枚举小于 $x$ 的数，让它们加上 $x$ ，然后区间打上减 $x$ 的标记</li></ul><p>设后面的“枚举……”时间复杂度为 $O(t)$ ，发现 $mx$ 的真实值（算上懒标记）是单调下降的，由于 $mx$ 初始最大为 $10^5 + 1$ ，所以所有操作时间加起来是 $O(a) * O(t)$ 的，由于总共只能用 $O(n)$ ，所以必须保证 $O(t) = O(1)$ </p><p>还是可以开并查集（但这里可不能像最初分块一样开辅助点，空间不够），对每个值开一个并查集，然后记录这个并查集的 $si$ ，整块修改的时候直接合并两个值的并查集，查询的时候直接输出这个并查集的 $si$ ，都是 $O(1)$ 的；如果是散点修改，就直接重构；散点查询，就通过并查集找到范围内每个数的值，暴力统计即可</p><p>但对于散点的时间，我们还得从另一个角度分析才能得出结论：假设我们没有离线，空间就开那么大，则 $m$ 次操作最多重构 $2m$  个块，每个块 $\sqrt{n}$ 个点，同时怼上路径压缩，由于每次会遍历每个叶子，路径压缩的效果极好，散点均摊每个点可以当作 $O(1)$ ，则时间复杂度为 $O(m \sqrt{n})$ ，均摊到每个块和每个操作，就是 $O(1)$ 了（好像严格的 $O(1)$ 应该是用链表代替并查集，重构更快，但不太好打）</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> get(x, len) (((x) - 1) / (len) + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LB(x, len) (((x) - 1) * (len) + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RB(x, len) ((x) * (len))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">10000</span> + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">5e5</span> + <span class="number">5</span>, A = <span class="number">1e5</span> + <span class="number">5</span>, B = <span class="number">1000</span>, NB = B + <span class="number">5</span>, N = <span class="number">1e6</span> + B + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, l, r, x, ans;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Block</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa[N], si[N], val[N], rt[A];</span><br><span class="line">    <span class="keyword">int</span> mx, tag, l, r;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">va</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> val[<span class="built_in">find</span>(x)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rt[y])</span><br><span class="line">            fa[rt[x]] = rt[y];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            rt[y] = rt[x], val[rt[y]] = y;</span><br><span class="line">        si[y] += si[x];</span><br><span class="line">        rt[x] = si[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            ++si[x[i]];</span><br><span class="line">            <span class="keyword">if</span> (!rt[x[i]])</span><br><span class="line">            &#123;</span><br><span class="line">                mx = <span class="built_in">max</span>(mx, x[i]);</span><br><span class="line">                rt[x[i]] = i;</span><br><span class="line">                fa[i] = i, val[i] = x[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                fa[i] = rt[x[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">destroy</span><span class="params">(<span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//一定在摧毁前找到真实值</span></span><br><span class="line">            x[i] = <span class="built_in">va</span>(i);</span><br><span class="line">            rt[x[i]] = si[x[i]] = <span class="number">0</span>;</span><br><span class="line">            x[i] -= tag;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">            fa[i] = <span class="number">0</span>;</span><br><span class="line">        tag = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mx - tag &lt; (d &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = mx; i &gt; d + tag; --i)</span><br><span class="line">                <span class="keyword">if</span> (rt[i])</span><br><span class="line">                    <span class="built_in">merge</span>(i, i - d);</span><br><span class="line">            <span class="comment">//这里最大值不一定要保证存在,反正上面判了rt的,但一定要不多不少</span></span><br><span class="line">            mx = <span class="built_in">min</span>(mx, d + tag);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> + tag; i &lt;= d + tag; ++i)</span><br><span class="line">                <span class="keyword">if</span> (rt[i])</span><br><span class="line">                    <span class="built_in">merge</span>(i, i + d);</span><br><span class="line">            tag += d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> ll ,<span class="keyword">int</span> rr, <span class="keyword">int</span> x[], <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ll &gt; rr)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="built_in">destroy</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = ll; i &lt;= rr; ++i)</span><br><span class="line">            <span class="keyword">if</span> (x[i] &gt; d)</span><br><span class="line">                x[i] -= d;</span><br><span class="line">        <span class="built_in">build</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (d + tag &gt; A)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> si[d + tag];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> ll, <span class="keyword">int</span> rr, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = ll; i &lt;= rr; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">va</span>(i) - tag == d)</span><br><span class="line">                ++res;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; blk;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N];</span><br><span class="line">    STC Question q[M];</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)    </span><br><span class="line">        <span class="built_in">read</span>(q[i].op), <span class="built_in">read</span>(q[i].l), <span class="built_in">read</span>(q[i].r), <span class="built_in">read</span>(q[i].x), q[i].ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">get</span>(n, B); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        blk.l = <span class="built_in">LB</span>(i, B);</span><br><span class="line">        blk.r = <span class="built_in">RB</span>(i, B);</span><br><span class="line">        blk.<span class="built_in">build</span>(a);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (q[j].op == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (q[j].l &lt;= blk.l &amp;&amp; q[j].r &gt;= blk.r)</span><br><span class="line">                    blk.<span class="built_in">modify</span>(q[j].x);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    blk.<span class="built_in">change</span>(<span class="built_in">max</span>(q[j].l, blk.l), <span class="built_in">min</span>(q[j].r, blk.r), a, q[j].x);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (q[j].l &lt;= blk.l &amp;&amp; q[j].r &gt;= blk.r)</span><br><span class="line">                    q[j].ans += blk.<span class="built_in">query</span>(q[j].x);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    q[j].ans += blk.<span class="built_in">ask</span>(<span class="built_in">max</span>(q[j].l, blk.l), <span class="built_in">min</span>(q[j].r, blk.r), q[j].x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        blk.<span class="built_in">destroy</span>(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="keyword">if</span> (q[i].op == <span class="number">2</span>)</span><br><span class="line">            <span class="built_in">write</span>(q[i].ans), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="built_in">flus</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="其它-1"><a href="#其它-1" class="headerlink" title="其它"></a>其它</h3><p>这是个galgame吗？我好像没玩过……</p><h2 id="第三分块"><a href="#第三分块" class="headerlink" title="第三分块"></a>第三分块</h2><p>由于lxl觉得它过于简单，被开除块籍了，后面数字断了的就是开除块籍了，不再提</p><h2 id="第四分块"><a href="#第四分块" class="headerlink" title="第四分块"></a>第四分块</h2><p><strong>「弑尽破净的第四分块」</strong></p><p><a href="https://www.luogu.com.cn/problem/P5397">天降之物</a></p><p>维护一个序列，支持两种操作：</p><ol><li>区间修改，把序列中所有的 $x$ 变成 $y$ </li><li>在整个序列中找出一组 $i, j$ 满足 $a_i = x, a_j = y$ ，使 $|i - j|$ 最小，并输出 $i - j$ ，不存在输出Ikaros</li></ol><p>强制在线， $n, m, a \le 10^5$ ， $500ms, 256MB$ </p><h3 id="做题-2"><a href="#做题-2" class="headerlink" title="做题"></a>做题</h3><p>额……操作全都是对<strong>序列中</strong>进行，分个鬼的块啊！但是毕竟这是“第四分块”，加上出题人lxl，估计还得分，就硬分！</p><p>还是考虑对序列分块，同时记录每一块内每一个数的个数，对于询问，如果有一个块同时包含两个数，直接暴力，时间 $O(B)$ ；否则吧每个块当成一个点，点上只有 $x, y, 0$ 三种信息，找到最近的 $x, y$ ，整块直接加，散点暴力，时间为 $O(2B + \frac{n}{B})$ ，修改就并查集维护即可，考虑到每次修改是对于整个序列，可以所有数共用一个并查集，不存在散点的情况，块长取 $B = \sqrt{n}$ 时，时空复杂度为均为 $O(n \sqrt{n})$ ，希望它别卡常……</p><p>艹，打到一半意识到这是完全假的，因为可能会有多个块同时包含两个数，而且还有可能出现两个相邻块最优，或者多个跨块最优……总之就是完全假掉了</p><p>臭不要脸的康康题解~</p><p>原来正解是根号分治（那为啥要叫第四分块啊！不过好像有人分块卡过了），不过既然是学习，当然学更稳当的根号分治了（就是平衡时间复杂度）</p><p>在讲正解前，先明确一些东西：</p><p>先考虑暴力的做法，当然是对每个数维护一个<strong>有序</strong>的位置集合，合并时归并排序，查询类似归并用双指针，但不合并，据说这样有 $60pts$ （夭寿了！lxl出的题有暴力分了！）</p><p>设 <code>si[x]</code> 表示 $x$ 在序列中出现的次数，当 <code>si[x] &gt; lim</code> （ $lim$ 是阈值）时称其为<strong>大点</strong>，否则是<strong>小点</strong>；定义数组 <code>as[x][y]</code> 有意义当且仅当 $x$ 是大点，其意义为“大点 $x$ 到值 $y$ 的最小距离”；定义<strong>附属集合</strong> <code>v[x]</code> 表示“自上一次重构以来，新出现的 $x$ 的位置”</p><p>我们要保证所有附属集合的大小不超过 $lim$ ，具体的，每当一个点 $x$ 的附属集合的大小超过 $lim$ ，我们就暴力跟新 <code>as[x][]</code> （此时 $x$ 必为大点），暴力可以做到 $O(n)$ ，我们称这个操作为<strong>重构</strong></p><p>另外，在修改操作把 $x$ 变成 $y$ 时，可以开一个数组 <code>val[x]</code> 代表值 $x$ 的真实值，这样我们就可以交换 $x, y$ 了，只要记得只要修改一下 $val$ 即可</p><p>好，现在来看根号分治：</p><p>因为 $x, y$ 可以交换，所以只考虑 <code>si[x] &lt;= si[y]</code> 的情况 </p><p>对于修改，设把 $x$ 变成 $y$ </p><ul><li>若 $x$ 是小点，暴力归并二者的附属集合（把 $x$ 并入 $y$ ）；如果合并后（这是预判，不必真的合并） $y$ 的附属集合大小超过 $lim$ 就重构 $y$ </li><li>若 $x$ 为大点（此时 $y$ 必为大点），显然把 $x$ 当成 $y$ 直接暴力重构（为啥不合并呢？因为 $x$ 是大点，它的一部分答案信息已经在 <code>as[x][]</code> 里了，附属集合记录信息不完全）</li></ul><p>重构发生会把至少 $lim$ 个数从附属集合里除去，它们的信息被记在了 $as$ 中，且它们<strong>不会在出现在任何附属集合内</strong>了，而当所有附属集合都为空时，显然不会再发生重构，所以重构最多发生 $\frac{n}{lim}$ 次</p><p>合并附属集合显然是 $O(lim)$ ，不重构只修改 <code>as[][y]</code> 是 $O(\frac{n}{lim})$ 所以修改的时间复杂度为 $O(m * \max(lim, \frac{n}{lim}) + n * \frac{n}{lim})$ </p><p>对于查询 $x, y$ </p><p>先暴力“归并”（不合并）二者附属集合，再与两个数中大点的 $as$ 取 $\min$ </p><p>查询的时间为 $O(m * lim)$ </p><p>最后关于空间，最多有 $\frac{n}{lim}$ 个大点，而每个点的附属集合最多有 $lim$ 个数，所以空间为 $O(\frac{n}{lim} * a + n * lim)$ ，另外一定注意 <code>vector</code> 的 <code>clear</code> <strong>不释放空间</strong>，具体写法见代码</p><p>明显，因为 $n, m, a$ 同级， $lim = \sqrt{n}$ 时时空都达到最优（然而实际上一般出题人都会卡 $\sqrt{n}$ 的，开大点可能好些，但本题不必）</p><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">10000</span> + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    IL <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> L = <span class="number">317</span>, NL = L + <span class="number">5</span>, N = <span class="number">1e5</span> + L + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N];</span><br><span class="line"><span class="comment">//id记录大点编号</span></span><br><span class="line"><span class="keyword">int</span> lim, si[N], as[NL][N], id[N], val[N], tot = <span class="number">0</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; v[N];</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">write_Ikaros</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">putc</span>(<span class="string">&#x27;I&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;k&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;a&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;r&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;o&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;s&#x27;</span>), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//重构</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!id[x])</span><br><span class="line">        id[x] = ++tot;</span><br><span class="line">    <span class="keyword">int</span> t = id[x];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">        as[t][i] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = INF; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (a[i] == x)</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            as[t][a[i]] = <span class="built_in">min</span>(as[t][a[i]], ++j);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n, j = INF; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (a[i] == x)</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            as[t][a[i]] = <span class="built_in">min</span>(as[t][a[i]], ++j);</span><br><span class="line">    as[t][x] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//把v和一个空vector交换,开在函数里的会被释放</span></span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; l18qAKIOI;</span><br><span class="line">    v[x].<span class="built_in">swap</span>(l18qAKIOI);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">//合并</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, sx = v[x].<span class="built_in">size</span>(), sy = v[y].<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; sx &amp;&amp; j &lt; sy)</span><br><span class="line">        t.<span class="built_in">push_back</span>(v[x][i] &lt; v[y][j] ? v[x][i++] : v[y][j++]);</span><br><span class="line">    <span class="keyword">while</span> (i &lt; sx)</span><br><span class="line">        t.<span class="built_in">push_back</span>(v[x][i++]);</span><br><span class="line">    <span class="keyword">while</span> (j &lt; sy)</span><br><span class="line">        t.<span class="built_in">push_back</span>(v[y][j++]);</span><br><span class="line">    v[y] = t;</span><br><span class="line">&#125;</span><br><span class="line">IL <span class="keyword">int</span> _merge(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, sx = v[x].<span class="built_in">size</span>(), sy = v[y].<span class="built_in">size</span>(), res = INF;</span><br><span class="line">    <span class="keyword">if</span> (!sx || !sy)</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; sx &amp;&amp; j &lt; sy)</span><br><span class="line">        res = <span class="built_in">min</span>(res, v[x][i] &lt; v[y][j] ? v[y][j] - v[x][i++] : v[x][i] - v[y][j++]);</span><br><span class="line">    <span class="keyword">while</span> (i &lt; sx)</span><br><span class="line">        res = <span class="built_in">min</span>(res, <span class="built_in">abs</span>(v[x][i++] - v[y][sy - <span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">while</span> (j &lt; sy)</span><br><span class="line">        res = <span class="built_in">min</span>(res, <span class="built_in">abs</span>(v[x][sx - <span class="number">1</span>] - v[y][j++]));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> _x = val[x], _y = val[y];</span><br><span class="line">    <span class="keyword">if</span> (!si[_x] || _x == _y)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">if</span> (si[_x] &gt; si[_y])</span><br><span class="line">        val[y] = _x, <span class="built_in">swap</span>(_x, _y);</span><br><span class="line">    val[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (!_x || !_y)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    x = _x, y = _y;</span><br><span class="line">    <span class="keyword">if</span> (si[x] &gt; lim)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (a[i] == x)</span><br><span class="line">                a[i] = y;</span><br><span class="line">        <span class="built_in">build</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : v[x])</span><br><span class="line">            a[i] = y;</span><br><span class="line">        <span class="keyword">if</span> (si[x] + v[y].<span class="built_in">size</span>() &lt;= lim)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//重构y就不必进行这个跟新了,反正as[y][]是准确的</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; ++i)</span><br><span class="line">                as[i][y] = <span class="built_in">min</span>(as[i][y], as[i][x]);</span><br><span class="line">            <span class="built_in">merge</span>(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">build</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    si[y] += si[x], si[x] = <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; wfyAKNOI;</span><br><span class="line">    v[x].<span class="built_in">swap</span>(wfyAKNOI);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = val[x], y = val[y];</span><br><span class="line">    <span class="keyword">if</span> (!si[x] || !si[y])</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x == y)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> res = _merge(x, y);</span><br><span class="line">    <span class="keyword">if</span> (si[y] &gt; lim)</span><br><span class="line">        res = <span class="built_in">min</span>(res, as[id[y]][x]);</span><br><span class="line">    <span class="keyword">if</span> (si[x] &gt; lim)</span><br><span class="line">        res = <span class="built_in">min</span>(res, as[id[x]][y]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> last = <span class="number">0</span>, op, x, y;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    lim = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]), ++si[a[i]], v[a[i]].<span class="built_in">push_back</span>(i), val[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (si[i] &gt; lim)</span><br><span class="line">            <span class="built_in">build</span>(i);</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">        x ^= last, y ^= last;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">modify</span>(x, y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((last = <span class="built_in">ask</span>(x, y)) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">write_Ikaros</span>(), last = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">write</span>(last), <span class="built_in">putc</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">flus</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="其它-2"><a href="#其它-2" class="headerlink" title="其它"></a>其它</h3><p>天降之物也挺好看的，但可惜 $09$ 年是钢炼的天下</p><h2 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h2><p>在写到这里时，已经 $7000$ 字了，才完成 $\frac{1}{3}$ ，觉定分成几部分（目前想的是三篇，到时候看吧）</p><p>已经打了两天的分块了，我都要吐了，缓缓再战，下一篇写好会在这里挂链接的</p><p>update：<a href="https://dyd-true.github.io/2022/01/25/%E5%A4%A7%E5%8A%9B%E5%88%86%E5%9D%972/#more">大力分块2</a></p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguCF896D Nephren Runs a Cinema</title>
      <link href="/2022/01/24/luoguCF896D-Nephren-Runs-a-Cinema/"/>
      <url>/2022/01/24/luoguCF896D-Nephren-Runs-a-Cinema/</url>
      
        <content type="html"><![CDATA[<p> 神仙dp？A了这题就去搞分块</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/CF896D">Nephren Runs a Cinema</a></p><p>一眼看过去就是卡特兰数</p><p>但VIP用户怎么办？我们发现他们在哪里都不影响答案，直接先不管他们，最后插入即可，就是把方案数乘一个 $\binom{n}{o}$ ， $o$ 代表有多少个VIP</p><p>来<del>推倒</del>推导卡特兰数， $Cat_n = \frac{\binom{2n}{n}}{n + 1} = \binom{2n}{n} - \binom{2n}{n - 1}$ </p><p>所以，合法方案数就是：<br>$$<br>(\sum_{j = l}^r \binom{n - o}{\frac{n - o - j}{2}} - \binom{n - o}{\frac{n - o - j}{2} - 1}) * \binom{n}{o}<br>$$<br>发现 $i, j$ 必定同奇偶，且 $j$ 是；连续的，直接消掉中间项，变为：<br>$$<br>(\binom{n - o}{\frac{n - o - l}{2}} - \binom{n - o}{\frac{n - o - r - 1}{2}}) * \binom{n}{o}<br>$$<br>枚举 $o$ 用时 $O(n)$ </p><p>但模数不是质数，考虑将模数分解，预处理阶乘的时候把包含模数的质因子取出来，记下指数，然后再乘回来</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, D = <span class="number">40</span>;</span><br><span class="line"><span class="keyword">int</span> n, p, l, r, phi;</span><br><span class="line"><span class="keyword">int</span> pr[N], inv[N], fac[N], c[N][D], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % p;</span><br><span class="line">        x = (LL)x * x % p;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi = p;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = fac[<span class="number">1</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> t = p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= t / i; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (t % i)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        phi = (LL)phi / i * (i - <span class="number">1</span>);</span><br><span class="line">        pr[++cnt] = i;</span><br><span class="line">        <span class="keyword">while</span> (!(t % i))</span><br><span class="line">            t /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t &gt; <span class="number">1</span>)</span><br><span class="line">        pr[++cnt] = t, phi = (LL)phi / t * (t - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        t = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            c[i][j] = c[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">while</span> (!(t % pr[j]))</span><br><span class="line">                t /= pr[j], ++c[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        fac[i] = (LL)fac[i - <span class="number">1</span>] * t % p;</span><br><span class="line">        inv[i] = <span class="built_in">qpow</span>(fac[i], phi - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y &lt; <span class="number">0</span> || x &lt; y || n &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (!y)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = (LL)fac[x] * inv[y] % p * inv[x - y] % p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">        res = (LL)res * <span class="built_in">qpow</span>(pr[i], c[x][i] - c[y][i] - c[x - y][i]) % p;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;p, &amp;l, &amp;r);</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    r = <span class="built_in">min</span>(r, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - l; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> t = ((LL)<span class="built_in">C</span>(n - i, (n - i - l) &gt;&gt; <span class="number">1</span>) - <span class="built_in">C</span>(n - i, (n - i - r - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) + p) % p;</span><br><span class="line">        ans = (ans + (LL)t * <span class="built_in">C</span>(n, i) % p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>废话：</p><p>接下来开始搞大分块！</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 组合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguCF896E Welcome home, Chtholly</title>
      <link href="/2022/01/24/luoguCF896E-Welcome-home-Chtholly/"/>
      <url>/2022/01/24/luoguCF896E-Welcome-home-Chtholly/</url>
      
        <content type="html"><![CDATA[<p> 指令集</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/CF896E">Welcome home, Chtholly</a></p><p>很难的分块暴力……</p><p>但是指令集可以过！</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">&quot;Ofast,no-stack-protector&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC target(<span class="meta-string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">namespace</span> Fast</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> L = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">char</span> buf[L], out[L], *iS, *iT;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> gh() (iT == iS ? iT = (iS = buf) + fread(buf, 1, L, stdin), (iT == iS ? EOF : *iS++) : *iS++)</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt; </span></span><br><span class="line"><span class="function">    <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            x = x * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = <span class="built_in">gh</span>();</span><br><span class="line">        <span class="keyword">if</span> (t)</span><br><span class="line">            x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">flus</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">fwrite</span>(out, <span class="number">1</span>, l, stdout);</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">putc</span><span class="params">(<span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out[l++] = x;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;class T&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">putc</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">            <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">        out[l++] = x % <span class="number">10</span> + <span class="number">48</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == L - <span class="number">5</span>)</span><br><span class="line">            <span class="built_in">flus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Fast::flus;</span><br><span class="line"><span class="keyword">using</span> Fast::putc;</span><br><span class="line"><span class="keyword">using</span> Fast::read;</span><br><span class="line"><span class="keyword">using</span> Fast::write;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N];</span><br><span class="line"><span class="keyword">float</span> x;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> op, l, r, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">read</span>(op), <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">                a[i] -= (a[i] &gt; x) ? x : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">                ans += !(a[i] - x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>良心有点不安，后面会补分块做法的</p><p>update $2022/1/25$ ：学完第二分块了，一看这不就是板子题吗？直接看<a href="https://www.luogu.com.cn/problem/P4117">这个题</a>好了，代码我blog里有</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5064 [Ynoi2014] 等这场战争结束之后</title>
      <link href="/2022/01/24/luoguP5064-Ynoi2014-%E7%AD%89%E8%BF%99%E5%9C%BA%E6%88%98%E4%BA%89%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E/"/>
      <url>/2022/01/24/luoguP5064-Ynoi2014-%E7%AD%89%E8%BF%99%E5%9C%BA%E6%88%98%E4%BA%89%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E/</url>
      
        <content type="html"><![CDATA[<p> 做了那么久的水题，来道有难度的</p><span id="more"></span><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p><a href="https://www.luogu.com.cn/problem/P5064">等这场战争结束之后</a></p><p>题意和永无乡类似，多了一个回退操作，支持回到第 $x$ 次操作后的状态， $n, m \le 10^5$ ，时间 $500ms$ ，空间 $20MB$ </p><p>先不管时空，看操作</p><h2 id="回退"><a href="#回退" class="headerlink" title="回退"></a>回退</h2><p>先看比永无乡多的这个操作，说是回退，但其实又和一般回退不同，因为它是“回到第 $x$ 次操作后的状态”，不只是这期间的加边要撤销，这期间的“回到……”也要撤销掉</p><p>那咋办呢？考虑建树，具体地，建出 $0$ 号点为根，对于第 $i$ 次操作（它的编号为 $i$ ），如果它是加边，就让它的父亲为 $i - 1$ ；如果是回到 $x$ ，就让它的父亲为 $x$ ；如果是询问，其实可以打标记的，但是最坏情况下对时空都没有优化，所以还是直接让它的父亲为 $i - 1$ 即可</p><p>这样只要dfs遍历一遍操作树，根据节点信息操作，就可以得到答案，时空消耗均为 $O(n)$ ，可以接受</p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>现在来看如何根据节点信息操作，首先这是dfs，所以我们的操作必须支持撤销，且能够在线维护加边（联通）和查询第 $k$ 小</p><p>可撤销的查询第 $k$ 小可以考虑可持久化平衡树，但sm的空间（ $20MB$ ）不允许，考虑分块，对值域进行分块，记得离散化，单次 $O(\sqrt{n})$ </p><p>加边很明显用并查集，不打路径压缩，按秩合并单次询问可以做到 $O(\log n)$ </p><h2 id="时空"><a href="#时空" class="headerlink" title="时空"></a>时空</h2><p>现在来看时空限制，明显时空都是 $O(n\sqrt{n})$ ，一般的题也就过去了，但这个出题人不一般</p><p>时间 $500ms$ 没问题，但 $20MB$ 的空间只允许 $n \log n$ ，shit</p><p>尝试卡块数，设为 $B$ ，发现：</p><ul><li> $B \le 25$ 时， $96pts$ TLE</li><li> $25 &lt; B \le 27$ ， $92pts$ TLE + WA（不知道为啥WA）</li><li> $B &gt; 27$ ， $88pts$ MLE</li></ul><p>这就是由乃oi吗，i了i了</p><p>但是，我们发现 <code>short</code> 可以存 $2^{15} - 1$ ，大概 $3 \times 10^4$ ，而 $n / B$ 在 $B &gt; 10$ 的情况下不大于 <code>short</code> 所以可以开成 <code>short</code> ，空间变为 $O(\frac{n B}{2})$ ，计算出  $20MB = 20 * 1024 * 1024B$ ， $n \le 10^5$ ，不难发现 $20 * 1024 * 1024 / 2 / n$ ， $B$ 大概可以开 $100$ ，但别的数组也要空间呀，所以 $B$ 开个 $50$ 差不多</p><h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>调试时遇到一些问题，莫名其妙输出 $0$ ，样例太水了，手打了 $makedate$ 和脚本对拍：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//make_date.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">rand</span>() % <span class="number">100000</span>, m = <span class="built_in">rand</span>() % <span class="number">100000</span>;</span><br><span class="line">cout &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; m &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="built_in">rand</span>() % <span class="number">10000</span>;</span><br><span class="line">cout &lt;&lt; a &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> op = <span class="built_in">rand</span>() % <span class="number">3</span> + <span class="number">1</span>;</span><br><span class="line">cout &lt;&lt; op &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">rand</span>() % i;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">rand</span>() % n + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> y = <span class="built_in">rand</span>() % (i / <span class="number">2</span> + <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; y &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#check.bat</span><br><span class="line">g++ -o std std.cpp</span><br><span class="line">g++ -o t t.cpp</span><br><span class="line">g++ -o make_d make_d.cpp</span><br><span class="line">:<span class="built_in">label</span></span><br><span class="line">.\make_d &gt; t.<span class="keyword">in</span></span><br><span class="line">.\t &lt; t.<span class="keyword">in</span> &gt; t.out</span><br><span class="line">.\std &lt; t.<span class="keyword">in</span> &gt; t.ans</span><br><span class="line">fc /w /a t.out t.ans</span><br><span class="line"><span class="keyword">if</span> &quot;<span class="variable">%errorlevel%</span>&quot; == &quot;<span class="number">0</span>&quot; <span class="keyword">goto</span> <span class="built_in">label</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>调出来发现是 <code>ask</code> 函数里面 <code>for (int i = (y - 1) * blk + 1, t = y * blk; i &lt;= t &amp;&amp; k; ++i)</code> 写成了 <code>for (int i = (y - 1) * blk + 1, t = y * num; i &lt;= t &amp;&amp; k; ++i)</code> 导致询问大小只有 $1$ 的联通块时输出 $0$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, B = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> si[N], fa[N];</span><br><span class="line"><span class="keyword">int</span> blk, num;</span><br><span class="line"><span class="keyword">short</span> cnt[N][B + <span class="number">5</span>]; <span class="comment">//short立大功</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> typ, x, y, ans;</span><br><span class="line">&#125; que[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> val &lt; t.val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; p[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == fa[x] ? x : <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> typ)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (si[x] &gt; si[y])</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">    fa[x] = (typ == <span class="number">1</span> ? y : x), si[y] += si[x] * typ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num; ++i)</span><br><span class="line">        cnt[y][i] += cnt[x][i] * typ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &gt; si[x = <span class="built_in">find</span>(x)])</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= num &amp;&amp; !y; ++i)</span><br><span class="line">        <span class="keyword">if</span> (k &gt; cnt[x][i])</span><br><span class="line">            k -= cnt[x][i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            y = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = (y - <span class="number">1</span>) * blk + <span class="number">1</span>, t = y * blk; i &lt;= t &amp;&amp; k; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(p[i].id) == x)</span><br><span class="line">            --k, res = p[i].val;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> typ1 = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (que[x].typ == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        que[x].x = <span class="built_in">find</span>(que[x].x), que[x].y = <span class="built_in">find</span>(que[x].y);</span><br><span class="line">        <span class="keyword">if</span> (que[x].x ^ que[x].y) <span class="comment">//就是que[x].x != que[x].y</span></span><br><span class="line">            typ1 = <span class="literal">true</span>, <span class="built_in">merge</span>(que[x].x, que[x].y, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (que[x].typ == <span class="number">3</span>)</span><br><span class="line">        que[x].ans = <span class="built_in">ask</span>(que[x].x, que[x].y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">        <span class="built_in">dfs</span>(e[i].ver);</span><br><span class="line">    <span class="keyword">if</span> (typ1)</span><br><span class="line">        <span class="built_in">merge</span>(que[x].x, que[x].y, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    blk = n / B; <span class="comment">//这里B是块数,blk是块长</span></span><br><span class="line">    <span class="keyword">if</span> (!blk)</span><br><span class="line">        blk = <span class="number">1</span>;</span><br><span class="line">    num = (n - <span class="number">1</span>) / blk + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;p[i].val);</span><br><span class="line">        p[i].id = i;</span><br><span class="line">        si[fa[i] = i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//离散化</span></span><br><span class="line">    <span class="built_in">sort</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ++cnt[p[i].id][(i - <span class="number">1</span>) / blk + <span class="number">1</span>];</span><br><span class="line">    <span class="comment">//操作树</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;que[i].typ);</span><br><span class="line">        <span class="keyword">if</span> (que[i].typ == <span class="number">2</span>)</span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;que[i].x);</span><br><span class="line">            <span class="built_in">add</span>(que[i].x, i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(i - <span class="number">1</span>, i);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;que[i].x, &amp;que[i].y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="keyword">if</span> (que[i].typ == <span class="number">3</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, que[i].ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 分块 </tag>
            
            <tag> 并查集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>圆方树</title>
      <link href="/2022/01/23/%E5%9C%86%E6%96%B9%E6%A0%91/"/>
      <url>/2022/01/23/%E5%9C%86%E6%96%B9%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 又一个奇怪的树</p><span id="more"></span><h1 id="圆方树"><a href="#圆方树" class="headerlink" title="圆方树"></a>圆方树</h1><p>圆方树（Block forest）是一种树的结构，它能轻松的将仙人掌转化为树，并支持一些操作，有时我们也可以在一般无向图上使用它</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>先明确一些基本定义：</p><ol><li>仙人掌：每条边在不超过一个简单环中的无向图</li><li>点双连通分量：图中任意两不同点之间都有至少两条点不重复的路径</li></ol><p>要构造圆方树，当然是要构造出<strong>圆点</strong>和<strong>方点</strong>，圆点比较简单，直接保留仙人掌上的点即可；然后对仙人掌进行点双 $Tarjan$ 缩点，每一个点双就是一个方点</p><p>对于边，原图上的边统一不要，直接从所以方点向它对应的点双包括的圆点连边，这样，每一个点双就形成了以方点为根，圆点为叶的“菊花图”，而这很多个“菊花图”通过原图中的割点连接在一起（因为点双的分隔点是割点），如图：</p><p><img src="https://s2.loli.net/2022/01/23/qSYP7zrElZT8UAV.png" alt="圆方树"></p><p>圆方树的点数小于 $2n$ ，所以请注意各种数组大小要开两倍</p><p>其实，如果原图连通，则“圆方树”才是一棵树，如果原图有 $k$ 个连通分量，则它的圆方树也会形成 $k$ 棵树形成的森林</p><p>如果原图中某个连通分量只有一个点，则需要具体情况具体分析，我们在后续讨论中不考虑孤立点</p><h2 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h2><p>直接对原图进行 $Tarjan$ ，因为原图上每个环都是一个点双，而且在栈中的顺序就是环上点的顺序，如果一个点 $i$ 的出边 $(i, j)$ 满足 $dfn(i) &lt; low(j)$ ，说明 $(i, j)$ 是一条树边，直接加上即可；如果 $dfn(i) = low(j)$ ，那么我们找到了一个环（可能是重边造成的二元环），则从栈中取出点直到取出 $j$ 为止，设这样从栈中取出的点集为 $R$ ，则 $i$ 和 $R$ 构成一个环</p><p>对于环，我们新建一个方点，对环上每个点连边即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; G[N], T[N * <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n, m, cnt;</span><br><span class="line"><span class="keyword">int</span> stk[N], top;</span><br><span class="line"><span class="keyword">int</span> dfn[N], low[N], dfc = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    low[x] = dfn[x] = ++dfc;</span><br><span class="line">    stk[++top] = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : G[x])</span><br><span class="line">        <span class="keyword">if</span> (!dfn[y])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x] = <span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">            <span class="keyword">if</span> (low[y] == dfn[x])<span class="comment">//标志着找到一个以x为根的点双连通分量</span></span><br><span class="line">            &#123;</span><br><span class="line">                ++cnt; <span class="comment">//增加方点个数</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z != y; --top) <span class="comment">//这里一定要让z=0!</span></span><br><span class="line">                &#123;</span><br><span class="line">                    z = stk[top];</span><br><span class="line">                    T[cnt].<span class="built_in">push_back</span>(z);</span><br><span class="line">                    T[z].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//注意x自身也要连边（但不退栈）</span></span><br><span class="line">                T[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">                T[x].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    cnt = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        G[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        G[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (!dfn[i])</span><br><span class="line">            <span class="built_in">tarjan</span>(i), --top;</span><br><span class="line">    <span class="comment">//注意到退出Tarjan时栈中还有一个元素即根,将其退栈</span></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j : T[i])</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; j &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>圆方树有优美的性质：</p><ol><li>无论如何换根，圆方树形态不变，因为你是把环连成菊花而不是别的什么</li><li>圆方树的子树 = 原仙人掌的子仙人掌，分类讨论各种情况可以证明</li><li>方点不会和方点相连</li></ol><p>还有其他神奇的性质，要具体题目具体分析</p><h2 id="一些应用"><a href="#一些应用" class="headerlink" title="一些应用"></a>一些应用</h2><p>下面开始口胡</p><h3 id="仙人掌最短路"><a href="#仙人掌最短路" class="headerlink" title="仙人掌最短路"></a>仙人掌最短路</h3><p>类比<a href="https://blog.csdn.net/qq_36316033/article/details/79889173">树上最短路</a>，我们在LCA处考虑，然而圆方树的树上距离并不一定就等于仙人掌上的最短路长度</p><p>注意到圆方树中的边权都还没有确定，可以利用，如果一条边是圆圆边（圆点指向圆点的边，这里已经任意选择一圆点为根），那么它是一个树边，边权等于原仙人掌上边权；如果是方圆边，那么边权等于环的根到那个圆点的最短路径长度；如果是圆方边，那么边权为 $0$ </p><p>这样，如果一对询问点在圆方树上的LCA是圆点，那么其圆方树上长度就是原仙人掌上长度，因为路径上唯一的不同就在于对于每个环是走哪一侧（这个决策对每个环是独立的），而前面边权的确定已经解决了这一问题；</p><p>如果LCA是方点，则我们只需要考虑在LCA这个环中是否要走经过根的那一侧，需要找出这两个询问点 $(x, y)$ 分别是在这个方点的哪两个儿子 $(px, py)$ 的子树中，求同一个环上的点 的最短路径（其实也就是走哪一侧的问题 ）可以先记录环上边权的前缀和，这样就能 $O(1)$ 计算出不经过根那条路径的长度，再通过记录整个环的边权和比较出走哪一侧更优</p><h3 id="仙人掌dp"><a href="#仙人掌dp" class="headerlink" title="仙人掌dp"></a>仙人掌dp</h3><p>仙人掌有若干种DP，比如最大独立集和直径</p><p>最大独立集比较简单，只需要DFS时，树边按照树上独立集的方式转移，环上用一个 <code>f[i][0/1][0/1]</code> 的简单DP去转移即可</p><p>求直径的话，我们类比求树直径的方式，在LCA处考虑，设 <code>f[i][1/2]</code> 为 $i$ 子树中的第 $j$ 深的点，那么圆点可以轻松转移、更新答案；在方点转移也容易，但更新答案不能直接更新（因为有哪一侧的问题，直接取不一定是最短路，会导致答案偏大），我们可以把环复制一份用单调队列来解决，也可以正反各做一次前缀和</p><h3 id="等等"><a href="#等等" class="headerlink" title="等等"></a>等等</h3><p>算了，反正我也不会，看<a href="https://immortalco.blog.uoj.ac/blog/1955">这个</a>吧</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>还是给道题：</p><p><a href="https://www.luogu.com.cn/problem/P4606">战略游戏</a></p><p>这是一道图上圆方树</p><p>先建出圆方树，则要求删掉多少个圆点后 $S$ 在圆方树上对应的圆点不全连通，这就是连通子图中的圆点个数减去 $|S|$ ，或者说，圆方树上 $S$ 中节点两两间路径（树上只有唯一路径）的点集并减去 $S$ </p><p>如何计算连通子图中的圆点个数？有一个方法：</p><p>把圆点的权值放到它和它的父亲方点的边上，问题转化为求边权和，即把 $S$ 中的点按照DFS序排序，计算排序后相邻两点的距离和（还包括首尾两点之间的距离），答案就是距离和的一半，因为每条边只被经过两次</p><p>最后，如果子图中的深度最浅的节点是圆点，答案还要加上 $1$ ，因为我们没有统计到它</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, D = <span class="number">25</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; G[N], T[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> n, m, cnt, q;</span><br><span class="line"><span class="keyword">int</span> stk[N], top;</span><br><span class="line"><span class="keyword">int</span> dfn[N &lt;&lt; <span class="number">1</span>], low[N], dfc = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dep[N &lt;&lt; <span class="number">1</span>], f[N &lt;&lt; <span class="number">1</span>][D + <span class="number">5</span>], dis[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    low[x] = dfn[x] = ++dfc;</span><br><span class="line">    stk[++top] = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : G[x])</span><br><span class="line">        <span class="keyword">if</span> (!dfn[y])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x] = <span class="built_in">min</span>(low[x], low[y]);</span><br><span class="line">            <span class="keyword">if</span> (low[y] == dfn[x])</span><br><span class="line">            &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z != y; --top)</span><br><span class="line">                &#123;</span><br><span class="line">                    z = stk[top];</span><br><span class="line">                    T[cnt].<span class="built_in">push_back</span>(z);</span><br><span class="line">                    T[z].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">                &#125;</span><br><span class="line">                T[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">                T[x].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            low[x] = <span class="built_in">min</span>(low[x], dfn[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dfn[x] &lt; dfn[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dfn[x] = ++dfc;</span><br><span class="line">    dep[x] = dep[f[x][<span class="number">0</span>] = fa] + <span class="number">1</span>;</span><br><span class="line">    dis[x] = dis[fa] + (x &lt;= n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= D; ++i)</span><br><span class="line">        f[x][i] = f[f[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : T[x])</span><br><span class="line">        <span class="keyword">if</span> (y != fa)</span><br><span class="line">            <span class="built_in">dfs</span>(y, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y])</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = D; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (dep[f[y][i]] &gt;= dep[x])</span><br><span class="line">            y = f[y][i];</span><br><span class="line">    <span class="keyword">if</span> (y == x)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = D; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (f[x][i] != f[y][i])</span><br><span class="line">            x = f[x][i], y = f[y][i];</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> TT;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;TT);</span><br><span class="line">    <span class="keyword">while</span> (TT--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            G[i].<span class="built_in">clear</span>();</span><br><span class="line">            dfn[i] = low[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= (n &lt;&lt; <span class="number">1</span>); ++i)</span><br><span class="line">            T[i].<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            G[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">            G[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        cnt = n;</span><br><span class="line">        dfc = <span class="number">0</span>, <span class="built_in">tarjan</span>(<span class="number">1</span>), --top;</span><br><span class="line">        dfc = <span class="number">0</span>, <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">        <span class="keyword">while</span> (q--)</span><br><span class="line">        &#123;</span><br><span class="line">            STC <span class="keyword">int</span> s, a[N];</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;s);</span><br><span class="line">            <span class="keyword">int</span> ans = s * <span class="number">-2</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= s; ++i)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">            <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + s, cmp);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= s; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> u = a[i], v = a[i % s + <span class="number">1</span>];</span><br><span class="line">                ans += dis[u] + dis[v] - <span class="number">2</span> * dis[<span class="built_in">lca</span>(u, v)];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">lca</span>(a[<span class="number">1</span>], a[s]) &lt;= n)</span><br><span class="line">                ans += <span class="number">2</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans / <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>带花树</title>
      <link href="/2022/01/23/%E5%B8%A6%E8%8A%B1%E6%A0%91/"/>
      <url>/2022/01/23/%E5%B8%A6%E8%8A%B1%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 莫名想到三十六计：树上开花</p><span id="more"></span><h1 id="带花树"><a href="#带花树" class="headerlink" title="带花树"></a>带花树</h1><p>Blossom Algorithm</p><h2 id="二分图最大匹配"><a href="#二分图最大匹配" class="headerlink" title="二分图最大匹配"></a>二分图最大匹配</h2><p>一般用匈牙利算法：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">        <span class="keyword">if</span> (!vis[y = e[i].ver])</span><br><span class="line">        &#123;</span><br><span class="line">            vis[y] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (!match[y] || <span class="built_in">dfs</span>(match[y]))</span><br><span class="line">            &#123;</span><br><span class="line">                match[y] = x;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="comment">//main里</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n + m; ++j)</span><br><span class="line">        vis[j] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">dfs</span>(i))</span><br><span class="line">        ++ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度是 $O(NM)$ 的</p><p>当然也可以网络流，并且网络流一般比匈牙利快，因为它的期望复杂度为 $O(M\sqrt{N})$ （Galil Zvi在论文Efficient Algorithms for Finding Maximal Matching in Graphs中证明）</p><h2 id="一般图最大匹配"><a href="#一般图最大匹配" class="headerlink" title="一般图最大匹配"></a>一般图最大匹配</h2><p>考虑一下二分图和一般图的最大区别，就是二分图没有<strong>奇环</strong>，而一般图是可以有的，所以匈牙利算法中的寻找增广路然后路径取反的方法在一般图上就不适用了</p><p>主要还是要解决奇环的问题</p><p>我们发现一个奇环里<strong>至少有一个点不能匹配</strong>，即这个点在环内两边的连边都不是匹配边，也<strong>只有这个点可以向环外连边</strong>，那就干脆把一个奇环缩成一个点（<strong>开花</strong>），路径取反的时候再暴力展开一个个取反，对原图用bfs找一条增广路，这棵节点可能是花的bfs树就称作带花树</p><p>正确性：</p><p>设原图为 $G$ ，缩花后图为 $G’$ ，我们只要证明“ $G$ 存在增广路的充要条件是 $G’$ 存在增广路”</p><p><img src="https://s2.loli.net/2022/01/23/srMLvVyG5lmN8xg.png" alt="看花"></p><p>首先要明确带花树的形态，如图，加粗的是匹配边。黑色是一个花上的边，红色是其它边，可以发现，整个花上只有 $h$ 一个非匹配点（这里的“匹配”是指和花内的点），也就只有它可以向外匹配，所以从环外的边出去有两种情况，顺时针或逆时针</p><p><img src="https://s2.loli.net/2022/01/23/oLKIV4Mzj7pceCk.png" alt="出花"></p><p>可以发现 $G$ 和 $G’$ 的增广路都可以对应</p><h2 id="增广"><a href="#增广" class="headerlink" title="增广"></a>增广</h2><p>带花树的本质还是寻找增广路</p><p>对于每个匹配 $(u \to v)$ 给 $u$ 染绿色， $v$ 染白色</p><p>遍历绿点的出边，如果访问到的点未被染色且未被匹配，那么就找到了一条增广路；如果被匹配了，则将该点染白色，将该点的匹配点染绿色并加入队列中</p><p>如果访问到的点是白点，那么找到了一个偶环，没有影响无需处理；如果访问到的点是绿点，那么找到了一个奇环，在bfs树上找到这两个点的lca即可定位这个奇环，可以用并查集将其缩起来，因为缩起来的环是一个绿点，所以环上的白点都需改成绿点并加入到队列中，这个缩奇环的操作就是开花</p><h2 id="开花"><a href="#开花" class="headerlink" title="开花"></a>开花</h2><p>还是对于每个匹配 $(u \to v)$ 给 $u$ 染绿色， $v$ 染白色，花外点表示为红色（它们也可能染了绿/白色），不妨就叫它们 $u$ 型点和 $v$ 型点（这仅是一种不严格的颜色命名，想表达的意思仅仅是“我们的增广从一个 $u$ 型点开始”），那么不难发现，花的根（ $C$ ）一定是 $u$ 型点（这样才有奇环的矛盾）</p><p><img src="https://s2.loli.net/2022/01/23/sOmTVgnl5w72Mtq.png" alt="hh"></p><p>那么遇到奇环时，一定是存在两个同类型点产生冲突（如 $I, J$ ），带花树算法的处理方法是：将花缩成一点，该点作为u型点向花外遍历，在修改増广路的时候再将花展开（这只是一种理解方式，实现时并不真正进行缩展，而是用并查集模拟缩花的过程，用反向 <code>pre</code> 保证花内部増广路的正确）</p><p>首先，我们考虑用一个并查集维护花根之间的关系（因为可能出现花套花的情况），即将花内所有分花根合并到新出现的总花根上（即一直维护一个“极大”的花）</p><p>然后处理花内部的増广路关系，这是带花树算法的精髓：</p><ol><li><p>在产生冲突前，奇数环上所有 $u$ 型点都已进行了从环内向环外的遍历</p></li><li><p>产生冲突后，我们分别以冲突的两点为新的出发点（当然是 $u$ 型） ，向对方方向继续染色増广</p><p>可以发现，对方方向上原本的 $v$ 型点，可以作为出点向花外遍历，而这条増广路是从<strong>花内距花根较远</strong>的一条路延伸来的</p></li><li><p>考虑如何记录这条较远的非常规路径。我们知道，在匈牙利算法中，对于每一对匹配中的被匹配点（ $v$ 型点），我们都会有一个 <code>match</code> 指向其前驱匹配节点（ $u$ 型点）（即图中的红色边），也就是说仅有 $v$ 型点具有 <code>pre</code> ；</p><p>然而在花中，所有点可以作为 $u$ 型点向外遍历，也就没有了严格的 $u, v$ 区分，因此无论 $u, v$ 染色情况如何，我们为花中所有匹配对之间建立相互的 <code>pre</code> ，具体实现见下（注意由于原本已有部分 <code>pre</code> ，即红色边，我们要根据特殊性质去建立剩余的 <code>pre</code> ，即蓝色边）</p><p>特别注意，如果到了u为根节点，就不要再反向建立 <code>pre</code> 了，因为它所在匹配对并不完全属于花！</p></li></ol><p>这样，无论以哪个点作为 $u$ 向环外遍历，我们在花内部都能得到正确的増广路</p><h2 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h2><p>可以发现，通过缩环减少一个点的复杂度为均摊 $O(\log n)$ ，因为使用了并查集。找到一条增广路最坏情况下需要遍历整张图，复杂度为 $O(n + m)$ ，总共就是 $O(n(n \log n + m))$ ，大概就是 $O(nm)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P6113">一般图最大匹配</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N * N];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> match[N], col[N], pre[N];</span><br><span class="line"><span class="keyword">int</span> fa[N];</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    match[x] = y, match[y] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dadd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!match[x] &amp;&amp; !match[y])</span><br><span class="line">        <span class="built_in">link</span>(x, y), ++ans;</span><br><span class="line">    <span class="built_in">add</span>(x, y), <span class="built_in">add</span>(y, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rev</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x)</span><br><span class="line">        <span class="comment">//奇妙的是,这里可以写成x[pre][match]</span></span><br><span class="line">        <span class="built_in">rev</span>(match[pre[x]]), <span class="built_in">link</span>(x, pre[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> dfn[N], cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    dfn是一个标记数组,一边打标即一边上跳，第一个重复点就是花根</span></span><br><span class="line"><span class="comment">花根一定是一个绿点,所以可以隔点上跳</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span> (++cnt; ;x = pre[match[x]], <span class="built_in">swap</span>(x, y))</span><br><span class="line">        <span class="keyword">if</span> (dfn[x = <span class="built_in">find</span>(x)] == cnt)</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x)</span><br><span class="line">            dfn[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">blossom</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> w)</span> <span class="comment">//缩奇环(开花)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; <span class="built_in">find</span>(x) != w; x = pre[y])</span><br><span class="line">    &#123;</span><br><span class="line">        pre[x] = y, y = match[x];</span><br><span class="line">        <span class="keyword">if</span> (col[y] == <span class="number">2</span>)</span><br><span class="line">            col[y] = <span class="number">1</span>, q.<span class="built_in">push</span>(y);</span><br><span class="line">        <span class="comment">//这里一定要判一下</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(x) == x)</span><br><span class="line">            fa[x] = w;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(y) == y)</span><br><span class="line">            fa[y] = w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">aug</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//带花树</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((ans + <span class="number">1</span>) * <span class="number">2</span> &gt; n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        fa[i] = i, col[i] = pre[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">for</span> (q.<span class="built_in">push</span>(x), col[x] = <span class="number">1</span>; !q.<span class="built_in">empty</span>(); q.<span class="built_in">pop</span>())</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u = q.<span class="built_in">front</span>(), i = h[u], v, w; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">find</span>(u) == <span class="built_in">find</span>(v = e[i].ver) || col[v] == <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!col[v])</span><br><span class="line">            &#123;</span><br><span class="line">                col[v] = <span class="number">2</span>, pre[v] = u;</span><br><span class="line">                <span class="keyword">if</span> (!match[v])</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">rev</span>(v), <span class="number">1</span>;</span><br><span class="line">                col[match[v]] = <span class="number">1</span>, q.<span class="built_in">push</span>(match[v]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">//缩环两个方向各一次拼起来</span></span><br><span class="line">                <span class="built_in">blossom</span>(u, v, w = <span class="built_in">lca</span>(u, v)), <span class="built_in">blossom</span>(v, u, w);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x, y; m--; <span class="built_in">dadd</span>(x, y))</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans += (!match[i] &amp;&amp; <span class="built_in">aug</span>(i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, match[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="随机匹配法"><a href="#随机匹配法" class="headerlink" title="随机匹配法"></a>随机匹配法</h2><p>还有一组和智慧法类似的东西，由luogu上<a href="https://www.luogu.com.cn/user/28313"><strong>皎月半洒花</strong></a>巨佬提出</p><p>思路就是随机匹配</p><p>发现匹配本质上就是在找增广路，但直接枚举每个点找增广路会有问题，对于一张二分图，一条增广路要么是一条奇链、要么是一条奇链套一个偶环，偶环上总可以完备匹配，所以绕偶数步走到原点并不改变下一条边的匹配状态；但是奇环则未必，如果经过一个奇环，就必然会存在冲突的情况</p><p>所以随机匹配的思想就是，不找环，只找长度为奇数的简单路，这样做相当于强制断环为链，正确性难以保证</p><p>但是考虑如果多做几次，错误率就会大大下降，于是考虑多做几次这样的匹配</p><p>注意到这样做很容易被卡掉，只需要多几个奇环顺便构造一下加边顺序就可以了，所以就可以每次走的时候将边随机一下即可</p><p>最后附上花巨的一句话（<del>听不懂但是好装B啊</del>）：“题是众生一般题，水是天下一样水”</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, ans;</span><br><span class="line"><span class="keyword">int</span> match[N], vis[N];</span><br><span class="line"><span class="comment">//clock_t 就是 long</span></span><br><span class="line"><span class="keyword">clock_t</span> st;</span><br><span class="line">DRG drg&#123;<span class="number">20051221</span>&#125;;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; e[N];</span><br><span class="line"><span class="function">DB <span class="title">when</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (DB)(<span class="built_in">clock</span>() - st) / CLOCKS_PER_SEC;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dadd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x, y), <span class="built_in">add</span>(y, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    match[x] = y, match[y] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">shuffle</span>(e[x].<span class="built_in">begin</span>(), e[x].<span class="built_in">end</span>(), drg);</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : e[x])</span><br><span class="line">        <span class="keyword">if</span> (!match[y])</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">link</span>(x, y), vis[y] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> y : e[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> z = match[y];</span><br><span class="line">        <span class="keyword">if</span> (vis[z])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">link</span>(x, y), match[z] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">work</span>(z))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">link</span>(y, z), match[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x, y; m--; <span class="built_in">dadd</span>(x, y))</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    st = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">when</span>() &lt; <span class="number">0.9</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!match[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">fill</span>(vis + <span class="number">1</span>, vis + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">                ans += <span class="built_in">work</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, match[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果是一般的出题人，也就认了，但是这个总有毒瘤搞不清立场，<a href="https://www.luogu.com.cn/discuss/316114">帮出题人造hack</a>，对此广大网友评价为：“卡 随 机 的 艺 术”</p><p>但有什么办法呢，人家是大佬（<del>反正我带花树过了</del>）</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>平面最近点对</title>
      <link href="/2022/01/23/%E5%B9%B3%E9%9D%A2%E6%9C%80%E8%BF%91%E7%82%B9%E5%AF%B9/"/>
      <url>/2022/01/23/%E5%B9%B3%E9%9D%A2%E6%9C%80%E8%BF%91%E7%82%B9%E5%AF%B9/</url>
      
        <content type="html"><![CDATA[<p> 我们充分发扬人类智慧</p><span id="more"></span><h1 id="平面最近点对"><a href="#平面最近点对" class="headerlink" title="平面最近点对"></a>平面最近点对</h1><p>这本来是一道分治</p><p>但是<strong>智慧法</strong>不香吗？</p><h2 id="圣经吟唱"><a href="#圣经吟唱" class="headerlink" title="圣经吟唱"></a>圣经吟唱</h2><p>在平面最近点对（加强版）里最高赞题解写道：</p><p>“我们充分发扬人类智慧：<br>将所有点全部绕原点旋转同一个角度，然后按 $x$ 坐标排序<br>根据数学直觉，在随机旋转后，答案中的两个点在数组中肯定不会离得太远<br>所以我们只取每个点向后的 $5$ 个点来计算答案<br>这样速度快得飞起，在 $n = 10^6$ 时都可以在 $1$ s 内卡过”</p><p>这开启了智慧法过本问题（<del>恶心出题人</del>）的新时代！</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>装模做样问一问：</p><p>给定 $n$ 个二维欧几里得平面上的点 $p_1, p_2, …, p_n$ 请输出距离最近的两个点的距离</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>由于这是出题人丧心病狂的<strong>加强加强版</strong>，一般的智慧法被卡，所以，考虑优化智慧法（智慧智慧法）：</p><ul><li>首先，必须旋转坐标系，防止出题人卡我们（但加强加强版的出题人已经疯狂到出 $152$ 组数据了，所以光这样还不行）</li><li>在时间允许的情况下，能往后多查找几个点就多查找几个点（本题实测 $100$ 卡死）</li><li>不以 $x$ 排序，而以 $x \times y$ 排序，因为 $x, y$ 应该是等价的（很玄学）</li></ul><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P7883">平面最近点对（加强加强版）</a></p><p>（ $152$ 个点跑了好久，出题人太丧心病狂了）</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LDB long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, K = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> LDB INF = <span class="number">2e30</span> + <span class="number">0.01</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LDB p[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> p[<span class="number">0</span>] * p[<span class="number">1</span>] &lt; t.p[<span class="number">0</span>] * t.p[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d &quot;</span>, &amp;n);</span><br><span class="line">    DRG e&#123;<span class="number">20051221</span>&#125;;</span><br><span class="line">    UID&lt;<span class="keyword">int</span>&gt; u;</span><br><span class="line">    LDB th = <span class="built_in">u</span>(e), ans = INF;</span><br><span class="line">    LDB z = <span class="built_in">sin</span>(th), w = <span class="built_in">cos</span>(th);</span><br><span class="line">    STC Point p[N];</span><br><span class="line">    LDB a, b, c, d;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%Lf %Lf&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        p[i] = &#123;a * w + b * z, -a * z + b * w, a, b&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//stable是稳定排序</span></span><br><span class="line">    <span class="built_in">stable_sort</span>(p + <span class="number">1</span>, p + <span class="number">1</span> + n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        a = p[i].p[<span class="number">2</span>], b = p[i].p[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K &amp;&amp; i + j &lt;= n; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            c = p[i + j].p[<span class="number">2</span>], d = p[i + j].p[<span class="number">3</span>];</span><br><span class="line">            ans = <span class="built_in">min</span>(ans, (a - c) * (a - c) + (b - d) * (b - d));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.0Lf&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随机数 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kahan求和</title>
      <link href="/2022/01/23/Kahan%E6%B1%82%E5%92%8C/"/>
      <url>/2022/01/23/Kahan%E6%B1%82%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<p> 又一个小知识</p><span id="more"></span><h1 id="Kahan求和"><a href="#Kahan求和" class="headerlink" title="Kahan求和"></a>Kahan求和</h1><p><strong>Kahan 求和</strong>算法，又名补偿求和或进位求和算法，是一个用来<strong>降低有限精度浮点数序列累加值误差</strong>的算法</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>计算机的浮点数误差有时候会导致很多问题，如下面</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> x;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">    x = -x;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    cout &lt;&lt; x &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>这样写是错误的，首先，比较浮点数最好写成函数，即 <code>cmp(x, 0) &lt; 0</code> ，其次，那个 <code>else</code> 也并非代表了 <code>x &gt;= 0</code> ，因为 $x$ 可能为 $NaN$ （not a number）</p><p>在比如，浮点数满足交换律，即 $a + b = b + a$ ，但不满足结合律即 $a + (b + c) \ne (a + b) + c$ </p><p>由于浮点数的种种误差，在只加几个数的时候还可以接受，但如果要把很多浮点数连加，在一些题目里面误差就无法接受了</p><p>William Kahan提出一种解决方法：用一个额外的浮点数记录误差，最后修正</p><p>具体地，如果现在正在加 $a$ ，而已有的和为 $sum_{old}$ ，则先计算 $sum_{now} = sum_{old} + a$ ，而误差用 $c$ 记录，跟新为 $c = c + (a - (sum_{now} - sum_{old}))$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">kahan</span><span class="params">(<span class="keyword">double</span> x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> sum = <span class="number">0</span>, c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> y = x[i] - c; <span class="comment">//先补上前面误差</span></span><br><span class="line">        <span class="keyword">double</span> t = sum + y;</span><br><span class="line">        c = (t - sum) - y; <span class="comment">//跟新误差</span></span><br><span class="line">        sum = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其它 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>扫描线</title>
      <link href="/2022/01/22/%E6%89%AB%E6%8F%8F%E7%BA%BF/"/>
      <url>/2022/01/22/%E6%89%AB%E6%8F%8F%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<p> 不只是线段树的那个……</p><span id="more"></span><h1 id="扫描线"><a href="#扫描线" class="headerlink" title="扫描线"></a>扫描线</h1><h2 id="普通"><a href="#普通" class="headerlink" title="普通"></a>普通</h2><p>虽然线段树那里已经学过一点扫描线了，但还是问一问：</p><p>给定一些矩形，求其面积并</p><p>这个太简单了，直接跳过了</p><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><p>看这个：</p><p>给定一些三角形，求其面积并</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>三角形比矩形讨厌的地方在于，矩形平行于坐标轴，只用考虑四个顶点，但三角形可以斜着</p><p>考虑把三角形用顶点和交点划分，如图：</p><p><img src="https://s2.loli.net/2022/01/22/xwI9XeSEKsFPWnp.jpg" alt="三角"></p><p>每两个红色的线之间不存在边的交点，换句话说，都是梯形（广义上的），直接两边线段长度求并，乘高除以二即可</p><p>由于三角形有 $n$ 个，两两间都可能有交点，故时间复杂度为 $O(N^3)$ </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P4406">三角形面积并</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-8</span>, INF = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; tr[N][<span class="number">3</span>], q[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">Point <span class="keyword">operator</span> + (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x + y.x, x.y + y.y&#125;;</span><br><span class="line">&#125;</span><br><span class="line">Point <span class="keyword">operator</span> - (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x - y.x, x.y - y.y&#125;;</span><br><span class="line">&#125;</span><br><span class="line">Point <span class="keyword">operator</span> * (Point x, DB y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x * y, x.y * y&#125;;</span><br><span class="line">&#125;</span><br><span class="line">DB <span class="keyword">operator</span> * (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.y - x.y * y.x;</span><br><span class="line">&#125;</span><br><span class="line">DB <span class="keyword">operator</span> &amp; (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.x + x.y * y.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_on</span><span class="params">(Point p, Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cmp</span>((p - x) &amp; (p - y), <span class="number">0</span>) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">cmp</span>(u * v, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">return</span> &#123;INF, INF&#125;;</span><br><span class="line">    DB t = (v * (p - q)) / (u * v);</span><br><span class="line">    <span class="keyword">auto</span> o = p + u * t;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">is_on</span>(o, p, p + u) || !<span class="built_in">is_on</span>(o, q, q + v))</span><br><span class="line">        o = &#123;INF, INF&#125;;</span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">l_area</span><span class="params">(DB x, <span class="keyword">int</span> side)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = tr[i];</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(t[<span class="number">0</span>].x, x) &gt; <span class="number">0</span> || <span class="built_in">cmp</span>(t[<span class="number">2</span>].x, x) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">cmp</span>(t[<span class="number">0</span>].x, x) &amp;&amp; !<span class="built_in">cmp</span>(t[<span class="number">1</span>].x, x))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (side)</span><br><span class="line">                q[cnt++] = &#123;t[<span class="number">0</span>].y, t[<span class="number">1</span>].y&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">cmp</span>(t[<span class="number">2</span>].x, x) &amp;&amp; !<span class="built_in">cmp</span>(t[<span class="number">1</span>].x, x))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!side)</span><br><span class="line">                q[cnt++] = &#123;t[<span class="number">2</span>].y, t[<span class="number">1</span>].y&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            DB d[<span class="number">3</span>];</span><br><span class="line">            <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">auto</span> o = <span class="built_in">jiao</span>(t[j], t[(j + <span class="number">1</span>) % <span class="number">3</span>] - t[j], &#123;x, -INF&#125;, &#123;<span class="number">0</span>, INF * <span class="number">2</span>&#125;);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">cmp</span>(o.x, INF))</span><br><span class="line">                    d[u++] = o.y;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (u)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">sort</span>(d, d + u);</span><br><span class="line">                q[cnt++] = &#123;d[<span class="number">0</span>], d[u - <span class="number">1</span>]&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; ++i)</span><br><span class="line">        <span class="keyword">if</span> (q[i].x &gt; q[i].y)</span><br><span class="line">            <span class="built_in">swap</span>(q[i].x, q[i].y);</span><br><span class="line">    <span class="built_in">sort</span>(q, q + cnt);</span><br><span class="line">    DB res = <span class="number">0</span>, st = q[<span class="number">0</span>].x, ed = q[<span class="number">0</span>].y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; cnt; ++i)</span><br><span class="line">        <span class="keyword">if</span> (q[i].x &lt;= ed)</span><br><span class="line">            ed = <span class="built_in">max</span>(ed, q[i].y);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            res += ed - st;</span><br><span class="line">            st = q[i].x, ed = q[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">    res += ed - st;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">rang_area</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">l_area</span>(x, <span class="number">1</span>) + <span class="built_in">l_area</span>(y, <span class="number">0</span>)) * (y - x) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    vector&lt;DB&gt; xs;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;tr[i][j].x, &amp;tr[i][j].y);</span><br><span class="line">            xs.<span class="built_in">push_back</span>(tr[i][j].x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(tr[i], tr[i] + <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; <span class="number">3</span>; ++p)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> q = <span class="number">0</span>; q &lt; <span class="number">3</span>; ++q)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">auto</span> o = <span class="built_in">jiao</span>(tr[i][p], tr[i][(p + <span class="number">1</span>) % <span class="number">3</span>] - tr[i][p], tr[j][q], tr[j][(q + <span class="number">1</span>) % <span class="number">3</span>] - tr[j][q]);</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">cmp</span>(o.x, INF))</span><br><span class="line">                        xs.<span class="built_in">push_back</span>(o.x);</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="built_in">sort</span>(xs.<span class="built_in">begin</span>(), xs.<span class="built_in">end</span>());</span><br><span class="line">    DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + <span class="number">1</span> &lt; xs.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(xs[i], xs[i + <span class="number">1</span>]))</span><br><span class="line">            res += <span class="built_in">rang_area</span>(xs[i], xs[i + <span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="炼狱"><a href="#炼狱" class="headerlink" title="炼狱"></a>炼狱</h2><p>解决了三角形，就相当于解决了所有多边形（剖分成三角性即可），可正当你得意都时候，圆来了</p><p>圆咋办？如果扫描线的话那个弧形可不好求，没有办法，为了对付大boss，只好祭出大杀器——自适应辛普森积分</p><h3 id="辛普森积分"><a href="#辛普森积分" class="headerlink" title="辛普森积分"></a>辛普森积分</h3><p>先看看辛普森积分是神马</p><p>顾名思义，这是一种积分方法，来看下面这个函数：</p><p><img src="https://s2.loli.net/2022/01/22/GZQ4xHAerdEaRbj.png" alt="函数"></p><p>求面积当然是用积分了，但它的解析式又很麻烦，咋办？</p><p>辛普森提出一个玄妙的方法：把他近似成一个二次函数</p><p><img src="https://s2.loli.net/2022/01/22/Nr7JY5jzHyURPdm.png" alt="js"></p><p>如图，直接把绿色曲线当成黑色的二次函数积分，设绿色曲线为 $y = f(x)$ ，取 $(l, f(l)), (r, f(r)), (mid, f(mid))$ 三个点确定这个黑色的二次函数</p><p>二次函数的积分就很好求了，就是：<br>$$<br>\frac{f(l) + f(mid) * 4 + f(r)}{6} * (r - l)<br>$$</p><h3 id="自适应"><a href="#自适应" class="headerlink" title="自适应"></a>自适应</h3><p>解决了辛普森，来看看自适应</p><p>显然直接辛普森积分是无法满足精度要求的，我们要让他“适应”我们设定的精度，具体地，对于区间 $[l, r]$ ，设其辛普森积分后面积为 $S$ ，而区间 $[l, mid], [mid, r]$ 辛普森积分的面积为 $L, R$ ，若 $|L + R - S| &lt; eps$ ，我们就认为这个积分到达了要求的精度；否则，递归积分左右两边，加起来即可</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.acwing.com/problem/content/3077/">自适应辛普森积分</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-12</span>;</span><br><span class="line"><span class="function">DB <span class="title">f</span><span class="params">(DB x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(x) / x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">simpson</span><span class="params">(DB l, DB r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) * (<span class="built_in">f</span>(l) + <span class="built_in">f</span>((l + r) / <span class="number">2</span>) * <span class="number">4</span> + <span class="built_in">f</span>(r)) / <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">asr</span><span class="params">(DB l, DB r, DB s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">    DB L = <span class="built_in">simpson</span>(l, mid), R = <span class="built_in">simpson</span>(mid, r);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(L + R - s) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> L + R;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">asr</span>(l, mid, L) + <span class="built_in">asr</span>(mid, r, R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lf\n&quot;</span>, <span class="built_in">asr</span>(l, r, <span class="built_in">simpson</span>(l, r)));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="圆的面积并"><a href="#圆的面积并" class="headerlink" title="圆的面积并"></a>圆的面积并</h3><p>辛普森积分的应用一般是更改 <code>f</code> 函数：</p><p><a href="https://www.acwing.com/problem/content/3072/">圆的面积并</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point p;</span><br><span class="line">    DB r;</span><br><span class="line">&#125; c[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">f</span><span class="params">(DB x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        DB X = <span class="built_in">fabs</span>(x - c[i].p.x), R = c[i].r;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(X, R) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DB Y = <span class="built_in">sqrt</span>(R * R - X * X);</span><br><span class="line">            q[cnt++] = &#123;c[i].p.y - Y, c[i].p.y + Y&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!cnt)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sort</span>(q, q + cnt);</span><br><span class="line">    DB res = <span class="number">0</span>, st = q[<span class="number">0</span>].x, ed = q[<span class="number">0</span>].y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; cnt; i++)</span><br><span class="line">        <span class="keyword">if</span> (q[i].x &lt;= ed)</span><br><span class="line">            ed = <span class="built_in">max</span>(ed, q[i].y);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            res += ed - st;</span><br><span class="line">            st = q[i].x, ed = q[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> res + ed - st;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">simpson</span><span class="params">(DB l, DB r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (r - l) * (<span class="built_in">f</span>(l) + <span class="built_in">f</span>((l + r) / <span class="number">2</span>) * <span class="number">4</span> + <span class="built_in">f</span>(r)) / <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">asr</span><span class="params">(DB l, DB r, DB s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">    DB L = <span class="built_in">simpson</span>(l, mid), R = <span class="built_in">simpson</span>(mid, r);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(L + R - s) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> L + R;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">asr</span>(l, mid, L) + <span class="built_in">asr</span>(mid, r, R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;c[i].p.x, &amp;c[i].p.y, &amp;c[i].r);</span><br><span class="line">    DB l = <span class="number">-2000</span>, r = <span class="number">2000</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, <span class="built_in">asr</span>(l, r, <span class="built_in">simpson</span>(l, r)));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2022/1/22总结</title>
      <link href="/2022/01/22/test2022-1-22%E6%80%BB%E7%BB%93/"/>
      <url>/2022/01/22/test2022-1-22%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a8123146ccfbac5fefb0ad1ac2144706e33823d90f3da193cabcdb9dae8a3c3b">111e7d6409c611e6b63fd1363c3273c85fb2058823cf9cd410a92fec8bd4f8bfb0350da669ae92879820b34f22fdf085ef81a40f980473bda306436cb3708ecb5f26d1fc6f17de4c569a2af1969c696da12a3ec575128036c64aea84869c001313d921f7799f1ed078ae5b78cccf9dc2e8e5597ab700e7ec64e62ae69e73afb2ab7728f02f8d7123ce0b11fcab5d03ed9c43b2fcbba20648214e0edcdcd9f27cdc104ddffd41fa508116e9afb44a6726f8e27ae61490bd1b49f522c761dad6ab2582335d270fb0df5f684120e59593a3a22e860602b43a1fb0adcddeb8181f431cccf1810e1b9cdfa7a3654ee2b95c25bc4410ec69bf706531f9e52801b9b42de8bcbbe8f15628d35022a2fdd360392ac284de73d8faa90215a62ec8be0eb803789816588ad7f72032950858ff7dd3f83ceb656da41976e298b6ee79496ff3af2f232a93fb462dbb26f0f289fef214f5db784330dede6605ea8f8d29b4eec3f2b89e5441165ff913fa462c6b84df2386aed0ea04da7745c0df74d52c55a9554443872c73d619b9416545b5e89a6d55b23a250ffef52409c94138e64655bf779158582744ffdfa7ec68e478fa907ad0567f6c776515eb5e0fd2bdc4b71e46892cc2718844a7f8bf1c351cecf9639c2e967e1dda78a422bf404eee74b0a85cc5e9c111cf306f4b8f49a680a85250f62f2c63657c189c9a263370579b2f515ed620e949a972014aedbc509a9305f6b1aab930fec98fb0158d9e1b672f216a95c31b648e96ef1809b337ace4c7e816bda6469a0d971b2a5b238bc298c632111f5c1bca6a43e6a0c55fe7efbe25c5053cb9d78ecf5e6a95c99fc75658d238aa49f94e7e2d25296136b60838ef4ed13cd39417df540976330a86407ae1685a89c05c460ff72e02c2bd3021de08ab18e1920881ffaf40ea96039f40cddddf0069fa5d6e61aa41d10ab556542a632bc999079ee6513e20fe3085bec3ca5ed11513fe72384666052f3e600eb340d307d23f40344fa42651b9c0df206ad2fc0cf01fd58c7bd70c7f8957e9eec9000eedab5ba115db417d2d157b06b7cb5ebd21ddefb785db363e9c6d1cc8139968846ebdcfa0372b3b4dbd55c3edff7192e6d6b9fe6e74f5530ff5858dd0aab16dc303f1315c2ae16d5ed9266899ffc4c9bc4f08a7395e4c50fb91f6e39169506aa7dea490e358602487b4da1953cf31c2eb1abf3b6a1b00963f55d2a3a5d3516309f27c7f1768cdaf2e43d8a93535344d959152f09de50fa6deb1cf462187a6d228f01a0921231e25b9785ba2b702cc0a1f0737c3178533fdbc0f07e00a73aad49d40522a3468206c004227a5da72abf934c1c78b00ae9eddac36813a8ab271b8f9b4805069d0b1ee5030debbb8afeb1a919acf41427d48a0d8c0cd38de4cae1ed053ad0bb009bde5ffdd6d54ca7337ffe71c059616db3190520ab5f07f6b415f6bad07e1630cf58eb0ba79f76c8a0338482d6eacc93c8fa9dc58e60d3a9c1c33b996b157d9b2274a1b8408cb1027ff0c3219d9e9f9c61f808e3e82c8020b5984661175e9f4e6cc48b459f013f6e92f8456842c3407fe43165186ac9ecdb70b9e2f8b2adfcb2cab9143d36f0089a078b561c2c57fb6f829228e5e5ea76479fa62401d941e4434ad1d0ebc9f4edf917bd518e4d95fbab616bfbdd37365c5d79b0918b902c2aabe7aadebbdde2503ab163b74f082d9bd63942c2953c695612807b4a1e4e94196a92a858197dd489f6977b788b0687b3bf35f5e56cbd01cea84fec13cc5565741b5888d18ab89e775bfde16e7db8ed5052e003443dec81d18525fffbb18724301a65af1c900b9b7d8cf88b399aef13b316214019d5c5ffcea924ab4d268f9641c91663fa7394761a378a82e85542dd3f3e05fa07b3b4501fb1a621161709c91ba15682d37f3a66e69f18f4241b09e6d67c6ec0fa4318c9544f158a0a5b511ef4fd3d8bd3ecab70a164b0e65d0043fab110b3d504b59e83d4c03dd1e573c5157c660b3a70f4130cff704afc6214c9e39af8ddccd9c4bcefaaff65452b352d8d8ada2d8e5b0d92782bc2e92b67d56c857311bd37ab783cc001ef88ccd7a52a616ee9ab6a2554230efa01dd26b6fe006c7d44afd088547c53c40621f690f7fcb044cf743233952edcdab988563976acc32763a3e1384445f7c58e8bfd89e6b24106b0f0417b90eeccb9e42f53800915cccb092ed69cf9e2fd5c1098dbce10280158500a1c334cc82b3b311acd79e2e8e35d7fd4bf66c39ba1637fd28cbee4768e19e41ecd43c93a1fa9b18004e33bb21e25e21dfcf52be3d32f069bc1f2fcda434133e6ecab7eb3348d247a4fdef529c76e9b8eef52ce23ce5be0f0bad113975341359b79b18cb42d6cbb8a3ed613aa866aa21a811b012aa9e06a56d784a00081beec45d2ac1fefb32d4e74c6fc371846e06fb062a696e7b9f82d30370feb616ee01d9cb88d60c36fa599ec62b13595aab5608a65fd6ae39dbfda458034439e15e0a61b18ac186fd0ba7648c64086f7e1308a0189b92750c78e013e3788b96fdb71774f8515434ab8db292b2c6727a9e5722eafdc1e37dce18f997d9403b6b2a0bd98cf7e9f9e7eaa4ae84e1a1e7ff8fdbde458d26a682041134e6900d9a32fd811a819f5df293e784f347c43dc39647242d2a749bee6e41522f3541b6f7ee4a9e07e051d6bd606c3a8329823273a7525d26769e85fa4ceeab9e3c263547f3f7a6ea23ae8dd0dca63389757c91eb0dddffa9d43b810adf7d3412cde5531064294751ab4298e2375c6da8a1a29224bd6d6e2953414d7688b5fa11eb439958e8d9d10ebadd8f89bec3f851cf04c364e307bde244e67df843559d75445a1137e8ce698c12a4672c082668dc07fcead6a5f057a571dfae235788f31a51c6a15be2b8aed8c2142fcf449886791b03eccc68656744a7ab99a6dbf1eb0ce73cfc06fd2dc66e896bf8cea6a30062e70f5bf977a544b1c779afc39cd717aa1374fd5d4faa9cd725e13e635305c4caa1e54a2835195533d3875e313a02b851a625cca76fa8ab549b9c5186e2ae1dfdde9104036f84b919536c5c2831d8b7c5ab126b03012bcf5696d2e5762698ee17318e6984c7af27492520080585233cc6dbb53309c549be80165d2b34dfe6642df2a285f01c2e3ea8c7e711aa842c994aeb1c547318b47c1c29fbe024bc58773128ae41f87b9a0136446d55834e14d8ab32b8a242b911e499414849392283e160c8d32c2f68353e6957781b4bae4fe770833dab899965ca077a9b5d1ca865a65b1bffcf3420adff774a73062204cee714f48864f1fc77fcbb9ae328294c432fc502ff5cbd6528e2b8a62b0efb6dc41790b49bce19188cd5636170d1679de7baba36dcc86b6831cf6abfebcc7bdb9e9fd387d54c2f10d65307dadef571f7163e6c20b45bff0393ca7a4b40b5c7f1a293cd5cea3d4f1c7430ef5eb8e2b622440ea4389153f295cf0a0d5161dca685b059f358fb8e3c09effafcabd11bab2e3fa8fa0846ae7df5f7bfc51b4f84b633a11a216d8b9f1167556a8b6f58e0b18bbe367c9db3b0c8ef35b9c1dce6013efdac6d2456bb0d5dbe8f95bd03c1534c40ac1714900757be5fea78ed6338692ab5afc7e28671baaf4cc6057a3619a07550af4eb3aa38c43999c5deb477a75d1153671f4fed590d20e55c852d03ef45d34641c07f561b390a155359db8fb8c3296f76c0d5c976a59aee4acc4a7e2f5370a13e06a9b62032e19c0d641f3d2bc359547957ac61d80ef45eb20c74934aa6ca62ab90c8eeb3cee0038cfd27b3d8b7f44ab9232e6b4d32f491000cee953ac86f051fcde556f3686b8f933d6e18dca35dfc57e8af4130895b6b5ecac78ed20c56dc08a4e17a1c4f957413c5fe6dd0a29fc37ec6772361c5032c7caab5a2492b3625f4782a05a9dd65b05f79a53384830b27bd168f255f1cbb368a12a52d8971d933dafd633ee57490097e2bbfc878922e3a74cdbfb8d4f11191ccb5f54194173edd78c32d8779d44f54317ed1d1628d6d2d85611553d2c726bcef19738c13d4aa1b8a6cd0be3a29465ea7a91093265deb3cb4f9d00d0753c46154c8a4cbd9e868663c8b89c62a3ae21e7a9553653b21a29292634cbc7db8a8677e990bed84810ed938e00421b234e8af8c698b9be88ba9c2cd0579ec158ddbb4b0859013d4fcda9e623696f069e3e7a64a48fc6eb3bc3f771d494e5da33b5e7fe6a21ad945fb1e521c7f801e73217403097e0057344df85835eeacf58c99412aa5f1b3026bae43332917fa7e31d647d8809e3adac0acf6f20daa4b506916ed5261f48f832a92b0ebf62aed5cf6130c2d59470708fe4feddd6fbcf6a46f2d6daaee1da371bb74fe5a8aafefa8b03958de0c76cbdcfae77fc779c97bc9895da5083e67e8f0d472cc0138b4a3adae0bdcc9c8ffb92c4f487eb649cfc0e84cd711e19e38f45d0fc1a421e9bb2ca170b7634e35b8758be05fc418a74695c10995227060332560efcbf96fc1cbe5cb9ed2cb8150336f6946e5e04f7b783822cd035ce9006722da59571a331850f90f04a18465016b51cb401bb7c6c5b91c930722bba790e29910a7925582708f02a242a2d856ada96b81204cc1bf5639b8b94215c32e23f4f270e60b85daba6fde7526f207e4ea8cc78e88a081fac2af637c8a320297b40d758a97d32512c1de47e7b61fac098145db0d76264ffedaf60dd1503be9a25db058810ca8e3e3b62fb6bcb44908e4f5883a75de4ecf613123538b5ef7a3f41b3ba9daad1ebf1c47d6a776e164fe95f0cbb5070c47276cf47132e222a8c0386954bd032afcfbafc5a1778d80dd27705262de3506a1e354bbf59ef18689ab99237d8505e05e53383e30eaf5546d57611283ea87a67b70652b587014782fc039d5b7b86b7cb9bf694b588837b2a6c9536a76ee531901e88602d04b3dcabf55617aa323287c5d612ee06f6004248e31054bef3ac8a5e6f02776a5bb01e6fb6f453b515a000bca540ec2ea877fdcceb67cea04fd449bf533cfda467889650537996fd6c716005ea5d8d0edd4fbce518f4d55b16b1d61c33ccb89c01ff215c4d078998f7107c5598caa58973d81c3fbac2c3a206f1e74de13cd280c8505b8124334fc451b39f37d7cbd919c8693a2b5921f3f120d0f73ed2fd27c4a82d8f87bca21ef6121f462e67ef65b862c16fd9dec968bdc4e1a0b9bc4e2b3e1e584ba22ae17e798d6673d5c1b85c162398f28efd762d8778ee11b6089b40bad6b0eafad32a58803d08fc550235a29d937705b754766150ee8fc501e792a2dfc145e8c6b16a6e20ba6ca90c6c32182428ddfa340245fdcd62d344b8d93ac113a9e8049022cd63f1e85495a46cb08778f4b8462e670c810a93aa494579197a38e30d4857075a35b7d7c1bf982cd3e1340dbc71aba940a57f62042fb4c645ba1ea79e46d1078c5537d6aded6d284e7f3d3e5d4b25a6dab81c2141e5eccfbdc67dfaf393dc7959d6f0789ccf862c34686662d4be908e98ad6cf6c3805180c0cbed2a45cb92ab08fffed4b65db90675f537d07f38d45e8f5caf9ae8f2761cdc7b32e18a6f43363d55027a78070a02562e3bb2a89a4747f28c459e558a5287bb0e7c347a2868e6517f7ccf44065e61c60d6d60c4d8453c64a2cdb696ad764e5f0a5d83a57eab1c7e13e525923de2344594adb707bdc2fafb982b1d06d7cdc7ba3b7db39210186fb93898b7acaaf8fd0a489fc3784cf47be66ee28d801079361449b2cc74c4e89e6407f9893e406d1e63f572404ecb20220359fb6a817fb5d1637cca6feebe622c733ce0434a2c9f69157be6fd06bebc6b96f9d759d2655c8d11660b402d9cc7c16aa23445d0ed24e530dff6180d28d588e4bae5e8cd2c5e45c79fd6922a6abdc2d6448ef66d31feab16e32a83fa67a5d5af17051055925d9066f87868809600aca7fc1a9ad0193e8c76bbeaa3e522209e7846b5f1e24dc32e6c468759cc2cb49c1c3feff1cd64adc5bdc5071fbe5680acd076a9615b7d6cbdcb79cea94b32947d690032d6c4c4ab11654fc9c38a2ced71bf4ada3df685f684f6aee253efa52304d2ffb63c347e8bd077fb38f868a0c9e6c4ce34613de93c50f4afaea5b6ccece9fbc8fa7237ebd79a02593ca1df37f74e6a5e0e98ceeb8e4390178063c18ecf978b198aa4088e09b072763f87690da337ae21dc9be2d478bccee20a44455e40c31301750b715fec240ca1f9c34ac2573ad2f5629a5a7b5c6bf023144eea857cb43dfedba1dc99b124f17894bd9d769e92f665f01aa72ea25a6fbbe0163c4a1174f03b87b545f66c9b82de1bd2547b4ab8bc61631ccfbc194711e6ae351b2e55f7bdba608f8f904315812d5baad656a44ee9cbd852771d5b6d612227781afea23723920905c0f688a9b6823fa7ecbef0ef8a47a6fe66e3a2476a63b18379091ea991aa4de24d18c9fbca4925a03d50e7155c923a5881bd14ec4c81455248a45796421a5374aba95777807fbaa96ead010f5f65039dcadcb9b94365350bd35a93ccbd48e9e4abdb7089a0fead7715452757dcb43922cfd83295e674c5ac617f9363056894e4854bb399a40089dc79514299361c03e82a591f1f64ffe6a03f4ae34e9001569adf372ff98656ddd3d96f64a8131923b947702869ff7c09986c7d64a2e63741af7bffe71bceb7118701e088857d6f72f8d407c0027f440e39269dcf19b3b724a3b8e9569509cb7fa29321ba39de11f65cc1dbf08cb443195d096ddc624ade83977fd5f668022eff1deddd013c7dcae92a09f03e4912d1fefa4a53a9c799693d5cfb6e83c5a9453d2effb55fe0537dbd2decab17f8321cb6dec833da0f16bb73809f303496d91563cc4b4f28b1088ef5b651b8d15e563aac6d41b007f507302d49b09b41caf90f2560844a356bfbac17c967c2cd5a81ff03456ac6f9cd0f1708faaa4064a031910418658835f1444426498c2f57bb473f90e445f4e1e57acdda0331cb727eae00d031ad8b37c4b6ac28886396fdb3357f54c1903db6ac21a3af054cd33af392691c8240c0ca46b54d6805223af88b5674d5ca27c2e9326fcb77633ed74d090163e38dbb7231dfaf09c041c14f56f19e338286b6c6b3852ec6f57dc91da54497ffb98ac2bafeaf6b2d5fbe5f4339731e66138f5c6e1afdd1cb1aee6892ebe88c6e8b3ad255029a8a55bbacf63f0b99f523ff99f4a72315a08b68e03e5cb33259233501233afbd02fb5a54f4e6741f158d5a1f35b326e781dabbf159ef2ac0d01a3b43f55aa49401e53cfec9e8b5110a507ed6038632bc98b5470ab64eab9d9d610fafc6da9de97032a2a555a8635ab263330f56229fab1bc53f2d2720b2bb30a2ed5167f9e9d918dce8c4b93c996f3cff5ba121355c9dd8106e5fcafd6c66c7c75aacd9e135889a1b66087cc7c88fc6d56202f5a4383f335733ab7c7a496163dfb597acec3b33a1306109809cee9b1421bf7ad5f41dcd872d7cfcd019d6244308e015d33bfc68ed57913c75c1ca4d48930fc21ee5405205286dffa64e6fb191fccdf441c3f56c7952e36226413695576f32971694f011c6aee7d3a8388ee21c28a7f57be8c2a571bff3afc9cc23665e10f1716f418c65b1a7c20f08a936058ad5b1ab72cb459dcf746d97592a9194fa00e9118e9e7c3b023ebf43d290fdbcc8760c24a7415245b9c79645361c730582fddfa56d383f27e5227d688136796889c24155ee4d4a1f8f87aad4ce004a9487593f93dc60d8c15b537983ce28981ed2187daf8bb5747def3f86ee61f8a350d219e2663249d4f42a06d3d619e909cf476e9d1e1bd22c37d5574bc95292fdb117c879d52e959e5cc5aa28cc667ea3a8bbd48531a78f8ff9131896a8eb75119213dc98eb6ac6a3d887b5160e0c243b08e157c7b33e932800af61ca4fe98fce9327ad2ec4af4c7df947fd6a95f4257a9bbd4c2eb28ff7e61bd0e9198acd862b48bf22a82fea3d3787fb44d0f1904e7078f70acebbf2d7a85483af50c25b0eedd8fb6faf7ce4661d237d2bc113d7403fb1166de885fbbebe22d836b7be98dd0e2abe57aaa414ddb638fb12af103b37d00c12918bdd0a3053af2d5a76a6d94764087bc240e301867022d3a3e16403c3bc53e0f8a796716ae3c30b549793c795cc2fce0b730168bb9b6757f483a86d09ed30f93d0251c54098e0e749ebf2bc86609d707279e5c9307653d5c1ee327c4756191edb46bdbef6f81de22cf7f97c0963f6b47941bcc04bbb349b01f8a970613e57301efe726bc3ba80e75ebf3734995659c5f830ef3c3dc1c8e8a212750d5bb807aa6199e0209715b490c46d05f7d3539d3fba6c0d7873d65056f1a561153b49afba5ce038246f16d9fbf384a70d3b3b3cd7da128204313d9a1ae6539784514fe2cf4fde8184bb04cb73838da128fc436ea41161c315ec9cd257b40cbb44e6a8c61105bbbb7fc7b336af18b0174d92fa9533f4eee415e63ac804fbdb069846e4b0e18c06c9ed7bb4d3433a12c39e1141b4249c9195eba5aa6827dc7fb02e368dd6785afe5a4d2e4594470bdd3e8aa929a7241c43272066a75241a20e85c890f39a017849be87c1a910ffb188686778a27c4e5e5a2659f13d8a5637b35c0476a0b445a398e61404ba72761163256ef95dcd82634c2e3dc9bd4cd1ba593814c0b29321ed0f7a729b4784568a796a40b465182b5af3ddf79c6d5e033c23213341530c9cc184e5b3a36640258edd36f795bbc21931db182190a50791259a1e49fdbcb3a53dadaaa2d341b9a5fbe3250516cd9771a338639f0d8c43aa241602e48118404704e64566747d24a2c3f419b851ed697b584cd53336b9e5169053e366f465b3b7eafc3fec71b890522baf77cfb867c4efc12d10d934dd06584668420c8796294719b82f72640167ace2444bd400e13e7c862c2a6d2324ceeac8241a31f83789e22ffe3a588c4d5fc5f8bbbc90a51cddf109dac327589367bc83cb8b1ae606b24feba12fb036831c85c33a41e742c9ed8e8b1c69900a40a0828df2d6927c896b176a3bbb33f19860cb078f6558de566ec779dcdfc9a3f663780fbbfad26373b555e9c5d33a6f998268945a910befaf72c59685be9aca5f64a4162a206f5f3864a255237ca90ea0eca03b77c604c50e88f27d38a5b4bc46091a31077351adf6070f5ba66676e25a9c988f0745d77211e8b6357ecf5098b18f6d5e39c6e2651fd6cc7d5bfec46af2b7cf350694488a3d18f59a97535ec78fbab9c7a764d61e797ebc6a7ecf8afd8077c214dedffd5edbfc05ad55bf1cc95ebcfb60cfcae008a75010e375093c7702e970a318515cc540173b9e76361f0eb31b13ba68ffa67d7877e8437aba4c04b7b3705f5cf7a23d7df621b43eac8f1dd9b4c1018c9c65cd3b2b619e2cfe2e5a0996eb39ece1aa68ce83b9d9a9a7067342866ef7fc3b519ad7193a025acbc392e928330859c651b8c20b4cad11f85a55192ef7d53ff22c10118c3a0d132cba53671e9a9cbc105562f439fdd7c5a69e33d2190303b2bf5517e45ad2545217f65411018d479ec6e41322b8776e3026c7d501f4e3bde99f3ffcf9c3d4a759040024a0d89755ba87eeb2b71e63d0dcedcd09e078f76dc434b5f6a3a5db195ba882a4a0cc21703558a2a9929d415a92adb75ecab5174bbc2ec78d45fe06eee50c60d0dde1772798b6176e94a0a45b3738f1de1216ccbf776398f42f22d1179112433edc86e7b4263cc412585a2f0260596c284c16186f935369cde654b5b8ceeabd3a41cca4b6198486f90e8e8d3d7550be36cbc05cd09871dc5323b231d355db5ea1900fb3205f6e6e625ef389babd0a453d1a77fd1de23a91b0a00164828d82515cf3620cad93dbe05f90d250cfd8947f0917a72bc5aa9a084e256e65bdc0a0fab66cec1748da80ca0a893c699c4227c780ea579bf054cc303a0c59a9421fd7c7c326d04f7cdab7f331e61c16c78ded34a0132ffc999b5427f498bbd4c64a9c7b26eb1c08537af3c582cee8f8b06c973e978f591d316c6af71520a34275d62e5e8aa46317bd38caf6bf71b4add7b2fae63b9fa03ed674a0ed03957a83426f0ee2b76fc0531f81ec9bc9a2835e1159244e4127f5735da69c297f71c6062fde8fd74bcc67e1da535a03e6cc3e70aba39f280e063ead49ccdb5e099a3ced38e69991509bc85bce1ec2b42f27fd1780ba269006fa0e77c9e0a0f0e2ea79e031d8264f5a1fdced54cb059b6f6b2717ed4178af6cabddaacdd0d0509e16d399976606b76fa8fb2c5c8191c88b4f78473620db47757bf28237ea034a437ccf1d2a9753333b01d926163b91f4be44922958fc3f018db8cdd542e8ec6abcabe138f964e085a3d6d39c71240c1f60b97b65293ba30fe00986dcb81b0d51f96552238614d3bd7e1e2e68dc859b02879ec89d930439673dfc4a2857270c4bc20e554536882d7061c92bf7db168675cb015fd832a9672a8dad6f2ed394a110294480d2ddab4cfba0272ad6b2b53a1d614770e7f0944ef3e15dac587b499c53e641d7c0cb5c9004a465d835b3cd8ce14deec1c39ad207ee0c415ece156a6467ded9a2efe121b43a0b70ea73abff8a18f0e23540c7390b89dc9487cb1cb2335495986bde830829f8ad14eb446df074b3001344eab55f983a9f14035258ba8138b852added6355a1bcf2b7407b4aeee6a2cf798776c8bc0a3498aaff453aa1b7d0603bc9790278cd250de978d0030cf2d9738ec060a50eb4f97df69660686310c1073ce03e88f3ded14af82f134410fa1a66ad17db70c92aae93e13a54513df8af330fd41b1ac0cfebebc2bbf7ee2a196874e8695e43866bb43a9f4393862d984ecb293aca9006811582b3218929edfe94cbb840f763ee286b55615fe12b9d16470481d7ba10c8eff1db53ae81586bb97b273773df6ffda36d8476ee6aad4ee7fafe1f955cc3311cc96b4f2fa71b24e17c370a73e3f0d33b70fd7e7d72728d9e2e82c446a878fd578adf55494c0a4c4d33c9cac261f5a0e893223ad353201f344ac4cebcc7f710bc6e7465fdebc69f05220ad7f2efc165ba657634ad4f0635e8bcf1912ad0680d5819d025e274d86646d1f14bab71bb6a6e81f03f6fc2399b0bd19d484ca1a2e2381b9580907ac25045e047c61ca0c8e6801f464ee4e23577204103ee47f259f05f56dba01c4717e4042642e0d3ff76ef562faf95213e302501b0621828d3127af85b20df15a3c1c02a542d039999d78e32fbbef96f6b546f4484c6c8826816dd51079aaec5f3056084133c613ce3487ae68e933a2562b35bb2f028de13d8845c49ae1eb7198513595d50782781c495c0f02887cf18702cc40fa1375a0987209655a55f45c21716731efc9af6a714dc9ab92909cb5f22471555c829fdc9f0010cf667566477508f487e2d520f50abd7390611e2b789593da7c16fe7e3fb743f4bebe4fda5655ff8042af34d8f623ab66d910920bf9edab7c4f41daace2b915d6b87e764efd04beb168f9e6a8d4648aa02f759495d9cc5f1674cb7c4b4a5cd4bc44fdad3443418d2c31ba892e71a1e09efc53b0d1453d2ae169df39c0f623a4fc3c34098da70a14fb28a4c9860b1c7a6bdf3b68f76de67ad6fe50cb373cda6fd40ead3729490439262c92eef9faef5bca1acd08053cb65c5ffddde3cba5d3e422b49b62c0d6ac14bd9046d2889285cefb0c93071d91431cb1bf34cba15c45bcb8c77d9e67172cf93075566593cefca7aa86b2db6fa0eeaad67b39dfe4bc73388079ccdae100ddb31b019e63afc71e36a497c8828fe1c2874146b4f5ee67beba66e9182c637bf63a25ce75f709deffa9434c72a87b83d53b10d5570fea78e0745957067476c7b9af46f3018c9bace8d52c3c39e9c9c2a08af92314894e7ebcce72abc40350ed3ab5da3b59bd7ae88201bfc64d67d9d59113de6b8d2874c30fbb228eaf9e9fef256c4ce95b48195a0eb6cc27f65ce538e4746d97c86b50dd062580f043d730e6d789b6a61d41ede128fa8e1fbbc46b54701af828b1c61ed81a15b31486534d566e28f7d9d9a5e805545b9314a4f2002650865d843b3bf3c9d582d7bf5884a6e71bc364bb6cc1e0e28d3609231841b3b88e30a44b523457a4630d1ebf42ae2ab5f21495bb2f0730444aa7f9b7ad21630488086ebda2e5c64fcee2fbb5b2ff64f13b133ab3d214768ddaecfe862e16adf0055cbf50dbf60d7282ef189dd15765c815f661eb60a0eddd12bc0aff134c6bbcabdeae1ef025611e603933ad5ae1c169f4081c2ed31683db6719e3dc36ccdb84504e99c758af5dbf8a10440febc30c83af8607edb5babb632d39880439e94c0c7089fe85ffaf0500736bf05d0afa73854408ee260bcb430657314a845e0bdfe4b48e8ef9c6ff2f3563f022e0ca8b3c78cefe01141680322089c5fc1debcf067b188496ee2cf4fa00b5d037866b96d7469c304d3bfd13e1a7767d4c49b706f0a6f8f47b848b76127ac0ae6f4267446a2a0ee04819935352d62bd3c0fb8855cb476f61890ebb0a2a6c10f5c7e662839c32260d6732fe31ee8c1b9d375a73caf4294b14723f452287ae81d97a0ad841e58cf52e9a3d00cf7fc3a9bb332345d838b970e11e58e49fd18e20c935b3ee9bc9db956d8bbaf717f64c0f993e373b095b0beaf32214ddcb95ce2062629ef6727a219e5f54176251f0e7aad922b53a760b2521b8f4310cc9c19d1f03cfb98239f65b89676b4ebb97d436b9e6c6e876a20c82e6e48151ba74b4afa40d68d183a1c1aee7ac5942be1540e2c17ad5c296623bbf44709451ed5c5348996074e39776310c8c9473e4c35de80bbf0f32f465003274b6e7dfca1305f02ffa2b0bf0847883b8267c2f210d08a1b66ea0a3c4bf316198a45bf45cbb73291884e7a4d2adb6ccca0dc5a93c37a1f2c4f2010c1adf605bf7cf40de444ee569e82021891cc87dbebbb35a172bcd4793f0120a86d4b42fedac2889938fb915cb3e4af51c7df5284ff8195024949569637a253fad96a2e5e463c929054a93353c6b70fc1305505b975e3257fbf27bc56045884b6278a0c3eec01d857159ce52aaf428f550c8d1d347e799588b9f3dfedd0c8daa12912661cb14549fc02b64d129a4b83567338d171c8521ee54fcd6d6785d563557e41b8f94825764819c13436a8cd9244ddaa543f6a73ffa73dd4a8e8d8ec5ab940edcece23246aa52c7da388d3415ece6b7b540e7662b68e026d96e86211dd1249227a0c1d296bd4822b16b835199631d24e4f97346a9905353cf48c687e663de8dbda5c3ee60bcadd60d420371f103c7742fd0719c124383cf336e14409e66defb56057025d2c55d1f8b5cb8e7f1ab60bacbd6543fae522512d67c3999bc0c0afb8ba415641d96fc220740ec510d0cb59fbe573b782b6510df22b44d4467155f12636cfbea5e423b57262a476ac99a9e1a16dc3149feb8afa0919718650a85b3e786e37d74feb4e822105aa9073571e899b2b2567c5e1e2d559e4981da10130e7145679d36f144e25dee4c6cf9b6b51a671db26dd2130aab6ebb4ebcb474d632b5e6e6b79a70a98487573909f2789f215b113cda0d458117653c506a733f23c366cde02972b692b76d5e40229d70372d7e424c0e384f0491a0b9ec68e1f74a1f29498ce2069ccb4f55aa135c8b541d55d0a4d6220c540575276bef6be48fb1c9d7dc71f766b44ff34910dd35ac70d8cf6d1fd28d43807c514f09a8c4f6b339b63ca047bccebb517b45423c1cd784f2bd7596ad52c1056f8b2d70e9c23b05bea7eecc35e20946a59e6a0f7cd3bdd8a3b0ff6f1f3d2806b8c339cf664e6f650c29a88780a5944e9ee51fe8e9dfbf7104811b175557248d22381db8f6b20b4117178235781190ece4510eccecc640d4eb29896c845c631fb085cfbfdfc9003f00e0940acd2e404eb15761eb6c7ee7735d1398c25a1e3d3a41222362a219acf26f252efc267e11be524b0385a2107f1af68707780745f5deaf2ddee26c2a05c3f1c9d619883103ed6f3cc8cf53bd94881c5c70b0c2ac566c9f2b4106e73a64b6c4cd00cd65256d06fc7f3a053ddc8009ebc842d1757fed622e48871f1013d05339e82ffa61c81f59d2ae0261cb6f6ec68cab9c440f5380bcbd668edc817b46d5bf9b3c775a2402580df1a80b15f51395f15731d1ba45af8a1deca93295f626dd98732ea258a6304cf517b2bd223d05cd5dc447a3c21e21816d275935cc1159f260307525658c60afbf8da00a59c1aaa66d9b155b046ab8b3d68d77cb785da31e764188cd5a6b4e5579df89bd3e9350e8e815bc513976db0b2abdcfe26abc87e5d70e07723ca3089d6615c702fa3ee9c128a770d28284501046bb40560487e645ef65a59b6a39c23895d324bbebfe68c9d717b052cb84286ec9cb61d0a9d41a539ccb4c5a154f8cbae310dbe27706b00284d9184ff942aaa6c6ea908ded997f8a81c8ca4d9897df1ec36261eb7a4e6e4bf01de805afa13aeb48d3d0009e3726e6adb85c10db0a364e2f1ce8a80f69dbe059c66a61fb16f078de77cfd0f5382e845058fd4e171dd1eb73a7a25ccd620a6f480c093273c3414143b7f5562dd0f933183e309cb3c4b91d4acfbae81627ba8717a17bf1f86bdfaca13c583e049033f88130b238de35aaa39fd0b8091a5931eb3bbdd4e56c5cfc8c6afcd26888a5497f713da91c9915e7f26aab160ea0aaaee705534b1449aead6a9c9688073e6c5131764b30c7ebf0a5045cab624fa91223f26fe45d5246f0a8a8a97a0d26208218fa3118204e6a9700776aafd74e76ccb360572f20dbb79bb2f856efd77a29846a1efb1b1ca9323dbe49b772b3674392a05b88514a1d132fcd60fcf9e24e66c6c7f69c6f05e22f42e1f186538950c7df02f11cf150d622bb7d4b330ff52c660c4ce45bb3a044f66ebe5fdbe553fa809ae62042b0c17fd4f6d176b5470d4d40a56f693cf8931268a6306be12f467a6104a16061170d6dd7a06ecaa5fb1eaab78e60cad8e55edaa981ae3d1e7a17c9b4ce051343cce2e5add77faf034fd4b2768d95a09171fe7958be61f62e7241feff0eeb77f80d89c63667a7f1fa7c8d9d821a5badb3f9dc576d99b7d6595e31e6b43f9f7dae0d7e135ca979829e7130bd2020a293b61ecfcbb8506305d79cd7e99787bd1f52dc93621da87b5de394802c1256fcee123ceeb9d3764bd9e0b8080a891d6aefecba6130b8b7cc055af26bbaed0c59002bf15aa2db15e1de7ec1c5e5c941a399f66f2007fa9d9e5a6384428eff0dcedacfdd7ecad1b99ae1363ca2f3a91f3a4975c31d31c8970fa2da50017ef21e011e8938d5264777de1f5475eefcc89a5cdebd0cd3719e0e55459d4e9e8474dd1f7f3d1161474fdf17d4ad791f06f7fb03616b08d08d59fa6d66efe71dee80dd6e365b1ecf0cf0e3d2dcb3c99375c6d1d9fcfc4cb70cb071917b26c360789839256b2834fe3c0425154bb13ab3d63bd0c867b3d325b113d8416087eacc84d913c6af043f8681173a902a60db3b8172b5a17076940ffeed654c30d76dc558752698a2ebf0ef730260fbce96997105c3985e84d10df3935a405e0f72638f90aa42b2206d21e122e485bf2f38122954ff41b7ca1455ac37bad3d3dc96deb415fae79a9f04a5c05af79effdefc5fb14d2993768def589f65af27071f57327871759a67646b2e974f476eca9a1a109fbd6b5620f970dbf0ef0b7642c202c89df3b593abe72bae36a27d5d484b88d9963cbb721b7c5d1e970f746b4bf7a556873345c25d9ea3600ce3a62ff77193544d61f3fc66a02bc92f83ac030514ac6dfbd98852d561aa69c4b05acec41acb53bdb1e793c1c884a3a4b01132af5366387bd8d0d460b7094919b4e4d41eafdacfbcffae755301d922eaab30de14d2b9d4b0a8f8cba78f79c4e17e229ed03e4afc17a87ecfdf987695610524414da4ea73033d32c215f19dd6593c0b8ff96ecbf63f6ab4cdf8b3e0beb5acf2d035812b24b2ee05369bc5011cc0229f6c0ee62b06e40e206d554def2ac4f6b7a4e61804361eb842ccd5c1b449ff858b136337c050fa0a67b5901bfdb8e76e980cb71f769157df009f0672b07d8662f724256c77be740a205a22740d381c61f1f19fa56b334a07f31b2fd0d4242cb82120bf2e15747452f9f286d3920ba474491dc3a1a3c6cab80ec857c2246cb40826cb36fdacf2adb45fa70076c5d8ecdf17bc310b0be7351ff9f5b8af6af3f8166c6fe3ab52ab76cf224dec26a7132a15bf3a11f6d514747a68ac9f6eed694e8084c0ec7c2ea209ca749883df7a743fb6a671d37e8e25602525851de5de824954797971f62ec6801fbc96bfd8b41978a961f186940cead7c8334f3cc8e78c6813623717b94f4bb35e30812a0dbc948e51c73b364ba0a1984a3da635da0bdf103d4800d6e6f8d6865e494774b5659965061cfd6a380ab1bdb7b829ae5dbe5d5083d24c4cb85f7eb4f7f9b7dd951f474fe0df0693614f45d2bb0acb5fa34d57403632ac1cfa6ac1893f5ab3d6f89de0235b981a156daa35a61b06c3e518eab80d3ef794a9b5931dd06613def4a08a88c3794ddff9aea7268a31029a777aa390c12f301e4891002aeefc2e2621156a31d121417d9530c309a8395cf16afe96d6f8aec30e54aee809356832e157da4dfeaf4550ad57f094ab31586352d58447ca9041da45033e87b6c58c8e15e82a34e30a86b180c37cb4aa92aa09fe05c76ce35e3c4102b8ef66fe72804b8937587c991d8447579c155645e1ccef03b679dabf768fe8838b28b230744fef4bb283a9f66a33f771cf26953a1d9260485d7656fcb9e65bba26adb62c9c68f5328edc4a832f5d65bb86dedc434dc1d9d0ba446d1f5a8193c5c4a21ca571f5d3bf5811ea179d2a54c364ab68e07ebbe6cae3a227e4ffd8632597f5520cf35a35a0f9339388c6da2d3769a782abfd4ab2df46fc849aa90eb8d066ad653ecd93bea9d88417ef093179386ae21d95b6b23d8ccbe06c4da31604d64d503af286945c5d74b7982d7a37fbcb150ef1a0e3eedca7fe149045bbe7a4b86ff83a39e9b0fa101d54a9538f4ec309dd7fdcddd0ae0bac0fc81da33c5c66476f2b186608a65c4b102a2a83363acd635a11dfb5b54bd78a250de94c9e14c61c7fb660fe71d93a1ea66e7366f70b7860eb0268b1e9ab1177beff337ffec2da3d02dfc73a13c638277ebc642ddd6e2360f441bda8396d04a30cc0b6e9a02c100a5b3420a19f0445ea8752a26c61f7e96ab3888a668042d40a5542eeb656ca78c860f004b93b9303cd9623130c3d7265d3e7a52eb2e13a651f980ec85557d53d762a76fcd9825bb14917098f5371a06db5745c75ff370789c5bb05d786f18635d4a2034aee4fc645456fc6a1dbee9d2308e0322658d04782c8932cfc582c4c0f1264376f1e88b135660c0418c576797ed144024c1d830350ad64c9ae4ce41cefe44a57e7ea6c84082679146f8a7691c9418a956205c7b6e809eb64e112cb4df3e06ecd17d07f85d057a8a1237e05db3a5970da61bd1f6e902ec98b77810c07f63a75c2661dee5d9f4169e91a2597c52541fe02924cb509e5457ddf8f4d9fa86d1441178c7cc710527a2aed3da96fe24ba51b4b838f98c31273f63acab403acb9bd3d007dc35c965cd4ab812a657543e47d926cc05515c2f516c60fc4b84c699345600b66793a41ca10c9cb8068929238866c27a16e0c959b832aa0826f84c27fce341d007f65dc5996fcd01070c9a87d918b93bd47950340ee82e75e3e35998f5c4e4361bda1ed1966e98f72e00e7ad62a6591a5fff1f845d48cd93d96587f2117bf9029f68743925f07d57c6408a25a95fb6c7397de2c5f0d494b84d0dbcb8f0144a03025482eb8f3dd2f8ad49053161eabe1593d901e0a6b409ec7e10d7ed4d6543bd088cc5eacf7bf5d2705d5646795a99f77867270918f77011500f8ecbb50975561aeb85c188397cf111a39de0ccb836415f1a34b469c4817d53c6ee76d51aa8d5281ac2ea7ef13f32d91504797256cedc540db588863036417204a49b2cbd4aba365e49ea528a5ad051be6f4ba10f0da05c45a127eb6084fe2f6cca416c22e4fbf540b8d7e537b57d018688f49e53c66cb6a2b9793b9cf9660131e74bfd907e0c13f9c73bcd553f694ddea0ce1eb5630b0d0fe89cf7d20cddc14178ed756e3c3e56ab3b39e8efa6db20e5c56f8a3a753fda532c98037221b9b18795f5d15ab6d6793d374ebd3b2c10d48b2d1c9f03f872b527ad5b37a142c52269344f419bc64d8382c11f0d01d5f45e1c44be0594d5a8e5b7011cfaa73635f6e96e5824f11965466e294572980fb8dde6ed94bbe9fd937b5a1fa85e23f2026bdb2d9590b607e7b006403fc0403a217142e95d22e495ec941a8c7d06ae3c14af5060fd720322b14a55c847585dae95ff9ab04006986724b5916d914521d27b260f6a0100b1f12de23cc654e607191d33761c94141caa0608fc38bcf12f73a7661d68e48ac7c63586d8a93d1f4f2888ed5bf8b1dcfbe47d79bbd4953cbb9674af8715df584c98ca0fbdf9573d1464311d89cfd36b47e45a8bd17f7e6625c9e247d072731569ea14810ca47ce8b25d13ea6e9d4d67ab3d1fa3b13c5e07c8059b54ac2ead274331d26eddbe20f9d6cfab908419a2da239857e7175231891ba29ff6f57edaf305be17090035e4e36ee381e6613800a00bb1f44b955a8109827a0dd3367e60f4c272086d43893b678b8e4afb88852113337c88e6a44dd1d78477c7ca80c65fb5f5f9fbacd02320e89caa88a9d275c95eaa8549fcb58765cf93e73f8ab1a065cf1625d5e64cb2f50a9cb196f5d9265a4c0c2d2661c1d9814ae8799542a646ee0c3f1c3460aa1f31f956e5203117108a073b416c9cb78637d7f9f8c2b4169c7cce922bf700ee1e4d82cf6920347826b779f78396f26cec3fe85c14fc01acd2693236430fc18a5f430ecdf765e0701a8922ead2165145639d72a99354df1ae10f83f8dbe62a06c4466632549c23be81e27013c707378154eaa8d0707b0e867148f0d1bd336e765589abc0e3f229e090a2cfd278eba860223fbfca55bac776ff90f9a059392d169e7780ac305d11aecad115dca270a314bf6a10680c927398885cdcc5d356e74704b622930afb5ff05cd1a70baf6a5c8deb537a5269b5d5b71b2a7c59c63fae75e555542d8bd0256a790ab1c2d23419b348b3ed3acd576e8367437c5774e1c53a9d8a21ef8eff0babb058f504a93ae2e157b9f183dd278007407e615d24d6319df351bd8ffbdf10fcb1203860177bbdaa0933c959fe2d668464303c04e47bb42c64cc77f1e03a912101ec55deb15540ec5627698a44e499a602c338e95d2b56436f6cc7b31e9d865173b8c177b100096de5679c72aa5c901677e343689c2ad6e37926eeeb90e5567d9ab13ffcd3708dd37b3b1f0b13de8e392e9781627c931c2dce8eda68c60f8fa6a92ed091f5969e07ec7cf3755187b50cac94466a1c9e7d1957432b96c5f34bb13e4bcf8864599cd21f2f12dd834eea3e2c4a347aba87806e33c3496d7daacd47e471a5bd4fcaeeed80ba757a8bd0e0f095464d6a59dfa7bb43f86e2accfd6ffbc774b107ead8151f3410bc5cc596143cdab333da44fce9726dd79383337d5b6888ec049f798b389245688352647c1fc16acc674c0a0527514933cb05c2e0bc24c7e592bea38b8f849c7e80c37644f20a658081f59b94a2c373c3612cc3b348654db8b9a64e5f9264bb7526b044a4a832526dcc62d10a6755ad9dd919eef257f73d3f568e32e294c7edd4eab25d5ab1a8c00a9b8525e76dd0524de269f37c87a9a7b7af99bab264377c6f9501575753183e3f6aa581eecf6910de9fc0c10a88eaf969720f169eb704606bf6b3346aea7b37b12750e8d38137f12baaf8a549921a64629cf7b38ed99030c179ebb23bec60ddc7dddc6655b1ccfc0ef15d2ce24280a3d86a32ec95f82ddfbfabf93918301a667b7e56cb9dba90042a1ccce56ef7d25581ac421476db61ab761f764c5210276027e02b16bea02fcd5573fe522f2847525fbffe93c0db9e0f20740a4b8b819860968dbc34c79613b14f2254b6dce08d4bd2c62667c1a0cbeb791cb4f2efe371a9d2feb698f3346678bef37581d2a52ddec651948748e11341191d1efe1b7711a48ea191ae98fdea3e97d5afe3e7e5b5190868ef0c97e98ba3972c3ece2b1a67c8d839b7bfebdbeb76ebf1cbfbdaa5520c19cd81b45214e53dc681ab5f262b638643db8a902d896b1776c6e23868fa3337f820aeec6c6990f40b811f46078a1691a63eb5884b7062e94482afa3eb40fb6f03642a9f93277032980ec0fc10cc1045b3f06a2c1af71e48f3107245da17a24247314c6d02be45ec446ba034d7434144c0c5daab9504426df9400d9cd5d3bcee79d0d51de5e29dfa8d5196563cb7595ec6eababaec5d12a7b4ec40e79e04dd3fb581b5ecab3c4d7e3d0f281bfd9d14ff330a2bd2f925a48b02906b3cc7ed3e8068334f18ba6e3ebfb1b04263c0bfa65d59f5229dbcc2063606cfdd86281c6e29de6c10aaf23e096eeb8fa981d3bb6b3578087dbc247e3f24f8d6294903c76c76b8f79ca96b5bebc3495d2e2516e1f0d2932bc335964876ba9b4eba6e511a97a4693e77d87807a047fa1321261969a3bd11fbdc57cfd541a45a2df66183217cd3ebf977a61729b1ad7b1f1331577122987ea86eafa8a30ed3a4c0b759833f64df19ae1e98ea33417f0d28da564be53fc8e06b55de9537edb08ee1fa71d536f903c75c6a40d1118e25043290c3b21e0e8a261121a325ffc39d10166af569c31502034996b1f37525385ca608a1227fc7676765cb5561cc89eee8f2b72a0c7dbc64170c3599457f6dec918ed13511ea8d0a6c18c74deecdc76fab2eb13cde18c2f7a4a86c4a03af8b12b488fbf492d618fe92b33ec4a2cf264483bf272c26b19c02f82b653766db3ccb55a732a62b1b5ed76f5e1b0e10b0bd44787b6a0d3b0644d5d3ff857ad6892a2e44016884e7c9c13ec18820b6c1dcee3f2738b6ed9db2e4a01f8f8490acc79bfef60186a83b013202d60a399889d587817d1c628741d1d88582ff384db37951eb7d57cc8a9e04e1e8f70b19025224f08361b81be0b1835f62d18aad5886611946e27ec2e0d789fd73fcaf540f0b3cfe6c4bfd724a48d8477eaff1bae2ac4ee0ebf5dc95b6e60fd1ea4fc4427c04800ac27c57b7704898a2d0ef64ddaffe103267d8c1b98cb1748f7432c5432b734ba948fd80fcf6f45e60a585341d0144e941340ddbf866a7cfaab3c1e15029906d9eff6e8f8b18d76e2b0bef2c0c8e89a31cd469c00b17acaa961ff5a7f44e8010d80ad621cfdfd0e75d34a490eb1e3ce7b760e36f0ed4de06d1c93df4f5e4f8063f91b47e6d4ed6bab978ceff9b7bf2fa98f35ef1e14cec15f5348f7bdcdf4372ce877f159fec916ca8b8cf53fcbcb464cb6c96865e584d632b46ecadcb6c1403ad0adf184b64c3e0759d345c85eaa452e45fca23d45474475e4cf1a3ad3a9e3798e8ee8813fe05f7f9c05441c1d077be5fb0e3a80a3cc6ab6cc6adb7d83b072984cc2a3ea8287132de4cda2070867bd2d30ff0c0e6357621cbfa78867d882700119a43a8153f8bf7f5962a6d6ac9ad3080150ec956ac72045765e97962c1af966cd8f5302a92d7098de7fe77b26cf12efdea7cc32e55cc7f0bd6d3eb01df4cc06f591d244122bac9fa642f973bf063354d1d19fbbd310cfd413f4c7b935928e4d98793710da7f0d6cb71286114c91fca608f0af4eb25fafe839834d41895baa18591e995ecafd77c7aea36b6e5ad1fc7e8c1f62f4f14e691055305d4e58bb9493d246aea5299074af723be3f51f0d8fd142dfaf50f35fbaf8362bf175d32bc745eaa76034c7f9ff406875572fddac4aa9b7a9f606fc2532d1e02bb9fe7ae4d734b744841415a74fa4c0ac72cd7093469a20e1de75ee60d9c2d8bc07fe0c8b9d4cd6ef791f4691b1261215a79230904c517d4c89903423f1c61d17fe15c3eca534a5a0372a91a4e57461a97487c8a89bdd4fe152c6540135dcb4d6a6ec32c1009b368dc88ddc2e15b2daabf6b481695bdaaefa2d882448594abff6c9f2738cea1ea24dc2882ed27dcf99c93b4400ce7adae02663487c46186abe9113196f1cc2295579fabfc9c45d3213dcba9996042ecdc5b0018add9352aafdd5633725239be299d593513665bbcd8a8679037e14dd9babefb280ef1407183230848e04d1db4479e7f89b965b6f96ea46a0107c561aad3831b288a269ed5bc67f97c0d91d404ca803dc7159aa0f29e076e1bbadcd7fb51306403e09b8c6794c89233d0a8abb53d9ee1d4d0fddcd6c368b7838416902f95d6914acb3f7ac5069ab3c77e9a44e2649289b929a0d916525d9a7f7286e41f502a38b5878335de361e24c10b036a89fd265fe4e0b368845d46180235fbfb54569e242df3152e8155b537664f7110aa03927a9118052c6798fc2d54abfdd41e6687b87433b7e19eb8248727c77bbc8743f82297063c06b9b41203b413240f234946ec5ecfe888e91961f6e173bdd833293524385f7f976faceea2612ce93c56904684c49cc6bfd14465a61eb0d6c8f4cf22b3d379bcaebd464504cc29008785a44800285caa5d0662c61e799298e7b22094f2c9b5267aca1fd8ce59d67e262d8303b671fa689f5e7de137b81095a3f444d81f03cabe59dc0b6ce8c14f9aa0101fe505f340a7903b6c3a59482a252985d83ee52dbfda85258c053dd71b75f48a2cd2bdb8a0c12fb22cbe4410d553831082d3049e85de4c6a66b8dfd42a9016e5471ee3fcbc4ce2ff6db9259cacbe8bcefb3e93761c41d02c7e0f7b4e3029a1b4dda7f8fa6959a9310242bb46168a2368904257bd0cc8ba558d518ca24860aaa5308a1d7b25209719ccbfc79cb16bb044ec1fe97fec593f19ce7c86153afc9e3a5a70865be4215306e3fe0ec53c94471942dc3d00dd815e00d7777cb31968339e217adbed0bfbfce1bf875ffddbbf7dc60a2989da23a4c65dd439823464173f0150cf9089f97f78de4e91619e617db373c06d096be5e53c8f2e53671a21b1adc56cf4b2cf3828a87c1fef23b4a463694e73cd332f53905999b83b7fd0035842a087ca7c6d965516de0e2cd556d1bddf3ebe2018776403ad521c1e241891a8612896b59c54347e4c10b58afe4a623771b4f0724d38ec851f03364f3251955da638a6cf54dfa1b7a5c1bf16a6ccf963352bf4c05d4829fca708a71c799aae0df33752588f544e531fcdfdb0bcf8d0bcbd79533733039fe2d028c5f12680b0264b4e53d5462117ee9a01369535f60b049e5fec515f2ed335b7452e0708ee93edf3573afe0107f975e82575182bead7eabcd4f9acc6df1cf48e4fde748823c218c981ba73aea919629d8e98c9ca78f20157f0a6981914364bdc90e375aaa1f6bf988fed9d2dfdcce88c155371452406df0f4cf5ce1fe84bd2867d346c65a192baab54658004ec194c393f2a98082bb0f1258965b7fd4053255581a67f0df694be999d3634dc57c3eb47546b91540cf198c8636da55480da8a3fb41bd40dbdc7c9794546a99c940d0d129f4416349e55cf38a99f27903f7b678c3cf59334988ccf723117880c4c0ab5a1248946e778ae074f2cd2e16353c8a67e36a413a772871ca7d790ce50baa6f45d835b1356b7053a798be5ad1752d4c08121a84bd5997c022fac438db2a2776d1a05c00b3e7b1a6af6296336779ab27308908fa52fda08ea4a3857de69328a7bc1a8d8564ea2a8961ef2c26c92794fc36051e5424c1328386e16eaefe702ab52cf53b39bd4532c3c3b21b19882108eb8d77abde1f0914a77d4dc9b990d63a71657fc29afc5b4fd8613542854c66041199a99e43118a0cde4f784a85ce333a7c7e7da4a9f65cdb6395d51127bf886850c44fdbfd501471abe9aab01b33e9c0458ee9bfce74329de5e725a070c0e55cd2a43310ee5ca33c59a04240e6051a8772a7bd1322c4cc8c3ea855c2c69970d991126e4e6fac22ce87788c39750106e9aa75de5a00951232d2af8a0f47b3d6dcd466de3e3695eed915c9c0aa842fc54eec999a4732805305cb929ad6662770c02bbb65e668cc712c072d44800f78cef85713c9af0ebff9b4fbd76d166b12d6ff0aec9a341b8ac3058a198f84e33076516977a3e12f54dd6313f5f708a4916fbdbce4f90c420eed7dd0a52b499bdb7bcff05f53ae6c96bcb04084022105ca0d605a7bb46854473d7d9a261d4c54945c902657f0dd2282204f0b2585b9fc65a0cb3e14e01cd1a6e8ddaf089531c6528d8a94db5b32ae8dc8002abff5f8fad6e2c242fc14af3e478143b8309111f782e5018b3176daf533aee8107d60b185d873828cc4451b2358c7c8aee8534a4479b1b747246841b2cc4f0fecb9e282f55a8afac84cd86b8fe685f809c6ae555f0d3551c9f15865b3686ce5385bc80f8a3c1cfc4d747b7287cc3346ff723aabf25ee39b6a6a8a6aaa7a521a594872e18a595c8ffa311204a91eddf5f4001798eefa19665f5954f8d2b4a06d5220d10d5b42211e78cb03fd69db45884b4359bedbb96da7de0efb4e5d126fd58fc036f06acfddd2e694574968a10097a6b82694d2a7bdf6bacc18df20f12d0217b5fbcabb66741f92c04138b93cdb5fca7db58652bc0ff1f1732477332de310bde35a7a17f5624377a40b5a7955f53087a92d094c5c141d3a893bf3691a4a10aaf8a9b870fb95b1781e14aaec610d51174d52866e86e5aae905e36c0065b9284283738acd78ac721184c435c47f34624b3b559cfd5eefbc4c743c31bfc5a68979ed0d7a767d698e268f1017d53678dc26e8d3ad39782d8613bff763aced6d85129a4d33e0e250764aee6db30b0b4c460eb3f8c3e3a2a7385cc81f1220008eca0391b7605daf8a68ee85fe50191ab03e1147dbaf9f81a21da4b8def1ff4b7f9ca81d0db2772ca420dc284f7737bbd6fb340b530c674c127e2c684a315af1b0ac34ba67f426449668fb17fcf3eabfe922102c48ddda15346a74ba7d75b7e8145d03247d6f8b47a0eeacd847d5d90f880355810b0e4947a9fec41e1c486b18717f00cb5ca6a16d4247269a5d3105fd934b9c6a79323b44bb63bec2a903b4d9d5bcd305cd0a992aceb9f7dea3663d7cc617e9c5d88a21ab22b699a320de59a0b1b7909c913254883ceb2740a09ac5bbd8d9c4827197b7a142dee25bf431f439bd33e2e4d4f1c55333966fd4fac2af9b77b1f039dc57b9dba44538c814b7935c28f0856cb745d17950af54d380ecf1b8d448bae0c0b86a48f350fbc9f339236d05f224ff250d4da4e5014393141a4f26d406a878d8e77a4a2f573eb9ec5b2a2115dc4b3b27717bbea32ad834f959faf69e045d82317e90469bcdb0a6899c41d0f1705eca5920717dc846130f7adac62ff479b7264097380c8c6c925a1a693aaf221792c07a012256edcfaa7ea12165b21cded4a6c511661e806d2a880d957ac323a4e71342c2612038c43bc80b7f57194e94171310345385e7630321ffa62a73e60973ef691cb19dac41ac7afcedbb79994d2cfefd4e9ae054662b64522e548301873c28b0b0ff8f3b7380f6d6e1717f10dfbd93e31c346df3f107cd0d6e1ec79c89f8180ea0ed41711f2d185a1dbef377ad4ecaa3a155035dcffea9436e83bfa7bec3dcdd5a05aa7913bcd20330cb2314675123bad59e781b5edec3af5ab5e14f1a4059329af88ae4ef887d08ccb8967c117c3278e6773f588ce89f4a595312e5bc4b3689b41f66057027e0d16d0601930eaae2a9c750c35ee5b77b6546c746e13969ee2dfad9379bc885b42d8ff22be28daa1c3feb1b6b3c36037f1bcb2184e52f57f2f405c618144fb377885e2aa7012906edc7fb5ca7d16d8c9c91fe97b3a99f73d0e249247fa0245fa81b361289e83938b1718710a807249d6c510e96a56eebd5847f0fedb9241304b606dc3df37a58db33df09d33285efbc5c8a89bffe2bb4394879c50cb85020813e7954b5139c65c203ab2a899c99ec16ef0da5427a25a76e0cbe7879066e846d83127e5d05a72b8a24e24af49806f347200b62d674a9a2249502568dbebae68e9903b7892d6e3ba15c80ba1cafa2489f1cadcad43b5b0ad5bec2843533768e559cb91fe6f579f482dd0cb5dad3b7e157ed3c492d0c1a91ea63ec31826555c8c77ccd76da9be972a48947ce3c68452a0a77e37a127be9aafb18962ab36ef795629b5ea3e39f01019fe71948ce9597ecb2703a333b5839ae2d6b1baac019f9881858f0cddd1aa7f48369aadf00d221bb99202437f9ac73d3f781707df9caf85816bdd7d7a57bc22096ae116510d654ec3e14f7f1d1faa73cf60d525494e51dfaff3f5912eac1644ab23d98a8f63b60132ed39217c572705bfb7cf0d7faafe8b9e10ddbb7e2eb0d040f489591d1d9ddf462e61f10009556399165598e5519276f6972f6a1fe4eef4f207f443b333da078be222c18dc3275bed021e84157bebaeea21a6ea5db8c59bcf5f2f7670f2c58503408eb317717af3b8595e2097fd78d9c0955f19d6ae8e1c30a029d6e6a098145d7d3052383a826edaadbf393193dc656fe2bde37089e3768a5f145c308999117ea9700fadb65258d42e78d5528a571ecfd0936702448c8e2fcaf3a473ddab7fd410df5a70e5bf6f668c49a80895a434b8337d5649ec2fa25e078db77ac0a3c4c9d715a64a302064fd926981e3171546a779c3f0418246b6341acf8ff0b84af222ab4e5b498afaf948cd208a46ad4b0b325a79ee835012c6d9f8d95bf5bd8aef9f969a703ea00254f93407933b2e0d904a4787e1e16658515a0ce5f6dbed470b686f2b6107888fd43ffae87bbfe48b16b7d9b3c617bfe24a7a222a15dcd1465f4a33b810ba4b243784fb683f1c1cf88fab7bef6f3974fcc55c2d21db971a0c94ffdb801d14f85576d5ea78986ee4e70f9fca797215f458897c6c14fdf281516d1afd838e15589119b327c96f98aef1c304b125a6cf7684802846dde2dd11bd1658a438c5fe2b4685f7001967a014b47d640f7973d6bcea20ef887ccd924e59259fa62f3aef21ce3dc33c06dbeab91551b14f43c3fc48622227acbef729ef8b6b141b8febdede6d0baea41ae130c01ed39e14f0fbab2fc2d1da4e3ec26bf9eb310229cd9e195225ddf52588d8d3044e96a8abc7ce72c27b80cc83be21766a15550dc2a5ee1c70618b8ea90fa7712c80b8db6b3a1e301aaa4900c71ca9417e10c17d5b14f88901a7c576ab7c6e15af8c559084fb1fb74a80a6c631061020d98cc0b0e0596ad7b994dfc59020e9f624674ea09fd0cc9df9140559cb8c46d00ad4b8faf5452a51bcd330f1eac986e612fbe775b8909e9e33ccfb9e9ff530d48de1c58edccb2662e36a0e3a6a3a5d335bf3b72bce20997e27d1adc28c4dc00b76b1880a0138d3489dcf92f4a3049e96f7e0e157676aceac46c3446e740e0cb467c999a0f760adde0af03b1dc06cd7605cc0f7066bae53b7d456b0d37360564ab5866dc2c0e301353410d5b5fe82150384df6f9ce5eeff99da495eb85f9520ebd9d3a1a9c02a74cc245ded76828ca89c2a9a3e0d978bbe4f91c9e7c24395dbd8bfc6d7ec8e0b23412e7ced3f6d9c03d04778853eeacdce6c13c85355a284f3566426f8a7d4cd133435dcdf93cc964a9298ed8bdfef4c8ca800cb9532918c66229bf0cd97ee39e2755457f25dfedcfa492f2dd2d19bd10d39902a4295f2e70e49f97ac6c743e27622e833cee9020e0bf5d712c790ac36ec65426062af7a94bb458767fc6d463e02e8e0df9ac77108ca9182ba8a140ea2294ca7f7f92df6ecf95f1262add3fa9d2939247c0d604d42f6f22eed9e6bdecbc53de240557b591237d045140dbc02b92ea9ad5befa67c9db7b92bdf9c00e8b3eef1024639059358d269f26865bd255e5faf1c7af7f4e567ff6aa185b8845f2ce40e0b1bca3e97a5b298a45481a7a006d3a798060229d024b84b8f0cbdfdbad78098c47378c3b563dd36e9253c6b271600ebddb12e0d61fb812472e5d4a43d27f194a86da91bab9765cd54b0d51e77373f7d89913f4fbbdf907f9b84f1c945f61bc4748b6920d54322ee23b737906414450d328e245683a47b4614f90f1c3a76eda7da80f156b20506a61194bc75bc6ca9d6ca805e65d63a8652d1c9d1285b23578ce016ae40cfa30bf81d5172b8c5c8dc9658aa0b143fab6e0005bf19705c35ff1329b3008d1537003a688373d90f13d6dd839a0eb0cbbed64ee13573815ebafebf6e9efa158a1ae2df743920884c9112a61427c828dcfffcc3b71e294e033692d9df69d3d0e284192db78fc49b00375270f19e4a1969c7b96779c05e08f1f16e2e698b303ba3b72d077f172ac78ef7f6af86df38835125d1a7bc025bf60f93a9e7228bf9922b577d67edd27fe97fcb732382df70a13d536ba2dfe7de8ad71c195ded2534ec19fb2ce824bad2188397eed7930d90606573c2beac5d01544fd9ef4b2b5bc4330e7bba2b89b2db89705fb71247df8752338c8d9f4a0ae11297f3c8f6aa8b691281e3f123ba73a80d619639bc21448359917cd0f4ee01872b7f7bac3516287dcf1c968e48a7e1122a422180190d5c4658198e777c46a9fc6613558526f20fba527f31f2e3c717537de0e0b2f8fa16f7b9bffbce430b1deff3d2f420d8bdfcef76e584bf440bc2a3dc59a4a8eab02144ee078f13239d8848e5629a87804fd54874c80182c99288f31b406b019b9da1f485b247d7dc24e49585605880af5c91e9b7aab15648a724faaad21309971952b289676fd071fcb80635eb383585a457d5bd2b11554ac4e31298ca1d57be024539e6d3f44f3c7bf97ba5fd6e7f0c72b3107bf321c977cbc02aea8ec0299e33c2f9aa970fb57f1d12406b317ef46f3fe01b9dd8b85f541165af25b5ac8d89d45d102b965965f33ee6d70c54fe69b77fec2a5d907ce574aabfeaef8e21092d562efa26b416b9705cc35463b60f9f236d254818523708f48badd38299ac828c9b1e79bc7a08a6aa0b458af4c5414800cfb437796d7b31a60ff81e5c02694b528d221e6f7ba22216e714a7b831499abd06c3400a59120ec4b31f159dead308bdb5d58692d02d2c565fb16b32d66e59907dc74ee569f4e9490761f3ef4e03c1387975a955dfeb2dd98b7c7f606757e562b848f0ad68ab566f6f3b07c3aa0a8a40bebe9c0fbb48e7224785fb660b9adad752a39b1afc28cf3ae515f9464a76a5cf72acdf1d4a7661ab559f618b2da6f20e8aae9f8d3806149e7fe4f805c00bbc84c5279f29a11b2668268dbb8b20c75a2b2dc820d330b4f10e56a23d9ce89f4ed795ed7154ac376a39306b6ed6218055b746e343a16c29b8b99763d6bae555462bc6a09d800a7f2535cc1ab5fe5f38bba7725e04888dddb350aed007dca9d43c42ecad9df1337da6294633039dbc26fa2f4672c2ba2fe64b30433bf4968b7a4d9d88606c4b87f02f3ee380739635f7d2f3442b6b835eca515fa7aeeb0993dc2ceb8c809f776bc3a284516c8a108c4b5dfbef71cd3ed6840de73d3325fb267c6e80638f030b1595d5ab1bafcd3e9c431cd6b9438b426cabf3483d19e54ba6c6d70f58aa0af6ec77bda513af5c8eab23762d01ee1d05f5cec6ef56b0a4636fb8145aed51eee25586588c62c272539682dcecde0d6553b74f0ffe59328a7da37aed9e9801a4267d29900b5200c0e7938306d935de2ae0a3ad0b06ae643f0584a854dda4eecf5b6dde9707114ce374de6f068663eb20122cd1d51d9856255fd5938a9ab9296faa9f7a8ed70e83b7927b833992d062b5a9c99f601a52abf9864cffcac954f97f4a95022de3f4ea4958210266f622c0eb170191099bda266a46127bff4357d100c0bd6383644754e05b90e78ab318101bb16ca1f1adad4a70cc3a7c61ee9f1300608b2ee33889f0259d54a04b2903411361f13f56074e0bc39f069f1d7abfed8b0d028513658850d5a0d5ce6ee47aec88bef916389dc1bcd2c84142bac717691b94bc519d9f4a0f9b91e499f31ba6fd96b964ccdf658ab0104fad73aad0f6658aa069fe98649ce58d3899c15d2c877b73cf1dd5534b9f63626f41624273b5cd1fad1226bb05969a47c60cac88dfb9168b718397f40fd118198989c7543953eae87c3dba8ba8dc2f5f495c0fc1454d9e71516613af76f6afec3f059cb71d7296a90ad7f8cf9fead7353f99fd0e3567dbcf89fa7a74656e191dfe643120be4c8189c17ba8530a2fdb305e5d84f764b4645e532a27b161be8da5367b40ec05744a49b3ed7311e7c4717ae980c29d0b5eacc36bbf43d3d7283dd27cafc1a0fdc3cb85f51a82ffd48dcd01073dafab46ef07d929bfe0e17f5b191198efc3e553c60d56121b52181a33d295c0fda1f0cff058dff6d5b5d58e5ee04955b61ccd375966ae4268ad2b3842b37eb548febf48794afaaf78e08d3237773df6d80bb36c044b5039a5ad062feccb19583b8edb014161140f352a1a07eb094c61c100324fd3b47f193fc5818641f15aaada827d60b51d2124d965f736a6a59b7c26728a1c426808465970faf98dbd32fb7b8c0a8ebd990a8af4a7ddf1eb90b9df249634ba433b609895e395e8e744a2e2411818ef17fc74970268d476e472e16b49625ead166d3d0d9b19d684db695a27f99c32656cddf13c323ed45bf77634b8ce50c1de62e4dc1cc36b61d48e4bc15adb458f9bd47bf9d8edb874b0d7d1b23b682e9354e3177bf4fd671e74cf36ae5dcd4e2ca90b3a0ba0d1f1994fa3c2e8aa1cf7083501fafb0bdaa9da695d0f9ea7b1a23e8499babd7de48f62af387828a5141f7468e969502767c6c3c18da622697d545790001f7a10087e1a263730455cd2140b477e565b1500c752f1a229c3dabb4d0a899b5ae177a013cba4968ea227024751ff17421e53ac565e78a56938391b2a6676eb012cb66232be62e2e07c3201a4b8ac821daf0bc97cc4f4fa4b301a69d65c89a99127d44e500c1f1e0e2f88bc7633b1f372f9e3c88f97442d9d996726d8c1b017418f361b52fcb56f3a75376b1912cd67a1328e7c2e7bea3f8cf98d2abf80dffcd5061e4c255be6a8177db3f98ba93545555c3718950122a04e5da015df57a764ad99add9e7ff8fa3010d297a41bc83994f6c6edf436a4a3e21bad4d2736274461edd3e2e2d30a5c80242979ede751cb4069ba211c07a75d115c6626e8c60f37023f02b3f93572a8d8923a7d4925d55d0623ad4f7537e5794806858748df4a598e12b382c97abb4cbabd5720056ca45d1672460fe42247b4bff62d693a5400692381307c91d26d95e0b58a532574852adb7eff58acfa0adfc011491dfaff6f225f7df3e4ea71b9d6f7bf1e503049fc51407472d78ffdd17a2f1a8c529ee78a7d5b5dfcdeff3613b81ac8ed86c9f337a8c0aee5d420ffccfd0b4ced3cbe2ce5dc9deeb321dfaf273a042b5ac7e60c4e224cc99c46fbb14cfa43fda7241e0ba9a2b2e3755e558fda8b9c85a775bfbabb3803270b289d30c12db7be702551fff9675fb6663cf5fb41af648f2e7beab3f732ae21c41d2b72e1f8e2abd6514728ea5b93ad7d512f8cd3855303ad001371e7db0f72a2ac335431ad9bf1e0de025c47c2ab19aaa3eee471712562dd801e42881a20ad174c4473dc1bbe65ab9ec320a75f4131f2902f19de65f87abd3a61c1cdb3b92910f6c9242a18d1003b01d3be5f4913a6f604535934b5b66abfd63534e92f611a69a6e72e677a1aa35762d54abbd1e617607608c043055cd65b80d41b37f54b562ff4d3b7521d247334435bbfe03aa8df550f8589d2a2034b2a3510c359d7d083807cd4fa666109e22b36d34238ee7c9994b268c56c6bf12e103c47810056b3c5ff876dc19c653560c57b57d84fd186e6c5b0b990d476a9f75b2c9377a10741548713ff4577705d2f8c367bacba4e23bfd743421b35b30fa173d6dd1ec061cd1115a0987412b3b150dc3dc321f63f47bf0668f29096c624b39c0824c59b229484f1ca6bff5dbaf9b543e68d138e3553a9dcf0e5789cebf6da11170e36974f7fc7e85f6df8d1406466b4bf46b84a1a9ef04f47ba69937584243b73bf1832713463ec70ef4a7e63674ccd6b4ab98d1661b92867dd8b309f224c64cd857b0ff8ab33183aef8196b87aff2667573ac63acd5cb9ed00b3760a1323e6a005e2e07629170afec77c810c3c982156393cd7b435af6b5fa50aa4377d6f3625a994b4e2a203e49d66b4239134b082da09ab72816a6e808ab969f64bc922722153c618b14475535fcbb4e57ae1350d76a79c6b1763f51044bc306948e9eb114bcbd69799c56aa6916c1e38c3ff036c5c73944f5e86c088d2adc53b7d62e86607838e2d07e0be3244faeb91d433ed04025686f57dd4ea9436e84b6ff41914f0d13ab066fee32556b8ab568992cffe4ea2f529289b8197ac4fb3050a5fe323a908e7b503eea70691f74505b4c5f15203db37b14d20d12e42468bb49275cf109b537b9d378dc391608016ca8270c436f54d3ca5d4c5ec30c1b4266987a9943c720e26b19d8f0bc3904abe3cfbbdbc591990d6d4afa25bf9b1722fb76590f48f3e46fcec17a84732ac60f5c645e3378f4ef274f0f5064a79ec080338a77ec34bfd5061f985afee14ac853687c2418fc3783f22327122ca3f8e3ada64cb5f5d753ecf2b8b05dbef7720228e5e65c224ade53509df6133e0e168087998362acb9f65d5143da4357be2ac647184b879c4cefe14d233839e7f40162d2d4d4db7339d23ce8617ac4f146c7660d3059a87e7428afe6cdcad6ae5995cba985921198351de20b990236e7b4611806476464f80df502b7b91ee43f61a25e318fa8f4dc3ed606348ae14cf6e0bfc0b13fa76ca07acd626c334f6ee079cc09d593bb691464a863345bc5c7a0949ee74a69f0fbdb252f128ab92a4a87ef94728e1e13e8c5c44831f9294b696956488b291115f0fc44a0ac3cbb3a80ff56e75cc75ed1afc797b21d7fe9ebab52f231461098930aa310dcb4aa96825ed616f578ed60e20fd1cad580c052bcab4ff3a63b8a1938f80bcc5b8ae308263666e8f035ded467ccf115e683bc99942f958235138b253252cc11b4ba30f44be3e8cdd1cff997295a3a51ad69c63734e71bec8a3fb1a8ae0a1fd98b033b6996a9d4e06767259251abf4b11cbeb8bbc421f0541bec674e83cc1b19efeb9ac8d1833fa8b2bf6f6d54478cfe258c81527cc2dd0027c81654ed799cd0a71544a70acc94cf1942389ec39b2aad76fe26abf836996f1cc3eee0c67e6bb267f265ba0f3e70a154e7f9f1baf8859531c2f541c50892e88761ca8d02b09023cb2be1391f27d58dcbab340a088e0c2d6c725672a7842563e8cd54af459c23ca2fcb94c57d8dc0d22bce81753bfb9508b1fbf81ab5bbc4177e65a284dc8bbdc1d167caa101fba5cfa7f660eff0ccf95bb6e382de3c8cebb03cca26dbb3de3fed2b1124318c1bb3a7340e7a075c81ab67c5a90221c3625feb8a87ee6bd4a09d38e0594a9c34f546d0812531bbfe6c8a8c84b52d14dd58637e33067a8cb655d09a48796575bc5675933873f5ba26ca3f7c494b86b000bb430c1b15e4e21602e8751e664b6bcf30e045bee85e0249171471ee3958082babe357ad3100a2c312a7a598c52f22f40b653b8eae562e3096fc7b26ec4ccf9a4e8ed1175c2288a2685cc7358b95f03a4e8e82d5a951a67ab7e57624401234b9d72c82d881e28ac79e9abf4a348487d87a050f15581972e105ac9feb20c0269cc7ad37444b6ff6f559b3c835eb9970a4de5bdb69f45425c68f044de99c604bf8b0053653450ee735775e467f7da017afea3139c35b5fcbd3132e57c3d60a097631da88a29780744dafa132d05d60b621f1bdfbccfb9e7a63b16a6a11b2da40d638e2358d5449a37930005561f3b631d6b51a8b79f03056c1e6c531927fdcf9ce04fa39ec0a20e2e1bc54a6a6fe7b7aab419c7ff20122659cb22c4e012c98b9049f398770cae1ad89054ff81037abe844d7b9ad16db6ca0e512b9b27b6284914a9cf9bd18962614bd0d46f4e515a2d88337f3a50fafe5ff6c000419b99478a2a36171c075ecb987026b581948edcb46c4834f004dede945232ce9abf415c14284c27c0de51a10c50bdb21ff6b6dfbf3494cbf45af399439790a348619ffc8a25a6087fffe7a3f95192d84879157916a42f4ccaccb77a97fa1b8bb3371b8aef4e744ad2cfa1079acbb9f8de886d7aa58785ca42bfe271c5e34d1c364fe6e53de77dc08e8cf8b4661674849cdcb97ecbc5415728436762e82cfa563a717c7a1660f81076c6529069e990149b10798c883fbb7a79edc818b149156b92c865a052b26f823cab6ae696da11a73094c7c43fe8ab7686bd084c71d935293ba4efe39e3c24667c8f1ed4c85991f35d4e7398f14852e5422d23b4d5e2cb57950c4d3a47dc378e67fc5af0459f4b0d7ee4aef773a2f49a7e5f3c7ab23dad0834666735c49eea80c5d99ef44f5a664c37c49610c47b1077ba9109112050c2c7d5cf8c97c061a6faa7b499bfc0564d291a0ec11ed92df670b3a81d5ba15896d57370bffc20ed3fdad960e0d895eb6f8968200594b57d4aca5338b9fbaeb244deb8a853058f39589d15c50efcae0fe90192e6c2fd2127f21a5c3192d1cb14e68872a2922fe286983b7ddd975e2b2b7fe5da4404a6d5cee91966413152584f140b2c884c7770c1aefd71b4a2014d0d311da53d074113ebaf1c71fc031ab23eb1c95987cb137962a502b378415703e9081503508cb9556c16ae8e29a18a09b3da4cc6fc167ef33d3a1158a878b63f4a1a810f572575623e57ccefdff93bb476de832422de5077ffa7f6db7c0db376087ba5abc65447d05b6d3d2bfb5b6d1c4c5462adab5af6b7639396edf3e078895a281f389d0b019bd72403343a561e55270e9d83ccd7a3ab262e791bd1230d7719fdd5fcd2c17fdb795c1827efa57422bb8f002b788bafd1bac469e387640d10d977559d6be8cd23566cc500040f7c09a18dfe57f6deefa52ec05eb9397bbcef535732418390d6550ce46ef2a4f9506c25aa51033fa0b3ed8b95b5c6cd8d2d73078231279732b1e56877d20b37b9b80b3b62e0353fd63559fd8629991095c2b0b438923a4c7447bba5a45c2bd006fa21e8812e906ece193ff3a6e96441213c4ceb89c64ce655beb2993d98d056dabf71dbbb610edc030b0dc9a4a3df030830f2e816e012ccd6e6b5f93a649016b7cdd3bd8d0914b8570be1b4384e0eec3667772394878222bcc8e7823bdbd29ebcf2425798df83b5a44292497e6d9c5738ab5886e8e16a6e7ae9657c1757588393c354d3a00aae1edf366c8a989603e1dec1fb13b7150c91bff81c0de1156424303c4d19dba51cc39f1b3f37373a4f115b61735e816d6159e26d73df46c9e40ae52ea0ae15032f038b5c945ba17748a1fcf91ace577bae24e27db215c5be00294ef8be921243c67143f782c1367aee2e9b276790be4ee25736959b81d6a761d87f5a1f4249ee36785b346f6c76ce156309e064a7dfb7068caa8124732d1b4688973d72de7f7ef599e8aca58b142994149100c2a91283efab5502b3ef7ac388bf6a89f3fbba42eb7d190e73821d48f6c6b6d1cfb714fef0c46af89a8717446bce6a6700b45d4297f543fc1258bdc5f1741533ad8c65d36458158fb0a4163251dd238bcbd107960a243f23164eaefc4fae2f5cf3f65f66e09adca50b726f2f1053e5f4fd8d239259f8c9069bed7fa9b297fedfa4977c6ebea8dfe0e790a308cf0a78ebc6d9c261a374f10efecd2ab9bf049a6f926d2da2cda687b4f804333b71d858edba45e394e9797a90973a702b0dc25f08773b517eb4c9806a9034c6ffa8936b208b8778f910f8193e42ca6f4dc0730dcb4274a862eab48c6ad66db98c6ea0390d7d518942ecaf5c1905c37b8b7bb7165ff8b5484211a51eba5bf9e946fd6180d88cbe4712c352c7fef4f80aba757b14f2dc530eb9984c1ff38db6c333b9180292a5e5268a1c53d090a87b5cb5b5201dad54c5097429abcc44ca6bf6de97da0fa83ba590e73c6df29185f9a096deaf50548962c4c89192247e87c4a481a7aad8c8e743986234b89b4a43132265e249107e78c8476e33a81218266bc77eee1d1c92ab642a491e39dcda24c6ff8412a4817a27e06d5cccb8bd7b6a6761cd415ef3fc3a67a29b72263ea171649ad4a4258f7a7524858af4fbd00d908439b105dea1064eb1e03f267ed95ed675d39f03dd557ae8a9320dfe0d763b3073b5b357e92610c2dd97aa0b2b34be15b174559321eab6b149ef57956b29d289c939117769615646bcb21a07f2aab7162ed6201ebd5490e53a766a64bd89c388ed43fed99b0c01af16cc0dad532368d1ab8d12a3d347f90afb3db8dab5e4e6eeb8988e4df79d122228682a5da219f8522e9ae56fedd972cca953ce7d5f6c040c8a92be919d4c7fbde8eb3bf9a8774cd71baf0ccdd60a6e2d99d58fdba60d5393ad27744d110a778226df2b4a9fdc804f3cd49ad035f133a63d00aecb7f71cc174aa04c34fa52b7b6be979a184f75e0af708058cf9e04635103db3d8faef5d05f301ac62795e76bf21523623fe25cf49de875524e661dee368036eb27d60b5b4a4899d4b204a378227dbe299ee2bfa36392a82408599aa66ad1d5499da2f2443af9184decfcee92a26a3f9e0e5579924260e65c32a5a5e154e1bd6289e63cc95c17c3a2ce093d8664ec1e75b66eb6dcdc7eb1b44a479c01b898621aba8235b30d19c6155ca0474193e01cdcafd7cad2cc0303e2ff253af47580ea925091da2b764717d835d77478fe5a0b4b145b004d6d6a2babdc409c0cfc7244ab870f09e7f6f41bcc56fab49757b108f1e64e6008dec80c273a75e7736ba7a2c034f62ef6b3182e1719e147710fd8d14ac41d35a241904f40d0a4f67fed37bdd0821862e9b535538b36439e023dc52b3f55c7b6fdb9d63ed9cbcf14c8070b1da14720cca99836bb0e283fe963b2609d903182dde877c3c08ba82f829b1fd6f780a8f5c393390ff0fe95528066ccd4583429d4b410a1e0f6b035395d5254a3407885483ca9d269d817b05b2e6d3463a2ec365f985d5839d218c3bdfbf6370dfecf0c03391570656bcf6d03bf8a2ec6dfed02e3016f9c09799a900fa42466b17914b10368c3e2e6b9ec34d150a0cdd127a7b50203e7b6b7fcb08d207c93c0f2d67c18fd50e29520c47dc83b64328f269d6a80efdb31726bc2c70f8af50adc55830c279cb44f309004bce19f9d652b5541637f73ec309ef430e71b8f15687bf333c96a3e147559aced46d4936cc6d41adc213a99e5179f65546544b7d54a190eacf198c3a20e1e7bbce6c8e9e21540b278e08c6809949e6dac5cec2c518b0ebab3ed72c2b2bc9e6a81638fb9399d63432a0abaf0e9a1a5b3639502f1f59fb020d2d7451808fe97c38df01319c9b5febf2e11d384b0ad763fb2d84c48c732424a513c17dade7253e2c00512e3353681de8e151e19e9ca3770307ec76919bca6d13d3d592a976931d1d3fdb86dbfe4cfd1e21c2c581132729b737cfcbee89a5b33b839df1c11fb987124547941fca37567701f8eb8fe8dbf4ecaf7b780872da878e8a333c4e509be529c0ea88bda9eaad5a762dc73078bb9c6729af55d3f96bf278934a82a69a66227dcc93f2a2773594a01e6860513e891f4fdcafdeb4342320b3475583ac39c026d4de7f52641b68099418900e3dd00066f5f72ba76ef9720719b73dac505f536b3bc745bc7f05d6c8eae09b864f3d2e44952b17ae3b06456819071c1813dfe621da23662fc3965a8615a7a5f0e4b65df99f143915d1dfb374f91afd4a440bdcc87c347d6e72ee54734925a8c71f985d2e123a59ec417fda2c6668d5ecbfe266cb3c2112d1a5fd2332620d3c4b772eac5c3949a92fa2a9631b49b8d0cba57ea86108045fdda9f12bf1d7570b40c3af0570559aed87cbfbe710b278549ff0acc4d8806791be262fae50c9f264ddcbc6a7ee49fc2eeeaa1988223511fda4048a6d027d757bfe55539d617f7f94334a51d9e13932a80aab1d0ea3151c452ff705b8b24e204a6d1d4a948d22714108af19bb9618d877ac4da250f812430e42e5395a8eedae4e1c2b61ff35cd1d83255912768a6b2c511306f6f64f392e6bdca45e155a868e1aaa49b32ac1efc309611402fa1740b979e2ec8dfe810625d65369d593a24ba313e857ad9dbb74d72143675436ffcba8c22e4719775064c0e7b11fbb941b26fb3ab041f6b9245aef148256c4b23341e160754c74e61b8584f68e5d7dd8d936ffc2cd5dea504aac3747f496dc25239b3b65a10981d1de926654590e662734b2e7f83140336c0af40db6f2527de057d42c7934b5a470ae86eba528cf0500b5112c8310aa3beb2756a96d0c2d1645db049deb3f35433e48e0a89ec1f788908bab68be1196b83a9044b2b19ab44df128963e89d5aa206d5d87050cd59474e792f123d17a28dac1d9e24aa4ff7c15c407e81495fc86b4ffdfc82c2f1dcb71f9376e4ca1bd29405d8258f92575244ce8160be9954d0ae661fe254736c26307e96d0be3fdc82fb7e319eb7af2764d6c178a42ac61fadc168572ae3cab2dc4d5abd57b825b2e2648b5eff6a87e63f4935c324cea25a7c8b9634d2e39eb8a62bac9bebd29c60c98e23a56553ce48785e238141ccb5cd2ee087365efcf122d926c79f0f77613f1eed2b5b58306049119491338e39b9dcb52f6faead1ec86c3e0f12ec3131ced7f5f091841b587fc8500225ab7a65d9571acf9dd9bb6ef89b4d021e25ad9956469c506b4e63a291cfcefda33ed3575abfea431c4c46257a3e4559abbd1ded7254bf71606027045641104fdd13dc0042773aae02e45e7baa6cd830fc661449ad132dc6762cc84faea3f2c7adf774acbf46827e570d8a11242e7eeec3af339e5507a2dcab5f296deb6224bc6628cd9faf6d5fbfced5e39de6292a816540886efdf41a0a83839464904225d678696b17ae1266072ab849b6b448eeb43696d12d63011a9955df3bf60ca23e7b9e0ddc9cdd0925a680ac08d7dece395865f50760de20caefc2237dae7c27b0c71b3f78961a085d0760f81abdc0ceafccf4b3b90a29b66c893f9abd536b25ece9c21209944c8aab5573a7102db3268205ce3e6b136cf3161c4e4a7dc2f2923fd31a9943a9a77e4b1fc776532e1358bee690518ee206a250349f015aeb83a26cdfe3a753b3a715e54e61e0ffc0a351ca8241c0739cfca65e55d60fe43e2d0d48064089a0b23489a72877bdef4573f377ac81315572d60a317ddc7e8a740de3f0a6dc5b2c95097e77215f91f66ceb7117d816cf731ddf26e553b06b6658963b6b6b4e221d160894be58ccd9df0bfe554d48b6a8d4ecec5d53939662cd56756dc5a9a70547bd6231fb4502c3bc97c9fa56f7d5f8220b0eebc2bf5d95924020bf6ed8550ecd6e342809be98dd0a64fccc1108036d6ac4bc6890a372ace5f5126de0769380dd8945e6d936cecebf0d20be611a18c010fce5dfb99aaf78bdc1bcc9274101104b839c98568662abadbdd81cbd3bf7ef567be5145d4c3305ec5af8d317cbea561f0ad4b8c4c03f0a350f9e8cd4e95977703cdfb2f9ef56e04c34fd7585c6cb7a4b3fa5f22a52fabf08acfcd081f12499fde5c979832c030713d6682b702adbe66b6b444e6ac868530210c5ee6073f82f9e4b1d1b5ee3eabd33314e83c33f5b1843b5f4f0da180e6254b58f8ae77c8c7cb62e0539f98726f69b312222bb0897b8c983555d7a1b7bf2f675f45652d4770da2aa34fcd15e7f979bc8a2be24704e31601828aadeade96efa83a476f57589b30c5efb7fea527a2c0e3dee030536ffecb5355dc7bc3996ff164cf9fb39a370b2ae1ce2a1dddbb95215fc0822b7c5a281d5997588117a0db044ef23a81d4dabe144452e0a2bb963ed251c823d22fc3f76597a00fbff63852b889c534423bccdedc59b6ff40848369f5c674e3978725b290b65eaa6bea099a6c51439830c5cb9124d66c2e595b850c8da3b8bc533651e4972d636177e0b31cead63b2a4db09c099ccc5777261786fedd7fc0ab1e596241d1209e7d239dc3d89e900d610e570e165f6c2c5f591bd1e65fefbfef937c3ca989d05bf494b920bc469b9cd61aea26afe31a8917a4e1a59744130e0ba1be5de307d7e906c2801d2fb37170a204b12ecf1ca44f7aecc5dc9e93874ad03a693e23388723537001bd72dd44e7698d604324b9f854203f946c95b7579e0622536c21cb8fbd610bb8cfb4de3c5c1482c2c248e8de3322bf05d4b3c04b2fd55ff8b19a01b2a680076e438e252d3cd4869273533e3c366f2be73ee951dde26684ca46284afc86cd8be5a0a7f4b924d43415c65a886a20d97d3c6b88f635765e5687669504186717ff5a8a3eafb22bfebb3163a716fe46e1eece8ae4cf87eb9a09f9a5475a35e5808e8bf1396c19b3c83e8e9c0b2ad62132fc89bb19294fc62dda1cbf69d6b35aae4ce25fe2f941054ad6a8a8df7545d7d7c4df46d89e8812048800cbfc599cce9fca5bd16029c1ca54ca315132ec2e5752658f5ffa643148915421b49d756b49198ae6c5fa72cf6a09e5d10fe9306c71427eafcd66d2e74971fee6b075242942545e751eb241c6be3d3be554d2002a19116432e5fa3fb8053c4883342aee755cc16efbac00f8b6e26fb4207f171b912e1b06fba0db86daca6f1aaf6341d120d55734bf344bde69031f6f414e53ade427cfb8fb61062a85aacc5deaa73f27cbb6131c9adc9bedfe4144e837a3c6d999f6a140577e791ad96278dc8000f0476c36715fae78a64f6d829056d8ecb4189b557e1284f1dbaca09b8897aecc3b2bb85ad38fe12088391fa8159b19aa63ba4926da15ce55542c88b6d344efd638566f5f06694ccdf39fceac3601997a3b3541f7afefc1ed50b59a1ae33d7dd288ec83602c0f0bc7f393828e5bcaf0b9e0f9d2c3e84c46d0ac50d5a9b4cf7ca645d46511ded7bca8329df6fe3958177605cd25076fc2cd9d696087f8da06ed26ac13764cfcdd64f2872ea2b8db46303bd6213fa3fd74933c44ed76f175b6c84223ddd588aecfc8e8f85493c2f85689819da608c81378d3d234e850d638e1cf99e90fa2acc50438db8bad97d7f9a360454272c06498f5df6b362f35070288aff310405180d51f3ae48ca788aa24563875f5d0ec1c0d5fbe8fdb17e927054ac330b33f90791c8198575128386381b36d0d60f867429a699edf43e1050efba74b36be3d6eba4e689fbadbf9fc16776af230f79e72457c9533a99292ddd86a481f240c8f2c46649df1d12c03bf04184f9f2992cf2a35f88311b16c9a563e149e762c7d28fe7563da3486cc2490f58c249ba9b4235a6ab1e5f21bea5024288d7dad045c76f5e9023b83f8fe12109c9c2d4b5c38f7578897e31dfacbc8b8e7d935499771741db93500fc36998c66148efff43e4d7af3947f96a7ad1787bc169f155fcd8004b13d5a80c76030f4614a335df99ed60a87154b032b3378711b2850416f2b84911d5427d56a6591abf2937dbd86a266ff166111d46460e893f69be719a8ca06a1296b3024fa5f6aa9a544537b45828e87cd449142d862bbd349557342ccb95052a1d27ae21401b4d530e8ea0263458475ab389e7088a1b277268065c7469d08621b990da75d07a0124454cd99a17ea99617690012473dd0bd5b9356134d743670c4b39e5e147144445a7b18d9622bffe9d3982085c0f00be73377b1816dcfd5623f17a8230b33fb1b264aa7aa464a70672648e2d506b4a9fe3751f87cb58077f9c62ba57c935fe4c0e9f96269d47cb7cf889bfbc2456073153c13c7dd359815892e61931f3da0b1519ca19a373f2f5e227f57de56751ff6eb85e98a99504eafe2d5d7442839464e027739d49ec3c397e2de24b3e9eb1ac401d1ac57a55b808a6aabd46ab29bdedbf5228a248bfe9da91e2d9e427eb7a2378a493f1158c280f6977103aedea98f8007771a6376042eb77548504713cdb3653e959629984c64d6496bc5a716845b402478df7b0fa02775da7cf135195a511a23a4726e8706f7d8e9b206f66207fc05384fa0608b17bac04a7809d108c91014958d1ac6d9c025ed1694113c06a94b4754c9228bc8230e19549515d003c6d008599d2b3e0f3fd9c5555a1a34c9708733ddca8196db9eb4d145d7251e7049d45aed38056ee5174bebef4e936967033d94de5fd10e821b2521359666691be05476e5313a5d9c3fa3c3457754a276aef0ed6cc5c8f035d469cc0057df351c489de4fe245d630b2df170f33f87ef4c0bf16f84462ae6636f0fa549f70eaa11f3e69c40f28a30b06558ba7b40f137784249c48f4ac3827d365f7e5e401ccd7f865893f4b0888805fb639c0299a289b46c929c175e4621130e088e2d1deb6cf4cf79a1ca92c06617f794a6acc75473b3b6d7f370ace7b513724ae72d87976d3643d784b4f50e1f6289ffc722d0612247a6c64a921a62ebd8730052672785b4a6420f9d4fc493648deb4c7703aa88d3e1adef9f27f14a097e3dfedc2ae07fd15835b5c3ece9858bb569c17a36c6aeb5d7404440875cb14091c3caf3b725bf301d5756a1122bfe823f4503757c3c26bcb2314fd853b0a31eae940b9ee2a9fb915e80d1efd47fd1a89b4114769bb5852c039ccf8a761551a406e65f0facceb423a72f4c2896e50b5a86a41b005fcbbecb10d5da831faa90cd4af5cde15f412c4f7561e2341789458984772e863aae3e60edb43281034bc203694a99571d6e89004b3881ca51116b8998b943e2e1d68da9f91427f15e579725e7c5dad5667ac8f638e686c519161ef3e8df5cad93625262dc08dd5e58a4247171c60d6468b42cda6c96e65fb4ee3a58ab0b5013f4461c150807fd8f2e93f5cdcdebec7752313e4389fc40f4f6bbe8c363a569ca1d249fd3c71b1ebd3d72405b8fc4f5b7ed24d342f7ad5a1d83345694ff1f80e848a4faa86c7976fa7b9ee536e88f930ff73a587783f0469ea412bdb179dd7a06e184b8422502172ac3c93be5579490941f9b7b46fb3614921eeca0e3f8f5719ca86fbff93c86e2f76fb8e0d80f346ffe621943866268484f1d4cbe84a9dde0576e61a5c98d2a1b9298f12f32181d778d7e22152b7167259db1bfbe8ac73f25d534c3e880a66bd732c845d63b4dfe1487576cde6597224cc4849e85f4a1f9fb2e4a9d2323b41e98be16d2789c701cfc0558f36a1f6e9fd20db73a617d2c8345766795800bc9a4bc3d95673a4c7c090bc4743b953dae39bbf54a7654f22ff4d5c7eeb0f9bca52b5e1068899ee2442fd7d640ccd282c7fe34838b2b864593885c0746715b1e68073dced5f0a1fdfd68c0ac72808eda3860074fc0d708d4c114b44f067108907c2d66a4bfbd2f700fe04a5da4d5a68ab41cb8cff1bc857b2d81214194f43118ba2912c41823403aa1101970bce4d29a21629d4225fcf0e47dc88fac20c73ebc8c53bc83f8fcf682fe67024c6c1809ef1fc7e891da3ca5f7dd262847ed527ef5af8b6671a3bbc1187e07e59f79046b495a06f545e9d3b699e22a22420c90432d3d04a4bea727e148ddd87aea9cb9b2ccfa0f5923262c7efab4372b29799bd2d9d57f7a5526be03d0c5cb70e116e556c1183975c511d914bd4364edeca84f9f7b51f188eda9aa5aa371d634ab01ba87f56b56f87100af7431435f2d88e27d7fc26ae71276f2e572df818845494ca2d4b800e498e9b6b6c22c572583c7dcff9d3b0fdd1c69b5e04e9f9112f5d2d361ac9a22e266ae6c31431f2e9ddf07f83f12593e2ae914723fb753fceb94801ca47769b5a5434942b5ea1a1da25b0e30472ae114f9ce77b0f9b3bc0e006a0237e8806f88a882d3b7541f982d67b903c9a7dada5dadd4a04d413772ab2276931ca633b964e781beed20153fda2a8d5ea8d6f4b33d546f17e47b7bc14935ea5f1ffab7bb52cb1bf819405c46631e0117edc439284573bf5a9da05ed5557e5025122dde685fcb41e9aa958d4f926d2f574f4c9f8c1239129f6feedae4702f7b658ee2af56e0e54ccec34d7e1b582ad28d58ce42585415d124879846dfd4ba0b6f774dbe3dfded28a01dc365e164cc6820d923c920620656ee8968b47073f455ea6ebf44685a03edc3c1e3fc46163c1147db97d17ff1278067dc9dda47dfe5ba4c4735a4a0cf9996b3123a08af7b6e3be9351206ce2eb712510449c9ce1bffbd770b5b55eab707a3add4828584c3ca99e8ee251110c7e5f0d4f32b5454233cedbd9317ac333fda4e9b3b09f43b978ec431dceb5b11bf524b7a815efa808e4c4c7a6bf84d73cf4689913fd0bc9f395c28b8aa981c9c6039e149d86e096d3f370c1e78e4ca0db77dd5ebb62c81f0d022c720fd9555063d7b6c7fbe4a75074702b2b2646d6c2701e5e2cad726d766594f5e1ccb40abaf10e830f53174a66a3a4467d465c953bf9cb3a70637d2c8c252ae4f89b9c7fd9f0cd04119d805002780f59e4686441c104c2c1bbed2a9045515b66df2d0e608cc38de106c12d495cf4f588908adf559064d2c15f6c38eae0d9d4d56460d997c5ef86ddca34c3d27467f77d10c04b267b0889880177a516877fa9606183ee7e3c6213eb9d5f7e7390ca235a5fde7138fb8a4f4bafe1208f923c31e96f7edc0fb6a351684eb9039580c4d1cf7d7e7d21d5c59a9aed398b00e6c28dace54528f7951989e145ff36440914e6f6f809472a6086fc152eaaa54a8771243765f79cedd53b0e0ea2c535c044fd39ea6932a5a6775a56cacbf326c16d406c3038c888ef5dc1a68f5f20fb1f7d47f68921028f1543a39ff8f43609101bb119475d8cddfa4b403a689471dead38e07ba17545b8f3d100872a2547f25500cb78a072c072ff088737836c383c5a8be79fde47386474d18c9fd0b3765ecd51048cb8366342a1339267a7b8751775adece4a9d30c9c8ae1a86f42a0e30b1eb30c2ef5520c1e38c4a13d504f059acee201712fa8d0e0a71e527ffdfe01dd3bdb401fc08cb871598bc5df3589431861887390fc5bfc079e7b9faffd84c33327fcdad614244d2fc9d7ee2c1795c2819b3646f32d9d657227eb81ad161289154d50f9c5516bc5d912228fe548ef50a4842bce66b75709c3b1614470171be088cca7ae0d5522df0731e71518a59b981dfd8b78bba9a2a8a411b04c5976a676634fce3d2a4c0fef37111cc71464ae40663ae285f29c207dd755aaf85e4e33417671defd6239f5b11f3f3bbea9a396a61eb6bc7be96208f3a02924b06bafa62e7f564b394ed86cd63bda0362f23a359df769305f9a821770d98d5b91f268f04d8510a44dc29f14dbaf06c428fdb85feac3e1afbd1ca9743cc173453e80d2f7bf41ca38865c6933ed23413a41a781ecad537da7270e99ae896d4d645235964cb459dc11abcbeb95703b6d75fa5097631246899b1e80d370b71b97d2a2f18963db6bd8c46993b5df1fff6e46c19b0949be08fe65c89b95ae77bf63dd9072ac53d67d6cfe8f2c6eefb5a2ecb2e35a89b42c512bc653f6e2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> test </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 网络流 </tag>
            
            <tag> 状态压缩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>光速幂</title>
      <link href="/2022/01/22/%E5%85%89%E9%80%9F%E5%B9%82/"/>
      <url>/2022/01/22/%E5%85%89%E9%80%9F%E5%B9%82/</url>
      
        <content type="html"><![CDATA[<p> 一个小知识点</p><span id="more"></span><h1 id="光速幂"><a href="#光速幂" class="headerlink" title="光速幂"></a>光速幂</h1><h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><p>先给个快速幂代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % P;</span><br><span class="line">        x = x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>快速幂可以在 $O(\log y)$ 的时间求出 $x^y$ ，且实现简单，是很常用的算法</p><p>但是，在一些黑心出题人看来，还是不够快</p><h2 id="限制"><a href="#限制" class="headerlink" title="限制"></a>限制</h2><p>为了有更快的方法，出题人必须给你一些额外的条件：</p><ol><li>模数不变，即多次求 $x^y \pmod p$ 时， $p$ 保证不变，这个一般题目都能满足（其实可以变，但每变一次就要一个 $\sqrt{p}$ ）</li><li>底数不变，即 $x^y \pmod p$ 时， $x$ 不变，这是光速幂最大的限制</li></ol><p>有了如上限制，来看如何把 $O(\log y)$ 的快速幂改为预处理 $O(\sqrt{p})$ ，询问 $O(1)$ 的光速幂，其实很简单</p><h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>根据欧拉定理 $x^y \equiv x^{y \mod \varphi(p)} \pmod p$ ，于是可以预处理到 $\varphi(p)$ （为了方便一般处理到 $\sqrt{p}$ ）</p><p>具体地，预处理出 $x^1, x^2, …, x^{\sqrt{p}}$ 和 $x^{2\sqrt{p}}, x^{3\sqrt{x}}, …$ </p><p>然后，对于询问 $x^y$ ，令 $p’ = \sqrt{p}$ ，可以回答 $x^{y \mod p’} * x^{(y / p’) * p’}$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> BL = (<span class="number">1</span> &lt;&lt; <span class="number">16</span>) + <span class="number">5</span>, B = <span class="built_in">sqrt</span>(P);</span><br><span class="line"><span class="keyword">int</span> qp[BL][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> ph;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>)</span><br><span class="line">            res = res / i * (i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (x % i == <span class="number">0</span>)</span><br><span class="line">            x /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>)</span><br><span class="line">        res = res / x * (x - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ph = <span class="built_in">phi</span>(P);</span><br><span class="line">    qp[<span class="number">0</span>][<span class="number">0</span>] = qp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; ++i)</span><br><span class="line">        qp[i][<span class="number">0</span>] = qp[i - <span class="number">1</span>][<span class="number">0</span>] * x % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= B; ++i)</span><br><span class="line">        qp[i][<span class="number">1</span>] = qp[i - <span class="number">1</span>][<span class="number">1</span>] * qp[B][<span class="number">0</span>] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qqpow</span><span class="params">(<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    y %= ph;</span><br><span class="line">    <span class="keyword">return</span> qp[y % B][<span class="number">0</span>] * qp[y / B][<span class="number">1</span>] % P;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手打int128</title>
      <link href="/2022/01/22/%E6%89%8B%E6%89%93int128/"/>
      <url>/2022/01/22/%E6%89%8B%E6%89%93int128/</url>
      
        <content type="html"><![CDATA[<p> 没准有用？</p><span id="more"></span><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;deque&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">int128</span>;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shift</span><span class="params">(int128 &amp; in,deque&lt;<span class="keyword">bool</span>&gt; &amp; de)</span></span>;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">size_t</span> N&gt;  </span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(bitset&lt;N&gt; <span class="keyword">const</span>&amp; b1,bitset&lt;N&gt; <span class="keyword">const</span>&amp; b2)  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">int</span> i=N;  </span><br><span class="line">    <span class="keyword">while</span>( i-- &amp;&amp; b1[i]==b2[i] ) &#123; &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">-1</span> == i) ? <span class="literal">false</span> : (b1[i]&lt;b2[i]));  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">int128</span>  </span></span><br><span class="line"><span class="class">&#123;</span>  </span><br><span class="line">    bitset&lt;128&gt; number;  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">int128</span><span class="params">(string str)</span>:number(str)&#123;</span>&#125;  </span><br><span class="line">    <span class="built_in">int128</span>(bitset&lt;<span class="number">128</span>&gt;<span class="keyword">const</span>&amp; b):<span class="built_in">number</span>(b)&#123;&#125;  </span><br><span class="line">    <span class="built_in">int128</span>(<span class="keyword">int</span> a = <span class="number">0</span> , <span class="keyword">int</span> b = <span class="number">0</span> , <span class="keyword">int</span> c = <span class="number">0</span> , <span class="keyword">int</span> d = <span class="number">0</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="function">bitset&lt;32&gt; <span class="title">b1</span><span class="params">(a)</span>,<span class="title">b2</span><span class="params">(b)</span>,<span class="title">b3</span><span class="params">(c)</span>,<span class="title">b4</span><span class="params">(d)</span></span>;  </span><br><span class="line">        <span class="keyword">int</span> i, k = <span class="number">128</span>;  </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">32</span> ; i ; number[--k] = b1[--i]) &#123; &#125;  </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">32</span> ; i ; number[--k] = b2[--i]) &#123; &#125;  </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">32</span> ; i ; number[--k] = b3[--i]) &#123; &#125;  </span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">32</span> ; i ; number[--k] = b4[--i]) &#123; &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>[](<span class="keyword">size_t</span> i)<span class="keyword">const</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">return</span> number[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">    bitset&lt;128&gt;::reference <span class="keyword">operator</span>[](<span class="keyword">size_t</span> i)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">return</span> number[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">return</span> i1.number &lt; i2.number;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">friend</span> int128 <span class="keyword">operator</span>+(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(i1 == <span class="number">0</span>)  </span><br><span class="line">            <span class="keyword">return</span> i2;  </span><br><span class="line">        <span class="keyword">if</span>(i2 == <span class="number">0</span>)  </span><br><span class="line">            <span class="keyword">return</span> i1;  </span><br><span class="line">        int128 result;  </span><br><span class="line">        bitset&lt;2&gt; sum;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">128</span> ; ++i)  </span><br><span class="line">        &#123;  </span><br><span class="line">            sum=i1[i]+i2[i]+sum.<span class="built_in">to_ulong</span>();  </span><br><span class="line">            result[i]=sum[<span class="number">0</span>];  </span><br><span class="line">            sum&gt;&gt;=<span class="number">1</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> result;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">friend</span> int128 <span class="keyword">operator</span>-(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(i2==<span class="number">0</span>)  </span><br><span class="line">            <span class="keyword">return</span> i1;  </span><br><span class="line">  </span><br><span class="line">        int128 result=i1;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">128</span> ; ++i)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>(i2[i] == <span class="number">0</span>)   &#123;&#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            &#123;  </span><br><span class="line">                <span class="keyword">if</span>(result[i] == <span class="number">1</span>)  </span><br><span class="line">                    result[i] = <span class="number">0</span>;  </span><br><span class="line">                <span class="keyword">else</span>  </span><br><span class="line">                &#123;  </span><br><span class="line">                    <span class="keyword">int</span> k = i;  </span><br><span class="line">                    <span class="keyword">while</span>(k &lt; <span class="number">128</span> &amp;&amp; result[k] == <span class="number">0</span>)  </span><br><span class="line">                    &#123;  </span><br><span class="line">                        result[k] = <span class="number">1</span>;  </span><br><span class="line">                        ++k;  </span><br><span class="line">                    &#125;  </span><br><span class="line">                    <span class="keyword">if</span>(k != <span class="number">128</span>)  </span><br><span class="line">                        result[k] = <span class="number">0</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> result;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> int128 <span class="keyword">operator</span>*(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(i1==<span class="number">0</span> || i2==<span class="number">0</span>)  </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int128</span>();  </span><br><span class="line">        <span class="keyword">if</span>(i1==<span class="number">1</span>)  </span><br><span class="line">            <span class="keyword">return</span> i2;  </span><br><span class="line">        <span class="keyword">if</span>(i2==<span class="number">1</span>)  </span><br><span class="line">            <span class="keyword">return</span> i1;  </span><br><span class="line">  </span><br><span class="line">        int128 acc=<span class="built_in">int128</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">128</span>;++i)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>(i2[i]==<span class="number">1</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                acc=acc+(i1&lt;&lt;i);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> acc;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> int128 <span class="keyword">operator</span>/(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(i1 &lt; i2)  </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int128</span>();  </span><br><span class="line">        deque&lt;<span class="keyword">bool</span>&gt; de;  </span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="number">0</span>;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">127</span> ; i &gt;= <span class="number">0</span> ; --i)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>(flag == <span class="number">0</span> &amp;&amp; i1[i] == <span class="number">0</span>)   &#123;&#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            &#123;  </span><br><span class="line">                flag = <span class="number">1</span>;  </span><br><span class="line">                de.<span class="built_in">push_back</span>(i1[i]);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        int128 div = <span class="built_in">int128</span>();  </span><br><span class="line">        int128 result = <span class="built_in">int128</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">while</span>(!de.<span class="built_in">empty</span>())  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="built_in">shift</span>(div,de);  </span><br><span class="line">            <span class="keyword">if</span>(div &lt; i2)  </span><br><span class="line">            &#123;  </span><br><span class="line">                result = result&lt;&lt;<span class="number">1</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            &#123;  </span><br><span class="line">                result = (result&lt;&lt;<span class="number">1</span>) + <span class="built_in">int128</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);  </span><br><span class="line">                div = div - i2;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> result;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> int128 <span class="keyword">operator</span>%(int128 <span class="keyword">const</span>&amp; i1,int128 <span class="keyword">const</span>&amp; i2)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(i1 &lt; i2)  </span><br><span class="line">            <span class="keyword">return</span> i1;  </span><br><span class="line">        deque&lt;<span class="keyword">bool</span>&gt; de;  </span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="number">0</span>;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">127</span> ; i &gt;= <span class="number">0</span> ; --i)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>(flag == <span class="number">0</span> &amp;&amp; i1[i] == <span class="number">0</span>)   &#123;&#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            &#123;  </span><br><span class="line">                flag = <span class="number">1</span>;  </span><br><span class="line">                de.<span class="built_in">push_back</span>(i1[i]);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        int128 div = <span class="built_in">int128</span>();  </span><br><span class="line">        int128 result = <span class="built_in">int128</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">while</span>(!de.<span class="built_in">empty</span>())  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="built_in">shift</span>(div,de);  </span><br><span class="line">            <span class="keyword">if</span>(div &lt; i2)  </span><br><span class="line">            &#123;  </span><br><span class="line">                result = result&lt;&lt;<span class="number">1</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            &#123;  </span><br><span class="line">                result = (result&lt;&lt;<span class="number">1</span>) + <span class="built_in">int128</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);  </span><br><span class="line">                div = div - i2;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> div;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>==(int128 <span class="keyword">const</span>&amp; i,<span class="keyword">int</span> <span class="keyword">const</span> k)  </span><br><span class="line">    &#123;  </span><br><span class="line">        bitset&lt;<span class="number">32</span>&gt; <span class="built_in">bb</span>(k);  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> g = <span class="number">0</span> ; g &lt; <span class="number">32</span> ; ++g)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>(i[g] != bb[g])  </span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">void</span> <span class="keyword">operator</span>=(bitset&lt;<span class="number">128</span>&gt;<span class="keyword">const</span>&amp; b)  </span><br><span class="line">    &#123;  </span><br><span class="line">        number = b;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">friend</span> ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; o,int128 <span class="keyword">const</span>&amp; i)  </span><br><span class="line">    &#123;  </span><br><span class="line">        o&lt;&lt;i.number;  </span><br><span class="line">        <span class="keyword">return</span> o;  </span><br><span class="line">    &#125;  </span><br><span class="line">    int128 <span class="keyword">operator</span>&lt;&lt;(<span class="keyword">size_t</span> step)<span class="keyword">const</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int128</span>(number&lt;&lt;step);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="title">to_ulong</span><span class="params">()</span><span class="keyword">const</span>  </span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> *((<span class="keyword">unsigned</span> <span class="keyword">long</span>*)&amp;number);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span>:  </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">ToDecimalStr</span><span class="params">(std::string &amp;str)</span>  </span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        str.<span class="built_in">clear</span>();  </span><br><span class="line">        <span class="keyword">char</span> buf[<span class="number">128</span>] = &#123;<span class="number">0</span>&#125;;  </span><br><span class="line">        <span class="function">int128 <span class="title">Radix</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>)</span></span>;  </span><br><span class="line">        <span class="keyword">for</span>(int128 num = number; !(num == <span class="number">0</span>); num = num/Radix)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">if</span>( <span class="built_in">sprintf</span>(buf, <span class="string">&quot;%d&quot;</span>, ((<span class="keyword">int</span>)(num%Radix).<span class="built_in">to_ulong</span>())) &lt; <span class="number">0</span> )  </span><br><span class="line">            &#123;  </span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            str = buf + str;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Print</span><span class="params">(int128 &amp; data, <span class="keyword">bool</span> bEndl = <span class="literal">true</span>)</span>  </span></span><br><span class="line"><span class="function">    </span>&#123;  </span><br><span class="line">        string str;  </span><br><span class="line">        <span class="keyword">if</span>( data.<span class="built_in">ToDecimalStr</span>(str) )  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s%s&quot;</span>, str.<span class="built_in">c_str</span>(), (bEndl?<span class="string">&quot;\n&quot;</span>:<span class="string">&quot;&quot;</span>));  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">static</span> int128 <span class="keyword">const</span> one = <span class="built_in">int128</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">size_t</span> N&gt;  </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_one</span><span class="params">(bitset&lt;N&gt;&amp; b)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(i &lt; N &amp;&amp; b[i] == <span class="number">1</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        b[i] = <span class="number">0</span>;  </span><br><span class="line">        ++i;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(i == N)  </span><br><span class="line">        <span class="keyword">return</span>;  </span><br><span class="line">    b[i] = <span class="number">1</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_one</span><span class="params">(int128&amp; k)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(i &lt; <span class="number">128</span> &amp;&amp; k[i] == <span class="number">1</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        k[i] = <span class="number">0</span>;  </span><br><span class="line">        ++i;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">128</span>)  </span><br><span class="line">        <span class="keyword">return</span>;  </span><br><span class="line">    k[i] = <span class="number">1</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">shift</span><span class="params">(int128 &amp; in,deque&lt;<span class="keyword">bool</span>&gt; &amp; de)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>(de.<span class="built_in">front</span>()==<span class="number">1</span>)  </span><br><span class="line">    &#123;  </span><br><span class="line">        de.<span class="built_in">pop_front</span>();  </span><br><span class="line">        in=(in&lt;&lt;<span class="number">1</span>)+one;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">    &#123;  </span><br><span class="line">        de.<span class="built_in">pop_front</span>();  </span><br><span class="line">        in=in&lt;&lt;<span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IsPrime</span><span class="params">(int128 <span class="keyword">const</span>&amp; number)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">for</span>(int128 i = <span class="built_in">int128</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>) ; i &lt; number ; <span class="built_in">add_one</span>(i))  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">if</span>(number%i == <span class="number">0</span>)  </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其它 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>李超线段树</title>
      <link href="/2022/01/22/%E6%9D%8E%E8%B6%85%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2022/01/22/%E6%9D%8E%E8%B6%85%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 队爷的智慧</p><span id="more"></span><h1 id="李超线段树"><a href="#李超线段树" class="headerlink" title="李超线段树"></a>李超线段树</h1><h2 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h2><p>顾名思义，这是由队爷<strong>lc</strong>提出的一种<strong>线段树</strong>，用于维护一下问题：</p><p>在平面直角坐标系下维护两个操作：</p><ol><li>在平面上加入一条线段</li><li>查询直线 $x = k$ 与已有线段交点的纵坐标最大的线段的编号（也可以得到最大值）</li></ol><h2 id="算法流程"><a href="#算法流程" class="headerlink" title="算法流程"></a>算法流程</h2><p>既然是线段树，自然少不了区间和区间信息</p><p>lc线段树以值域为区间，对于区间 $[l, r]$ lc线段树维护的信息是“与直线 $x = mid$ 的交点纵坐标最大的线段”</p><p>询问很好解决了，只要对所有包含 $k$ 的区间上的线段都计算一下即可</p><p>问题在于跟新，如何在加入一条线段后维护出新的最大线段，考虑向节点信息为 $f_1(x) = k_1x + b$ 的区间 $[l, r]$ 插入一条线段 $f_2(x) = k_2x + b$ （保证线段可以覆盖整个区间），分类讨论（下面红色代表 $f_1$ ，蓝色代表 $f_2$ ，绿色代表 $x = mid$ ）：</p><ol><li><p>两条线段有明确的大小关系，即在区间内一条线段完全大于（小于）另一条，直接跟新即可</p><p><img src="https://s2.loli.net/2022/01/22/LdXUlcTYKFEZWSx.png" alt="4"></p></li><li><p> $k_2 &gt; k_1 \wedge f_1(mid) &lt; f_2(mid)$ </p></li></ol><p>   <img src="https://s2.loli.net/2022/01/22/YelSVQyT9BEFvoa.png" alt="1"></p><p>   此时用 $f_2$ 跟新当前区间，并用 $f_1$ 跟新左子树（这里有一个类似标记永久化的思想，右子树的信息可能并不是该有的 $f_2$ ，但询问时我们会用 $f_2$ 的答案而不会取右子树的答案）</p><ol start="3"><li> $k_2 &lt; k_1 \wedge f_1(mid) &lt; f_2(mid)$ </li></ol><p>   <img src="https://s2.loli.net/2022/01/22/8PcIXBwOa5MEjeU.png" alt="2"></p><p>   此时用 $f_2$ 跟新当前区间，并用 $f_1$ 跟新右子树</p><ol start="4"><li> $k_2 &gt; k_1 \wedge f_1(mid) &gt; f_2(mid)$ </li></ol><p>   <img src="https://s2.loli.net/2022/01/22/kEGYLpPmRhszHSo.png" alt="3"></p><p>   此时用 $f_2$ 跟新右子树，当前区间不变</p><ol start="5"><li> $k_2 &lt; k_1 \wedge f_1(mid) &gt; f_2(mid)$ </li></ol><p>   （懒得放图了）</p><p>   此时用 $f_2$ 跟新左子树，当前区间不变</p><p>lc线段树没有 <code>push_up</code> 和 <code>push_down</code> </p><p>有一个需要注意的点是，为了方便求值和交点，我们用斜截式存线段，但垂直于 $x$ 轴的直线没有斜截式</p><p>我们考虑到对于垂直于 $x$ 轴的线段 $(x_0, y_1) \to (x_0, y_2), (y1 \le y2)$ ，在只关注最值的情况下，它等效于一个点 $(x_0, y_2)$ ，而点就可以写成 $y = 0x + y_2, (x_0 \le x \le x_0)$ (就是平行于 $x$ 轴的，长度只有一个点的直线)</p><p>考虑时间：</p><p>询问操作要遍历每一个包含 $k$ 的区间，是 $O(\log n)$ 的，而插入线段操作首先要把这个线段分给若干区间（保证线段一定覆盖区间），这是一个类似区间查询的操作，要 $O(\log n)$  ，而对于每个区间，我们会递归跟新它的儿子，又要一个 $O(\log n)$ 所以插入操作的总时间是 $O(\log^2 n)$ 的</p><p>注意上面的 $n$ 指的是值域</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P4097">板子？</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, P1 = <span class="number">39989</span>, P2 = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-8</span>, INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> lastans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB k, b, l, r;</span><br><span class="line">    <span class="function">DB <span class="title">clac</span><span class="params">(DB x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; r || x &lt; l)</span><br><span class="line">            <span class="keyword">return</span> -INF;</span><br><span class="line">        <span class="keyword">return</span> x * k + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; l[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> l, r, id;</span><br><span class="line">    &#125; tr[P1 &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) tr[(x)].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) tr[(x)].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> id(x) tr[(x)].id</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> Mid (tr[u].l + tr[u].r &gt;&gt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tr[u] = &#123;l, r, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        DB fa = l[a].<span class="built_in">clac</span>(x), fb = l[b].<span class="built_in">clac</span>(x);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">cmp</span>(fa, fb) ? fa &lt; fb : a &gt; b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= <span class="built_in">l</span>(u) &amp;&amp; r &gt;= <span class="built_in">r</span>(u))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//从l18q抄来的优秀打法</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, mid))</span><br><span class="line">                <span class="built_in">swap</span>(<span class="built_in">id</span>(u), d);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, <span class="built_in">l</span>(u)))</span><br><span class="line">                <span class="built_in">update</span>(lc, <span class="built_in">l</span>(u), <span class="built_in">r</span>(u), d);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">judge</span>(<span class="built_in">id</span>(u), d, <span class="built_in">r</span>(u)))</span><br><span class="line">                <span class="built_in">update</span>(rc, <span class="built_in">l</span>(u), <span class="built_in">r</span>(u), d);</span><br><span class="line">            <span class="keyword">return</span> ; <span class="comment">//记得！</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">            <span class="built_in">update</span>(lc, l, r, d);</span><br><span class="line">        <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">            <span class="built_in">update</span>(rc, l, r, d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">l</span>(u) == <span class="built_in">r</span>(u))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">id</span>(u);</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="keyword">int</span> res = (x &lt;= mid ? <span class="built_in">ask</span>(lc, x) : <span class="built_in">ask</span>(rc, x));</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">judge</span>(res, <span class="built_in">id</span>(u), x))</span><br><span class="line">            res = <span class="built_in">id</span>(u);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; lt;</span><br><span class="line"><span class="function">Line <span class="title">get_line</span><span class="params">(DB a, DB b, DB c, DB d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">cmp</span>(a, c))</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="number">0</span>, <span class="built_in">max</span>(b, d), a, a&#125;;</span><br><span class="line">    DB _k = (d - b) / (c - a);</span><br><span class="line">    DB _b = b - (a * _k);</span><br><span class="line">    <span class="keyword">return</span> &#123;_k, _b, a, c&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_real</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = (x + lastans - <span class="number">1</span>) % P + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, op, a, b, c, d, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    lt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">40000</span>);</span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span> (!op)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="built_in">get_real</span>(a, P1);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lastans = lt.<span class="built_in">ask</span>(<span class="number">1</span>, a));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">            <span class="built_in">get_real</span>(a, P1), <span class="built_in">get_real</span>(b, P2), <span class="built_in">get_real</span>(c, P1), <span class="built_in">get_real</span>(d, P2);</span><br><span class="line">            <span class="keyword">if</span> (a &gt; c)</span><br><span class="line">                <span class="built_in">swap</span>(a, c), <span class="built_in">swap</span>(b, d);</span><br><span class="line">            l[++cnt] = <span class="built_in">get_line</span>(a, b, c, d);</span><br><span class="line">            lt.<span class="built_in">update</span>(<span class="number">1</span>, a, c, cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三角剖分</title>
      <link href="/2022/01/21/%E4%B8%89%E8%A7%92%E5%89%96%E5%88%86/"/>
      <url>/2022/01/21/%E4%B8%89%E8%A7%92%E5%89%96%E5%88%86/</url>
      
        <content type="html"><![CDATA[<p> 恨死几何了</p><span id="more"></span><h1 id="三角剖分"><a href="#三角剖分" class="headerlink" title="三角剖分"></a>三角剖分</h1><h2 id="三角形"><a href="#三角形" class="headerlink" title="三角形"></a>三角形</h2><p>先思考一个简单问题：</p><p>如何求一个三角形和一个以三角形一顶点位圆心的圆的有向面积交（求并就是面积和减交）？</p><p><img src="https://s2.loli.net/2022/01/21/svTklGA3KHJRo12.png" alt="三角形"></p><p>明显，对于 $\triangle ABC$ 和 $\odot C$ ，分类讨论：</p><ol><li> $A, B, C$ 都在圆内，面积就是 $\triangle ABC$ 面积</li><li>有一个点在圆外（设为 $A$ ），设 $AB$ 交圆于点 $D$ ， $AC$ 交圆于 $E$ ，面积就是扇形 $CDE$ +三角形 $CBD$ </li><li>两个点在圆外且 $AB$ 于 $\odot C$ 相离，设 $BC$ 交圆于点 $D$ ， $AC$ 交圆于 $E$ ，面积就是扇形 $CDE$ </li><li>两个点在圆外且 $AB$ 于 $\odot C$ 相割，设 $BC$ 交圆于点 $D$ ， $AC$ 交圆于 $E$ ， $AB$ 交圆于 $F, G$ ，面积就是扇形 $CDG$ +扇形 $CEF$ +三角形 $CFG$ </li></ol><p>分类讨论即可</p><h2 id="多边形"><a href="#多边形" class="headerlink" title="多边形"></a>多边形</h2><p>现在，如何求多边形和三角形面积交？</p><p>当然是把多边形剖成一个个三角形分别求交了！</p><p><a href="https://www.acwing.com/problem/content/3037/">望远镜</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-8</span>, PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> - (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> * (Point t) <span class="comment">//叉积</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.y - y * t.x;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> &amp; (Point t) <span class="comment">//点积</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.x + y * t.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (DB t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t, y * t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> / (DB t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x / t, y / t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; r;</span><br><span class="line">DB R;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">mo</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(x &amp; x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">dist</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mo</span>(y - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">norm</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x / <span class="built_in">mo</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">rot</span><span class="params">(Point x, DB th)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x * <span class="built_in">cos</span>(th) + x.y * <span class="built_in">sin</span>(th), -x.x * <span class="built_in">sin</span>(th) + x.y * <span class="built_in">cos</span>(th)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB t = (v * (p - q)) / (u * v);</span><br><span class="line">    <span class="keyword">return</span> p + u * t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_on</span><span class="params">(Point p, Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">cmp</span>((p - x) * (p - y), <span class="number">0</span>) &amp;&amp; <span class="built_in">cmp</span>((p - x) &amp; (p - y), <span class="number">0</span>) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cir_jiao_lin</span><span class="params">(Point x, Point y, Point &amp;px, Point &amp;py)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point e = <span class="built_in">jiao</span>(x, y - x, r, <span class="built_in">rot</span>(y - x, PI / <span class="number">2</span>));</span><br><span class="line">    DB mind = <span class="built_in">dist</span>(r, e);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">is_on</span>(e, x, y))</span><br><span class="line">        mind = <span class="built_in">min</span>(<span class="built_in">dist</span>(r, x), <span class="built_in">dist</span>(r, y));</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(R, mind) &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> mind;</span><br><span class="line">    DB len = <span class="built_in">sqrt</span>(R * R - <span class="built_in">dist</span>(r, e) * <span class="built_in">dist</span>(r, e));</span><br><span class="line">    px = e + <span class="built_in">norm</span>(x - y) * len;</span><br><span class="line">    py = e + <span class="built_in">norm</span>(y - x) * len;</span><br><span class="line">    <span class="keyword">return</span> mind;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">sector</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB angle = <span class="built_in">acos</span>((x &amp; y) / <span class="built_in">mo</span>(x) / <span class="built_in">mo</span>(y));</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(x * y, <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">        angle = -angle;</span><br><span class="line">    <span class="keyword">return</span> R * R * angle / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cir_tri_area</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB dx = <span class="built_in">dist</span>(r, x), dy = <span class="built_in">dist</span>(r, y);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(R, dx) &gt;= <span class="number">0</span> &amp;&amp; <span class="built_in">cmp</span>(R, dy) &gt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> x * y / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">cmp</span>(x * y, <span class="number">0</span>)) <span class="comment">//三点共线</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Point px, py;</span><br><span class="line">    DB mind = <span class="built_in">cir_jiao_lin</span>(x, y, px, py);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(R, mind) &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sector</span>(x, y);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(R, dx) &gt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> x * py / <span class="number">2</span> + <span class="built_in">sector</span>(py, y);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(R, dy) &gt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> px * y / <span class="number">2</span> + <span class="built_in">sector</span>(x, px);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sector</span>(x, px) + px * py / <span class="number">2</span> + <span class="built_in">sector</span>(py, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">work</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        res += <span class="built_in">cir_tri_area</span>(x[i], x[(i + <span class="number">1</span>) % len]);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    STC Point q[N];</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%lf %d&quot;</span>, &amp;R, &amp;n) != <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, <span class="built_in">work</span>(q, n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 三角剖分 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>旋转卡壳</title>
      <link href="/2022/01/21/%E6%97%8B%E8%BD%AC%E5%8D%A1%E5%A3%B3/"/>
      <url>/2022/01/21/%E6%97%8B%E8%BD%AC%E5%8D%A1%E5%A3%B3/</url>
      
        <content type="html"><![CDATA[<p> 四个多音字，怎么读啊~</p><span id="more"></span><h1 id="旋转卡壳"><a href="#旋转卡壳" class="headerlink" title="旋转卡壳"></a>旋转卡壳</h1><h2 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h2><p>平面上有 $n$ 个点，求平面<strong>最远点对</strong>（即<strong>凸包直径</strong>）</p><p>由该问题也可以得到一个性质：平面最远的点对一定是凸包上的两点</p><p>简证（口胡）：设最远点对有一点 $A$ 不在凸包上，另一点 $B$ 任意，设射线 $BA$ 交凸包于 $C$ ，设 $C$ 在凸包的边 $DE$ 上，有 $AB &lt; CB &lt; DB$ </p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>有了如上性质，我们就只需要考虑凸包上的点</p><p>先取两条平行于 $x$ 轴的直线，让它们“卡”住这个凸包，然后逆时针旋转，时刻保证两线平行，整个过程中两直线距离的最大值就是凸包直径</p><p><img src="https://s2.loli.net/2022/01/21/KJ71iOymbDFwehP.png" alt="卡"></p><p>正确性显然（然鹅图里那个图形好像不是<strong>凸</strong>包）</p><p>但角度是无穷的，我们不可能真的让两条线旋转一周</p><p>考虑用点的距离替代两线之间的距离，我们称把两线“卡”住的两个点称为<strong>对踵点</strong>（即图中绿色的点），明显，对踵点成对出现，且距离最大的一对对踵点之间的距离就是凸包直径</p><p>思考对踵点的改变条件</p><p><img src="https://s2.loli.net/2022/01/21/YJ2crbSzCFjtL3e.png" alt="对踵点"></p><p>如图，当黑线旋转至红线位置时，绿色对踵点变成橙色</p><p>而红线位置就是<strong>凸包的边</strong>！换句话说，只要对凸包每条边，求出离这条边最远的点即可</p><p>那么如何求呢？我们逆时针扫描每条边，明显要求的最远点也将逆时针旋转，可以用一个双指针，面积法判定两个点到一条边的距离，时间是 $O(n)$ 的</p><p>加上求凸包的时间，共是 $O(n \log n)$ 的</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/record/67434458">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> * (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.y - y * t.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> stk[N];</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (y - x) * (z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">dist</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point t = x - y;</span><br><span class="line">    <span class="keyword">return</span> t.x * t.x + t.y * t.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">convex</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(x, x + len);</span><br><span class="line">    STC <span class="keyword">bool</span> used[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]) &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]) &lt; <span class="number">0</span>)</span><br><span class="line">                used[stk[--top]] = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                --top;</span><br><span class="line">        stk[top++] = i;</span><br><span class="line">        used[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    used[<span class="number">0</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]) &lt; <span class="number">0</span>)</span><br><span class="line">            --top;</span><br><span class="line">        stk[top++] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    --top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">rot_cal</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">convex</span>(x, len);</span><br><span class="line">    <span class="keyword">if</span> (top &lt;= <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dist</span>(x[<span class="number">0</span>], x[len - <span class="number">1</span>]);</span><br><span class="line">    DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">2</span>; i &lt; top; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> d = x[stk[i]], e = x[stk[i + <span class="number">1</span>]];</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">area</span>(d, e, x[stk[j]]) &lt; <span class="built_in">area</span>(d, e, x[stk[j + <span class="number">1</span>]]))</span><br><span class="line">            j = (j + <span class="number">1</span>) % top;</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">max</span>(<span class="built_in">dist</span>(d, x[stk[j]]), <span class="built_in">dist</span>(e, x[stk[j]])));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    Point q[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.0lf\n&quot;</span>, <span class="built_in">rot_cal</span>(q, n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.acwing.com/problem/content/2144/">最小矩阵覆盖</a></p><p>思路：</p><p>凭直觉得最小的矩阵一定有一条边与凸包共线（证明太长了，可以自己百度）</p><p>所以用旋转卡壳，对于每条边，求出最远点，另外两边“卡”一下即可（感觉自己说了个寂寞）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-12</span>, INF = <span class="number">1e20</span>, PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (Point t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> * (Point t) <span class="comment">//叉积</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.y - y * t.x;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> &amp; (Point t) <span class="comment">//点积</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.x + y * t.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (DB t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t, y * t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> / (DB t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x / t, y / t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ans[N];</span><br><span class="line">DB as = INF;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> stk[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (y - x) * (z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">mo</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(x &amp; x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">proj</span><span class="params">(Point x, Point y, Point z)</span> <span class="comment">//求xy在xz的投影</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((y - x) &amp; (z - x)) / <span class="built_in">mo</span>(y - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">norm</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x / <span class="built_in">mo</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">rot</span><span class="params">(Point x, DB th)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x * <span class="built_in">cos</span>(th) + x.y * <span class="built_in">sin</span>(th), -x.x * <span class="built_in">sin</span>(th) + x.y * <span class="built_in">cos</span>(th)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">convex</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(x, x + len);</span><br><span class="line">    STC <span class="keyword">bool</span> used[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">cmp</span>(<span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]), <span class="number">0</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">cmp</span>(<span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]), <span class="number">0</span>) &gt; <span class="number">0</span>)</span><br><span class="line">                used[stk[--top]] = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                --top;</span><br><span class="line">        stk[top++] = i;</span><br><span class="line">        used[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    used[<span class="number">0</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">cmp</span>(<span class="built_in">area</span>(x[stk[top - <span class="number">2</span>]], x[stk[top - <span class="number">1</span>]], x[i]), <span class="number">0</span>) &gt; <span class="number">0</span>)</span><br><span class="line">            --top;</span><br><span class="line">        stk[top++] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverse</span>(stk, stk + top);</span><br><span class="line">    --top;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rot_cal</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">convex</span>(x, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, a = <span class="number">2</span>, b = <span class="number">1</span>, c = <span class="number">2</span>; i &lt; top; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> d = x[stk[i]], e = x[stk[i + <span class="number">1</span>]];</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cmp</span>(<span class="built_in">area</span>(d, e, x[stk[a]]), <span class="built_in">area</span>(d, e, x[stk[a + <span class="number">1</span>]])) &lt; <span class="number">0</span>)</span><br><span class="line">            a = (a + <span class="number">1</span>) % top;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cmp</span>(<span class="built_in">proj</span>(d, e, x[stk[b]]), <span class="built_in">proj</span>(d, e, x[stk[b + <span class="number">1</span>]])) &lt; <span class="number">0</span>)</span><br><span class="line">            b = (b + <span class="number">1</span>) % top;</span><br><span class="line">        <span class="keyword">if</span> (!i)</span><br><span class="line">            c = a;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cmp</span>(<span class="built_in">proj</span>(d, e, x[stk[c]]), <span class="built_in">proj</span>(d, e, x[stk[c + <span class="number">1</span>]])) &gt; <span class="number">0</span>)</span><br><span class="line">            c = (c + <span class="number">1</span>) % top;</span><br><span class="line">        <span class="keyword">auto</span> ta = x[stk[a]], tb = x[stk[b]], tc = x[stk[c]];</span><br><span class="line">        DB h = <span class="built_in">area</span>(d, e, ta) / <span class="built_in">mo</span>(e - d);</span><br><span class="line">        DB w = ((tb - tc) &amp; (e - d)) / <span class="built_in">mo</span>(e - d);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(h * w, as) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            as = w * h;</span><br><span class="line">            ans[<span class="number">0</span>] = d + <span class="built_in">norm</span>(e - d) * <span class="built_in">proj</span>(d, e, tb);</span><br><span class="line">            ans[<span class="number">3</span>] = d + <span class="built_in">norm</span>(e - d) * <span class="built_in">proj</span>(d, e, tc);</span><br><span class="line">            <span class="keyword">auto</span> u = <span class="built_in">norm</span>(<span class="built_in">rot</span>(e - d, -PI / <span class="number">2</span>));</span><br><span class="line">            ans[<span class="number">1</span>] = ans[<span class="number">0</span>] + u * h;</span><br><span class="line">            ans[<span class="number">2</span>] = ans[<span class="number">3</span>] + u * h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    Point q[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">    <span class="built_in">rot_cal</span>(q, n);</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(ans[i].y, ans[k].y) &lt; <span class="number">0</span> || !<span class="built_in">cmp</span>(ans[i].y, ans[k].y) &amp;&amp; <span class="built_in">cmp</span>(ans[i].x, ans[k].x) &lt; <span class="number">0</span>)</span><br><span class="line">            k = i;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.5lf\n&quot;</span>, as);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i, ++k)</span><br><span class="line">    &#123;</span><br><span class="line">        DB x = ans[k % <span class="number">4</span>].x, y = ans[k % <span class="number">4</span>].y;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">cmp</span>(x, <span class="number">0</span>)) <span class="comment">//c++的四舍五入会把-0.000001改成-0.00000</span></span><br><span class="line">            x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">cmp</span>(y, <span class="number">0</span>))</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.5lf %.5lf\n&quot;</span>, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1513C Add One</title>
      <link href="/2022/01/21/CF1513C-Add-One/"/>
      <url>/2022/01/21/CF1513C-Add-One/</url>
      
        <content type="html"><![CDATA[<p> 一道题写了有三天……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/CF1513C">Add One</a></p><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>定义一次“操作”为：将一个数的每一位的数值加 $1$ ，进位了就多占一位，如 $1912$ 操作一次后就是 $21023$ </p><p> $T(T \le 2 \times 10^5)$ 组数据，每次给定 $n (1 \le n \le 10^9), m (1 \le m \le 2 \times 10^5)$ ，求 $n$ 操作 $m$ 次以后的<strong>长度</strong></p><h2 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h2><p>考虑将 $n$ 的每一位分开计算</p><p>对于当前数 $x(x \in [1, 9])$ ，先用 $9 - x$ 次操作将其统一化成 $9$ </p><p>问题化为对于数 $9$ ，进行 $m’$ 次操作后数字的位数 </p><p>打表找规律，打表程序如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">list&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it = a.<span class="built_in">begin</span>(); it != a.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    &#123;</span><br><span class="line">        *it += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (*it == <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            *it = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">auto</span> t = it;</span><br><span class="line">            a.<span class="built_in">insert</span>(++t, <span class="number">1</span>);</span><br><span class="line">            ++it;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;t.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout);</span><br><span class="line">    a.<span class="built_in">push_back</span>(<span class="number">9</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">work</span>();</span><br><span class="line">        <span class="keyword">if</span> (a.<span class="built_in">size</span>() &gt; j)</span><br><span class="line">        &#123;</span><br><span class="line">            j = a.<span class="built_in">size</span>();</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&quot; - &quot;</span> &lt;&lt; j &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>差点把电脑挂了都没找到规律，估计是dp了</p><p>仔细一想，可以化成 $9$ 也就是可以化成 $10$ 嘛，然后每次进位时也是 $10$ </p><p><del>通过题解</del>发现dp方程如下：</p><p>设 <code>f[i][j]</code> 表示数 $i$ 加了 $j$ 次以后的方案数<br>$$<br>\begin{aligned}<br>f[i][j] =<br>\begin{cases}<br>1 &amp; i + j &lt; 10 \\<br>f[0][i + j - 10] + f[1][i + j - 10] &amp; i + j &gt; 10<br>\end{cases}<br>\end{aligned}<br>$$<br>两个细节：</p><ol><li>开 <code>long long</code> </li><li>先枚举 $j$ 再枚举 $i$ ，否则转移时 <code>f[0][i + j - 10]</code> 和 <code>f[1][i + j - 10]</code> 可能没初始化</li></ol><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">2e5</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">LL f[<span class="number">10</span>][M];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; ++j)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i][j] = (i + j &lt; <span class="number">10</span> ? <span class="number">1</span> : f[<span class="number">0</span>][i + j - <span class="number">10</span>] + f[<span class="number">1</span>][i + j - <span class="number">10</span>]) % P;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">int</span> T, n, m;</span><br><span class="line">    LL ans;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = (ans + f[n % <span class="number">10</span>][m]) % P;</span><br><span class="line">            n /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我dp还是太弱了</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三维凸包</title>
      <link href="/2022/01/20/%E4%B8%89%E7%BB%B4%E5%87%B8%E5%8C%85/"/>
      <url>/2022/01/20/%E4%B8%89%E7%BB%B4%E5%87%B8%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p> 向量乱杀</p><span id="more"></span><h1 id="三维凸包"><a href="#三维凸包" class="headerlink" title="三维凸包"></a>三维凸包</h1><p>不多说，看<a href="https://www.luogu.com.cn/problem/P4724">题</a>：</p><p>给出空间中 $n$ 个点，求凸包最小表面积</p><h2 id="增量法"><a href="#增量法" class="headerlink" title="增量法"></a>增量法</h2><p>增量法可以解决很多问题，它每次把一个问题化为同类型的、规模更小的问题，可以表示为 $T(n) = T(n - 1) + g(n)$ </p><p>考虑三维凸包，它一定是由<strong>一个个平面</strong>组成，和二维一样，我们先确定一个平面，然后<strong>不断地往里加点</strong>，每次加一个点，<strong>更新一下凸包</strong>，直到所有点都加进来了，整个的凸包也就求完了，这就是增量法的思想</p><p>那么问题是，如何更新凸包才能使得加入一个点后，更新为一个新的多面体，是 $i+1$ 个点的凸包</p><p><img src="https://s2.loli.net/2022/01/20/3ZzHIGgJCMRX1SN.png" alt="三维凸包"></p><p>如上图：每当新加一个点 $p_r$ 时，将这个点想成一个光源（太阳），向四周散发光线（如图二），照到原先的凸多面体 $CH$ 上，所有能被照到的平面是要删去的面，所有照不到的面是要留下来的</p><p>然后看所有边，每条边都在两个平面上（两平面的交线），当光线照到他所在平面时，代表该边被照到一次，然后我们找出所有被照到一次的边，说明他们是能照到和不能照到的分界线，所以我们新加一个该边和新加入的 $p_r$ 点所构成的一个平面（如图三），就是新凸多面体</p><p>还有一些细节：</p><ol><li>存每个平面时都<strong>只存三角形平面</strong>，即存三个顶点，但若存在 $n$ 边形的平面，可以划分成 $n - 2$ 个三角形</li><li>如何<strong>判断一个点能照到的平面</strong>呢？可以判断这个点在平面上方还是下方（通过和法向量的点积判断，具体可以看<a href="https://blog.csdn.net/qq_45735851/article/details/114382634">这个</a>），在上面说明能照到，在下面说明照不到，所以这里的平面是有方向的，因此我们存平面时一定要严格按照一个方向存三个点，这里统一规定逆时针存</li><li>如何<strong>判断每条边被照到了几次</strong>？我们加个 <code>bool</code> 二维数组， <code>g[a][b]</code> 为 $1$ 的话说明 $a$ 到 $b$ 的边被照到一次，所以当 <code>g[a][b]</code> 为 $1$ ， <code>g[b][a]</code> 为 $0$ 时说明 $ab$ 这条边只被照到了一次。（因为都是逆时针存点，所以这个面是 $ab$ 边时，邻面就是 $ba$ 边）</li><li>如何解决多点共面的情况？给每个点都加一个微小扰动，就是让他的坐标发生一个很细微很细微的变化，使得不存在四点共面的情况（存在概率极小），然后任意三个点就可以构成一个唯一平面了</li></ol><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P4724">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> URD uniform_real_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB PI = <span class="built_in">acos</span>(<span class="number">-1</span>), eps = <span class="number">1e-12</span>;</span><br><span class="line">DRG e&#123;<span class="number">20051221</span>&#125;;</span><br><span class="line">URD&lt;DB&gt; u&#123;<span class="number">-0.5</span>, <span class="number">0.5</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y, z;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">shake</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        x += <span class="built_in">u</span>(e) * eps, y += <span class="built_in">u</span>(e) * eps, z += <span class="built_in">u</span>(e) * eps;</span><br><span class="line">    &#125; </span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y, z - t.z&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> &amp; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.x + y * t.y + z * t.z;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;y * t.z - t.y * z, z * t.x - x * t.z, x * t.y - y * t.x&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">DB <span class="title">len</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sqrt</span>(x * x + y * y + z * z);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Plane</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point v[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">int</span> id[<span class="number">3</span>];</span><br><span class="line">    <span class="function">Point <span class="title">norm</span><span class="params">()</span> <span class="comment">//法向量</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (v[<span class="number">1</span>] - v[<span class="number">0</span>]) * (v[<span class="number">2</span>] - v[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">DB <span class="title">area</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">norm</span>().<span class="built_in">len</span>() / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">above</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((x - v[<span class="number">0</span>]) &amp; <span class="built_in">norm</span>()) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">convex_3d</span><span class="params">(Point x[], <span class="keyword">int</span> len, Plane p[], <span class="keyword">int</span> &amp;lp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">bool</span> g[N][N];</span><br><span class="line">    STC Plane np[N];</span><br><span class="line">    p[lp++] = &#123;x[<span class="number">0</span>], x[<span class="number">1</span>], x[<span class="number">2</span>], <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line">    p[lp++] = &#123;x[<span class="number">2</span>], x[<span class="number">1</span>], x[<span class="number">0</span>], <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lp; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> t = p[j].<span class="built_in">above</span>(x[i]);</span><br><span class="line">            <span class="keyword">if</span> (!t)</span><br><span class="line">                np[cnt++] = p[j];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; ++k)</span><br><span class="line">                g[p[j].id[k]][p[j].id[(k + <span class="number">1</span>) % <span class="number">3</span>]] = t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lp; ++j)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; ++k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> a = p[j].id[k], b = p[j].id[(k + <span class="number">1</span>) % <span class="number">3</span>];</span><br><span class="line">                <span class="keyword">if</span> (g[a][b] &amp;&amp; !g[b][a])</span><br><span class="line">                    np[cnt++] = &#123;x[a], x[b], x[i], a, b, i&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        lp = cnt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lp; ++j)</span><br><span class="line">            p[j] = np[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    STC Point q[N];</span><br><span class="line">    STC Plane p[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y, &amp;q[i].z), q[i].<span class="built_in">shake</span>();</span><br><span class="line">    <span class="built_in">convex_3d</span>(q, n, p, m);</span><br><span class="line">    DB ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        ans += p[i].<span class="built_in">area</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 凸包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2022/1/20总结</title>
      <link href="/2022/01/20/test2022-1-20%E6%80%BB%E7%BB%93/"/>
      <url>/2022/01/20/test2022-1-20%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="d40353bc959d79fca3681d43455140ebcc52892fe31ce0a675c621b480220857">91be494885fcda4e29aacd3585d6ad0f1298ea79e517d6387ff2e6490489dfd4049a2cf53094048ce8831299b510f846e53b222139657a8464bdd284d5262d1c7d15051737ed3de2cd5eb551757b90cb065d4441b7d75f149dcc5fbc32234633f04320d73ab01ed56f5fa1fa7968e66aa5efe95a0966885c2aa79d64d9357ca292e114e4de809b76b7a7c09178d98183513cebe767412b6bc9c1266b5cc3087b995bb8fc24e6eed3380324ff5ce1a49bdb3e2db1a7d1568941a6ddbaeaf9eafa8923e01a2e8a7fd4cb361a98ab1f54ccc0b5cf095a7934e5bd5392b7ce041b1ab24707c803d817d5bd87f1fef95b46f2c376d7381718d38bc1f83678ee0713b56330a313afe557cd4c5a90d7d159af21e9fb231f3b086d352677423e171a24be5fcb86173c74e24efa943b58b9789401e85f79b19e29ecfe6022ab8142e38ded8b8bac0bf71187bf1857677d93a0003bfac1c511beed8901138a98bf0e4e100fcde57640633d5df9f94762d054a32e8868ff48b497397b1989e321440ba70f97ce35c4bfe06447c79aeccaae2f694632afb1c0cd1f6ca77219bf73c0751f096c9f6ba9c7ad0d6ad761701d4c32822c920485b72d5dadcfec54a32eb2f1a1509379c068c64e11fd12189cbfd4e87feb7e51b203c34800a33f7e8e00454969f1e4cf1458d6c382d01e1e4ad3b1695c0e906440ea1d1df15e1402f1c28148324fca22cfd640f3307d100fe3d7501d02feeca5c1cc3697c56f825699289789103a66afd1179705780c077f924a7fd08887306734510dc6533712213b9269203adc88392c721d6fe35ecc64674a0b9c4752bc7f319377590446c57e2972b3286e17ea4e0831d327c0c65a36c7338133f4f6f05db3dbc9715baf2bcd140dd8354d95c75fd68592343bb47929aee94125bbd2c92fcb68c388ef360e341dd6e9ed0499034a7a283965eb8230b9ce66cd4154ca3cd1ffec0dbca2734e246ad66fa674db6be6ddb49fdc76db2a0778969f54053398e6be0b8477123cf1c22b048130cf18ec8c63d09fbe397d72df41fbfd9b65e64bde570d1bef300aa499d1fd909ecf26a487efdfdc87d5eee203043cc9f163a215b5e1f5f5171c792be413ebe3f03abeeee15ca12c6b0499d9d8bf8056bc53fddfff3f1b5f141c03e07e86897218bd755700a77f87dc64d198ce6c15ca7ccfe72d5d13a2653c151e7167c6f1843226c4d4f384769cfd062e30e74b405fe4023f681fc71ca76dd10868cb2aef91fa7bcee3141f7657431e77b45d13a2e86ac033fdafc0330561b346fadb3012b2e62e767ceded79431075e3d98d1ff99a7796f5dfe43c4f76efb09a899066264688c6a78fd5d9ed0f6827fecdb847fb5feb4c9621e66d7cac306a025ad51c6bf2149748e0e7c024ad753751ad4c11f30cb478be17443eacdff1f99684757cea66a5c6f2da7fb3c767a6c3130f0abb618c74d3e17066acc21e1dc3f459a18518f1791678ae6665073964ccaefc90c717d72507de3657d1541256d5af9658338ca404e21bc39d50b56344339fc7236a1b1ad29461a26cdabdbd1c89e9da3486b34b9468b41bc45f98137c10f001b20a6292b12bc8ce5a0d59ffe9f85f5b0f264109f0672016afe388ab8dd828f8153ea2a02762395a786e025381acd82d6c8e50ab479ec649dcecd89ae3d3ce35a8aab413ba2d79cff4072ecf5142a5a7340a5f957dc87794a6f289065d72b901daef28c4ebe4ebb2eaccf74927e82389cc8615fdd39820dba3edec907c96e65a5ab2514fc5dcd1618d3a22a29378d4374f580b2047d78b33ef9a2d3a135cd7bce3e7efac6b47008b300896f0185973367181e3168707f7ec200eada8ed99d4f78e2cd8843997d52a4f25a3cb2ab2448d8321f6e9fe1b8429ad99ae255c2fc841df3c93d846c3b8fedd401b148b6ec0a99149ebfe8a73616573a83484895bd5f7d11c29e7145f55e8fabdddde210ed755f4648ca09eb6fb2a110d64e57c15628be203b8b8c84bb4880d3bc85b8fe6f0dd841afd0d6d205f72dc9dd6c0d6a10923c67883087047c95d7552f19304c4e197c012d4bd5d55eeb97f54b6e1d8325a4291645fb29754281dfe350d927cf0e4b45617a66b24befc33d8a40c0500b66b91ef729bdd9c22b6e18295f54d86249a08a3c8cefae5a78311d495f5a95fe46d0bf112a5157699270faf7f64dc58237f456e03c5d32a9ab864a27c34ff44cdaaf78de64941252c1e257a3b61eb439706d80d7af6d6f735f0c6854c10eaa565c3e0853fa4062536c698fa231f2ddb56eb1af8db03c8055b148b8f4050665982e580899dc49be0e816324ae9a07d81a7ce3e20ea1e326689147cbca87726992fa13211fcbf92a99eeda4980057738291f0a36039c6e3b8fb72999c65ff2d2f1b61494ab76b8137b5a4e0309b4fa3babb917478b1087932e5dc05ffbc4d2761113dd23663c0fac418f051b344635a098896e757d4a37d84bd6b5a7b5ce140cb81eb3b81689c9cbac7c6409e827d9d0fb16c10fc28cb78a56a984b64db717eb10516d26338e25cdd463392f7ec77423a29d810c0e0570ab2e5b4580b013284529ac81b5a796b2aaf4658f20406b06732d50812a2a4ec097da528865d09cb8dcbedc4be8dfa06ef5ddb0cd20b64306b2a1b863105fca43fda2d97daa853dca024ebbfd91013135c623b2b391afb7fcdcc92367ba01cac5ac9e0c89cf3b0e20f08b73b6aea1126281385d07ebc41ea41f6fe3e1c0e722274dc8fae4ba85a8a61542a91d96f4f0592f1eee309436b2b5af0697ec5c082afbb8d218dff6262ed2a4d722d65be76673ffbb58741ce4cec7434c35b179f46f24c844573271a33db8559c1884ac79bd87a3df3c8440c3014114cb5273ed10d1dd30ca6c5303ff7688e85737a96ba046cb3eba215cf7823ce51958c04693dcfaa882d7924e189896b7bdd9e944770f541c96e6ab8f98767118a3056478652b8b567aec955e8e99ecef4ae7fcf00d2900632ccb444c77cf5cb014a32e505ce4d81f8ee14690c933085b251e9cf56be7f8bc14a7167bd658c268a6bbf833774e2bb4652c9a0605199aa7144985503b00cad2bd8da254e0fd010ac18513c255891a291c4065dd0288581f2044d9837d7fa5771a976b3808156b64cb4d778adb960bcecc3e202e01e8b367918cfbea82592e8598e608f59a8d502f95e6eb8d812c5b3723b06b862131385c06b4c8afd5c905c9fc949a6388fe21e461fc563be199ac870daa20c060160e75ae104bb6f47c31503b2f9f4055dd61bbc89781169db7f4556ca0b616c4dc3e41cab54a7720de02108767f5885b44d333d7709516875ecd8fdc93db25ac73a55774be33966002de54960208e5014bd41ad0841fae087b2ce88505be4fe73c9755666807c44b457a4d9f609e8cc2ab54bdab977682210f863f2a616022e563aa8997dca38c6094255695b5a3269ba04f6e351a22dddca90213576ad6f8562bae0e8f9eddecdd2d1a751d9b92ffd6a283c23216a48459837947d343dc075066e7ad0897af0501cb1c403496ddf7c86d97cddf5c89cd3e20761e780892037d967e1c3c4ef996eddcaf49a70584600de2553090ed83b2b419c6c0548a864b7369c683ce3e3e51afc459a2cf18b52b7be5f932e3ba3cc5359d09179619f37f772d366a273a300a8c1a978c135504295db5e7764082cf8d5a98513482fc1f468f91baf4598d9fcd4e15299a7171947d0c32c81606abf391120f5c2c61313f9f50ded774dfda1bc59e1b50063e1f6108b384cfe7a08d02535ecdc218826cebc90b4f47ad0c679f2563a5fc26e2bb6a0d4cb728434c2dae73222a865fd842b6723cccf3792e2ab31af009a76b48fc845abbad6cd31931548d9bdeaec56e2d931f7dca038cbb990a69891c0a82bd77c11541456d41558ca542179af2d3508ac00d5509d4820c5fe779ca125e7cf966d6f98ef9c59ee523b8a0748220765ab05821abdf7682e3f1aca9039888f83a679dc473e3427ea6d077eb714d0910becf58bbd2b4532a28e4b749e000b17c11c60c45a7c81b8cf5b32210a1241ab2922c1a5e78c210f34362d305049b50d15eff597d56763161375427f7a3bc9b50651422125b47c040d1d741ad2e6b6f889655acb5e717d31dddfc564d8e85ca1ee50bdd65d691cf64882054bcecfb97455fd80e54a02e9e73b8fc32134a7ee9429b23eafa147592a222c5c4332256da77547cbf65eb2e9d23f26ad0da97a73b36e83bfc3869124b84043a2f0c804d96de703fac93fd52cf57edb2edaad2309fbf1646d094c2661d07a1d9fc4fe596550dde421f75cb8ef6a45c48a902c1bcd52c7d6fd3089515e1ac1d0d8404b3e991c44bc9008ed6e58944ac0741edd03ff2962aa01973738888c08f74ac8c14458fa6ba30ea15a8ce1316f26921a67ce84c7596982f58109dd904ba98327b437969eb960f62b4d961cdea20945c1ab9d391114f00021d446037d0a20f5ef8616832707ed235d85cded78fa0883f1e5205dd3db477459f68be130418173d5deb2bb65fd4fb821e98986193c1cdc41a97448caa53a95dfa29a9d533b0252c43bd4c4dc81446fe0e6f74c9f95a1ddcf15440f78172d38dc636dce80d912f45a099e678cdc96ea6c947e68e0fb25d42f179b96afb8a59daaf985e7919a3871e2057379c0d8e792565814c2da63e08eb67f1aba7bca3f34f51f40338398974032177d3981eb1d7e1302cb77a562915de3535a5ad942b660ad7607ef375f84d9cf53072333f7480c1a55f697cf17bb1f0c083fbf625a3b086a210a769b702ec156cd2a84b2077362ccab3a451b76c9f010c0b130fed0c2ea47a3ad7347e1f8e713c37ca642b61d91d758155f9aa354643ede842dbbe1f62e8ffcadf3affe7d72f87280f33e18f99873c95b36497fef5d6a1405398f6de52d9630ad2d3111d4c54d11a5f839869c661c96a64f311b3aaaebca1ae925ab05d850d50f135ae0f102ef4ed2fff091344115e3916ce7296a39dccf51f2a07cd0cce90cbda46ae32f8122e2f7ee89fdfdf59ae2bf1ec522a39d7197dc8c7a57eb587107881da4213cf4afe39767446cc90ce446bfbfa044c89fc55322d6952f7c2b0ef3659fbd71ab7ea7231cc1fd5967bc209ab62a9f9f34b81db8460e23dbd1e10ba018a4ba27526d59829fb744bc2e867a15e74886d9f2b313039f5fa471d4048e151b1c7418e923cf5604088b27938e04454bccea42b75a077f9f4f8ea4453790b2ffb0a68c1c5d1def9e1271a76f8bb80ce9563a83239ef1132fbe0910eeb6977cf4bf9dd1aec6b82ec4308750ab36f7b450dd08580d517325f166ddc1ce279ddea9e8b434aaa7a3aa913c35835816907a110fd5316a88fc5c628929f47c7551e23e69a306d1a7ed9aa6bc06780a3b46f12aa2291d0d8b531286fbb5dfcabba3a19fe5a8b860703d623c213c7e08aa08871bcba1a3b4ba6bbaa10e301cb6e819cb41e67e1ff0a485b2135ddeab5c3655da5c56d61b8ff8fd3ad4dfefb7a1e1dced6cdbbec6f5e475d02c6fa08f1a0a95a44780248fb25ba4f80b79450cdc327dbd92b2301b06ea69e690793ae6307a9efeccd12aa0ac78c92a5f090b57f90575e4af7fbc506e7cfd137b700cfa84871438b60279810814721c30fca93b6bd195087a555e1dde39cca667d50caa2e506ef60c047b25deb51bd593306f9ff9a29aa40534b84d29c223e25a421a28a4da4cd9c2cff35f9032980a0f362a2fcb01cdec91369a9d8c6a6533de117a9bbe861a58adcad18d5961b927df3277db36b7a0e75ff715f2431078d46f8366f8187fe612a9c15eb92b99a24e361fc3f3ee35f1589bfee957ecd2028e58d9dd31cee21ecd40604a8284f1a987e64cb620c6b45374f99e8d9db45ab777c59135781dea7000c75bf97e75e401348ec451d5b0a0762e1ec672d81799fe7f3808d1879b370d9705542694c49e24106c18fc9d0d4af9230693832134399d367a2dccf04841661c76530b4d06126806c4a1f844ec44f9e7e83e4ee275c6ced658a2f5653a6e94b55932f05c976dcc21754537db2cfc28b1b0f5af7ac054d0a5ed4c1cd149d25a0e3417cc5d765f658ab8b2a670789230d0d5ecffe637cb5b59b0f68cc4c8f3ba39694ff65f0d03808f7c27da3a8ca6cbbc999bec4525ba0cb3cb9a1775256855792cd0512cac23a6a0864fddb77299ee9e94f72f8a5a496b29ca3d58aebdeccb8c5fc7a27735b9650cdb03bc0871b76257ab9e318a5e31cb64cb6638fdcafd57310e69183dc64f05b08dc507eda6a14523d5c449335d4fd06fe16cb57c9a7ec358ca158e84b42a95f4f2c5860227d204055c1218222f3af707b08ce9670c8e97512d876e9854e36e33b6d6a4b1869894b3dee87f550d095c0ed799b31c917a252cab7e754131f14e699ca79979f706b9b5e149116a99a0b3a39fdd546e05ff1be9127246386117a08a283b3533ddeec5a24de39595582f9486908587770bcc63e1702a578baa467ab3f8fc08c5ebf28e19831899bda909425a00eefa89f989c452c70a1383f83cdc30c44fb414e36ef7ab7dc4633b48c4f546988bedf359525d97bec8f8ed5e3641abb7195092c0c4780dec31b3c065026001ff5a51849103deabbde5c1ba08a413a3c2d11e62b855c4e3be1332d815376be85eaace6305a1f8710042708031a981d546daee6f0191837d296c2c7889e0075f66f112233ebd81a2d6d2a79fb63a07e4b584ced42f0a54aa421e4bb6df9bcb491283174d616a9293653d0c045ad53d44f1a49ac12cbc4463201fa0db1db889b0647f6f2ea214e3fce7ca68d07b97a3cdcc63d9b6862cc39aca2fa77f39e71a5a66aebcfe644dfbc4a324f34de0901207c98221a8d6939d79339af7781668d0240fcb87b5af239ea7abbefb9e5ee19c14762aabd7929d2aa01a778a371eb1cb81fd51a3923e93a94e28258a20a495836de784f43b329cb89ad4f44d14e66c5f1decb72c2a0e1cdb69c701a967c083b1b8c825798eb217c7b6cf1321e02f746bef7b9014431052c609553a127065f1f5dffaaf243e85ad811242631a4c231682978a5b436d1a5b0537f5ea426ee5f04a86c654eb85e7c621fc674af5bf4dc0254e7e0a6e86c7dc70d9877f2165b37ce8574e1d395f6820c3e4d83ee48c9cb9259317c16aa3c0f85272b93dc1d7c1bf104df4949e064e37e4d29f31ae1a2e077f914091b9312dc6829a3a531bbfd4c03cb7fbbe53811d9f1876985fee2cd23723cfb30e54d6e171151c6e23c22469beca31b346d457322c9f46a421d39f94d4646614f38de8bead871f4d59234ea4f1577700353b532b72dcecb3f5fbdafb9900ea1ec51237a9f2d0b47dc0560105ccd07924ff0bf77a2f7b79ba572c012613cb9480c3e19c7f77a97d6428ccd4826648672b311828b50fae8459a64cdb7c46efd6580322755b140e0258dfdf45f71a78ccede3c0fb300a975f512ba57dcbc26297b53ac3034ad8b921de330a0498f55d086aeb823ae4af7311bdb1de0fa794068a1e655148f0b63dd489e8f481412fd950787ea5d16ed72af725c416670563f66e08606aadc96b1a8f8f7c7aaa4aec164ce33a73883b2b6fc20fa62a1ce36779c4e1a07dd1d62d94a68078913a3ebb98280ca6769f6db3a77aeaf536bac62b7814a8750b63f1f7dc2b7377469dafe6621b284bca737f0fd4a4ee3b6b2d8f7d5b86d81956edfcaca3eb525d4083cd554272fb5af70e37c834d1b3aaba5993b69bc7befae676dd7f6b2884821c40181156930113e3a50e48b949e8aa3de8e13e16e4faf2ee1d86622de7fc9822ce58f285ab722441c29980614f53298a4f3c7e84b417da68e952f9be2972683c6f6782f7b9bd2837f8662d01fc42980503c0740a4ad5eca392fe93af0c60fdf3afba63c38d1f06c612e074f56d96748b54b05b7abfae95e70d1c7342473d4dde46456ac9456bbf5bc50ce8f4e7f9e3e02ee6c32ff3d4dd13ff434062884fcd7aec29d27ddfc3e0041582588beb5cf6e9fa50e33ce1196b2d5ce8a72c5338358b2f92b5d567d128d41064b6bb85a2572f4b41fc7ac2999994ea88c08215e66696799be14cf7a41db297fc7743c8b7cd05cf8879c86ae6f7192c82ecbe3de1e587f68b91fd03138fc825a969d8f604ad8ff30379d55430357a47fa4a7af4ba5c403a6db8d402010fc5a5674f99c229aa94ef1eb586fce05ebb4120fdfb886648c04a1dfdae645f0b526a2a5b8562ce937c8ae4d03787e40cdb2498f9bfac77d9da9f89d5d5a94984071f8f35534952477fd1c1ee9d0c721fdc0cf479854bff9ae1ccd10e51eb02c335c40b413e6ab1db9fd3eed5ff003ee393319706a888713c76e2ddd7fee5c47ed808ed02d0e626b4c4917f3ea342231c3485bc6cf5436f56072bca3e031103285f03e08d685170ad2eaebcb2703b8bb08ba181f8f023fe8c89c4de13a09e3ded54209e75c7a0e832cd5751945440786d2bb3ff53a5841a89c9769fc8b4770bd8d8aba232856df2c1626bc22e47216c10151696f240492145be20023e5dcc41c8ad48c1c36cc936233bbd888859d70eb57352ec5f205795235d925db077d7e92fe5c9d37f59aa91ee35cadc1fa9a4c9eeacbb968948c7c0e213ffad157d8ea795ddb513770933ff9ade09873214bab01906726f928d0bc0ec47fed00b14998d2568c92f1121836de778cec17ddefc6d63458a65f787d32d986d7a71aaebf809cc8854d3ac4eaafc452a01480046553fbde81e8923e5fa221c9af6f7ca48a76754ca0ffa6c34488443717e98a572fedfd80e4e345fe5688138879d3e3547664b28df58d46f3547a086516b6ea9b8a1bedc72be7b9485f89dc99b6674e7bba6bf90b1139c605be07a26470ab5609c43c0705c56757cf942a3b124ebd7273850641da178b3dac2a795e55e5882feebaaa203b73d3fe1b72a6bc457e274fb61740ba1d0b1494a7b7a988461ec07b82a7f187b7355340c49e62938910ca717e4ad0bb8bc2ff2a8daad99b06447b9d87f7902a41074898c80e95afbcff92c99dbcb78edf065fab6dde4eb8f0be5b2dfc87e71abbb92850720285f1c3b83e66bb01d8061c481d31822737094b17d9e9500c32e598251c988816677f1d980a36df61e84b3014d93ad2962921283fb7dfb965e748d0e0f0c5e784efb284ad6e97e1256f16a6f590eef5a7fa6d580a3184ee3151c349dd6ff024e5535180405d6782aa1e98aa00f58752f443f691586cbd19333a5a470d3141b7f36fb1b7034b7e30aa070c186392a3c33ad80b3f0accaa14bf0408a2b161bb213f8b261606b6ec293122b217168363811877c575edc0eec1b90b72e0133df0566db1dd6cf20f8bf62bc8762ccde7fcab8dd18d647e5742d94cc0059420d1b44b7764fa1d95d2e84ceb9ad8180346a2efa47a4817411934e2cf7f95c114e3f47f63defc0ae75ecfdc869cf9337bc950826b53381b935853a6a8391576128c1e0e09f817813710e208bf1d25144542b770ad248812f0bb248e1759bd499ce782161e612352154c0fda32cd3efb3570266eacec29377f8782dd2a7951ea6d82dac17172f2c5c7b27f9be8ef549a1adeb96ddcf0238e96ff67941aad0459b755f121197dff0d43e339ba65af20ef7ec77568731719ec5f77b9c4c1426eef0948154164298386e099d1070abd7a15e0bc0f4cb693780c669eefc2780e0f947542a49fd561b1077aa4f7a62efbcb978c6058d25f763b5a74c78bfbe1ea0f0c597a45a107f78ee4fba96a7a9b6a52c97fb7a47bd9de3b2342e96c7d60bcb9cc735539f09dba4b16d04ed13f0127e43eb71eee60b863b41386eebdf4a97efb070d1a09e3c7bba589402981183f3f7bae9142a9eeb7bbfeb3728b46efd0b47591f698da60632fa05a613bdf110629537089e289f376511e4fc1f7307bcc8d58209954b032ed77d0a3fe794bc3182d913886d02689c0b2389243d9ee45c79c953559bb02b66b8702dab3024336fd6c1b6a6a8c1c4351891837c29f3d2052c63ef1ca0607863375978847c0c8220f0fa931f4c0afc0fa72f8ba14182a2f7f6aeac0e0fda46d79c2e1a9f507d6f9fc44918388bc2b54358624c0bcf5b7156891f6a3935b5679be72d4d921db09df0638827996f8d0c5abd92915cad246ce0447b9baf142e397ea8c5a782c1afeef1b528f4fe779c041e18ebef671404f28380d69041704e5d9e51d36444e8e7110e78c06b6a31952985cecd7dd4f187e1c7a80f491b13d569efd9bac24a6cdfb8a6e5dd65b21dd8a0884d0f30b52f840e1c4e3b7d97506a91a658e0fc0b394ac2a56c968efd9afdd16060e76846bb0dfa750e25ef4e7983049c8fc12ff8970892d3b3ab69c3bc9fff95269c0b1ec58d0a49ccffee3531bdaec5ef815d81c21a8d859478e654f2bc3c5a745385e3e5b3146e50e1d4908cd1b04ad28a457de388b5efec5d27280b2899117183f55feae3a6e72fcc9e2645b61e1826b821f922ba986adf88ccd73813248fa58670119e41e1f17815ddebe2c38c12ba48ce6f3e0dd72a24c3a8bd12091f09275a302a968590fcf0e82810ec0944c75b70a63e43fef3011c9619759b0854aa16219f451d9cb3ee7e3dc599188c809af2eac05b6e0a4986f8d3cd6357baa009bb2f9a539da7d9f579c44bb1ead18be3d51cf579e5cf5d7e827175264d001990fe5898f5ce7ef665f6c2d6038a981e11f4d8e765d114442f65e33f5ab6ce42675557cbac61d86e361db146f27350bd6167cbd355da250497db2ce33930176a8ce8707c5f07b29d922a7681f500bceb0ee8bd743da8e7b3c6034616ac857d8616e513b3db9c9411fdc7bbb5b286ff84d2879bbaf06098eb8c76a02d82b8215243b149c24a9c3ab6151148aad7560c5575f003c2aedc834bbdb8f49dff7d18b7c8760a19e1256639599eb6b314cc11d821d2e298b675141773a3e01efa13e9efeacde93d16d1e29ee7443b430fe3e8e94b09267f33d6d2c593c1b5153ec9b962567dd2ad2255be8424caf4d7535e0d274b07d96a656217d3fdb67d336fdaa57a289c94190793a08c88071a93ea3566c41cb30ffa61c95f494cc372491c97e1a584e06087a1c8acd2cb50704b2bc3b80b79f3f8cfe7f1d46e6208bd6643e9fb9fdb386e27d23e7cc3777b2eaf6c9165924c24d56ca8276024b561e1ba390a9940ca823f4128b5dbe0619207ca65ad34464e759869b3888d3bf5e922e2c37502444b5e3b84b618fb13c14f50605d39cd446f04cbe9e46d2f639331c96e7d185d772595190c98506f975ee789ba47f1224f2e76baa4c3c862eb5449bb23f1880bfc06ac156e72983815e5f8faf106c9594113c0b944056ebf8e2a8148f47eb08c43bfd1e855d17158c01cc55c71a11b5d88541b33665a821a1801163cb7c25920c18b5fdf697b16843deeaffdec73307d673d1ebf178428ca30ec6c48acbed04a12cd41ec3e8a5aea6bf826da741e23c0330f2a24d21bd469ff335966548e73d1d62aa2f8ed46afd0a2e925ef617b79a44ba2be16787cd4d6bad9995eef440130fad202a50cf8e82552eac433e56908abf3e732b3fb559de8068f27524f4bcf22c9e2c3e61377280d45f8392b010c7bd31a87a3938a160700cb48851748c18fbe4c8117c78b67018746912faa66e6499d4f5f1a052f109bfa4755668543baf36b726654ece9f99c1875fd6d6dde6afd1b3d97bea0e316218f367e8b3f3c96ca86f500b6ff62e7a2c0425b4e2544aa1afb521d0189d5726637593bbeb64039fce9356c12d788c092c3397a0430015e9d96c19a1d80ea200674e4f0986fe5177fa299e7367ff3cf7d0eb9bd5163dd73aa779eb6b0a4b97de8bee15dee5d0ffb3eff137bcba7ae2c7d86c7fe30c6a112f62bddb63346744873ed7955510ec24aac234acba46816b2808262d4f563e232da80a492b3b9d2238516fc7d76f4fa1707c23773bd1466b1b0dcc58c7900b31ffca590522b306a5077b68f4d816cbddec32160ab1afc2ab3ff70ad443905a27f6d562f5cffbde7872caca30b739ed9a113d8c3ae77358ff51854c3d05340ea601625a3558056ea14254dd4c014f02ed751725a28fa75fecea601e602cfb94467395b09bed90d67d16a7c5f0d10c5b814d3687d72538ba6c80a23cd1d76a4e179c3c2be4455c789945ac482d20afe211c514bad70b55af75a72702b544f58a9aacbbf14d2a6cd52e541f5e6765991f36e3047892d32e52b25544311dee144caa75c64e0fcc7087c4f9eeff1e7fd4a08f5284c10af66d031316ba29369fc0ca88bc644247fe615ef22cc9e4a4b1f225f76b6ef6799c442e01a30d925e8f67693f06378efe9fa79d8f20e9235c2ae1253bbff4e409527e79ff7baa6a2109c679c262a5e068478db8649dee13fc84c4ff0209ebb2f7d70420246c91a809c8b17fa99d1c0f4d4ba518596501e0a9681901edfa12852489bd4a0f3e66e7838a6bdd2148b073899f65573dba536b171e1dd672080bd769e7ae3a58d29af03c4d59c716bf0949ab0f1d87952bf884a2ac4f9cd51ae2fabcdc6cd4d4edcaa7bc7088d858ba1a2d06e3a0c7e7284374fc24d61762d6263ec9902c25697025c2e9a00a7cefc92fbf71c4d25f0b007939e0620cf16565c5cc63af1006d7cea1927a30461b5b1a794947e9225991054a45cc27cced8d912e99f64706f7e30bf3ce1d2879efc6d707be1fd62199dd430b2a84be9fe2bd1a70d9703116ecf64f7420f47bb3e86e64f840c99936a052b063a1b9d58843a174d11e3f4d9f1496a94b111f87606cfd593c6ad6be0472c21c32f2f20f56daf361729445d8846eb1cf0c3f6479e0ae21add6388ed967698ac683e98eee9e711cfdca0c0bcd654e1a1dbc4857c49801b209c1e1d371c2269a564c3115b2a29ba12737acc707adf76f1114ac8b9865a19cfc36bc5e09f368c2d426256235c1af7276e09b2367f8efe33a8345434e96ebe52f9eff9607c717c9caec575161a91c8566ded8c8612dc32a7ff0a841dbc3c424d1390179d6919dd722837693d8ddd56c400fc1a6c5439383fbff5362fa771721db3752796f52b4d05d231a7f988e9692874f1c09e7d4f1b7422658cd528f024081931e03d67a8d8cccd41bcfd2a341f5f64236faff2c8d06080764e4d1b599b756ba4f893c4137b10eeb77a367a2b58010065bcde9ec79177789c0d2e7a5c3b2a0e8d6c0435ac34e3bf2fa113a9da43b66cb9486d08f74cf1f1c1efb515e9f3fcea04c73dbba95413e0c704887984cef79aadf52216ffaa8aa97b59083847f4d6d25dee5d4f0a53201b93fa78852df490566ce1b2b0fa1a1bc785dd2e8dd4f0145d5266bf30b5a30109e206a4cb8626e6a5894b679a56a86a53d801419fe348a360e644e6c85d5fbca60294400d2502cb29e58eb4b5c3976b9b4d71dc4c7018d88e1c6399b06022af8dc2b9cb72e951820c1e1dd178e0844eadc2c964e481d115733366d465081a4f531ee0ac522c57012b9898429874cc28cf3e7fc35cfad54a8f26a4e4a8ed6981222948b67a1f3f45e306540a6bcfa28b3a7ab3a79f6c42b916f30bef3eb23212c320b0b3322c15830106e1e12d653915ed3cbb1895e5e8a3b9472ec6f0ee7682877067d46dbb09213bb2ee0f6d2f30c4a2aa1c2e14c064f8d960fbeb1a4a22e1fe949f0be85e4c0698529c80613f2515ddc22eabc807fa469a54fa76cc342ea562e88dbc4f6845efa142324b88f204eadbb1316783baf9cb27bd711283f90107b43722569f15f5bed955ab8803dcc53b9da415e3a8ac864e706359b399443f02c7ad006fb79170240c99d376eba987a667300aa7cb8d0d0d202072eccbf0fe31cf2f9fb7550349984167ee686b3e8bbed995b220ce46b2083bafd3ce710241b29f545d38fe93fa4c3672ca2287b9dab178f5483dad429aa3e87974299a8d1b3de7a2f1f05cbe7597b1b7726d4e77d26bb88d386eeea75cac42bba12f8701fb1b4364ef404c13fb8f969bf6e3d194035aaa6c4ec386a3b3a9416d72583b292d962b76a5f134fb8105f9ca4e596beb51d938ca09ed9130166fa5d64a69f0057ea9dce0d0ee0707ceabdbb9a76cf1b019bd34edbec6c39a45b6c039fd8c9fc2a9f8a71eb35fe9c484cde64bb3adc8f840ac4f708a9e98b0ae373097669ccee60a961df4b078fc1a0dbd1caba51e18bbe734d0848cb91eb34e2ebac673f7660e130a2e7bb186c82cbf793e2babe6f7a6a172a185b7c0ba1018220acdcf6d74d77d17f29bdb274cefe33707368a356c888e290e96253bd37d735bef2ba12427cc75e0cd87a106105247ae008083757c8772f869f5ba66da5b94e9a4469fff5a0271f39dc63eef88db116ef3d4eb88d9810beec1343083d4d736aea41ef690ff0e4ce3e68b10fa7a01694e124635bb393825a972cb671df3b7444e4bd7f117b934a9f8e018606e6c3cde8b28630f50b32f43e5ee38e43d09507ea4459e11ea4f600d87e7e0b865dcb8f700f5df1efe2a306985a262f763edbbf226c08c1af75be1e4d029b083b2317e73372999da4d1dc27a459e1d573355e0bd9de50d70dd48ca24cf89bf0c37157aa8eae2e94b77a30219d138c76ddf46e73751362522e14f06b6a6e93ff62c381128571ac725fd615ab974c5096b5436452733c6283c42ba500ce91e3291e97b75148d64dd99e83ecafbca01a27dd6b86fbb5269230cdbb65a2c1119c24cb8271c7b134dc9a8f322070b47edf086684e6b7c2f1b90daff4b83aac7b0a761caa25cb397d3234cd14522d464d398b3bb78b9850c6cc2f5706708fe7053d8ac757e41f84645acd4cbdfdb9927f8fb5b55e774ae8e6fd9fff9e8b31be0a5ccd15bfcea91b093d6d07d9c09bf05c219f2f4f85729d38e212844b0e2b3f68826d5c1c7989c16eae857606bfccc87689470fc0b19ab7d55177fd3518eb9d453c5795433d13aec632932fa60ad73a7561e8a0b1f4895952454d8397ff21a6eb138b80178d9da110b94eb7fac0d1f5d580de8138a4ec08040b8bcfc439181e74a030e4cb679ab9cde0c55f49ac63530b089853a3f92f9434608edb9e68e1c7a1e7d352ce4cca3e11cdfc9c6ff797ec259b7e669062ff181e3dee0ccbccb648d8445124b3a03b96787f766d6eca9dca821f10b0d6ac524aab2ac376a7876c114ce127c75db8bf339f9515cb8ce47c9d64c2a956e1db6a30f6927767c473321ebd2ba6df75ed6eb80eae6d07a6e9cb07327823c57474a2dd9422b00c16447cfb53db68ff7d02604bebf411e6bc55408c759d625ab540b00d12f269c9d184e9f64c6de95282c5b33f3ed634bb6fe9637def2ebc143c66fc8128a7f2efa011e2bf046cef71db7457d18db0842e3df746c580f05b09976fea381d890e8dc87b23ee9bf2e0ec1f5ab47c00006707f067a4482349c06d0ae02df822bb8c11de20a4f0debffe48579ea99ded4dd6680cf9f8ba9800daf0b7133b0e624fd8772808ff659b44615d95d53342673f8bc2d6266992ea13c9ae2b28543bb47f628d37a9d730c06950b258d7fa1a63121a091d97da9c6177160374608df05ea73c68a1193dc540bd21ea09e07c1a131711a39332ddf35bf507c7be29d7ce82358c1b57bc7e6107a4a17c848eaf523cbe295473c474739d29c82cf8155e9f95ef4eb0d85c858728ed61e41496a85ad5bbb60b6185ecdafebba65bb0334b040b50bdd4e9ebb5b9a5c84b3ebdda72f4a7080072e490abd3ee272bcf8ca0796ea586e0eaf681415a89cd9f3c1fb8b9a07a467d20d304171ffa53886f5cd780c19e27f941b40f2fdae7b085b41de02a4cf16a8d32958520ce66a66273394da4a54d314eed4e1560bd254a68b7e5cbcd46776b85f0954ccc8c28dda2ec70d259a5db14517f2077d4768a6c0b335ef587747a29dac50464e442c163025b62c85bf197c337bbaced25cf619ff6f29660a58209087ea29ef5d009ae4b38f440aaa4de6c11bacec8862f9a8da3399524f41cee5f7e4d04e5bad204a45712ca66e0341681e13fe708e8583464010c90d665d4dad7c3c7b0e672225abc7c588ebe83f351ec015ddf33ed0638f1206da24d3d2a606fe350769801f91409315c7e588ad8b139e52068eeb2c15940ede87a5433f40c56b5dfda504b384205ba2613a476393622543c1a7cdae72e8f64802603324467eb477e3327f7e7920bc04b208a5bea06ea652c6957628813a411bf06338ea9972a595dd02ec696dafbf65b891f69b702f8d165d958b3e3cbf71635f706d0f0a9a52f1a28174f0244b0c4daa1af5323b9c31b0d85fe35f7724145721bd6167eadba474817166745d04e23dc8c959b0a1752b41337a2ad9a4638baa7d99dfd34c953144966f17ea113bee5ced81a387fb9f43482d1b8501286a930035ded8d40ddae0d07d67f513e625080bbc221722d22bd489c944f6beb7c1a73e0e4638de5ffd6e03efb3362be6070f7df435f255ee88ee1d23f4ed7627bef81dd8014090e9d19379c442c746b31a8f3815235d0996bbf8f724845f87cd89b96a97a4ea54cf876b144271e423369dddf4119bca191dfa8a687663d701b18bfe89202c67a282bd6318fcc502b01ef85792573c06773708e337e97ae941ab1510edec496cc20e407842c1a33c2d3be019592db946461c0a3f00448b8bcdae98cd7579d4657eba5f19a33e8b9d18e2a0823a3b95329a679b62786dfbb3d90a2c7897abc97285415656aaa9b86b82198e0af311246d8f54f400bdf68dd275db5493370d5d22500f3348c14bb5c38fc8f988e86fd58d068f412e4b9c2725b8bba100e6a7a458b72f221017cd094851e44c7f40a647db6f3ca284dd3ab2be77e7737d218b58ee4543f54436157d361bf499e8b65db39b9a13520c309be4d37e09e89824c1fd8f112b32b7d659a584848bb813ce012e26e8caa9feeecb3fa26109f6dab20ee08c9283390da5514bbda02fda90a3eeb9e0e25be41aa49f79f15675581cd0312d0e2a00c20bea536e90b192d37f4b587430fb7ce23fee497dfdd8d538bcdb54141edfa3ad8922d5d746857ca9bca70b6f1a1371b44650216e2dd7c5e2209c970ad628cebb13edf25df8b09562d8d42a100ad3276ca80f24a13b6b4d9f0ae512a31ceddc005029d3b6def99578f5de3822bba87a500c891707dc9e811c79c7a83a251427b5661c54db2aa8756a011b3e49069d88579b89b65f1fe3ece13f7d801ec4d9c6296243a0e28d675cf88b9dee02ecd2b84144e2ce25eee48737c2a899f07b08abc5a40f3727bef3d48e175d54f86c050f2bc06e74e6581debbfaead0e5e15fb18475845076dbf6a5bb3843d0b8b28a92cc13bbab49d596f8f41e8178f6149155349b0c2381cb9be24e6c4ebd912c0d98a30f0952f54647e88dacdcb0dab90a10d85c231bcd4e7b7e5f846bcd9e770693a175460939516c21a64a6e38803238e58377be50d97c9d7706a75d9f87c4f539223a0ede34f77775386d97f9a1906042b236c25ec1b7abff2879b30d50357be20d1c987b559920ea5c575677c73798af346ea6d6783a4151400931d8e344c33ce15623b37c46fe459bd41cf700b8a3d17d2ba82363654c40f2c071c9ee1902692b2a7418f60596d28cc417a15ee78f8278bf65de04e1f4057aaa81d6acb5e69154ec370ff5a4439a66e09beb4bd5cd48b30c0ca12c8411ed226eb1d309ba485cf7ae98de0f957fcfde52de1a0a3ccf146163f8afb6293c00fd64fad2fc6d6097c5e05e10ed82f0aafc4bcdeb5e57d849580009c2f083fbd828d101bd5bfefeec533143757055f3ced79b95f9c02125f5d9bc19d261addca0e7e1f833b42b70551b2a04bb83a7218f7ae24b332b9b0d43f3fd24f022163e9e9ff520a04a855cf4483f96a45ef59cd376000ed722babfbecfb64887c0126f99a198fee2e313c016671b006bdf8d67d737904675f283c879a0bad3ec1bf78d367efe81a954332269e8ee3d241027ac5ebf976436fd573eae8650b56e46ba2e61d35fa75b225ac33ae8b4c3981f5b1044d9a7c1e80a205ff6e2d3f328958bd27ffcfac76935cd31c60ca580dd8e3cc95a6cfad19a0f555242546c097a22e8333c2d09ad8d3566b22eaaaeab3bcceedaad2c9c6afbb3fbadd8132daa08d05c2f440032eb970552cd3b2a20bcdf1c057d2afb6ac70f5de79f3515a0f643e09cc1c3a0b4d949e626e88c178a05a72e5e631ea43127f67483ae5923b9cfc87fa33dbcb76dd97348727034a6e438221e084dad710510acd220fe9397157314315bc5cd922d0ff04a4f15e0d6ff2666ecb2e8552f7df0d630b8dedb73b0071655e22de3910ae94e0abae064b0f3672e7c075b122bfd226012d40f9b8450dcada766220a005fcfe7c6de5687115a2a4499f1782b728809989e2963c660db2f40e6d74cd20491bcf3e1fb47160f043ce9ef174306511e2366b756b1ed5db96cec907d04e9d57acc21a2cc30e06f023a043d729e58204c9fcf771857d6ccccb72524ae67dc6e9e92112078d786698dde83bd95199688d362883e95171bf8946bb24184d4ccf558b4735e9e8cb2659b5f2683606d14300819e543b38e71b80d84fd778a1a7413e70d99b73599ba49c82f583f5265d1ae491ddc4582ff588a822f2a77e63235637444d63bdc9169a73fd15de88c44f050c7fb6ac58d5c8b2cdb72da3af96745f71f553719ea1c50ee0043f37f330468f7d1ee4f90dc46bb3ade724d8d10cb7fcb51a5b7d1d4ee420e98ffc209002618bd9eb8341d3f81f35c778d123b3cc05b11c1ac83cc7fbca05e28269d05de6eb0994368a37b2ac0c8e0db7df1ed6b8121e99a1df89f053007b4d562fe0ccd2ccbfcd63250db693f034d51ba8cbb221bc9ef979cf78c3b88c1f6c85e2462839071d62181b7995bf8b4820549cbe4bf689927214dc8a4357fcd9ac37b5f95cae186d20769d5bf02d9395cce5b1cf41d010e79a2f1a992b83708b133f010ccfcbdcda98c987cb257d999000d79c38b680259a9d5d451bf0d43d87e5b8474ffc549b01d7c70d56d7c5ff056364317fcb7734c7cb6aeab038ae3f0b7c70cc1492076de10e4b8fb2afbdacacbfd7a86fd24bdeb5c7452dbbe0e221cb0d57ac02cc3aa93fa070885e2474a67e56a91b7f2f8fa0fd533e5bfabab44918bc9542be80a7497638b213569c445e826f5d367b65a4f24f2df993ea4ae46efd77bc70404940e6d1c3eeb88311014edb1a5b3ffca8caa98512ba0f56a2b9e662ee62deb0c1fae0144638b6a8d00be038b89aa3b75892aa8d04587374f8eca1bd90804d56b8d95647676d68a8790009ff936cf42bc9438be506bd1121f67c2afc8dc92f3c6afa6783df29f2dfb4c12494c1e50281a329cae7fe25c9143dd0dc92f3aea296a9edb34c0db0bd355484f1f74fc104511c23a8095a81e5885c95f3e1cf2a65833ce40a0eb740826eeb60011f5293afe0360f4fbe28eead5b2a731ef6cc0fa0d731530c2fccd529abbd205752d48a1b08a336ade053b542d211347b8eb1067e9cd80c40eb78f8e813a89fac67043f2da78e3b6e8edc03337755b1ef10fc30e8d1a23580e77e2f374d99887103d6b6b379e8bb1fd9bf2c790959f05bcd4856c522da667cfaa815aef53e0b11d03f4d455eaca192f18e4dc70c30b08569ff59d41ff1cd4825efa580f54b6f49614444e1ec1e22660290e259d4a3790bf3fa4cec40845df218500060880cc0926e3a11b603323f42be9e5cf9b2cd35c14158944ea6cee203e164c1ab8d03b5f420762a2e15986ddb1416ba96b40c4fe58dd916764988733650283e98940928dea3cae6941afb995dacfa54eccf614622cfefbe4b74222188c316c3f5c344714fd2d3536912678fc486244072e90d6f1e30214a5733becbfb1bec30a094d8f5aaea8e8fd8f5faa92199fca99794dff34c7284e83f876fa9da99063e6f4d1a296a9c35cb78ddfba9c20bbf11690113d4e4b5869f359824a77a5d16ed9602c9bb1552cdaea12b8c480bf9b41e47f7ec4fb511eb759912f8e44144faf4963c08d1ee3724079c15c7f361815c122da20aab708e1834e550d095d662d45909617f5c7dc6286397205720c11c51057da0552211c38ece775239db04eee8cc94e3ae4cce9c503bda32a50f339028ceb13de6dfb0d52be57774e39e0fe5616f020ee1198992cb001244282f653f1529b0988cc857e6319cd40714a9092aa207814e559dd8da85dcaae3efcdfa4710b6d65561ed09d41820ba7dba0827a59118de83555b46d9e5025d855dacec5952c4fc0e04f791fe313ea4fa2880ecd6d1eedaa538e3bf0bd770e8df8e7cc92840a5e6c3abc53f174bf377d335cfd3060b84186bae174c501328863174b6273bf3e2220a7fb30a9a8d6478c9ea2418a4b61728dd08e6b6c1bdd79dcb622d03c317c889689ed6a389ae8f022fe4d5efb5e99e0956d551f1cbd5a8cc7eb9a3ecc0495087c7b1d73fd1665b4055d1e6ca0bc00a1298bf4482a639c6c253c24773bb8a26ae8b195404045ddc4acef655eb8a20720556becbbedecad822eb3e82a298bf531eaa2a2284d1e1bd4b17844a4ec0acad2a1b6ceb37a476d24f9786247533432052eadf12797cf74c02e62989889500e708b1efa448921be41c2d3f72efd4c50b9a52ba3e873a2e29fb192a2326aa404cc9247e5bd5183f523d7f62957904f26a100cceb909207e4fa164a5e16b3f86f3e463563ee110513a695b0fd4424e07ece0c7b10862fdabb772025159a70a809168581e811ca5199770c8450e5684473f70f1c4c7e578a5c9ce4c3d56420c697255be50c91ebedc005a439323989e2c46d58bdb9b2e26d53156caf71d174a72abc0e6f33ca5c78ae34038a6ee0e79596d86be1abbf1c0c4dbf2cda602843421bd0c1cb37d3aa5acdbec24ab88b2cae95a71db8095d083c95bc9bace2177801594d53d2435e14e72c8742337d9f12b0aa1676be75a301913d3b8f4ddec31a0a2da9cef90c32c1cbae3f96bb375361aa4fa66acf4beee93ecb9a6d169ff7cd466adb1b4554349fe1abe5f21660e998049f7c562543af8edb910f13c590cdf953d6aaab1166df83c71889160bffd3287949e1c040f859e7d4dc98a018d017d4d79e1c8419e293c837c8eaf33052d08d5487c9b8e1118c90d91f95c1c7e65239c4a2f60da79b6c3dd490c8e9be34d23cbba2215b5093350a50c30332e994deba32d33dcda6fae5628b2b2a5931a1d1ba5b1925c28a9e67a3f3f135cc66d1b68844a5d0a5c7c544245f75b75ffd9f1c94310bbe09cfb47426bb46d5cf17141e7753b02f9b6fbe516d39c040ce6e2c1092e04999255bed277415362adc23fc43daa74cee05e9291e97998835a6c82eecc22d4d4fecb20d1cfce55063f2df46b89becf7e3a2f687c74fc852213185d9ef8a2d2e11dd0bcfee4ebcc09afcd0233944c43b410bd3ecfd87c9fe5bf9257e76f4ed561d3235e34b2a5a89a8831376d5012ce8784894c5e26363b6b2c12460bcaf505c40b02b69d56f8f24e54eef102b71eee7bf66a4855ec9b0ac35fa606ca9a5b9ff95fd2b4a915d8ed79e78bf446a020c23ec154c98de0effc18fc2bc1d892b6b5f9f5bc898bf8d4fd730d5860a48b0ee06eb67b40c463480468bb8b045f7053e7670f1b99c81fba9e2a7bb86a10d8768e366d58fcf8e1252fe419d16ad0d8e137d6be286ca6759e431f14ae2e2aa0cc4f4851bb15f8d043fedb2bbb5d18e6e115273e5fe56201eb475f17b372c4d1e1e0abdf7d29ed44167e17787bd6fe625ec5b800b05d9536b9d03f993611e401081942f890cdfed777782d9855c401166a8af764ecca71bd1ad6abcfbaa6877105663301dcb2c662a49a8d408925587b4d877fc56271c31a8eedaff1ccc8f535714951871aaf19681e2d21c5be7529075486321a7f85781b5fc7ed215788624d433e5495a2ccfe5d8457040e1443e0b37d276860888a044b17bcfecbae23d20e214b390c1fab29ab88de18481b272b2f1ea32a2f8672ce7f1bf4b9e2c86a85cd7178fdf4e1b716cbe95753721eaee993286fa6c0bb0e3243f6e5e7e64c7ccb5c86e1c8b084c84d159110e90efea06f6de737fedbf66b22e6786901efcf1fabb68bd7ee2a0d24155f0360c904e361f7fa64d651ff22dc72ed3d23a34a0f34b5eb050e599f5db176c75abf34172f7a808d98aea1f65e8ebcd019cc57783a797ba3c4f22ead50893d3bff06d3a3f0e728ff9a0fe8c9a6194af9a14c1f0d1062a4bb718f8de642d209e3c30d6f116793d881ce5c822f02e5ff1fafa7709dbcc27a9161e2a40f9102c2c8fc8e0cd56cadd1ef37e358a50c70ddeff11e29e9b482eff509769b24b5ea0344d8372120d89485ad354d2ff4afc1f04fcc7509c08c6ef8ef8ac41005c0d46167557f4c0f735d4441e840473748586027c5039ac0ccf84956920b93ade543ed58a0346214f01f0c472320ab86f4f1674bf29894df712366fc7a34ec0900ced045a651131dbc770a17268b682a586678e48baadd1576618e4085162eb9b58994b5ad46e2b43ae2db687bd74d9267142f66280a9267e2aff9df218e39a28a4fd66022ab962d41e2b9191b96ca185db86c2074a15a13125d9ee1d371ce27a9f353d7d6b43f16aef7464638a57fc71bb54b37290797211bb0db8af379607d33da21e5c539bc0adbc127c05890205bdd835d5820e5b6b95048e60dd27147466e54332d036fdfb00cb37b7923360cc7f859c607b54786615632b4cf1e9b60013d938767948af92b7f1001ee8a4ac19c9f7ff7a1ef271a8be8efe1fa8cbd5d73c994a977f11e1910e97f610d9ec0798f453a4d47d068fcbe3a186a9c09fb5a666395b0c7764e3957b31975fd8dd7d77c5b5fad0227128c803a37cc0ba7ba8ef6898c8f0b4a7205118524638f6dd3ed23512f86822471ad61b4cf1210a518d7a0232815f11703092faeeeabae2d4b218ca6ab1799a4b4ae838289a59207aa5acc2f95b4530daeaa13cd658b3cbc9ef8d342e5ec6fd649694ef93cdc2ec4f2d7ac3858c058891277b6f351c7a7384170541e8bca6bd8c0c7efae50bb3a24de66f0d1988d8cbb228d49b7baa343eb912e317ccf139fcb552e14e957464a4a31bd1672263fc9751ef699c9f43060c74090634c7de8ee28fdf14051b49b345240ba838bbd6418af216d5ea167c8ecd9d841d400b8c6f2bc4441c035c86af5a1e2fb1ee1f76992ec2dc201a6f5eaa815bae0882538c6e0f9ed30742ce72d38ef073884a402807ec4bf6350c09e3577d776c34146b088b2d8cdd9c121887967a0ac2cd7bd14890077d97ce9b98ed5559d63e4c4bcf4d158639acfce5e701ae6a2e8def25b403c7135d36bed0800e89cf09c5a031188185257d5d0c33c1f307a112097c2008431c63963bae5260f5eb7f18a19d8d95cdf7aa0f2227f01ca641ea8cec1cedd40e451ae0cad2a89e5af56a58261cb355d261493ca1036a075fb6c53d26ea870ffb597844c4881cb4a1ad5796788e37d17d73f819a40432b67e436b4507c68f3555ef96fd2137c18146393ef744d6aa2de6ca61546b991c96a83f0304c499d5986d943ff19a910ef7185a55c8202104ec88811a8a8e869348000d0e1455ac4b02aebf84ec980b130d459e95f2069cc4c131be1cd9ed4741ce696f2160f19b435fa4e58b6dd3e7ecd918cc8e703b43ac9e558952b868f278835be887fcf20262932a9fb49dd33bfea296c77fdec7da86f11727f6a587b6ddac5924a7754f22fa034c5bb951171822fde463e384d7a5bc03ae73a0904a423e251986d0fd3bb80e61f3dce15dae678d31f346dfdb2a7da4ea5aab1082b9ca019396a88ba264c95b4bb5e5d0b401bcc3dc53e5dda9de0738ec31e675adeb407d1c791c8a1452e2e6ccd09114629f29f0e93ac2981e8401a9c637ebd26063eaf579ae258b8cc589aea08f10bcf58efa74628479c85f0443a57e3d350ef9e8d0c57e8d123223956223998691ed8b177c4543ffe94afccf86d5af952bd5e46b62b615f7f74b68c1b2fa071b829e8fe65c928549f62b31278eb7ee2e35f4bac17cebc8e9fe7600c8f926c8c63b2e0fa359ba366b59008cc291b2e8cc7e3a8eba9bdac3aa9c9fc4960f3863279ed563eadd65ac8c2f7ca5fc8e86e03634ed4ae43c9f63c35c13bb9efffce843e4b12511bd2930b67f0dc3500a93c79bf66a78c9a5e27be87cbb484e1876f88100f20d59a15d8cf211cfce7fe64615e1e57149fd8653c556acef01349542d6846d932ea4af3abfd9ced64e7a8cbd0cfd8dd24e28c00ccf9301530b4ef52c6d31b04236622ec6508f3a3158485cc559c07717ce1683e4357e94eab9275cb44516b0877b27c2c97bd33bf4221fbfde8540c0ce7d541c42f6b0e6cb06e10fb776132dd540c1dc5d3f1f04b7c39efcd0ac90e4456f5d5f887d7a42b3a0a56a12fc998ce0fc1e70e88cec883fa98b8376dd77c08766497c3019f492a71586d4372aa48989810bb25bcbc6fa6c5b8b2537841dddc29b8d6ca719f764133f0fb710524b3eaf14abcbb28386858aa4e4c5af290eee26d394b5826c831c1fd68625b44328667474502346ed8eeed394dae37e451e8656b1ac5703dcec9cff1b9bd38c3550e6d469f60592aad55624e353332d3cbe0afee7b75610c382a34433b6fbf5720a8bee4f1df7f11468a58efdf919dccdcf96dd7018395246dd55720f9baee45b0b206264d2ad8b53a0d1a97372a4469062bd91d228b6799dea11ac0b733491430503689020768016b6f8fbf06d71ce0720bac21a0aae878e4eaab995487371dc3024c34e92129f6fdde14c540f42b5859ea9ae3a5425b95a3ca40309e0f3de2393c8269d1f52911de99b950c4f31910e14d275410f56ba11659afbcfce01525f2afa32eb6055f1b6f49928ea9ce73ccde0418745198d8fede65810e6054f183fbb7cd18615da442c19ae757ae1764d2ad1ee88d8a52459c705e9cb713470c9b99f93aa9363fe944c8f3785cf1f6d929642bbe49278ef1439b5afd2d597642fffd866f8ec92406b036e91c1371bcf6a0ad0a539ba79944bc07d1d61e85b7bda4c929f3499c6924de889840d038e653b145354135eaf5b851f541611b14f4d268df9a081d71e6aa2eedf9ebd02f1b559cd3b563cea0d1571082f8f1563df427b04695f60c8986e47969a51ae5405be2de8f11152e8b4ed0f91802b6b552880c0273dae539abae64946f5e15311cb8a3bee252a69b6003fd49a9add7e8ebe046d68362c63cef94d2afed6013d1afd79a0dc3fc1da801ab891f3d6ff9ed859c9850c83d81861215b1ac041b793082a0733170161588beea83e46c24a4bf87ddafd88d2f0567e240e3202b9a95ea33d31051d5089e859794a3a56d36c099774a4397b7f8cb36e174d30d10ab7a137ececcfa58fc4ad9cf16bc342f003d630b0202814f4e964897cb74c32fc84b792eaabd8b6ff30034f6f74cdac22087054867e6af0d3095b5279de84a4b1457216cbb826042226be61c86559a69f2fdfb58fe51bcd861a7b6d95a40dab96f6e4462b1b4660ef9e5dbd9ae959e5c2885fae08a697cfe5a31d15fcd746c3a9d1e2129a6e54413053a23ce1d1f6ed117fe8518f14bf981a793c7d18d822b6a6cf2d8f7f10946de0a65ae9470b953422dba4a4ea7cb735a57352e9894e03c241caa0b62401ec26020e48c767a91bdfd0ec90e2bcf22dc90e08086fab9fc2e7ce1876f0c21687ad8174d69ee457ead594fc570874ee91fec168f6487c484077f811dbedf97e2473ba11d1ec18597d12fbe5fe42f143dad988d733a6b7d89dadc06f18fcf8385d9c95d000c1cde3cb7738ffe393ab266ed2412fbf5b8277bc730fb86a5352cd8d3b413e3e739de5e9dcac744de3645003afefb1095c93736867fef85ca87b79dff4f4d35514a0fa5ac60cb3d2778b03e9af4c451cdef37614a4fb11de91af3ac02b901d0403965bad1f63b9e685c7563e668bedfe972b29fb9530e6975341fb121edcc3a24e5c002c1720b9770227f971255a5c8c4048981471ab13bb8f4628d0637c401a30337f2a40c96214ea88c5315b51a39a003c7342fe8b885882338b885cb33ae2c49dbdf6dde81f2f93faad5eb3fa513672ed17cd315d74bae5449628449078a5adc472f58b8562179d82c936cb05f7bc4888f51996c04dde2356a75fd1be2a050d42a255f4167839a6f8f28d53b1b4e83d1e070731be3c16a51c22b9b0e6660c953395e92913af8f75f039f069afad75b5f78451f19ca73653c7909d2bd7bcadccce305f04a9babf1d3da0192eb6ff92ae7609103bb1297cae92d171b133a22f8e7d941c349f53da4c625e7c5925580de73970ecad454af3caa17d35690530ed05a78230005406a780f1a221cf1944cbe957a4a8b7650a21cae40db1175d0daabbcd36d72a43c05b17b8d702063d83699bfe238d5349ca86b83c8c1b398297b2b24e7c5130e229610c22c7870e8af097f8154df974fdc2540b0d2ff6bfd54cc040e8a4380d13166ea26c8f9351f58301a812f56eb57dbcc79f65cf667138bbbb32377946e8489fb811a07daf183abf65b728e040cb724130d417fe8a2289fe47113861547de0dd9d527857d5703ad712cd2384670a8401105854cbfa779cc40220990d2981c466b7bf139929bfbf798e229311a925a7e0bf8252b6e253a9f3dfabd0f411f00164ba1ceae63af5d8f0b95e2c481c715297e779b2ae9a762f5bb51acde2276e942d0e556d1e8e15390fb529fb9f3502c479022406344b1b02ffcbc7d6ba31898ab6db09052a25d859ca7b5c9b83c180a7c3d1e5c3a1bed0cb138919001928003159c1c9f44003aef92530683c4bcab3eb85b70c6480a584fdb7247b52d6db0b7151870812be234ada0b069babaa789cf8990c0c005b817e709d5f0c131e0c145efa492869da89c0783191293399856cd5a11980e9b50bad6cb22d5896de263133c4f2ac4eefe0d9411cf78cc0ad796e197a56de71e31be6f45eeaeae443d0ba1bb7e6f44a62168d2144bd4eb3b82303454210eddf72134a86351146883d02a25e21e864823c69108574c4c452254c51b256e9c00a24ba34e9738d58429b9b94a9015803e14912afa4368121be5a37832071c854514e22d9930c9c154b9f5b4dfd91e61159960661c54fc5ff0062e60d2318f14ed8adba377bf87590d9b4b2786628498037836b53c117588ed08270278326aa63aa3bfb799651def8841d64d024752d2490868fa4fa178e6ca249f9b0e4912f8f799ad23f7ab0f5c773c3050e5c41409d16d852e72dd13d6943e95a62f0a3ef78660cac838b6dac13428343cca8577381ed13ce1e5ee6eaf183ac786eec0c006c56d492ac8d7b38516d3bb0dc90ff5436115025eb36a787c12a8d3eddae50cf10356dd71859e1266d0f37cc41eb7b401d974ec2ca1cc372f3cc1b5331987069c46559aa9a1d0dc9c7d6fe6880c2b93e30c5e058a7baf5d91aedf3a2ecc8bb13312390161c511434657b452833c0b4eaf479f2f565f9f703de64fbb3ba3ca74d0c9e61d094a279d5b5307d5d47727922357375a2aba3435510ee108dbc7514c516c4e64779ac61952dce41ce4e65d5eb7a8679a0f6187c87be26e2e019d4bb8953636972a9e33bf344afcb7f0d58b05fb6d0f757a5059d720df891465949d2853f3884a0b2847632e668a3da377578014c0efa3c841a20627caa307c59763e64af9064642b7979695d2b736316629a0850a975f29942a44ed7580aa9b25aabe1e9c7876b1c09607dcb8eb4614ab7008ab743ea3780a04fea6ce3db24ab2a89bed1cb8142eba5f937c466dba0f40d08a25c138fc705e6061b6be3e8d92ac55ddf79ea755138103e02a647c3dc5f46b376da1bc0876d85a580798527a834035dede756d932a696f2b27ce982fdc56287d022d5c9877054dfa857269a07e8e4b88101e4a4cf4c942d99e919946baaedb83935501c2dd21758fe1b03ee334400bd03de1ea05e8039b24cd6d115fd2be6b2db741253691a8d808fea5dff7e4d32d6dcc7df260cd7bb52bcdba5438550cb5fcddd6296f641db6f87f83fabdb1fd31e15524c5489f9456543be76787200257323c19955c5050298087f2fe7af5ee89fc0f023ba50a4ff6b1a2b04d39cdb88cbe6720bd64b1aabc060d0d273d5db0434078c0f6953e52871bf717a3442da16adc5711766a1fd2270b3d1fb48345e5c60176ee942821e1c38129a8082febfe87f54ca13452d6f2e18a0859f3413edca86808bf6dbecb4a562f8977fdefcb67baf3d2b79cbab87e8bfa25fd3f98154bf315c0aec3a0a3c169d8763478fda12df4b74582a412804d7240bfe40741870f55fecd3e06d492248b6321cb35fc1898bf469d7035323d5a4ea568558ce731299251849f91e03fe67dd14da14ffbc96cab80d3fa9730fb83a0a376d6d4121ddd0d7963ae87929bfc0e2184408f655f778fe1688247bde1025315fc0504ed4746e81dc92022d4dc58b2c182565ff6bf710ef375836903a0646be21b00b134d9e85e09eb2e702cc3b30ff77eca2e7e3601f4121f17936c81ee91c5bebc870a163ef668f68ac26d2244b6e534fc515a0d176acc0ad28380f8955fd01984e2133f66301a1f6062f2ff8133be7756670316d605d17e9a52e87dff98e153b4a241a553a94991f5988504aa8dd905aee506fcb09227d645625c9868d65d90c57048910dd1a224cad1cfea39d03e1f0fe7f9991406a906719359be00d8aa0c54f68d35f1abe61f453ce6a002cda1f8f6525515c7e18555b2c8174d8fceb0df81b8d1c2e438672f97f34d016cd27d346769a052e5a862b687cc59bf4211081fc91cad23684c36c643cf97d80c74ee24e52f0db4d803aded018d15d3f815ae64c6e91055219d2df601d88f5f5e49dbbcdacf4f340db04aa75e7130cd5ae6fecc01de132b7dfbcd645308b3097a678f0de131f87c9e04373462bdd572dc0dab5c3f6407e518c7155cf41976279528d9e2cf49dbc3d1e83a89a0f59ea9dc736218b5e60b5c25c4780f444f85892096623fec35cf2014fe4aadd31c79a8a8a9e4704a3452717fb1c0a55b07dcdbd48b4fcfdee51dc18af646b0767e9bc20354d0ef18ffa2a207249b9e992af793d139b469bd1ccc30d348a8d9a910c2cc8f182432b56b81bc7bedb01b47e9c9d370186dd6667a3d3e8cadc70e3d59284755e6cb4582bd7a3a620f11999b4ae11a297e91d0826f6b7b37909a7fad6f250ea67784754cad5703a3149677f0b8f57e062e66e2b95d960bba3fb9a6e497ff62895f9a74aa80d4a53aa48eb4fd016458b215c544147d0427ae2a64bdbae5dff3885b65d2dcc6f28401e453b93ca66b35958ee83fa664cd6eac31d8a3021116e5f4d94d29fc51a61251d3586a524d790208ac59e6eb2c931ef3a6401c2618a1e561a2c790b91556abcd86c8bd0667957af5c5019c1aeb772564609a76b534f48d65f0ee937d15ba1881558806ed03c3213627e63fcade9950333b70444a487de4ec5ba201839b6354dabf6521b44ff75953751a5b3b853265ff20d9c1ad84d357ada19a78e1e6a0d5f264d471fbf1bd67f2bbe04068ddfa807aedb912108c3f3ec1272ca06093d6811e83313334defe2ab141a89b14a8d1acd64ceba9a282906bf7516989b3d578dd83c908a6ff1c50d1af8023d3274d8948e20c088532287cea0bf466b0b8e1d8ab80b048a382fd658bdde438bcb6728a917a7b76c16fac8ec1b59f23a09b68d9a1adac6f76b895bb069df4d756299feb601d342232a47c096a41d157981e27447119d451822c9dbcec2c7164f045600142f146ecf16d4e95fde864097ee5c06988ab12f1881269b5da8845deb3daf7e6d09be8ff21741168fcaceb17e03ed3e36198d5d840f85488461fc262b010bb96bd3a4a8cc5134ced436d1e08d6fdd551d06cb9fab76aac76f896e0d2a1908d30bd117a91cabd99c08468ec044510def4a13b8fc356697692a3658c61471b2fffce5cee1479613250da202e1ec94492bbdd75b6f4fd6136a510895a8b4c412beed31e57f163acbf2f447ecf81478113b3f9688feef469d15e0e129d29a5ddfa6e97819ea518e5ee51f2f9e78eaddea0bbea9232ffe1438f578f937a3a2e8da77191850b2828849a7e3d7cefb28c462e6064b3aae2490693f8ff7f0ec3fefbce9952f0da9abe593ada798f0a22189dd12acf5b43c1db11f1e4397769976ec8bfde3b7ef49ee1695dc6d60265b8976641c6edbf48c53639e16916c998df974946d4fe01c805f4af9ca84c95fb0b200eb9a58d4864ad02fc0c18a54221ee2db3ee996f7a25a8254c4c6250a2934b4cdd7dcfab73f1df53b3be3c5a78608aba1198eadc9d484c164ce3c41fdb05b73959769a3394540c663caffcff9d4da820723adad2c5347da39a6c63d8401404c5601f6e646abbde7ee8fd61b2502e470505005250dc80d7c896375620ec77fba416707a23447076ee39a6fa48218b30ed459120bf3dd2946eda65c5ae6a19178701b71630ea13410856178e52de680bfbbc552156f65930e4768b55b8f8f862a74229ddcd8f7ac019f4a747d1236ba1c9f701434392f289ec7a2bb4fa7ce06a9118b2298ffcc93cf906269e8470a3fb2d1450862dbb4b414320dc0b549d18e2adf77607c769fc24b35710ad16a72ceed2ba752cf5646ebe38d2abf2122a25b0d167e01777671c2e9b799cfcd42abc8b51dee6b4444df0466cfabc258520be941234d9dbac76ba9c4289c7327037beb1aecbbbe7344b8a0031fc6646b9b59a6a2e4383cf5719944a1c8c8410fb8064ea3b73b71476e8dfac084413d7f1426adbabf535a0bada044163c337591fa53026db0cf0dc89f5bae33faa6b9822ddb37c4feb7c5e0eba5fd6cf48721be14b9ff6f3d72b2a6b46af381d391835c0f87c959c9ba23fc70dca4ab25bd13976dabac874d25ee43b91a7a458b615a954d42fb0885a6c6d01924e5251bb1fc3b05cc00a4a8618d7d41518b9071dc4521b732471b60546cd425460e42e0f4cabc75872f54d7624e894eb7d5f0ec1e79207a360325a35b221dcbbb4917483245bd0fc81cd44e68d9c56cae6090ccad114c03bb59d72f384bbf53b47cfa3e5311ed6e07749e1556a7f10fc619796ffb5700531b9545211834fde064412938f9e28f71db869e98fa6e9055971163d4e566ce2af372627d2cfc2014ce2f01cf99376fc0ca68055b044f20dc44164295c4cca4e3f254656e111689a9a1a385a40f7bbe019c0163e57230ec6c4ac84c4c5255808ced263d77400f8a5a40d58c9e21a9c5e4532ce9de29a7a61a82e2483629651c166be92db5d06ce9ac52dcdea7eba263eab96ecbea5a4e425bbc494c38a0b8a083c5544d3069da1467ba71ee7da468d116d84d14bb09cdcc4560d9dca9f7c345594d33631d362f2ded2cc578b620bf35d5c6474d176bffe21c2cd7086e99a1b08aeb4eb4e9368b9ae356839ca8bf7b06766d97fbf7924d108223198dc2fe2f56a37dacdc4ad68b14a4750724c20e1a742d962346aaf564889cd2ebc77d8296311096e3427f7324eb0729bfb1d454052bafa82e841bde30c2821776a09df6c7aff452b6dc67960034e6de83aa2042542d460ba93726f43a02b36d4a77356b1378496962b8bb46b953db07aaa14c3a9305c75c3da6ab9d5ac91aea9c07d76fa1e6de21acfc4410fdf8755665ca307883c89fcb95ec885ea9641ce9d487158ef8b3027e9800b170a524129903b1a8c313fb49c1e29ba6fc5095123274de36bda8f7ea8eb08027f9ba5da97fc72277bc598a8de9ef02d3667847f9acb9367decee12ee5ad83c65ea4bbe66cb3ff9a3ad19c635bcecb98ace383679464769a561907e093dd67a3b7964ea2a772f5cb6d450bd7c34a1b01361530235a5bf6d43516cc89f04e6791a60e5e3a42b1ab201785b778f1f91040ca1c1c61c28141735bf284015f4fefbd29ed80babb8a054bc6a70dc3c155899698026d213920fe1b4bb54c176193b75f885f352f93a07816aace77dfd1211039a65fb26ff61bbf022ed46c8d6a5a6afdb8cb59b2c72f8c56e656f574d38ab0af5c367dd427338004c1e7fe01beb470d6357350a1eecabe429122a490583fb8d3639e70dcb5da30ef2bcc0526cd4ecb8dae2ac6b169e092ee5a3e70cf971d133ad0580f76f06c5b33ac5d2cdcbe332c068c780b32e86f5a8eccef7d3045690f30fe039e3d95f7257683e952b302f7222c2c86666879864b43450bc29e0780fb9ae082795edd79273c67a2508635f3161e50f0ac3401d0035e983ad176fb3b037957b4377e490b277f63fcf91645f093103e256d929d7a7584d4af2375a28f5fa1fc615c628a106426608234a021c86c35d222a035ea5db938c6d72b997f6a36f9a71f872eb8aef903929a71d659f74edd65c91c4f1fbd49e2085c407a31662d0ac6a06096e7efeb29ced1da8eb5e5c47987c534ca9f63d681dc25dc9fadfc7f6cbf7695d5445f8200091f3ad3e4f18dd4dc6f8f6562e12c046e83db0d6d034dc9f0a1a4c9a5a7589257784f7956cb2cb4a9291278f2c6857941dad5050a868ddc3d07b40b2e6fb486476eda505ba6f5d415b3cf8e21cff1f99281e5acb60c95109ca7e15eabb06894dbf33411bcbdfc36a4baa742f83f0ce5ec0b6b2b90946664ca4891f6775ea4903d9b0793e4867559c47d618680609cfb4daee07bb3a7c29b4ac29067bbadf3869f5d9f71de612e0aedfd5c4bc62ba54499023915030544c4c76c58ded8dc68600de0d1174a2cbcb05dc0ff1a5bc2b7651c4ad6c7ce2b002d1e0cbc5931767e951a574d2176a597cd9a2d60d16a9b26076594b844d7b3dfcb9b0a10cdec1ec2c6b6ef0e1168f9c15deea87088f60f7e9d3e82e641685203d13f288f9d8a7a2a5dc4121488556533ece3647386a5e38edd3786e9e579eef3d18a0d4c066deb2ac4b9b124dd194743ad7638c8af349d6e30222a1bd0a46e96f8df8189d62e7c4926c10928312db53ee517475f3e737bbcf0ef5974357e0908ce515aefe385e682950c7486bcccf62cca87ec21493e169826dbb4edf448a06c3e22f4c0222ab9abe1090091c96e66bb9b19551c81f67dab28ecf1767f58f93bc979e255c71900f8d121a254d38e51b4e73415a7e926a75ee4d201f225fc5869d6b3611711c344b1e5ebc60dfb632ece688dd316d5d43c2b93b5825b7827f2bef3fcabe27039be4f5e1d713d84850f0ac772519ce895b3e54e0dad45d829afc6179af7eb8c39f034904d10776de256cc9fd69246f71a05667a32492629f8614e93f833a4213732c0ac55bf5515e1a7f7c98c1482e7e99f11148928f0ecea9d8b03d4cb7720cae7018e6a2b98997447c0a0c03951ac08f790f546c9eb8deff5e80cbeb9a56dbb3ae48a881316a8a15c7a9100bdb9823ef4337157ab1f2eec60739cd9a5e1f82b5d18983953e1990d80bdaabb24a01e23669299b35b44fb8e8a4cccb94af89ae6332253e0d3d02e92f8527fe976d046e7bd42570e6f6e116796a413a585ab6d8023e926f979aa722b1a342f78369d55c8a195f5b5ec0aff4aa6e783eacfa5b71643e5d4152d170bf5b71fb6394f06e06ada4f3cf566893bd82e052e6d4852ad0252a340c107c0e19bb6862a263e01ea3293bc652e2ca726ca1598270878aac65104370416f6da685542ca18622e5af86de51b5282ee9c8e8bf0236ad582339bd323438d789b08ecffec64fb1a3934bfd9ca</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> test </tag>
            
            <tag> 网络流 </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> 二分 </tag>
            
            <tag> 容斥 </tag>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最小圆覆盖</title>
      <link href="/2022/01/20/%E6%9C%80%E5%B0%8F%E5%9C%86%E8%A6%86%E7%9B%96/"/>
      <url>/2022/01/20/%E6%9C%80%E5%B0%8F%E5%9C%86%E8%A6%86%E7%9B%96/</url>
      
        <content type="html"><![CDATA[<p> 玄学 $O(n)$ </p><span id="more"></span><h1 id="最小圆覆盖"><a href="#最小圆覆盖" class="headerlink" title="最小圆覆盖"></a>最小圆覆盖</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>给出 $n$ 个点，让你画一个最小的包含所有点的圆</p><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><ol><li><p>最小覆盖圆是唯一的</p><p>简证：若存在两个不同的最小覆盖圆，则点一定都在两圆交集内，以相交弦为直径的圆也覆盖所有点且直径更小，矛盾</p></li><li><p>若点 $p$ 不在点集 $S$ 的最小覆盖圆内（包括边上），则 $p$ 一定在点集 $\{p\} \vee S$ 的最小覆盖圆的边上</p><p>简证：先画一个很大的圆 $P_1$ 包括 $\{p\} \vee S$ ，然后在保证包括 $S$ 的前提下把圆缩小至不能再缩小，此时圆 $P_2$  就是 $S$ 的最小覆盖圆，因为 $p \not\in P_2, p \in P_1$ ，所以在缩小过程中必然有一个圆 $P_3$ 使得 $p$ 在其边上，当圆的半径小于 $P_3$ 时， $p$ 就到圆外了，所以 $P_3$ 就是 $\{p\} \vee S$ 的最小覆盖圆</p></li><li><p>最后得到的最小覆盖圆的边上一定要么至少有三个点，要么只有两个点且两点连线为圆的直径</p><p> 简证：如果圆上只有一个点，则圆无法确定，肯定可以通过平移加缩小找到一个更小的圆包住所有点，与最小不符，而三个点或一条直径确定了一个圆</p></li></ol><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>现在有了如上性质，我们考虑如何求出最小覆盖圆</p><p>由性质 $3$ ，我们考虑如何求出圆上的三个点，具体地：</p><ol><li>先将点随机化，先让第一个点作为一个“圆”</li><li>枚举 $i$ 从 $2$ 到 $n$ ，如果点 $i$ 在当前圆内（包括边）就继续；如果不在，进入步骤 $3$ </li><li>由性质 $2$ ， $i$ 一定在点 $1 \sim i$ 的最小覆盖圆边上，所以我们先将圆改成点 $i$ ，然后进入步骤 $4$ </li><li>枚举 $j : 1 \to i - 1$ ，如果点 $j$ 在当圆内（包括边）就继续；如果不在，将圆改成以点 $i, j$ 为直径的圆，进入步骤 $5$ </li><li>枚举 $k : 1 \to j - 1$ ，如果点 $k$ 在当圆内（包括边）就继续；如果不在，将圆改成以点 $i, j, k$ 确定的圆</li></ol><h2 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h2><p>看似有三层循环，时间为 $O(n^3)$ ，但我们进入下一层循环是有条件的，即该点不在圆上，而由性质 $1$ ，最小覆盖圆唯一的，又因为三个点确定一个圆，所以在这个圆被确定前，每个点有 $\frac{3}{n}$ 的几率是在最小覆盖圆的边上的，这也是进入下一层的条件，所以二、三层的时间复杂度为 $O(n) * \frac{3}{n} = O(3)$ ，故总时间为 $(n) * O(3) * O(3) = O(n)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P1742">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB PI = <span class="built_in">acos</span>(<span class="number">-1</span>), eps = <span class="number">1e-12</span>;</span><br><span class="line">DRG e&#123;<span class="number">20051221</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> + (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">const</span> DB &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x * t, y * t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    DB <span class="keyword">operator</span> * (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x * t.y - y * t.x;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> / (<span class="keyword">const</span> DB &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x / t, y / t&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Point p;</span><br><span class="line">    DB r;   </span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">rotate</span><span class="params">(Point x, DB th)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x * <span class="built_in">cos</span>(th) + x.y * <span class="built_in">sin</span>(th), -x.x * <span class="built_in">sin</span>(th) + x.y * <span class="built_in">cos</span>(th)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">dist</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point t = x - y;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(t.x * t.x + t.y * t.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB t = (v * (p - q)) / (u * v);</span><br><span class="line">    <span class="keyword">return</span> p + u * t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pair&lt;Point, Point&gt; <span class="title">get_line</span><span class="params">(Point x, Point y)</span> <span class="comment">//找中垂线</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;(x + y) / <span class="number">2</span>, <span class="built_in">rotate</span>(y - x, PI / <span class="number">2</span>)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Circle <span class="title">get_c</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> u = <span class="built_in">get_line</span>(x, y), v = <span class="built_in">get_line</span>(x, z);</span><br><span class="line">    <span class="keyword">auto</span> p = <span class="built_in">jiao</span>(u.first, u.second, v.first, v.second);</span><br><span class="line">    <span class="keyword">return</span> &#123;p, <span class="built_in">dist</span>(p, x)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    STC Point q[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">    <span class="built_in">shuffle</span>(q, q + n, e);</span><br><span class="line">    <span class="function">Circle <span class="title">c</span><span class="params">(&#123;q[<span class="number">0</span>], <span class="number">0</span>&#125;)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">cmp</span>(c.r, <span class="built_in">dist</span>(c.p, q[i])) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            c = &#123;q[i], <span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">cmp</span>(c.r, <span class="built_in">dist</span>(c.p, q[j])) &lt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    c = &#123;(q[i] + q[j]) / <span class="number">2</span>, <span class="built_in">dist</span>(q[i], q[j]) / <span class="number">2</span>&#125;;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; j; ++k)</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">cmp</span>(c.r, <span class="built_in">dist</span>(c.p, q[k])) &lt; <span class="number">0</span>)</span><br><span class="line">                            c = <span class="built_in">get_c</span>(q[i], q[j], q[k]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10lf\n&quot;</span>, c.r);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10lf %.10lf\n&quot;</span>, c.p.x, c.p.y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 最小圆覆盖 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1423K Lonely Numbers</title>
      <link href="/2022/01/19/CF1423K-Lonely-Numbers/"/>
      <url>/2022/01/19/CF1423K-Lonely-Numbers/</url>
      
        <content type="html"><![CDATA[<p> 继续在CF刷水题</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1423/K">Lonely Numbers</a></p><p>感觉像数学问题，管他那么多先乱推一波：</p><p>对于数 $a, b$ 设 $c = \gcd(a, b), a = cd, b = ce$ ，则 $a, b$ 为“友好数”，当且仅当 $c, d, e$ 能够构成三角形</p><p>把 $1$ 特判，不妨设 $b &gt; a \ge 2$ ，则 $c + d \ge cd = a$ ，所以……额……好像不对</p><p>看样例，发现“孤独数”好像都是质数，再换个方向：</p><p>考虑数 $a$ ，设其最小质因数为 $q$ ，考虑 $a + q$ 是离它最近的比它大的“友好数”的条件：</p><ul><li>首先 $\gcd(a, a + q) = q$ 且 $\frac{a}{q} + q &gt; \frac{a + q}{q}, \frac{a + q}{q} + q &gt; \frac{a}{q}$ ，现在问题是何时 $\frac{2a + q}{q} &gt; q$ </li><li>若 $a$ 是合数，则 $a \ge q^2$ ，成立</li><li>若 $a$ 是质数，这显然不成立，但我们发现 $a^2$ 是比 $a$ 大的第一个“友好数”</li></ul><p>综上，若 $a$ 是合数且最小质因数为 $q$ ，则 $a + q$ 是大于 $a$ 的第一个“友好数”；若 $a$ 是质数，则 $a^2$ 是大于 $a$ 的第一个“友好数”；若 $a = 1$ ，则 $a$ 没有“友好数”</p><p>然而 $T, n \le 10^6$ 直接 $O(nT)$ 暴力必炸</p><p>还是考虑样例为什么只有质数没有合数，或者说，可否证明小于 $n$ 的合数在 $n$ 以内必有“友好数”</p><p>首先 $a + q \le n$ 的情况下明显成立，考虑 $a + q &gt; n$ ，由上面可得，此时 $n$ 以内没有比 $a$ 大的“友好数”，不妨考虑 $a - q$ ：</p><ul><li> $\frac{a - q}{q} + q &gt; \frac{a}{q}$ 成立当且仅当 $q^2 &gt; q$ ，即 $q &gt; 1$ ，显然成立</li><li> $\frac{a}{q} + q &gt; \frac{a - q}{q}$ ，显然成立</li><li> $\frac{2a - q}{q} &gt; q$ ，因为 $a \ge q^2$ 所以成立</li></ul><p>于是，对与合数， $a - q$ 是小于 $a$ 的第一个“友好数”</p><p>那么，现在，我们要证明对于 $a \le n &lt; a + q$ ，必有 $1 \le a - q$ ，因为 $a$ 是合数，这显然成立</p><p>于是，我们得到 $n$ 以内的“孤独数”判定方法：对应合数，它一定不是“孤独数”；对于质数，只要它的平方小于 $n$ 它就不是“孤独数”，否则就是“孤独数”</p><p>那么就很显然了，预处理出质数个数的前缀和，答案就是 <code>sum[n] - sum[sqrt(n)] + 1</code> （ $1$ 本身单独算）</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> prime[N], cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> v[N], sum[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!v[i])</span><br><span class="line">            prime[++cnt] = v[i] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; prime[j] * i &lt; N; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (prime[j] &gt; v[i])</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            v[prime[j] * i] = prime[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + (v[i] == i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="keyword">int</span> T, n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum[n] - sum[(<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n)] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 素数 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>凸包与半平面交</title>
      <link href="/2022/01/19/%E5%87%B8%E5%8C%85%E4%B8%8E%E5%8D%8A%E5%B9%B3%E9%9D%A2%E4%BA%A4/"/>
      <url>/2022/01/19/%E5%87%B8%E5%8C%85%E4%B8%8E%E5%8D%8A%E5%B9%B3%E9%9D%A2%E4%BA%A4/</url>
      
        <content type="html"><![CDATA[<p> 相似的算法</p><span id="more"></span><h1 id="凸包与半平面交"><a href="#凸包与半平面交" class="headerlink" title="凸包与半平面交"></a>凸包与半平面交</h1><h2 id="问题引入"><a href="#问题引入" class="headerlink" title="问题引入"></a>问题引入</h2><p>给定共面的 $n$ 个点，求一个周长最小的凸多边形，使得所有点都在这个多边形边上和内部，这个凸多边形被称为<strong>凸包</strong></p><h2 id="Andrew算法"><a href="#Andrew算法" class="headerlink" title="Andrew算法"></a>Andrew算法</h2><p>解决这个问题有多个算法，这里介绍Andrew算法，其流程如下：</p><ol><li>将所有点按 $x$ 为第一关键字排序</li><li>先考虑上凸包，具体地：<ul><li>维护一个栈，前两个点无条件入栈（第一个点定在凸包上）</li><li>考虑栈顶元素和它的上一个点所在直线，如果当前点在直线上方，就弹出栈顶，加入当前点</li><li>当前点变成下一个点</li></ul></li><li>然后再反过来做一遍，维护下凸包，只需将上面的“直线上方”改成“直线下方”即可，注意一定要再扫一次第一个点</li><li>最后，注意特判所有点共线的情况</li></ol><p>时间瓶颈在排序上，为 $O(n \log n)$ </p><h2 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h2><p>板子题</p><p><a href="https://www.luogu.com.cn/problem/P2742">围住奶牛</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">DB <span class="title">dist</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point t = x - y;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(t.x * t.x + t.y * t.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cross</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">andrew</span><span class="params">(Point x[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> stk[N];</span><br><span class="line">    STC <span class="keyword">bool</span> used[N];</span><br><span class="line">    <span class="built_in">sort</span>(x, x + n);</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]) &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 凸包边界上的点即使被从栈中删掉，也不能删掉used上的标记</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]))</span><br><span class="line">                --top;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                used[stk[top--]] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        stk[++top] = i;</span><br><span class="line">        used[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    used[<span class="number">0</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//为了应对所有点共线的情况,这里不能取&lt;=</span></span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]) &lt; <span class="number">0</span>)</span><br><span class="line">            top -- ;</span><br><span class="line">        stk[++top] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= top; ++i)</span><br><span class="line">        res += <span class="built_in">dist</span>(x[stk[i - <span class="number">1</span>]], x[stk[i]]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC Point q[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, <span class="built_in">andrew</span>(q));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h2><p>几乎板子题……</p><p><a href="https://www.luogu.com.cn/problem/P3829">信用卡凸包</a></p><p>首先，如果信用卡是矩形，显然把所有顶点记下来求凸包即可</p><p>而对于四个角是圆的情况，每一个信用卡可以看成四个圆，我们现在要对这些圆求凸包</p><p>把凸包分成两部分，一部分是直线，一部分是曲线</p><p>曲线部分恰好是一个圆（凸多边形外交和为 $360$ ），而直线部分等于是求圆心的凸包</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;, dy[] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x == t.x ? y &lt; t.y : x &lt; t.x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function">DB <span class="title">dist</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point t = x - y;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(t.x * t.x + t.y * t.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cross</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">rotate</span><span class="params">(Point x, DB th)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;x.x * <span class="built_in">cos</span>(th) + x.y * <span class="built_in">sin</span>(th), -x.x * <span class="built_in">sin</span>(th) + x.y * <span class="built_in">cos</span>(th)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">andrew</span><span class="params">(Point x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> stk[N];</span><br><span class="line">    STC <span class="keyword">bool</span> used[N];</span><br><span class="line">    <span class="built_in">sort</span>(x, x + len);</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, t; i &lt; len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]) &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 凸包边界上的点即使被从栈中删掉，也不能删掉used上的标记</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]))</span><br><span class="line">                --top;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                used[stk[top--]] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        stk[++top] = i;</span><br><span class="line">        used[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    used[<span class="number">0</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//为了应对所有点共线的情况,这里不能取&lt;=</span></span><br><span class="line">        <span class="keyword">while</span> (top &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">area</span>(x[stk[top - <span class="number">1</span>]], x[stk[top]], x[i]) &lt; <span class="number">0</span>)</span><br><span class="line">            top -- ;</span><br><span class="line">        stk[++top] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= top; ++i)</span><br><span class="line">        res += <span class="built_in">dist</span>(x[stk[i - <span class="number">1</span>]], x[stk[i]]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC Point q[N];</span><br><span class="line">    DB a, b, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %lf %lf %lf&quot;</span>, &amp;n, &amp;a, &amp;b, &amp;r);</span><br><span class="line">    a = a / <span class="number">2</span> - r, b = b / <span class="number">2</span> - r;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">    &#123;</span><br><span class="line">        DB x, y, z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            Point t = <span class="built_in">rotate</span>(&#123;dx[i] * b, dy[i] * a&#125;, -z);</span><br><span class="line">            q[cnt++] = &#123;x + t.x, y + t.y&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, <span class="built_in">andrew</span>(q, cnt) + <span class="number">2</span> * pi * r);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="问题又一次引入"><a href="#问题又一次引入" class="headerlink" title="问题又一次引入"></a>问题又一次引入</h2><p>众所周知，一条直线将一个面划分成两半</p><p>给定共面的 $n$ 条直线，每条直线都将平面划分成两半，我们只取其中一半，将取的所有部分求交集，求最后的面积，这就叫<strong>半平面交</strong></p><h2 id="solve"><a href="#solve" class="headerlink" title="solve"></a>solve</h2><p>为了简化问题，我们用向量表示直线（给直线赋予方向），固定我们取向量的<strong>左边</strong>，这样，对应两条角度相同的向量（就是直线），我们只保留左边那条，剩下的直线一定不存在角度相同的向量（即共向向量），然后：</p><ol><li>将向量按照角度排序（这里使用 <code>atan2(y, x)</code> 函数，注意是 <code>(y, x)</code> 不是 <code>(x, y)</code> ）</li><li>用双端队列维护，按顺序扫描每一个向量，如果队头/队尾向量的交点在当前向量的右边，就删掉</li><li>最后用队头更新一下队尾，用队尾跟新一下队头</li></ol><p>时间 $O(n \log n)$ </p><h2 id="例题一-1"><a href="#例题一-1" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.luogu.com.cn/problem/P4196">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> DB eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">DB x, y;</span><br><span class="line">Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Point st, ed;</span><br><span class="line"><span class="function">DB <span class="title">angle</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">atan2</span>(ed.y - st.y, ed.x - st.x);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cross</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Line &amp;x, Line &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">DB a = x.<span class="built_in">angle</span>(), b = y.<span class="built_in">angle</span>();</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">cmp</span>(a, b))</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">area</span>(x.st, x.ed, y.ed) &lt; <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> a &lt; b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">DB t = <span class="built_in">cross</span>(v, p - q) / <span class="built_in">cross</span>(u, v);</span><br><span class="line"><span class="keyword">return</span> &#123;p.x + u.x * t, p.y + u.y * t&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Line x, Line y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">jiao</span>(x.st, x.ed - x.st, y.st, y.ed - y.st);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">on_r</span><span class="params">(Line &amp;x, Line y, Line z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Point o = <span class="built_in">jiao</span>(y, z);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cmp</span>(<span class="built_in">area</span>(x.st, x.ed, o), <span class="number">0</span>) &lt;= <span class="number">0</span>; <span class="comment">//这里取不取等依题意</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">halfp</span><span class="params">(Line x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sort</span>(x, x + len);</span><br><span class="line"><span class="keyword">int</span> hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">STC <span class="keyword">int</span> q[N];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i &amp;&amp; !<span class="built_in">cmp</span>(x[i].<span class="built_in">angle</span>(), x[i - <span class="number">1</span>].<span class="built_in">angle</span>()))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[i], x[q[tt - <span class="number">1</span>]], x[q[tt]]))</span><br><span class="line">--tt;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[i], x[q[hh + <span class="number">1</span>]], x[q[hh]]))</span><br><span class="line">++hh;</span><br><span class="line">q[++tt] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[q[hh]], x[q[tt - <span class="number">1</span>]], x[q[tt]]))</span><br><span class="line">--tt;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[q[tt]], x[q[hh + <span class="number">1</span>]], x[q[hh]]))</span><br><span class="line">++hh;</span><br><span class="line">q[++tt] = q[hh];</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = hh; i &lt; tt; ++i)</span><br><span class="line">        ans[k++] = <span class="built_in">jiao</span>(x[q[i]], x[q[i + <span class="number">1</span>]]);</span><br><span class="line">   DB res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + <span class="number">1</span> &lt; k; ++i)</span><br><span class="line">        res += <span class="built_in">area</span>(ans[<span class="number">0</span>], ans[i], ans[i + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> res / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, m, cnt = <span class="number">0</span>;</span><br><span class="line">STC Line l[N];</span><br><span class="line">STC Point pg[N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span> (n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;pg[i].x, &amp;pg[i].y);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">l[cnt++] = &#123;pg[i], pg[(i + <span class="number">1</span>) % m]&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, <span class="built_in">halfp</span>(l, cnt));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二-1"><a href="#例题二-1" class="headerlink" title="例题二"></a>例题二</h2><p><a href="https://www.luogu.com.cn/problem/P3256">赛车</a></p><p>有点卡精度</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LD eps = <span class="number">1e-18</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">LD x, y;</span><br><span class="line">Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; ;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">Point st, ed;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; id;</span><br><span class="line"><span class="function">LD <span class="title">angle</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">atan2</span>(ed.y - st.y, ed.x - st.x);</span><br><span class="line">&#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(LD x, LD y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LD <span class="title">cross</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LD <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Line &amp;x, Line &amp;y)</span><br><span class="line">&#123;</span><br><span class="line">LD a = x.<span class="built_in">angle</span>(), b = y.<span class="built_in">angle</span>();</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">cmp</span>(a, b))</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">area</span>(x.st, x.ed, y.ed) &lt; <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> a &lt; b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LD t = <span class="built_in">cross</span>(v, p - q) / <span class="built_in">cross</span>(u, v);</span><br><span class="line"><span class="keyword">return</span> &#123;p.x + u.x * t, p.y + u.y * t&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Line x, Line y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">jiao</span>(x.st, x.ed - x.st, y.st, y.ed - y.st);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">on_r</span><span class="params">(Line &amp;x, Line y, Line z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Point o = <span class="built_in">jiao</span>(y, z);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cmp</span>(<span class="built_in">area</span>(x.st, x.ed, o), <span class="number">0</span>) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">halfp</span><span class="params">(Line x[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sort</span>(x, x + len);</span><br><span class="line"><span class="keyword">int</span> hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">STC <span class="keyword">int</span> q[N];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i &amp;&amp; !<span class="built_in">cmp</span>(x[i].<span class="built_in">angle</span>(), x[i - <span class="number">1</span>].<span class="built_in">angle</span>()))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[i], x[q[tt - <span class="number">1</span>]], x[q[tt]]))</span><br><span class="line">--tt;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[i], x[q[hh + <span class="number">1</span>]], x[q[hh]]))</span><br><span class="line">++hh;</span><br><span class="line">q[++tt] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[q[hh]], x[q[tt - <span class="number">1</span>]], x[q[tt]]))</span><br><span class="line">--tt;</span><br><span class="line"><span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">on_r</span>(x[q[tt]], x[q[hh + <span class="number">1</span>]], x[q[hh]]))</span><br><span class="line">++hh;</span><br><span class="line">q[++tt] = q[hh];</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = hh; i &lt;= tt; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> id : x[q[i]].id)</span><br><span class="line">        ans[k++] = id;</span><br><span class="line">   <span class="built_in">sort</span>(ans, ans + k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">map&lt;PII, vector&lt;<span class="keyword">int</span>&gt; &gt; ids;</span><br><span class="line"><span class="keyword">int</span> n, cnt = <span class="number">0</span>;</span><br><span class="line">STC Line l[N];</span><br><span class="line">STC <span class="keyword">int</span> ki[N], vi[N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ki[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;vi[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">ids[&#123;ki[i], vi[i]&#125;].<span class="built_in">push_back</span>(i);</span><br><span class="line">l[cnt++] = &#123;&#123;<span class="number">0</span>, N&#125;, &#123;<span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">l[cnt++] = &#123;&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, &#123;N, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i : ids) <span class="comment">//简直毒瘤的map遍历</span></span><br><span class="line">        l[cnt++] = &#123;&#123;<span class="number">0</span>, i.first.first&#125;, &#123;<span class="number">1</span>, i.first.first + i.first.second&#125;, i.second&#125;;</span><br><span class="line"><span class="built_in">halfp</span>(l, cnt);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
            <tag> 凸包 </tag>
            
            <tag> 半平面交 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算几何基础知识</title>
      <link href="/2022/01/19/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/01/19/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p> “这不显然吗”</p><span id="more"></span><h1 id="计算几何基础知识"><a href="#计算几何基础知识" class="headerlink" title="计算几何基础知识"></a>计算几何基础知识</h1><h2 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h2><ol><li><p>$\pi = \arccos(-1)$ </p></li><li><p>余弦定理：$\triangle ABC$ 中 $c^2 = a^2 + b^2 - 2 a b \cos C$ </p></li><li><p>浮点数比较：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>判断一个浮点数的符号就是 <code>cmp(x, 0)</code> </p></li></ol><h2 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h2><p>如果不清楚可以看<a href="https://baike.baidu.com/item/%E5%90%91%E9%87%8F/1396519">这个</a></p><ol><li><p>向量的表示：一般用点 $(x, y)$ 表示向量 $(0, 0) \to (x, y)$ （把起点平移到原点）</p></li><li><p>加减法：已知 $\vec{a} = (x_a, y_a), \vec{b} = (x_b, y_b)$ ，则有 $\vec{a} \pm \vec{b} = (x_a \pm x_b, y_a \pm y_b)$ ，其几何意义就是平行四边形定则</p></li><li><p>数乘：已知 $\vec{a} = (x, y)$ 和标量 $b$ ，则 $b\vec{a} = (bx, by)$ </p></li><li><p>模：向量的长度，定义为已知 $\vec{a} = (x, y)$ ，则模为 $|\vec{a}| = \sqrt{x^2 + y^2}$ ，模长是<strong>标量</strong>，代码中模长用内积来求</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">mo</span><span class="params">(Point x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(x &amp; x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>内积（点积）：一个向量在另一个向量上的投影长度乘上另一个向量的长度，即已知 $\vec{a} = (x_a, y_a), \vec{b} = (x_b, y_b)$ ，则 $\vec{a} \cdot \vec{b} = |a| |b| \cos&lt;\vec{a}, \vec{b}&gt; = x_a x_b + y_a y_b$ ，是<strong>标量</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> <span class="keyword">operator</span> &amp; (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.x + x.y * y.y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>外积（叉积）：两个向量围成的平行四边形面积，定义为 $\vec{a} \times \vec{b} = |a| |b| \sin&lt;\vec{a}, \vec{b}&gt;$ ，是<strong>向量</strong>，方向用右手定则判定，四指从始向量指向末向量，大拇指朝上（朝自己）是正</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> <span class="keyword">operator</span> * (Point x, Point y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>计算向量夹角</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">acos</span>((x &amp; x) / <span class="built_in">mo</span>(x) / <span class="built_in">mo</span>(y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>向量（点）顺时针旋转角度：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Point <span class="title">rot</span><span class="params">(Point x, <span class="keyword">double</span> theta)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> &#123;x.x * <span class="built_in">cos</span>(theta) + x.y * <span class="built_in">sin</span>(theta), -x.x * <span class="built_in">sin</span>(theta) + x.y * <span class="built_in">cos</span>(theta)&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>计算向量 $\vec{AB}, \vec{AC}$ 围成的平行四边形面积：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="点与线"><a href="#点与线" class="headerlink" title="点与线"></a>点与线</h2><p>注意下面的 <code>Point</code> 有些表示点，有些表示向量</p><ol><li><p>直线的表示：</p><ul><li>一般式： $l : Ax + By + C = 0$ </li><li>斜截式： $l : y = kx + b$ </li><li>点向式： $l: p_0 + t\vec{v}$ </li><li>两点式：不多说，两点定一条直线</li></ul><p>一般使用点向式或两点式</p></li><li><p>判断点于直线关系： </p><p>设点 $C$ 与直线 $AB$ ，令 $\vec{v} = \vec{AB} \times \vec{AC}$ </p><ul><li><p>左侧： $\vec{v} &gt; 0$ </p></li><li><p>右侧： $\vec{v} &lt; 0$ </p></li><li><p>线上： $\vec{v} = 0$ </p></li></ul></li><li><p>直线交点，直接上代码了，证明可以考虑平移至共起点后用几何意义：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Point <span class="title">jiao</span><span class="params">(Point p, Point u, Point q, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u * v == <span class="number">0</span>) <span class="comment">//平行或者重合</span></span><br><span class="line">        <span class="keyword">return</span> &#123;INF, INF&#125;;</span><br><span class="line">    <span class="keyword">double</span> t = (p - q) * v / (u * w);</span><br><span class="line">    <span class="keyword">return</span> p + u * t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>点到直线距离：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dis_z</span><span class="params">(Point p, Point x, Point y)</span> <span class="comment">//p到直线(x-&gt;y)的距离</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point u = y - x, v = p - x;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>((u * v) / <span class="built_in">mo</span>(u));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>点到线段的距离：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dis_x</span><span class="params">(Point p, Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == y)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">mo</span>(p - x);</span><br><span class="line">    Point u = y - x, v = p - x, w = p - y;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(u &amp; v, <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">mo</span>(v);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmp</span>(u &amp; w, <span class="number">0</span>) &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">mo</span>(w);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dis_z</span>(p, x, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>点在直线上的投影：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">proj</span><span class="params">(Point p, Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point u = y - x;</span><br><span class="line">    <span class="keyword">return</span> x + u * (u &amp; (p - x)) / (u &amp; u));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>判断点是否在直线上：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_on</span><span class="params">(Point p, Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">cmp</span>((p - x) * (p - y), <span class="number">0</span>) &amp;&amp; <span class="built_in">cmp</span>((p - x) &amp; (p - y), <span class="number">0</span>) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>判断两线段是否相交：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_jiao</span><span class="params">(Point x_1, Point y_1, Point x_2, Point y_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> c1 = <span class="built_in">cross</span>(y_1 - x_1, x_2 - x_1), c2 = <span class="built_in">cross</span>(y_1 - x_1, y_2 - x_1);</span><br><span class="line">    <span class="keyword">double</span> c3 = <span class="built_in">cross</span>(y_2 - x_2, y_1 - x_2), c4 = <span class="built_in">cross</span>(y_2 - x_2, x_1 - x_2);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cmp</span>(c1, <span class="number">0</span>) * <span class="built_in">cmp</span>(c2, <span class="number">0</span>) &lt;= <span class="number">0</span> &amp;&amp; <span class="built_in">cmp</span>(c3, <span class="number">0</span>) * <span class="built_in">cmp</span>(c4, <span class="number">0</span>) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="三角形"><a href="#三角形" class="headerlink" title="三角形"></a>三角形</h2><ol><li><p>海伦公式</p></li><li><p>四心：</p><ul><li>外心，外接圆圆心，三边中垂线交点，到三角形三个顶点的距离相等</li><li>内心，内切圆圆心，角平分线交点，到三边距离相等</li><li>垂心，三条垂线交点</li><li>重心，三条中线交点（到三角形三顶点距离的平方和最小的点，三角形内到三边距离之积最大的点）</li></ul></li></ol><h2 id="多边形"><a href="#多边形" class="headerlink" title="多边形"></a>多边形</h2><p>通常按<strong>逆时针</strong>存储所有点</p><ol><li><p>凸多边形：</p><p>过多边形的任意一边做一条直线，如果其他各个顶点都在这条直线的同侧，则把这个多边形叫做凸多边形，任意凸多边形外角和均为 $360$ 度，任意凸多边形内角和为 $(n−2) 180$ 度</p></li><li><p>求多边形面积（不一定是凸多边形）：</p><p>考虑在平面上任取一原点（一般取第一个点），对于边每条边 $AB$ （逆时针储存），计算 $\vec{OA} \times \vec{OB}$ （注意外积是有向的），求和即可，可画图理解</p><p><img src="https://s2.loli.net/2022/01/23/eVKYgLw2japn6dU.png" alt="area"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">pgarea</span><span class="params">(Point p[], <span class="keyword">int</span> n)</span> <span class="comment">//polygon area</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n - <span class="number">1</span>; ++i) <span class="comment">//这里点编号为0~n-1</span></span><br><span class="line">    res += (p[i] - p[<span class="number">0</span>]) * (p[i + <span class="number">1</span>] - p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> res / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>判断点是否在多边形内（不一定是凸多边形）：</p><ul><li>射线法，从该点任意做一条和所有边都不平行的射线，交点个数为偶数，则在多边形外，为奇数，则在多边形内</li><li>转角法</li></ul></li><li><p>判断点是否在凸多边形内，只需判断点是否在所有边的左边（逆时针存储多边形）</p></li><li><p>皮克定理：</p><p>皮克定理是指，一个计算点阵中<strong>顶点在格点上</strong>的多边形面积公式，该公式可以表示为 $S = a + \frac{b}{2} - 1$ ，其中 $a$ 表示多边形内部的点数， $b$ 表示多边形边界上的点数， $S$ 表示多边形的面积</p></li></ol><h2 id="圆"><a href="#圆" class="headerlink" title="圆"></a>圆</h2><p>解方程即可</p><h2 id="三维"><a href="#三维" class="headerlink" title="三维"></a>三维</h2><ol><li><p>三维的向量表示 $(x, y, z)$ </p></li><li><p> 三维向量的加减法、数乘运算、点积运算，都与二维的相同，直接套</p></li><li><p>向量的模 $|\vec{V}| = \sqrt{x^2 + y^2 + z^2}$ </p></li><li><p>叉积： $\vec{a} \times \vec{b}$ 是一个即垂直于 $\vec{a}$ 也垂直于 $\vec{b}$ 的向量，方向也用右手定则，代数式为 $\vec{a} \times \vec{b} = (y_az_b - y_bz_a, x_bz_a - x_az_b, x_ay_b - x_by_a)$ </p></li><li><p>求法向量：</p><p>根据叉积的性质，在平面里找两个不共线的向量，求他俩的叉积就是平面的法向量</p></li><li><p>判定点是否在平面上：</p><p>先求出法向量 $n$ ，然后在平面里任取一点 $p$ ，判断 $(p \to x) * n$ 若为 $0$ 即在平面里</p></li><li><p>求点到平面的距离：</p><p>先求出法向量 $n$ ，然后在平面里任取一点 $p$ ， $(p \to x)$ 在 $n$ 上的投影即为距离</p><p> $D = \frac{\vec{px} * \vec{n}}{|n|}$ </p></li><li><p>多面题欧拉定理：</p><p>多面体的顶点数 - 棱长数 + 表面数 = $2$ </p></li></ol><h2 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.acwing.com/problem/content/2986/">玩具</a></p><p>很简单的例题，直接二分每个点在那两个向量之间即可</p><p>判断点是否在直线左侧即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; a[N], b[N];</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function">LL <span class="title">cross</span><span class="params">(Point u, Point v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (LL)u.x * v.y - (LL)v.x * u.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = n, res = n;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">area</span>(b[mid], a[mid], &#123;x, y&#125;) &gt; <span class="number">0</span>)</span><br><span class="line">            res = mid, r = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> f = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x_1, y_1, x_2, y_2;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>, &amp;m, &amp;x_1, &amp;y_1, &amp;x_2, &amp;y_2);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, u, v; i &lt; n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">            a[i] = &#123;u, y_1&#125;, b[i] = &#123;v, y_2&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        a[n] = &#123;x_2, y_1&#125;, b[n] = &#123;x_2, y_2&#125;;</span><br><span class="line">        <span class="keyword">if</span> (f)</span><br><span class="line">            f = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span> ans);</span><br><span class="line">        <span class="keyword">while</span> (m--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x, y;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            ++ans[<span class="built_in">find</span>(x, y)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d: %d\n&quot;</span>, i, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h2><p><a href="https://www.acwing.com/problem/content/2987/">线段</a></p><p>首先题目可以转化为，求一条过所有线段的直线</p><p>考虑枚举每条线段的端点，可以证明，如果存在这样的直线，必然有一条是穿过线段端点中的两个的</p><p>证明如下：</p><p>假设有一条直线符合题意，现在设其与线段 $l_1$ 的交点为 $A$ ，将直线绕 $A$ 旋转至“即将”不满足题意，此时其必过某条线段端点，再绕该端点旋转一次即可</p><p>时间复杂度 $O(Tn^3)$ 在答案为 $YES!$ 的情况下跑不满</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DB double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DB x, y;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; a[N], b[N], q[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(DB x, DB y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - y) &lt; eps)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">cross</span><span class="params">(Point x, Point y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.x * y.y - y.x * x.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">DB <span class="title">area</span><span class="params">(Point x, Point y, Point z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">cross</span>(y - x, z - x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (n &lt;&lt; <span class="number">1</span>); ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; (n &lt;&lt; <span class="number">1</span>); ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">cmp</span>(q[i].x, q[j].x) &amp;&amp; !<span class="built_in">cmp</span>(q[i].y, q[j].y))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">bool</span> f = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; ++k)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">cmp</span>(<span class="built_in">area</span>(q[i], q[j], a[k]), <span class="number">0</span>) * <span class="built_in">cmp</span>(<span class="built_in">area</span>(q[i], q[j], b[k]), <span class="number">0</span>) &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    f = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">if</span> (f)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, k = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf %lf&quot;</span>, &amp;a[i].x, &amp;a[i].y, &amp;b[i].x, &amp;b[i].y);</span><br><span class="line">            q[k++] = a[i], q[k++] = b[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">check</span>() ? <span class="built_in">puts</span>(<span class="string">&quot;Yes!&quot;</span>) : <span class="built_in">puts</span>(<span class="string">&quot;No!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 计算几何 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1466D 13th Labour of Heracles</title>
      <link href="/2022/01/19/CF1466D-13th-Labour-of-Heracles/"/>
      <url>/2022/01/19/CF1466D-13th-Labour-of-Heracles/</url>
      
        <content type="html"><![CDATA[<p> 希腊神话</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1466/D">13th Labour of Heracles</a></p><h2 id="文化（神话）常识"><a href="#文化（神话）常识" class="headerlink" title="文化（神话）常识"></a>文化（神话）常识</h2><p>百度来的</p><p>赫拉克勒斯（Heracles）是宙斯和阿尔克墨涅所生的儿子（而阿尔克墨涅是珀耳修斯的孙女，底比斯国王安菲特律翁的妻子，太乱了），不过不重要</p><p>关于他的经历自己看<a href="https://baike.baidu.com/item/%E8%B5%AB%E6%8B%89%E5%85%8B%E5%8B%92%E6%96%AF%E5%8D%81%E4%BA%8C%E5%8A%9F%E7%BB%A9/12653060">baidu</a>吧，跟言情小说似的，太长了</p><p>总而言之，它作为半人半神，在人间做了许许多多事，其中以他的十二个功绩为最</p><h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>又要靠我自己翻译</p><p>给定一棵 $n$ （ $n \le 2 \times 10^5$ ）个点带权树，有以下定义：</p><ul><li>我们用 $k$ 种颜色将树的<strong>边</strong>染色（<strong>可以不用尽 $k$ 种颜色</strong>），保证每条边有且只有一种颜色，我们称其为<strong>“ $k$ 染色”</strong></li><li>对于一个颜色 $x$ ，定义<strong>“ $x$ 色块”</strong>为只由颜色为 $x$ 的边和其连接的点组成的极大连通块，明显，在这种定义下，块内没有度为 $0$ 的点</li><li>一个色块的<strong>权值</strong>定义为该块中所有点的权值和（两个不同块可以包含同一个点）， $x$ 色块的权值定义为所有 $x$ 色块中最大的一个，若不存在 $x$ 色块则权值为 $0$ </li><li>对于树的一个 $k$ 染色，其权值为所有属于 $k$ 的 $x$ 色块的权值和</li></ul><p>现在，对于 $1 \sim n - 1$ 的每一个 $k$ ，要求出该树的最大 $k$ 染色权值</p><p>注意有多组数据， $T \le 10^5$  ，时限 $2.5s$ </p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>有个鬼的思路啊， $T \le 10^5, n \le 10^5$ ，读入都挂了吧！</p><p> 先假设我们读入了，考虑问题</p><p>首先对于一个最大的 $k$ 染色，它的每一个颜色一定只对应一个色块，因为有多个色块的话只取最大，必然会有点的权值被浪费</p><p>再考虑任意两个直接相连的色块，它们一定有且只有一个“割点”，这个点的权值被计算了两次，我们当然是让这个点的权值尽可能的大</p><p>考虑将点排序， $k = 1$ 时答案就是所有的和，每次加 $1$ 后就加一个当前最大点，但一个点只能被加 $deg$ 遍</p><p>然后突然发现，原来题目保证了 $\sum n \le 2 \times 10^5$ ，读入不成问题！真是纸老虎啊</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> deg, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> w == t.w ? deg &gt; t.deg : w &gt; t.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    LL ans;</span><br><span class="line">    STC Node a[N];</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i].w), ans += a[i].w, a[i].deg = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;u, &amp;v), ++a[u].deg, ++a[v].deg;</span><br><span class="line">        <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, now = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (!a[now].deg)</span><br><span class="line">                ++now;</span><br><span class="line">            --a[now].deg;</span><br><span class="line">            ans += a[now].w;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot; %lld&quot;</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 贪心 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF888C K-Dominant Character</title>
      <link href="/2022/01/19/CF888C-K-Dominant-Character/"/>
      <url>/2022/01/19/CF888C-K-Dominant-Character/</url>
      
        <content type="html"><![CDATA[<p> 888，多么吉利的数字</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/888/C">K-Dominant Character</a></p><h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>有一个由小写字母构成的字符串 $s$ （ $|s| \le 10^5$ ），当一个字符 $c$ 在 $s$ 的任意一个长度不超过 $k$ 的子串中都存在时，就称 $c$ 为 $s$ 的“k-dominant character”</p><p>现在要求一个最小的 $k$ 使得存在 $c$ 为 $s$ 的“k-dominant character”</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>看见 $10^5$ 想到 $n \log n$ ，不难想到二分 $k$ </p><p>先看一眼答案是否满足单调性（好几次没管答案单调性就白打了半天），明显如果 $c$ 是“k-dominant character”，它也一定就是“(k + 1)-dominant character”，可见答案具有单调性，可以二分</p><p>考虑如何在 $O(n)$ 的时间内判定答案</p><p><strong>等等</strong></p><p>我突然想到，字符仅由小写构成，直接暴力扫描 $26$ 个字母每个字母的位置，两两之差的最大值就是这个字母作为“k-dominant character”的最小 $k$ ，注意首尾</p><p>如对于 $s = bbababaab$ ， $a$ 的位置为 $3, 5, 7, 8$ （下标从 $1$ 开始），那么 $a$ 作为“k-dominant character”的最小 $k$ 就是 $\max(3 - 0, 5 - 3, 7 - 5, 8 - 7, |s| + 1  - 8) = 3$ </p><p>时间复杂度 $O(26 \times n) = O(n)$ </p><p>然后就AC了……diao，说好的二分呢！</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">char</span> s[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), last, ans = n, as;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> ch = <span class="string">&#x27;a&#x27;</span>; ch &lt;= <span class="string">&#x27;z&#x27;</span>; ++ch)</span><br><span class="line">    &#123;</span><br><span class="line">        last = as = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == ch)</span><br><span class="line">                as = <span class="built_in">max</span>(as, i - last), last = i;</span><br><span class="line">        &#125;</span><br><span class="line">        as = <span class="built_in">max</span>(as, n + <span class="number">1</span> - last);</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, as);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 二分 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三/四元环计数</title>
      <link href="/2022/01/09/%E4%B8%89-%E5%9B%9B%E5%85%83%E7%8E%AF%E8%AE%A1%E6%95%B0/"/>
      <url>/2022/01/09/%E4%B8%89-%E5%9B%9B%E5%85%83%E7%8E%AF%E8%AE%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p> 还是比较简单的</p><span id="more"></span><h1 id="三-四元环计数"><a href="#三-四元环计数" class="headerlink" title="三/四元环计数"></a>三/四元环计数</h1><h2 id="三元环计数"><a href="#三元环计数" class="headerlink" title="三元环计数"></a>三元环计数</h2><p>思考如下问题：</p><p>给定一个<strong>无向图</strong>，求图中有多少个环是<strong>由且仅由三个点构成的</strong>，这样的环被称为<strong>三元环</strong></p><p>暴力的办法当然是枚举每一个点 $u$ ，再枚举和它相连的点 $v$ ，再枚举和 $v$ 相连的点 $w$ ，判断 $w$ 是否和 $u$ 相连</p><p>但这样会有一个巨大的问题：一个环被算了多遍，必须想办法让一个环只被考虑一遍</p><p>考虑将边变为有向边，具体的，对于边 $(u, v), u &lt; v$ ：</p><ol><li>若 $\deg(u) = \deg(v)$ 则令 $v \to u$ </li><li>否则，让度数大的指向度数小的</li></ol><p>下面证明这样做后原图会变成一个<strong>DAG</strong>：</p><p>使用反证法，假设有一个环为 $a \to b \to … \to a$ ，则有 $\deg(a) \ge \deg(b) \ge … \ge \deg(a)$ ，明显应该 $\deg(a) = \deg(b)$ ，换句话说，这个环上的所有边都是第 $1$ 类情况，那么就有 $a &gt; b &gt; … &gt; a$ 这显然不成立</p><p>在上面的DAG中，一个三圆环显然会变成这样：<img src="https://s2.loli.net/2022/01/09/efZA16ptMNFakVw.png" alt="三元环"></p><p>此时再枚举，这个环就只会被记在红点上了</p><p>关于时间，首先我们要枚举每个点和它的出边，时间为 $O(n + m)$ ，然后，要枚举出边指向的点的出边</p><p>如此，对于第二次枚举，讨论这个点（就是红色点的出边指向的那个点）的出度：</p><ol><li>如果出度 $\le \sqrt{m}$ ，那么最多有 $n - 1$ 个点会指向它，由它会枚举的点数为就是出度，所以总的时间为 $O(n \sqrt{m})$ </li><li>如果出度 $&gt; \sqrt{m}$ ，那么指向它的边最多有 $\frac{m}{\sqrt{m}} = \sqrt{m}$ ，虽然它的出度最坏是 $m$ ，但总的时间为 $O(m\sqrt{m})$ </li></ol><p>注意在上面的讨论中，第一次枚举和第二次枚举是站在两个不同的角度计算的时间，在计算第二次枚举的时间时，第一次枚举的时间对它并没有影响，故总的时间为 $O(n + m + (n \sqrt{m} 或 m \sqrt{m})) = O(m \sqrt{m})$ </p><p>同时也可以得到，三元环的个数上界是 $m \sqrt{m}$ </p><p>代码如下 ：</p><p><a href="https://www.luogu.com.cn/problem/P1989">板子</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find3c</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            vis[e[i].ver] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                res += vis[e[j].ver];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            vis[e[i].ver] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    STC PII _e[M];</span><br><span class="line">    STC <span class="keyword">int</span> deg[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;_e[i].fi, &amp;_e[i].se);</span><br><span class="line">        <span class="keyword">if</span> (_e[i].fi &lt; _e[i].se)</span><br><span class="line">            <span class="built_in">swap</span>(_e[i].fi, _e[i].se);</span><br><span class="line">        ++deg[_e[i].fi], ++deg[_e[i].se];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_e[i].fi == _e[i].se)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (deg[_e[i].fi] &gt;= deg[_e[i].se])</span><br><span class="line">            <span class="built_in">add</span>(_e[i].fi, _e[i].se);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">add</span>(_e[i].se, _e[i].fi);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">find3c</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="四元环计数"><a href="#四元环计数" class="headerlink" title="四元环计数"></a>四元环计数</h2><p>简单的思路是将四元环分成两个形如 $u \to v \to w$ 的形式，枚举 $u$ ，然后像三元环化为DAG，一样枚举 $v, w$ ，对于 $u, w$ 记 <code>cnt[u][w]</code> 表示从 $u$ 通过一个其它点到达 $w$ 的路径数，然后对答案的贡献即为 <code>cnt[u][w] * (cnt[u][w] - 1) / 2</code> </p><p>这样当然是错误的，因为三元环是无序的，有唯一性（即三个点最多存在一个三元环，且在DAG中这个三元环的形式确定），但四元环就不是了，如图：<img src="https://s2.loli.net/2022/01/09/hNO64LyPJT1aqfK.png" alt="四元环"></p><p>同一个四元环在DAG中可能有两种表示（ $2 + 2$ 或者 $3 + 1$ ）</p><p>那如何才能不重不漏呢？考虑三元环建边时的不等式：如果存在 $u \to v$ ，则 $\deg(u) \ge \deg(v)$ ，那么，在上面两幅图中，我们发现，<strong>度数最大的是同一个点</strong>，这启发了我们</p><p><strong>我们将每个点按度数大小重新编号，度数相同原来编号大的点在前</strong>的方法，就可以通过编号直接得到任意两个点的关系</p><p>设重新编号后排名为 $rk$ ，枚举四圆环中 $rk$ 最大的点 $x$ ，再枚举 $x$ 的出点 $y$ ，枚举  $y$ 的出点 $z$ （这里直接枚举无向边，注意判断 $rk(x) &gt; rk(y) &gt; rk(z)$ ）， 这里就得到了一个长度为 $2$ 的链了，再枚举一个点 $c$ ，只要 $rk(x) &gt; rk(c)$ 就计入答案的贡献，不管 $rk(c)$ 和 $rk(z)$ 的关系</p><p>时间复杂度还是 $O(m \sqrt{m})$ </p><p>注意四元环的个数上界是 $nm\sqrt{m}$ ，可能要 <code>long long</code> </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> id[N], deg[N], rk[N];</span><br><span class="line"><span class="keyword">int</span> cnt[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = &#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">find4c</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= n; ++x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (rk[x] &gt; rk[e[i].ver])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                    <span class="keyword">if</span> (rk[x] &gt; rk[e[j].ver])</span><br><span class="line">                        res += cnt[e[j].ver]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (rk[x] &gt; rk[e[i].ver])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = h[e[i].ver]; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">                    cnt[e[i].ver] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> deg[x] == deg[y] ? x &lt; y : deg[x] &lt; deg[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>, id[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        ++deg[u], ++deg[v];</span><br><span class="line">        <span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(id + <span class="number">1</span>, id + <span class="number">1</span> + n, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        rk[id[i]] = i;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">find4c</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>以后在写，现在鸽了</p><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>啊啊啊，马上就要考期末考试了，这估计是我考前最后一次写blog了，老天保佑我别考爆炸啊！</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP3765 总统选举</title>
      <link href="/2022/01/08/luoguP3765-%E6%80%BB%E7%BB%9F%E9%80%89%E4%B8%BE/"/>
      <url>/2022/01/08/luoguP3765-%E6%80%BB%E7%BB%9F%E9%80%89%E4%B8%BE/</url>
      
        <content type="html"><![CDATA[<p> 心血来潮想写SBT了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3765">总统选举</a></p><p>想写平衡树了，所以看了道题</p><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><p>首先有一个小小的前置知识：<strong>摩尔投票法</strong></p><p>摩尔投票法用来寻找数组中<strong>出现次数超过一半的元素</strong></p><p>思想很简单，考虑每次取两个不同的数，把他们都删掉，如果有一个数出现次数超过一半的话，最后剩下的数一定都是这个数，正确性显然</p><p>具体实现可以考虑维护一个 <code>cnt</code> 和 <code>t</code> ，扫描每一个元素，若 <code>cnt = 0</code> ，则令 <code>t = x</code> ，否则 <code>cnt += (t == x ? 1 : -1)</code> ， 最后如果 <code>cnt</code> 大于 $0$ ， <code>t</code> 即是出现次数超过一半的元素</p><p>但这里有一个条件，那就是<strong>必须保证出现次数超过一半的元素存在</strong>，否则 <code>t</code>  当然就不是所求，所以我们还需要判断一下 <code>t</code> 的出现次数是否超过一半</p><h2 id="题"><a href="#题" class="headerlink" title="题"></a>题</h2><p>那么考虑这道题</p><p>由摩尔投票法，对于每个区间我们只需要维护出 <code>cnt</code> 和 <code>t</code> </p><p>考虑道维护的东西可以合并，即对于 $fa = [l, r], lc = [l, mid], rc = [mid + 1, r]$ ，有：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (v[lc] == v[rc])</span><br><span class="line">&#123;</span><br><span class="line">    v[fa] = v[lc];</span><br><span class="line">    cnt[fa] = cnt[lc] + cnt[rc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (cnt[lc] &gt;= cnt[rc])</span><br><span class="line">&#123;</span><br><span class="line">    cnt[fa] = cnt[lc] - cnt[rc];</span><br><span class="line">    v[fa] = v[lc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    cnt[fa] = cnt[rc] - cnt[lc];</span><br><span class="line">    v[fa] = v[rc];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>正确性显然</p><p>所以可以考虑用线段树维护 <code>cnt</code> 和 <code>t</code> （就是上面的 <code>v</code> ）</p><p>但是！问题来了：摩尔投票法有一个讨厌的前提——<strong>必须保证出现次数超过一半的元素存在</strong>，所以我们还要检验这个数是否真的是出现次数超过一半的数</p><p>考虑平衡树，对于每一个候选人，建一棵平衡树，维护支持他的人的下标，直接查询 <code>l - 1</code> 和 <code>r</code> 在平衡树中的排名即可得到在 $[l, r]$ 中有多少人支持他</p><p>卡了个最优（主要是SBT快），估计现在已经没了吧</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SBT yyds</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, K = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeForSBT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, v, si;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) node_for_sbt[(x)].l</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) node_for_sbt[(x)].r</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> v(x) node_for_sbt[(x)].v</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> si(x) node_for_sbt[(x)].si</span></span><br><span class="line">&#125; node_for_sbt[N + K]; <span class="comment">//由于del优化,SBT的节点数为n+插入节点数</span></span><br><span class="line"><span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SBT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> rt = <span class="number">0</span>;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">rr</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="built_in">l</span>(t);</span><br><span class="line">        <span class="built_in">l</span>(t) = <span class="built_in">r</span>(k), <span class="built_in">r</span>(k) = t;</span><br><span class="line">        <span class="built_in">si</span>(k) = <span class="built_in">si</span>(t);</span><br><span class="line">        <span class="built_in">si</span>(t) = <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="built_in">si</span>(<span class="built_in">r</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        t = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">lr</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="built_in">r</span>(t);</span><br><span class="line">        <span class="built_in">r</span>(t) = <span class="built_in">l</span>(k), <span class="built_in">l</span>(k) = t;</span><br><span class="line">        <span class="built_in">si</span>(k) = <span class="built_in">si</span>(t);</span><br><span class="line">        <span class="built_in">si</span>(t) = <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="built_in">si</span>(<span class="built_in">r</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        t = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">mt</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">bool</span> f)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!f)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">l</span>(<span class="built_in">l</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">r</span>(t)))</span><br><span class="line">                <span class="built_in">rr</span>(t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">r</span>(<span class="built_in">l</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">r</span>(t)))</span><br><span class="line">                <span class="built_in">lr</span>(<span class="built_in">l</span>(t)), <span class="built_in">rr</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">r</span>(<span class="built_in">r</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">l</span>(t)))</span><br><span class="line">                <span class="built_in">lr</span>(t);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">l</span>(<span class="built_in">r</span>(t))) &gt; <span class="built_in">si</span>(<span class="built_in">l</span>(t)))</span><br><span class="line">                <span class="built_in">rr</span>(<span class="built_in">r</span>(t)), <span class="built_in">lr</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">mt</span>(<span class="built_in">l</span>(t), <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">mt</span>(<span class="built_in">r</span>(t), <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">mt</span>(t, <span class="literal">false</span>), <span class="built_in">mt</span>(t, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!t)</span><br><span class="line">        &#123;</span><br><span class="line">            t = ++num;</span><br><span class="line">            node_for_sbt[t] = &#123;<span class="number">0</span>, <span class="number">0</span>, v, <span class="number">1</span>&#125;;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        ++<span class="built_in">si</span>(t);</span><br><span class="line">        <span class="keyword">if</span> (v &lt;= <span class="built_in">v</span>(t))</span><br><span class="line">            <span class="built_in">ins</span>(<span class="built_in">l</span>(t), v);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">ins</span>(<span class="built_in">r</span>(t), v);</span><br><span class="line">        <span class="built_in">mt</span>(t, v &gt; <span class="built_in">v</span>(t));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        --<span class="built_in">si</span>(t); <span class="comment">//一定要先减,不然会错</span></span><br><span class="line">        <span class="keyword">if</span> ((<span class="built_in">v</span>(t) == v) || (<span class="built_in">v</span>(t) &lt; v &amp;&amp; !<span class="built_in">r</span>(t)) || (<span class="built_in">v</span>(t) &gt; v &amp;&amp; !<span class="built_in">l</span>(t)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="built_in">v</span>(t);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">l</span>(t) || !<span class="built_in">r</span>(t))</span><br><span class="line">                t = <span class="built_in">l</span>(t) + <span class="built_in">r</span>(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">v</span>(t) = <span class="built_in">del</span>(<span class="built_in">l</span>(t), <span class="built_in">v</span>(t) + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//在这里--si(t)就会错</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">v</span>(t) &lt; v ? <span class="built_in">del</span>(<span class="built_in">r</span>(t), v) : <span class="built_in">del</span>(<span class="built_in">l</span>(t), v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">int</span> <span class="title">rk</span><span class="params">(<span class="keyword">int</span> &amp;t, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!t)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (v == <span class="built_in">v</span>(t))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> v &lt; <span class="built_in">v</span>(t) ? <span class="built_in">rk</span>(<span class="built_in">l</span>(t), v) : <span class="built_in">si</span>(<span class="built_in">l</span>(t)) + <span class="number">1</span> + <span class="built_in">rk</span>(<span class="built_in">r</span>(t), v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; sbt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Date</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> cnt, v;</span><br><span class="line">    &#125; ;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">NodeForLineTree</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> l, r;</span><br><span class="line">        Date dat;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> ll(x) node_for_line_tree[(x)].l</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> rr(x) node_for_line_tree[(x)].r</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> ct(x) node_for_line_tree[(x)].dat.cnt</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> vv(x) node_for_line_tree[(x)].dat.v</span></span><br><span class="line">    &#125; node_for_line_tree[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> Mid (ll(u) + rr(u) &gt;&gt; 1)</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">merge</span><span class="params">(Date x, Date y, Date &amp;z)</span> <span class="comment">//合并x和y,储存在z</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x.v == y.v)</span><br><span class="line">            z.v = x.v, z.cnt = x.cnt + y.cnt;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x.cnt &gt;= y.cnt)</span><br><span class="line">            z.v = x.v, z.cnt = x.cnt - y.cnt;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            z.v = y.v, z.cnt = y.cnt - x.cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">merge</span>(node_for_line_tree[lc].dat, node_for_line_tree[rc].dat, node_for_line_tree[u].dat);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">ll</span>(u) = l, <span class="built_in">rr</span>(u) = r;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ct</span>(u) = <span class="number">1</span>, <span class="built_in">vv</span>(u) = x[l];</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="built_in">build</span>(lc, l, mid, x), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r, x);</span><br><span class="line">        <span class="built_in">up</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> pos, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ll</span>(u) == <span class="built_in">rr</span>(u))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">ct</span>(u) = <span class="number">1</span>, <span class="built_in">vv</span>(u) = d;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        <span class="keyword">if</span> (pos &lt;= mid)</span><br><span class="line">            <span class="built_in">change</span>(lc, pos, d);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">change</span>(rc, pos, d);</span><br><span class="line">        <span class="built_in">up</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL Date <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ll</span>(u) &gt;= l &amp;&amp; <span class="built_in">rr</span>(u) &lt;= r)</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="built_in">ct</span>(u), <span class="built_in">vv</span>(u)&#125;;</span><br><span class="line">        <span class="keyword">int</span> mid = Mid;</span><br><span class="line">        Date res = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">            <span class="built_in">merge</span>(<span class="built_in">ask</span>(lc, l, r), res, res);</span><br><span class="line">        <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">            <span class="built_in">merge</span>(<span class="built_in">ask</span>(rc, l, r), res, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; lt;</span><br><span class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = sbt[x].<span class="built_in">rk</span>(sbt[x].rt, r) - sbt[x].<span class="built_in">rk</span>(sbt[x].rt, l - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> (t &lt;&lt; <span class="number">1</span>) &gt; (r - l + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    STC <span class="keyword">int</span> a[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        sbt[a[i]].<span class="built_in">ins</span>(sbt[a[i]].rt, i);</span><br><span class="line">    &#125;</span><br><span class="line">    lt.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n, a);</span><br><span class="line">    <span class="keyword">int</span> l, r, s, k, win, t;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;s, &amp;k);</span><br><span class="line">        win = lt.<span class="built_in">ask</span>(<span class="number">1</span>, l, r).v;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">check</span>(win, l, r))</span><br><span class="line">            win = s;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, win);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">            lt.<span class="built_in">change</span>(<span class="number">1</span>, t, win);</span><br><span class="line">            sbt[a[t]].<span class="built_in">del</span>(sbt[a[t]].rt, t);</span><br><span class="line">            sbt[win].<span class="built_in">ins</span>(sbt[win].rt, t);</span><br><span class="line">            a[t] = win;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    win = lt.<span class="built_in">ask</span>(<span class="number">1</span>, <span class="number">1</span>, n).v;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">check</span>(win, l, r))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, win);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SBT </tag>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 线段树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1221C Perfect Team</title>
      <link href="/2022/01/03/CF1221C-Perfect-Team/"/>
      <url>/2022/01/03/CF1221C-Perfect-Team/</url>
      
        <content type="html"><![CDATA[<p> 简单的二分</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1221/C">Perfect Team</a></p><p>尝试了一下CF难度 $1200$ ，一道简单的二分（感觉一直在A水题）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, c, m, x;</span><br><span class="line">    <span class="keyword">int</span> l, r, mid, ans;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;c, &amp;m, &amp;x);</span><br><span class="line">        l = ans = <span class="number">0</span>, r = <span class="built_in">min</span>(c, m);</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">        &#123;</span><br><span class="line">            mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> ((c + m + x - mid) &gt;= (mid &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                ans = mid;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> 贪心 </tag>
            
            <tag> 二分 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1455C Ping-pong</title>
      <link href="/2022/01/03/CF1455C-Ping-pong/"/>
      <url>/2022/01/03/CF1455C-Ping-pong/</url>
      
        <content type="html"><![CDATA[<p> 结论题？</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1455/C">Ping-pong</a></p><p> $1100$ ，不是很简单了，先考虑贪心吧</p><p>但是一个细节是体力少的一方可以不打，等对方体力耗完，可以这样理解：反正体力少这把必输，且打不打体力差都变小 $1$ ，不如不打保留实力</p><p>由上也可以得到一个策略：设双方体力为 $x, y$ ，若 $x &gt; y(y &gt; x)$ ，则体力大的一方赢 $x - y$ 次，双方体力都变成 $y$ </p><p>而当体力相同时，先开球的人必输，但他们是优先保证自己赢的多，所以先/后手都不会让体力被一把打尽，就会故意输（对于先手，这把输了双方体力相同，而对方变成下一把的先手；对于后手，这把输了自己体力更大，下把必胜），所以体力相同的时候两人一定是每个人都把自己的体力赢完</p><p>但第一局Alice必须开球，所以她的胜场会少 $1$ </p><p>另外，其实看样例找规律也能做吧？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, x - <span class="number">1</span>, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> 贪心 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1567B MEXor Mixup</title>
      <link href="/2022/01/02/CF1567B-MEXor-Mixup/"/>
      <url>/2022/01/02/CF1567B-MEXor-Mixup/</url>
      
        <content type="html"><![CDATA[<p> 再挑战一下 $1000$ </p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/1567/B">MEXor Mixup</a></p><p>略有点水，放代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sum[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sum[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] ^ i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T, a, b;</span><br><span class="line">    <span class="built_in">prev</span>();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="keyword">if</span> (sum[a - <span class="number">1</span>] == b)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((sum[a - <span class="number">1</span>] ^ b) == a)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a + <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a + <span class="number">1</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 练习 </tag>
            
            <tag> 贪心 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF4A Watermelon</title>
      <link href="/2022/01/02/CF4A-Watermelon/"/>
      <url>/2022/01/02/CF4A-Watermelon/</url>
      
        <content type="html"><![CDATA[<p> CF $800$ 的水题</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/4/A">Watermelon</a></p><p>蒻蒟发现自己刷了好久luogu了，偶尔想换换口味，于是看了道CF的题</p><p>毕竟（不通过luogu做CF）是第一次，所以做一道难度 $800$ 的try one try，在思考了整整 $1145141919810.1415926535…$ 秒后，终于做出来了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">    <span class="keyword">if</span> ((w &lt; <span class="number">4</span>) || (w &amp; <span class="number">1</span>))</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> CF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4466 [国家集训队]和与积</title>
      <link href="/2022/01/02/luoguP4466-%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F-%E5%92%8C%E4%B8%8E%E7%A7%AF/"/>
      <url>/2022/01/02/luoguP4466-%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F-%E5%92%8C%E4%B8%8E%E7%A7%AF/</url>
      
        <content type="html"><![CDATA[<p> 时间复杂度到底是多少……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4466">和与积</a></p><p>一眼望过去感觉像莫反，心里拔凉</p><p>但还是坚强的把25分的暴力打了，不出意外，刚刚好25分，于是，找规律</p><p>打了个表找规律，看见答案一块一块的贼像数论分块，心里更凉了，把100以内的数对打表出来，发现（<del>反正我看见的</del>） $gcd(a, b) \ne 1$ ，硬着头皮推</p><p>莫反<br>$$<br>\begin{aligned}<br>设 &amp; gcd(a, b) = r, c = \frac{a}{r}, d = \frac{b}{r}, k \in \mathbb{N_+} \\<br>&amp; a b = (a + b) k \\<br>&amp; r^2 c d = r (c + d) k \\<br>&amp; r c d = (c + d) k \\<br>\because &amp; gcd(c, d) = 1 \\<br>\therefore &amp; cd \mid k \\<br>设 &amp; k’ = \frac{k}{cd} \\<br>有 &amp; r = (c + d) k’<br>\end{aligned}<br>$$<br>乱推一波到这里不知道该干啥了，于是去看了看（<del>被我遗忘了很久的</del>）莫反，想到莫反的经典操作——将枚举约数改成枚举倍数</p><p>考虑求 $c, d, k’, (c &lt; d, gcd(c, d) = 1, k’ \in \mathbb{N_+})$ ，则可计计算出 $r = (c + d) k’, a = rc, b = rd$ ，又因为 $b \le n$ ，所以 $d (c + d) k’ \le n$ ，也就是说， $c, d$ 确定以后， $k’$ 的范围也确定了，可以直接计算有几对，时间复杂度为 $O(n^2)$ ——woc，暴力也是 $O(n^2)$ 啊！</p><p>再次推式子：<br>$$<br>\begin{aligned}<br>Ans<br>&amp; = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} [gcd(i, j) == 1] \lfloor \frac{N}{i (i + j)} \rfloor \\<br>&amp; = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} \sum_{k | gcd(i, j)} \mu(k) \lfloor \frac{N}{i (i + j)} \rfloor \\<br>&amp; 令 pk = i, qk = j, N’k = N, 有 : \\<br>Ans<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{N’}{p (p + q)} \rfloor \\<br>\end{aligned}<br>$$<br>到这一步动不了了，主要是 $p(p + q)$ 是个二次项没法整除分块，卡了1145141919810h，高素质的瞟了一眼题解：<br>$$<br>\begin{aligned}<br>Ans<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{N’}{p (p + q)} \rfloor \\<br>&amp; = \sum_{k = 1}^N \sum_{p = 1}^N’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{\lfloor \frac{N’}{p} \rfloor}{p + q} \rfloor \\<br>\end{aligned}<br>$$<br>于是当 $k, p$ 定了后，后面只关于 $q$ 可以整除分块（<del>我咋就想不到呢？</del>）</p><p>机房的巨佬在这一步就可以做了，但蒟蒻我还是不能理解（感觉三个 $\sum$ 时间不是更慢了吗），所以我又绕了一下</p><p>发现这里没有必要跑满每一个 $N$ ，中间有一步：<br>$$<br>Ans = \sum_{i = 1}^N \sum_{j = 1}^{i - 1} \sum_{k | gcd(i, j)} \mu(k) \lfloor \frac{N}{i (i + j)} \rfloor \\<br>$$<br>这里当 $i \ge \sqrt{N}$ 时后面就为 $0$ ，所以直接令 $M = \sqrt{N}$ ，则<br>$$<br>Ans = \sum_{k = 1}^M \sum_{p = 1}^M’ \sum_{q = 1}^{p - 1} \mu(k) \lfloor \frac{\lfloor \frac{M’}{p} \rfloor}{p + q} \rfloor \\<br>$$<br>枚举 $k$ 用 $N^{\frac{1}{2}}$  ，枚举 $p$ 用大概用个 $N^{\frac{1}{4}}$ ，数论分块大概用个 $\sqrt{N^{\frac{1}{4}}}$ ……？？？啊啊啊算不出来了</p><p>看了一下题解，大家也都各不相同，但好像是 $O(n^{\frac{3}{4}})$ ？</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> mu[N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; prime;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> v[N];</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!v[i])</span><br><span class="line">            prime.<span class="built_in">push_back</span>(i), mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j : prime)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * j &gt; n)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            v[i * j] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % j)</span><br><span class="line">                mu[i * j] = -mu[i];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">work</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ed = p &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> l = p + <span class="number">1</span>, r; l &lt; ed; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x / l)</span><br><span class="line">            r = <span class="built_in">min</span>(x / (x / l), ed - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        res += (LL)(r - l + <span class="number">1</span>) * (x / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    m = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="built_in">prev</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mu[i])</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * i &lt;= m; ++j)</span><br><span class="line">            ans += <span class="built_in">work</span>(j, n / (i * i * j)) * mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>感觉自己莫反好弱</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 莫比乌斯反演 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4022 [CTSC2012]熟悉的文章</title>
      <link href="/2022/01/02/luoguP4022-CTSC2012-%E7%86%9F%E6%82%89%E7%9A%84%E6%96%87%E7%AB%A0/"/>
      <url>/2022/01/02/luoguP4022-CTSC2012-%E7%86%9F%E6%82%89%E7%9A%84%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<p> shit，不是水题了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4022">熟悉的文章</a></p><p>首先匹配的问题很好解决，SAM、SA维护文本串或者kmp处理模式串都可以</p><p>关键问题在于 $L_0$ ，首先考虑的是二分，因为答案很明显有单调性（如果长度 $L_0$ 可以，那么长度小于 $L_0$ 的也明显可以），但二分后如何判定是个问题</p><p>目测感觉和dp挂钩，有点像在kmp上dp，关键是假设已知长度为 $L_0$ ，如何得到划分方案，这边想考虑贪心</p><p>贪了一会贪不动，如果没有明显的贪心就考虑dp，设 <code>f[i]</code> 表示在已知长度为 $L_0$ 的情况下，以 $i$ 结尾的前缀串中“熟悉”的子串的长度总和，设以 $i$ 结尾的能匹配上的子串中最长的长度为 $len_i$ dp方程比较好推（就是状态不好设）：<br>$$<br>\begin{aligned}<br>f[i] = max<br>\begin{cases}<br>f[i - 1] (不让 i 成为一段) \\<br>f[j] + i - j, j \in [i - len_i, i - L_0] (让 i 匹配)<br>\end{cases}<br>\end{aligned}<br>$$<br>关于 $len_i$ ，可以对于每一个串预处理出来</p><p>明显可以单调队列维护，但由于数据范围是“输入文件的长度不超过 $1100000$ 字节”，所以我也不知道时间复杂度是多少</p><p>关于处理 $len_i$ ，我想的是先把文本串全都连起来（中间用 \$ 隔开），建一个SAM或者SA，然后对于每个询问直接暴力跑一遍，好像会挂</p><p>发现可以用类似AC自动机的想法，直接扫描匹配，就是建一个SAM，开始像Trie一样匹配，失配就用parent tree向上跳，大概应该也许可能是 $O(n)$ 的……吧？</p><p>还有一个实现的时候卡了的地方是单调队列维护时，区间长度是在变化的，解决办法是每次入队不是让 $i$ 入队，而是让 $i - L0$ 入队，这样可以保证队列中节点一定在区间内</p><p>结果SAM打挂了，调了好久才过样例，对这些东西还不是很熟悉啊</p><p>慢的一比的代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> SAM</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> len, fa;</span><br><span class="line">        <span class="keyword">int</span> ch[<span class="number">3</span>];</span><br><span class="line">    &#125; nd[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_v</span><span class="params">(<span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ch == <span class="string">&#x27;$&#x27;</span> ? <span class="number">2</span> : ch - <span class="string">&#x27;0&#x27;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="built_in">get_v</span>(ch);</span><br><span class="line">        <span class="keyword">int</span> p = last, np = last = ++tot;</span><br><span class="line">        <span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[x]; p = nd[p].fa)</span><br><span class="line">            nd[p].ch[x] = np;</span><br><span class="line">        <span class="keyword">if</span> (!p)</span><br><span class="line">            nd[np].fa = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> q = nd[p].ch[x];</span><br><span class="line">            <span class="keyword">if</span> (nd[q].len == nd[p].len + <span class="number">1</span>)</span><br><span class="line">                nd[np].fa = q;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> nq = ++tot;</span><br><span class="line">                nd[nq] = nd[q], nd[nq].len = nd[p].len + <span class="number">1</span>;</span><br><span class="line">                nd[q].fa = nd[np].fa = nq;</span><br><span class="line">                <span class="keyword">for</span> (; p &amp;&amp; nd[p].ch[x] == q; p = nd[p].fa)</span><br><span class="line">                    nd[p].ch[x] = nq;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">1</span>, now = <span class="number">0</span>, t, len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">get_v</span>(s[i]);</span><br><span class="line">            <span class="keyword">if</span> (nd[p].ch[t])</span><br><span class="line">                ++now, p = nd[p].ch[t];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[t]; p = nd[p].fa);</span><br><span class="line">                <span class="keyword">if</span> (!p)</span><br><span class="line">                    p = <span class="number">1</span>, now = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    now = nd[p].len + <span class="number">1</span>, p = nd[p].ch[t];</span><br><span class="line">            &#125;</span><br><span class="line">            x[i] = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> len[N];</span><br><span class="line"><span class="keyword">int</span> f[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> sl)</span> <span class="comment">//x就是L0</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; ++i)</span><br><span class="line">        f[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= sl; ++i)</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">//由于i-L0可以跟新i,所以要先入队</span></span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; f[q[r]] - q[r] &lt;= f[i - x] - (i - x))</span><br><span class="line">            --r;</span><br><span class="line">        q[++r] = i - x;</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; q[l] &lt; i - len[i])</span><br><span class="line">            ++l;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= r)</span><br><span class="line">            f[i] = <span class="built_in">max</span>(f[i], f[q[l]] + i - q[l]);    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[sl] * <span class="number">10</span> &gt;= sl * <span class="number">9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SAM::<span class="built_in">find</span>(s, len);</span><br><span class="line">    <span class="keyword">int</span> sl = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = sl, mid, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid, sl))</span><br><span class="line">        &#123;</span><br><span class="line">            res = mid;</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    STC <span class="keyword">char</span> s[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, t; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        t = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= t; ++j)</span><br><span class="line">            SAM::<span class="built_in">ins</span>(s[j]);</span><br><span class="line">        SAM::<span class="built_in">ins</span>(<span class="string">&#x27;$&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">work</span>(s));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 单调队列 </tag>
            
            <tag> 二分 </tag>
            
            <tag> 后缀自动机,SAM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP3906 Geodetic集合</title>
      <link href="/2022/01/02/luoguP3906-Geodetic%E9%9B%86%E5%90%88/"/>
      <url>/2022/01/02/luoguP3906-Geodetic%E9%9B%86%E5%90%88/</url>
      
        <content type="html"><![CDATA[<p> 大水题</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3906">Geodetic集合</a></p><p>水题（主要是 $n$ 太小了），直接给代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, que;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Que</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Que &amp;t) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> u == t.u ? u &lt; t.u : v &lt; t.v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; qq[N * N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans[N * N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="keyword">int</span> dis[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[(N * N) &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = (Edge)&#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> star)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        dis[i] = <span class="number">0</span>;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    dis[star] = <span class="number">1</span>;</span><br><span class="line">    q.<span class="built_in">push</span>(star);</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (!dis[y = e[i].ver])</span><br><span class="line">            &#123;</span><br><span class="line">                dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> star)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(star);</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        vis[i] = <span class="literal">false</span>;</span><br><span class="line">    ans[id].<span class="built_in">push_back</span>(star);</span><br><span class="line">    vis[star] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (!vis[y = e[i].ver] &amp;&amp; dis[y] == dis[x] - <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans[id].<span class="built_in">push_back</span>(y);</span><br><span class="line">                vis[y] = <span class="literal">true</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, a, b; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(a, b), <span class="built_in">add</span>(b, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;que);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;qq[i].u, &amp;qq[i].v);</span><br><span class="line">        qq[i].id = i;</span><br><span class="line">        <span class="keyword">if</span> (qq[i].u &gt; qq[i].v)</span><br><span class="line">            <span class="built_in">swap</span>(qq[i].u, qq[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(qq + <span class="number">1</span>, qq + <span class="number">1</span> + que);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, now = <span class="number">0</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (now != qq[i].u)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bfs</span>(qq[i].u);</span><br><span class="line">            now = qq[i].u;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">work</span>(qq[i].id, qq[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= que; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sort</span>(<span class="built_in">all</span>(ans[i]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j : ans[i])</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, j);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> STL </tag>
            
            <tag> 搜索 </tag>
            
            <tag> bfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>奇妙的知识</title>
      <link href="/2022/01/02/%E5%A5%87%E5%A6%99%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/01/02/%E5%A5%87%E5%A6%99%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<p> 奇奇怪怪</p><span id="more"></span><h1 id="奇妙的知识"><a href="#奇妙的知识" class="headerlink" title="奇妙的知识"></a>奇妙的知识</h1><h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><ul><li><p> $gcd(x, y, z) = gcd(x, y - x, z - y)$ ，这启发我们，对于已知数列 $\{a\}$ 及其差分数列 $\{b\}$ ， $gcd(a_i, a_{i+1}, …, a_j) = gcd(a_i, b_{i+1}, …, b_j)$ </p></li><li><p>$C_{a}^{b}=C_{a-1}^{b-1}+C_{a-1}^{b}$ ，这启发我们可以用递推求组合数</p></li><li><p>自然数次幂求和：<br>$$<br>\begin{aligned}<br>&amp; \sum_{i = 1}^{n} i = \frac{1}{2} n (n + 1) \\<br>&amp; \sum_{i = 1}^{n} i^2 = \frac{1}{6} n (n + 1) (2n + 1) \\<br>&amp; \sum_{i = 1}^{n} i^3 = \frac{1}{4} n^2 (n + 1)^2 \\<br>&amp; \sum_{i = 1}^{n} i^4 = \frac{1}{30} n (n + 1) (2n + 1) (3n^2 + 3n - 1) \\<br>&amp; \sum_{i = 1}^{n} i^5 = \frac{1}{12} n^2 (n + 1)^2 (2n^2 + 2n - 1) \\<br>&amp; \sum_{i = 1}^{n} i^6 = \frac{1}{42} n (n + 1) (2n + 1) (3n^4 + 6n^3 - 3n + 1) \\<br>\end{aligned}<br>$$</p><p>对于自然数 $k$ 次幂求和，明显其结果是一个关于 $n$ 的 $k + 1$ 次多项式，可以待定系数法求解</p></li></ul><h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><h3 id="哈密尔顿回路"><a href="#哈密尔顿回路" class="headerlink" title="哈密尔顿回路"></a>哈密尔顿回路</h3><p>定义：</p><p>哈密尔顿<strong>通路</strong>：经过图中每个结点且仅经过一次的通路</p><p>哈密尔顿<strong>回路</strong>：经过图中每个结点且仅经过一次的回路</p><p>哈密尔顿图：存在哈密尔顿<strong>回路</strong>的图</p><p>与欧拉回路的对比：欧拉回路是指不重复地走过所有路径的回路；哈密尔顿回路是指不重复地走过所有点并且最后回到起点的回路</p><p>判定：</p><p>设其有 $n$ 个顶点， $u, v$ 为图中任意，两个<strong>不相邻</strong>的顶点</p><ul><li>通路：若 $\deg(u) + \deg(v) \ge n - 1$ ，则图中存在哈密尔顿通路</li><li>回路：若 $\deg(u) + \deg(v) \ge n$ ，则图中存在哈密尔顿回路</li><li>回路推论：对于 $n \ge 3$ 的图，若任意一个点的度数 $\deg(u) \ge \frac{n}{2}$​ ，则图中存在哈密尔顿回路</li></ul><h3 id="竞赛图"><a href="#竞赛图" class="headerlink" title="竞赛图"></a>竞赛图</h3><p>对于一个无重边和自环的<strong>有向图</strong>，如果其中任意两点间都有且仅有一条边，就称其为<strong>竞赛图</strong>，顾名思义，它可以想象成 $n$ 个人两两对决，赢得向输的连边</p><p>性质：</p><ul><li>对于 $n(n \ge 2)$ 阶竞赛图，一定存在哈密尔顿<strong>通路</strong></li><li>一个<strong>强连通</strong>的竞赛图一定存在一条哈密顿<strong>回路</strong></li><li>一个竞赛图，将所有强连通分量缩点之后，一定形成一条链（链上会有跨越边，但是绝对不会形成分叉）</li></ul>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 其它 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4927 [1007]梦美与线段树</title>
      <link href="/2022/01/02/luoguP4927-1007-%E6%A2%A6%E7%BE%8E%E4%B8%8E%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2022/01/02/luoguP4927-1007-%E6%A2%A6%E7%BE%8E%E4%B8%8E%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 出题人我谢谢您</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4927">梦美与线段树</a></p><p>很快手玩了一下答案，设 $\{a_i\}$ 为序列， $\{v_i\}$ 为线段树节点的权值，答案就是 $Ans = \frac{\sum v_i^2}{\sum a_i}$ </p><p>下面的分母好解决，问题在上面的平方和</p><p>考虑线段树维护节点权值平方和（同时可以很自然的维护序列和），当区间加 $d$ 的时候，设该节点对应区间长度为 $len_i$ ，则 $v_i^2 \rightarrow (v_i + len_i * d)^2 = v_i^2 + v_i * len_i * 2d + len_i^2 * d$ ，发现节点的改变量和它的权值与长度都有关，考虑维护系数，即维护 $v_i * len_i$ 的和与 $len_i^2$ 和</p><p>具体地，设 $s2$ 表示节点权值示平方和， $sl2$ 表示节点长度平方和（它只用算一次，是不变的）， $sm$ 是 $v_i * len_i$ 的和有：<br>$$<br>\begin{aligned}<br>pushup : \\<br>&amp; v_i = v_{lc} + v_{rc} \\<br>&amp; s2_i = v_i^2 + s2_{lc} + s2_{rc} \\<br>&amp; sl2_i = len_i^2 + sl2_{lc} + sl2_{rc} \\<br>&amp; sm_i = len_i * v_i + sm_{lc} + sm_{rc} \\<br>pushdown : \\<br>&amp; s2_i = sl2_i * d^2 + 2d * sm_i + s2_i \\<br>&amp; v_i = len_i * d + v_i \\<br>&amp; sm_i = sl2_i * d + sm_i \\<br>\end{aligned}<br>$$<br>打好懒标记，调了一下，一交……WA90？！</p><p>一看，输出了个 $0$ 以为爆精度了，就 <code>#define int long long</code> 结果不变，一看讨论区，有人说这题要用高精（或者不要脸的 <code>__int128</code> ），我看了一遍，每一步都模了 $P = 998244353$ ，连 <code>long long</code> 会不会炸都怀疑，但还是改成 <code>__int128</code> 试了试，结果不变……</p><p>对 <code>__int128</code> 不是很熟悉，我以为自己用错了，还手打了快读快输，结果还是不变</p><p>忍无可忍看题解，发现问题在于题目说“令答案化成最简分数为 $\frac{p}{q}$ （保证 $q$ 不是 $998244353$ 的倍数”，也就是说答案可能是 $\frac{k * P}{r * P}$ 的形式，所以<strong>中间的过程中不能取模</strong>，只能开 <code>__int128</code> 硬存最后约分</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int __int128</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gh() getchar()</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="comment">//值,平方和,长度平方和,长度与值的积的和</span></span><br><span class="line">    <span class="keyword">int</span> v, s2, sl2, sm;</span><br><span class="line">    <span class="keyword">int</span> add;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) tr[(x)].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) tr[(x)].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) tr[(x)].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> s2(x) tr[(x)].s2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sl2(x) tr[(x)].sl2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sm(x) tr[(x)].sm</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ad(x) tr[(x)].add</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (u &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc (u &lt;&lt; 1 | 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Mid (tr[u].l + tr[u].r &gt;&gt; 1)</span></span><br><span class="line">&#125; tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> ch = <span class="built_in">gh</span>(), t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        t |= ch == <span class="string">&#x27;-&#x27;</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        x = x * <span class="number">10</span> + ch - <span class="number">48</span>, ch = <span class="built_in">gh</span>();</span><br><span class="line">    <span class="keyword">if</span> (t)</span><br><span class="line">        x = -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">9</span>)</span><br><span class="line">        <span class="built_in">write</span>(x / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x % P;</span><br><span class="line">        x = x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_init</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">v</span>(u) = (<span class="built_in">v</span>(lc) + <span class="built_in">v</span>(rc));</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">v</span>(u) * <span class="built_in">v</span>(u) + <span class="built_in">s2</span>(lc) + <span class="built_in">s2</span>(rc));</span><br><span class="line">    <span class="built_in">sl2</span>(u) = (len * len + <span class="built_in">sl2</span>(lc) + <span class="built_in">sl2</span>(rc));</span><br><span class="line">    <span class="built_in">sm</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * <span class="built_in">v</span>(u)+ <span class="built_in">sm</span>(lc) + <span class="built_in">sm</span>(rc));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">v</span>(u) = (<span class="built_in">v</span>(lc) + <span class="built_in">v</span>(rc));</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">v</span>(u) * <span class="built_in">v</span>(u) + <span class="built_in">s2</span>(lc) + <span class="built_in">s2</span>(rc));</span><br><span class="line">    <span class="built_in">sm</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * <span class="built_in">v</span>(u) + <span class="built_in">sm</span>(lc) + <span class="built_in">sm</span>(rc));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_tag</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">s2</span>(u) = (<span class="built_in">sl2</span>(u) * d * d +d * <span class="number">2</span> * <span class="built_in">sm</span>(u) + <span class="built_in">s2</span>(u));</span><br><span class="line">    <span class="built_in">v</span>(u) = ((<span class="built_in">r</span>(u) - <span class="built_in">l</span>(u) + <span class="number">1</span>) * d + <span class="built_in">v</span>(u));</span><br><span class="line">    <span class="built_in">sm</span>(u) = (<span class="built_in">sl2</span>(u) * d + <span class="built_in">sm</span>(u));</span><br><span class="line">    <span class="built_in">ad</span>(u) = (<span class="built_in">ad</span>(u) + d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">ad</span>(u))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">add_tag</span>(lc, <span class="built_in">ad</span>(u));</span><br><span class="line">        <span class="built_in">add_tag</span>(rc, <span class="built_in">ad</span>(u));</span><br><span class="line">        <span class="built_in">ad</span>(u) = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">l</span>(u) = l, <span class="built_in">r</span>(u) = r;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">v</span>(u) = <span class="built_in">sm</span>(u) = a[l];</span><br><span class="line">        <span class="built_in">s2</span>(u) = a[l] * a[l];</span><br><span class="line">        <span class="built_in">sl2</span>(u) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = Mid;</span><br><span class="line">    <span class="built_in">build</span>(lc, l, mid), <span class="built_in">build</span>(rc, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">push_init</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">l</span>(u) &gt;= l &amp;&amp; <span class="built_in">r</span>(u) &lt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">add_tag</span>(u, d);</span><br><span class="line">    <span class="built_in">push_down</span>(u);</span><br><span class="line">    <span class="keyword">int</span> mid = Mid;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">        <span class="built_in">modify</span>(lc, l, r, d);</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">        <span class="built_in">modify</span>(rc, l, r, d);</span><br><span class="line">    <span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = __gcd(<span class="built_in">s2</span>(<span class="number">1</span>), <span class="built_in">v</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">int</span> A = <span class="built_in">s2</span>(<span class="number">1</span>) / t, B = <span class="built_in">v</span>(<span class="number">1</span>) / t;</span><br><span class="line">    <span class="keyword">return</span> A % P * <span class="built_in">qpow</span>(B, P - <span class="number">2</span>) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">int</span> op, l, r, v;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(op);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(l), <span class="built_in">read</span>(r), <span class="built_in">read</span>(v);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>, l, r, v);   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">write</span>(<span class="built_in">ask</span>()), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> STL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5389 [Cnoi2019]数学课</title>
      <link href="/2022/01/01/luoguP5389-Cnoi2019-%E6%95%B0%E5%AD%A6%E8%AF%BE/"/>
      <url>/2022/01/01/luoguP5389-Cnoi2019-%E6%95%B0%E5%AD%A6%E8%AF%BE/</url>
      
        <content type="html"><![CDATA[<p> 神仙数学，想复杂了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5389">数学课</a></p><p>最近感觉不在状态（可能是快期末考试了吧），所以随机跳了一题，肉眼可见的数学题</p><p>由于 $a, b$ 产生方式相同，所以 $P(a &gt; b) = P(a &lt; b)$ ，因此只需要计算 $P(a = b)$ 即可</p><p>考虑 $a = x_k$ 的概率：</p><p>设数列为 $\{x_i\}$ ，明显 $x_i = \frac{i (i + 1)}{2}$ ，选出  $x_i, (i \ge k)$ 的概率有 $P(x_i) = \frac{3 i (i + 1)}{n (n + 1)(n + 2)}$ ，再得 $a = x_k$ 的概率有：<br>$$<br>\begin{aligned}<br>P(a = x_k)<br>&amp; = \sum_{i \ge k} P(x_i) \times \frac{1}{x_i} \\<br>&amp; = \sum_{i \ge k} \frac{6}{n (n + 1)(n + 2)} \\<br>&amp; =\frac{6 (n - k + 1)}{n (n + 1)(n + 2)} \\<br>\end{aligned}<br>$$<br>所以：<br>$$<br>\begin{aligned}<br>P(a = b)<br>&amp; = \sum_{i = 1}^n i \times P(a = x_i)^2 \\<br>&amp; = \sum_{i = 1}^n i \times (\frac{6 (n - i + 1)}{n (n + 1) (n + 2)})^2 \\<br>&amp; = \frac{36}{(n (n + 1)(n + 2))^2} \sum_{i = 1}^n i(n - i + 1)^2 \\<br>&amp; = \frac{3}{n (n + 2)}<br>\end{aligned}<br>$$<br>注意数据范围 $n$ 要开 <code>long long</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> LL P = <span class="number">998244353</span>;</span><br><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL x, LL y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x %P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    n %= P;</span><br><span class="line">    <span class="keyword">if</span> (!n)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        LL a = ((LL)(n + <span class="number">2</span>) * n % P - <span class="number">3</span> + P) % P;</span><br><span class="line">        LL b = (LL)(n + <span class="number">2</span>) * n % P * <span class="number">2</span> % P;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, (LL)<span class="built_in">qpow</span>(b , P - <span class="number">2</span>) * a % P);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 概率 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多项式</title>
      <link href="/2021/12/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
      <url>/2021/12/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p> 多项式没家桶</p><span id="more"></span><h1 id="多项式"><a href="#多项式" class="headerlink" title="多项式"></a>多项式</h1><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><ul><li>NTT</li><li>FFT</li><li>一定的数学</li></ul><h2 id="多项式乘法"><a href="#多项式乘法" class="headerlink" title="多项式乘法"></a>多项式乘法</h2><p>NTT/FFT即可</p><p>毒瘤卡常之预处理原根（然鹅不开O2有可能反向优化，慎用）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> VIT vector<span class="meta-string">&lt;int&gt;</span>::iterator</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; g[N], _g[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>, gn, mid, i, _gn, t, <span class="keyword">_t</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        _gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        t = <span class="keyword">_t</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; mid; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            g[mid].<span class="built_in">push_back</span>(t);</span><br><span class="line">            _g[mid].<span class="built_in">push_back</span>(<span class="keyword">_t</span>);</span><br><span class="line">            t = (LL)t * gn % P;</span><br><span class="line">            <span class="keyword">_t</span> = (LL)<span class="keyword">_t</span> * _gn % P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, a, b;</span><br><span class="line">    VIT gn;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = (op == <span class="number">1</span> ? g[mid].<span class="built_in">begin</span>() : _g[mid].<span class="built_in">begin</span>());</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)gn[j] * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    a = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * a % P;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式求逆"><a href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4238">板子</a></p><p>对于给定 $F (x)$ ，求出 $G(x)$ 使得 $ G(x)F(x) \equiv 1 \pmod {x^n}$ ，其中 $A(x) \equiv 1 \pmod {x^n}$ 指 $A(x)$ 次数低于 $n$ 的项只有常数为1，其余都为0，即 $A(x) =  1 + 0x + 0x^2 + 0x^3 + … + 0x^{n - 1} + a_nx^n + a_{n + 1}x^{n + 1} + …$ </p><p>做法：</p><p>考虑倍增，变形：<br>$$<br>\begin{aligned}<br>设G_0(x)满足:\\<br>&amp; G_0(x)F(x) \equiv 1 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>故:\\<br>&amp; G(x) - G_0(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; (G(x) - G_0(x))^2 \equiv 0 \pmod {x^n}\\<br>&amp; G^2(x) - 2G(x)G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br>\because &amp; G(x)F(x) \equiv 1 \pmod {x^n}\\<br>\therefore &amp; G(x) - 2G_0(x) + G_0^2(x)F(x) \equiv 0 \pmod {x^n}\\<br> &amp; G(x) \equiv (2 - G_0(x)F(x))G_0(x) \pmod {x^n}<br>\end{aligned}<br>$$<br>注意特判常数项要有逆，然后倍增即可，时间 $O(n \log n)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="comment">//逆变换记得除</span></span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> len, <span class="keyword">int</span> x[], <span class="keyword">int</span> y[])</span> <span class="comment">//将x求逆,答案为y</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, x, y);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)t[i] * y[i] % P + P) % P * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    --n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyinv</span>(n + <span class="number">1</span>, a, b); <span class="comment">//是长度,要加1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式除法和取模"><a href="#多项式除法和取模" class="headerlink" title="多项式除法和取模"></a>多项式除法和取模</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4512">板子</a></p><p>对于给定 $F(x), G(x)$ ，其中 $deg(F) \ge deg(G)$ ，不妨设 $deg(F) = n, deg(G) = m$ ，求 $Q(x), R(x)$ 使得 $F(x) = Q(x)G(x) + R(x)$ ，且 $deg(Q) = n - m, deg(R) = m - 1$ ，其中 $R(x)$ 最高位可以为0</p><p>做法：</p><p>对于多项式 $A(x)$ ，记 $A_r(x) = x^{deg(A)}A(\frac{1}{x})$ （其实就是把 $A$ 的系数翻转）</p><p>变形：<br>$$<br>\begin{aligned}<br>&amp; F(\frac{1}{x}) = Q(\frac{1}{x}) G(\frac{1}{x}) + R(\frac{1}{x})\\<br>&amp; x^n F(\frac{1}{x}) = x^{n -m} Q(\frac{1}{x}) x^m G(\frac{1}{x}) + x^{n - m + 1} x^{m - 1} R(\frac{1}{x})\\<br>&amp; F_r(x) = Q_r(x) G_r(x) + x^{n - m + 1} R_r(x)\\<br>&amp; F_r(x) \equiv Q_r(x) G_r(x) \pmod {x^{n - m + 1}}\\<br>&amp; Q_r(x) \equiv F_r(x) G_r^{-1}(x) \pmod {x^{n - m + 1}}<br>\end{aligned}<br>$$<br>多项式求逆得 $G_r^{-1}(x)$ ，多项式乘法得 $Q_r(x)$ ，计算即可得 $Q(x), R(x)$ ，时间还是 $O(n \log n)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydiv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> n, <span class="keyword">int</span> y[], <span class="keyword">int</span> m, <span class="keyword">int</span> a[], <span class="keyword">int</span> b[])</span> <span class="comment">//x除以y,商a余b</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> ta[N], tb[N];</span><br><span class="line">    <span class="keyword">int</span> dt = n - m + <span class="number">1</span>, tot = <span class="number">1</span>, bit = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (n &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = tb[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//求逆</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        ta[i] = y[m - i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">polyinv</span>(ta, tb, dt); <span class="comment">//这里就不加1了</span></span><br><span class="line">    <span class="comment">//求乘积</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        ta[i] = x[n - i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = (LL)ta[i] * tb[i] %P;</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dt; ++i)</span><br><span class="line">        a[i] = ta[dt - i - <span class="number">1</span>];</span><br><span class="line">    <span class="comment">//求余式</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = tb[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dt; ++i)</span><br><span class="line">        ta[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        tb[i] = y[i];</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        ta[i] = (LL)ta[i] * tb[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; ++i)</span><br><span class="line">        b[i] = (x[i] - ta[i] + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], as1[N], as2[N];</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]), b[i] = (b[i] + P) % P;</span><br><span class="line">    <span class="built_in">polydiv</span>(a, n + <span class="number">1</span>, b, m + <span class="number">1</span>, as1, as2); <span class="comment">//多项式注意+1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n - m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, as1[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m - <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, as2[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式开根"><a href="#多项式开根" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5205">板子</a></p><p>给定 $F(x)$ ，求 $G(x)$ 满足 $G^2(x) \equiv F(x) \pmod {x^n}$ </p><p>做法：</p><p>当然可以多项式快速幂求 $F^{\frac{1}{2}}(x)$ </p><p>也可以考虑倍增，变形：<br>$$<br>\begin{aligned}<br>设G_0(x)满足:\\<br>&amp; G_0^2(x) \equiv F(x) \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>故:\\<br>&amp; G^2(x) - G_0^2(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; (G(x) + G_0(x)) (G(x) - G_0(x)) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; G(x) - G_0(x) \equiv 0 \pmod {x^{\lceil \frac{n}{2} \rceil}}\\<br>&amp; G^2(x) - 2G(x)G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br>&amp; F(x) - 2G(x) G_0(x) + G_0^2(x) \equiv 0 \pmod {x^n}\\<br> &amp; G(x) \equiv \frac{G_0^2(x) + F(x)}{2G_0(x)} \pmod {x^n}<br>\end{aligned}<br>$$<br>边界条件是常数项必须是模 $P$ 的二次剩余，时间 $O(n \log n)$ </p><p>代码懒得打了，反正<strong>次幂也行</strong></p><h2 id="牛顿迭代"><a href="#牛顿迭代" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h2><p>牛顿是一种思考的方法，多项式的题很多都用倍增，但每一道题都手推式子太过痛苦，于是，我们可以（<del>更痛苦的</del>）推出式子</p><p>问题：</p><p>对于给定 $F(x)$ ，求 $G(x)$ ，使 $F(G(x)) \equiv 0 \pmod {x^n}$ </p><p>做法：</p><p>推式子（<del>啊啊啊我要疯了</del>）：</p><p>呃……突然发现<strong>康托展开</strong>我不会，推个寂寞，直接给结论：<br>$$<br>G(x) \equiv G_0(x) - \frac{F(G_0(x))}{F’(G_0(x))} \pmod {x^n}<br>$$</p><h2 id="多项式求导和积分"><a href="#多项式求导和积分" class="headerlink" title="多项式求导和积分"></a>多项式求导和积分</h2><p>来两个简单的，直接算就行了</p><p>求导：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">    res[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">res[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>积分：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//逆元可以预处理</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">    res[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">inv</span>(i) % P;</span><br><span class="line">res[<span class="number">0</span>] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h2 id="多项式对数"><a href="#多项式对数" class="headerlink" title="多项式对数"></a>多项式对数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4725">板子</a></p><p>对于给定 $F(x)$ ，求出 $G(x)$ 使得 $G(x) \equiv \ln(F(x)) \pmod {x^n}$ </p><p>做法：</p><p>求导，有 $G’(x) \equiv \frac{F’(x)}{F(x)} \pmod {x^n}$ </p><p>多项式求导得 $F’(x)$ ，求逆得 $\frac{1}{F(x)}$ ，乘法得 $G’(x)$ ，积分出 $G(x)$ ，时间 $O(n \log n)$ ，注意要保证常数项 $f_0 = 1$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span> <span class="comment">//differentiate</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span> <span class="comment">//integral</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> n, a[N], b[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyln</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项指数"><a href="#多项指数" class="headerlink" title="多项指数"></a>多项指数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P4726">板子</a></p><p>对于给定 $F(x)$ ，求 $G(x)$ 使得 $G(x) \equiv e^{F(x)} \pmod {x^n}$ </p><p>做法：</p><p>两边取对数得， $\ln(G(x)) \equiv F(x) \pmod {x^n}$ </p><p>由牛顿迭代：<br>$$<br>\begin{aligned}<br>G(x) \equiv G_0(x) - \frac{\ln(G_0(x)) - F(x)}{\frac{1}{G_0(x)}} \pmod {x^n}\\<br>G(x) \equiv (1 - \ln(G_0(x)) + F(x)) G_0(x) \pmod {x^n}\\<br>\end{aligned}<br>$$</p><p>时间 $O(n \log n)$ ，注意一定要有 $f_0 = 0$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> n, a[N], b[N];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式次幂"><a href="#多项式次幂" class="headerlink" title="多项式次幂"></a>多项式次幂</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5273">板子</a></p><p>对于给定 $F(x), k$ ，求 $G(x)$ 使得 $G(x) \equiv F^k(x) \pmod {x^n}$ </p><p>做法：</p><p>推式子：<br>$$<br>\begin{aligned}<br>&amp; G(x) \equiv F^k(x) \pmod {x^n}\\<br>&amp; \ln(G(x)) \equiv k \ln(F(x)) \pmod {x^n}\\<br>\end{aligned}<br>$$<br>对 $F(x)$ 取 $\ln$ ，乘 $k$ 以后 $\exp$ 即可</p><p>但是并不保证常数项为1，则求 $\exp$ 时边界不一定为1了，不能直接取对数，所以提公因式，设 $r$ 为 $F(x)$ 的第一个非0项次数，提取公因式 $a_rx^r$ 就可以保证最低位是1了</p><p>考虑提公因式对答案的影响：我们提了公因式后，最后答案的前 $k * r$ 项都为0，后面的项就是我们求出来的，最后一起乘一个 $a_r^m$ 即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    k1是模P后的次数</span></span><br><span class="line"><span class="comment">    k2是模P-1的,用欧拉定理求第r项系数的k次幂</span></span><br><span class="line"><span class="comment">    k3存真实的k的一部分,若r*k3 &gt;= n说明前n项全是0</span></span><br><span class="line"><span class="comment">    num记录r</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    STC <span class="keyword">char</span> k[K];</span><br><span class="line">    <span class="keyword">int</span> n, k1, k2, k3;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;n, k + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    k1 = k2 = k3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l = <span class="built_in">strlen</span>(k + <span class="number">1</span>); i &lt;= l; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        k1 = ((LL)k1 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % P;</span><br><span class="line">        k2 = ((LL)k2 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % (P - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> ((LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>) &lt;= P)</span><br><span class="line">            k3 = (LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polypow</span>(a, b, k1, k2, k3, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式开根2"><a href="#多项式开根2" class="headerlink" title="多项式开根2"></a>多项式开根2</h2><p>前置：Cipolla算法</p><p>如果 $y^2 \equiv x \pmod P$ ，则称 $x$ 为模 $P$ 的二次剩余（然鹅我们要求的是 $y$ ）</p><p>而对于不保证 $f_0 = 0$ 的开根，我们必须要求出 $f_0$ 做 $x$ 时的 $y$ </p><p>下面是一堆我听不懂的思路</p><p>可以找一个 $t$ ，使得 $t^2 - x$ 为非二次剩余，设 $w = t^2 - x$ ，则 $y = (t + \sqrt{w})^{\frac{P + 1}{2}}$ ，这里考虑把 $w$ 定义为负数中的 $i$ ，随机选 $t$ 尝试即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    <span class="built_in">polysqrt</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式三角函数"><a href="#多项式三角函数" class="headerlink" title="多项式三角函数"></a>多项式三角函数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5264">板子？</a></p><p>对于给定 $F(x)$ ，求 $\sin F(x), \cos F(x), \tan F(x)$ </p><p>做法：<br>$$<br>\begin{aligned}<br>考虑欧拉公式： \\<br>&amp; e^{i \theta} = \cos \theta + i \sin \theta \\<br>故: \\<br>&amp; e^{i x} = \cos x + i \sin x \\<br>&amp; e^{i (-x)} = \cos (-x) + i \sin (-x) = \cos x - i \sin x \\<br>所以: \\<br>&amp; \cos x = \frac{e^{i x} + e^{-i x}}{2} \\<br>&amp; \sin x = \frac{e^{i x} - e^{-i x}}{2i} \\<br>待入f(x): \\<br>&amp; \cos F(x) = \frac{\exp(i F(x)) + \exp(-iF(x))}{2} \\<br>&amp; \sin F(x) = \frac{\exp(i F(x)) - \exp(-iF(x))}{2i} \\<br>又因为: \\<br>&amp; i^2 \equiv -1 \pmod P \\<br>所以: \\<br>&amp; i^2 \equiv P - 1 \pmod P<br>\end{aligned}<br>$$<br>做一遍二次剩余求出 $i$ ，照着计算即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> img = <span class="number">86583718</span>; <span class="comment">//直接计算出了二次剩余</span></span><br><span class="line"><span class="comment">//封装时记得清空数组，要重复使用</span></span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注意模数不为998244353是要重新算img</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] + b[i]) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] - b[i] + P) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(img &lt;&lt; <span class="number">1</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(b, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = a[i] * t[i] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n, op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    op ? <span class="built_in">polycos</span>(a, b, n) : <span class="built_in">polysin</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="多项式反三角函数"><a href="#多项式反三角函数" class="headerlink" title="多项式反三角函数"></a>多项式反三角函数</h2><p>问题：</p><p><a href="https://www.luogu.com.cn/problem/P5265">板子？</a></p><p>对于给定 $F(x)$ ，求 $\arcsin F(x), \arccos F(x), \arctan F(x)$ </p><p>做法：</p><p>直接积分得<br>$$<br>\begin{aligned}<br>&amp; \arcsin F(x) =\int \frac{F’(x)}{\sqrt{1 - F^2(x)}} dx \\<br>&amp; \arccos F(x) = - \int \frac{F’(x)}{\sqrt{1 - F^2(x)}} dx \\<br>&amp; \arctan F(x) = \int \frac{F’(x)}{1 + F^2(x)} dx \\<br>\end{aligned}<br>$$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>, P = <span class="number">998244353</span>, K = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> img = <span class="number">86583718</span>; <span class="comment">//直接计算出了二次剩余</span></span><br><span class="line"><span class="comment">//封装时记得清空数组，要重复使用</span></span><br><span class="line"><span class="keyword">namespace</span> Cipolla</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">    <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span> (y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                res = res * x;</span><br><span class="line">            x = x * x;</span><br><span class="line">            y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> t;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t = <span class="built_in">u</span>(e);</span><br><span class="line">            w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Cipolla::Csqrt;</span><br><span class="line"><span class="keyword">int</span> r[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, mid, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * gn % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polymul</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = ((len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>); i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = x[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (<span class="number">2</span> - (LL)y[i] * t[i] % P + P) * y[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">    y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">    y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; i++)</span><br><span class="line">y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">    t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">        ++num;</span><br><span class="line">    <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    STC <span class="keyword">int</span> t[N];</span><br><span class="line">    <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">    len -= num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        x[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        t[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">    len += num;</span><br><span class="line">    x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">    num = num * k3;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">        y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        y[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sq = <span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        x[i] = (LL)x[i] * inv % P;</span><br><span class="line">    <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)y[i] * sq % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注意模数不为998244353是要重新算img</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] + b[i]) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        t[i] = (LL)x[i] * img % P;</span><br><span class="line">    <span class="built_in">polyexp</span>(t, a, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(a, b, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        a[i] = (a[i] - b[i] + P) % P;</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(img &lt;&lt; <span class="number">1</span>, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = (LL)a[i] * inv % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> t[N], a[N], b[N];</span><br><span class="line">    <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">    <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">    <span class="built_in">polyinv</span>(b, t, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = a[i] * t[i] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyasin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = (<span class="number">1</span> - (LL)x[i] * x[i]% P + P) % P;</span><br><span class="line">    <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polysqrt</span>(b, c, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyinv</span>(c, b, len);</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyacos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">polyasin</span>(x, y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">        y[i] = y[i] ? P - y[i] : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">polyatan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">    <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        b[i] = (<span class="number">1</span> + (LL)x[i] * x[i]% P) % P;</span><br><span class="line">    <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &lt; tot; ++i)</span><br><span class="line">        b[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(c, tot, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * c[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">    <span class="keyword">int</span> n, op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;op);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P;</span><br><span class="line">    op ? <span class="built_in">polyatan</span>(a, b, n) : <span class="built_in">polyasin</span>(a, b, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拉格朗日反演"><a href="#拉格朗日反演" class="headerlink" title="拉格朗日反演"></a>拉格朗日反演</h2><p>不造有啥用，给个式子吧：</p><p>若两个多项式 $F(x), G(x)$ 满足常数项为0且1次项不为0，且两者互为复合</p><p>逆，即 $G(F(x)) = x$ （或者 $F(G(x)) = x$ ，它们是等价的），则有：<br>$$<br>\begin{aligned}<br>[x^n] F(x)<br>&amp; = \frac{1}{n} [x^{-1}] \frac{1}{G^n(x)} \\<br>&amp; = \frac{1}{n} [x^{n - 1}] (\frac{x}{G(x)})^n<br>\end{aligned}<br>$$<br>简证：<br>$$<br>\begin{aligned}<br>\sum_{i = 0}^{n - 1} a_i G^i(x) &amp; = x \\<br>\sum_{i = 0}^{n - 1} a_i i G^{i - 1}(x) G’(x) &amp; = 1 \\<br>\sum_{i = 0}^{n - 1} a_i i G^{i - n - 1}(x) G’(x) &amp; = \frac{1}{G^n(x)} \\<br>[x^{-1}] \sum_{i = 0}^{n - 1} a_i i G^{i - n - 1}(x) G’(x) &amp; = [x^{-1}] \frac{1}{G^n(x)} \\<br>对于 i \ne n : \\<br>G^{i - n - 1}(x) G’(x) &amp; = \frac{1}{i - n} (G^{i - n}(x))’ \\<br>求导, x^{-1} 系数为 0, 所以只考虑 i = n : \\<br>[x^{-1}] G^{-1}(x) G’(x) &amp; = 1 \\<br>[x^n] F(x) &amp; = \frac{1}{n} [x^{-1}] \frac{1}{G^n(x)} \\<br>\end{aligned}<br>$$</p><h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>由于那么多东西烦的很，于是封装了</p><p>千万别打 <code>class</code> 和shit一样，我用的 <code>namespace</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRG default_random_engine</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UID uniform_int_distribution</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mod, quadratic residue, original root</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Remember const int is faster than int</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">If you want to change, remember</span></span><br><span class="line"><span class="comment">I = min&#123;qpow(G, (P - 1) / 4), P - qpow(G, (P - 1) / 4)&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span>, I = <span class="number">86583718</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">This is a class for solving polynomial problems</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Its default data type is int32, However, when multiplication is</span></span><br><span class="line"><span class="comment">out of range, it will conversion is enforced</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Its default modulus is 998244353, but it can also be changed</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Note that when changing the modulus, remember to change the</span></span><br><span class="line"><span class="comment">original root at the same time, and the modulus should not be</span></span><br><span class="line"><span class="comment">too large, if the modulus exceeding int32 </span></span><br><span class="line"><span class="comment">may exceed int64 (that is, long long) when multiplying.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">And you should note that N is defined outside the class,</span></span><br><span class="line"><span class="comment">it represents the longest possible length of the polynomial,</span></span><br><span class="line"><span class="comment">generally 3 to 4 times the original length </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This is a class written by Dyd on December 30, 2021,</span></span><br><span class="line"><span class="comment">and hopes to help you</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//This is for fast exponentiation </span></span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">res = (LL)res * x % P;</span><br><span class="line">x = (LL)x * x % P;</span><br><span class="line">y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//This is Cipolla</span></span><br><span class="line">    <span class="keyword">namespace</span> Cipolla</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> w;</span><br><span class="line">        DRG e&#123;<span class="number">114514</span>&#125;;</span><br><span class="line">        <span class="function">UID&lt;<span class="keyword">int</span>&gt; <span class="title">u</span><span class="params">(<span class="number">1</span>, P - <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            <span class="keyword">int</span> x, y;</span><br><span class="line">            IL Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex t) <span class="keyword">const</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> (Complex)&#123;((LL)x * t.x % P + (LL)y * t.y % P * w % P) % P, ((LL)x * t.y % P + (LL)y * t.x % P) % P&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="function">IL Complex <span class="title">Cqpow</span><span class="params">(Complex x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Complex res = (Complex)&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">while</span> (y)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">                    res = res * x;</span><br><span class="line">                x = x * x;</span><br><span class="line">                y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">IL <span class="keyword">int</span> <span class="title">Csqrt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">qpow</span>(x, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">int</span> t;</span><br><span class="line">            <span class="keyword">while</span> (<span class="number">233</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                t = <span class="built_in">u</span>(e);</span><br><span class="line">                w = ((LL)t * t % P - x + P) % P;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">qpow</span>(w, (P - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) == P - <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="built_in">Cqpow</span>((Complex)&#123;t, <span class="number">1</span>&#125;, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>).x;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">min</span>(res, P - res);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//It records the flip subscript </span></span><br><span class="line">    <span class="keyword">int</span> r[N];</span><br><span class="line">    <span class="comment">//Fill x with y</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">fill</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i)</span><br><span class="line">            x[i] = y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">fill</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i)</span><br><span class="line">            x[i] = y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Ready bit and tot </span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ready</span><span class="params">(<span class="keyword">int</span> &amp;bit, <span class="keyword">int</span> &amp;tot, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tot = <span class="number">1</span>, bit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (tot &lt; (len &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//preprocess the flip subscript</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">get_r</span><span class="params">(<span class="keyword">int</span> bit, <span class="keyword">int</span> tot)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//NTT, remember to preprocess the flip subscript </span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> tot, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">                <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">        <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">        <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len);</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">-1</span>)</span><br><span class="line">                gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">            &#123;</span><br><span class="line">                g = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">                &#123;</span><br><span class="line">                    a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                    x[i + j] = (a + b) % P;</span><br><span class="line">                    x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        gn = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * gn % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial multiplication</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polymul</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * y[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="comment">//Remember to clear the number of bits that x does not need to 0 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial inversion</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyinv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            y[<span class="number">0</span>] = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">polyinv</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(t, x, <span class="number">0</span>, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            y[i] = (<span class="number">2</span> - (LL)t[i] * y[i] % P + P) % P * y[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Polynomial Division</span></span><br><span class="line"><span class="comment">    x divided by y quotient a remainder b</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polydiv</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> n, <span class="keyword">int</span> y[], <span class="keyword">int</span> m, <span class="keyword">int</span> a[], <span class="keyword">int</span> b[])</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> ta[N], tb[N];</span><br><span class="line">        <span class="keyword">int</span> dt = n - m + <span class="number">1</span>, tot, bit;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, n);</span><br><span class="line">        <span class="built_in">fill</span>(ta, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(tb, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">            ta[i] = y[m - i - <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">polyinv</span>(ta, tb, dt);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            ta[i] = x[n - i - <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            ta[i] = (LL)ta[i] * tb[i] %P;</span><br><span class="line">        <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dt; ++i)</span><br><span class="line">            a[i] = ta[dt - i - <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">fill</span>(ta, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(tb, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(ta, a, <span class="number">0</span>, dt);</span><br><span class="line">        <span class="built_in">fill</span>(tb, y, <span class="number">0</span>, m);</span><br><span class="line">        <span class="built_in">ntt</span>(ta, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(tb, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            ta[i] = (LL)ta[i] * tb[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(ta, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; ++i)</span><br><span class="line">            b[i] = (x[i] - ta[i] + P) % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial Derivative</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polydif</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            y[i - <span class="number">1</span>] = (LL)x[i] * i % P;</span><br><span class="line">        y[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial integral</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyint</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)x[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, P - <span class="number">2</span>) % P;</span><br><span class="line">        y[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial natural logarithm</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyln</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(x, b, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit,tot);</span><br><span class="line">        <span class="built_in">fill</span>(a, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(a, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial natural index</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyexp</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            y[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">polyexp</span>(x, y, (len + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">polyln</span>(y, t, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        t[<span class="number">0</span>] = (x[<span class="number">0</span>] + <span class="number">1</span> - t[<span class="number">0</span>] + P) % P;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; ++i)</span><br><span class="line">            t[i] = (x[i] - t[i] + P) % P;</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(t, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(y, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            y[i] = (LL)y[i] * t[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(y, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, len, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Polynomial power function</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    k1 is the real power(it could be modulo)</span></span><br><span class="line"><span class="comment">    k2 is for Euler&#x27;s theorem(it&#x27;s modulo by P - 1)</span></span><br><span class="line"><span class="comment">    k3 is to determine how many leading 0 there are</span></span><br><span class="line"><span class="comment">    we use them as the power is too large</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polypow</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> k1, <span class="keyword">int</span> k2, <span class="keyword">int</span> k3, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!x[num] &amp;&amp; num &lt; len)</span><br><span class="line">            ++num;</span><br><span class="line">        <span class="keyword">if</span> ((LL)num * k3 &gt;= len)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">fill</span>(y, <span class="number">0</span>, <span class="number">0</span>, len);</span><br><span class="line">        STC <span class="keyword">int</span> t[N];</span><br><span class="line">        <span class="keyword">int</span> x0 = x[num], inv = <span class="built_in">qpow</span>(x0, P - <span class="number">2</span>);</span><br><span class="line">        len -= num;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            x[i] = (LL)x[i + num] * inv % P;</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">fill</span>(x, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyln</span>(x, t, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            t[i] = (LL)t[i] * k1 % P;</span><br><span class="line">        <span class="built_in">fill</span>(t, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyexp</span>(t, y, len);</span><br><span class="line">        len += num;</span><br><span class="line">        x0 = <span class="built_in">qpow</span>(x0, k2);</span><br><span class="line">        num = num * k3;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= num; --i)</span><br><span class="line">            y[i] = (LL)y[i - num] * x0 % P;</span><br><span class="line">        <span class="built_in">fill</span>(y, <span class="number">0</span>, <span class="number">0</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    This is to get k1, k2, k3 for the k which is too large too be</span></span><br><span class="line"><span class="comment">    used in polypow</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">ready_for_pow</span><span class="params">(<span class="keyword">char</span> *k, <span class="keyword">int</span> &amp;k1, <span class="keyword">int</span> &amp;k2, <span class="keyword">int</span> &amp;k3)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        k1 = k2 = k3 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l = <span class="built_in">strlen</span>(k + <span class="number">1</span>); i &lt;= l; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            k1 = ((LL)k1 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % P;</span><br><span class="line">            k2 = ((LL)k2 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>)) % (P - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> ((LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>) &lt;= P)</span><br><span class="line">                k3 = (LL)k3 * <span class="number">10</span> + (k[i] ^ <span class="number">48</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial rooting</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polysqrt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sq = Cipolla::<span class="built_in">Csqrt</span>(x[<span class="number">0</span>]), inv = <span class="built_in">qpow</span>(x[<span class="number">0</span>], P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            x[i] = (LL)x[i] * inv % P;</span><br><span class="line">        <span class="built_in">polypow</span>(x, y, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, <span class="number">1</span>, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)y[i] * sq % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Polynomial trigonometric function</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Note that if the modulus is not</span></span><br><span class="line"><span class="comment">    998244353 I should be recalculated</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polysin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            a[i] = (LL)x[i] * I % P;</span><br><span class="line">        <span class="built_in">polyexp</span>(a, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            b[i] = (b[i] - c[i] + P) % P;</span><br><span class="line">        <span class="keyword">int</span> inv = <span class="built_in">qpow</span>((I &lt;&lt; <span class="number">1</span>) % P, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)b[i] * inv % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polycos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            a[i] = (LL)x[i] * I % P;</span><br><span class="line">        <span class="built_in">polyexp</span>(a, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            b[i] = (b[i] + c[i]) % P;</span><br><span class="line">        <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(<span class="number">2</span>, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = (LL)b[i] * inv % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polytan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polysin</span>(x, a, len);</span><br><span class="line">        <span class="built_in">polycos</span>(x, b, len);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = a[i] * c[i] % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Polynomial inverse trigonometric function</span></span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyasin</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            b[i] = (<span class="number">1</span> - (LL)x[i] * x[i]% P + P) % P;</span><br><span class="line">        <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polysqrt</span>(b, c, len);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, <span class="number">0</span>, tot);</span><br><span class="line">        <span class="built_in">polyinv</span>(c, b, len);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(b, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyacos</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">polyasin</span>(x, y, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">            y[i] = y[i] ? P - y[i] : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">IL <span class="keyword">void</span> <span class="title">polyatan</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        STC <span class="keyword">int</span> a[N], b[N], c[N];</span><br><span class="line">        <span class="built_in">polydif</span>(x, a, len);</span><br><span class="line">        <span class="keyword">int</span> bit, tot;</span><br><span class="line">        <span class="built_in">ready</span>(bit, tot, len);</span><br><span class="line">        <span class="built_in">get_r</span>(bit, tot);</span><br><span class="line">        <span class="built_in">ntt</span>(x, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            b[i] = (<span class="number">1</span> + (LL)x[i] * x[i]% P) % P;</span><br><span class="line">        <span class="built_in">ntt</span>(b, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">fill</span>(b, <span class="number">0</span>, len, tot);</span><br><span class="line">        <span class="built_in">polyinv</span>(b, c, len);</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">1</span>), <span class="built_in">ntt</span>(c, tot, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">            a[i] = (LL)a[i] * c[i] % P;</span><br><span class="line">        <span class="built_in">ntt</span>(a, tot, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">polyint</span>(a, y, len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    works</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 快速傅里叶变换,FFT </tag>
            
            <tag> 多项式 </tag>
            
            <tag> 快速数论变换,NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>快速数论变换</title>
      <link href="/2021/12/26/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2/"/>
      <url>/2021/12/26/%E5%BF%AB%E9%80%9F%E6%95%B0%E8%AE%BA%E5%8F%98%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<p> 不给好质数的出题人都***</p><span id="more"></span><h1 id="快速数论变换"><a href="#快速数论变换" class="headerlink" title="快速数论变换"></a>快速数论变换</h1><p>众所周知，FFT有两个缺陷：虚数常数大、无法支持取模</p><p>而NTT就巧妙的把这两个缺陷（<del>转化成另外的缺陷</del>）解决了</p><p>思路大体和FFT一样，不同的是，NTT不用虚数的单位根了，而用的是数论中的<strong>原根</strong></p><h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><p>设 $a \in \mathbb{Z}, p \in \mathbb{N_+}$ ，且 $gcd(a, p) = 1$ ，设 $d$ 为使 $a^d \equiv 1 \pmod p$ 成立的最小正整数，则称 $d$ 为 $a$ 在模 $p$ 意义下的<strong>阶</strong>，若 $d = \varphi(p)$ ，则称 $a$ 为 $p$ 的一个<strong>原根</strong></p><p>可以证明，<strong>奇质数一定存在原根</strong></p><p>原根有一个关键性质：**若 $g$ 是 $p$ 的原根，则 $g^i \mod p(i \in [1, p - 1])$ 两两不同且取遍 $[1, p - 1]$**，则让我们可以取原根做点值表达式的点</p><p>下面用 $g_n$ 表示 $g^{\frac{p - 1}{n}}$ </p><p>而原根也和虚数一样满足折半引理、消去引理和求和引理，即（以下都在模 $p$ 意义下）：</p><ul><li>  $g_n^n = 1$ </li><li> $g_n^{k + \frac{n}{2}} = -g_n^k$ </li><li> $g_{dn}^{dk} = g_{n}^k$ </li><li> $(g_n^{k + \frac{n}{2}})^2 = g_n^{2k + n} = g_n^{2k}$ </li></ul><p>也就是说，在FFT中用到的虚数的性质原根都有，而且原根支持取模</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span> + <span class="number">5</span>, P = <span class="number">998244353</span>; <span class="comment">//注意N要大于二倍n</span></span><br><span class="line"><span class="keyword">int</span> r[N], bit, tot;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = (LL)res * x % P;</span><br><span class="line">        x = (LL)x * x % P;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i])</span><br><span class="line">            <span class="built_in">swap</span>(x[i], x[r[i]]);</span><br><span class="line">    <span class="keyword">int</span> mid, i, j, len, gn, g, a, b;</span><br><span class="line">    <span class="keyword">for</span> (mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        len = mid &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        这里可以预处理3和inv的次幂卡常</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        gn = <span class="built_in">qpow</span>(<span class="number">3</span>, (P - <span class="number">1</span>) / len); <span class="comment">//3是998244353的原根</span></span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">-1</span>) <span class="comment">//负数的bool值是true!</span></span><br><span class="line">            gn = <span class="built_in">qpow</span>(gn, P - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; tot; i += len)</span><br><span class="line">        &#123;</span><br><span class="line">            g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; mid; ++j, g = (LL)g * gn % P)</span><br><span class="line">            &#123;</span><br><span class="line">                a = x[i + j], b = (LL)g * x[i + j + mid] % P;</span><br><span class="line">                x[i + j] = (a + b) % P;</span><br><span class="line">                x[i + j + mid] = (a - b + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]), a[i] = (a[i] + P) % P; <span class="comment">//一定要保证是正数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]), b[i] = (b[i] + P) % P;</span><br><span class="line">    bit = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (tot &lt;= n + m)</span><br><span class="line">        tot &lt;&lt;= <span class="number">1</span>, ++bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">ntt</span>(a, <span class="number">1</span>), <span class="built_in">ntt</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; ++i)</span><br><span class="line">        a[i] = (LL)a[i] * b[i] % P;</span><br><span class="line">    <span class="built_in">ntt</span>(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> inv = <span class="built_in">qpow</span>(tot, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, (LL)a[i] * inv % P);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="关于质数"><a href="#关于质数" class="headerlink" title="关于质数"></a>关于质数</h2><p>模数必须是 $2^n + 1$ 的形式且 $n$ 要足够大常见的有998244353，1004535809，469762049它们的原根都是3</p><p>具体的，见表：</p><p>设 $P = k2^r + 1$ ，原根为 $g$ </p><table><thead><tr><th>P</th><th>r</th><th>k</th><th>g</th></tr></thead><tbody><tr><td>81788929</td><td>21</td><td>39</td><td>7</td></tr><tr><td>104857601</td><td>21</td><td>50</td><td>3</td></tr><tr><td>104857601</td><td>22</td><td>25</td><td>3</td></tr><tr><td>113246209</td><td>21</td><td>54</td><td>7</td></tr><tr><td>113246209</td><td>22</td><td>27</td><td>7</td></tr><tr><td>132120577</td><td>21</td><td>63</td><td>5</td></tr><tr><td>136314881</td><td>21</td><td>65</td><td>3</td></tr><tr><td>138412033</td><td>21</td><td>66</td><td>5</td></tr><tr><td>155189249</td><td>21</td><td>74</td><td>6</td></tr><tr><td>167772161</td><td>23</td><td>20</td><td>3</td></tr><tr><td>249561089</td><td>21</td><td>119</td><td>3</td></tr><tr><td>377487361</td><td>21</td><td>180</td><td>7</td></tr><tr><td>377487361</td><td>22</td><td>90</td><td>7</td></tr><tr><td>383778817</td><td>21</td><td>183</td><td>5</td></tr><tr><td>415236097</td><td>22</td><td>99</td><td>5</td></tr><tr><td>415236097</td><td>21</td><td>198</td><td>5</td></tr><tr><td>469762049</td><td>24</td><td>28</td><td>3</td></tr><tr><td>469762049</td><td>21</td><td>224</td><td>3</td></tr><tr><td>469762049</td><td>23</td><td>56</td><td>3</td></tr><tr><td>469762049</td><td>22</td><td>112</td><td>3</td></tr><tr><td>576716801</td><td>21</td><td>275</td><td>6</td></tr><tr><td>645922817</td><td>22</td><td>154</td><td>3</td></tr><tr><td>645922817</td><td>21</td><td>308</td><td>3</td></tr><tr><td>666894337</td><td>21</td><td>318</td><td>5</td></tr><tr><td>683671553</td><td>22</td><td>163</td><td>3</td></tr><tr><td>740294657</td><td>21</td><td>353</td><td>3</td></tr><tr><td>897581057</td><td>22</td><td>214</td><td>3</td></tr><tr><td>897581057</td><td>21</td><td>428</td><td>3</td></tr><tr><td>918552577</td><td>22</td><td>219</td><td>5</td></tr><tr><td>935329793</td><td>22</td><td>223</td><td>3</td></tr><tr><td>935329793</td><td>21</td><td>446</td><td>3</td></tr><tr><td>950009857</td><td>21</td><td>453</td><td>7</td></tr><tr><td>962592769</td><td>21</td><td>459</td><td>7</td></tr><tr><td>998244353</td><td>23</td><td>119</td><td>3</td></tr><tr><td>1004535809</td><td>21</td><td>479</td><td>3</td></tr><tr><td>1107296257</td><td>23</td><td>132</td><td>10</td></tr><tr><td>1107296257</td><td>24</td><td>66</td><td>10</td></tr><tr><td>1107296257</td><td>21</td><td>528</td><td>10</td></tr><tr><td>1138753537</td><td>21</td><td>543</td><td>5</td></tr><tr><td>1161822209</td><td>22</td><td>277</td><td>3</td></tr><tr><td>1161822209</td><td>21</td><td>554</td><td>3</td></tr><tr><td>1205862401</td><td>21</td><td>575</td><td>3</td></tr><tr><td>1212153857</td><td>22</td><td>289</td><td>3</td></tr><tr><td>1212153857</td><td>21</td><td>578</td><td>3</td></tr><tr><td>1214251009</td><td>21</td><td>579</td><td>7</td></tr><tr><td>1218445313</td><td>21</td><td>581</td><td>3</td></tr><tr><td>1224736769</td><td>22</td><td>292</td><td>3</td></tr><tr><td>1224736769</td><td>21</td><td>584</td><td>3</td></tr><tr><td>1281359873</td><td>21</td><td>611</td><td>3</td></tr><tr><td>1300234241</td><td>23</td><td>155</td><td>3</td></tr><tr><td>1300234241</td><td>21</td><td>620</td><td>3</td></tr><tr><td>1306525697</td><td>21</td><td>623</td><td>3</td></tr><tr><td>1327497217</td><td>21</td><td>633</td><td>5</td></tr><tr><td>1438646273</td><td>21</td><td>686</td><td>3</td></tr><tr><td>1484783617</td><td>21</td><td>708</td><td>5</td></tr><tr><td>1570766849</td><td>21</td><td>749</td><td>3</td></tr><tr><td>1709178881</td><td>21</td><td>815</td><td>3</td></tr><tr><td>1835008001</td><td>21</td><td>875</td><td>6</td></tr><tr><td>1866465281</td><td>22</td><td>445</td><td>3</td></tr><tr><td>1866465281</td><td>21</td><td>890</td><td>3</td></tr><tr><td>1893728257</td><td>21</td><td>903</td><td>5</td></tr><tr><td>1931476993</td><td>21</td><td>921</td><td>5</td></tr><tr><td>2088763393</td><td>22</td><td>498</td><td>5</td></tr><tr><td>2113929217</td><td>22</td><td>504</td><td>5</td></tr><tr><td>2113929217</td><td>25</td><td>63</td><td>5</td></tr><tr><td>2113929217</td><td>23</td><td>252</td><td>5</td></tr><tr><td>2130706433</td><td>22</td><td>508</td><td>3</td></tr><tr><td>2130706433</td><td>23</td><td>254</td><td>3</td></tr><tr><td>2281701377</td><td>27</td><td>17</td><td>3</td></tr><tr><td>2483027969</td><td>23</td><td>296</td><td>3</td></tr><tr><td>2483027969</td><td>25</td><td>74</td><td>3</td></tr><tr><td>2533359617</td><td>24</td><td>151</td><td>3</td></tr><tr><td>2533359617</td><td>23</td><td>302</td><td>3</td></tr><tr><td>2558525441</td><td>23</td><td>305</td><td>3</td></tr><tr><td>2671771649</td><td>22</td><td>637</td><td>3</td></tr><tr><td>2680160257</td><td>22</td><td>639</td><td>7</td></tr><tr><td>2717908993</td><td>22</td><td>648</td><td>5</td></tr><tr><td>2717908993</td><td>24</td><td>162</td><td>5</td></tr><tr><td>2722103297</td><td>22</td><td>649</td><td>3</td></tr><tr><td>2780823553</td><td>22</td><td>663</td><td>10</td></tr><tr><td>2885681153</td><td>24</td><td>172</td><td>3</td></tr><tr><td>2885681153</td><td>26</td><td>43</td><td>3</td></tr><tr><td>2910846977</td><td>22</td><td>694</td><td>3</td></tr><tr><td>2998927361</td><td>22</td><td>715</td><td>3</td></tr><tr><td>3112173569</td><td>22</td><td>742</td><td>2</td></tr><tr><td>3221225473</td><td>24</td><td>192</td><td>3</td></tr><tr><td>3221225473</td><td>25</td><td>96</td><td>3</td></tr><tr><td>3221225473</td><td>26</td><td>48</td><td>3</td></tr><tr><td>3238002689</td><td>22</td><td>772</td><td>2</td></tr><tr><td>3238002689</td><td>23</td><td>386</td><td>2</td></tr><tr><td>3313500161</td><td>22</td><td>790</td><td>2</td></tr><tr><td>3414163457</td><td>23</td><td>407</td><td>3</td></tr><tr><td>3435134977</td><td>22</td><td>819</td><td>2</td></tr><tr><td>3451912193</td><td>22</td><td>823</td><td>2</td></tr><tr><td>3489660929</td><td>23</td><td>416</td><td>2</td></tr><tr><td>3489660929</td><td>25</td><td>104</td><td>2</td></tr><tr><td>3489660929</td><td>22</td><td>832</td><td>2</td></tr><tr><td>3510632449</td><td>22</td><td>837</td><td>2</td></tr><tr><td>3577741313</td><td>22</td><td>853</td><td>2</td></tr><tr><td>3615490049</td><td>23</td><td>431</td><td>2</td></tr><tr><td>3615490049</td><td>22</td><td>862</td><td>2</td></tr><tr><td>3628072961</td><td>22</td><td>865</td><td>2</td></tr><tr><td>3665821697</td><td>23</td><td>437</td><td>2</td></tr><tr><td>3686793217</td><td>22</td><td>879</td><td>2</td></tr><tr><td>3749707777</td><td>23</td><td>447</td><td>2</td></tr><tr><td>3892314113</td><td>23</td><td>464</td><td>2</td></tr><tr><td>3892314113</td><td>25</td><td>116</td><td>2</td></tr><tr><td>3892314113</td><td>24</td><td>232</td><td>2</td></tr><tr><td>3892314113</td><td>22</td><td>928</td><td>2</td></tr><tr><td>3938451457</td><td>22</td><td>939</td><td>2</td></tr><tr><td>3942645761</td><td>23</td><td>470</td><td>2</td></tr><tr><td>3942645761</td><td>24</td><td>235</td><td>2</td></tr><tr><td>3942645761</td><td>22</td><td>940</td><td>2</td></tr><tr><td>4013948929</td><td>22</td><td>957</td><td>2</td></tr><tr><td>4194304001</td><td>24</td><td>250</td><td>2</td></tr><tr><td>4253024257</td><td>23</td><td>507</td><td>2</td></tr><tr><td>4630511617</td><td>26</td><td>69</td><td>2</td></tr><tr><td>4630511617</td><td>25</td><td>138</td><td>2</td></tr><tr><td>4882169857</td><td>24</td><td>291</td><td>2</td></tr><tr><td>4882169857</td><td>23</td><td>582</td><td>2</td></tr><tr><td>5158993921</td><td>23</td><td>615</td><td>2</td></tr><tr><td>5175771137</td><td>23</td><td>617</td><td>2</td></tr><tr><td>5251268609</td><td>23</td><td>626</td><td>2</td></tr><tr><td>5528092673</td><td>23</td><td>659</td><td>2</td></tr><tr><td>5536481281</td><td>24</td><td>330</td><td>2</td></tr><tr><td>5578424321</td><td>23</td><td>665</td><td>2</td></tr><tr><td>5788139521</td><td>24</td><td>345</td><td>2</td></tr><tr><td>5788139521</td><td>23</td><td>690</td><td>2</td></tr><tr><td>5838471169</td><td>25</td><td>174</td><td>2</td></tr><tr><td>5838471169</td><td>26</td><td>87</td><td>2</td></tr><tr><td>6014631937</td><td>23</td><td>717</td><td>2</td></tr><tr><td>6165626881</td><td>23</td><td>735</td><td>2</td></tr><tr><td>6333399041</td><td>23</td><td>755</td><td>2</td></tr><tr><td>6434062337</td><td>23</td><td>767</td><td>2</td></tr><tr><td>6534725633</td><td>23</td><td>779</td><td>2</td></tr><tr><td>6593445889</td><td>24</td><td>393</td><td>2</td></tr><tr><td>6660554753</td><td>23</td><td>794</td><td>2</td></tr><tr><td>6719275009</td><td>23</td><td>801</td><td>2</td></tr><tr><td>6811549697</td><td>25</td><td>203</td><td>2</td></tr><tr><td>6811549697</td><td>23</td><td>812</td><td>2</td></tr><tr><td>6996099073</td><td>23</td><td>834</td><td>2</td></tr><tr><td>6996099073</td><td>24</td><td>417</td><td>2</td></tr><tr><td>7096762369</td><td>24</td><td>423</td><td>2</td></tr><tr><td>7348420609</td><td>24</td><td>438</td><td>2</td></tr><tr><td>7348420609</td><td>25</td><td>219</td><td>2</td></tr><tr><td>7474249729</td><td>23</td><td>891</td><td>2</td></tr><tr><td>7566524417</td><td>23</td><td>902</td><td>2</td></tr><tr><td>7717519361</td><td>26</td><td>115</td><td>2</td></tr><tr><td>7717519361</td><td>25</td><td>230</td><td>2</td></tr><tr><td>7717519361</td><td>23</td><td>920</td><td>2</td></tr><tr><td>7818182657</td><td>23</td><td>932</td><td>2</td></tr><tr><td>7843348481</td><td>23</td><td>935</td><td>2</td></tr><tr><td>7918845953</td><td>27</td><td>59</td><td>2</td></tr><tr><td>8170504193</td><td>24</td><td>487</td><td>2</td></tr><tr><td>8220835841</td><td>25</td><td>245</td><td>2</td></tr><tr><td>8220835841</td><td>23</td><td>980</td><td>2</td></tr><tr><td>8279556097</td><td>23</td><td>987</td><td>2</td></tr><tr><td>8858370049</td><td>26</td><td>132</td><td>2</td></tr><tr><td>8858370049</td><td>27</td><td>66</td><td>2</td></tr><tr><td>9177137153</td><td>24</td><td>547</td><td>2</td></tr><tr><td>9227468801</td><td>25</td><td>275</td><td>2</td></tr><tr><td>9865003009</td><td>24</td><td>588</td><td>2</td></tr><tr><td>10267656193</td><td>24</td><td>612</td><td>2</td></tr><tr><td>10267656193</td><td>26</td><td>153</td><td>2</td></tr><tr><td>10267656193</td><td>25</td><td>306</td><td>2</td></tr><tr><td>10619977729</td><td>24</td><td>633</td><td>2</td></tr><tr><td>10871635969</td><td>26</td><td>162</td><td>2</td></tr><tr><td>10871635969</td><td>24</td><td>648</td><td>2</td></tr><tr><td>10871635969</td><td>25</td><td>324</td><td>2</td></tr><tr><td>11123294209</td><td>24</td><td>663</td><td>2</td></tr><tr><td>11173625857</td><td>25</td><td>333</td><td>2</td></tr><tr><td>11173625857</td><td>24</td><td>666</td><td>2</td></tr><tr><td>11341398017</td><td>26</td><td>169</td><td>2</td></tr><tr><td>11341398017</td><td>25</td><td>338</td><td>2</td></tr><tr><td>11693719553</td><td>24</td><td>697</td><td>2</td></tr><tr><td>12297699329</td><td>24</td><td>733</td><td>2</td></tr><tr><td>12348030977</td><td>27</td><td>92</td><td>2</td></tr><tr><td>12348030977</td><td>25</td><td>368</td><td>2</td></tr><tr><td>12348030977</td><td>26</td><td>184</td><td>2</td></tr><tr><td>13186891777</td><td>25</td><td>393</td><td>2</td></tr><tr><td>13757317121</td><td>26</td><td>205</td><td>2</td></tr><tr><td>13857980417</td><td>25</td><td>413</td><td>2</td></tr><tr><td>13857980417</td><td>24</td><td>826</td><td>2</td></tr><tr><td>14042529793</td><td>24</td><td>837</td><td>2</td></tr><tr><td>14092861441</td><td>26</td><td>210</td><td>2</td></tr><tr><td>14092861441</td><td>27</td><td>105</td><td>2</td></tr><tr><td>14092861441</td><td>24</td><td>840</td><td>2</td></tr><tr><td>15065939969</td><td>24</td><td>898</td><td>2</td></tr><tr><td>15065939969</td><td>25</td><td>449</td><td>2</td></tr><tr><td>15619588097</td><td>24</td><td>931</td><td>2</td></tr><tr><td>15653142529</td><td>24</td><td>933</td><td>2</td></tr><tr><td>15854469121</td><td>24</td><td>945</td><td>2</td></tr><tr><td>16475226113</td><td>24</td><td>982</td><td>2</td></tr><tr><td>16575889409</td><td>24</td><td>988</td><td>2</td></tr><tr><td>16626221057</td><td>24</td><td>991</td><td>2</td></tr><tr><td>17314086913</td><td>26</td><td>258</td><td>2</td></tr><tr><td>17314086913</td><td>25</td><td>516</td><td>2</td></tr><tr><td>17314086913</td><td>27</td><td>129</td><td>2</td></tr><tr><td>18387828737</td><td>26</td><td>274</td><td>2</td></tr><tr><td>19998441473</td><td>26</td><td>298</td><td>2</td></tr><tr><td>19998441473</td><td>25</td><td>596</td><td>2</td></tr><tr><td>20501757953</td><td>25</td><td>611</td><td>2</td></tr></tbody></table><h2 id="三模数NTT"><a href="#三模数NTT" class="headerlink" title="三模数NTT"></a>三模数NTT</h2><p>对于模数不符合要求的，可以用这三个质数分别NTT，用中国剩余定理合并（要求答案小于它们的积），一般来说可以应付系数不超过 $10^{23}$ 的情况</p><p>然鹅，拆系数FFT跑得比它快……</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 多项式 </tag>
            
            <tag> 快速数论变换,NTT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文章密码</title>
      <link href="/2021/12/24/%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81/"/>
      <url>/2021/12/24/%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c360df3eab9b6fc27ed3a2a46bfdb659f366c02390573ca04dbdc8b9c7732600">fb7f687860606098f1ad1cb36041d4e3ac537c2c4647f3d67e3b11a8c7ee588e1c7ca94440e71812a71af5c098d2f09cb95d70bfa129432469064c7c37a746ac9e48dd7a73101584b7db912bb8fc955c587e056548a9972225090ed57b1ad9b2c39bac7b4465451af25420f3a38931f70ac021a27ff02591a413abdfedcdfd824e700fd50dc0f63c859e4956529889f2a9d94b605d7510b5f091e10a4400a6438a8e95def3b721e3651ca534691c334d1dcf733169f11e9e2d642644156dcce4d57f90ef0a44e88684f48e0a6172cdd4e2707fbc0b8563e15597d99e044f8f1fb27c941524582e91594e3275d0a8c5b82c37a7eaffaab23edf2379378a627f9cc72af3b96cdf1a541bdb79df12b5c4c8bc78dab851a8a19a07e90ca504c4c8ee43a50d9b182dde1ea29e58372b5cf510d7b3c2d5b38936934a34e1008cfa61f2ed9cfa7da4cf86b8f1523918ffe90e6e53ab2b86f25e23e3eedef8c7b8dba566cfe61fc678bacdc6d1949cdac7eb812a4b7ddc1f7396b73bca4963ec2ffb8b288a3d4c0a1eb71f8d4b3c92d33676059f05de3ecd5297a41123e7b254fc49f6ab0eda5f22fa36e4b992110387a422e8f23a8460651deec85efdf17b6a39d7742fd0186e91e59db1f789b109fbb61c6a17a883ce119498d8c89d6461c7f44126171b38e5465889e7c7916bdcfb7e00aa933ef8db9df4e971cfc9ec43c9e1bae758c725642d596b0b6b969f9f69c8e29330ec2bfaec28a0578130dc2516a089c7dcbbcd74e9313e5c184daf3322cf6592db3cff2cd61beacf318977b9b8ef0fc3a2a06f1eb46b9970856cdb1e10cd791bcc5fed520a185f740085d7544ddcdd933a90df89c9416a5c826aa9d4c509ca2fd10a2ad6f93a739ebceff8313350e12006b2523f161c28087f9a9b17e3f73da08d486288852f91d5f111a99d9205ee361ce9498963d24769b38f3d365a4c3de2e524ac74f21b95a61e5e8d87bc95c4b6b60b0b0a04d6572b936c59a410d39002beadcc46f7ea7d025e445599479491df5cb69e74c223ac30aba680409efd19042915c0590365d96c6b7fe9245890e075a1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 其它 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>后缀自动机</title>
      <link href="/2021/12/23/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
      <url>/2021/12/23/%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<p> 自动机/鸡/姬，到底那个好</p><span id="more"></span><h1 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p><strong>后缀自动机</strong>（SAM）是一个<strong>状态机</strong>，他有<strong>一个起点</strong>，<strong>若干终点</strong>，原串的所有本质不同子串和从SAM起点开始的所有路径<strong>一一对应，不重不漏</strong>，所以终点就是包含后缀的点</p><p>简单来说就是用一个边上有字符的DAG存储下了一个字符串的所有子串（当然Trie也可以做到，但是Trie的点数和边数都是 $O(n^2)$ 而SAM的点数和边数都是 $O(n)$ 的）</p><h2 id="一些性质"><a href="#一些性质" class="headerlink" title="一些性质"></a>一些性质</h2><p>再继续讨论SAM前，我们必须先知道一些东西</p><h3 id="endpos"><a href="#endpos" class="headerlink" title="endpos"></a>endpos</h3><p>定义函数 $endpos(S)$ 表示<strong>子串 $S$ 在原串中出现的位置的尾字母下标集合</strong>，如对于字符串“abcbabc”，有 $endpos(ab) = \{2, 6\}$ </p><p>endpos有以下结论（<strong>较常用</strong>）：</p><ol><li><p>对于两个子串 $s_1, s_2$ ，有：<br>$$<br>\begin{aligned}<br>&amp; s_1是s_2的后缀 \Leftrightarrow endpos(s_2) \subseteq endpos(s_1) \\<br>&amp; s_1不是是s_2的后缀 \Leftrightarrow endpos(s_2) \wedge endpos(s_1) = \phi \\<br>\end{aligned}<br>$$<br>正确性可以感性理解一下</p></li><li><p>两个不同子串的endpos，要么有包含关系，要么没有交集，可以理解为，它们要么有后缀关系，要么没有</p></li></ol><p>对于endpos相同的子串，我们将它们归为一个<strong>endpos等价类</strong>，对于任意一个endpos等价类，将包含在其中的所有子串依长度从大到小排序，则每一个子串的长度均为上一个子串的长度减1，且为上一个子串的后缀（简单来说，一个endpos等价类内的串的长度连续）</p><p>定义  $longest(st), shortest(st)$ ，表示endpos等价类 $st$ 中最长，最短的子串，由以上定义可知：对于 $longest(st)$ 的任意后缀 $s$ ，如果 $| shortest(st) | \le | s | \le | longsest(st) |$ ，则 $s \in st$  </p><p>而我们还有一个结论：</p><p><strong>endpos等价类个数的级别为 $O(n)$</strong> </p><p>对于一个类（endpos等价类） $st$ ，在 $longest(st)$ 前添加任意一个字符（满足新形成的字符串为原串子串），得到的字符串必然不属于此类，因此会得到若干个新的类，得到新形成的字符串的endpos必然为 $endpos(longest(st))$ 的子集，并且分别添加两个不同的字符，所得到的两个字符串的endpos必然完全不相交，所以对于此操作（添加一个字符），我们可以认为是对一个原集合进行分割，分割得到几个新的集合，且保留原集合，新的集合还可以继续分割，但是总的分割的次数不会超过原集合的大小，所以最终形成的集合个数也不会超过 $2n$ </p><h3 id="parent-tree"><a href="#parent-tree" class="headerlink" title="parent tree"></a>parent tree</h3><p>考虑上面类的划分过程，将一个串前面添加字符，得到新的类，这种关系可以构成一棵<strong>树</strong>，如对于串“aababa”（图中红色串为每个类的最长串）：</p><p><img src="https://s2.loli.net/2021/12/23/ycUCONS1Aa2fvVd.png" alt="pt"></p><p>于是，类之间就有了父子关系，我们称这棵树为<strong>parent tree</strong>，记类 $a$ 的父节点为 $fa(a)$ </p><p>也有个结论：<br>$$<br>|longest(fa(a))| + 1 = |shortest(a)|<br>$$<br>正确性很显然，从建树的步骤中就可以看出，在一个类中的最长子串前再添加一个字符，形成的字符串就必然属于其儿子中的一类，且这个新形成的字符串肯定是它所属的类中最短的一个，所以我们只需储存 $|longest(a)|$ </p><p>那么定义那么多有什么用呢？其实，<strong>SAM的节点就是parent tree中的节点</strong>，只不过二者的边不同，其中空串所属的节点（parent tree的根）就是后缀自动机的源点，而最大子串（整个原串）所属于的节点，以及其在parent tree上的祖先就是终点，如图即是一个SAM，蓝色为SAM的边，橘色为终点：</p><p><img src="https://s2.loli.net/2021/12/23/3iyroqBa6Fw1MId.png" alt="SAM"></p><p>根据定义，SAM的边应该满足：<strong>从源点出发到达点 $i$ 的任意一条路径形成的字符串均属于节点  $i$ 所代表的类</strong></p><p>二者边的主要区别为，延parent tree的边往下走是在字符串<strong>前面</strong>添加字符，延自动机的边往下走是在字符串<strong>后面</strong>添加字符，故parent tree主要用来求节点（即各个字符串）的性质，而后缀自动机本身则主要用来直接跑字符串</p><h3 id="数量级"><a href="#数量级" class="headerlink" title="数量级"></a>数量级</h3><p>前面证过，<strong>SAM的点数为 $O(n)$</strong></p><p>下面证明：<strong>SAM的边数为 $O(n)$</strong> </p><p>先取<strong>后缀自动机的任意一棵生成树</strong>（不是parent tree），这棵树一定与点数同级，即 $O(n)$ ，那么我们考虑向这棵生成树中加边</p><p>对于每个终止节点，我们按一定顺序跑遍属于它的子串（跑的时候逆着边的方向），如果能顺利跑回源点，则跑下一个子串；否则，说明我们需要加边，每次连上本应该跑回的边，沿它跑回下一个节点（这里若干次加边后得到一条回源点的路可能不是对于的当前串，但没关系，因为它一定对于终点的某一个子串，我们下次跑那个子串的时候就不必加边了，之后重跑我们原本希望跑的子串，直到真正顺利跑完这个子串）</p><p>这样，当跑完所有终止节点时，在原本的生成树上增加的边不会超过后缀的个数，即 $n$ 个，故总的边数是 $O(n)$ 级的</p><h2 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h2><p>那么如何构造SAM呢？</p><p>先看看构造好的长啥样（这个SAM比较特殊，只有一个终点）：</p><p><img src="https://s2.loli.net/2021/12/23/n1TRXCxIJgzH95q.jpg" alt="SAM2"></p><p>那整齐的一行节点表示的就是各个前缀所属的节点，显然，对于任意一个前缀，它在它所属的类中长度是最长的（不能再在其前面添加字符）</p><p>而相邻两个前缀所属点之间也肯定有连边，当然，不相邻的节点之间也会有一些边</p><p>上面那些零零散散的节点则是不包含任意一个前缀的节点</p><p>而蓝色的边就是SAM中正常的边，绿色的边是parent tree</p><p>SAM的构造是在线的，即我们通过不断添加单个字符的方式构建后缀自动机，时刻调整其状态</p><p>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="comment">//1为空节点</span></span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>; <span class="comment">//last:未加入此字符前最长的前缀所属的节点的编号</span></span><br><span class="line"><span class="comment">//这里的节点只维护了最长的串,因为所有长度小于它但同结尾的串一定被它的祖先维护了</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> len, fa; <span class="comment">//最长长度,父节点</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">26</span>]; <span class="comment">//类似于Trie</span></span><br><span class="line">&#125; nd[N &lt;&lt; <span class="number">1</span>]; <span class="comment">//开2倍</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> p = last, np = last = ++tot;</span><br><span class="line">nd[np].len = nd[p].len + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (; p &amp;&amp; !nd[p].ch[x]; p = nd[p].fa) <span class="comment">//遍历所有长度小于它但同结尾的串,加字符</span></span><br><span class="line">nd[p].ch[x] = np;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">如果最后形成的新字符串没有旧串里出现过,</span></span><br><span class="line"><span class="comment">说明x实际上是一个在旧串中没有出现过的字符</span></span><br><span class="line"><span class="comment">因此不可能存在除节点1以外的祖先</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span> (!p)</span><br><span class="line">nd[np].fa = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> q = nd[p].ch[x];</span><br><span class="line"><span class="keyword">if</span> (nd[q].len == nd[p].len + <span class="number">1</span>) <span class="comment">//判断np是否为q的子节点</span></span><br><span class="line">nd[np].fa = q;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">//不是就说明q含了不该含的子串,直接新建节点为np的父节点</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> nq = ++tot;</span><br><span class="line">nd[nq] = nd[q], nd[nq].len = nd[p].len + <span class="number">1</span>; <span class="comment">//这里就相当于去掉不该含的串</span></span><br><span class="line">nd[q].fa = nd[np].fa = nq;</span><br><span class="line"><span class="keyword">for</span> (; p &amp;&amp; nd[p].ch[x] == q; p = nd[p].fa) <span class="comment">//同理跟新</span></span><br><span class="line">nd[p].ch[x] = nq;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; sam;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 后缀自动机,SAM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行列式和基尔霍夫矩阵</title>
      <link href="/2021/12/22/%E8%A1%8C%E5%88%97%E5%BC%8F%E5%92%8C%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/"/>
      <url>/2021/12/22/%E8%A1%8C%E5%88%97%E5%BC%8F%E5%92%8C%E5%9F%BA%E5%B0%94%E9%9C%8D%E5%A4%AB%E7%9F%A9%E9%98%B5/</url>
      
        <content type="html"><![CDATA[<p>  神仙数学，一起递归式学的，就写在一起吧</p><span id="more"></span><h1 id="行列式和基尔霍夫矩阵"><a href="#行列式和基尔霍夫矩阵" class="headerlink" title="行列式和基尔霍夫矩阵"></a>行列式和基尔霍夫矩阵</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>给定一个无向图 $G(V, E)$ </p><ul><li><p>度数矩阵 $D$ ：当 $i \ne j$ 时，  $D[i][j] = 0$ ，否则  $D[i][j] = 点 i(j) 的度数$ </p></li><li><p>邻接矩阵 $A$ ：当 $(u, v) \in E$ 时， $A[u][v] = 1$ ，否则 $A[u][v] = 0$ </p></li><li><p><strong>基尔霍夫矩阵</strong>(Kirchhoff)  $K$ ，也称<strong>拉普拉斯算子</strong>：定义为 $K = D - A$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/VatPLREvlyDocXh.png" alt="K"></p></li><li><p><a href="https://baike.baidu.com/item/%E8%A1%8C%E5%88%97%E5%BC%8F/2010180"><strong>行列式</strong></a>：对于一个 $n \times n$ 的矩阵 $X$ ，其行列式定义为 $\det(X) = \mid X \mid = \sum_{p} (-1)^{\tau(p)} \prod_{i = 1}^n a_{i, p_i}$ ，其中 $p$ 取遍 $1 \sim n$ 的全排列， $\tau(p)$ 表示<strong>排列 $p$ 的逆序对个数</strong>，行列式可以理解为所有列向量所夹的几何体的有向体积，这样可以结合从几何直观出发理解为线性变换的伸缩因子（没有屁用）</p></li><li><p><strong>排列的奇偶性</strong>：定义排列 $p$ 的奇偶性为 $\tau(p)$ 的奇偶性</p></li><li><p><strong>对换</strong>：交换一个排列 $p$ 中的两个元素 $p_i, p_j (i \ne j)$ ，其它元素不变</p></li></ul><h2 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h2><p>我们来看如何快速求出行列式</p><h3 id="关于排列的奇偶性"><a href="#关于排列的奇偶性" class="headerlink" title="关于排列的奇偶性"></a>关于排列的奇偶性</h3><p>关于排列的奇偶性，有两个性质：</p><ol><li><strong>对于 $n(n \ge 2)$ 阶排列的所有排列情况，奇排列和偶排列各占一半</strong></li><li><strong>一个排列可以通过若干次对换变成一个元素严格递增的自然排列，对换次数的奇偶性与原排列的奇偶性相同</strong></li></ol><h3 id="关于行列式的性质"><a href="#关于行列式的性质" class="headerlink" title="关于行列式的性质"></a>关于行列式的性质</h3><ol><li><p>交换对应矩阵的2行（列），行列式取反</p></li><li><p>交换对应矩阵的1行和1列（进行一次<strong>矩阵转置</strong>），行列式不变</p></li><li><p>行列式的行（列）所有元素等比例变化，则行列式也等比例变化，如图：</p><p><img src="https://s2.loli.net/2021/12/22/Mj3HBxZNmVEyDhz.png" alt="行列k"></p></li><li><p>如果行列式对应矩阵 $A$ 中有一行（列），是对应2个矩阵 $B, C$ 中分别的2行（列）所有元素之和，且 $B, C$ 中其它元素都等于 $A$ 中对于元素，则有  $\mid A \mid = \mid B \mid + \mid C \mid$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/aGZFo8zKqbBiefm.png" alt="行列式1"></p></li><li><p>如果一个矩阵存在两行（列）成比例则 $\mid A \mid = 0$ ，如图：</p><p><img src="https://s2.loli.net/2021/12/22/SFQXY2w85KWeJtZ.png" alt="行列式2"></p></li><li><p>把一个矩阵的一行（列）的值全部乘一个常数加到另一行（列）上，行列式值不变，如图：</p><p><img src="https://s2.loli.net/2021/12/22/W31fApMycDaFo5B.png" alt="行列式3"></p></li></ol><h3 id="关于代数余子式"><a href="#关于代数余子式" class="headerlink" title="关于代数余子式"></a>关于代数余子式</h3><p>由于<strong>代数余子式</strong>的定义过于复杂，所以在这里定义：</p><p>在一个 $n$ 阶行列式 $D$ 中选定 $k$ 行 $k$ 列可以组成一个 **$k$ 阶子行列式 $A$**，而删除在 $k$ 行 $k$ 列后剩下的 $n−k$ 阶行列式称为 $A$ 对应的 <strong>$n−k$ 阶余子式 $M$</strong></p><p>设 $A$ 在 $D$ 中的下标集合为 $\{ \mathbb{I}, \mathbb{J} \}$ ，其中 $\mathbb{I} = \{i_k\}$ ， $\mathbb{J} = \{j_k\}$ ，则定义 $(-1)^{(\sum \mathbb{I})(\sum \mathbb{J})} \times \mid M \mid$ 为 $n$ 阶行列式 $D$ 的 $k$ 阶子式 $A$ 的<strong>代数余子式</strong></p><p>对于单一元素 $a_{i,j}$ 我们令其代数余子式为 $A_{i,j}$ ，余子式为 $M_{i,j}$ ，有 $A_{i,j}=(-1)^{i+j}M_{i,j}$ </p><p>那么有如下性质：</p><ol><li><p>$n$ 阶行列式 $D$ 等于其任意一行（列）所有元素与其对应代数余子式的乘积之和，即<br>$$<br>\begin{aligned}<br>D = \sum_{j = 1}^n a_{i, j} \times A_{i, j}, (i \in [1, n]) \\<br>D = \sum_{i = 1}^n a_{i, j} \times A_{i, j}, (j \in [1, n]) \\<br>\end{aligned}<br>$$</p></li><li><p>$n$ 阶行列式 $D$ 的任意一行（列）余另不同的一行（列）对应元素的代数余子式之和为0<br> $$<br> \begin{aligned}<br> \sum_{k = 1}^n a_{i, k} \times A_{j, k} = 0, (i, j \in [1, n] \wedge i \ne j) \\<br> \sum_{k = 1}^n a_{k, i} \times A_{k, j} = 0, (i, j \in [1, n] \wedge i \ne j) \\<br> \end{aligned}<br> $$</p></li></ol><p>以上所有麻烦的要死的性质都不用证明，太好了！</p><h3 id="消元"><a href="#消元" class="headerlink" title="消元"></a>消元</h3><p>我们考虑一个情况，当一个矩阵任意一个位置出现0，看公式中的 $\prod_{i = 1}^n a_{i, p_i}$ ，发现只有有一个0，整个排列就没有贡献了，所以我们的思路就是利用上面（<del>讨厌至极的</del>）性质，让矩阵中出现0</p><p>我们现在考虑将矩阵一行（列）消成只有最后一个元素非0该怎么做，即实现图中变化：</p><p><img src="https://s2.loli.net/2021/12/22/xQysulI6frHmAdc.png" alt="非0"></p><p>利用行列式的性质6，对于1到第 $n−1$ 列中的第 $i$ 列，我们只需要让第 $i$ 列整列加上第 $n$ 列的 $\frac{a_{n,i}}{a_{n,n}}$ 倍就可以在 $\mid A \mid$ 不变的情况下使得整行前 $n−1$ 个元素被消掉</p><p>将最后一行消成只有 $a_{n, n}$ 非0后，由代数余子式的性质1可知 $D = a_{n, n} \times A_{n, n}$ ，其中 $A_{n, n}$ 就是红色矩阵：</p><p><img src="https://s2.loli.net/2021/12/22/lMVqvp7KU6jrifg.png" alt="A"></p><p>然后我们对于这个红色矩阵 $A_{n, n}$ 又消元，有 $A_{n, n} = a_{n - 1, n - 1} \times A_{n - 1, n - 1}$ </p><p>如此一直消元下去，得到的就是一个下三角行列式：</p><p><img src="https://s2.loli.net/2021/12/22/CK8jT1EdYtX9f2g.png" alt="三角"> </p><p>我们就会发现这样一个矩阵的行列式是其对角线所有元素的乘积，也就是 $\prod_{i = 1}^n a_{i, i}$ </p><h3 id="其它细节"><a href="#其它细节" class="headerlink" title="其它细节"></a>其它细节</h3><ul><li>每次取新的余子式的时候需要注意奇偶性，及时变化正负，因为记得代数余子式是要乘上一个 $(-1)^{(\sum \mathbb{I})(\sum \mathbb{J})}$ </li><li>如果题目要求 $\mod p$ 情况下的行列式，有些数是不一定有逆元的，或者说消元的时候精度出问题，我们可以考虑对两行（列）做辗转相减消元</li></ul><h3 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h3><p>消元是 $O(n^3)$ 的，辗转相除法是 $O(\log p)$ 的，因为辗转相除和消元每次必然使得数变小，势能只会减少，所以这个是均摊到 $O(n^2)$ 的（我也不懂为啥），总时间为 $O(n^2\log n + n^3) = O(n^3)$ </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P7112">【模板】行列式求值</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">600</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> P;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">det</span><span class="params">(<span class="keyword">int</span> x[][N])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>, w = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (x[i][i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//对第i行和第j行做辗转相减</span></span><br><span class="line"><span class="keyword">int</span> div = x[j][i] / x[i][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n; ++k)</span><br><span class="line">x[j][k] = (x[j][k] - (LL)div * x[i][k] % P + P) % P;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">res = (LL)x[i][i] * res % P;</span><br><span class="line">res *= w;</span><br><span class="line"><span class="keyword">return</span> (res + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> a[N][N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;P);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">det</span>(a));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基尔霍夫矩阵"><a href="#基尔霍夫矩阵" class="headerlink" title="基尔霍夫矩阵"></a>基尔霍夫矩阵</h2><p>基尔霍夫矩阵 $K$ 有如下性质：</p><ol><li>基尔霍夫矩阵的每一行或每一列上的元素和都是0</li><li>基尔霍夫矩阵的行列式的值为0</li><li>基尔霍夫矩阵的任意一个代数余子式值都相同</li><li>如果图 $G$ 不连通，基尔霍夫矩阵 $K$ 的任意主子式行列式值为0</li><li>如果图 $G$ 是一棵树，基尔霍夫矩阵 $K$ 的任意一个 $n − 1$ 阶主子式的行列式为1</li></ol><h2 id="Matrix-Tree-定理"><a href="#Matrix-Tree-定理" class="headerlink" title="Matrix-Tree 定理"></a>Matrix-Tree 定理</h2><p><strong>对于已经得出的基尔霍夫矩阵，去掉其第 $k$ 行和第 $k$ 列得出的矩阵的行列式，其绝对值为生成树的个数</strong>，该定理被称为<strong>Matrix-Tree定理（矩阵树定理）</strong></p><p>因此，对于给定的图 $G$ ，若要求其生成树个数，可以先求其基尔霍夫矩阵，然后随意取其任意一个 $n − 1$ 阶行列式，然后求出行列式的值，其绝对值就是这个图中<strong>生成树的个数</strong></p><p>以上的定理适用于<strong>无向无权图无自环</strong>的图，下面是一些拓展</p><h3 id="加权"><a href="#加权" class="headerlink" title="加权"></a>加权</h3><p>如果图中边有边权，可以把<strong>度数矩阵 $D$ 变成边的权值和</strong>，直接用Matrix-Tree 定理，求得的就是<strong>所有生成树边权乘积的总和</strong></p><h3 id="有向"><a href="#有向" class="headerlink" title="有向"></a>有向</h3><p>首先要把邻接矩阵 $A$ 变成有向图的邻接矩阵，然后对于 $D$ ，如果它记录的是<strong>到该点入的边权总和</strong>，那么求得的就是<strong>外向树</strong> (从根向外)，即 $D[i][j] = \sum_{j = 1}^n A[j][i]$ ；类似的，如果它记录的是<strong>到该点出的边权总和</strong>，那么求得的就是<strong>内向树</strong> (从外向根)</p><p>关于如何保证根，巨佬们说：去掉第 $k$ 行 $k$ 列就是以 $k$ 为根</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P6178">【模板】Matrix-Tree 定理</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">det</span><span class="params">(<span class="keyword">int</span> x[][N])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>, w = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">2</span>; i &lt;= n; ++i) <span class="comment">//以1为根,故删掉1行1列</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (x[i][i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> div = x[j][i] / x[i][i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n; ++k)</span><br><span class="line">x[j][k] = (x[j][k] - (LL)div * x[i][k] % P + P) % P;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(x[i], x[j]);</span><br><span class="line">w = -w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">res = (LL)x[i][i] * res % P;</span><br><span class="line">res *= w;</span><br><span class="line"><span class="keyword">return</span> (res + P) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line">STC <span class="keyword">int</span> k[N][N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;t);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="keyword">if</span> (t)</span><br><span class="line">&#123;</span><br><span class="line">k[u][v] = (k[u][v] - w + P) % P;</span><br><span class="line">k[v][v] = (k[v][v] + w) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">k[u][v] = (k[u][v] - w + P) % P;</span><br><span class="line">k[v][v] = (k[v][v] + w) % P;</span><br><span class="line">k[v][u] = (k[v][u] - w + P) % P;</span><br><span class="line">k[u][u] = (k[u][u] + w) % P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">det</span>(k));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 图论 </tag>
            
            <tag> 基尔霍夫矩阵 </tag>
            
            <tag> 矩阵 </tag>
            
            <tag> 行列式 </tag>
            
            <tag> Matrix-Tree定理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/21总结</title>
      <link href="/2021/12/22/test2021-12-21%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/22/test2021-12-21%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="87d7407f86e6de9e962175ddd0f634a1fa15e5b606050fd9b6f612ac84ff67a9">9f1ae9a104c95f1bdc52d8723feba369f3d3abf2d4fa95b59e8d6349f0aacdc5b05ef848d181645fe2e47264c6ef88d466cc300b50895b7c38d6045dc9a6ecd002009d42932ddf1d661cde659f512b0c2787d70865fb696cb5714d68347fa8d7fe68bae506d585ed6fd995b816f94190a341ff407035bef1c7918f9563c2b0d441a5201a1f55d29b22200889ae6a9b76426c8d2cc30613b2fe21b7ef1468a5e308f109e9e7eb9cfc6c3887286870abaa77e86029c196430d1b0df0e7a2350bc2145bb9035564a8fb3f63930b2638c8eaa3b09ef0f1c0d1fb165c2424be3881dfc2d27d467cef2415adde99d758fb7cf4faf54e896c4739533fcf2cb243780293840a1d3020be4964f424b51ee08acfcd1eed074623a422c6e942606d04366fe812d1d6e97c1080aeeebe5a4016b7f33a614c575bfb9550729de126b49241a4f9a51271159d13a8c904f5b233be147f59c6edef78d79f6f8e9145b77eab025233d1ff8c91576148ef608045ed2d1206ed410b1bb59073477214ff3f36834d0f9e0a9e056b51cc1a23671b78bb34d5b9f1800706c9073a9762f6c921cfcdd3d665cd90195154e10b89e624a73ef97e4f62208478823a2651efb67f876b2e0acc10315217f5f0380cf5bf432634db522dcdaa62bc9d49958544dbd9974be0ee5eb67b121a68b36991770b8045136c0234495b800a54376a452aff29cf0f31e2f99107121147d9c8e2a876d95898e15e92225d37bf19d31bc8bc0f40416736e62512e74009dde0c15f54e869a0cacc10e7232487d625424e543e9408b2cb889d843ea51d42c66c46dc632f3f878bfca6f3644e88ed284f98be9ef709e0f7c07eb35f2d8e04a901eaeeee9fb8c0220f34e9ca873a3636c76057935356ef9d232274966c066790470025c4d3f9ea9f11f992d2e6b95c6d8a79f99f8f8bbe59ebe3c97e1cfc143a04361593ad6846a506153096534e2d56605f547075f11e29056e18e799c38fc6788e1423f2b31fc4b18cc1426f30af715549f0a398558be653726b0777f4ecf78754c3d113f7a3d97e77198f8532aea0df03926e2fc517ebb30363b6aff307312d020d587a516a7ed3845982cd0c1a38c2705d789da03154aac5e41e8075ce3c8e15518af7a4ebd15347017b44458ebec92a4b32e7ec1f5c5f3cbed041b5c80bac397cf61cd1adeae83ecc1ccf5ea64687f257206eadd3c2ec267ae674fd555f763abf0e2af3662300a4e7d19389e89e1bc3efe106a2e8cfad888736fc1279c806ebe36ddc7340c2e3f60db92155cd7b79b87d835a6cc697d20b3d51288f905b760a691a8d89bd4d03c278d7ab02285fc9af7695d07236cdd7b9a8a21ada38e3458ec3036837b4c999c4eb9f600c88bcd3f5226abc4f63ebfe8b84edced56bb975f984c2906248ab5c0976e62c7b6548eb800abb8c0f1e34c51c34ab376df21ff46ba5a5e3876feb2e6fc29a448803890f1a49cd33b37607dbfce3c1d0dcbd0289fdd77e82a488448c92017680b802b7c08492d9e58a10ca0598ea032d8270751974ddd252b6dbd109057e0ae4998564affcdf60c9b644bd598a609ca220252c930b1545417bb5fd1b10cffc2977818aba62cebed2be9bc85ecb500e3ffcf027df4e418864a7b637c1de871b3b27d0ad5dae444033c152d2625d2ef324bd8dcf460b38bd3709fa960dfae0b138e5da372cf6e78bdf9429665782a8dd529f0274e5fa7163d148618444c72c25bcbddb182ebae38cf26f36ecbd320b1d7390f024d9b11dc8c70532365d4580e187320d6864bb99489f7d7a6e06beaf30a32290331b8ffb4fc7ca7af2d696b6f8c966bc11f55ff6c05969962d2bfcfa5bef82e8f1bec8b510186bd517dc59bb9c951599b3539f70b46d4312bf1be2ec40967df127df2fa90dc3a7e2d36b5286ddf12be616a6b8a3ffd575ce87536370f5264113c2487e33a30a09462c485e6170cfdc4be5c78d52bcea12ced30d4ef44969fa704c58b0be7b16513bc57122f524852eb4360489f720ead6a9a86209d83f3be79317dd58de1a8e871be1f23f9ae98a3ca9691c13bb11ac8bf6777a95eac14a68c42e60c4eb757604d3adea5ffc484569dc33b9d908c4b0aca1f25e1b95c77d3087af59ab6357709c79e4936fd356e5e453782495507644f9e9f2ef579af30edb030d759137ef30ed13feb266098ca74dd4667ae4efd0a8f73759ac485dd1fd393c64f36b3d66037c2ac991ef7883f416245460937640353ef9b1df4cd03bf3858c36f6f6a46e5a9c8c1bddeaa9304e58b2702ded14ca477c1047b188087be13ce5702d8f00b12ac2e8e16fabbfdfcf0a7cab4b0b10d01d5b842c9b48954fc8fabb28f1124648eb117b7a4890a0bc934aae1387d148ad5edf2633a1deaa48a6c56f07cd2e6e825a680b38d13ad824f0076433c44996a36c9554c6197585a6d425dcd34a0a0e9d29055c97700d9854ba123a288e0750ff473c7f7570dee690afa2ab1f7d6ee04d43888267743d0a2433d4c2180ca143dc886dfff67869139db6f36055964af35bea5743670529c27247ed0603931cce951a133954fcc69c4e6b04c6981788ad979afb7a0ae4286d7a0c026adcf5a6a746486aee9ab77daff5306e440d62832bcfb0716809ad85b61275d8111849a1be84c218cf6634fe3ca99b11dbaef5d1cfa72a5cf40de98099dbb6031d8ff5ebfe3337745c1b5578d2ecbb095244f35339054a70941abe93fe6735a7ea8764f4cfca6a11ff70165d1c2734470fe032b1b445162855ddf7e7273b59dfc5fedd97c3b812a654328f8eef175bb70a27765c6790aa128d08add755ae9ebe4904a99326a570cbb6df0a2bc34338b73844719e0aac3ae272938ef6e270e28c7ad195cecdcdcc7133b6e099d38e018626e1f9c36ee57dc247762a73b0c6dd0c7444b4e9c8de9772327172167c615228228c86a920ac3508b2ed2138453bcc6a2cb30036cf29ffc692d01f2179e0f05033e570d51470b723c1ba07e41d4c8877e859de565f4bfc9d3812086634f287c1c0151363ffe4b74c8327b33f1c46d7a1c7a63ed5e1e602267fe0ad80158e2170f7b1b43881b43d1b3d3aaa5d3f4c447458d7ced1c6edbb09289dc8b715c8588e264d3edced12b764bc6b40502a7c0d0d01cb30c7b569732f5cf155849d2ade6de041bc9a4922b7edc5114642ba827a81e37b2d3d93b09ac86efa933c1ebdff618a7b7448a4d59d6852c47954429647108308dc952cb18dca734910760d8628b7420e7bd17c87d4997814cee54315681dd92fa00b5632584765c1291af985f30d497805502471312300018dd14fdfe070405bac5c73fe15c0dab3bd6bc835f70471c2208404f8b20cb304e99d890c8b4d60980f37420abbc3451f3481f967473433f15962e16d1be3b3e5a96c24569042000ff3f85210645355212500809896fe153352687a0ff592adad63853f6a20d7053a2f385394842d126c42640f283bddadf43a4473b74b42d68ad74e26844bc8bb1eb36037aff683f15f4f1f559beb41eaca321c0df8f5c2cc4da9534c04170b570b3d77ab2eb7545126a208952b1eec78258476ab9d04e2b0588cf39c225f4e5cf2724fb0a6d41cd395b6e3bd802a1aa0bb62ef2e80f59349c9e61027ff474167cbc48ef13513225fd279b3d9d0f69d6bc87e238b5245c6d707741500fb6308a418f8bdc8978d94a3f16571d6f26aa315a08e19bdb28471f0c66a5254c59b0095f1097461a989ed3ebf5d81d99510cf0606c5e23a75cb090d9bfd8c69306c851ffe2e22bae9ebb4fbe1b82bc5b333d034a93f16608b244e65a406c7fa84ba2e7e99a42f05129f94717bfb6ed365f3a3b880818b1ed15923a588fe902d57961e58d72667087be1773c4026858cef0bc1749b12d27097fded53a8339d2a49705b178532158ca1409e316404289c994584982abb0a8fd49c60f3745bc612147aaef5981ae27fb050e522b17fbb2fa3d4bb114f9d0a55ae348b8330707162db60453419ed66211e8b22ce6802557bf5e155afb5ef8f073b021b4b07a9018eaa4d332fb0449b259cdd0fd3db6e9f056e4cc640ccd77add40e2d8dc650f6696a7754e8114aa00116b263a52f8abbe63dbebd104a9cb60c2d513a043b38583d5a217457cb84fc4fc41367d2462e7b3601697fc23834e31421d324ca3a20d4611c7303d49a87e8ef34dfcddf60c5f20279e19e31618424ffe0326244945fa229d601c2630583a96fbd36161276e7e1e0c284cf9b0d8d3c9add56791107d857738dfca49ef1554a7c1954f6c92b1472d1e4f7821ca49d253e7540c7ab718f8bcce78134c15bbd482c0c592bbce3a715c8786314fab8978e7e2a8fc72deb1cde21dce3a45d8135280fabddc300b41144608719856de0fd8820b887009dd7e64ea1979a6782efc6b5a047575b43de934d883b213ee9a6a8670f7a1ff67ed8552249480aaa42897eb69c057ac57200d85f15fcfa0a468f99a198e022a1bae2926191e031e43fc2a396660d657fededd2eb1be84b5d653dcd86130ca8b31cebfcbe660d1ea4f8932dde7f1660fb7cf5d0f59c8f3234a9d7fb8cea74bf52d1dae67931a538c368caf962edbe4dc647f9abbf56de9b6981cbd932534fe6a1698dc433f18f0dc2ca6e3cee2a51e5627a59e3e588ad0310eef5216ff65a2074341b563befb547873444da274f623ac33f9bfae27ab30085d215e2be5741f68837eb8f8ff128f54010d5bf9d67ca3e40ef3cdca8f7d7500f4edc48fa769cf968d648cb076d56ed18cf918a4b0ed633f66887b2daf0c7447d2d980a69fdf757d5d89cbc9f6cc9b8403236c3aa121eaa4d0b96f6ca2a39a4c3666f763feab509056a9f70f8b13e39408504d957c6c9094ed6ab2ec56cf67e773db26cb36aeebe74c28c2e8f1970573a3ad0ebe0162238337294373421f3df432ad146c3eab804490d206668cd172297f8846fe77fbdbafa17cbfb449005dd8a404598530d817d4788e54f20a3e345ad29f94ef0d5d386fa7bd5c34e41897b9c7c1a377f2ed6536f6e34a1d19b256d901ec09fce45c07b5f11bc8152bdda8427162ece110e014576159f0d5c4ed792dcbe3133b960b6e0e9d2a3490f8136a082033a812ca20673e9b290b8c6532f9138dce64646602aabe0927bed2a56433596c7583ddd7f3fa5525524db226c8e8a18cdef15c03f5d5216c8f4d3b707008a1998f0baa17ab8b8b8cb314d3d6674a022eb92c09c05fe7f4737cd676a676ccc37accdc689eaccea28411873e1081d1e02b3d37b799b54d6bb43e0bd00877766ed664585fe4d839421f4a868a01c7dd4d44ec328ff950ae5b0335ce42c9c59ce20798ef8041d01fd229115435a3a21e83ba90b0d959209b9890bd98f006c29204a21bc217a4eedcb12047ec175dadc98cdead3fe10b6a603aa84321ae2b6cf3144f0e7c6e6f134b492231e447e0282435c1a425f22124e1d88a1627f551eacbe280b3dd25a1f3b974e5ddca6500be8a1b47b3798d173a0698f4cf86f5e6e92857bdcc2e783b902fb29fa7e2985e3a8b47e254b6c3ef4be1614f2b1d0ffeaf73bbe63d7f11de0f16d2c50f0bdca8d0c53c0f964681325c3dc60c0ecd892d88e2449c1d92a55903441df51d0d7cd8747784f771dac573b50f6fb5ab1ca5401969a31a0c48f32aa4a34b624a45c263fd3c10858763d9b39fa1f5f06bd4c93911aaa6f9615d0cc3f880097a026e1ab9ed19585a1f359fbb36f89b78e2e2f0c04c68d7133ac92983e0291dde6a43091e71c6c8cdd3dfa44a921c0bab84d8f552c50de270f669871d25278e07f489e67fa9c41ac191de1f96712377605a7142c2f3956b5a636d1ebdcb40a902b3ddb5ffc0b2fb0dd37ae037af7c1dc102de3d2aa626ea9ac27e1422deb9efc033c7e67f18142d341deb34b77475ab6a911963d3dbb314f3e61b135453a3e294b489097ac1417e1ea5d390be99f11e732e69e847f281d6fd00e96dd896f7935f92a69de7ca3d927e8a4d8da3295877eb97d189d010a8bddd1897818e7e87a06832f46dd0a55b33903d3810d3fd02482e0f4ee21f24a369090791e1ccf1f8e0609f67bc82022c1d41c0a702259fd0338e77ded98464ad19da7b89a9f144a8a0cd0557b157f49032da39e6c2829f8369c8a3cf031c395f9f8654184237a32da4afa20a79c430e728d03cf38c06935c957913bfd08984a0e31bdb25867e3e4cd8f8f515d85472943b09a527312097cd7adb17b98abb31592f56a01c50258e6203e7e9960e1bc89e146137d24e89d336077fe5eaefb3dbce999988dbff5a35f2729aa23b65e82a7f7413538165288d6b0ff6f652beb2f82e6f38ab5b2a707ab3d1fdf4aecb1852a4bb8ca76ef42af005eddf06c0f3b9797a568b13b92c995145717481360348008ed3f9c3f372f3449928a176b2dd269f2558700d7ebbd06cbc2e684ac483723b93b7e5fd709eee94444c75022e04be46dd9a8f18dbc53d06d6ccf85250fef57f091366df83e2378e0ba04be76062ca51f0c8647c7734e86491ec16f1d02f246c0a0dbb85bcbca4c94394add05ee7db832119af497e98c4e8affa6e7f952a8a8e6f3dcfaaddaecce891e7534febf683a250e633c40d147e27bb5054eeba3fb66a06f58d92e7c010e042bc586ce59ef4e1b1a3c11f93f90d30dd506110aa243cf433d98505c711d6df6e676c3bbde40281135bbaf8415cfacbe7ce90810ac6c9ec2eee6cfe93ca2fb1c577205379fb01ef8d55b40c8ad0450bb2a2784b4b8458a4331a3e67bc37c41f53c968d5e18f946c1678d97f6bf2d92ba922a97ebb8183ebeeb56aaa7433ce863841a14babc427c35ddb30d72abc53f6308868e29cf404403f0d37c1a606b24acf67be3f575577cf74167c122f56d9f34aefc1dd5ac5f5dd7f7620a160086c60b6fb9ce48e8414ac0a214202de44c7d767e29a06afccd5391554a9e217156961e7c6937251982cdf5577c940ae1d7932f473b3893fb1244e15af102e9f136a52434ce5fc9d1c86144fc75844ab365d4d985970ab11eed725385d94e3d1097f1126e0cee5bcb85dcbba1dcb7828b17aa5bc2cb7049b294d660223dcc25b53e30b70778e647ed7eb2fd90efaf40db4f7f23f3be8da5e7d9e60620e1979e455949d99e2325b79ed91396b93b18160eef0870666321c8b2dbbe0cb2be2b9663dbc3e065899a0330bae0580202a0bf5406d9ad14ca7b663178cee0dfe6555c40c5aff00ff77d4d093c0d832e94f159fe4d38e3c3faa6e205175ed375fdc5edfc96933c72bd54a1ec4f057b0358416fb31b8a2b1a392cb9e82a5f4c4c82f82dabd92307ef747da21a65b913b97faa543aa19518aba30ed55b9c71df62fb5146077a1289a775f6abd7ee7b081a71aab37b2f7a9a4918cc026ddfaa38a436eb8c84b705c7ae6cba4cf5c54e04f7a6a7b213b3e45257e4a27798b39a57cd39c26bced2471f2c6d34f8eb3b71bb061877e7c033607ff57afb8570942ef4dc146781809d1edb34e464df3c59e06c27003095ba7edf812dd45a12743483aebf3967466dd6e7a607518a8b1f4e7850604015a5896fd9c22dfb95a9e6fa45c25f4d3892d3816745a3843be9009615f19b49b5e587661f447a5db807f320c64814bcce9317a81029362af31d816b8894c8fc9317ab1b35fb90271ea4793b01259fbed0e29f174a38288163d20bd59d7c927c0b0e81acd7c9a3b88f73666dda50cf320c2a7201f158754c51de59cb218e6e187840b4952f77681283fce6823ac4572c4cf37846a40b1e8cd8c675f66a3f428e1b4a5ebfd69c232427196c6ca21bc42d9645fef4ac8b6de8769d2dce6157aecc9c7b9bf7c3c04f97f478127892dd713fdf1fd19c2136101b769fa8a5595bb1ff0f6010afd52cb34417777bea80d4173b5060b3f766186f519406dc960113bd0b597ed545bc6c0c4891a4c20504c1c7dc6b8d078ec8b90302cd3785d24cc8d3cd39a6861363c11b85bb84e3bd4d83e0ca7f2daa4fcdd5e078854e1202cf62f70c51db4fa65ed3f0578775946ed7e992081a21ebff8f2adc64961f56436381650fc877a072f1ceb44d32b0cc524b857011e2df7f2065a39c4984020883b74f56a738cc9d4f7ccb0d13bb80abde30e40fd5e1f72001e16fa0da3f5c891c7e2dd391e89fe215c16e2caf8abe70af1a745a042d4b81cf51c59369a15237bfc3799fbbf2f3fd92ea04f4650b9c58e10322a22d5174075501d41c88e3494756d0cf44db72d78cf5abf3437228bef5f81ecf1d8b1739f1a4d97f7173ec18ce28508bee0d16cdfd81862389938b367acb8ca1a6da5249ecc51973d2cb9f92df3f956a6e7406161a8157a9835f13efe3f6b931d90447c525e67cdf0548f0a71e84b7610e175d9aa08c93f5940a149debcc42510e95b73f242c53ea086e3cb484b2465a8eb17a6cbaeb584409332383346c6b5e4ba22fe1eb70342f60779b492e7943ed7ebe8d8893d48e8a2367910730a4ed98ca49ada40d8de5d4c87f8f14b1b54983b5eb8e4ee7ccb6824bfdba022eb392ff52e3c36c98506c80f451d3607711a1ab6ce78ee15e614bec9e3f3fc121baee7ae63c2af99f3f17859f15b496e25ae094ed283ed97299e564ed8aed857348dfa1a8bcaef79016c5d26f4095e65ff319a12a73ff25422199c745c22d27d808a3436d5f0dc66f4359a6de7b3c9d4210f1821a9c52deb017c49a521723888cebd67aba050e30e9c5cfbb756685da68409fa12cc99ba849252cb578a973f128dd608b147ce0d20e4ca3d626ad3a0e3241de68d8b727bc48ab3711a8593367864befb3c6a5edb9d3a747403a5475fb809dfdc958dd3061d3a7936219737e136727f3de758274e6e6fdee962558cf77b572f6f9d5344df3746c1d54ea2ad9c2a1d71fe6c737954b5ce722aaad7111da135b83832f7886a0ba032836a0050937f7fe03ac14a6f73d416c29cbdad7359b3194d3d5b6bd8b014102a0b58b12e321ea17a66b5e6146099ced49e603858d3b52a7e1e4383388f3dfc4e0e10c52c2743f793a15e7170c4e5ddc0d3aa2be6be10bdd189c5d485227d1243ffabad65d486d05933ebbc92f9a1a0acd74b04d8d974d8face37ba91041c87878f5c28095638cf3d36e99ec56b56d880e666bee4555bc07010c3cc6b82a8e399c35f978e493d8a9aae60691f490c28b2e2456094834dd0f87e1d2a3902a190bb8d7518df2b363c455e0e605edc2cc135b829f29dd9c28d575e04a1edc1c89a711cc8a4023fcb48a086527191acc96baf4c09ce057f2553f5258339ec0e45b5713af0c98ebac828478065dd4c458b64de0db484659a5c8c5b3cd5ee35e26ca2b0459643bebc6a31a010dc25a257738a88c31d5dbaf8058537e05b7af4a717476c6cb42409115bdaa824869dcfab32f9b127860a86b13eedb2012adaa8906279332f8607b453c5c098feac3ccc597064b5c1754d64a39b0114eb4b1be33337c59f4d96417fdd473bf7562d1d1fad9faa16bc8cfd328f242606a2f65d3be9dbbe80b2085943afdcd82a267d8869c44ddb95bc5efba2bef96fb7dfe34a764c6404b884847958cb5ef1db9af8227616ad6e4f4592bbf4b40e296afd4d180f738df8da0138289cd4326b6c56754b40c805b635d60796dce718ed2e913508395b346eb719b4dcfb24c899ac8bc4f9aa28117de8274e59324c787e7e0381df7e8f746d68d954f00712bfd78d693b97fbafda570ee098611f16746ffee8067233a4bbbe10643d02c9868ef3528236c7378f047c9261e9017d4e54c963db4fac4ebc31652fb5d571108fc57c312277d2f87cbd711f8636d89f1afbe1bd49bcbbd2710da853b42ee125542182840bac9a58162d14a48fac5588140e7eae575154b0976fe9e6f255e97ef2c011e7a5e8e9900cca41f86002dc1056e9d31cd9f4d1c13d755c8a6a14e894f5fa9e5996eb158f8b3e59f85b11e3a55be052ee8914b2a6a6111b136cc1efe23d769b9df778bac1d2a5d6b76894952a5a9c5f099534e69d38248604fd6f42f48c5bb352137055f02a42cb098b9232ba041ebd2004605ba5881d0bac7f2bb15a37470087632abbc8c49236e331cfdde7399103185ad3f97e590ee71417e4052ac476389dde0c0ff56d4cea63e1349e9d56552ce975a78b34dbf1eff251f488de7635177ae22eae34bd796dcfe4e12b8cec075a7f3280f65ed03ba32a26a391336523ec1653bba952893e3c2bdbaa5db89e94380395dcf1c7da279a0db0786c3f2e08c43053850aae04948f0984580233c7954e527f6523db61655d162aea6ff6ca389b942ebf2f90e6e654f5a193bd64e1b885b6019f16f6e0e9af9fcc2d59df3525cb3cd9961d62ba38530d8e196c0019d9fed8fae403c747553094006d00a9ffa3f04462a66840767b51c4a943ecfacfe72ef846c864cdb1d4e6efea45a9f6cf2efac5a0a9ab0fc67b7033ad07b4b48807efa7b6a00af8f4c2cab2c5ec4341d4bcf9988a29c354e72d590419e999cd86349528ef1256fd68bedf21db9ad873f4c4e8aed6468d5e32808f0a31f93c53e59f80b10953be3f40b51cda65fa96c3e44bc1955cdc8d1514d932d6693b2c5c1d5e73bb4589cce8d0598fbd13b1d1d1a750215eeb7bf98cccc84cf307a6b079f12bd0002c9ebe7adc05d1d92576bfbe91cc04409a60757ce0c31321d764bb9455a9f24b580303f74c68122c73147e5ef02fb0e9f40647fcfaf165336b9970cbcfe003df41e86c71674f225cc7d6ab0476afe7d44b0fc39f922da254d6061900cc3ad8b3505094e7702201fd0301653d44ac91bb18972e733bfdde4277dfea3f8985b51eb41d5aa571ff9c628212a0084b2702263f6bbb135db28493395e6b7b433f75df2ec6fd329bf1c3eef58ace8da136932c2d467e7df4671194a2191e667b7f62a8ac7c42bf3f80ac5f644b01b389ad4ee8d740bc0886d6d640a988af626b97123436a64a810b829548900c700d668238b82392c4e8f16782d16b8e2c461b9cf0f6f4e6012e372e7475a7baad1eb018041fca5599f5b1f7a13ab78af623d27a65546875ac003ef79567b07a8e3e4124aaadd4bb576d0e4d94e00258c05fda8b82b46c69316fc7b149d4b8ec6a9c5d7ea465f80a0c1bc3778477441eef9815b2ceee3ace30c4cefc57492fdb32ae77088eb5c89d594fcd17d5878585bc7b7c77aeaacb9e80b1e67c38760d9a7f98097a87347ba2e288e3d6b8d40b38705fe6b0e9c2795627f9057bfcfa389fce7cee0e026dc881c10e188743b1854c2b2291514b9ecf4b92a0b5c79c9e5a4633edff8add1ca2c037525c52a6d26fa8237142ad72cf7ecec63e443bcb07584be9ea3fc1f110b8bff0bc6f191ce62b1270ced7c78dd84cc38556e00ce27bc85864031fe3f19573f41f8a21540e04a9ce44f0edaff12eb96618930e967930ddccbcddc379427a7354f9ac2b01b04af83541d83e32257b59092dc9c9f0bdb6c7dabea6de65573bf2b20e1fe480f5fa542940086bee7c2a490e4feeee19a6d8c7cd2c145439efdec81f9cbf978976479c3b3fe9e8297ad64e9620703f89ec52b69ffd0568df1b1ae5e55513d25cf9f063a47b15fc335ef2ab18a9ebe61310a95a0adc83269d06a7d727a0f87fd61a869bfbe57fbed3d56391885c3b0b83f0a339046dc9c42c4f1294ca71a69f7c1c9ef5f159bbeab80ddbc804e1febe93ea44ce7cdbf15c5b8ac382348f88a3567759d4587e10ec8c957bc35aa431863102e70dbc579635bdc7ccd9003a067947d46824cd032893d28f0eadb9e71949bd6975f795ab451d70533d5da7bfcc1ab1664ee03d7ab9ea55a4473b714b28ec56f4db0819edff1aaa0cbc3ba210daf61032f6945b1b60583d28f4aa583be09d0bd73b8d4bab3ba32f2baeb3efed737aa9bac6bdaf2c7d9038b175267d81022320fcca393caa2c9cf363856164bc4014de7010eba4529eef93e85b96861c3945a70e972834b295c5dbb59a6e133b312e2a4b04c713a9b46a141e99bf61406d55ffa4c4b254bd64b7b5bc0629c41454d6900de3d938c0f6ec5b93baae258ab5509f5d27df4d80ede97cb216799ac588b00c0a41849a3dfff100481e305e09917d88fcf325fb81ab44534395ae0b5eacaa913ba3a91614a0f1567f9c201f230327ba6353a491cfbfe0a7074b9473064830f2f100e370b8b9b3d935f80c7f975e187e838800eaec6e9eff8ab7b84db0d0230a52c0cf354e29d96cefd5103a0d8dee3d2e64b173456c629ebfbb9f6227e1ff4b464d02e998f308f49c68aa632c67dc0f5c9b6aba29d5248684a791733e2e4db7ad436ef0e12c9a0b17c3ec26cb7ef92a50a51728eb69a5855b48edb76bdf6cade77948bb4f8ffad33194e361535cf5225bc5ccd371bca56d3df0f80082598ef7074fe0d53ffeeaa265babd28e56f322732c9da650d917c21bf588a2b49ef648cd593956d20176e69b52c9e8b7ec1934eab98cbd50390a83a8a1e79fb66d17c2bddeb47bdf28486c5a9b406ac06604e39c83ad9482702af0589d6323419ff40d07cfad0950cb6309b6bd2ba861a284276654d7c62492ef165f65b89d59ef9c81fb7adad6af08c7d249b84001555b5db635a83674409ca2ac4d4b4dda6fce22342c5685c7f8aee6bd9cd5fa4c881c0d2a790d69b878acd70cf7a5584f054efce47fed3c2548cc1c1e45db805fe4cad5e7e2e0e3ee33b548ba79fa293feca72b7072f6d279a829f86f30e9a9818f2426134f593c55f4d52e797bae6adc328eef3a08d26d28e6d02ce2e1a16c049ab2b1608333cc42ca9a9d2dcbfe64a313a4fd943e078429d68673584c72b1a06a8812287f31033cb4b303bcd93989d61917772ab767ea1106afefbbe07944e1b5daf204b97e20329d84ea07ebcdd2f5530f0c6e55b2f692bfea093e1a22a2f55a209782559c2210e084e3f762d96ebe34575b4b79372e40af31e5081db1ba6a6d2cb951044f9a80b5e448a925e790015ed4f5da8e9a4c33877dcb9386a639b68789ad0a7484e54b0cb50b5e35c6ec7e3d09e6a2ab8c2ec5cb520820bdf4a4c142e1cf1c3bedd3155d536b450e24e0876bb76260856dda6363d09e0b719d4be40d7e20247eaf0a2f1e581581502efd0ae9403849796c73fa429a0193d8fbc5379b9f31d3c1c766a7d68bedaa927f577f76190dfb4facca1754f77a6c93fbacd5687f00320c477e4acbef7a255c2e0bc5def36f214107a570e2f85a4d86df33f31033fef1b2852e4e9aed044b4c721337d71ebca744251106041d3f9056d7e5b3742364177321de2e061d9a80cef0269cdd7c7c644481fc6c4456110364374a2143cb810a189bb8c01b4439b89bb6193f3ea8cfc8bcbcd24d8ea34ad1b45d646bbb7c95d1cae905fe90dc3b76481c8bed31b235436abb93fcf767a4c17bb91e14de7d6c461df3a600d37bc80e67733e34c03c87b427b688a287a1dfe9b1f7ab7de2b9494b01f764bfb5686e4fed51e548e4f778b9f6c4f67976b89b53678a28513a8e84f51ef62956860da8b92518dade583a919dd2249aa9ef04f50ae5c336a8744968b9cee21da431dff46628b6f82b6ee35bb046560acad502384c6ebd51d0b3ce9f6fefbccd58c364b60787c57793418c183a44a166142b252ce809a91b34cc0981561818a8579b3698ebc89b8d2db256ac401535778b06b4423362e2dfdf9dafb4a301ce2fc4a78d65afda9056aa9ef50d41dc0b7e536c5c8d94d1be59ddf427c2caeab24083adbb40a4187ed082845e2960e1ed527babe6f90351bd754968224f8cbd6cb69c6b5a96c5db85df912584e66a6ec8dfcf8fac174a329b68c32fbf2e0456946cba0cbc5123630ccc8fe4f14603e342d4563342a27d18b1a7f9ff5fb54a2e2a081f32a3be7ed1f603b2af69057feacc20c8eb74f2c3c09f4369bb0fe5a3911866036391f58fea7984fdf544c06f4a38a1fbb6fde4e9b9bb5ba4c23a3a86d0300433b85035a352e5926af4b8c5f2a53d3ac54109549ebd1e8e44587ffc21c1f2cbb7861fe8f6eac9ff47850b9757968d8b657f7db8e754d3f2655c74ebc2bddbf23758e9d8ab9a732960c6d4e33d366ec188d464104494da695edffa0a2bcb44b2f8aac17df2d4dfa8497f220f77ccf779de2a9d0bc5584bfd705e70d40b10da20968e76342724fc90c51708c20cddc7aa3be583212eef54f69f7de37599f9adf48be57e4c95726d1410ab7cf93774a656150afc876167164d02e41ef0b53bea9fd901b3cc14b629144a5ab834c44abe03091a5cc01ea450b0f79e75c6e7ad853431592857845f2937b9bde81d52db67637c0ada40d9cb7046089b1e4efa4794710250c19ac3b55fdacaa05177e941a1d9233e56ad971019bc7778d0f927aa53f5791c0156f445e77a9e35d9470f6b869ddd6ecba6022792db3271f69f5a8bd1a201f901f0667c21675d6cfd52802196630536cc59a386f7e70a10df157ae1168b09f227eed760c1c88d2b963de1a085c65c2eb64084118f94b0da2f45d0be382af044ebb0f1b6d9f64787141d2336bbddfdb2ac54b246a6964eb1319283babf11ee4aeba492fa9b148dbca349bee5f80b29c4255658c2d5570315a51f1a5da9238c6876d7a1ab0f5c18af3e645d9b7c221895ba8ea2d700b8a56bac89b32cb5b236b3a375ffcbcee4b1f9a707b6712fb105868b218bfce6fe65d0aaf6e5a00d0add3d72cfd78590bf3a69bc91a39ecbe18d8c30403273971c3cb7b53f16fea6c47d5ef17f0a980e108cdaf533b4f9b56dc23abc1be31b76522cf1f5d2e11be2b70bb0140651830bd605249672a19898ec8f2954ef0e4f2dce777ecb9e2b7c2cae9472b399a6471df476de6cec9151bbb2cd9eba0cf0adbffeb4990d1ca6366fd4588dbf355f06655a506ef2f5dec7436a00573c6044be20f9c5b9f0cc81627c6ba80ae22398970ed178f440d0c3517acc53280007a730526f0353ef35a6d8b83307ab992910cfdc282b39f4a15c59152f229ce837a886acd1b68195fdf3b3325085e9da3b4823627a82981f1109dd002837a31f9043336adba64f65ee2a6435e064998f12eeba950460de51fd0797f1069bc6b2874a1d3e4fdfe6fa4371198d56371a1536f1ef20808274e0e698152bc5c167467e33f1185a9e3cbd0f4631d040fced77d99835781a2e1b20f1d9b2a0eb66d2ac278a1e5c676e5e5f2ecdd911cb80f045051c9d4c92ec0df01e87b7fdcb8ec2f290c0330aee43dc86a67a7b01495315f43ba0a3302084356f7b47075c2c0e5e8e4ecc2f499b0ee5eabbf29588699934af73284d9a3f54f0d3a17ad39c6b1cf3ea9a1a610587313d463db99058594962eff2cbfed65462a9a07286b2157da2c813e42993e6160d07a545c1a9aaaad4927c6cb7bf9d8e3daaedd4cc2acc795039f0216a912e5389ddbeb20c7c3be7c7ff4a72ee1d623abca34de28f7f58a5f8427ab3114fe0f5bc85c1f331fd94450b4b05d2b39afd017c374904ffab8129f7c136783f03de22e7b39ec63d6df1da3df62e00a6e98ed02d8819b0d30856d5aa101f71f43d18dd57b4afcda2123cadc476494fd7403f6b8d5ce16d30a4c8c0be0e542049b875459526554166f69af4b364d7b52442873a95eac8234a982152c8eaf3fa8fded2552dd0040dcc4e9769cb739354968cca2dd16a700b07203589a3d7ddcea92a4d56f191f87f23415355b5890dacaa5447555e2aa46ef56fc06621f9e8618382b0ea325a42eed61cf9d35404fc442ddd4b2e11e84885fb42d7fb56acb3d9e98071ca0140b04b6bd5c61c17491607ed0c26fc2e2c7c1bdbc825533249f45ddad42cba85a3c860b09c7ed217f2efb42d58c96dd42464764c36b7d9f37883d3121638002e55febe7392d8db329d131abe21a217d7ca287859804862ddcf60463fb73cb572fc2690a5f17a6251cd8b317ece88706e8e47fba759a9b50801ebee68999ee3278cd669167b5c700d56635464067be2cb5b6509f5f699d04cd8b68f5605ea65059eea49d074dd102430e00cece8118e1327e681141fb4974527e15596e26437c16d08d31105a05098ba55481a3cccc67c059c7081dd606b5c98684b8b0f32d58c785750df1a681d7dba2578c1c6fa686bfc1a9e17e8cda1bca448ddbc976b44961e009a338d246e917fd05ce76f3b9061c894b11239ca4d9fb096fa71011b114375b41c1af0ca4486819436e13340427fd45ddd1fdd38454615bf07e47b1d8b5bba082e13cc3bae5f308efb0d583a3c466a66b0847886350b6e0cea56497b667d5a1dde2442b891fd2962cae64fb49aeb406a2ce78fdf3cd470895b1db4f259f0090c42f13eeab507201bfc4bb28eb73f973c343a5b7bae46761f6b1fe5cd1c6f54948fe1189a9f0e5d51a562fd7b4f55bfc69af172b14cfebb1e6b539f49cea52272d34390b3f4cf2474e4a5f283245156c09e256c54a2145188966738c7991031cb8e41f8b91cfc8a5960511c08b07731ad1d6da319f5b78822a49e442d26d8a662247bb2b5254746f3d5ac6f4e916493fa7b5c8ff59036ee7792d24c12ee216d53c58f51b0a0556dab252b9fcc9f6d2ddbc717fcbc5c00ecb8556768c7269d452ab0cbf941fd762522a45c1c276e886995dad72d27fc1d617fed83fe9f0ffccbbec25c5acb7c2d4621f32dca9884c017a30349c0b10d2a47dd30987a56e41798f2e3bde2b675a43c78de093c48a610f36159fb2851a1a300b16d34d01da87f21f2f6f19b404f9c3cb38b47959096685d47f7097a30af8b78ad47e200a6a377c7bebbc7e1bf17cc9eab3f75432a70877fe94d248e8df911ce5c0644ab516efb112d656aff4fb720519e3c9cd8e0bac188ae5196f843d576a15a3cc68592051f75493e54ad73ef9e6c16d3b83212b2066a7332264b959b09c1415686605c5c22e97f917a23817d077050c7badae4c7d1a7e61922815b3539d68da0d44819ce6102fab617d6b185e19d89d49ad019abd2844cf6cac791b38b07da43a903ae5c59d7b9868d0ef27143f0b5a69afbcd3745b4fcc7ea3ea347a94fa9a0660825ef02f28731ab1067297ee96ed954330aeba03bd737c6d360e85f4ecd6ea16a885724da3b066c1e20cf0342d598905fdbaad6fc8ad19dc7f88b50c7f39a31ef62924f3fa3c38cfaf13e0cf81f52059b69f437b18d7e380499fb683054117918cf6d3b3cfe380cd8ced6541a726250a778964b208138339cb93f15744a8629e74a16dc530f59159c418c82f7ab124985ff2bba574e455798fc071d888f934a360a01df98ae2f37237dcd7759bbf9ee194d423b2c5640f75780fb94f25c0f367ebd4a45f7f73ebc78b6f915efcd81ce58f02631ea1f6f2a535bb14e85799009411fefaff2c21b38e86b0f640aea18834e4dfecff7a1d8186a7739292f8a716118d0b452299e8952fc6f335a0f956427ec8671bee153d53fab7b0fd4dc00fdd49f0391a684cfa4e1b1b8c193692400bbc47ac9288accc6bb476d61b8285564626f46bd64b38bdfb2fec402829458bbf35c8a52aeb06e0f9d31549fdd01923c75bbc57a2956f9f564c89639a6f76cf86f6231b2b4860bb05ce06370bfeedc28415df073a01a7e68d65aa0e6064fa76ca1a293f91a161a150858313dbe94661c879217f2e08b640ff4e9314408d615709b822553aff19ff85fe276184022aaa8170df3fb0dccf1432e38fb3f4b89b66f18eaf4381f3c454f49b38ec343c61ddcdb4ea0d319ab1123325a18d90e3fbead845c9f9dfa2a8dd1ee09c157fce03dae137603616a4b940f26c756e66f125050dde2867535d435459e38dc6588fa8c139759d0a5a67ce4c2940ae1c082cfc82d6fd9c40c9a67d50c527070327a0e9494092c04df9d5169fd042758c96b214ee416572132d910b2a472dd5c4986def8d673139a4de2b46123de2fd99280ef8fb877a0acc217b04f942ed16392eef26869ea72098ba92d8e131210bea3ffead841a14452dc46dcd912eea9b084093ca5e5571ed253194bc867c3fa539bf7fededfb03297719270dbd57508f3704614dd7f94cc74d22ef964a46efc7cf628732462587e862fb9110b5a826ee50c0bf360dd71b1e3f2fa02b5594ee50c9c39d12ebe55c73b1f2ad033962ffc4e298e8b2db2d039366081d8064fa2dc479e7a756e2c0b9ef2f77d566f6bf0fda20677dd6940e8eed6bf392b3d3f75e33a0709ac6171aeac7cf20eb423a32e10e2439769e378f20ffd13f0b315d6f0109648bb20e9eef3c159fb6e51aa85f84c51ff105e8cd900f84d14157f17bac9065b9e5faa58df58b07c70f11a64e2545d34de89c693d789040c65db4d4453e913d2651467e3a948d4035848e4cedd528a33255034ec4a91f9b0bfa88aee7689ac4d853cb64b886d827cc0933b01ea2aaefd2904f234c03f9f0e1e9ad12ec11e79291012c2b51f3039320fd65af94267d5f808f92cf85b7e5973437d4dd7368a4c96521679720c97f80aa42c169707069486aa71794c98499025e687ccfd8a5145f26296672e6ca6744a854bf70742532cee4859e55a4d62c011f4bf9b445a86e8c2e8e38eb7b92396579677e3cbabdd29acbbc7a6ae3ef99a74fada31d50a162d5a56736099db01f6412b0d7b93f65107cf5b59bf0f121b78f3afbcb4a179de995b7f03b6087cfd4314b273310de9a09fde87403c09decd8df49f613a02d00d858df7b617dbe97a97940c8845507300238357abe49e11c66f0538b4aefffa839de9cdb9c0229657f4c3922c18320588d2334ec0e6bf182743912451e30f217e97795f23db203ebf4744b8d4ec6847c555823361c9f4eba5c67944e85d14eaef87832b689304a526df57afffd0b567b76c433725f68450afbac99d00f2bb733d8b762c10594b14bddceb7c4c6e6263358f0ecdea29a8743ea2f137eda20100aa6b188d3b6a0cb3212a039d4c81c46ccad8150f857da79e4c9ef04ae6330271e47cb6c9b005acdd80e3d84a05a8e9c9f1322fa65098b4ced11c1aa5ad4d58dc17d6a69dbd305328912065388d66ea7330de13148668ef80f8b893a7c5c6dcb5d9fbc7835298423e2a6d03b46f6f3ff0b0f979508d1f032640ead8c7790e55f004d9d1c77893afd1ef94e75a2e26208ed41f324e879f563c93c3a4976c82eb9a8dceebe795971ed8c97b863f96d674c542368949d484a62e8ff3a50d2608fce756e3032efe11e5ee7705c8f64e5f25cfe909cd8613bf6f463f8868b9783dfd42609d38f9e3b728eb8a192e50fa06dc1b9ead91dffb234df1749b8f40681efe2c725736f23e39252dfdd192cacf0fc700618fdaad566c5352db6f9fdbadd7f0342c3949d6b4f2fc3dc5bbb1d23dc35b8dbf725fe9ac0397c83275b07fc8814847e542a72330c297ecdae48c337a1333221009a86568abbf986aa2f64c97ccf80bde3bfcc696479a137ac4583aa010868e4bc8d30910882d717e69afc3cdd00d8bc773d90bd6da5c4cd5863c4a14a26976375345175a0b3a7c633ce83465dda29bc6915109ca4bb59f8cb2019b1d43e0139c3c634d27a81f5ec17bfd36dd2b21fdac8e695333900cfb78d169cac8ed975aa9783acebfe7cb0c0208becdf62c1d54c4ff3e61671fdcc739d5014c32ba716346ad5cfcf4e98600e94d438aae646a243011c06ac2f28eea34e7a91912608a82308716e5ffd8a8486fb1e16f7688c06a3346a37d154933ec8924a375e02186977c2f9ebd4d6d4bc4820994cea01217ef295707dab368ca7eb007fa9567922566e2c6c2aead45c38be9994ebbe272ca0a3a20023479790dadc2e23d0d8cf17239b2d69285556498f610e839b735d5ffe741d35478cb6e4f00dfd09a6591f6e845702f614bce724ca8cc1f80a59a71febaabf1366d5f4331f558ae89b63a19949893488cfe2120a0d47d0ca08427b3d2d390a28ae9c83e986cf0c328afa23af188e668717550527a9378b8e4c4b59e61fba3c008c85c33358b74a7ac04dabc7da40ea90a5ca37bc832bde0c3febff44c3cc742c4cf6ae43040c4d39e5dec8b8b94fb5e0501da002d274d7d3fea6630a5e384b43b4eeafde8608af73cf79d00756cffc55a7e6e2c8d317c7ed3323375ff5be1ff918799439a08d8b4eb1a2ec663710d98f320606317f7b1ecb47758762cd7f420e20f466d0d34065b202621bd49352908b0c2fe43d1ca476cfa0522d5c2b836bfa50adb1e792ef5b671cc074fdc2fc50d988c4ffbb9d0557b1fd45017fb93709dac451d398903525ecd5b9b5bc395d1a869c9adeec31037a6bf86d512c4f0353b906d3a7be78fa3603e9f2df56dc5e6fdf38892111afee45f2828b95116a4f9c75c1d05d60f03ab84b3b164ccadee65c8864c303a10f7c16331b867611e90428eb7471a2588d1f18b80caff6e276839187c951d77cdd8261599c767ca5c847219eb5973e168e34ec7976e7e585a5b2ce6c37e4114b243f168fddfeb75a8755e1884af27cec288ae4b876f071a4fc1593d8f9b30aa4f5f8cd102cbb3991adba281eb2a07731fc47dc1cd6c20592ff6143216e027311f401541c5d999c36f1c5880ba86b97f050fb00013cc3cfcd727d64f70bc39ea688a56233fb877f8c2a62e56c781ae6a70416d60f5180f8b2ea4c2a665b93ced599fed607666a52ef40b49e887574dbf8e657097e8a4bb4b9f8e6670b72f24cfdfacba3d6fb08553177815771f3e68b58dc27fea77060f53b0e6ede7a9300d2e08c99afe5d85de13e4b3b1a9c8897197d7b89f7c084b70e60596de3e47e55b563bf62a715735243b0b4196f968bbc2a569d4b466be46c08b979aa89c6f6b6f18db273eb5ae3bbaaf1b3959b9b55e470782623674dd9f5555c7590be84b0892b7dca90b45c71a6399a517b530cd2f04f47fd595d4084bf00aeba77d56e0baef2b9a02762d3acd61aa325ade4b399679afa68a223668a4b4f24099cb8deced91d08e5405b3bc223181ee1f19b09433b88010a4d1bdf5d2aca2fec62455893ad7c7e1af90c1f5c341797526728c856f55e95598bfc407bad116275f3c754e0b45616aba3d0b2bfcf64cf23bd0cff774b2301f80515f7927940cae67cfc1e510f074cf36a2cc27112d57142f247e9f3713f01de96a631857875267fe0a81a5e04d3063d8a669c4d81bcf1a802c79623536f18b60c4e0bcdc087a74a55981cd6f5eb31f821227b52f71ac9b9f6d8809ad2cddcceb5dd33a467c30c27abc5463b6bc95fcc147481343c7886a8e65e824f2f9c179302711fbcb733c95b1486be62a67f8d552845fe39916eeb528f04354b88e9c58f39d28440922c8f9bb34a188f643c134972fff2572019dde7a037aaed492cf31e9d51f22d859a7211b023dfff7d53044888a2bc10c5cbbfc001e164a7d72a4e5ea519c81121d3fc6ec7305c8018b9860caa60304f1efdd25162d293b2584d8a84aa6ad013b9a22f6a3bbf3cb00ed612cf95d4708ebb5ad16ffbb5040c690519221a9d9f1319eb268679ba77943b6949ff683bbd826d3909a1b0638d9cbeea32d3cb6436fb6ce232c84ff33b7ec7694b191800164d71777a0ed36d3cd361ed93dc882e3b6ae1cbf186652d612433a21f4c14713141d741b6fd47b3d25b42130c221971ae6c8cdd00634befc02f3147aed30bf862826f60b6633a6fd9c6aae1a6939b4e42b1de9a2a614815928aa3e0df88350903646f875846837ea22c494752f8ed84163664daed10671b54c5afc3fb4a9f90b2457845f406c920c22f7a2705a58825a503a9d4d29207afdf4f7b9970755b582c2ea5c474f844160507b3a2e548a42e6954ae478d53726ad257a6dbece5fa5ea262b664c44052f1676d3ec1e86d171886f999062482941933b2d5224846cdaff99842951a3235b5b12aa969a67860922b6b36bd09726c96bcbfe22ffbf1c1690fb0ed25059c722352f5c889ae833a28d631941437e7e0c26096f3957f34b7313efcc95d7440f6680dd473a54544c000510b291c5c749a777c21990a419237c4d93f6371a78f12a892c407ad4abc1bde80a49bad12216873609549c81744f12c69a483fc33ba1f1ff68e56322a5c718d0d4674ea4d7b90768d914944f37eba58d2b7ab95d0260a7285eabfda754acb897035746f95955df1f7f89e34f88878292ce66c5d3c026822d8a7f0c8029fa05e1a722ffb66645e1c529e487fb87cf01366a83ca25ec31916113bfce352f5cc01f50afe2be51f3db2ade85a4de2d24ba3a8c87d19e3888f729de087a1caeca5ecf5eda1e646983897969a8ed77a66d8b1a8f3fcf16dd7e8a899a708cd47964989c5f010aed2543e9e4e2c4e3d87ebfc41f52fea2a553823b5982e0aae1a026163113356931f2940b240e6a2612b2e0c7d4b007e26ba4f3b4b9098ef65630546aafb36a9c5c82954474cd1bd00442475b27b2fc5a8869c73f4b7a38edf41d374f9c226fd4523af92af0180fad338c21181635b7a8a5c75a740435d78e53fd7aaff3c5c7ccc9c983feea9b8a3b65bb0c7771225067123f4de1ed9aa97538c113f821490fed9c0f56ed806d599a668b915e7db973812da7b6bd10f33e26a1e59cf80cb52b0f92cfef12b9fb2ea87a2ca185a4536b685951333179de73cae47aeca35a07864d7f81c81b761633b66323e04d4c9833da652f009f01eff2d1434b4cadcb79a1351f4ea19b0920dcf7cfaeec1eb1a6695b61c05ee9ca44543506bfce878572478a895ee4ac41e0b201a72f7e2ec6be866c5a9943d56a4789b6f2fb496ebaa309f87a69bee4e9890b0ae1c656c7fc05ed1992b653b66bd75a7432a85a0a49e1a54d55556370c39b821b4094e2930fe1b85668004c761167e1021cfc0059e3acb1a1cb1242171e30005cd20baad808f96c5588ea5a11d67358977d427f6f02b004ed7e5ff74262279febbb81dc8076c7e7a9404099727eda50f46ab8ecd578f0bba853c968d758a33384e219a3448c84d3c23b11e2df55e4ce233bd9b007943aae95771c61ef65165fd7de4aa67db65d16d7a825fe719d880d9df5534b829c7cfccb8d7940ea40fdf20c13d2432a4d794894842115cf8b9f9826da42e3da6220dbeecb76a50c5f38ed250348519da2eabc0042502f90449027939ee3f3da24e22fa3a4c32c3232974f8250c1534fab5e5e386fafe748fa76c844e111d192a8a3400b51bf84b40bd722e449f51fab11e79ac6198af73231b15adda2d8840c6b5bd02b4dbe8c9b24be177bd927ff061a8bd2cdf9ce92ea2aa013d9267ce3c9bba1d59c1195a24ab70eeeb96b815e6e10e163743510c45a6105d7084652b3a926cb17d91d58eed461a1095d54dcd82f81d1560c2774f3f475a4d20b52c74e67d0b4b5c0e1ca1ec2683f64ea8d66cf361282f9aebcb3e94fc2b48a7a50a2bd9f831aa22d1b16745eb331e6692f7c33842f9ede5f19a362389da963f8d4bf6a87589e90c5e47d3f3bf7b2b35b11f19519319dc7c0596e5e0971a61141ba4c77060f90dfc4719d4ec4fff9c01ca57db75d9e566599186c167c27de1bc1fba50dc1864d0c6d051aa9c6d186c36c81246936bc6836d6833c0ecace40725029da384c685f99ca6817a638ab1fcb60cc4c67aeb02113867fce05a66b00b946c3224d7ca2f237396187c24c320e28e3b952704104efce46ff521cbaf2f5125d2986d00eb53a4cb2b4ad17e69a1fc5054260ab8b042148ecb7130731df2414b8b44f21fbfe5ac530ee2009bad94b7c80890a6f37728ed6dcbb94193a8f85adb3ed6cc476277482bfdb39d76b47931995632ae6ca7478a3be30734f28d4b5678c5b84e722c23acea3ad027c71bf850e6a229bd52f17eb45db328a0ff537f170890958d5e32c57f0e46191e69a2ff4aa8b20a3d3ec9d35ec74b1e6d9081a6fdbba1bc3ec86a6f24cc02dd716c73298173521ed1be85500e65b06e8b15b710804bce3744c5e3e319a95fd1b6d335d8833235c06e7900f290685f1c8db24f027297a89fa322940e5936afee9536517abede5fd43295b646e7349b7d649e80ae12be85daf7cdb1bf0dc6717a0425455779a26759d30b00d1d379133f8653e4dd2c9691241f857ead6cfc584556cf081b8847d6415e030667ac6b566c527ec5fc67f4c152f624f60bf00fa57f8c55bb3479e2cf171b0823a4304caac0f19fd3444d4a28fa156d63aec12b1f6c4a36ae548f438ac46bd0e26eca1b94d576853c3c647fb9eefb3788f60339b17ff23315a6a35c1c7f18e6d9cd557f6865fe8b6a0b591b1d6a585d9ed9b92894f40d30b84d32ec04963eabd780269dfe527df0b0f448666fe40d974c7d48a5c7a0faa71523d2ffc4c263c710c0e25f3dea0d1198f43a9225753c8ef1a6df9dc3fe9bb2685567f0886b7d14bf260e3051c655b3d88218723ed273331e4fc5855643f1e4d0bb64490e0c1842f26a76c827dabe1259d936ac338bee0d4111aceb7c0d9729ae59362b3b6bc65ae580b84ad8ed371a4041326958f309e942e1dca6cc02e506c29dbbf3dfd235b2f1900043c1c458193f14b48ea87058cdd8614e99745207aca2f5ec69c81be7d5e0af4130ea943191bc3aa11de66d948afc6ecb22b1ea46ae6388bba6d16989a72321bad3a8e70330792e7b01cb2a4e85eef427210b7260a27e420a3921529a2f90547fb85b25f3df8ca8a6ed3c942649c37eba178afd4ff7b65e49005abeedc50b634b2357e1afb9d6499b9c1bca5eed09b1cd3a4edc7919110c83fbcc0f3e6442ae8d27c6cf920f42883dd6153fea41f057096fef86d28ed26d7dcbe35e8943fc4d5576d59dcba328a1b3251cef0b4908a50374de0bcbbd1a0b6cfb98a19526baf600458f5cabe0038371dd75e129f3568e32b1f297efc3e1feeb8e1e61ddd4b43533b45a4fc63c639cc5a9c2f2fe2b6def7afdb371500980808b50d7779e19889f37978f441bd0d5e648d9bd4a8216a52468fd9a644845a01e92ad8ad3f21eea2bd2559ff4954ec8b6ecf7ed4cdc9341291dd1b540bce7f4c95efe9c1b715f5394efd3d297359346cc4116d1b08d9a9245c5e109</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> test </tag>
            
            <tag> 基环树 </tag>
            
            <tag> 基尔霍夫矩阵 </tag>
            
            <tag> 生成树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>后缀数组</title>
      <link href="/2021/12/20/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/"/>
      <url>/2021/12/20/%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<p> 字符串总是让人头疼</p><span id="more"></span><h1 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h1><h2 id="前置知识：基数排序"><a href="#前置知识：基数排序" class="headerlink" title="前置知识：基数排序"></a>前置知识：基数排序</h2><p>首先保证值域为 $[0, n] \wedge \mathbb{Z}$ </p><p>然后统计每个数有多少个，记作 $cnt[i]$ ，然后将 $cnt$ 求出前缀和，此时 $cnt[i]$ 就是“小于等于 $i$ 的数的个数”，倒序扫描每一个数（倒序是为了<strong>使排序稳定</strong>），扫到 $i$ 就令 $i$ 的排名为 $cnt[i]$ ，并 $–cnt[i]$ ，由此就可以做到<strong>单关键字基数排序</strong>，时间为 $O(n)$ </p><p>对于双关键字，我们先对第二关键字进行排序，然后不管第二关键字，只对第一关键字进行基数排序，由于基数排序是稳定的，所以当第一关键字相同时，第二关键字仍然是有序的</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>后缀数组是一种针对字符串的数据结构，为了方便，我们统一令字符串的<strong>下标从1开始</strong></p><ul><li>字符串：由字符组成的序列，用大写字母表示，如 $T = ababbcbac$ ，记其长度为 $len(T)$ </li><li>子串：一个字符串的某一段，记作 $T[2, 5] = babb$ ，其中 $[2, 5]$ 是下标区间</li><li>后缀：一个长度为 $len$ 的字符串有  $len$ 个后缀子串，为 $\{S \mid S = T[i, len], i \in [1, n]\}$ ，为了方便，称从 $i$ 开头的后缀为“第 $i$ 个后缀”，记作 $suf(i)$ （suffix），即 $suf(i) = T[i, len]$ </li><li>前缀：我们将串 $T$ 长度为 $len$ 的前缀 $T[1, len]$ 记为 $T^{len}$  </li><li>后缀数组 $SA[i]$ ：排名第 $i$ 的后缀是 $suf(SA[i])$ ，注意<strong>区别“排名为 $i$ ”和“第 $i$ 个后缀”</strong></li><li>排名数组 $rk[i]$ ：第 $i$ 个后缀的排名是 $rk[i]$ </li><li>$hei[i]$ （height）： $suf(SA[i])$ 与 $suf(SA[i - 1])$ 的LCP（最长公共前缀），<strong>可指字符串，也可指长度</strong></li><li>$lcp(i, j)$ ： $suf(SA[i])$ 和 $suf(SA[j])$ 的LCP</li><li> $h(i)$ ：第 $i$ 个后缀与排名在其前面的第一个后缀的LCP，即 $h(i) = height[rk[i]]$ </li></ul><h2 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h2><h3 id="SA-rk"><a href="#SA-rk" class="headerlink" title="SA/rk"></a>SA/rk</h3><p>求后缀数组 $SA$ 一般用<strong>倍增算法</strong>求出（同时 $rk$ 也就求出来了），时间复杂度为 $O(n \log n)$ </p><p>首先我们想如何对 $\{suf(i)\}$ 排序，由整数排序的方法我们知道，至少要进行 $n \log n$ 次比较，但是，字符串比较的时间复杂度为 $O(n)$ ，故直接比较时间为 $O(n^2 \log n)$ </p><p>不难想到，如果能让字符串对应上数字（且大小关系对应）不就可以直接比较了吗？倍增算法就基于此，其流程如下：</p><ol><li>假设我们要比较 $\{S_i[l, r]\}$ ，取 $mid = \frac{l + r}{2}$ ，递归比较 $\{S_i[l, mid]\}$ 和 $\{S_i[mid + 1, r]\}$ ；递归的边界是当 $S_i[l, r]$ 只有一个字符，可以直接排序</li><li>假设递归完毕，则 $\{S_i[l, mid]\}$ 和 $\{S_i[mid + 1, r]\}$ 已经有序，扫一遍可以把他们离散化到整数，设 $S_i[p, q] \rightarrow A_i[p, q]$ ，现在 $S_i[l, r]$ 被变成了整数二元组 $(A_i[l, mid], A_i[mid + 1, r])$ ，直接排序即可</li></ol><p>以上会递归 $\log n$ 层，每次基数排序为 $O(n)$ ，总时间复杂度为 $O(n \log n)$ 具体实现时常用循环代替递归</p><p>ps：其实有 $O(n)$ 的DC3算法，但不常用（常数大+难打），有时间再写吧（挖坑）</p><h3 id="hei"><a href="#hei" class="headerlink" title="hei"></a>hei</h3><p>首先证明三个引理：</p><p><strong>引理1</strong>：<br>$$<br>lcp(i, j) = \min(lcp(i, k), lcp(k, j)),i \le k \le j<br>$$<br>即对于任意的 $i \le k \le j$ ，排名第 $i$ 的后缀和排名第 $j$ 的后缀的LCP就是排名第 $k$ 的后缀和它们分别的LCP中较小值</p><p><img src="https://s2.loli.net/2021/12/20/fOrihaHRVncWGz6.png" alt="引理1"></p><p>证明：</p><p>排名为 $i$ 的后缀为 $S_i$ ，设 $T = \min(lcp(i, k), lcp(k, j)), R = lcp(i, j)$ </p><p>首先若 $R &lt; T$ ，那么由于 $lcp(i, k) \ge T$ ，所以 $i$ 的一定有前缀 $T$ ，而 $j$ 也有前缀 $T$ ，则 $lcp(i, j) = T$ ，矛盾，故 $lcp(i, j) \ge T$ </p><p>然后若 $R &gt; T$ ，那么因为 $S_i[1, R] = S_j[1, R]$ ，又z因为排名， $S_i[1, R] \le S_k[1, R] \le S_j[1, R]$ ，则 $S_i[1, R] = S_k[1, R] = S_j[1, R]$ ，则 $T = R$ ，矛盾</p><p>综上，$T = R$ 引理得证</p><p><strong>引理2</strong>：<br>$$<br>lcp(i, j) = \min(lcp(i, i + 1), lcp(i + 1, i + 2), …, lcp(j - 1, j)), i \le j<br>$$<br>即对于任意的 $i \le j$ 排名第 $i$ 的后缀和排名第 $j$ 的后缀的LCP就是它们之间的后缀（包括它们）中相邻两个的LCP的最小值</p><p>证明：</p><p>由引理1，有 $\min(lcp(i, i + 1), lcp(i + 1, i + 2)) = lcp(i, i + 2)$ 不断以此类推，即得引理2</p><p>这个引理也可以表示为：<br>$$<br>lcp(i, j) = \min_{i &lt; k \le j} \{ hei[k]\}<br>$$<br>用这个引理可以<strong>将后缀的LCP转化为RMQ</strong>，ST表可以做到 $O(1)$ </p><p><strong>引理3</strong>：<br>$$<br>hi(i) \ge hi(i - 1) - 1<br>$$<br> $hi(i - 1) \le 1$ 时显然成立</p><p>当 $hi(i - 1) &gt; 1$ 时，不妨设 $k = SA[rk[i - 1] - 1]$ ，即排名在第 $i$ 个后缀（不是排名为 $i$ 的后缀）前面的第一个后缀是第 $k$ 个后缀，同理设 $r = SA[rk[i] - 1]$ </p><p>有 $hi(i - 1) = lcp(suf(i - 1), suf(k))$ ，将这两个字符串各自去掉第一个字符，因为它们的LCP大于1，所以这个字符一定相等，则有 $lcp(suf(k + 1), suf(i)) = hi(i - 1) - 1$ 且 $suf(k + 1)$ 排在 $suf(i)$ 前面，则由引理1有<br>$$<br>\begin{aligned}<br>hi(i - 1) - 1<br>&amp;= lcp(suf(k + 1), suf(i))\\<br>&amp;= \min(lcp(suf(k + 1), suf(r)), lcp(suf(r), suf(i)))\\<br>&amp;\le lcp(suf(r), suf(i))\\<br>&amp;= hi(i)<br>\end{aligned}<br>$$<br>故 $hi(i) \ge hi(i - 1) - 1$ </p><p>有了上面三个引理，我们来看如何求 $hei$ </p><p>我们枚举 $1 \le i \le n$ ，计算 $hei[rk[i]]$ </p><p>对于 $rk[i] = 1$ ，不必管，因为 $hei[1] = 0$ ，否则令 $k = hi(i - 1) - 1$ （特别的，若 $hi(i - 1) \le 1$ ，就让 $k = 0$ ），然后暴力求 $k$ 还能向后走多少，易知时间为 $O(n)$  </p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.acwing.com/problem/content/2717/">模板</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> sa[N], rk[N], hei[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_sa</span><span class="params">(<span class="keyword">int</span> _num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> x[N], y[N], c[N]; <span class="comment">//排序用,第一关键字,第二关键字,cnt</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i] = s[i]]; <span class="comment">//第一次只有一个字符,不必离散化</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[i]]--] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, num; k &lt;= n; k &lt;&lt;= <span class="number">1</span>) <span class="comment">//k枚举关键字长度,合并后长度应为2k</span></span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>; <span class="comment">//记录离散化后的值域</span></span><br><span class="line"><span class="comment">//先以第二关键字排序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i)  <span class="comment">//没有第二关键字的牌最前</span></span><br><span class="line">y[++num] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">y[++num] = sa[i] - k;</span><br><span class="line"><span class="comment">//以第一关键字排序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[y[i]]]--] = y[i], y[i] = <span class="number">0</span>;  <span class="comment">//这里清空y实际上是清空x,因为后面交换了</span></span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="comment">//将排好序的字符串离散化</span></span><br><span class="line">x[sa[<span class="number">1</span>]] = num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++num;</span><br><span class="line"><span class="keyword">if</span> (num == n)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">_num = num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">rk[sa[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_hei</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rk[i] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k)</span><br><span class="line">--k;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; s[i + k] == s[j + k])</span><br><span class="line">++k;</span><br><span class="line">hei[rk[i]] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">get_sa</span>(<span class="string">&#x27;z&#x27;</span>);</span><br><span class="line"><span class="built_in">get_hei</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, sa[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, hei[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>SA的应用主要是通过引理2来实现的</p><h3 id="多模式串的匹配"><a href="#多模式串的匹配" class="headerlink" title="多模式串的匹配"></a>多模式串的匹配</h3><p>考虑如下问题：给定模式串 $P$ 和长度为 $n$ 的文本串 $T$ 询问 $P$ 在 $T$ 中出现的情况</p><p>当 $P$ 只有一个时，就是kmp，当有多个 $P$ 时，也可以AC自动机，以上算法都是 $O(n)$ 的，那么后缀数组如何比较好的解决该问题</p><p>首先不难想到， $T$ 的任意一个子串都一定可以对应到唯一一个后缀的前缀，具体的， $T[l, r] \leftrightarrow suf(l)^r$ </p><p>那么考虑构造出 $T$ 的后缀数组，由于 $T$ 的后缀已经被排好了序，可以二分查找每个后缀是否有前缀 $P$ ，具体的，若我们二分到了区间 $[l, r]$ ：</p><ol><li>如果 $P$ 是 $suf(SA[mid])$ 的前缀，说明这就是 $P$ 在 $T$ 中的出现，所有 $lcp(mid, j) \ge len(P)$ 的 $j$ 也是 $P$ 的出现</li><li>如果 $P \le suf(SA(mid))$ ，进入区间 $[l, mid - 1]$ ，否则进入 $[mid + 1, r]$ </li></ol><p>以上算法的时间复杂度为 $O(len(P) \log n)$ ，时间主要消耗在第二步的比较上，可以用 $hei$ 数组优化</p><p>假设到当前为止，获得的最大前缀匹配长度为 $maxlen$ ，其对应的后缀位置为 $SA[pos]$ ，即 $P^{maxlen} = suf(SA[pos])^{maxlen}$ ，对于当前位置 $mid$ ，求出 $len = lcp(mid, pos)$  （这可以ST表 $O(1)$ 求出），分类讨论：</p><ol><li> $len &lt; maxlen$ ，由匹配的最大性可知 $suf(SA[mid])$ 的第 $len + 1$ 个字符一定不同于 $P$ 的第 $len + 1$ 个字符，直接比较这两个字符即可</li><li> $len \ge maxlen$ ，从 $maxlen + 1$ 开始比较 $P$ 和 $suf(SA[mid])$ ，完成后更新 $maxlen$ 和 $pos$ </li><li>当 $maxlen = len(P)$ 时，匹配完成</li></ol><p>以上过程中， $maxlen$ 是不下降的，加上一个二分，在不考虑预处理的情况下，时间复杂度为 $O(len(P) + \log n)$ （然而，就算是用DC3 $O(n)$ 求出后缀数组，ST表预处理还是 $O(n \log n)$ ）</p><p>代码如下：</p><p><a href="https://www.luogu.com.cn/problem/P3808">【模板】AC自动机（简单版）</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e6</span> + <span class="number">5</span>, D = <span class="number">30</span>; <span class="comment">//开大点</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> T[N], P[N], s[N];</span><br><span class="line"><span class="keyword">int</span> sa[N], rk[N], hei[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> mn[N][D];</span><br><span class="line"><span class="keyword">int</span> log_2[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">(<span class="keyword">int</span> x[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">log_2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">log_2[i] = log_2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">mn[i][<span class="number">0</span>] = x[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= log_2[n] + <span class="number">1</span>; ++j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - (<span class="number">1</span> &lt;&lt; j) + <span class="number">1</span>; ++i)</span><br><span class="line">mn[i][j] = <span class="built_in">min</span>(mn[i][j - <span class="number">1</span>], mn[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> t = log_2[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">min</span>(mn[l][t], mn[r - (<span class="number">1</span> &lt;&lt; t) + <span class="number">1</span>][t]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; st;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_sa</span><span class="params">(<span class="keyword">int</span> _num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STC <span class="keyword">int</span> x[N], y[N], c[N];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i] = T[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[i]]--] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>, num; k &lt;= n; k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">y[++num] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">y[++num] = sa[i] - k;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">++c[x[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= _num; ++i)</span><br><span class="line">c[i] += c[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">sa[c[x[y[i]]]--] = y[i], y[i] = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line">x[sa[<span class="number">1</span>]] = num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++num;</span><br><span class="line"><span class="keyword">if</span> (num == n)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">_num = num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">rk[sa[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_hei</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rk[i] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k)</span><br><span class="line">--k;</span><br><span class="line"><span class="keyword">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; T[i + k] == T[j + k])</span><br><span class="line">++k;</span><br><span class="line">hei[rk[i]] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lcp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == y)</span><br><span class="line"><span class="keyword">return</span> n - sa[x] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x &gt; y)</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="keyword">return</span> st.<span class="built_in">ask</span>(x + <span class="number">1</span>, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">suf</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> T + x - <span class="number">1</span>; <span class="comment">//减1是为了让下标从1开始</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span> *x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">2</span>, r = n, m = <span class="built_in">strlen</span>(x + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">1</span>, mxl = <span class="number">0</span>; <span class="comment">//pos初值不能为0,否则ST表会RE</span></span><br><span class="line"><span class="keyword">char</span> *t = <span class="built_in">suf</span>(sa[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">while</span> (mxl &lt; m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (sa[<span class="number">1</span>] + mxl &gt; n || t[mxl + <span class="number">1</span>] != x[mxl + <span class="number">1</span>]) <span class="comment">//为防止越界</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">++mxl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (mxl == m)</span><br><span class="line"><span class="keyword">return</span> pos;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">lcp</span>(mid, pos);</span><br><span class="line">t = <span class="built_in">suf</span>(sa[mid]); <span class="comment">//这里一定是sa[mid]不是mid</span></span><br><span class="line"><span class="keyword">if</span> (len &gt;= mxl)</span><br><span class="line">&#123;</span><br><span class="line">len = mxl;</span><br><span class="line">pos = mid;</span><br><span class="line"><span class="keyword">while</span> (len &lt; m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (sa[mid] + len &gt; n || t[len + <span class="number">1</span>] != x[len + <span class="number">1</span>]) <span class="comment">//为防止越界</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">++len;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (len == m)</span><br><span class="line"><span class="keyword">return</span> pos;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (sa[mid] + len &gt; n || x[len + <span class="number">1</span>] &gt; t[len + <span class="number">1</span>])</span><br><span class="line">l = mid + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">r = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> q, ans = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, cs = <span class="number">0</span>; i &lt;= q; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">while</span> (ch &lt; <span class="string">&#x27;a&#x27;</span> || ch &gt; <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">ch = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">s[++cs] = ch, ch = <span class="built_in">getchar</span>();</span><br><span class="line">s[++cs] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, T + <span class="number">1</span>);</span><br><span class="line">n = <span class="built_in">strlen</span>(T + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">get_sa</span>(<span class="string">&#x27;z&#x27;</span>);</span><br><span class="line"><span class="built_in">get_hei</span>();</span><br><span class="line">st.<span class="built_in">prev</span>(hei);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, cs = <span class="number">1</span>, j; i &lt;= q; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; s[cs] != <span class="string">&#x27;$&#x27;</span>; ++cs, ++j)</span><br><span class="line">P[j] = s[cs];</span><br><span class="line">++cs;</span><br><span class="line">P[j] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">find</span>(P) != <span class="number">-1</span>)</span><br><span class="line">++ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 分治 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 后缀数组,SA </tag>
            
            <tag> LCP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/20总结</title>
      <link href="/2021/12/20/test2021-12-20%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/20/test2021-12-20%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ed335c3bf68d2a0fa54d6c7c13beac672c0e6ce951cdfbc3e932463d28cf8385">111e7d6409c611e6b63fd1363c3273c869b19609281eb10b40c0a6c772dac972e0464347c763e23e7fd9f61b1f7cde0ad008d715abfc45cc75d5ee73f8a8b9a10d96527c6539f3b05e5fa92d383942a731b3b6d7ef8a2bf4c86f16f2ffc638ff217614bc7e076a23f486c7ace2d610ae29f3d704476a25bcf4025ed086de31c5babf42ba756b2684c3468a7c6f538afb5754936cf88355738cee7433c4aac8429fdabc0edeeef84b9e62710824bbfcd1251f2a45e1e4e03f7069eee2f2c83bf278f559ab2a4f299ac8ff1758e0e10c4b1cb63e7e8c6767d9ad3dc1484b00784f0c090babcca16a52d1553624d8517926087012b3c4167ca55dc63b6d88d43707661520df8226e08894155bd35ff3c92fb7642b605093d5e072d7fdb5ea09f78cffde2f460f072998815b4a6a155d4f402e9a7a9ad28d379368459061e776f72e84f02f831a8d88d17eab92f65a75456830877310451b2142fcf586ee1cee7243e088fea114f4a3226561bb5bde1d7108a53fe131aaaa650c6ccaf1dbb998a74f8a197cf9584af206fbf7d26c486392c1e2e58b155fd83b9ddbfe44aa47823f18340e6eb0db2c599e20204696d90e2a613b2b67c8c73d0c7c35cdb7b124e69cd60cb8927f45522ea84212b311de7b0bfd3c41612e18d710b76a7534c9835d3bf18277dee9f0f44679d685418fd7c2cfb8b1b3266d9775dc36c04523da6db5b99644d6634ced3d912c444cace46202b5aabd0381292ec97e6a5ad8f3a5ff954771d4572e151cf842d0be80b780864e129a468b818cb522b8d7d6afdc0140bd7320c70768f53de1bdb1e424af4cc113095ed7bff4e4830684708944ee253db5a65eca366d4d03303976027629f97723c348e2160fc63c3befc202319f17186ce39590c05b7654f9b420542e183bea7ff944cbacbec9970d634d689f957fb2e69b5f3d3ddea1872f0facb96804c729c98438f07e8b0a22b2e9f21237978c747dd6b88b0b04f2d8dafa4b6429e6e9006d615404540ebee1da2b842055c84330c7ece7e63199e915d8e5998fda41ed873070bc7947b837fcad4b3f49b71bdeae51bd56cffcb97da8811819b47b0a031361b2df6110dea238355b098fbf1f32027ed0f608b1c23ca12fbdb0bf9a40649d848de92c0468ef9d32fe6b27da51885734ab309f20505f38f34380d341e97832161b96fe85ebb6fec6c737788b0ea6be284e15ac33bf2b50d0c70f37731960dfa7927a814a099a52a346da5eac74fed26b957b035c7c035e6934077ed73b3974689c58b3502f9fe5b3b51de35059a5f80274e48376c958a0d3c986ed9c67dbc8497812277077d1daf48d20a87a55214a18b9de90a6e622bf27cd42b5ffd2ae0b69d141661b90441969e77c110e5cd157531508069c59a95a856b7ae30d3a4b1b4039e3f262d9db620ad41d7cc64e76fe651e9c7b69f0ef397d853aa8dc133f461c618cd17bc35d5aad87a7668122166171656f657fc218b7b460f4e06e67748ae60a654a08f292b54da2de8e5e9498850789345b185a1da05f10476b17ce5032b288b6e954e84e555d24e873a588b2d490fa606b410dbdf96a551af36868b10bef48fbbd44d44f2830a5f032cb484c227dd9f534e31c2395ccec0b1e02952c331cc67be23c539f30cd274d4918115f56d92346bdc31a99bb94e2743ac47b9d7419f226ef99fa17177d7f95300446e5d8d801fedb90520dff7bce224d66912817e01ecb9af575fc82a80a94b63bef2281584760915673c01f9a8e21f14c5fd161e41728650844f198a56382520c25cd519fbe244bc8f99e8317b74d07afbd78e0fa06a20171914bb555058d4b453c24435d8cbbdc98ff89b74e87e94c3db500aac180efb802b4876d17e9a4ee08184bb0d517fc208541368cbecfcb71ebd0fdcf45415dd4dd85e14087cd638974860af4379d06897cf70d1b240b37455fa821416d9fd7a56861e1cf96604d14497d8a9213af7066632c237f973364443af9afac70613f4e0148db571c570b2a6faf7cc5c2f17f5e81edfc00cad067f2babdb4659c890b7e18afdba16923051fc4c13b4332f786268999ee107c21fedc36376fe4bef765c2ffcb7a4c20e0b393112b105869e10ca420fcb8e3b84ee8bfe5db5a159ec8dae2be6658d72c486e9f8ece6878ee437ec0d839e7c8bc1ea9ed156c75ddc0f3df1fe75ddc087308e87af2044b5319f2a723fb3fe13afd134e8dbfef59c9f6f434214322f77807cdb7cf3120f0428c4645fad5039d50a8c1b8d0c20d14a5c1f64abf41149d028e8428360cefe8dc4c0baa2e322c6dfa7000ed9679073d57cc50df6d371a9cf44401accdc94c1d98c5cd921edb99d9f1b5afc0477dcb8170ccbdb3e429ee83a369c2842a581b83a9dec4cfa7b56134c8aa59ced0ec7b1a8719b3f5060e83d585ea8abc8840974e343d820c8503dadd6c6e4b122d17e7f4849ba8b2258b751f1f2118225937041dd071db3a5fc4043557dce73a9d5faae59587b1849bd4dda2a681e6c5dc8c54be23d86659d8188a21b3d44e80f9cfa767f6c1e84c555f0399efd439a475a40db09eb92e28cf50fc84642396db61757abecb1a51737cd39596b4dc3179c6b73b9c601a878ee69d5fee03fb843b7594c5a1087b3307bb73944280a73cf7c08d2ad45d89548e27337ec9e444cbec402b58416a211110b864df33c44378926f0587bf8f728e364aae4f1dfd4721fb0fcd3ebf7acf49995b5ce0cc4131a880423ff85be4275225a92c43cdbfd6a09b0f3c660eeed396ed4faf4c1f2ae4602afcf5ddb0678d0f1253573ac57d34a7883095226344c5d45a5c0eb7cda3e8e2c26f1f45b326d78b007fda0caeb646695e7d7ce2943b918deb44c6a995e9e368f58ca2abfa0abddfcacec4dff60ff0ea74488573659ea4367fd031c568d01ce1d77bb4faff0c595621b337730aaa2113afdaa36f07e81a5df2cf9537469d42d376372c5ebdae27fd900de53d4cba806c3f8117b621c1bb963341011b7cbf1a91a0c8dd51a1aa607b7ef152ebf53217c46bd3ec12915c8b4445ce58230b43cb11758fad81473c430052f1113b688a7de25d512117b8713f17ff7420d0bd597caec2ec181777f891908442006a5df24815108e4f9ae07b80bb1c97ffd3d210dd8ac092c9a5c83d313a8e5d721b8f00b81ca7094089f1fb6481cb637a807ca82346cd50f251f9cfcb59620db177bbc7c6c3f409f1523053e7916ac937dd84440d288ae470b3481f289a47f7c6c4009ce7b0795c27db0419a3bbdd1500d5ef54d1c1bf28accf816ca5dc95541ebecc1201dd966cb4925de4ef2c0bf01c1d56a256fecf8c624ec8405625863de2ded5bb49bd816ec4b7b35826fac41e9ae4f0f54da9a3357257f5c2f332f50347758c23201d498637c24e06250c38bf3c69b12e9b229027e1091247b7881a6c9f2f4cbaf1b2dd781b9bec7ee6a5193747649826edf16b4e6e0eb3f34289ebec892aefa394015432fe039a2d379d86cf438d06256532e859bee3a0a667f925365234d6ebf9fc86a7c8f738e05ee130eab2f7c89623747526151b774d34cf305be5447aa47e59dce28f4c59de6c9ede67742b00b7a5371cab976b298963f6ca12ee37326841b1c368fd45cf44fa2116fadd6b132cea0cd62fc71a28aea245efee6b854508b48afd4848b527cf1ae75d819dd6b9f4828063e1ab790d9abe25200848c3c92fae16c3373399cac311aac07f0132dca52042fdff636221118330dbee5a4e1b1c3bb2a612762a3c36521637de7b492531899ee93ecdb3d029d129c28bde5b14295a9af1f6d2d1cf759071b14ff4056d582a188ed8fb28bceb3ba7864aa69e55219ffd64dac918755e0b7a104e2e01c6f2409e07e5710093a1ac7c2a5585d0ea24f74b0d3c3e7d527cddd255657703b655e7f73abbe114203413ebc25468ca71446ec7272154211dfb85317808e2c1308bc3f95bce17da2ee05e6b9e1e2e20e2d0f1f12b06981f2ef4ac6a4ba94dc9d5c5a3f168ea3b24a0f389a3e65fbd6e01a16bb58293d1c0d9fc0989a79ae0950a38e88aa0c70cc1b060611080a27a676e9c6e43fc8fc3ef0298d9ff1ce9c231c0ac70c7634ac0cc37240f91f987ff3b5ae5e9492cedca42bd210382231eee84d78d97dffe78bb854ae291ba545dd5295aaae7a588da9a9ced523c16dfa797005c5771facc799d84a9371a1f5cf483004367c7ac4e5a154a2951dc76c3f7ce0028ebe1b82aef06dc9869abc0e437362f2c460fe6a433c676bd67575fad21be59dd7535cebc804a530e5c64a495895250ed3806c927efefe41eb4a08fa10dbc78f7ac70f84d41b1d6fd37bdf6c9a88c80576f8e05e0dcb42bdecf5e7a658244072879ceb6e5af4a7cfb61bb1c46e1d47b1c8439e5990faf2922a04f1c5abba070b769198c6ce88388f6d3a504f364d003415acc1390c2fd8de70700d84a61bd075ab6e2e806c3e4aa477b408605ef48565a3837be7e4e9ed29350e886ef637d420a47b5434cf38cf107206b5057ad2ece56fd504a14ba0a5a78c05ab17c5dea652fde790479bea4a715db2015d0d237c8e8fce6826f6988ea79e4358a941c5c772036e97328770963cadaae4157af161ad0e78873054ae99b1f0cc21f981ae4675667a96c3f782677d8f6f1b5b12831a5188a01dc87639e442e46ac1eb5b66bf365da47d3f1ca4a3d92baeaef980de3e361778b5bde75d4d4148ebc697bce3171910962a857f383c4e0e3b213676970036170dccdbf43247460f533ffaffa02d1897dd4f12625d83e62133422822c107768240de6e90a54da0a9392e8d9bf30841366d272149f65864b457cb7c60b0ef6c1f59393220371bb85cf46d07aca4e1b4a492dbb43c072123ac90bb8fe9c227e23b8b9025ce1009a8b47da01db3c6c9809b4c49c0ce4c13d8b53caac0fddfdf71c654a338ebfa1c3e4e4370f82fe3af11cff00043777dbeceebbfb9a85bf9ce5bfd9018a40fdcc96e56389157b6b3e928c5975743462b0bb8902a7b7af6596e44303c49e9655be2fcf8557ebbdfe02cd48bcba3c6f07c0e0f7f70143b35dcb422d6e5bc4c121ebc5288c6306d72ff4766654c0920b87ec6ef926afd60eb53ac92638f125e046729c04c8fd7d92f88fdc229f297d8b8146a29350c794f2d72cc0459da23a50d27213c0930f4542f87d43e419fde8b47234d7905bfaccf54c06d1074a4857cc07d928957e0fd6947c5ac6a61aba9535e61d949a421db81c519d77867ea4e97b53dc13ad4405944335a3bce0d02dfa2ffbe40e84a9a99333018442d5ce6c3c74624d51cd75503f7cf8d6465aa9ae9e9ca4ea6d396148e62f024869f383955ac22ba48a20dfb87210fd85c57c69c90dc5f9c1b531a36813426ddef62ca9710318d671e02e0d04c555f6fdf766a2141c0381981172f7cf12015803a372495d8777f7d19e401118311a2dc8a46159e26d65b21721cf1b0266b2cdf5f6f2c8fc567cc117919d0d62c6707e665b3171e43c27b2a3bbe47533fab307c8f32c5f9292797202d0f68f50e5c86a10befef6eaec7ecc9c844fd4346ffd571ad04e57438b2b3971d24675600a5dad3a63db8e490e29fe19a9d60e022625a9fbaf2e3c6899ae9025238fb7f11c317b3c02b8915b16c926e3c13f589437d75a83b770e91d397e4bebde90f55a80301709047a5073e23399e3f280442a948dfce542db84d0f645c2d19d67228c6eb96c9b1043b3f8f044b4776188dbc98e9cc7d24313d96a40e129dadb57f45feb4f3cc24916e703bbaa0a1f696b47d02d8221b3a800fee5d386071c81002aa7367cfa4f8fc9759ed706b110dbdc0a37906f5b9049e8de5f27249dfd9089961291a22f339cf387d795efc83c27538d4faffbf6d6c174081227454d96cdd1c7cd56409bf54b2596ff74dac65c6d69a32a84ab03e0b160a44e257f7b5a94670b8a9a86f70033834748b3cc2cdc364a7bba5c7bab420f8a841b9d3ced22b0ee3c95f90c37cb723f3d24e4f1c0e8a0907c924c9672da04968a63f1868850b15f327b94525a181b1c4d7da74d5b07a68dde9b8dbc073b6912fe489c880a41b959ce6736902f4660e1b68b52192ac4835a2736c1dffd3979b525a52a5a81b9e4b36f2a8c0f4c04bfb5a135e975ea6e82e9320d94cb6721be5d524b94110fb5e3592d55af121cea6d4185f56e124dfd8987c309a9f36f806e2c6f773b1c54474460dd085d154cedecc5256172daa8ccd4f754c3ae39c8a52c86cc8dd7bfea56db2ca1942c27d08fbc68e156671c7af161ec169acaef9d455ee26da6afd6149fa986039b85c1469fe4702ffa3edf919287c02dc7b0c7e47c7b5989085a686365ab5135aa288f214d655bb337d7119de2fea1a86607485bcd92de8f565c16daaf05b49e1ca74b445a281fd31fe7c37d4e5d68418a0835404632a1205de3c9fe46dd817eff415ee08a504188f4a2e6299a12c3efe646a84c9a0b024ecf8515f493e98f13a5511beaff3b3aded3189c01672f61b8daffe5ae648441a300731cebb894fc1713c103883ea20a196f845854524ca26697dc63d4d63a1bab5fbe0f991cda6a5946087a51cef27d04605c3c95ae46b2fdd0a3f771f4597c9cd680f8e01c154e6fee22cf4d2dc72799214aec8185fe69b0eec690067509a6fbfd04a8746cbc185624c18f862a4a090e7afc0607841165c1eb357c7ee229a4d9132880ef0cc0aaeb40b84f635e00ece0713c00a5964f61a850d59f9975ed77c36e60b692a2ee24929068e25033a090d307d59b7c0015a41d26ebfe5235a4e267d7e0801ed1eca15b2faebadab45b216a4126add12790def53cf061cbc2f42469910061410c8e92b79946c87afc1c6f6730dd116f722f29294245af9e2fad545bf0e7cb564325a8fb8ac5d17422af34818391e38be7b54235d5946598093de77449bf94e5fad07c6408da1f990148dd03c12db1c26cb409da5f7ef12b295fcae5e88e17d9f9c919f3e89489f09cd6b1ad3477684546851cc0ccffc0d09843e2ce29fb36ad71f64cd09a8969aa8a6f15e9b64d673ad5c02acd4b9db65781887809472d221f320388b3731dc1b56b1770315826bd6c3d50dd649a8245d7c3cb017e5646a1d86b069c803bcdf6265062bd688c6652a7c33c9a235266bfd9913207897dd9978aa2378b9a5699c34272b55861baa0b226f7bdc9cb3f18cd172214fb4ce03757092c4f0873c0f91706c4f0d42c26033f3c3b3993d4fba04187ec4968bdf68411b3994abe11652d9b95fdace769d723d2617780cf8d4572bbeab08a6834c93b47cafdfcc3ae8f01d0916798f00b2c3be0232c3bc6194abb6a7bdd6458577fe11a2052a421b2b3d0fc0b8770b66a4bedf13df72082c5250829956910b9c7c800414b59b54d11108be8eabf036d082c13b5a477f68c9d94bd186206ea7c828859fe7810b1afc43f25933b87ac35de724bc27240c28d5c7a0d0e9db1b97abfaa3e909cebfd28eccfab71c802caaa5ab479c05254a4b1fc7840a6ab853291e0e4b8392c7f27380bff1b82af37a4d8b5f92d38511491052f16ff8cdc5ab4d64fed08578cbba8392aed693f32263eaa01f61cf78133fdaa6fa8accfb594b58a0613f70a083b745bb978636b99e9a056cbad4447989a0bcc23a42b28cf2219b1a3cd322f980c694848e454f0c29177a18e062611224bc2947942cbb1ebd155c0a2e6ce8a031e9b67b91d5cd62aaf418416ec249210049516f081d666cce16168a07aa76bd40202e97ea62b78efc98c1e72f934efe61ef7aa7fe641c01d03239429b16e58bbcc0f7614af2930b8fe3f804a5bccc69a75800d226b8ddb0401e98cb7eb7fb7cd252d141ef1dabcb6983c01fd4cc838a68495ee41648a090cf5089818a34abf9f661e0478ebc4dbeaa9e1dc202dc796d1466325ede4ab3d5f22dae939e5b3c5959d76b72fc3f1b42d8322921bd633a85a7952b8743d56f2405d13366565a56dbd7d12ef7fcac8d15031b0f5fab79599a2d36e774cee8218fa8a53c1297360233c423a964a266044ce0dde99c90553a327be2b2c4bccbe856ee01b60ef985aaa5107ac70a7a240053a70d4fc920003fe7ced4cfa40f9b452203187a1db504a9990c951486b64606bd19b81d9d16554b00dc1c1f65e0954dcced17177b175b4f1f943ce7a885dc972c3649494c60ccba4011634d376a428ce52b97abe6f74b6d2a30210a9f5a3a7817655c2ee6b7a17c57402be5f9039a87f171cc660ec3bbb5c95f8dde3bd8f6a00d7c76c0fef2a025598aa328b2705fda5db4fafddcd9a309a6190ddb8314b109f02589e5408094db3eab67d72a4221496e5e2bb4e0ffc1058df895c8b6c0db4b9a2a8b28c983ec6916112b2a157b641f0201ea7c22f31384b763badacc996cf14e28a229a82ee7672d4a0a40e49d16ceeeee714233f05cc63dc8e1377435b549f7f9642179aacb6552360f6956a3c0cfb956f59481fca88f0cfea9d9b67ec9fc059caf19fabec353e6c6a6c06cd53413dfa26776b5390317a8c95ed4f2a8536aa6c021f3136044aabfcd88952cc84be2aab372a1a3a8837585897b2d6b0d9e54d8a21216ac8ece39f9403671e1471df52200c8e1917a4b2e60ed3e5fd946878e7bf45234595c8493ead44f147930d4928c7c5f8685e57353fbf2881cf94e99cad3f974593bff0fba40d3563e8a59ed5e4e2cddb10c123c6a5e4d3d724f29294bcc656c475597ae2e02c92a44dc43a9bf19f95383b1c313e0c29a4e9f1a868c48cfc9eaf027d4129bfda386726369473f0840d41689fc817b33d889f011f57b1d459c83e84956eca177889835dcf6cefe8848d6e7bc4e7a4babe2263575b971a61ebc0ee1a2b31de0494ea6d4c5bef29651b054164373f104927c5f582885b295a7b9cfa5747f9fb4eea6ff5b3f85ad4cda421a2f3ac8c2b18c99ff7b7638ca4cb84935507c48fc147ab58b20343c4e613b09534c760fc74c594a0ad4640ce02cf437ebea57e6d90efc035e55e8d6237f4e35f8166d44d84788bea39d9c3b93dfd85037d2571de5803d2ecee2b63c87cdc2540b84c33784735989addbd8c50decd44be33895727e8220029b38e24e7a39cc5ee0db689d1f2734e9fc4b3c403ae578eed6722b4789f1a50b0962741ad28167d175688fa0f7e5a26a52105073932ccd88a76eb038f673ea0e7c820da9f2828a5b9e534eaccd3aeb4d18b3d9e0b3ad3f6faf50ffacd28ff2f3e66d85401b600330068faf639ba4de7d2c22b287fab1fade6e136108a7890328ec8afb930722fd7165b6d27145742d320965d1eb03536d591d9ab661b2e04ce4c20ba0073eaa3066436650d9ff0660ce9f1b22283ba74db3dea7401afd87bdd730ca8cd889a50fa3fd484ef05f0da6de58e0ee4e2e5179113731fef8cedd87f50bcf103efb02eed7e17033315848155eb015ba555c428d571926b740d452866a37e0674c64467265c31235735650b1bac19028bfd1dfd9002fe7af837a36aaeb8ec5209f9d5b4b60225e1724416dc3afb300ee2280513bf9eac0d6b3af210f03d7b90595af445bae671a53ca759cee0762a7b435f1f4f5023f9d2b7e07705ffe883a830ae4792e6c620e56d9a99ec83a7b00abe2cce0a0008d8dd3c68904de11999129e7f7663102d175f3822033ecada6456efefb1f3604e42033f7e35696e4d723831467ad548f61188c312bb79364f007ebbe21981b2b2899b3aaa252eaff1b057186e0ffa09064115caa55c3af887aced50c79d71927ad7ade95d9620a57f5d1c1f68ee7eaef635677b7eea494381c60b29612fd1ef4d3cb650fcada6edb4e9fcea493d8bd99b95fe548865042432c7ed9030fd5ec474f118e45b044dfe3b1a88741d8c183c9180692cbad1145aca9d415d5a3ba69fcb8c7dbd988fb1f8d7dc0c615b894dbeda2595f88cb900bd7c6c434feee77ffbd18d51106fa4bab3f4f2c47eb5e078f324d38169eab390137d4b3b74ca00c4c1c9c1bf24b4d3f60dddb6237923fe459a5cc03b0e9da29ef51fab1134048dad3107c7a6671a43a9db5aff9ad034a006f62b28ae5c383ed44b5411b677d47d54a2efd9d1c40d89f402f398db9e40665384cf949c078ec47254da01169658c900050a3ff115efb77649c5189fe0339e817e77b55603e63c5441d3e5994a6fe464cdd4fcfded76a3f9f1edd05b10a5106d8d7abc802338743c706173fc8f07a08383d2c52d62cd4b48bbbf3a07ecd03c6b7aafd2337658d7a7032f3773714c2b19b3dd46f6c321ea75680cd621864018467f58f3c0505cb23f910704d15f75d7d1d2ba80cea52c0f01655551ab44e730980c5f8c93942d0efcc485d9cd4c7227b261c387b43dd0f1a75b64cfdd8f8ceedb15b60eef11db013c78f55d64139c20d8cd661955635cdee6b00108cff854e9c00d2faa94fcd350cddade0191c15c0973d4606c8638f02f3d9856d23a212754f772bf6761172f28d31eaba50c8541d4e84157f7e65edb75b3c67f8a36bcfe77da46dbb60bf01f28e3656008cf12bd60732fc82834f7b769bc92436d9775b3d2ebad16e24f67a31bc243ec8249c79a1c9128f54e425e72058812af30a0ec274b0a18f8678705e89e67c192665abacf5c35d714eed49a637fb8ba5412f8cefb81e80ccc7dcb61ecceb226486d44636ad57a37f4163df63d72ffcfed02c979eeb13c258df386c59c9282fe7429d06c257cf18d534fd56aa55ffcb069dc1440a374a5d6015a6c540d3521e974129e84d7e7ea0e3ea0ad9ae579b3a7ec7f0972ef94a524609e175ba0b93cfdf78c27043ff677310e35b8d797d7a711ae9076f18141883b046d3cdb313782ea73b03ba2b3acd7f5ee0016b29cefea26298fc21020cd272ad224c1e33c7f7aee59ad1b18e614e1ba158c8f58dc792adf5a52cb468047eaabbb6aba8584bb03ee2c7e9bbb2377dffcde4d38d569d40e954a1755784bfba3243d0c73252dda0592ebb1b25b1fe5e406cf36b5361c99b7736f8fb9672a29c24c2f3a806f93f5dc47070438c1b43b8136e4e1aaffb9de259ce14dedd053cb924aca57e99bf8763a424ea10d34053cf94ca32d3ad5bc0d7197916538ed35b2551c93beceb80116fdaa3b5e364b073d607aa2127bc356c0bcaa27fd431fc62b5dc66f0b7cb8abc25b0058eda712a4a9c1a30a28eb4de36fe1de8b1784381b1bc80401721faaa4a9d2001ea303c17379e0ba89580d22aa90490a4fd85b824b45ef5c77be72e81b98871054433cce613a593a6c28cdd5339ac7e4755695de4190ab3f4ebe4426d15adecc2cc82b2d9219e32eca0084be16e139332f32faeab6eb25fdf16e227824fe89988834fc1384df19b967da83c705454c53b29703c7e8a405f76512aef939c2347728f7c4b61030b9ec9df6c8f946dd8d772a722778eb232545d1691970bd44819e65a77380333e04673ad7f848f623cec87a070337a1e70bb8bb21d094b68335bdc62843f938722f5e045a4c86dfd4638290746e4737aece6b7fa6e6dbff3a238f83137fd7b3dcd66a09e387dc6095f089d29b985d2cfc3142703931848f6bc4d50fea935175b775b27bd76559cfb500ac12d9bb0df22647b123a81d4423aea70cb5554ac14cd1f0733cf7e9b39510d6d6ea5af29b1296b63c6fd874f34cf599b1386dd11e240332a060a429297b5db4dab3050c22d4641e311792e038f2d6a70462e5bb8b99c974926dac6a1396c4576d3e2b8069bb066d9cd645384dd984512dc513f910a4ce8be83e571b753e5e51030f3620f6dc0ea7385ea0c15db0c65567e65771bc73d4c449ea6ed690bef38cdc286e176c93a47a848ecf1a2a34413cde23c21c72fe373d53fdb3e031b3fec76af5eb4b944c3b2aaec83cbf693c000c59aeb31a9f96532942bb562bdfd91c02192199b0e8fdddb4eeff91df29e02ab24752df7af995b919bcab36e0fa8c9060954a28b9fc10ea44c6bf036efc61ac848b871d69836cbc58a67569ef41949d9e2dfa03001214fa0c4a54733f6973efb8fe23af1fb3266ca14e7d8b6a4216590790ae04907ad89318c052708fe9127336cfe225e5e78b51beae9e940108d5452bb105fe2cbe59531bc25ecfae8235e0e34a5ccc943e6a1e23408ed0c3c037ad4e82c511cae20f47c9d3398d54a47b0163793693019c4d4944c464e55a605006278a8e150eba85e8ab45a5c7aa258950b3de894327008d1bbb087132e7349b8ecf33f38a9f24c31a6bd8c7dc27772c07f19338701bf003771065f6eeeb32a8f57a789f859e3508d12b80a31584b4bf8ae3f8757398a1d1dd8e1610e1fdbe2981591b1f8f9d74edb22cd7e1bb3fc814d9bffd81df08efaa8274d11046fd83a526f46ec63be2d4a8a126ea1d162e422447146a5be38c88572897ba018c9d2eb84b4f43d6154b52d92b9102bd425c9a5657e2ca424c12b1e40413f8b883d8a9db83b0d45514b7680c74b53db7c19e1dddde71a87b5cfd52c9249fd56362bbbd5e9cbe5c2327a22d337f671179c6f049209cdf225e1fb2d2338fab52e167896236df119e5fd0cfba1f1fddd131639b13896f561312bc9e6b054c1596cc4677a1c3850398e1ea229e419ec0506d6688005aac4ba2fc618d6f971ef96e93755bf7fe8b6e3e5cc4ab4e07fdc9decab304253444da2fd86f6db25974cadc8b031e4f7c0ae544a9bce464b43711ce4db30fe1e8a4bbc9037d9690eb5e42cf175813582c51b3da78fdf191a8c19a270607f74e577a60aad9d19ea21ee82e976314b7dd2773db9caf47ec2b1d5e4b90ac53d3fb7f51876b9b0060ce5348ebf1f0754681c7ff09a8702b5ca2064574a0197ed1c9337e368327600112ade619b3d81451d08e908094e400b054779f3705af90ff69b5f401d386d64709113fb8c66dc25da35c1c227644a19fd130ceae66a2bcef2a4a4bca1384d968bab02d907d8651e48fc4b2eadad38cc283f10d16db0019c6aa356f31a04af8b9aac3189df266d4d4b9aa119032a924ba82f4364acbf8bfd1f1b993186a314557a5991fb587f5a1029c22a2e58337394794216e9fa99b0952b3253caace2936cc1a5928e2626572884d1dced96c2164a692c5e767c1a0870cc8c2894ad67dcc53774cacd1f4504704ac36fc91effd5c5a361130af0ebe4bf14b27dca2e0a092e805fe08b83837c9ac528ef0e06aedeb0c2c8d2156ef7b6b0d6322bf251ccb7f95783486df3336077a8169182c93872c6ca8af1f5f135b70cd38137bd2896b1630595ddf9d2fe9bd01e056b5f160609f097b65f13e9ff068705782ed3d75da18836c856e1229bb7431b30bf552afd562a7ee0ff65cc68df00583ae52673209875f47ee52970b141b78e20d5870afe4cef16804c98e094832ae04390265e8d144102b57840fcea89360f196527060d4af95f075a2b9cd702f1bfef0ea96a3019cfe86a91cedf70b67a116bf54c7fff980fe22b6318e835f52894f5d8c112f79796ac155ee74b5b9374dd84ec8055b4a8020535e05d67c59a1f8d18c2a2ca0da9d8ff2b3ce5341601de9b4b150f62c49704969fd6fa714d959c4129703f7753b2b33c9b05019dae045391ea21d654787ec121093080a564dc7ac68b8af590268577b72410cde0524ede8dea39f59bd33f442ab21f3836111100313c5fde33b6d9ec3f3e84da360145cba15aabce6222a9915cdb47df44ff3cedee37eb939978a7ca36071ae8fa09ad36cf396017cd7dc4857582fb513c4875f17b5b60ac38dc3c7593afeac2402e75fb8afdd7c1bf97abe4bba1804420438cfca07ad27b6a831ed85e934840995d5a521ddba9de9634ee6f5a03811a1652fe97c8f5c6554089b54e39f224862233f82031fe1c7ac424df9f0717fca89eeacbfd17b43e72b1bbe89006b031612bd86149a7a82e03f49e18bf3229618ff4fd878287fef88958ed6412a8c82ee3ce3c43b4d28dedb6177213c167b085b8f69a8fd65670decd16438b3255c9c26d74506d5693bd52d4ed6444b60620a89d8a689523cd996808d738bb1f578a62a910f47343ae519accfdeaf55387bfc0d320cb8a72490dadb5ba318fc19b422b2ed174a2a6b557ba31d9dcb664a6805d54246eb4e1fce8192917ff40bb11a257965dbb1be78bc1f3da869f92e0415efcde84f2d4244450c7b324ada6a4b1db018d74c9cd3a6217860b3f99a5d7668fc2ac950a8d46ff8da4eed8c95a043e2d16eb532c819833008854e9967c96f968a97d9a25688256de44097b22923689bbbe1b50841176dc9066cf812d1750e9cfc35a9c55d3dbadaf48f708c793bf75c78bf96917654c5811e374e84b4da2c3134f7d0ed0c1ca283c03f7063a74f0e6c337d9f3bd5a60eb5ea836cb58b8301c5b63365e2c3824c2b407145ca028c33126e9c627f113e4ec599773a233bbe786c3caec3abcf106b463096f0d7412774e299d68808885589dd8d2b2b0a067a3b5d8b4af88730ce1fe4db17f08cd181f6855884f0154b1d70e0e649370c899a553bece31215216d83a942f8a207d63757134f943e422c5ea1d22db0f1862c2c50e118711c29ea1117d9e7780634ee6d73707abd1213798504a49fc652808a8bbdfa0c009eba503f11ff833261cbeeb9a66860cf61e7e2c47019ae9e848584631fa1133713c761ef38deff85dbf96b4599fbc00e283ed2b9c962b74898fad16d61f32294b1690235bc513eae31d2802371bbc8d22414ce663369afa4cced7dd7de3399a88f04cf1715bae2482068df2a98112fed1c1ffc8af26b42fa1ff338d3c2b02e1024587ae6d2a1baebe0d59cb6e2d217f6cda72232a270ddb69f2c577c7baaedef2dc7d6b32bf9627579edf391ee4ab0db7a745d4c4c4ae3d1493968fdc4a11262fdf32ac79b725621ed2903c670878a30cbafc3f69cfe7d0cd308a9eb3ea6ff696a76621f2c0b89f722ad1a58f8461e48b63cee717295e71b5efd62e43f4648a4c76c639f685891ec632dc180f15f391f5828831f55032f0f0b8036512f6c86c8a8ffa10ff9934b8ee408abe4e12183596191431adccbf888e4178da9832693d1d27a6a395c53d40283e91cc6c2ffbeaa2bf05524bb433b5f96c0c7e8ed5375bb04e2c01faa860e0fb2c9cc8bc897570b278e65bde741e94cb3b025cbb685fc7936ae49ce36df63e92b752270985eeb5cad11fce27ef2dcc164c95be3dcdb418b4ef43b91eeed7ac734adce9af4453617c728a472b17ee680f26a02b2ee3b7d29c585dd6b326e1d174ab7991e4f32023ef324dc84c69d9a0306d68a1d8b0b065554b27b8c0897ea61a0ad94b53d77754073618cf71f1ef42761caa8658136818354c34d8726bb8f63613ddbdb014f9df654733d1d06bced98b2b400546d2984f88d90c0506c8066a8fff5825393f8eb8383ffa23ed77ee4b98e735709ee9e4617fb0a9f490bcfbdf367de0fb935419688158a4296c3c6f49b847d8f69c508ba4f9dc8bdc6ebb64209c66c90d9ab3c13b9a37e90fe162337507e82d6cb6c1f0c35c88a3fbcb2929d1710be0a125de7b06235b42909f497f6b7f22a68d9a85cf47652ef869591f90c4b0a4a94e75637346d8fd34bfa0dcfce6d5a5cfe0591eeb57b205ce8f88e1682227731b44c22fcbb1757ce05fb4809a84836acee33682870779a778fd7ee7f82d7a61027dab9cc1592ec01c1b25a85533936d8c51671c4dbf2298670ba9c84a2cf6774ff4035fefec46b072f4e86113b01ab47754fce0b7028a81bdeddc59c4b21a0e066ad6c1478c6a0b2c37ffa2cbfd9d93b4c06e0c693bec69b34844e72a43c9582199e1f2235a4f96824e56ffe76fbc3e46605ef8eda8cbbf3f28f7e22b714fff5d8baa4a0616f94d5624adde6059b4ad201725680f7752c80106dd4be6e3a398cb2912c9b395708d310f49881653da84d68ece9407dc9a583efacd69811a7c6be4708c6db693986845e8b9799beb9eb275f8970cae3744fdaf7c4e9eef2afc8e5d3cecadfd1b008ad40cfab0093655cbdc6dd237b88adb04f68ab68e0a4d60fb279508fac3511618efc574ffde46ca576ad5c514584c3f3809de9946d1d9b601d175c09348cc4df2c209b73e9c6483181f4b3617f29eb5745747b0212f54e32cd594d012686de7ab6c303e30f99bb4e241425559b1743d62a280baf8566f61d040926f3fd9f92efb04caa2611e10cc70e806a48d049f9ac93879397e4900b9c571200e0b3e7eae563c544e0e079917049c71e0006347327c466f577b6e31202360636b40ccc7323e09a15e581ff099fd48f1f2440d78f01586883d088d2b8760d2ade9bf4ca59e9d0bd646d9d04c983cee62059d22be2a6348917c5133efaaddc736a1086951b809ac37f91dcf34d30f4695f2a8d7d48dbb6f91f0c1464af2882bb064014fdadff9466e7f4fdc3a2fa7b18abd7b2d6eee8f716f33f2da0a0d8b46472510a49d46bd6f6f1be0fdd11818551a9b7ed480acdc4e86b73c76361843654bc52e65f454dfffc2d152a1075514fe3b9d20fd59df55101c56b65e8d0a41849989b6e05b3d65bfef6a5903f47b2f09b7d5325d381ed0ef9661fb3186cdcca29ef6eb4d33a20efd83be3bb0f203666e0c8103a135e4ae4489e2943104f1598f7b395dfb172e20b887222896651ca52a1955d5df7da6abd87f441fa6cb290db1c03c280d3d30a761b0b79d3cffc27f68b78d556b4a759219b9017ac13bdf0ccfddda5fcd62f00ed0bf5ec4b9704c5167b3608a0ae11e6240b01bdb5c90f246705f89dbd82dbe44c531b10234611827e96d2fe266be88597d9ee21d5dc8ae91c20e2fe10e1b7abaf0de259d632a6e05196c273b6de7df78649288c734bf3b77c6b51405c39c0616b4688ca43426ac7a1134c32289997f539bfdd7afd58c2ea5e37ba12d270ea6a970d8166cdd23ff7683487aab840567f3a5c01e1f86f2ee9edd161f0be937885d405713335b5d640e8c6ce7142b97da325b619e0d60a7d30acbc90f8c43b8c48980428367d363978154032f731d7cb8d820782f10da9d7aa215ee7335e0e8ee72d8644c09d48e544b21cb929b70cc7ee019a5bed659084fd74d6839a9bd3c934ef4853e829003e41b89a81653eccdcfaa3aa6c78f2e9b0f410883bead4463695aa4c554b694c717f9b31b15f60190aa277e33c8c64455f553be9d0adfc0550ef7fc9d62c5df54b6ba5ab0b34af5c53176cf0c488b79a0066135c39b0654840c43488d7790073d7a57dd61f08eeaa26463e444e7380ab5325df2a69418e6c6a36aac26a54aaff53894598f8c25f4dedf038945a0ba6c9ef850cc9b98ea48261770204392c0f502212114781c7ef7a37bdaa43deb5affd6f2e0d89373f9e294709ca4ca82eb34cfa5055065300db7bf9f44c5c541c5e0ab93060c9ca0a4dd904c1ddbd819039d5dd9c3d59d67793db467fd07ac68bd5470fd6b01ee281b7410c1485a65d9e9a262bcd1cd791b6c971003ce8b476a9ae435b07b2277ae979724f84c813d5f003e748c49a24dc9ee4d12ff34ca5505411f7e2390cedbe59f9015d6c49478cd860d2a2375308b233de492438555b33808a4e2232b25ba3e505d81fcc244870ce5df3db1746a5281f67b662d305edd981b08ae3555c12cf0084eb2eb223f12f77b11b28a9052e7f4f63c4641fdc5e340dce1c2e27d3460e93e8d9be328c744b4fd97255d058d63a7a3baca305cbf4b65a0a6c89602bcf5f7dde20dd37e2230f01e2e35605fe931dfb5ac4eae6dd77f56971b74c44c8da7a65a8b777fecb2ca092f7bbb5a2f0754438e9055d29172ec97241d6d992fa71f20c3cf2a16bc3b68872661310ad86db976954fc959ac3da87369bca65ad601ed898bd4675bc695dd5a2fb3d58510bfdcfc6b2d67d23e90f525e85d6d17045364b68b65223bcb0863a4333ddbe3152502d5bfa6e5145b370088c9003b31123b2d0ce6685b63d77513ab7ee1d221339108e2372589467e285ca4d47792a62165ada955c3f0e9489929da7f956e7201195362eb3b51960eac5f44b06c914cae1fd11a4699cd35e3c563a632e617372a4c681b42df6c2801c55e6e029dec9905924e5dd37e568a129a95a50a9c9af8353559799c8e0926585e65f7ba70badcf15abaa1b1f7a166aa5780baa2c36a05d3cb4679433fee84f3a04ddd56e5abc73d14ff3483cbb0d69f031a2e842f683af6f15abe366e70467befb838b97510784526bed381db3af5da8340307ffa46a9ddea4a287a1eb38281dc9346e57ce4cc79a5149e8343bd704794cc9a7306a8a605b8f2025c1d766de3215c8d065d6709e2e987c180de2adebe567c9709ad255fb5ff65f3e738a38458331c2ea9bd5efacf883b81039db034ce57f857d1a22a4b890c3b2a634bdcff25a312a975c2b062c6e2234c4904082bd06361aae10e08836af418fef112ca35b1a50bae66dc23efb9e2c3ebd50d0039f24347b8806dfa2c6e2a8eb1f48d9f68b030a1f870a929803c0418a9a6488cdf361f26918e7b5f9b895f3f455232ca22a865a522ba6870a2650ee4653733f0d54cb36de80af6b3bf8f1fa79d782781c1aac55e1b5ffa5cc9c0174a43bcb4364684b50835828b222aa0f5e02c9d3642b7d2f493a504d857899110cc4b124e51bcd124d33b47cb7a1fa77af4293d4816a7dfabdfbc32b39946bac0e105f0eedee7a5dd33238424a148cac22b9d0a8c4e889fca8a461a265d7ddfdcb4f26d1dc920b2afc103ba1920de31cfa4dda3033de506a9099df369d2bf2a41d892e2251f65ffbdfb877e09ee839090295e3f511c01ae5330c645155175deb69967b6ce976a6f62ceeebb6d336acf91289a30e99683b0bc89a5af844543c2522dc0c77e2ca68a2637f31ef29a3a8e3b6df7092d7141c7c5772a8a75e3301c04ae3d1fd95d13d588821c40c8aa69d5d85abddfdb3ddc02bba46baa636288876b8a0a327fca9a5ff46a6fae1443f63ff376e529d3bfc2829f907234112e8ebd26db4c02b92e4c757f65624ca7cfb2fce69e101675f9895063d42a243e6f9c24af814daa8e12ea241f3c8bcc85d94d4a2e6b4f0ec3019e7e0287750e0d40b0775f29f55bf808a733fb798527d66029492e060f8206dda9cb3fca852952366e47fc22c2e91fb15518546bf307344e28ec64be735bc7f5ba48ef86493b2c732c2f750b5907e5a51f569da41b1dd19178ef3531892fbcd07cb7f87bc8281524ec16b5097c96f719274560b90b25bd041838890cfe4cc8a45db5360ce71f2bcb1d19ec6483f7aa2f2d63e7bbf8e9bf4f00a1dacb95850aecdac00bb0a6928d61ee97d2770193b98a016a1e6110b5cc77db291e4ec253cd72a1f34ee24555f3b8fd44d767ceca5d1b508ea1bb245aa2c409e52f4fa0f57ee049d8a7b1cf1415bd9c2d9fe0a6b224ea715dd5fb6b878d050a83b62b40496c5fda11e81d7079f0692ad898b770d33947397dc2b2c7081d87cc5a186f3bf307d7ad84e469e3c00133da47fe3b505184b4e078d9c69400c48ee048e43b5713070d86ba441133a9427485f6507c42f69a55da8bfe548b03b09dccfe37f1bf5a0133a53a66b5fea208befc22c6c16d0a4c615ad9e1abb0a4b4b7e43b391eea01ca8475ccd02077763be38c6fc0a2ce07419062dc933b2e10d1938ea7a47b1bfdd6c1e3136d70634fd5bb967ba00c087ebba8afdf44199afa8c3d3d22b5fd98e388d8fe50e319a8e4ba26e6061f9113ca83f4ba1fbc639047e334e6179f6ea4964e3bb45115200c6d6cbc49f8df798b54153ca6659b07816ccc9776bb56c1f8b115969fb1ba60827c15508845a31b5a7d221d3dcdbe0c2c580e3b0a10068cd1ff5c21550a657e5fd325161266d61bf5ced6a601b2c8945453f82d123228cee2fb29ee7f8c92c39468dbeeaee17677fb95e5b78be4791f39629714b7fc4078efe1900de09ca7236240a6c94bdf045cf6ae39be2a8ce1a2620107b8e82f5905dba36ad44e60257e1b41732dddb212d52432d5e524e989195b95cc199f101f6d33a48f09dee0a6988e1515243ac0177f6cd003e75d05a6bf6a8a6f790df7d8a6283127fb5f9b7246618225ebb90789c2c77be751f3f1ef03928f85314eb3c884094db2479070939978975f7f82df20eb9215e7812c942a79291b5202bb0ca3f95f6bc6802e1c761b9253419b886d156f5df70ea135c909a26f9b7949c54470fc1bfc75a318848f7513caed88ff4dbbefdcd2e6ef182a0af7bcfb4833129e4b67d68771b69db9e6073a7e8efbab2f7374130b9e1c7edfdef1841dddee7c55ccaee7957ef514f7141dce6061812c62ce4e1a4dcccd3d49ee07263ed99a25026e0272ac2ba94fdc2c041207a20dc279c54c0b1cc403be2d7572f10008bf14e482ac6aad891e9e2dc6d2720738d0ef1b80fb3f7e353d0a30b60e27c6a8ecf974dba8046de38f9888c078468520d81fd3307c72682a53120fa09456446452bccf6a7c33596023b70061bda0d14da3ac5d285fbd6a49a7696bf97a4823c1703be36c3fc9cef19eb2b0243165915e8456ccb4b0f28df66197c57ebaafe51944197b6dbed2bf1a37d5af5f10e24a0e55bf38a8d27b077a046e7c258fde4e1462a52d0792ee83c3342cf4a900bcc5e7d9336ef2ded3fa36c09ac3b5977a249d5579125f903a858871c39d64a5c2aa0d3253ca0b6bc72ef0364d30c23e70d48665a4b74591b7b9104f10c79b075591299348cc8d65c02f697254d64a5ea80f3da90805c1f3feaa157aa1662113a0265788e4974dc0f0edeaf433f1bbc5fe6e1721e97e06502e5d6ea56f389b3c9253238495d387f50279cb55f5c181ce9802acbdee96ea5852d0a6e7cf580faf75258a50dbe2d232222dc9452968eba1e37ad14134356508391da5767570903fc88fb83e1af6b526aae28ef5aa76a6f15d18fb92e88b8965cec15f2019dcae634c23876348f6403eef73e31594b2b99ce2bde3bf2b6d922fec1e272b8e88fa380d1674a0ed0fbd93fc6638898ca543e36074470e6e9931da7fb900f40604b08be55240193fed4b5d0c4eaaceb601bd1399cd020f736c2520e82955fe149084b63181635edeffc4ed6f2c449f6c97aa2854257a06599146fdb5b886f0540e74518ab49771ef8d0f56d126a5382d85b9736b4fc5802bb544b24d6ef907bc78c437beb316144e43fcb6ea59e3557008f44dead57acc2825f2dbf15a60459fc24129b9c98c80c841c6cc96aa72ae5855767222baedc5c94c95a56a609f64dd09b6c003a82df11dae8f026c76ff1605005a0e7b35a3ddaa31702e7ff29302c35107d975198323a63e1eed81f20d8b1d7fee4a175ce9f7d39a08a64a2188a7612879f06e07f164da39ac94a6218ae41fe6de91716d768658899bc69c9f545a313980cc671640173dde3a77566715e4e7a88c12d8ecbe9309176a2fac64b5f319b8cc154e954adf987bd9ec0a02533904ebdb7584def7da0b11afb49aa48a9386eb84cbfedd792ba2fa55e233ee5fedf9b304e064bac79d960007e18fc1d50e4241dd01b53ee7f11c5568bfbd0de242a33935af66b962499bfcc174433c4487d5cc85a345c2372fd1b61ebe7bafba37923275145eeb755090cac2424a9004459c890730503cc790f47cfdc68b05762a753ea7dfb66fcc606e89b6cf3290140c9a802ea5d46d82e27d7b8138b5af4f32d45949f1749a2ed05ed06c2673cfe85212b35ba0464073a118487c76a1cdcb9437903c6bcbdc04d8770a1cdfa0c0d9d8f629231216cc997d2f9724015460399d5104929332bffabc9435663d928036071f255a04b42f68cf679aeb6c5ee3de908ca26c871cca6b01a0d0bf107198b01fec03f8cf20cb2635a7c5aa7a24c3cbadc5bec2866d030aaf8e5a5dbcb11617023ef1e599919ff4a999c1fe283cf70b72f4b47657b0bd3b62a27494e54695c313d5c4e789cc64cf100846bcd915daf6fb1484300e744c050e3060415c2faee22583e83b864ececee008c501ef3a7d8042941b2d73f177f6a2e880886c4ae75b127dcfb6f9509895a0e91cdc709b3d1ca3c6030675b737a4e34a8001d7a7ddce3bf18efb3c0faea049ab08b45d9fd6157f198b7b41bf6cdee1bf45bcbf5a90f10881ac6043c6070532e405f2652dfee2633889c6dd7c64a1eb2a429e5e30df644a9d64a03e8c51c35fd35f1afffa523b6100cbe8b2f77cc92071efba78010a55a167bbac9bbb6c18c774b198ec1c8319d94b9bd0d5ae2057c284e8ee37be0dd99bf1cf63899145b9ff7854535c32e5504bce1907a3a735f005b39272b7fb044b6826fcf5fb30d8081b820232b08d5db99c54646af5c130420526653dc5350908984a9c82c6fb4107c0bd1e092ec436e78d5829c40ee97a7cc8adf8eb8d48db5282c6f008d7c03b5940bdb300efa823088fb5c6861b019e0b645598b953d4060e88411a0dddf5aa5fec5b2a59f4e060df10ae2f51c201858e9c31f9b78762355dcdcb616f4581acad1937661bded780c98c990264bd3d7863ffad75396748b48d46da8e8fff090e2a6acd26c64a1cff74319e9289a2b380b76e71eeb8991a9447061f70ba8f1d80564ce074419cc8267b2df46d92b64f06d014a32c29cb32d86a54c35bbc9b8447eee8aa16653d4d66bd22224733daa2c8e0eae3982f311c812f2f72050a2a809c583f4a5330f82d655c8e707dbbe0717f6408c159ee977a47828ca2531724530b6b12ee8daf7cc3b1036e09e8c802b8e8c15485eb178b2c24d9fa12886db882cd2b549581980bb74a243b9de32d65c29a791851bf1d291a26305be71974ffcfca81301eba7adac4974296a9d7a4aad5031b8f226bd068d58c8798b9ff0c495a248accb5126005ed7ecfe8de74dbd9bcdb8a4dc6cb911ffcc910f2c6dd055c0469e0c91d498b4dfab17ea4581c5ef5a991766da6a03c74226f73016b6cd167abfa6287d1593407b961816dffb2eaab40244d02f52d926015cd93bda937cf9240703690e90efe1d66616da349790433382348a9d932cb070b8aa51aa413643687bcbee633180f6447a75947043e6b72fd629ac23235e5d877f86808af2aa42d2fe6c221ea5d2204a6ec099d22ae4bc0c695cf9b34d2fb97b01dabb54179f2e3140980071ef1e68e88d788e1b5ad15cc960693497afd5de3bea29ef910bcc76cf74870de5757e242565d1215d65a76234e2b323d8b02c67be79d6a660002eaf23a4d96f6a292527ddf31242aca3049a1d098e154b31086cede909aea900cacfc01238262054395476d1464e79d87245d079022506122ab12cccb164e744e93e92d7f576718a21ab6a54130a2c0322dd541811b3b75f0bad3f65b52074706914cd71796613d00c6cd980d26c00fa816397eacc328985749491a8e9800fb336ff3adb543594b6a965ac2e24f998d5a029e56d5a8d8326ec0a770d0f8887d7bcbabe7191c6558559c36b12c89be245b65738b06bb53c3fb79df5c8d33be2c457187d071907247c800bc0ae712c22bb52a3a975e70b7359192106f185fcd2112896b9828f5d12360bd4ecd0a7546c45018eb28ab281c57d155330c4e1c578afceaf82ef16a29178477e0f59af773b1917a03f49d0871fd9b7d362e8e1986b0bd52a8cb08ae2b1949cd7f3db5542970bffa80ff3e9743fbce5e7a94eb760bae3002b1156552b4290c3e8375207fb102dc69cea69c94126d1663e83a5eb8ed4246e06ba9c48794196449802024f6fb05b9d6a6ba4a56caa66cfc53c177f27e4b744110eedf4b00a2f231a38ab281588860d381cc04d1863ef8cc94784e01f15b846b30076950f482f91f86c32273807c32b6f69e784d87704359cb8aec205ed7ce10a682145a7e2966301c1de3eaaa5f06d4c49d8048d182d03ea6b22ac39db037d79db17d0a7f0a5694c9598d3873b3f0076e71597a6a13da2fa2362d282d6d7eb30e05aa654cce1cccab643e1899e3cf268a89cbf4d1a0b362905cff62b93c42982a1a2a2a3b2b570d226ccfed836317e96e70e93b7c28e03c4cd4e032a6783d65655a1a8487edb35987c60a56f3d6564e1e2820f4f8bc3077f250847fb512987591af3f4859f12404cfc770aec4db4e1ff53c4cd7c4912f0553539b9dcdaa0a51e12fc84c714e66455d77507626aabcd2cbc49e49fc817895282dc4e8186b15e436ff3ada3a26853a78a7cbf2a4e33aeed44383d5b5f984ae8abdca2fe942f3f8961735b2fc3bfed862cf1d2e4f227498309a02f12b19617770e34e12ba92c9cacb81107644b493353d25618440ea7add7855ef96d58c2e4c1c6a5fcf9d40dc479e32457901dc9870dd805a5ce7656336eca3b15e40dd9daa85b691960882e8fd2d160ea899a62ffb4d64cc32a5e667a77e91ee71578b6463590c3b8577c0db2f89d4f451f8c1e16a292ce0021801c6cd3080cca65262205df83776306342be6f3d60e34e0f1051035a1198a9c72bbfbcc7ca6d2bd767c4ae0b12388f6e684d399219f0419c74f9b6b80e75bb6589049cd788cb67ee46109961f3b603f22640228cf25ceedbe777b8f8234ee23119d81d5f35a710413072a16c4e690b64f13a736d6ba784823f9846275caf173f1ef33eed6c98648dfcf85d00e5d519fb6b6f1fe49745e889e039b5392b1c6e73f17fe8aa87d74cf02ee6c5dee168115251d5ea5b58015a3696fefa2a4f1a38bbdd29f655e960c5a72e467d34cc76d8ef6e4ec85c80146ec7a97bb6a9b8393b2df6feb7e6f64f8ab4e7867f9cf14f77fbe38d60e4eb2defbf3d5384c42955993127173ff481a7c6b826599d91292089b8414b54ee2546ac2c728cd2f96e57cdaa04e0134a51e723097976a7050c42791329a03bbd68292fa4a50891784dc27d686cd1674bcb060c8ee48a71f44d11bc52b81deb2708ca25f7ac5a778640f4836a382084f5100f25cfa2cff3917e9dc592350ec9027b6218328b6a4aba9189bfc10c5279be7d416dc916a392e709a7625f5a158093646f664fbf614c5152d995c037bd4f567731c7617b67841b6e2a793fea41b0f87d769201b59dd91b68c34c3a100802dc94f6e25ea64a7d84a1784da1260487e55e7eb6a6b7c478c9c0e7302b9db09dd6878a1a9adab92ab5fecaf5115129863ea71c29f965439deaf13465b3fac3ce1eda9c26858c0b6eea1d8af8549652ef02fd1b716976686b7268143fecb31181121bbe1118d7222a897d0389e010f1445560e7be56b6ab00e029ecf8e4d3ea9213015013f25afb881e275ce1f2821333564b9327114b2ef4823c07a00a9cdc8ca61c392d67ac32f8f4336f3bdc49231b43d2236d01a944251f1d4bc8f704ba39fdf75d983b272f2fcb6b8cfae971da42cd61f21f213c2a21c7664368719a239938de73a044c1d66ef7684923ea20012135e367af106dea3daa841e5c24751fe174af800da8bae518610dfb36e768437f41195003badc87aca973f2843ca12e1d1c992df0a59af8e7233841b4809465c508c3d951d55e7676463a7507e5903644f56c4e464be6ba3e7163388e1e3cc36b867b9f5c7ffb4160788944969d6124d2abdc068e8a1fc70a3143ca77e61bf30f422d18980762bf88d6591ebbbcbaa89584e4c4732cf46be77229b4461696384bb49c21c20a43ddaff184f370fe4e0f6641d9d0a3d8c3ca762004404fb3fd9c69a3375d93c1245838c16a1c0cfdec466df803b31e1b9043888036b6c27009d30ede4349e83d239ce1e1ea3c6d0b716d0eaf339be901bd21913c8cae0a436b91f83c7769c2144ddd8481fd475667c4b2f7ae161e3ff60d788ef1adf9f9bad25a5d235520dbc3e8e19e9d13f20c72e625b2ce7d2156cda7f470c1621b2aa15538235489af51c2f6244a06e1e557055be80ed04f75ab78c3dbef8adf4bb136c9ae90b105eaa365e279b5f9f013c1e7f8b0791a67cef1a10b1a25cc4668b28e3838e61c703f47e13ec19ac38233eb246ec5dfbf0ac52b771da044b6afdcc0f0df17be4d2e7660d8804444421b8ea095ae2a6850990a70ed3a197f9fe79fa39014d9e06e26e2dee00ec26bcde834a8605ba05907eb427058fdaced66a0264be701ae19bcde0998abca5e7d9877335d50859b2decb3861b0236bd40daa7c575d3dd24ff5b728f64c1dd4934d98f34208c71fee1bac1e1eaaf6cf082bfef81bc7bf2724973d86a3004631064cad9a6d0c6e46a7daecc2bd56ed0bdc5725506a0dc26e899b15d495a67d8ab6ff139ae222ddde3a740274085442db719f8bcebf0437136cf14bb1c46935fc4249abac308d87f108ad10054b431e4c6338c48d0bbec7090b47a0cf987a21ddaff1e5dc3709cfeb0eb2681ccd565161b2edf5632c67c9294376cc9d16960648ad7c595255f8e6f5bb971ba33634929fc79b652333613f976bcb60cd648ce74f40c751c6eef7486fe56590ffa07b5c19b732a62f315e697c346a579e36ac0e3436e4e77a54bc965346c0ba4ab3215c4682a4512aa69144f1571589f4bb192aea7537bd60f0e24d8090c198f667bdc253079edd346940ae024bed0b8aea1d664edc36209ea8be7ebdb5f7be107b26c20cd41df6dbbae67f1fef152ad9206312e4cd7c912a8a363e13e47fbbc3851aabe3f7c39e7eb17a9b3d34ce844c72cc989c0ddabe2aba4cd1615b58ef2392519d44662e78965c7dc72273fd0137f9039c0c7412bf0dd7f27027b6a5f389e95cdac7b05020bff795b3029aef1c3ce85d1efa114fdb31667204526ef95bc30f91aff44ce52e121278c9515ad20888966e20e417927940c54d65d8b76a8ecc15b69971d89fccf229ced6a934250df1c89137b53a8bf852a13330c74ac77f98e0f7e3d9936fe56235d190fe30ab2a04793a6da797875b0d7f90b63c752c96319295ceebc41c384cc166615cb0d1195cafc9d2404716e7c75ec8b3f4d0b1736731d4b92396e51015a96970f3c482ba53faeac64456a5deb4ffabc4338d347a2b477505a830a1d125be4a20506219eb103280ada928c797c70d463cc736c884c062d6278d24f6f00c68c8e3082a96b7638dea8b1de0242cfa9c24b02060aeab0a8d664166bcf5cee5b893f4c2943f9c78eadb07b497e09f53425ee15e85aaf639cf1e78af0d202118c3943c757a4f81cf04c2a415a6e9f572523ce6584ac6abddaf7bea3ebe59839a9a6efb4441878bab141e3fef2708c59e77640dd6b48cccc4784899a2dece32a356a52131b0eff61a1de3cee12d8f619c51ff69c45eb88cdd6bc3041274e2af52109e79486b6e3674dc4466a8ae2e17f0e1fd12c174d3c7c005f640008e879a0c37596854012e5151709146f31b60a79f628779d5ef788a4e5aff83de4f506739934b2d067583887ba1ca3406c7ef41335952a312d4a1ba1504d1ee8d26f029d216123a29e9391490efd6fae237dee329a45cf1e3c36e6c508976422631435fffebea9798e69f270dbef3f3821b1950613b7e7b3a1d2f593320665bb532721f3665d73a882e2c33d5eef9d82dd41a9ad5e15d19335487bcb9c437445344fb78cc9d230f6017f6c315f4e2cd73e38862f79ff35bda70f4f28cf6ed114ccd2dc8151d8e4f129d3d056d3f2b9dd038f11e9ac2556247183a9eccf1018fa911ac3b77ffeb025a9cc4e1b5aa62e16f37a51781221b0fe6a03a6224c97ef96d309824a59b2c3d9a9309955ae28bd10d6375407010b47fc6ca155e6512f4bcdb555307d1741fcf62ffdd6820bfaf70a377fc33895d16cf704acb6f55ef918bfd216565de5904ab9803809589853b08c61bced75f2fc688bd30c8dcfb0d0ede16e4b331e6f9cfe385fd78f6ad80cb8e6eba3a2a9170889f4215fb9fc3da5dbebc73d41ca8bd8b446e18a37b8d81987c2f0306a564898a03faad8d0e9694a45ef9a8e77f37bd5ffdde5febde2680fb922cac419031d0b5a659f7c2420e2143d4d7f89aa3213d218693ab07100f0475547dfac58b2bc8e75ca648d914671476e1e3ac1fe51e2fc78ffa828d3ef1636edb5748930d46335d2f5a4b981ede2506e6f3805637ebc01f49140aca4d892636fb0403b2fb15971fc6de6bfe61f535e09afacca60b1a41a07dda4e8b48fc9db40823f10fe789438a66cdd62c0b77b6cb641ef9c3672fe8366ab5b753211c9481ae9ba1651431480cab3c22663e7e3b4fbb166b3af6b741abb409ec25d96939748e6f78527eae0d449646139a5088f42bee27a6c91ae8316bed08b0ac07e365a86381f9c49291d7d9953988b212e5113f4e62003218bd7f3a1cea56c8b97ee2f15ec0e3c9f51d9471ff517358794c085aace8fb259571c10e54f6f730445cb8868f1c0df0f4e796764a9c649a00d357e2b3fa7a3cae67b43b1f15c486167722d0ef176a2a289e1e98a1a9d92bb415b6c7ca7700fe6fded52b0973279eb67f181c25593f02c780191dd4c5779162bc29b1faef3e715265920b13e3c75863488194bda65daa5c6c408182e0151743337dc12e93e982f5bbfcc8e6150bbeb71cc84d41002c8b489e0d035ba6d25153c9788709be02a4906cf3969ae150f856d43559e9e7f7259be794930c27de8fbdc02b9e27c4195a3accbacadc7114ef8c4f8cfc1125c8fe4dd9fd4abdd029bd5e8435c720b81a9aa8307d8e1b7a7c2ff855aaeabd0beeef999f1d5e767f32749c2134b806acf4a87290f4f04f4410a095bfe3e47cf3d0d2da00a48822e1a29480ca73cf2a52c693087af8ee4a8033fdec2017b81b44cb516ba88719b7c3adf42cb0dc7e672fd270a9023c4b82db7a5a26a6b243b843f2138ac36282341598d9a596d3d2f521f7a9c76acc6829d01fa80f6001395da4baec7eb05251e466168b1bdad9025fae2f706e57c5cf9075f9d9d769b1606c228ab19628dfe97830eef9a4eb20f8cbf9952fec0ec11213a14ed7dffacbc4e6d1622f4984f396fee5f939e9875c2b3473dcfc52bddc7f0dd9ceae36bd491a1ad3de2a732611708f6a63e27dbbab363964b4e65b3d67d9ab1c5949ebcd2e2d596efef1196b600317034629e9385eb70c68d88449793a0e812d09cf3106926450007ddb8b602fdb8bc66638cdad95ee24ec1566d465745461031298bd0bac759fcd20b5b6941253bf3b6dd67383d5ab5a54ecd8a541668dbaa41429c189245945016d07e16ea9551f6e4f758e7343c01a18944a8c48768b0ae1955d9eb5a6d85a716ae918e810d721a30672a03de0de250aa7cf25d4d5a7a5d8978e80f1d14810c00eed148be0eb0eec6e985d3443a4d20096567e42f31a59477f5c23fbf61a14dab40e8f89dd0a49965c4a2b879979d748e98dab3a8499284efb1a1bb4ecbfbe027f58151bb12427c1b2ec7a17053e283307c3d8dac604636d0fcdfaadcd459305d30e2926fca1d6cdc7a47d08054040d4af2211a6d6bb01830cc2d585b2501d64cd065407437c0a704f4eac6c84327becf58b21b61bde51285113523cabe1817fa6e517596fc28ebdbfefe2ef53dd7285738ec68a5cfa7346f4d2abeb09f42b72a35e817e475d1bacf6d8a7d345bbee94d9291e64378776123798a03d60129791caaff80458881ecc6513fd44ed068e96eacfafc7a01f07261ff5a5342867669dbe2a2bc726a9e4ce978d746ee18b3bb0c99aaf77a4ca91023357f6d8f5c84bc1edc34dbc5085ef1ac0d464ea3e3195fa06608ea839796277bae78da9001f08ee7d26cfff6016a508cf0bf9c302f7b304e7a248a78e3ce5d7eb883f23ef35fc2f49b8887c69a7ec1d31cf20df59e18d6dcf66bacd113de042f37be7982e6ab9ac8a29c144a9ad2680191b0bfc440f3b7419aac0b9e054e73ece5918bde6a6ad5a410fc5d84e6af33b35a6d18a0921a2ade19183e287aa6743e1d5b252b7248e34a6c73aeb12129d3cb5c1f4eb8f70edef84c1a611deb573f27f9ef2c6fe50fb0f9537cbd360f0de0f5164ace8f68656e95a257a98cd4e514fde731628f4d82acc98049c49c46b76a8d1f153b7b8a4af6108fc44e781ae01bf924e2ac94ddb585898e084575a5a1a6a90b198e9e319f62f79a231aa0766ad087d7154fa8e4a1fb12d02f0cb6b7a65ab304d2ed28445fb41754ccf395a0a2fdfffb744116f48177ec18a9ae4dbb8cc0487b81398843314e578d2540760a8ed7576719669afd4e9242116ad0772cf0aeef38c53e3e544699b66792717a9b2ad51c1e52f83283b32d14005647c39f613455188e2ca6ef7e87c3c2499e06f4bfe233d3fb3cb35a0e16aaf9e7e38ffc5391d0d9ab3b16face61065b8e643e03e95b14daf60a38bd4b44bff11b27d7722576f6176d3e681f36dab2768397f649ebb912db9eb6219ae18c73e12575a803cf0f82995716b0eb14da920e344c5cffc801dd5be84263f0c0a670d0d52e4f7e4f84f1b40a946ba5a008f052c2928c7ce5278c146bacd2679a269f7efda0a865a3d9165e76167d67b2e1201d2dd06864237fea781a0f216fafe792e9395106319ad54663f36b9f5ce28596af016e0943d0846e123c44d5977400e4ca79fcc3193345e25780d50b45b7753f1cc8981657a960a356a418b9c8be052538fd3096f840af15c85d636a16909fd4da342ba9a1815b95d76eb310c215f287276f65e094ab4102bf6a2dedd3d5ac47b06ed4cecbb14036abff066d0e3c70ab0eb4d640153a2b5d072619fb186e014adc2566c2b12ee22305b6ee3a4246b85d28c804ee685f89316597d3dc6dfe34a2c37475f6b9bd16ebbc2726c1c752d3ebb4d2f9186a8d9b7a9e1eec125745726b40f7513f38933e98b284044fa063ee5eeaede0792bee5ddbfcfa3e8c7d106d11a965d955ee56d0c90a617c7efd25dc8747db3fd27fc9711ce3a4d21e3d7a5139731fba85b5e266293c436d0d7b249ea3a94aa14d3855405b1e5f73b45ceae3f2ea338ce6ce1fadd12ec38b5b1d7a8e0409e4cfb56b679bb43e0ed873d61528b400dc1182162567776d6ffabccd4af4015115cfde75ce4246f3bfc51e404984df7062808fd31be412eca500fa09987ee142e9c7c5de42bc111a6a26a06c24c01defd98abd7c0070885fa79b2fa24bd170d6207dd5ca946a60551ee1eed4cdc137358dab1dec83c16cd1cfbd1e020c519e9e03ccfe52fcaf7da7e3e42b27b251e33b32e90c024a04443286812fb5e8fcedbf10ce570bf78126e96bc896b8f5bbf99bd3b2fe3989f0be56e9b359b6ccc8a6790f83b3e462d158281b4edecb135d306fbe1cfe3269c876f02fc7667cdb25d96b3370237aa559cc44b893fa967c3f6fa5bee51ca22669c280d6237c45348b5feceda27933bc2b9fdf75f4273fa4af6c04a25d44282faba5080e6d7ceee9257fe27728d0c0da482a2066ba7d510517267b7378f7b8c2a89c08d3473048a4656065b60e24021c21ec091836b4a78c3b73f0f5433667841010431d2acf82e682fd2c1325abf9459150b569f56a1b2af3f73d0fb0b3f7773d152e7b069668a247b12c817052a98197fa8cd984fdc00deca410a5d52f635fccdde67af54423db49bdab3f2968a199a15faffe35baa03e9f2bb597c74b3b03c4428ba784efd33512b0cd49ae9b04914915a337cbcee969bc5de485f04dd3ca42a90d3c0d81d7835393ecf3b4873dfe503ea0211d3da6961083ebc5c405a90fdae1e4d51e8363847751c58e60d5c35a050624b8de9336afaf3ec76bb46ffeadd2b80daab24731f83cf5fce2981c406f049cb356fe4072905c40059394ad01063df63c13ad2d92c45028ed5e4f4902c06d1c8a8a165df2883f4f6e7fba95a7533034bf2d14150c9c7fd73d78bab7e9740b596fe24dbafeae780c0e118df4a1d9558a6b3b6f5d78556381f659ee2952fdc5c5738b74848f2193c10b0abe663c4b0b2b99637293ef2bab2b64abc61dcb96f07219fcd11dc2fe0d0e932f9faf38875dcc18a333745a5b2e2424ae2a8e091dcae943c82f3086a3abbc6397ec8669c40e05d52ce2d2e598f89497ae0b88c193608bfeb4972de936ac36eb6568c424ee180df6e1c2a66ecf58fb156057cc9a97921ba677b2687ad26bf9894c5bac31a74d3dd7826543653ab4168d301d5e8db0d80d4b303249a3928674dbb4933648acedf8cd5c27bf94e5ef3bb37b602b1436c1edc4ff2a66ab73d058ed299a6cc3a852f816639a88923d5ce31f3b9aa463e6f45ef27b74a0b7589e84e8db64a9fb325dcc066d85ec178c2e06fd68c518916d4297ac9ae8155ed14f6418ebaf7fb4e4b4f2619584773d49f5dc3c00d84bf2dfd1ef6e42fb4a5723d7577d06953792989741606f72babde11ac7c62a10f795b7324c5a6e837cc7430478a159b6d711fb1b68507fe1cf12865c802e38335fa9d0fc0302a7809b9903630b15d7d23a6fdbd529930c587d400f8a4f1b1ab99dab4a84fc8f5d74c8ea49316a52a1c824c3b1cc263235c65430924927f75725905b325a1ba4c149db9be46b5e7217f6eed8c326a4501a03fb4d322cffb81236a2675a7577eccfe44d1c8f0738a513f502f97f943f3c374d8014823dc1e4b3e2fed5f84c974be7a56484777b556bd45ee41725b4932e464ff3121061f883c1e345e0ca42e939f653f09402ad3da7ad7786ef9a8d7f235709e379eecc0c18d5a0a1ab801d11aa7eb99ce42abf4a02c4538656011822a235235ad7cce5d4d1c290078cf106ac2d1d8da5c86b8597bb53ade8030bcd0b3cc06929daf9716b655d8da27f1d860ac8f6a90608a6b2cda95c88aeb1f1732fe3aeb810cf1ec5e37679125a0a847844924f49269e2d9e5f3dac336df79fbea3b9f13a3a66cbc4eada1a175dbd6cdd7bfbb52fd02c8d74f5e53da80b995f9fa94524b31bb9540b218cdccdeb9fc84f5689cd847ccf2315023325166f5242c3f18359de67ac49a171c6a4f4fd24b3b1660a20ecf11f6c3a55575ff914d6f800caaf584b5245a30b7005fa52e885a24cc281cba8e12727420348e28fc31766b22a1fc0e0a146e38aa67b72b8cd5018fec679abf4906df378234865eafb8a5dcaf7cadcbce8fe9438c6f7a78eec25a1866b1eec188472589a7ecbfd676677fde18c70e7af062079e28cf17b4b08c249a0cb6412582605761ba8effe57ffcec7f6aea08c036a0ca22c2a67fea58ea411ddab9d83e919adea35864526e52d5952d632b99be400ca58cba33a52e1c8d9680330e749779fa0cbe041459226b323f40f8314e58168932adbca9f1429601eecefa4d20a46647d675f5e06082a1b93f880a89dea0dff0ab4e91a9a9ee82a6a9ad78f6fd0bd35a4570f38c8263b6ce44d1df48844ad5f1d7af845f2f9699f7619ef7fa8678a2ca62caaaf128c63947c9df5e0391a4f84875e5977cc7acd27d24616ce8eb965de06960fbc499cafdd0a5b9d3ea5836c40522f9319798e2802072f2bad74e7e424948beb0fae868cd41a66451864f3fcbf759b642e0857bea4d60813fc49396695c5075b429a62a95e6726e484bfe0abc0699cd072df2246ad6d76923876ec4949721b74354826cfd4a8b3f5777890ca7affd87b8c5b601e35c8737c893e09cc06d0a44d08904398d8bcc98e80954c2837f37f3621d6e4f1f031e2f8435e1c5f1ce40b6ffa6097cab81fd6f89610d7bf9143681d3567224b8ceeb1643c5b272a2c07f5ae3a4ae250fd2e94e8bc7886052712c5c6f16519e7fc2940d63c0747c59c73489b166020350bcbb9a14ca710c155bfe2be9579945a2affcde822180a92ee63b1edf985184739c51fe4c9a758267da284e5bd0ba62d0218d5e71ad8edc301fb70e669bdd2e27c36bb355ecdb4217d89aca7b9f42ceaf514ae718e5c3decd3788d29bcb278a476b1f08a83ca7e287e4656d8a95b98a2e0caca3369c4def5b98b458e1df4619566ec246808377ac1fddeeb532ea79f6c39b63abc122ee8c50b60ca497d673fb2bee227ee44e0f018e7c8449e58b091ec14c43a1c361a712421179ec136e2d48eb555bbd402c6106094bdb5e32629371f828ad1c97c03934415ae974f0087f5494a11748a24f082018dfc117af0e72026459cfb92ab8e12e49eb8fa523a096be2ace376c2c9d79325ffe0e78041c8823da08c9efaea04d6850fdadd59cce0df91ed0e37f417affb801b846e869066e5b8d4b35582b0edc672cc3ca6db11997ac89c72b7f036bee49359950c313857ee8cef5e6df6cae58228866c046d0a62fe8502cb32954ff7bfae35722cc59d7cebb9ff2096b33cc6d1e5c538fb3b68035c41a6348a6bfdaf0d2b01522aa85354a098890c4c42263b31009df52685d414c80be03b01bdd662e1b06419c331e5f4f35d006daab40e5c24c06644a28518e2557aefe8d01cd9a360b82e09ebf96803c1a916c4afb0cfa387ef27a6f1229f7aaa3163115136a06c549d88f30632708ea6166286d4d0ac798840614118b7e81a1e85f6299453b7b3f93d69ae8dfb539a03e74e7930b5fbe57e65dace08a38df61fb85d2d4abdd2dd9cc5215286ca35c9416f40abd357176730e9eb87e2dbbe2723367f079dd163008e20eb7c6071ddf708813a38a69f5f5ec239f47e51fb1f1ca45b2e45343cddc84523df4c03df68b20ce4819ccdab49f3c51e1c48e221520966f8b5a8793b75f06ee5c5258ec5f05013c89b13239daa2722517fcad97418e1de83eb035a937929d45b10e583902779615e08f9a86379e315f6ec7b741aeedf621e860ec5ada190c799a152a502f6a999fc243073a2fb924967b2d4c8199402b728ffb1eb8a8baf4f153762e79ab444c35649c1a5c3e2b8b3bc785dea414419d9f3d6fae4b0d82e29ac780788c53df473e19e303a1ce7441c55f8497fccc75d8c2237fd52b8a9e055896917611db6ccf5e671961ee2397373937602b280565e25435163cb7d02d8c8cfefb24bfc3947be914dbb49d641a9373b684c21027ea0e85a3bf64e23c76ce0f58d505d60c8a8a5790570cc822630e9ef06eeba6429abe97f2b72dc1e63e9a5f29081350e085f90354575acc44474bcd3edc3a97cc3feace4413d70660c363ae1c8e5e27c4e167878ec352e54244391c19c01a901ed98d72c33e67d7943c0f510c76e7a292552b6d05da0e361eb9c0ea4ddec9134075dbcb723d8849a4a18820e2e0c4fa32ae5ba260a69d573e747636f38c40b7186880295cafffc5d2edb324b51b20f7e15b95657d2d38d7e834e713b49e431d28ab3af299af302023cc039225a30eab35380a2ace3f16c7fc620e733442424fd03d3af68fa9f8d4f29d76162a11c4c483f44045682ee2a381a53b9cacbf5227242435d66736f5b6a2ea6422d68ce75a4d5b6e2002d9f484691de947f341cbda78bda2eefeca523f335e8f2655ea1face52d7b01e71fc0ce60f833cfa840e80261890853b3d89727b08d8eb446e6ebc4ae5e363ac5c25a10a0bd85773e89def173bd6bd5731c9e0be77576613ac14ec115152f0c432d5067a7ea286963b735e1c34d330d0676ad8770e95e4f31a4457331dc45489f51b803eafaa71124a9e5feb92f893e874e7f0904cf5b323a03a4c1e18ab8b1be58ed5f096204e3b8a291b5513b0545d5a5615870b0820123a71ce12ac1453acecca6710ea68e4bedb1d755b42a087f916f5d57471a6dd57448ea7a7c52564bc3c8c95e612fa1d9fb234d7a64e2754650aec5e2b7a98730132ebe91387c3007d64cb7f1ad5139739f0492ba3344dfcf6cb06ae65b78b03c2caee6c273448318723569fb1101f3933b1ce623c00eb8da3fbcf07094d63f29972f413605b6d477645fbb46caf8920b5e64b2d08ba28f3c2611c82bcf82f7a44e60f85d39e2f52a2ec842a9ead2895f4081581bf1bcb1ee261d04532642ab49bf7c02001f4f7b46e27105107f7a41fd1de22bbbe8fb88a4972c039a447c65c81bcad45fcdcc667bca1378838f005d9f1c7490c4861ec792a80dec9b6eac9e7ab8c69b6cb9fc93d2bd5456e886f6529b3df37bc7374c570bfdc6dfb63d97a716ea4079e6a38f13e305033aed84203af532aa626cbf64b3952ce11b286f36cbc8e0cd6263ba4b6f391bd5b00d18d9a78fa11d2007604241755e16c09f884f3a93587b5a4e7199df9c4ec7e33d86314e2024e201444a0d98b937e1b1fa3c1555b435c258d46792143009cc5a0de16d8369e24ab04acb9f0f0a347d825e8712df4c8b80ebfbe3c14bde65b82ed4018e895e708bf5d176a59add242d2af97afff795c82ee7b46a2b06ccbc06694f9347bc29324f55d8ba69f54b9a85c0453a5a21722058a020f2439e3aa3aac982f32f1732744a7198c5461e96671152c6de753603ed055cba5e4435d508cb341376100725d9ced188cc8758cab638604060775f3a050ed0990f226ef22226c45965ce491e7581db965992066dba103c1ef839a096fdea4b2a8151f08b37c7eb23d3d5f086a5298a3135157f0d43c2ec265eb745f0d9368bd289fb4bcc384c94e459a25abf4bf247d0a409837312e83eaa264f28b4825f0fcd6b56b163e3d4890099399f2a876d5e7cf52cbb55b9428963ed8128f0991bf6e3804d87b5a9ff593ac1651c0332ccc7cc44ce294b4f469b25d89ddf61d9f9393a6105c3979925a0013c482578e04918100c8619022e1e60170b6bb45029b159f9e60259c2e882a742aa5accb5afb269d8563d761125e929bd4de7cd3ad9c9e68ebd28f497fca05dc6966d60b415a123eb11070db88b3e2ce84fa1fc1290d87e7a5d6e7b46500e2587caf85438c3ba7bc28a6192de4d591def1224ba96cbe96e34fef222344d0e5d62cad86f3640460bba8b7c61a0c68875065f47f85e8a6c4823a4455584651c8137a8b981517777bc93a446a2eab80fe086f489bb1e798adb228757baafd054be70ffc1a04a7ec441903de4e1a7d993bb1ab9c3534827570e0804e52e826668a960e639ce939dea1b445ef72fdf796c4b4f1427b467dd89a88941d274fb31e26e6e35a3bff4153d99788aabaa1b86d07a072bc3d8930f6876109a6b459df5b6bfa4fa570bfaec9035b8e597ccf3b1e08f1fb48af714b5c1e2b417fb7481f8422af889c8fb7484aec24ceef652014ff83b7228653545e534492c71f1e43569515893cb6972103dd84bea4d5a1a6b05c806ada3cbd826b9543e401b5b25d57b18a88bee6c8381bdb8ba76fa31f367666d4ab301b2578260f5789930a89ad6f71bf51e9686834deecb94dd9cbf5acade5b71a7788653ebbcf0e2ef5f92ec92804f80478a9d28f0c71e02917142d5d330e1cd547902d4f99201e1304e8fb51b858568bebd84d5001ea4e849f351c337b27b496dbb1c70286bb415fb5b7e2acb18f6fbd0a57e950296643ed3e93c740fa800c3febe2262088e763dd8b7ddd9a610009953370019fa6777b7f80f56a7a9bd8d8350e1e0d95716934b5509fc73c06f94cb3782e15f4828d6758f2acd650f73291062182cb9541b67b8b782e530b594174c52b53d4beeeed1f28d777fa3fb73a3858441efbf06756aef01c2f9669c4f064e2ed4a049f0db90f6d3c1c91f1e27ca358ad26728a95ca0df5cb8f54c0e7f6bde7ef821811c5df63952e698abf24710ec16c02f24207fc017a765cf1830e4cbd59bc28a06928452b51b83759659938495a3157e5052f5a68eb454e17719414b069b3d1a09137bde3136178bf5dc54695dda8ccbef72d6b754fd747603a9c0da9485d0ac05e2f9eac878b67523461731710ae46d899ff2beb23ae8b8f4218a005b2794bdccad651ef819ebf739db7616b726818ea6cc31044aab85e2fbd5de90218848d62d18ce2548a8279cdb8a8642a487e09734550922619688d54fa3e8bbeadbdf17387eba8bb905c82f415e3a59cfbdfba50ae5b123505696e6f4ef6d568fe5db5a31348ab6895f49e329c7d10516ee927d789783de40bef703f958cc05fea22215f6a73a5a2c24aedf2ec103a08d2eb99ad89c3d318209fd2fd6a634c5736bfbc2b3a69e869467da2dbb4d52286bab17a8ae3ce4aacc91c6ac4cb510cbe77ef9ff8cc0319eb4c3a5ce6b76451aadeea6fbceac4c06f492a27ba6f33d6db6f199ec1aff725a3562977645e7cd9419ee730375740e709dbaa6c2a9e586198160a52f7c4062a44e0b1fa214605e2aa30dbdce34f23088f2766f162293765370ae6f441bcc80ce824b4ee2b726dd251cc9750dc445d67de0fdf0f1fa5d736022a399cab587fe37a4e4901c5f9b4400980332b63a75704db53f1b3d678b5fe45f0402b39c3a765e849e0e196b2f2d13b56e8d76b3630ecb8d706dce2b5f81b42e75dc0e3e1d141d87cf64d0e16e044aa6a1329378b30f63829ef048a0fa2728008350cb46e08305d74e05371d8056916ce15c77d21407809f1c36d66bb0fc87d52c868cca8ed4308b202118b378f149dbcbf4c343363995205502d0152eb243a021551dfe1971ee9c2804894677ce7fcad3005c16662f732268379c9da1140bd6f3a9aef10b625c9fd70d4b7c68dd40e3cfcff49476cdcfa299aaab47fefffda92afe1548e9a5be2af025fde7f035cd1fe7f6aff40b1a96652d752939faf8ff805695d3a964071f73427c72e1a9c83d7d03f3aa3265387229841c6212b571cb68d4091a3cdacdb42e837f8f390127aea1b201c421a9ca4ea26927ca514ca8eb07e759b99bd2e11466f4ddb0ab4fed52e046455381e313f170ac59bb1a6957d9bad8dbff7341d0b863b42b955fe31f4e0153273182b82a3ef94048c6717cee4f44b761e9d800d6497979adce82fb4dbda4701ce87d4383867dd8dfebbb317bc882ddd8d24bded65b3e489ee2f27dd45644538bf8864565b6c76f5504e68919899792b376eadfd7e2539f013733b21a7e546bdbef050881ff24e9db0deb5d353a9d1898a3c5af92936d6afedc79e470d61b5d3f4b1ea0a4491edd83a073a69d61ebb7f23554bfb86fbff9b5b8c2448d68f52c278906063f3161c69524b1bf697283a55131a7034215f412119d2188c85680276a2c3f84cfaaa2c6b5b31c760e4e1c963f753eeb65de3a5bbc1d19ba20a2b6b49e8fed32cd07972500534fa9cb1f3d2fed0c45292a1d4b527daae26c8a14ea4f744301c705c7678839ab1d57058104a84663bfdd623c8081507993c106a94b4f9675290e4c6e8eaea948530d7f701adfaca9926be023236d79236f5e42a3e6b51e7acbd9b9ae18206d7308fe494eae2e43c06fa4b7af56847059aa96da8c9a52fcabae21a95224bd84c90f1ba720c83de0ba0bf3eef6115a1e0cf2f37e357a89d97cbedc2d4c2dfae7cc19720ca6691fedead3ba3f747ea8e25bd3262fb83efa3ce8c0ec089ca911da8eca49fd3c66953ae44fffc83b7325209ed4e6146d1710a8fe81c3a929fef2be944dc8450e8a6d208a3baeff662a474cbdf96a8bca30c12a5f48dd4ca125b40b1cee8e3fd3b0a1a4af91f7da22a3e507ad0501ee70d20248ca268f6ea7f3b91441b042ff6224a2ffb26368475e27625fcb4d8ded75ba0d1594dcab04512064b908de3d06228c10af257887fa625190ffcbc05cf7180d357262825d0705054717c955556ac79830869178748c49139ddf476704318b00ff9fb0776e5c466eafc262307f2d950b7291e3bfc943cb6241fc3eab306f4c22a186e10a46c732bff71dd96d3869891ed9d9ab1066f6d3a0af7b83a811649337685182e5b46833d99e0583680455ff5f867d9c49a013db22d1a04a80cb59a1e5338df6e919d86d76ae05f9e925195b4c84fca6dcffab147901f930678eda84d314683fb76227479bb43c983dc59387c304f7198d850e23cd28ba6da88a3240c6f6a426c829153590f180541faa7ef32b8dd174f881342a00a5faef451862768b32bd180e817cb545d8a6231b5a63ce62b242952761acd173fb6611070c4989252622ac3ab55f1f7953ab9b8bcf0fcfaa0dc606bfcbbee323d94e0b6eeb76320c6a53a7df7220b006d4dff2d4c50db9cf9bb7455a96278c6d0e2964a6647d3803d9954b6ca097a73f5328667be9ac05f96a2d25821106f260c8d383a939e9a3d88276b188d6e3b1cb1eec3e43611f2303a04b3877957a14f91f8b3462430bc51dfd31cdb8b349349c12db08154652d1920265770f31e7a4e2ae04e7375c5fa0bb36833a6d9335ee5d50cab8bd78f05f6add075bc14f08e02d2f03c03ed7dfedb14d7ac87d3d248c1c6f5d52eaea5570e847408fd97402e148568d73378c1aecf62987aa9dc09bd9dd7c3193195358aacea450a870dab0a69be56e5a0c614ba2ecc27244f08f502f96ee67caeed0e450c93e399e270b8c3eeab8baefaaeaae9474bfccfc83944eb38ec6979417f7bb328eea9a74271451ba97dd3c559b6e3c8b3a316a21c9b7a767391dffe3a1cf256b7a62b462925d2598144b3aa86bef5ed54f175beb47c92f6a4c9efd21189a010476ab36719d4e54c53441e3a9169e1c39b9ef8ca3250fd0ad6ee1fa49be802727104d3c7740cc15ac52cc6cd3edcd5faa8afed38d5bf24f8b2dd213caa36313ad6a4a5e876330e4b8130d689782d8aea9e161c86ddf109c3afa5f54c3e6ac5d09b53bc0a70590fad6d9979443b731ec517d0e5d9944fd475949ba56f6f412ce0b8edea9cfe60811e32bb01d431092512360f1de31cbe2fdc7b2d564f426dcacdf4c701fa37573fd46af5ebc33370f4616eae840328b722e5d3bfe343faf6b8e3c4db1436d0a3653d09076d9d5adc599b19d69227842f5e432a6034b339848d1b67fc9bcae0ca1a2e59cc357975c758aaf5631e75f30942fe09df38f0a906033a3683c03eebd09fbcf821c83352e5dbb08eb81c38a25e27327aeaa0dbd8f650f9c10555b23417939616fd14c6673484402064278966b907665028d78826de097dc8f2c55585a4ce9b728f0072ebb962b57db5befc75e9bcb3e9e69e870460cbff459a5bee1f4dafccff95499fc77f1cf73a3645b9882963e2716dd81b99d95dc686d40eb8320ddda850c2bf173030bc855bbf7badfbf71c0a453bc976b0ac4b92ec3ea7bf4c5d554ed48d181107a9b2df0422715996a67e38de833707ca83efcbeaa991880faffa4a3a731e0bf0f9a72617e788cd431d62896afe3ee946681ae9cd21a7e621e004c1d9e22ce42517b7d5004b3b86709ff21f92d7e88646b7535d780483e70246ec4ab735e7cf4eadc4ba51bf2a05daf53c9bf2a277006e698cdb0f98f8fee0105bb1b5f1e4d1aab962266234c38ed7660260869c27a56c41a81dee5c82f6fee49342444ee1303d8d95dcc4a6f429868a50e3373ee42967da83f31c4d8cd84d5c69f789b4816f6c31204ddf6f4a6e232bbef0aba4a60bc3ffde319a7e40088aa028bcfd42985f1b707f2f2074f5f0cc49b934ea5b7990123ead6732ba6c6c0673bde4cd23e09e17151d8cd0311cddc0f1e37d2f6b168faa05e7055ec40802dc85d92de15ac68fea9929d7482fa0b735d22ce8fc77ccf28090917ffc6db693f46cd938ef38f222efe048ea90e00d70a84689606fb754b518ebc83bb553bfeda87ceed8d7e563ab4423017c53b8b66d80af4fef398bc787ed2bd601602421cb1ea307e5325326f29a993fe26efe2e1943cd820c55add231cdd509e0d080e6cd5fb1df14c014e875746df7475da2ce9520e5b63289b809e02091679c859a86a59e7bf57070ba5c7a3ff278584d36bcaa604b05be8750892cfbd027374e6e897495ab038a87412b278c6a9bc693df908abf29daee0a972b17daf0612f1f057dbfe6aa9cc85caedfab704c199ce0ae6c44b51c6cb88bf697af545a6839075092303fadc7541439361302e9a5d447d45e8950b5f683aca2b10f2fd80a6cdbbdf9741ff5c27d0e2c68c712409d8f7774ff7b1efdf4766f82a683270bc26c9cea1125c53bad2a1fdd84a50b23554a1afabce0d6e7431f7631a3b14a9c18f7299d5a1c3d62ddc1866bf3f4ff8dec9fb636ab73e4650594e5c6379a51cf27a1beacd7ca52f87a69784ddbfe5de5475884a7dcc35d3c30e24c0e34b46c74aed755e1e27dbc112c3e201d2a7c59d544aa161f6969585ae716a242929ced346787fe3dbe700776f8c69c64d11f589435662f32aadb666763847131d3e05c49cba9a2f38a5a3fc57e0a3783c0ac57cda5b5fd845dd8c7189eeff3e8bf1a35eca8d98b5ef90c7d854eec2fce120b6b9926686ea964c864f18cb77f9abd76009899056559c55dcc54145fad481837149e86ce4f043c29b719066896b49da93e82aaa1767f99c633b55b4f561e7affd7294789f420197f9a869eb7c1d98ae24961758d037005c740df9f1f9e35cba7fc898e6c0e1e0e681f7f2618f43ef24c9b2ed1d527988b84302ca230d4c80219f392cea6bc8d1755bd7c7981cd7e5adc89cc06310075562c7673afc9b297c04b02f0cb6fb4f943964b0a9b2ddfcac38eddeb9c46e00344db3e69e0e1ae5c7234e350fec2cd1c8ef1da1c8e61262ee55404f6fe35bd7172635277f33c366efaf34eec545ab9bc9000a3ad53c6e12864c723795c90a02cdd239bfa60dd80ab026b7b3f253a66e621e1614991920aea9cf5c934d762178d940277b19f1e7d6d6da5748cace6a894b9b3634189aa8172188371f04617ae3903debda60fb7683ddd184f764836d177105c259c2948a302b722979503740bffbdbd1f169768373f0f98ab58dbbc988aadebf29658f14208a07685f2630ffe697c2f57ab3a8c96c3660a02c9adc2873f2ee885e22c45ebc117880ee86b78dc282fb3436538759888e8b6bab1ee2061ea1521bb594ac95b7ee2ceaa2fa505ec9a3d14bf20df3e6b1e93d693604535c8f1be7e9b904ac5f7b114ba126a09809a7275ccbfec881629535ed9dd888d56c3758a8e1216d1425085ce33e3f24d9211d5171eb1fd41f6c748d9efc0b7c0aed9d43bfcbbe5b5a6bd62cc44da106915ed21f46b16a56182bb5e39b3b09a2950ac96d7009508706baca51268f6a3f1868537b8196074554bcf957c272bb8504a36dc1be4ccc1935439f2b66cc8b4221852a827a560ab8cc9bfa7abf2bfb97afeb7454be6fdae9100472f2ada1a5dd516920d912631df4ae6ee7dcfc56f12fe45db7ab75551c23217a9e4bee0422a3164d8b584950b767ebb2a0a5ecb507978cc898044d04dcb3409186761004113f0f4c6a52215f54d878b3e99fd4a2f8e9082b90ee1ce2687ab91fed44b45dbc5dd96cf210cd696e56ba1d67a1846225822a54bb3828efcc0973892b50a5ee26c459e86d747518b5e8a4daa23671ab903c62c65a71a6c3ed6de13da0eeac146de3ceaaefc3d2e2821be3ae5ed73be507db9f4db3da5b8c73927cb8e7f7f8107e348081d41f454224879892846a3da1e68096187c49d0f5a22a1b6d16a7625291c489491aa774882f8d6d358477065aa2f0373662a17d680c873052903f3f5412ff504bf1813c762872ee7c5ffce2f9fb986dc1f4848f9b6d908b2e2e6a92b40dec1e989408ddcefb134eccb62598c0ced13c1aa9b8a6a32f951f607721d79a8b9116fa1da1050fe85797901aeb0dd1a6e04649de6fcb9ef696deadb156493ca672fc1a28bbddcf55ca41a8bc575fe5ee45d056be38b74811dca6d95113b2df6389e40f758f3e1823d627bf08b3dc7ce3f6232aed07028feee45ad6052a3a4bfe1f0f24bf78b271da57d06d4be915d77b2778dfb1cb3de8526f05d5dbcb24395d0f75a1f6aaebf050763947cd0a4515b244347c29c7eec0b1a08066653f4a72fc545884f7f4531728a58a20b4dd501c5145ef5f6df9bb8daee02b620b5f349c24cdf33739fed985c78f2188b293ba812b03cd4af73b7d79d42bbf0f612eb869d45876371ba97ff4f9bf6247df708e69c2afa83f27a7db7258888e509e41f9fa03a648debd5a6e91abaea3e7aeafc64009a576579b14380992096f723c06f4134f1dba3f85a5a7e6588755c5759aa6eb2379a50773ff7aac6c10e5baae278a8ba78d6389c656ee7bf3dae71d4c5055a21de28d9271df856ba1d9bbcbda8ffad398cef9c176d9c4af8d985c07c79766fb696bdd82000be1aae28238c151bb20f939fe75c33991557045e5578b08593a5e774d3c3e3d3faa26a300af2b5954abd6df04cb71ae84af339721b1172f7eb72e53e0a85a7910487140f82b28bfcf1ceea4129e924c35999e4df0a59d630249835936ac416e7a65ccb4ac25d43ad801df29afd96e1eabf4e38be0c0025d03211f1e4cb5dd924fe5211137c5319e657aceee5daf5a7c1ebbf8a0329637e940528fd90c57b42030eee57151e3186e842cd8e0673790c8ff72db3a9f2e39448da530c86f41caf166651d1a8760ee3822fe857f5b39908a8ab2d02622bcec25708138a70ee3ea7af18c18341162bf7fb609dab3641f517e36ed0549851dc4e6e16e166a1673d080349ec1940f76c0cb35c97422a360804520956e6b2f9626365489335932adb3feeb862af4d3591d98eacdfd903fcc50bf237147e6791b8e8320355b0c291e076c4d579944baf00599d07b609d35bcc58456101371d1294f1618922804a40b2b6e74888a360a257d143eb7885b477d823c57c8bca744d16d99f79fec13850737fd020c3bbdddcd063f6f554e90e901ccfd5939ee32188827556e36f662ecb1284f70e70254f3169dbbb93343c3010424facde433a5e8546072e03ae0c1e7840a42fd5e50843dd9c94d4786c7dc7d1ab08ed6408d2abe1987ed307794d3621a3bd9fb5d8df9a1f07cb6d9dc16d42da8f66446f6f17f126444c14613242980b44efe112d22e79f6bf3a205c4378f396abb95acf6423cd7aa69a31da2fb250f68b63450be458fc2095f4ae1e2ef95e6ad980605f36e5b1798b583ae7fe080c6952340e962e3c4f405fdf044d1417cdcd7e5ee75fd7bf16d14cf28ab4d6704fbf8f3b4490e16d1caebf1e3ea5fd15b10da70313fde35550f1e4e784e5a3da9790221e4c7be31849d26c73295c2f2f3e188c36d26079b181d080c7a3e9bfae56f0183edce557dfd550565211fd344454a61a1da53c7abe78516da92929b57f0109cf242d7b9adaa50a7f6a70667d1d5f2eaa376ba3d12e5f244605e11f6ed46145127131e365af9aa2446623372897fd1197883c53aa21c8045a72729779413abc2a595ed9d28d4e63be0181c5bb47392e835cd076fb7cead8c5a5e399d9c066e170c8dc96b8e8e9fdab4981b1770495cd21e9d9d971a3dbc999e1c4c79696a15df302b5a9e0e69dcf8f0c19122bf6f4de234ec9172750b34c4fefc0b0a9d1cc6630cc26462fbd901765e81897bbee8698bbed264b867652ffd1d8226289ddeffaa64178b44f4247616d062b4dd165042124bb4924f6576d00bca32488d6eb7d05df15333d77d2c58573079e317b6292a710e2b013800df7ff9956b9dfd4645c5bc89c8ac0fd19da4cdbda494c33caf2d469d2e62334d682ec416c2e5bed07ffa3e0e7b65224e29d84dcb1bdcc4b8b2933c6e7d0c6cd5801fa37770dea34a8ec267db96ca4c83195286eb84da85203f3ede64fc8e103a7333a3e878d00e00e0568c11ed667dce4bf50e446aa724267745e609f9ad9037309910d792bb41f0924c264c76dae88d186a8ab7cf37570c140fae860ea6af6d686ffe9c7aad7f8d2c5190728b821f4ad3eba5f8d721362a304c7897169cf41c9cf7e16683e2e86d7b7ab0a55700d2dc630fb4612bd3937f101ed4b7e39e32b53769853023f8db620e464c98d4523408d2226c30a006224408a21301e9eeed6027553cfe06832c548c89077ba7f27f86a1137e657770e38d7bcf6d84ca8824d3443ae278c36c30bb1848225e16fd0530528d988564c7ad181cc5801fb55d61233d5987c15f8f7f5dd7423613569502f945d45ec566b8b8b955cb04ebdc977638043591d1c6a2a8f182d808588a0fe1208f29fc168e2e8715263f8eae15be42f644c8f94485b2bc6566861d8132fa26ee12892f35c5297a8e84f7491361a64bdaf132f3ca0e59b543fbb84cbc9ecdef642ff6f3eb431fba807605ce0c6afc11f6aac27af55cf8bc3be4b314abfd7c99fd2a1e8c3ace851c39d979d33873b75368296b0737306c69892cd3148135701fe337bde7e4a0990c658ed43a6826fade954de60871800e617881d15e0c2cfcd20f3a9932a6db6f0f3b47932a158ce762a2ef17ff3950dd855e1f6bc65cf73254c9f5f787893b7f3dda9726b90214a69dd85d9a9ab6042f5c382232b74fc53da4d80541b518236766497b135b9937a493a5ddc5e93d76e3cf99cfe33966552bb50af553d5cb54355fc4cec72dc78e610ebc096f4a06e544cd914b7e14f3b688ffae51c37c02dce6505f5461cfb5dee1fc1e04cb81442a6f9918c987b4c5d4bb895a8c7ab143064b85d5c5764449b16a667148db81fef3837d4b3d067f8028567515e8b1be0758f6bf27b96dfd4b58fb0e194691a6b746755f86691fdf339f455ab288760b31303b6609feea8be11f78154f3ca9d645d8d54c56ab4c6835f73adcee4de3f8c42941b706fa87f289d6f8beabee3eafb4327cc5b665dada0f654bc159d96c4b6b24add6a8832eadb01552f6a0955a8fab74ebc2609e53e10a48820706cbaaed0dccc8ab12efa088e848576bc665eddde4e1aff48082b04b7b945cfab532e639fef4f959f48cb5a27dcc203f473766fbe97deeb8ad08277e93f61ff8dbb4e5e5d75f5548b78599c5109fb7ff470e129445994bc8b55e9350dcad10737346b4568b4c42eee99a0dcbfa17d911caf6e8026a457366b912b884749aeb6f4d875b4358cfd6d371417e0f52ff9729405c4b06a9497510b67c4022290f45e834149e2c536ed3341b394956b1418e4af6ed4a8ed6b2c0574630580398b3ab9024f4b7a9e45baf0edf0f9339d6de64b965d75f755967fed1f75717b94339c92d845388ec81c9cb2f54eea63bc5a93698c20565da13e8524b217fa331c625604ad56b2d2d35299f957a2873318c214aa2050818116910c47780a39c101b80c37e5ef8523c33fa5d6571417463356c15afb551caaab4e80e0ecd94fef39ed5e84b101bd810a9339a1ba69fe5141bc72be5e53ef7232bfe3836fff150549f66738dd00eb68821c231bbf477ecf70abcc35628181b465be8655e9cebc95456aab98a8e841dd3fd5e6a2f0ef9e122056eb9e9d49106f7a7917e34c9ead06071d32c5709c8f3a2220be21bf04d876fa6d69b8695c7bc0095a7925e48655ee9ee9c45971a46bbe9c807132cd2f5704c2f17d28bca9b14fe58c0993b8a882b06f2dcb449e6772a73ed6fe15a13c424767aafcc152fb39cd157e88d805b2afc8f7d381fd1d64784872b0fe3bb325566a855b692c56a20d51b16634fcc489139ebffd68e552fcaa0bdd5cf28f09caa69e1ae6047d27bc1abad051442316a7702bf350e1f18b3b8ed3e581bee60b80237a27878355fc209d2ec363e03113647cab25c4b6011d1f9483218d2f6c18c13ddf1099d5e965a8a12abc3312bca5502596ecf8d9d019be450e3e7ea7b8b4de6a0d303edbd867c073626e06c5d22d6947b1c8f031e8216be7af473f20e06b2ad47c9362afef53fb7bbb9e22e36f06cb73692d8d41f855233939f8713a7f7f6377960c4f93a32355894842b39b649a4ab204bcb46f289a18139c2022fc954b7ff40d778a1e9a53ebe9b7b91f70eae511e493ec46c65531c3dfea8465ce01e11d835179bb5a296832f0fdb4efbf98c29736839a6a6b5b6e35eef37367a9114e8fbb72b8dbc3ae5fb597dbd118c421521bbfaa66d8098ab97129d31303599433de4718949af8cc041bdc4b0093dc6e545c65a64333a6799b3aedf4e5c89e4dfecfdc70f9bd181fa4ccfbf77b5a6c57bd1b724be96959009af9c592cc9a81b81b6847ee0d91bc018cfbf4cc273262462d35299b697f6014861faeadf86c057abfe68db413d153854fbb51cfb3f5543cda07d3d25dd09f54d5985472e3fa7b21c72df2b4d95d9d8a3eef4b01eeccd5d437e50187369fd074d1fcdd7199a97bafc01d57d1132559d8f5efe74fd9ce835b1c6ca00137dec27a5ab813bfba9244ed8b0412be958cb97c170b0852748deb6e3b894e9900757bdf43c3ab5e8f18a6bfd3e3818eb161a58c881a413b08638b5f40559178d5786dd532ce8b4d7e72848750d586fc1eec3e49824ec715740737322d40e4fe8b5978571d33ad8daa744e9cdf8886d180519e190f5a4f4a432ceeead17c601ebc5d3f8c005b561c3708fc2937244a289b5cf80e113c1dc3678a7fbe5627848e96c1ee6dff5c1a4c1d147c9d00e39b35819ecd020b4c4667f2a3f6bff844d8585b42c1ba92268585b0b39f58e13ae57787ab503ccc15d28db83379e2157384397ad09af861b008630711aba9c6d166c10cfdfa0f52124be1a33bb65226aaa8b6fb07ce65d2a07bee818001e07ba6a3269a0d76f70d14bee71580a239966e6acfab8ef65bf4cfab65414a297a421f99958612decfe15c3c0ad11b47e5ff10c1eca0eedc2566cc83474f67addff96d2ea35b10b41c939c3c879398f850d6ecf5729c1d25e3f0d257c6d846f3bf50ea9c6ee40976dc1e4ee7547a6bfd8946bc5931be6363bb61dc66488f87fcb6bbaa4b17259875dec5180474d617d19e9c2db73a640d1eb3e881bc7b7cecd0abd12c34ba9454900ef60391c8c1edeb1d687129b1021343511a0a5f483f4a36e6cf8a48fcbee482bf9c073f459c963b338dde7d1f3b0d421f689b179ba0c6be0c15e9856607e0a82039c23b5b0a0a0d55ec408dbc23aa0b3f5b5b97ed6ee9f7dd21638f90f7e826082defc5b00377a55fd841950ff93d51016477b1d653fd1f9bcde5359f9cad3d80d020d9c5b7a72f9be4249c71179c25c795d8f5726ffa0ba1a8a8c7aa31701581a065058ceafef586922655562b8565a9b839bcb1ed98b88f2ff75637bea2277c7f910dd2ba6126599bf64cd2ea0793e6981504d387f377d928957b3dcd9469a484390b14bccdb35178fa003e2c6eaaaca4502123979e2bcf3dbffb27025e4f0dbe0ed3cf445543bcaf7554c8ab5bc6452a742e3535c2b73ef3842dd5c662e92e90872e346a98ff95f98214c8cbb04635979cee0a93b274322a048dc4c1d411003ec40d7a22a19369246f66bb9d775e92c2eaf68f3ce2c0f52c87f2a2d07152f2320e567fd603da11e578fbc54fa121768383d300975530a0c0b7b1e51a1612e72c5c9100b7a03a1037a3ba0d41c40998ddaf5da7bed041728071d69cad841df68fc8a1e01716b87c4f573e56fabb2a63037f25178442131c9d5ab637bce9e03424eebe961de9f49e009aaf57ef7e4c94683f356e0ce2ed87b3fc4cfeb9ec1a85a633652566e1559ee8ef8452adc5880ea7ea1f5655b4ed576beac25ae5336bc4a300237d520ebc3b60ff78316834f31112c8d7701bf5f284fc8da5427633c82e0ad7ed967687348566e37b23583ea93be14bf3fa4ee75291428b0435a910b9f8870aca59742d8b5e7f4b343743b51931e6b44256a24b4be422e9e351cd04bd1ed65b22d6be9635b63c08128a9dbc8ea101c37b909e3e584279f858fa57605ad08310f6bbceb49fb49b3d936bda8e88fd0eb2e17c6ae8e34aaf1e9aa256b701a2625536c0028319b20ccb25286fde76ecca84be474eec3dba9e78d7f2a73249a820a1f61588dcb515a7ecd2cc7de767a57b91eaa4af2aa6fbd0635520d400f83ccd479df113fbf79951e3c2399d061961ece526529204aa0ec089e6275768108ddeea174052d60b67cefc3df679d8f933668b234de320ed4bcb9ffa8b6ba8d64e8bd161c6ca3ef5d2fb72635cf46ce6e2858f040300f7258810c961fcc0984f1a360dc8443ea5bcdc7b829e83410dc2bb423534676ef30811f43ec23592bda0fcc5b788901aa8ed61a58ba67788a8b86cf5fe3555889c4b9a6674f97826213529204427adeb18650a17c62a7cf8257c98d50d3b9cc72f1719b88165f4abf9facdff2dc21a4ebb4ff1990912f91010fda77ea85d5e9386a414e5f893d7c19658a0c14538e1aa3e04ebbae2463d98f1f98734a8044b0d124194aaf3c207ce19f880172f5d226a16b64ecf87c3d3a1ef24f6e9d001dcc7ce77e0a4b0773df45e4fc37323413e80b31351f378e2c46159c014cf43182be94170bf7fd8f7c6b19aa530f1ea1970a752f69cd8c1c6fe85f4b273bf509b048b1171cb5d564771d864c85a0d14209966f60455c3802722f5d656c5d3687868b195677441e72936e13c30fb611b5bc20a135197788b155e421ff604a67132ee628390575f2cdd2564459580e871ea38292702a893e888c3fdc8eab0db8d48bae80f03537889e06f0ec340a5acc8529b3d7e70b6b3987d76cd90097f057fa3a9df074d5363e443c58a13320c145c676cb0644cadbb9608a73bbde4d686a992eaca40c0b9197462b06383847f53fb731f19b26ab9910a4a337f6677acb860c21a52811248681d7afddda64c208ec5b58236cf685e8eda7ed0297007bf0181c45e4ea272ed3870b05df9be50277561b8b18000d708969fc7b287429f85081d673ed6f4c05fa597cd893fa2e1ed23458ada01d31bda28573034a4bdb4b0947db6bb384f361f505e7ba15e6391686292d203beb685324a38e9d9ef26cd3027ffab7e3e226eed6aab80b1cc1026f54303fbc20ce24813d5f054ea31b8f24378d78d5d29f1ce46625ba187946a3a1403b7a68cb93d046a9705bf398adb5ccde2ab6bc1b839f751a07e6e9d7b753c3b34f74f26b37346cb11266ea015b668c52248ccf4ff90c5e76e504b85a39d19dad375edeab661db1a2bdcf350a83cca3fe88cda2e0f1b3f24917f428922da8697576d14a8c5e019cb056a0d49b78e5849683d7faddad14bc6c5d71ea4f1ca84963687d3889e31fd5d60ef87bb830266e789c139526b8fa27821d05fc086fecf53994cd054e1216bcbc7b6da551db7c0425182ee06bb9093210aca86f6f8bbaee94cbe4b685ab28d1719615cdcd08f8837376d82d6e00461f9222cbc6e092b7c22c302675c4953c1838c28345cbcc72e07b08b9ae691d870e8bd36965ddef9aaa03a13c2bcf74edb3d99f0de9d6e6a8c8ebb7326f68c7176d763758b762fe325517952f1397d66b11f5b690921a707b54c558b43482b775005e9d143112eb532723bd9124d03ac2c042a3181cf3648ce6600ea073345fd8a92c8a6caf2670912974e834a9bfdfd68b702e63ddb1cb5e258f254d20017c06b7c724ec0f0ca73a60491a166d7241b99ed936487ed9912692ee1b4fabc4046d4596c04ddb5303f91a8662214b8e10a4b7cd7c05beca09541656e48093efbcef33355d037c5035fef1aaae2a53a81708f05dd2266252691cb8857df3390dc151ff007f7a6d16b7b1212ad8d3614510e802ea5ff873001e97ce9c54c69ba4016881a24d9e896154e6faa223067eb6b862e6a95c6de3ff479ca26ec50db055565e86fd504685f7cdb3e62b9ffadc5552121661aa615b225098d67e1217fd526f61d3b4e5df1db1c41072aa6c50e7ddcdb7215c7985eb1a5a334351076ba4848242e0b4f05c01490d3ae1dd92fcf45b7cba814810bd29a9cc799761a43f4974bbfb170994d7531a718dddfcb1a53597f1a302461b8bf04b6c2a49560067cfb22e680147af4373145285b02794a81f7a83a04b2a0c774b585f62beb582d851304c402e39f28b07e2838e9d7207084236ef4244a5f7e6afaaf3e1b5836f123485048d568c20ad5239702a937d6625ff630f1cf9234da652fdffb96460e6f09712ad24d0a07278a0dab19d21cb1251ba4d387f2d2c5ef987cb822bbc9fb5174ac9a559cfc8ec591704108652953e5fe29d9e2bab77439652f49f39b6c562d9716ee80a1e670df38ceb6efb5ff45f1b2cdb05d8a3d4be029872ac9f2367325876cf5698939860695f180826fe95ff8aa0a7b4ab0d6c4d54d76e635635c2c7fb6b129f3ae4c55806a15cc8f1a53ad7e526c068ab1851b0d09cad17007648a2dd19dc2a6b29d88403727f8afb431777f6a622e1f97fc3a5b87df925eb8154924b25fcc8a7519a5d1b534b8f6f47843e518a0bf86edf77a7f9a8f925b160ce3f3cdab876b77a4a9adea82f6f31084a590607f63af0c76c94847456591569a048702879808aec25636496483d61abc9d196c0e65b14690e6d805f602c92a6efb85c3e8dc339025da18807e32fce7310037b32e8b4f749e14068a9cf721b2becc625e569b8d3a5267b111ea0a7a37553b8724c9dc0df8d12316a9cbc3c19762535302e4316c8d3fdab3faea4693216c743a1bf127f2a31e1f5befe7f5b14c51edbb4b3b973aa6efec0532b6b541e0960adfcb4d4d571523fc245a168204cff2aa143a72080587e47e1785a4299a303f6b7f832d150a6c6d0aef953d4736364576cc172db58e1856f1dfc8f48252407a0562df6441c03aab3b3f79818e9b866f9a41e6479adc148075c1356fe21ffe74efc3b1cc608759aed03af96d3fe5217f97e22826029fde5b97b4f7792e63eff7d468a9d8e7e91a0685a63f19bd2b4ec3ceaa00ec7034a8bbe8156991da55e05512b31b6a6cd83164cee5d776c76a7108caa615dc80e338648e07a2c3b6cb97f599bff1db5ccb8275f196314117be24e372e6fc730773a52d71d5a01eaedb0cb70fe1d613a22664f93869705ece6db05a55a105c1ef496c432386d0a5925dfc8c2e6b28d45c90314cc4d55a540a7b6150f656c20de2135792ec189580823239a4dd6cd0e60ee929f6c6b5e823a00515320899f4612804a6288aacbbc32bddb3e6d8bf0debe4930ebf26e949f0845eb00ced04b4f461e1cc6478a4711a8fcceb9e91bb825f2d965672077b0710a5bf95ed2178de98f957912d3ff16868ec22c875988006fd60da5eb030297257307565b2f3327d1c14d4370b6af2690ff604c91f91534cb87ce259443969c60dedf2a8c76d6e9810164b39a556218eab1f1e1ccbbe89f9bc1456d00ced9ff4b2ff0063e3686fdc67c28a9f5280605bff26d48c7a0e5340a3c0f97047f6b790bd594a1d8e01082cfe25eb248c4e609068a9c5e2f3d5c80664fc3e6a21299266d626856743399638d6431120f16a313a879ad2aba2bba469a2748fa59c8a713f4d5e3f776f4dfb7ee8c99865fb34e646b1f30653dfd6e3a34149a70fefe2cf0934f32267408b78f7db229c0fc37752c65b3e7377fabaf6c92b44291b7cc0db4ed42214fb9ab44d76909d6ae161dd1b27121b1ed78edd62fcfdd35158a48a26a3c025d0998097987b7f43197898e541b65899210b96bf4489abf91d4b0422614b6257a153d0213c33fd487599e1f9a146496bd613f4c143bf702713e20b1b84e9aa7c2e31724f4a991248c29d5606c6c3869d9d217b25060cc6e11d2c5b1fc67713903dfe277033d8c834aef58e186363c482451eaf7ce7c980a600a7d1a1c1eb4714ba008ee657b7c0423d7a08a3bb11bbc92209bd265b6c567b855a7d32f38fc254a8cc8679dba1f59225ee2d314cc2dd24341a859e1058df51ff34d87dd8666f1172ce3931e7bbba7701d14cf0c5a2012842f5a801003db1956a22acb08dbfd4e441cccb34c80f27e265d610b968c41e615381e429e61c7dec16ae2fff3dd5b3e2fe1be13cc955ddee2af39381a710b8a3d47e4c31d1b31c70a04212cc4b57392e0f0381072129d6cec6c5715b7612ea118eef5da0a241bc5877fe97028cac35a0b4b6d8159e733b33ba30e03e5f68ab600b99de1dd0b8b85b62ca0a2619daa9e2fb3a25d1fcfe301b340d4adf234b227da56bc8b05c187e6b2e4d9e7003347716ec14553739e14e188f17bb9cfa17addc28563a47000d17fb46b925836902ee3b49899853772ada23222f018689851fa59f39f246bd8383227bd15d537d73a08e7f4631dc9d78af3a8bf07006e07f094037ce4f1aa619c17e5cde4d8cd7df0cdb1961e76deea37e3365dc01e36bac22408c18e35cfffbc739f31820a50aa9ecc8d2c870b813e5ac5d35b7beb24fd9c403d20407b259a0d2f455f58a753a12dc73281a99423a56996809a49f3630b5f061d5233fb7890ba19980a027956cbce6b616d098dd5a66d9f42fd6f016d46fc5ff5fb276c7dd90fc103c2d7febe2253cd01709fd70bfb51e3a2c6980b9a2226e042ed7089c3594a1e8577b474560c3c3824f29509800327128a38ef17535e7dbbe718421373f79a7dfbbfd96d861ee3b09bf25feef91e2f45914475b40d9cb5525aa31312621df1eb64e8475d340f18bbfd1ee75511dd6ba90181fe7b0a0980ced8fa4e77dfd9ea67995f4b3a8a3329c125ee5508c5731ecf177e94a9dff0ca22f48cc776561b34df8970f1c5ac16afa0a4d406bde6479a1ed909c3a73675e168daea51a42d46a6f1e85c295a524b5146ef15691853895b3e46589b6e7402f12532359dc0a839914d4fa9ad69df241ebf5138c60e447eb648fce30b4e2bd73a5c26e6f5bcfb9982ee942bcd8991c14e3384b8fa7a9a29879c53008a7f1325b4693d29b8fb3c052797066fda5eba0dae271ebdcb5efe45e5f97878ef32d105243c10e5cfe353d95c703d7bd86b73d7f8486fc7d898b97969b8191b48ca28354b052931772a6b61d7ff67b5f1dbae85a785d5e034905b7e438228def86830d37b3dbeb13b827d078d4087e90ae73bf46a71947b30a2b3cd4c0c386cb625f5c3b2c3a248dff8e68739524bfff2dbeddaac24b9f37e3722035859bc14067634eb8a9907fd618c28bc31ff9158ddb2b57041e827e200fb3303c36bbf2b5642e503eb9da93a0c5bf027a228c398e717a502bafdafafe58236a635d8540a80bd1b68a5479df0c21c626837d7423d6d4a5ffd0aadbfa872bfb3fbc766c537c5b9c0373bb725f5843c1dff14fd1da8ca92c13ec254762146e369f5f8598a7862974c94d035216250e34bd69a32180c703105303ee436bf0f053fc0aac4c6c955f726c04c21b3d9545eaaba5c35ea9ae4e36987a6991bb7d18cbfe63f2494466609dfd38eb729c7dc5e2fed41d42f1accb851c8f1698ca75ec472c9a1e90c02dbcf32d03ee5f34a33bd40ebb78f9b6285b53f4ac6aec725c394bec49e3507a7e3eea3c3536b7356db3a48f09e5934c768e5d61a81aff56698e4fa808c24137df5dad5193c478210be62a1dc6ea6f001913a9bb17f5d3715ec374ced256bada07d096166ea8525ccbaa52b186b2318dc8ab86d0e98ac2fc1393ebd2425e391789f24c92e8cfe8879c7e036eec9764a5ce6ca30884020d4179eaedbfb28c4de3ddc2f38da62b6499172472c35e0e746783489abb6f48086846e0a072a7d1a77e9ef4f150b382a95b6b6c68a50de545c25358f8b70af3d27acea50da7527d9a082225be3b88146a0b203f15ce96fb64df92bfb0d97395f32ba390db717b8e2215d2662bdb47b16050c8879b9bd80e029f5202f880989394c13e31476daed1b836ed2d3ba9afddbda26be182027ffd2d3804067ed1c41aaf79ee6aa9153b06bac06d03266fb2e6373f6160ddf83696142aef0a3f1dff4935212e9fbfa78cc3376f187208f70d1fc5aad62741766117e19e22282ab5df5965a1a224c83dd6b2dcbfa20104a1081b927e919e5714d00e0efecdc990051c359b77186ae72471fd466323b19d8033329c2ec6299568a941fbc19b9b006be38928fe761dba5100bef6cff88b861cfa0e9d9385f7cc46d855b918df65be97f6b45fef0eea439751613133786e3373c183d170ba9e542e27f4838ff1047dd8ad69cef341d0696d6562667d6b5be1461ff95932f3c4dee4ebedce1e13658350d30c0da41aebf295071ca50ac6d1890849f774c7fc782e416da18a244f096cee204c7954628bd41b5de60ed7e67d605e8e802cafa245150e45ce01f5cb59ba36c31c81e6e3ddf1d20859accd95f77c06666636767b9b7cb08566fc78d70a3e41bc0f7c2bff9e8581caad2214c88afcdf20df569a955da06d24dd34014535a26a45220dcfb4741b5c020abaf87fb7de17ad118fc8ed3fb5644b4429d4ac7f8e4f4ddb58eb5265cb6c13b82f7bbef7455489a5011e1b6b244eed8123432b759fdeeaaa0a7a0c8a9c18bfdba622727e26d71a22201c1056c38d0f15aa1ec0601fd8665326b0ab16a00c2c776580c92018bb9b8053a90d1603cf68e9cea36bc0128ed223745f160af594616981498473cc11edd9d795c6d98d8e52987901f9116c0fb7c17b22ca3015876d04869a3398e5459390f006f1e998e985ed9b66ed9d860ee0a088ace91d8de10627a8445cc08aefc37c2bed4c0f6e710828f01be1b3a4f8cb1c1b0e3b6dd89ad8cb6284223cc98217fd533280ae575560125f7fea1fea73b55100e900f9e6c1502f81f3ee689217e04b6a6a1fb4e243ca39cbcdcf679e86da1ec00f5bb9e07524d628d54cab3590a366fe6405342a1cd4a7cdcd34f3981a346259d33b37d7f29da4fd9f20f72659f7937decc6e6f9acb53b7c6f449d950c8014205cd9366d103fb0e526cbb15be3ed2f823317db0de6de363007ee5ab1ba2c109cef866d3119d34ce1e74af18283be6f57b86456492333280b8643493a241a40beeb81aa117c9e508794a17c8dc2135a43cf631391d2b7f3d7eb519a01bc67b5f4cc965599292d936c2c2d9affdb351edcd654447b5d083ca7d0b14fd58203e7a7dd46ef5b1538cbe38eff074094892ea2601556ddd9abb3e178b8aea36d88b4c29bc22a863076cc536d46a47e570a2a66294fb73356326ec86ae06176645687ae817ca5358bc0e66130e736a90c516e8206fd5c3be6dfbfb6f82901618384c393adff76d52514cc5c222049260a01bc83a05cfc0af6fca31fa1752db3351f6c39c61e8054ba39d6fc0c0f213fdcdb080567bd4b8d455237378d3507dfac1e9e503308a76c2e60b603958f20513474819748abd9346ecf98ee9940f02d4282575ae36daa5ee4f95d39c87751b74014d37a1276a88c6bc6757ece390a5a60094eab12e12da813262d0ba3e6c648ba660af579ad7b654f33f443bd72f1fb8a3daadf9cef0c0b7aea5aa9dbb375264f7a032bb6448868160abeabfda2d3a1024cee962bae4ed3d8026dfb91303c500dfa12698fa1361801bb0c04e1b803b351a37f27925455736211f3ab0c6fab4e22f689ced7b455c0b1ea5d1c2e6a4fe85dcafe01e45eec4577ccf86ec734fe07a54f8af6811df80798ebbeba9e3f5fe9a5ca8998615033ce3e839d845bd90d4168dc96f73575c6e072bf798a1eac47668a1458bedc1f3385b1db1e6afe6a75ce07c203714ea4142831bff6ad4fa96921fdc668b683f5942018d94bb5009d7137826dacccb410e5061fb6ddea3d778dd3bafbd59ad2c1582c6fc2f5f6a31c98ede5593d1f47083cc70cb273c3e3d3a3a4d392dbcfdc0d0418925a53c2188f1fcc5adc81f53347d7e3ce3b969977d7a76613e5d61bec3e98e856a222686c6d57c9a6978d872d1d9f00c416e67291a6f8f05f5ec49e77efbb857168644ee821bdb6de9477507e32f631596454f79d7b3628c69cfafbf148692f80ae464f107e7e89bb5753ed96483610a1a6403a88c24072e4a08a60f76a0b01bb86b37aea36d5e38e9829a52e0528930ec42dde62c6c597faa82cc43822bbf30cb66cd3e1f8f2c5b45b1f7c543037a927c18bd4cf71d2a3a5527011f23a2ae640bc554645e3cbc04b6a4eff14e23ed0e980de9c6d64ba2197b1b028e0b745ab0667a8d62c1731fb61b370910a3119c144a86c6d34a739c885524d757a92f39e63388ea49cc6a4d8d91165a003bfde40870581f3a956a3b3efd05101eed1c0fc76d1490e0bf4bfc9d4b489c42e3e227ae12feac4e8a2ec4bb55830416fc6e3fc24603e44ce4b4b92acca09b2cc4bbc49f617b7e3729d3a375952528b731b6fa726c7710c66a3e924091d99e4288e0f7ccb502ac0089c0da8dce5dd0d5354f00c955fc57f59a5ebc74b5267cb2cd161328cef3bee63ea3a0fa1acae5c899e9603088451c865939d3c176c90a00673296e4184510fe50e6ee78a6905b98fe77624de2c009e2cf28ae6130f7571a2657d62f1f9ecfa9d63690d01de63517ff92a0b48f5dc85d097b94f877873acb97c02a942cfb691e44dfa149aa2a2db102160639584373559cf49be8e5c59709c99507a8f71e31547432ca20fd2456a15a4938199b578af2feb4a70b88cbee8171920e09c0fca1a3705649247cea88b1e874a0d38bd6ebb6210db0001c6e14b1740759dd6da0ac309ce7b0a606662bd56b7a2a4315758e8fa92f002dffd2ce2e318dfd6c8143c5772f88a7908fa3b287b2c310f42f0ef4036ad9cb52b12d6f9e605905f3b8d3b07c4e927093c7253b74a2505dac7657471d3220d8855f4445fb4f450d74f866ec2b8c2a515b976b7ecff2a56e0776e07a36911cc35208f4200befbacc0b20c40306e36a63bf21f6f74303e2ede3da56d49f7339941b2d21d2c454e1733ac4e7e37fdc4c2328ca7ff2d71b06446bb5a3b9a87e5d47b74880f9dfaeec10cba6491b80772c372dabd7f209ca5529eecfb09df1a2cd794238ea06d93a53d09d56efc1add4eca2dfc9d1e671968f86338604b9a860453916071cf610fea9077d780cc512692e84a567e8a83a3d8fe1d630ac4543a484db1800d8fedb25e076da325d6d4b8b25f2d3be64c0232e369f547e2cdcac7eec420ca52557009a6d793ba15fc94835da168c9fe743a6e1b3e513e2276bb574755815f1ee347563619e54d757ac33356204290b8ab5caa0912279cdaecd87d8f9defc1450190a92e9e69d7d24ce6e04c774de850a8458b1382f146c3c351351355c837ee7d9d59f30132ecf79e80c2f101ef469bee701a8f789ae200f1cedf12d9fd52d7af809d19e12d86802031ec5b0e76d55167ac6506843f91ea48a8d644de9543b55232ecfe5931f24503937367d586267e6f378d959c5b1c520e9e57d3817597f7c61ec8476b6341782ee8d3fe2836392bb6f8f1880b405de267a90077637956559f17f8ac697467cc020aad745d6b8417bf289f95e2f376eabf4b569e77006b1f18539750a1d452e5521131c1194fa823f331d5bb6866c1871a7842c42cc1ddef202f3800f264c5f02282adbdd9ca37338aef26c69a4e3f23b20868e310692cd2a0015a6872be2490ee011f8bf3f44fb5007758f2c017472545b7029b0f9fd7c03d5c11bd7c57b75cbf7cc77ff58c698ef34201da514802049dcf4add3930c0818fde4fa9f2473e30434d1429d74422d31b74edfd8e09898e9097d6e7934ef3974a128049a369b733b75108594246ccb15fb1e311d8b5f8a20d5b83d659135f74a4bfe8c0030d6a678454849cb5cc304a8f6ac3d1cab0e7c7b344b101d1946dd37ebdab5d4694669e7b3d922d884dd464cf96973183af6bb369fdb6473a3980ded6842939bc43c347d5424ee1353a0034dcc41bab518f828700cd5910721a8dc3acba950dce3a041da50670b389d3be002650a2b69b827c51296545a5c3edadca642325ed8a34103c41baa43280c5eeeef5308f87499d147ed48a3bbefbca0b4791f0a5988de952ce7df27d80f80ca561f52753426b623a4c794b8e3c0432c9a0d3c98dd2c43ef788842556437bc47eb3e2d1f4c35f5b01af143361b5f73aacd2ae3aa09e3ea3f61417ff3b2d3e465536ebf6c1809f7f70a76fa2cb26600c7870eeff29f118746da86ba2f7a3cec466e9e17debce578c2ee4ed26c6c5416535664bc1d6b1ac54f022b5f3abfdf446df93306de56b9f8f4db195392cab0f17e9ce8ba255cf557522aeec77eb5f689e0f4968972d8614f03e37125a4bed83f89078be4ff098b64d898b0a4e8438feb051ec4ecaa6a301ab7eb16678e5d707a8026ca8ad07fc66b5313367e025bc293eb40cd7165015a76c62e5ed43f488a94d50f020c45614b1ffec7b4ab7f550664a85cc4672ba87b258b4a0ec7b31c1ed16171fd7c9c0a423d2ead68461bc407969d774d06f3dc119b7027d08b5ce13d6af2e3a69db758d3bc9e124a59e1048e731704f00514164865646ca9c6127cc5556d2e895dc4cd3cc1fa4f04e687ee3f64fe513aa70da54afae26d4da4f11472154340ba51de794510c853ac318a4973d8229535ff52a74740a27b8b45392741fafc521ba9a1511cbaea42d578dbce3c8c1bcf899971d30eb605acd43a551c17f9a1c8b203ccc61103c89a5b4056e1ee9b2b215a646606baf1218afbfac9a0bee95d4b1947e370c2764e882cb8fe78db291b28d350565f0b614a09d059e54596440a8d14a55058eaa0a64b5409b01db2b69c6607eb81292df61d8603495613b735d6710d4ec1afb55dafafbc320d7333555ea321f83271587d2c33428867de56c2cef71fe2b75a7d9b02280cd881ec93e8ff54147fb8e3249e8877e793a44e905d9e414c3a56f6b8dff603f56e6394ac494299849ee2fc563e554e12e623f1a62d82ffb1099fa1303e0229939dd6f319aba86e470df1413c0e02642bb805a4e0513261687e6241befc29d09f2638240dc88f73daee61d57c77fd73cf3cb4583756b085653c32cc967480f0f385241e4cbca21c7971e927860c838e7e116c4f58179a6e4f040589d2c1a758e43838b14ff91a810cdaaf60fdf68ca55f2ff41383dd8b9c332e8ecc42eb60169cfe4fe2502f3d7631c3c90c783626da012ad21096a0e096bfe7cadb3ea3fd7fae7727633219454fab8b69ae0b1c17e4e3ac8101dca5d152fdafc2ac74517b4767b00a27894bff9444d75fa3452cc684ca8733ff49307e4545f925f1f3b0c9488ea08e480627ded226f67655c8f330cc1bb94b15ca3984b9bb9a555c1bc71ca84d106bd86761339626f74b542bf0c9666b02bf86513a6b003a64158fec3601f0407acb943bc734ab2636cfda177d81c3def485202556d57164159159539682cc4e09b5784bb02f57a62865b92f1e965e33ce8d86da63ed6ac15a53204a706d35678b6079fbeaa63424ec2749c248e6563b14c353ca162577e29ad43f3fa512d0fd02800ae83b3a36b82cd24ffc0cfd3de9e840c2380964c581f9473125f9cd2c49da573a6c680cb590f1a2036e0f51e05540b3e5967ae650f256a228de75e882c7efa2637173062063569d91eaaefb209c13bb507d304f56f215c891eee4eae0ab88d69060ed28fde253504e98ca481ded2df49aba74013f32ef7924d48580c19596b35408ce2c29916dcea9e945bf76d7cb0fc0cc0e5e621aa6aca0bfab8636b44f8550be99cf4ecf4c50d59cc069bcdb19f30dfe0835ce1832444f618a7d3840b043d0dd016d9d0ad7ab9b642e6dd2e5741a7842ff64f5407da9679c54dff0d071a356ee91b6bbcd8eb76563aa748258bd10eb1aa6c3c08a6f7f94d3d8e43d0b22f75ff06922a0cd98e81abd2f9f68a7c4bf07ec3b1e896242cec1ac1c978a3dd3313ff12b1b78ba60b81d4d751a8651ac71c9810ab7db8b8367a1e59f66b35e74d9fd34b47ac0b1809a3e8822dd5bb5d8528f1d96937a4717bd151e47ce6236fe90c5e4ec4944de4dbe3636e48df352f9f4b0349c924bbb49a352365c1c32ff126bf3c0caa651395e26d51683e45d3d99d874d0171f7d1d4255d571fccb829438c3ed9470978fcfeeb9504755aabc198676278b13f076884e7ad52ca951b21887dcf1d5b7512d6661c55a29e971469d42341d63367b4ea3177f9b1cc3f559a027b122e1dad4b674440e7ca77228276f0db5fc5790d1fe456468a1ea4ad7735f798e5fc1ccb1e458b34a1c22aa679054ef49f3fa8b98fd3a730dd4c20de790e529a4b28a7327b5193c5457c29ff64360bf2d88aa0bbe6365a4cd669143398bff49db8f9fdec83e82c158e71ef9b2d73d1165735fddbeadca8f0d1da0984cb4a41b56b2cfab7f67f11f400c5640075bb28e7b05189e08065c75c7024fba588498caef5437a21a3828375d5ec3372770db649d793ad1e6a5c9d404afa0cc428139d86e8db690a44ed7ef0fc15d4c194679b814849fd311ac00a6c54501c3da341680d0e71987ef6383f4c4bb9368af8f18258bfe1b48f497947f11d94a11145f4d429db3be97cbb47eb92a82a72ea30e25f7af238a3347eb16fb53da0eca9bf66e7ef305675c3e5363e473aff8b3b6c7458a8a4d1d53f56e5454a1eaa29170a9de05001fd4038a1e8566acb59e3fc463e28aab361edc5a6df362cf5768cb83d847ccc3691e5f08168f129c102dfa66e696c6c33a53ca3313d6cb138c852311c735f121d5cdc82e536b1ff71e79d68c39dc3767758ff3ec80fd792cd108283b6d74000b394ee36c0458c25e458e0c653ff128a6f202a54fbb054ffdd618fa0be0859cd4eec7803933fd5147861dcdd6b859376cfd7c4f3f470250f24819caf1dc9df7be6ada7e95edb269ec35ffe0744d4fcea2c0a782122e573332de6715fe02c990251c4e7c1175f4b2be86574ce908b4399716941f85741bb93467f7b1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> test </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 网络流 </tag>
            
            <tag> 莫比乌斯反演 </tag>
            
            <tag> 二分 </tag>
            
            <tag> 杜教筛 </tag>
            
            <tag> 优先队列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>左偏树</title>
      <link href="/2021/12/19/%E5%B7%A6%E5%81%8F%E6%A0%91/"/>
      <url>/2021/12/19/%E5%B7%A6%E5%81%8F%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 考完学波数据结构</p><span id="more"></span><h1 id="左偏树"><a href="#左偏树" class="headerlink" title="左偏树"></a>左偏树</h1><p>左偏树是<strong>可并堆</strong>的一种，可以在  $O(\log n)$ 的时间内实现堆的合并，它是通过额外维护一个<strong>距离</strong>并保证<strong>性质</strong>来实现的（有点类似于点分治找重心）</p><h2 id="定义和性质"><a href="#定义和性质" class="headerlink" title="定义和性质"></a>定义和性质</h2><ul><li>距离：一个点的距离定义为一个点<strong>到离它最近的空节点的距离</strong></li><li>性质：每个点的<strong>左儿子的距离一定大于等于其右儿子的距离</strong></li></ul><p>以上就是左偏树额外维护以保证时间复杂度的信息，不难发现，这棵二叉树（堆）的<strong>每个节点的距离一定于右儿子的距离加1</strong></p><p><strong>定理</strong>：根节点的距离 $dis_{root} \le \log (n + 1)$ ，证明如下：</p><p>设 $f(k)$ 表示 $dis_{root} = k$ 的子树至少包含多少点，易得， $f(1) = 1 \le 2^1 - 1$ ，若 $f(k - 1) \le 2^{k - 1} - 1$ ，则对于 $dis_{root} = k$ 的子树，右儿子的距离为 $k - 1$ ，即右子树最少有 $f(k - 1)$ 个点，而左儿子的距离一定大于等于其右儿子的距离，故左子树最少也有 $f(k - 1)$ 个点，则 $f(k) = f(k - 1) + f(k - 1) + 1$ ，即 $f(k) \le 2^k - 1$ ，由数学归纳法原理， $f(k) \le 2^k - 1$ ，则 $f(\log (n + 1)) \le 2^{\log (n + 1)} - 1 = n$ ，可得 $dis_{root} \le \log (n + 1)$ </p><h2 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h2><p>有了以上定义和性质，我们来看看如何合并左偏树，假设我们合并的两个左偏树的根分别为 $a, b$ ，进行如下操作（假设是小根堆）：</p><ol><li>若 $b &lt; a$ ， $swap(a, b)$ </li><li>将 $a$ 作为合并后的根节点，并将 $a$ 的左子树作为合并后的左子树</li><li>递归合并 $a$ 的右子树和 $b$ ，将合并后的树作为右子树</li><li>若右子树的距离大于左子树，交换两个子树</li></ol><p>可以发现，每一次递归，两个根节点必有一个会变成自己的右子树，即它的距离会减1，当根的距离为1时它就没有右子树了，故时间复杂度为  $O(dis_a - 1 + dis_b - 1) = O(\log (n + 1)) = O(\log n)$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LeftHeap</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, v, dis;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) lh[(x)].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) lh[(x)].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) lh[(x)].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dis(x) lh[(x)].dis</span></span><br><span class="line">&#125; lh[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y)</span><br><span class="line"><span class="keyword">return</span> x + y;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">v</span>(x) &gt; <span class="built_in">v</span>(y))</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="built_in">r</span>(x) = <span class="built_in">merge</span>(<span class="built_in">r</span>(x), y);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">dis</span>(<span class="built_in">r</span>(x)) &gt; <span class="built_in">dis</span>(<span class="built_in">l</span>(x)))</span><br><span class="line"><span class="built_in">swap</span>(<span class="built_in">r</span>(x), <span class="built_in">l</span>(x));</span><br><span class="line"><span class="built_in">dis</span>(x) = <span class="built_in">dis</span>(<span class="built_in">r</span>(x)) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>左偏树的难点主要在于应用</p><p><a href="https://www.luogu.com.cn/problem/P4331">数字序列</a></p><h3 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h3><p>先做一个变化：令 $a’_i = a_i - i, b’_i = b_i - i$ ，这样，最小值不会改变，且任意一组解都有唯一的  $\{b’<em>i\}$ 与之对应，而变化的目的是 $b_i &lt; b</em>{i + 1},即b’<em>i + i &lt; b’</em>{i + 1} + i + 1$ ，故 $b’<em>i \le b’</em>{i + 1}$ ，我们把 $&lt;$ 变成了 $\le$ ，为了方便，以下不会再用到原数组，所有的 $\{b_i\}$ 都指的是 $\{b’_i\}$ </p><h3 id="转化"><a href="#转化" class="headerlink" title="转化"></a>转化</h3><p>考虑一个子问题：若有 $n$ 个数 $\{a_i\}$ ，求一个数 $b$ ，使得 $\sum_{i = 1}^n \mid a_i - x \mid$ 最小，即在保证 $b_1 = b_2 = … = b_n = x$ 的情况下求解原问题，明显，取 $\{a_i\}$ 的<strong>中位数</strong>时最小</p><p>那么再考虑，如果有 $n$ 个数 $\{a_i\}$ ，其中对于 $\sum_{i = 1}^m \mid a_i - b_i \mid$ ，其取最小值时 $b_{1 \sim m} = u$ ，对于 $\sum_{i = m + 1}^n \mid a_i - b_i \mid$ ，其取最小值时 $b_{m + 1 \sim n} = v$ ，那么该如何合并 $a_{1 \sim m}$ 和 $a_{m + 1 \sim n}$ 呢？分两类讨论：</p><ol><li>若 $u \le v$ ，即满足 $\{b_i\}$ 的单调性，则两段分别保留自己的 $b$ </li><li>若 $u &gt; v$ ，即不满足单调性，则使 $b_{1 \sim n}$ 为 $a_{1 \sim n}$ 的中位数 </li></ol><h3 id="正确性"><a href="#正确性" class="headerlink" title="正确性"></a>正确性</h3><p>第一类正确性很好理解，下面证明第二类做法的正确性（即取中位数后 $\sum_{i = 1}^n \mid a_i - b_i \mid$ 最小）：</p><p>设对于 $a_{1 \sim n}$ 的一组最优解为 $\{b_i\} = \{x_i\}$ </p><p>若 $x_m &gt; u$ ，则由单调性可得 $x_{m + 1 \sim n} &gt; u$ ，由于 $b_{1 \sim m} = u$ 是对于 $a_{1 \sim m}$ 的最优解，所以用 $u$ 替换 $x_{1 \sim m}$ 仍然<strong>满足单调性且不会使答案变差</strong>，故只需讨论 $x_m \le u$ 的情况，同理，也只需讨论 $x_{m + 1} \ge v$ 的情况，因此只需考虑 $x_m \le u$ 且 $x_{m + 1} \ge v$ 的情况</p><h3 id="引理"><a href="#引理" class="headerlink" title="引理"></a>引理</h3><p>下面证明一个<strong>引理</strong>：</p><p><strong>若对于 $a_{1 \sim n}$ 的最优解为 $\{b_i\} = k$ ，则对于任意一组解（不一定最优） $\{b_i\} = \{x_i\}$ 满足 $x_1 &gt; k$ （因为单调性，其实就是 $\forall i \in [1, n], x_i &gt; k$ ），将其改为 $\{b_i\} = t(k \le t \le x_1)$ 一定不会比 $\{b_i\} = \{x_i\}$ 差</strong></p><p><img src="https://s2.loli.net/2021/12/19/Pf8RZYa1NjA6lGq.png" alt="引理1"></p><p>如图，将解 $\{b_i\} = \{x_i\}$ 替换成 $\{b_i\} = t$ 答案不会变差</p><p>先证明：<strong>将解变为 $\{b_i\} = x_1$  答案不会变差</strong></p><p>考虑将第二段及以后的 $x$ 整体下移 $\Delta$ 个单位使得第二段平移到于第一段水平的位置，如图：</p><p><img src="https://s2.loli.net/2021/12/24/wC8FrZh2pBdnf6a.png" alt="平移"></p><p>考虑被平移部分的 $a$ 的中位数，设其为 $k’$ ，若 $k’ &gt; k$ 那么对于被平移部分，取 $k’$ 显然比取 $k$ 更优，则与 $k$ 的“最优”性质矛盾，所以必有 $k’ \le k$ （此时因为单调性不能让 $k$ 等于 $k’$ ），因此被平移部分至少有一半的 $a$ 是小于等于 $k$ 的，我们将对应的 $x$ 下移，会使这些所有数的答案分别变优 $\Delta$ ，而另外 $a$ 大于 $k$ 的部分答案会变差 $\Delta$ 但变优的比变差的多，所以总的答案不会变差；以此类推，将每一段都下移，解不会变差</p><p>然后我们来看原命题，就变得很简单了，由 $k$ 的最优性， $\{b_i\} = k$ 一定比 $\{b_i\} = x_1$ 优，而 $x_1$ 越靠近 $k$ 就越优（准确的说是不会变差），所以取在 $x_1, k$ 间的任意值 $t$ 替代 $x_1$ 答案不会变差</p><p>需要注意的是，当 $k$ 比 $\{x_i\}$ 都大时，结论任成立，即上图的情况反过来也行</p><h3 id="正确性2"><a href="#正确性2" class="headerlink" title="正确性2"></a>正确性2</h3><p>回到刚从证明正确性</p><p>刚才已经说过，只需考虑 $x_m \le u$ 且 $x_{m + 1} \ge v$ 的情况，即如图：</p><p><img src="https://s2.loli.net/2021/12/24/ECdGHrbvgMaSPTw.png" alt="2"></p><p> $u, v$ 以 $m$ 为界，分别时前一半的最优解和后一半的最优解，红色部分是一组整体的最优解，由刚才的引理，红色部分可以替换为绿色部分，解不会变差，也就是说：<strong>存在一组全段都相等的最优解</strong>，明显，此时应该是<strong>整段的中位数</strong></p><p>于是转化的做法的正确性成立</p><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>下面考虑如何用左偏树实现该过程</p><p>类似动态维护中位数的思想，我们用左偏树<strong>维护较小一半数，其最大值就是中位数</strong></p><p>设当前段中位数为 $u$ ，新段中位数为 $v$ ，合并完后中位数为 $w$ </p><p>每次需要合并的情况一定是<strong>新段的中位数小于当前中位数，即 $v &lt; u$ 时</strong>，则易证合并完毕后<strong>新的中位数一定在原来两个中位数之间，即 $v \le w \le u$ <strong>，此时如果新的中位数是新段中的某个数，由于新段的左偏树只维护了小于 $v$ 的数，所以我们就找不到 $w$ 了，换句话说，</strong>在没有限制的情况下，直接用左偏树维护中位数是不行的</strong></p><p>但是，这道题还有一个特殊性质：<strong>每次新加的一段只有一个数</strong>（当然这个数就是中位数），换句话说，如果 $w$ 是在新加入的一段中，那么 $w$ 只可能等于 $v$ ，应为新段没有别的数了</p><p>但是又有一个问题：如果<strong>在某次插入完后，中位数变小了，导致不满足单调性</strong>（换句话说，变得比前一段小了），我们必须<strong>合并这个刚完成插入的段和前一段</strong>，此时这个段不是只有一个数啊</p><p>同上设原中位数为 $u$ ，新中位数为 $w$ ，而这一段的前一段中位数为 $k$ ，显然有 $w &lt; k &lt; u$ </p><p>我们考虑到，这一段插入了一个新的点，<strong>中位数只会变化一个位置</strong>，换句话说，<strong>在这一段上 $w$ 和 $u$ 之间是没有数的</strong>（ $k$ 在前一段上），而 $k &lt; u$ ，故在这一段上， $w, k$ 之间也是没有数的，所以这一段和前一段合并后的中位数要么是 $w$ ，要么在前一段上，不会出现在这一段上且大于 $w$ 的情况</p><p>于是可以用左偏树维护较小一半数来合并（注意维护较大的一半是不行的，因为合并后中位数会变小）</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LeftHeap</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> l, r, v, dis;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(x) lh[(x)].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(x) lh[(x)].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) lh[(x)].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dis(x) lh[(x)].dis</span></span><br><span class="line">&#125; lh[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="comment">//终点,根,大小</span></span><br><span class="line"><span class="keyword">int</span> ed, rt, si;</span><br><span class="line">&#125; stk[N];</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x || !y)</span><br><span class="line"><span class="keyword">return</span> x + y;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">v</span>(x) &lt; <span class="built_in">v</span>(y))</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="built_in">r</span>(x) = <span class="built_in">merge</span>(<span class="built_in">r</span>(x), y);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">dis</span>(<span class="built_in">r</span>(x)) &gt; <span class="built_in">dis</span>(<span class="built_in">l</span>(x)))</span><br><span class="line"><span class="built_in">swap</span>(<span class="built_in">r</span>(x), <span class="built_in">l</span>(x));</span><br><span class="line"><span class="built_in">dis</span>(x) = <span class="built_in">dis</span>(<span class="built_in">r</span>(x)) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;<span class="built_in">v</span>(i));</span><br><span class="line"><span class="built_in">v</span>(i) -= i; <span class="comment">//转化为非严格</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">Line t;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">t = (Line)&#123;i, i, <span class="number">1</span>&#125;; <span class="comment">//只有一个的当前点</span></span><br><span class="line"><span class="built_in">dis</span>(i) = <span class="number">1</span>; <span class="comment">//当前点构成一棵左偏树</span></span><br><span class="line"><span class="keyword">while</span> (top &amp;&amp; <span class="built_in">v</span>(t.rt) &lt; <span class="built_in">v</span>(stk[top].rt)) <span class="comment">//小于的情况</span></span><br><span class="line">&#123;</span><br><span class="line">t.rt = <span class="built_in">merge</span>(t.rt, stk[top].rt);</span><br><span class="line"><span class="keyword">if</span> (t.si &amp; stk[top].si &amp; <span class="number">1</span>) <span class="comment">//如果两个区间都是奇数,合并后要弹出一个数</span></span><br><span class="line">t.rt = <span class="built_in">merge</span>(<span class="built_in">l</span>(t.rt), <span class="built_in">r</span>(t.rt));</span><br><span class="line">t.si += stk[top].si;</span><br><span class="line">--top;</span><br><span class="line">&#125;</span><br><span class="line">stk[++top] = t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= top; ++i)</span><br><span class="line"><span class="keyword">while</span> (j &lt; stk[i].ed)</span><br><span class="line">ans[++j] = <span class="built_in">v</span>(stk[i].rt);</span><br><span class="line">LL as = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">as += <span class="built_in">abs</span>(<span class="built_in">v</span>(i) - ans[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, as);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ans[i] + i);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 堆 </tag>
            
            <tag> 左偏树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/19总结</title>
      <link href="/2021/12/19/test2021-12-19%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/19/test2021-12-19%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="ca7303d601583827fbe37db72b05acac9cd6684eeb7d7663a85d99a869647563">91be494885fcda4e29aacd3585d6ad0f9671bf376ac363ad849f2b49266f11332f27b83c56527fbe0bb90b8f746cb7822fbeef229ecf425e711ff17985d47a9fd3380276f417a31ec84451ec64a0e18a418f967ea02fc8286a878fa6e5a9511821964245a5f53d23e31bab838e6dd12e8ac61931db82c6128f71f79a544f8fdf02385c7a0f81a0a2b3f3a86b5fc271fa996c9e45143ba76a1355879b1e2f0abd591b740484e01329e0853e72639b280a27c54e2e6d1a2c685ec24160993189fbdbb4f0dfb6cc3e02a70696bec3ca2796eaec945a746705dbd403b6d311207df0eb6034b43548693ff1a6c8c65ded56dcf3416481b7c1035fb1771a191721fd42052023ebda3e08a57f624118318769fa35f4466d8f5574f2114c4fe7daa261acec91bc42fe28f3c45313d5aa36408701e5425d7bf96ca20e976bd99144cdf33b7cbefd830b1b8ea59a8ed32668d0f4f552978cad228781c29b62a22129363846ace130e49c3590d6d0976436b77d3354740e1a6380cf200184da773daf6d63fb2ab20f2c6e6675a28d23aa95f4a1991f986716b03ce8cf77f7a18dd2ccd591ef95553e7fc85d17c05c58b3a1c71febee4b47648e30d1b65ad36fe9981a4f0c2b8917599eaf99dbc28abbf8bc1ef780b56f37fc1f2966c5bc07e9eab55881b338a78457fa2411bbc1d0cc51664fde312cce0f2370ad10c638d3e664626d79cd41bde87dba2c5afc8f733f904d59de2274bd3f082212d07152d1d50eeafcfa331180409bc5b7467b5a9f8e43e26cb20db73b087a3fbdcd70526a58d7e0805621fc6ca864053544fc0bf1105b29b2a23e56ba19f4da3b5cfb1837c1f63268165e8089e0c02102a2f1f9a87cc94cfdfbf3abd087ec76de5963f5ab2ecf2602ecf336f9ce003024756bcc61495b1727702eb09202261b01099df97d7281afbd1be6c63b716f1bf0304573b4030d880d6963b91c3b92f3034c97db1f594fa829f75c85abc015825bc26c76a79271f58a07d9b39c3293d76c2db881190f2ad50e4a9f944dcc61e69eb3dc13e81aa69027df6341980a541c2ca232a48a3354fa65c9e9c93800e9be1ee80ca13765c00b4ac175ac744f028ec551498f5d5821315286276caad2b6436d391e25f850f35b2dcec6534a1e12f2f2c08eeb8c5d3c6fcff26693b112b546945607f668e6ed541ff9e0212fcdc3ca9ef42563d33a76debe1a628597769a2174b5171e66c5640776bd9f41f100e9cfc29d0e4f7e642618423b8b237f06158c956070f08c4f0b025ba35e48787920fd4a6c4407b9a673f874dd30cddf2bbde1ac551ded489d9348c66f9a3b587ce3c831b05dba38377ec022c55172b40aa344b49c2f93d904c3106c7332a3ae8d8528fb12dd00fcf53f2a5bdce2c018fdc751779dddd7a983e4cbef804651928b924fe7293f8c3c5b272fad78a8858ed02fcae17d818e3515e05d2ba492d8d2d963e27e46b866d69c9e066882f8ef142be5ac8abecab503dbb49acb4b985720a491ebd07e575af6fd4e951d0db2a2a85e6a92d27491a7ac80438135ecf8171c90114eff0b55cecb7a9e09f95111df1ab9e4df5c462f7625c7432b9791ae9e2f05fa1b13a1f8932e047cf1295909057be38d162a3d486fb7ce33a741af0b10f00d646cb387034e0d11360abdbdd314f6522a4a994a98c1d8e5df826d26688ce3fcca95bfd91bf75fec553deb15421304c509c4b3b2ef5841fcde5f5cd4404250371ee583df83f4d2e10ec919ec6d5f7de28713fdb795c3678ec48114a806917ecf92986b808f9566d806aaca1ba4174e69db60399be7c7cea3d8b6689eb4406dfe151781b0df2e1d578047cdba291bc527a7d9e14a92b7cec00c41fe044430bf62c5391fb30f5a6bf1e9f40283b38903ab14d070964bcd808e5b08f0ded178e12ed2a7e4cf371e986ce4c8459c025a38462187ac501e3109b4050199d3e9ccd8694c4b3b650588c7790fdbfad288839602397cbcc46f5d650c79c4cb461a37909d0c167ee1ea930b4a009ab8ce040fa200283acb8413cb0401e9a42e5fb69c5327e49a7bf8405ae8b3f79ca763f2876533c7194001ce1717eca666d39a59e1f86c708937afb2820ccd986ec9449a20eed7e060ef511eae6871d1a88069a919a84fcb451729010a26582add7c8dee8979e6413b0dac37b03e6356d41851ee4c6028e919ee840b05ebaea20d9b4889484b9a1de24f31e4288d2db84af7089d3fa4e885c78cc3dbb1348782ba283417fc0f6c5465b19ad1131684f27fb37f05ffb05a8f1c948fa24ecdbdf32dea776c3ff51d5fe05ac5e82b0895f8252d5016aa3c82bd3fde2c82633fe06b32c2290cf886f04c99290fef0a6158ad4bef23785e8d7ec7a8bf2534b0ffcfbf666b03e8f4cc01fcb53dfaa65b83ec2f7766f6b47151a031ea39db24b7a4b2e2b30104abe41c18eb33abe7d5c120813ec17ab9043afab05d01a7eb7217b47a5f8a9988f84eb4dd4ba19e12de6034084d7e6d0250d434f8dfee7bd8b12094dc7882ac866c0b768ca1bd00f188d3c966e5e4da9cd4a607f92a39b6e77bdafc777ff9df5e0d6bc6fc67a61861f297f23f4969a812e85f20ca126cc96dfbebed5b5448c5d702e844bef580f235ed1337032bfd37101a66502b1a471b252fc23646770f624b1a1b498b500b18fcb15c5282d85877910954d5075fd755f538ba14a520e5f469b3054fdf2c699812e88d418d7cb9fad4e766dd446e362639562b3bafd09569efc23db98b1f1f9f8b6f8ac80e7f5d237eb6cb04919a5401c27d83207ed12b14ab7d5207266cb96aeafcc5aecc37e8c92adf6c72ea40cd92b126146cfa0480d211d4a455fd79511fa18696af1ae076d2f5b04feb68bb9c93fa63094230a49b91e7ab4afda12b4d77e713827f6f15301c1777a35c3729a470e0c9f3473b5cc5256c7214b9c26047c72a5593f5e0cec7386bb8b2185a1209e14f1880ae91d00b51fe8d17d0a9dc59070c541ce04bac5d08fedb6ca0dfb885a91803293df8b523430e2ce2695322db3d983d4b925994cf0b90a260b23ab8242ca0a8b067bb6921d33747fa4b97e3865526792777b02dce59fd044fc4aebc02572b1bbd885d6e82efd4f33038f880b0bce29e62b901f6f35ff3d6d22f669058b3c5c178456753847b406c645e43fe598f5d3c3ef7e207ac72f10a4243255f5b7d8d08071c881862d8b49a2fbed4cde13fa1f02a2181d7b4aa7644acef6726fbc519eb32c4ff39b2137cdf9359f8d92ea9267c56c16ad1691a883440f840131bb5bff18ed7e6909d6923ed838f0e40041d163495a48e6dc03d48a363c2afd24b965a14761895baee87b8bbc013f464bf27432459a1de00c72c72f92a86e4e2392a9d56627bdab7911d50dc39f828f752082667a5d67f4f3430487c98aa615bf58ded679cd2136ee4644a46998c61e256228b199b71bdf323366d0f462a1e176f6b7f4f621ca86a67b3cbee71b7c98008553c875926b435f2fa60c1c10015a8b68a14bdcf2b9c5238e02edcaca01379254704e50bc628771ff037dd6bb41fb468740d17031337786a90207e28a0003614e155a25ba59d8e3dc9792b56a30d2c7629e6828e2d104b7eff4a4f29e3a73f7cbd680a90bedc0b1b385b44d93e00a173ef1933db507da7c3bc7290537abdec42b11df37c89b8cd0f1187cdea7ff44976178ba05970fb02958e5fe712f8dd69f0fee3c20cecda60717e8884510ad39c4c40943af7294fceed62822b4d24cb7933b9adf212e1871cce41110fb66356599adca0921c716b170307045e4c1eacb855ca66d15eed6b7fa326727ffb47ecba48a88530774217abb352c465008f436735a241e0bde1ecc7d9d25ce03ce8614719ec24ccbc839abc76aff3bab8a0bd1f158c0078b52f40073c6246117f76e3b37ad4a34d92e85b8f21975ae8026a1bedf5cfb7e41b4c41894eec90c00512818320b4cc73cc8778cdfee809470149ba316f9785b408ee476f09884db030384da82996c2666db17b62b92fa27123ec5d876098881ab2a8ddab888d77fc31202587d8154c7027739f32d24957554b9275997ae1aca315eb96c7aec83ac0a30f776b69717574db7f2764bd6398af34a0b9a07e30d9e4bb6f121ab6ce0855b057bf27c134729eec14fbcaa7d9a691bce358a02bafc1f1ef755ed2e980a999711d8c39965557b2800fb34341e8abed70de9582597342cd19da9d418a7a1a20dcebb535c05d2ccf07d7ef5595cf3570c96391eec5bce9fe0329cf3a6807e3f92595b6459cddf92325e1b41d6bab5a6a5403a54cbb966f737a4b6e4e0b0b2664e7a7b73d4356543ce294035b50ddf5eeaf4e495a183efa99a8d9cb182f774bbce52257a715d7df944d0cf1b7efdbc1a669a49d1b329491970eb5f548fdff8865cb224cb10db2a1c0927745d5330849097cf7456b099e279d7302127214a18f973d489e3a1ca77ff638d93628089639f57f39f84a201a5aec4cfa965cc6836851787624a786b0a436e81f7080c6c2eb65c75550d550eb3a47c6bec8622879ba9ce667662edccb597ba77908f4822364a9f7717874a652d75c0d9f37e60bd2dbe90da0c983698213a1c0306c27c65879e7744e67f0a3490dbfd6779e89c726ffed1f38021fc097a88fe864a59a0f6dbaa3621282e3198fa66c2b55f76c8fc50ad13049be8ee549a120e614797fd58ad12fa6028424caa2f1116141130b922d10f5a85dda8a60a5beba9ee93e589a1b5601800adc46a649692c9dbb48c097a35cc3f41a608d350c7d637c1cb1f96bef8e8a95d292426e88004ac6c96b6a77cd8ff27fa3daee55ae51dd4f010b813a84a5f03bcd869db79fee91e74e575b2d05e3f4cd4b68075995b6064d02d87e18850aea4f1ed6058bf7b2fcaf6e818534891bc764ebf946455d61eaeb4bea97daced65304d2b95cc87805ef4d3e499ed0d9c56a6795a16838f08186ff4dfa911206a8e0c75b5aad49adca98dd7d8dea94087815ea806811e57b0683b6fbf9a66ab9bee219fd425cb15ef99fcbe8e165a6075ae08fbf67641095b2dcb5c0c68ff4d2f118e69e1bf1d96bf5b94b26fd6d363b438fef0e8662e49cd9f81ce07dfbcce036f519c99cd7a5011894239e1f77b38c546a9f8cc5bd296053b5387c79aaece6703787cc2d1acf20a35c5f0aeae5bb6fb35fae69c66ac0c9de34a7856a3ccd0ffb2f9086e3ac2add9169fccd8af42a05ed760e120916bb84c8798cc1d569f485aaec7e5827f03335349d368b32bf2308c5ddeb9b8c853d427a42daad1b500f9f86bd11c012e19aa22b20b9dc75debb216944a9fb99196de652a489269cdceec7b261dfb2cb42c4e1581efccecbea22c928f1653b3242026bee2d010687223ce97986eadd056c75a92a1492cfe45346d20f6c26a1d097c0a73c44f1f7a9c2e5d94f7aae76e14a7f701823b28bf2485c2671b99ee907205b775acc2b34c92a1c3322bf9dc64281073541c749d84bd7708f1e18911c8bcaf5fdd4d98e1eabf741a86b91adf31abeec32b32c0dfa38d48e9838b971c6127f50266130829985696a7522edb0e443dcab3da366f1a094eaef3dfbe306b7cbf1a13c3274200d04051c9b70e780c6d87fe9f889077424082ee083becc1cca96397f449d63f0778ea71acc3de32bfcb8978ff2dddcb00e0f78d98a78ba782ee5ea45eca3bc89fb5eecc7f2c1b52e9ad7c9b8cb386cfe305edf77ab552b2fe76f7a1dadaeea6931fbf4e0eaaf4527ff478532c6a43e3e2c9a4eb573caeafca24f4d64ad70bddf12a1acda9e9fcace3675b23ca95ec1bcb1d23e220213fb7144fef1d382c94f98709ffa9d5a02c9b104a39bbf63a7a93a5adeedcfefc42b68ccbd4c7e369d9dd72fc5618d9a46ba799f2376af184e524ea4694cf1e6928c0cc3875c15a9931374872c41e3844c492bcfbbb2bc36815736f2840c16a2e9cd032b11d76303b4488315985f56c7de601fba4252736358c14930f387bb6b059f3ab4b0f1e071947cf9443da78e6956e0ce583d92b6965208921f39eef3a23893cb5b01a0f04b9c27234ad37315133bd4809ba0b60bed92c812621b1dc2af345707f1064e6799d2f5e0a92142a8fb026ff98a92d102eda4dc203310092ba28e1a033421ea7cab8f132f38a75fe4b04a4efd76888f73f2beebcf5bec217709ea398ea497cd05bbc0322d7fa5187296cd119c7b248002168b2f29add2dbd399cdfd84a9b0d3ce161e01a274d0c97694a18c16dee07e069b8bc384acaf88bef2ff984d7619f0c7bf000e8b884f2e91b829a99c07fc52f9535cb292a735885bf5ecf1cb12efcf2a75d4ef9559b462beb6afb322ba092e0542211376ca2670db97be5e58cf6c54b20779c66ffe40c0df1e892c94018056bd54a582c6ed3d557e878290fea8338d7854d6c4a46aa75e0fb88bb57807b221fe0c1f51d8d8feabf45e11a9caa0d77eee3b12a0f052332d1ce1163d95fbf8744633fb435cd375a33239fbe4cfcf6eaf761f59ca08b38fce3f3686fa64ee9466474b4e64090a4b60d3d4fdc93b4811efa6d83da3333af311fafb39e20afbce5b622dbca66183410cf1f0ce1c4e854e2fd09de29986719b4d4abe3f8241444c5a9d9971018d6102093156378032a8570902f3ff4ce296615cbd1830e5f565dd71c9ecc3bdaf854fdcfb4441d25af36a3ed6b21d164ec5dec0236e7b75ac48c73c3f1d7635ca6df5c5ba1f88b997c41427cb025e48f34eec94de8ca1f56077bf165edbd3555a3710ff41da7d54ad1a00dd194a5cd4c451a476a71dc6aaa1192e58d0d2122039ad60845973f3a4aa773ac2940fa66ec3b8e4850fffadf6d5af920297cfa44d10af45bcdbf591c3dc3b3f0c0116da994b4609170ce9b3f552c519b1852dfe403df2a33f2c02c33860963cc598cb86420bbc4a42bf10fa9e8c33430b729d92a3ca4710a86a360234fe2f10215481110a3b7805dccc01af753e43ba58af0b8096ce4dba637735cfe9eaf47def1e10798c80a35ff00df9558194d9b865482e73792f371fa800d1862c183c3621d24eb713af7e9971a8e166defa90e582a672ee7d66b6c6f46c5d73b3cf16a657719219c99e0ca6e33a08d7c0544702be6866d90dfe4462affd19cfa398a1381cf342caa44be6563a564eadac5d8fd51d9719f19c31ccde5f81eef41e74ec9dfa58bdb1d3124f38db22edee00fe9fbf5c170186b04e3104ba0bb581befcb05f9eb5e363e3550f8824fe0fcc7da5ae6ea3f12a1b60aaa1ea40bd969972d7d2c0a267a2c0e9e673ac6fee62d07f6bca3fe3a699da4f516b55a129fb8bd1908c36b2db30a615023fbac48dc3afb521ca3ccacda2948ff3eefb99b810397063992123a8af32ce4d172de558bdac8a51b6cd0ab713e555601770a0cbbfd88993cb74b2de58599e3ba7be9b970d1079077f0b90badf0877d2705f450b28b62a83b662d68e4ceacb3b7a828b45e939caab92613159df9697c0a17217a7b68e8609490e23343d2652a89d263b69823fff20a02eb3ca5ab0350cf6feb8c3cc3778e0844f33ebc0d0a3080307c9cbbd4aff667517d33af504fa4e9c9e414398fb9c6eaaa76ec2e700f536cc4cf4051aee42c4c5afe523f16362f48cc7281cee6712a6b60ea2334c1065e8277b31f9aae75145093c4162064a3de275eb8adcc1edd59dd70dcfc260c66f1c6a4d0179c3b845c8e40256a11617290e23936d028e9ade59c7eea6c1cfaedee8f627c97320b27f2b9848ad7536b31c12016654993049a16a46bd76cfa6461c55d43583cac47b80cebe4afb5e04b168a034a5ff32f82901dc3d7aa3e720c9b33fac7512257fb591e5f430164e440ee590a1d9b43cc2ed3dd5ffaf03440976c745bb739bcee69552ee79da5bb5b9dda5b0d15b4597e9b37a28f03e9ddb79a3e72ac31dfc8185a4c5e3c544c65191a56a91cad97ffef2d4345f2c5b6d80c2e49bf26680efbd923448a8b2074438b6d0f0f5b5e9646eb52d927271d6597fc8efb760948678334cf06a6816af421772e7f5104ad18467a23987c15452abebc747430534c02ae359d2e49080454cc9858a1f7868613abd71804ec3960e8b863951445d35aedfcaab9d1e77155601bb8c0b5867383f22b054fbba030a47c5cc9a756d77dc610d790b8b134c395e54dea4ad100424a4b21cd26dfb5ccbadf8b6a0041d337abbdf42b8829091366d1d208c5b852d10e97b8c5b6c70e0d0fe4d5fee4231c81549b4448d2cfb7b389e79779c0acae0696efc2dbfa54da28ffe0ad69dbfe6ad8a1e67ea2a04b2b5b4af69b3e90ff65aa08278c502a63d79f4c4cd224ec1dcc3a86d1d5eb7f3a0b8bb220d6416c84dce86de85a8f5e1bc845859a391d7d402d7591905aead7033a31f2a484c8e1ff96e856761234070e0f8e096d0e46d8a28b60708ece2714f4a5b88c4ed9c983d2557d9df8a4c487e823548d61a4b0a58978caf26a6d64da28cffe0e24c7921e9b7ffa7bb6d6bb1823970f57f28c6e83c8916cab574846cf797945020294308e08a8858566a51652bcffd5f3bd038fffa416c79af9fb71dff7415a827c548bf51b9c4f7e72244bf2d8ddba3dfac3517dc17ad93f75c06adc3d87aae731f7bd7f13db0d71750481e4bea069ab98c992dd3aa2d81e65bd2193ca06e549f1bc684467d0746248e38a16d8a7e037e53f1b5f8bdf48bce06801b658d643f49695c31f977ad5b548b9ec97c52a6ec6f8417fdd70c8d13b82a29a8df8fd78aaabc41656315ec876a38f075076b149e9fda302181d1eb1a6ecd62fede04bada49a34077861c053ebdcc0649362bd82fc7c639c033dfff4f5f1f49b48c5f632efca58d5241492a576858f24719abfa1a6f1e8ec73ab4fa15371b86886ff619d62a68c99f3ee3e2469f4a4afe99f154e077956df0f6b0e289fe2a86c410225aa5e75b20097aa7415c6ccb37735753b7ef443f662272c54ee1019f58a61b793a29bd7a100cc29fd09e9bd6f0a07cc4582f47f6bd0925f27fa58cbab1446f9de8054c4ac56db1a78dda233fd5c764a037987cb96d8c554f3cccd34f0f4cf489d43112fe12709f22e091b2409beb17ae73490f5b1194a63baaa2d096a46edf4515850d52e995da6aa71475e2ceeb8bf6eb0ccc2ea704f28126daf5c83d1a17b06889f5b6550aa9b4f23bd727e610b94c693fd238dc303a27843ee4525d513c7959dd6dab320cdf4a67bf141daa73a69133b4e81215eaec4c8473a6e7375970cc5dcbad9e304fdfaff3e684e4188faceb42c5b88e5c57e3a13d43974772d43c4cd384c8d5b133b970f5cd65b6c2b3f177c884cbd6cfe5b5f61bc4595759d285ad3c07b4607717d89d095f37c4b103d17e1f7c88b9d01724d7ce25d89086a843869448619c559b4dd385e44d2277e8cd12d25e6ec62eca042b996732e86c30d5bf815bd60238eda7dac0254692f55c3c805c6c5c0ad5c02051aafd88fc7d1a92789adc308202cfc4291520147b74db48844d184f584ddc4735df74b51d31480d56cbb22126de5945d657e3b83b97478caf3b0da1f34401830bd16c05acc6d23cdbad51f5f32792909d397128945a0a56f9a030e8dad1e8395e5fcdd4c9910372585c5d7779d27db41efb8315ecab7f495abd7c60a8cf6d951d85855d23c411387ebe2bdbcccd2c87756223acb2ef2f5e372fff19e591511d892ea4ab389f67fae1d75a3b21849f9a3ef6815a92e33dc12c443ec8be42fa84b5dcc3b4f6ddc6bab85d5520075a85ae523e071f78e70ff83bbe541b4be1d1f3a890821719e74727f7aab1841cfd3fe0cad76450e082427912154af8c811b95622e9f8e62290f7dfa37c5c07f95378d20a2a53e8aad6012df1035e1cff624e9afc5e8ab174f73e37ef82c4662353ca53541bea0e36e04eb58a25e6775412710ba78e23cfeea71428090d7c3d003fc5a3e63159fa1a4c8960698099452f700b0ed9d895cc25097f8cdf612ae99000eb25a9ea972b187bb293e2970cf677a27f52b82fcc66d6b923907c6d1312a11ec20164f41c4369483335c4c0d3487065fd393612761ea6d153ff3850972ab6a8159e181c3e2a20f51a002a15f853ce0d47c222ccaec76fbd41722446ebc09b60dc9df24345a1c8411b3df374d716e55a1f1e1cefda98b139cbb90d3febaa530c2cd181d00f154c60337ef12c2a177f6e39eb0bd2a720f2d6c67ae25c05c093f2bb552e0b6aba3355157aa07f9711582aade57dd8dbb6cf3c8804aaf77da7eb590a684a0f99fe4e5cc70c59ffa5f3b84505fd6d43cae5d4fc84921027427d8376327bbafa28df13bfeb16845dc4555dcf6562b1a9b2bbe63a6d9bda8d12efeb17b6229c30916494fc896b6011898fc1df0a87d42eae9a1e295bf0acf489c6ede9364277db98bef15707b7c0b330b2e993f6f7e7011ce3c95268c18a6dbd4d04bc268a8e8dc94da99fb432706caf028cb43b86c9f659da3139502bd7058fe3edbb7250975e02b8395d958aef0d137ebf7c07d6dbe1eeae32295d3f6cdb9da70440e7b8a7f2176b59f94ea8103e75611674438702290b32363e6ba89cb8847af6aa4acebee0277643eb0bc81c4bc2bc208cdf8342bbf0dad752a578f14293998cb1533264e7964fa9b8b943ea4efa87dfd4d4e40f2fe2d2311f51a8e214baf225ebc711141fc4569d66d209cd4285c4a7a728be8e1b3a96732e9b92982493edfcebfc04998606ef256157d2e6f9e2f47760d2ba31dda7d9d492f1be405e36535380f7ec5fead32f1f01613a600481ab0c22d224d9b44d00ecf1b177817d931d39bf73617708bcd2cdcc018eeca47b495bacdaa6633aac401729618157836bb7e0a672ce3239fb8e702c6b38f1d88b809d2f4585a65dbc00458c24cf305335c77717b23c53627038ab583af8a73900d5caa27dd2b17d4ee4ec0ff0bf4ba11e84d5a1983de1504af0e1598f4f7934a8e73043566ea76db3a6ff45731a8d86f9c5ec76115b27b3a7ae66e0fc9c3ecc930622c400846f9728da8e2e3fd559cc5d138578510580d0056a66515473f70a778df6d367633ff09080cdbf699fa8db1e62498a459c1e2bc9dc26e38caa603abde3b505dcc5c2c1d9633bada8d8bda2c5e8946cecd89c7f96b0a2eff7bf98477b1e17c28242bce1dd9257e0da7c1b7b48d3bbbd689504185ebb623ab34b50381510d6d3b0e7800bab0c864bc54f74bfe5d6d690a9d1dbf6185b2e8124c1891d85f7660e16aaeeacd5a5d83d0c23926bbc41e9649a5cf2ab83a600b8add49348279098ca4f227d5bb711319d251352627183091099a44cfadcf4cf25516ab4c8320bb07a2a31608ebec0deb81a5978b216b5ee154ef3240a2faa28d138609bd16934e6f8475035c02a251d5b6958b09eb5b9c2fb22831e87c3d11033568c3393328555d88f352a2df34b842942487b48a7cc228b6e03e4b1634d64b6c1340786fb6df114949392e61918f4e39998e6e717aaf04cf05d934ebb84262cda4a5e60d099eebec99751ba805556b43b343a784361fa684f697e94484ce5daeb684973361eab0583be7bdfcb99d118375a0d848346c7d8fef9fe75945dc6c0d336fb3da32e7a0311cfaa0f7b360b8607fba216638fc606e08e3bbadab9b89d899ec777cbb4b8171757f5c2e4346e48449b0684523448e56e774e8bcde07a081250eace5cc5a96dcc7bafe5aaa6937e78840eff33793d3b9800b5e2b0a3ae08ca793304816f9adf48e632dcb78f77e4562c6c39cb4e3a0f872a400504c6f85ad49b03db64c94d2fca47617be51ab0a87780f124862cd0fbb31106c52691edb4da92ac7db54d9a9a5ee9a8d091aad1d7c91ddd3a2774df91ed6e5156e109f4a2d1a29148c195d08da6e2a011d428758c15ee55a5cff9953c948d29bceca48f993fb564279871f06e174707eaf49f322313e014734119cb59f5bdfacead50fe414d0227e6191c7cbfadb2b150c737ab0f01847e9527aaa33632ad50ccf663cd33bb245c8bfb6215058476f353c01797749349a0299820d72d8a2bf2a9232942a081f726977902acc501efc6212e9c24567433a73fefa3d3f5bca20cd6ee0b6c5e65123ef7a7ab5bf25364c465fc638b6af223bfaa4a1ea1a71977e24f3d84f48cfbcaa012aacffb629c45cdef1d47e426bf717da8ae00fc3b5b579901731ecf6d378c1b569c495bf90ca3c2fcb16bf18e9c64d1d9e80a27eb3b3f990192c42692ad59ef3b8e2b389e7b7c96ce05a3168cff852268e221d063eed3b85fa729b41a7e8f2156cb5b93bd5a49badd69de0466e872b0b72e1d7c4130d8a802d093bfe3d2d8a6ae4c92701fdedba97278c273b4c31c56bdec7467bd214677ded3cfc02780f0a1cfac3600c64808835298de7fcb229801cf05dabaa790cd8cc429f3752402ae61c578e98691de00e78b84a2cf53b9160bda21cd0db0d8382c010c7a4b14c978c0c484f29b6162e713c6b30c87614bbbed0111d1c25a3a6297412f36fa65eed154ee1ddbc9d62f34f8e793c2dc93fad3423b4bdef35cfc27828118d19e533b4fdc1b2c19c9278c01bdcfe10a25cb8f756ad8657460184d8192fbc30635cab845dfbbf89c4f017e105f82275be2b77f5b111d6e56e34a362000158a4c2e59cc4781f9820e6d8cb03b557f86a56c33fb5b98c729ff450b51e04294a05e0af6cbd493f29a4210c6849c6e986326214c01c07a021ff514da6311492bbfbeaccb5da0ea5ce6ab40a5347424e00319f6f30d1eb6e23e93a2c0d815501d8645c9182ce13d7661106864df87589ffd6f6673f03c957d3dbd43987abdcf7cf1d090516819ef5a8e23168030193500ec88683ff216d53ed0fd8eb1d76b4b91fafb9f2844abaa0a0b3166a218fc65718907056deac1872e7964ea5587e4f140e59a68bf7648493bd523f66bc50545967d0ff6e8d3c18cc147d903d9127dd1fffb551af5feaf24625c28dbb8bbf5183f0c431af0e609319a6af902361d66d37aec68453e318fb345327a8aedce80b561a0d748e994e06fbbd6b5c4665264fe66386de93dea39c24b29e90174f33eb303ac8c2f8ccfce69f6794e34af16a89db447ceeb7946972dd92783f93643ddf825eb5a8744aeb5d96b9e7b60777066fbfedf2224834186fdb9f61d56c1a8a3666198f8a7d67b5512096e6786d53c43746fcb2b7b13e3008613ae5ea65e58bae2b3b19b6de5b432de3e6e43ba2337c4e1c00a0393474aa9a97448134d2e7362c477aa47d239028f9aed7787ed1359a21bbfc3008f61a1b30159e144c6ed7e4e960351d9e25aa163aee19c3d8cbccf5c48dda7be79ce2d26e9ccf9723f37306ce3c3219d8f59b62acd38f29564e16dc0fdf291520c208b630fbc05525b4169b72e0acaf0ce32d2a461113deb1f707ad9a1fcbff3eec2bf3beddd0730f3e391239463ddb34ea0ece7ed68c4e38c3125fb180e075cc51bf75bebef3a314aeee25a17d81cf5ebee151f7f0fd2df5c9d6f72f7548513cfc247062a221569cf914528ac44dd238c087b121602a3b8b91d2bfe23a468de5075c13fb8f6e3802a9a1992c33a47ae373aa82bd151690f8d250edb8ecf950e9382d3bc2ee5aa893e597a3ad4b69e84cc3d9da5d380e1c20df908c7653e1b5cfb7f501fd76cab95f3915404f2e298acb9804868139da1b81d61359046517b08254e4f90a7c0a6c815ceafc5575b932282ded488920f87c1439458712671f7fb8cb2b1678f0c52135b077c73d5326f263f09977f526bf6b2bae1efdccfafaeef7ffc615ed34fdad18cd2c8b597d38767f2e28dffa918e20967f7cf0650565c0d008df48178a1ea777ceeed1cb7f7555bef04cd7f93ff2c973bd4471e91cb46c8a9368601b3e3846f6803b927038aee40131f06e3ee2823a0dcbcfec1001a5ee89d88156af8978980133c6a4a47c371c368312944e59c4b980e82953e73fc683cbe5652222a887d6e153ae42c1b5277d372e48bcc7f22b717eee899a383f3a0776e96f96a114fac68c7dc1f4ecfa4c56197407b4f60e54ab76e81953d288b6d116f935675a608c5754e250a1568f6d718d9f343d7bbc4e273a0d8753619a094741d6ea3cf00234e6693f8e7f1a49a898fc670edf04add284362515091dc53e8f19b3683663ac4f0535c0178644dffa86f5e8fb2a8c81b753f2e7a3154820fc64d40527d9a28428706f319195f4a3b734e013577f4c7eede1a5683e7177810c6558e0f0725b316ce064571430faa6c5464f370028ed89059dbdaa4cd28c4d4440331ab76bc16c19957de61d17344194624770dc2593144a48f37397b7874a059e8b6d9d1950e0f2dfd8d8c4f34eda7b7bacdacee1e79b0ff33cba62cf12d3170f3432ee67c8684211b6afbec07dd8f11d7ad828caee968bd8d4c962b298f875bf93b73340e4c769b2e69b94f178a54902b1093f30719b154d0854e8c7ba55599a77201493465674c0af6af61f4168de9d070e1759a07f518d8fda7a35b4195b1e06bdb7572d3354055bbeea38b8587739b27aa32ddefe4283bfb7fd412c5b56869a3de4ea5e9f07ea6333727ce8415f4b4e9ca26da0b1d60a54570e5b49098d3f434651f5d0784cce39e58da4ac5a4eee42ea6387f260399e0bf0b3e910f20ccb5cc9e70b70b35d463cc1b88daa01f96de11293ef86715cbcf67d3a7dded55e407cd20bb4f283e5ce79b9f5d2edc20af512daae01c785b9df9821c42019f2707567a9fd2bd6c37bf9ecfd3bd09200e9352c259d128693454874dc35827647e729b124ac1af8908a98aa5dcc34238bffc03b500cf6966daa0eaa3c73117629be29d3bf39349c083e2aab1c0d90ed65467f3f9ed13c81571d3931e27ccc60b02afe407ac9e855100e4c45c9349a8f751439351a700098bce96fef38f90011b31e82f2d930a3b5d7a346b6ca5601d2ba0aecf3ad6ab0826763e280f4a51612c46c8817a2f72ff64107e8fa72b57ebfae58a01fcd7d789506b6a1805019db017de826e263ce812bfe234605bae395feac9fa0aea67cd08da90fb95adc8935efba93e18a528d2d968004cc9902544ba2088c5b796700feb4879fe52990f2b5b6300a63c59eb63693026a0b5ea14585c954990523a13bfb276e648d30d0975fd7f93b7ead1fed6d515b9278e238e807811d7fa70dc10f9c3e3dafde4795f64bb723ab866aed8366c8a2b2f4cc7a93646c28c0fb0ece376109e8209162d61750d1ff227cedf9a6d0fa5957a8a55932d501acf2ac000451e81279458689349ada8df764b746b4d09afca0e7eafa13cb85706faba9060e34ac46e18635704619546ec5421c04ed1aa37533d2121b512c96068bd0ac91c20c733bc93eb3792820759c83299f36357a281d597cf3c763a67c691f021d8b16df32398eb5026bb7512a9c4d99cf0df20d7f91e2677f6f939fd19c3c39768c8444d7c50dce6a43d53c27b54c9a2a9cb1d839f0d9d856de169316d777ab2849bae39083e24781189f10fbefde81bf8e311ef8b566b1c3787b5be6d45b846cfb84080ee68ed668916a79d898e5ca10fd036f31396502be858be4837210d485b611cc7190ae4a608f446db21146f6af0ef508e7c8296788339ca6b90b08d8c03e1cb8910899577de759d28d278224051a7b0c2e491537e89b6856e5eaf45606cd25112481fbc66b3fa8c3e3d2ee869f7f99d48cac96e9296980b4d00528152c99aa66fc0341de5bd76992382cf83fd402816b4fd4f1f15de0a6f22589efcbbe614df1d1cd769d8ebf6daedd463fcbe08b0331e272bdbda28a2bbbf51e61133e8fa4cd7f04c02bd24f5c974aa5f6858f9f2d6a9378840fa1f1cb789d5affd3851df78c5e11c42b924791bec84621b64795ed973a44f7bc0404c43a0f963411e34d7b4ba64efffda42ec4445b6c802e8eb434362d26a0d4a95a03895b13b570bf0a9279e9c1b7a79a7c1daa1f188eae71cfdf7a48979f680e8c803f743f78e667280b51724f22f17ea307d151f3661561277f0fd9bd2d10379c933d443fd9b9d94be5ecd10600ea4f83e84896795e863708632cc3e2f6c08fc8ddc89fa4242bd1e551ef57653d3f32697b2701da4abf99169ab5076f9b0ea7e3e009474908514314172ad4731b1e2fd568c97a949d3d2bff2ec7a90ba432fbf9a37885323375f39baa7ccc531f5fb97ec27d022702d8c8c071cde92e88a318df5dca4d36dfc6de268ffe5c502338a99d3a543381f2bb7cb8efa8eb1c3792fe1deea7c06ccdd96da9cde02e56004a52e40224525504368d9bbba43e1e9481ed83c426adb71403d020bb00b99eec6c7fee7ab00d61d2cefbd48c7db4a0bf84223164161ab911401cb4d128d1757baa45e604e2439c1cfdedd6c20e35fed448a51fe574f0c78d0bbfc50852e0e5460bc43b8017880b94a0ea023ac27cb2e963f27533498278e14f09fd2e321c9f2e31b16d8ff44469b838832bc60a7a6fe0b1e562a01c81915e864d345c063e7dfa9f4a434f08555a9ec49cf540aca0119ee862b3a47766fc64c55c414c757cc22a415abbeb215a5f06f4770e85ed04e589f834654283556ab605f6d78eebce6a80ff02f8e2bf5a65c85a642eb59fb79cb8a0ccc9db31cdeacbca3f5dbbf6d2b087c8f9a900f23fd10216a8aa142660599edda42051aebcf0cacde540f4bd2fe7e43fd02c3191509040e2ff2329cf8c3d83567217e54dacb536baae51305570b9d44b628aa05d5d26e9b38a83622b393307b9c1b055e59d01d37bfa937e5107c4d8c9bac8b443cba95dfb5633cdb9d85dee9a06259de1bff0a7f2a8704c8f135c80c5480fcd0936569aa0bce00847892529ffd283486bd624afe8ff385f9e85e0f183e7b742a3688506f6db6f619382864465d7177c158166b16614dce528ca26a04824d49c0911a1861028624b266ef81214c4a907c9147db575411ddf0d6451565592a01d73a5d313ea5e06747020f777ea81f412032e45b4154aaceac0801ee05b85b421d8bd5949d5c37be29092fd6bbe1444a02566eb3c64cf4d3d57df8d9d02144befe004066362efdee61c8544b338f3c6d277d81a5f00a566f6f6e1f585cf7038860e1853657b1504ee3762d5207f8df4ccb66a1060c8bb73408304294c8ead4f73b819934b0c6f904818f7ff16778e59e4a497a33849b33646ba4c152bf7aa35bc50fec341181b128f1963e6819739b7f27f1550d3088016e6044f3a5e2202a1c14c93705a9ae195e27444c5bedbe537af3c690e4410dfdf7bce87cc6ffd582de4865cfde15397982a71a1c33a842fdbbcb26124a5d11d64f2e2336c98609f825804700e729277960462ab5151a5b69c6be38bc9238080d3ce413982acfdf2ac30e758094e06ed95655939c00a4900ede3d1e67d45dad2739917efbf1675a37ce2b01992b4a9b637efe8ca27e0263a2f51d95319ba69b29500b24a8c22a1c1ffe564ad7b80a10b74399b3940f1ff07a4f7ab307b01cf694b7e39faac280889f64c8fb4d4f37965bb781d9c649bd34454a440210157b153634939816eb684a5ee3fa4b4532c102ad89aefd79e75dfcba15dbf50c045a011a22a6b7113b85f4d0246d3be3958e7eca78c61d1c8450bcf770c4284dba257fbac9a5e3e944cc3d33aad3bdfb7d705a6aa9dd7dfe2d43628e27b857bf4c9e5b6624cf1067d5685c2de496bd81f68227fb70fd4b22649317cd8a2f3fd5ad82e2194d30369dbb07c903e55950c1a0a9ba090fc81c66381c9433a0b18ccbfbbee2baf27172f30e48a0693e6a9cceddbe97496541522a8b893dc1e9dcf80630cde367adca013e005c3f047e4d306e7ba2631d8b955ff29f7366e4c3515bc1b26de02ce3cea92fdcffc1d99b88b6232a23074844f6041934108da19c25e0d369c6f9f88c848427d1d6ba23ba9419f4e272464c54a9ad37de7da6e4e664e2fdc539b736230694588df29ed8052f99dbff917b195bdbcfbea3f2d1b3dd6bbdba4dc2efe2f29fd36945dae8fd6c60a8a3bf377d7e78659f2158d7665f9f73d9cdc322dff5293ce242ab9b236f17aa2df120070d8c3ac8d7c5dd3fe2926feed37f92bc70d3c306ac8a4ee1ed40ce417d91bfa56efd6e19337a7122d6777fbffbef7f99be1921a6b55a143ef318e93a71b10f7fb113251a30e0365f323615315b69bf8d451859a6e816c5cd5616f38ce27da2e85e223b93d5822d8a4da65cf25005c3f4bc03ee6c4414e22baa5c40c0a1f372e001663dd6d9a8672a3fc7629162b2e8b85b9548f8c54a1acdd3cbebe45c6cb6f5a25267fca21cd3ab05fff2c2996b639d64c47bb7a6fdde2471aadcaf74df765b0a6bee0d6cf0f487901d3d4b76789acbdd408f33438bfeb0446502be492118a188a494b9a2f6e21b9314b3ec707f2ebc268e2c090e98621d71a8c66ebfca758c0c73349edc92a49b8629e9549012ed1ccee5fd78311826c13472a6d43ac9d6e9d15dcc69ef47a6b7f267e16a466945e1a80205ad5cf7ce78c243e05d13a1a894e81d58b45954c868ac192c73187c09d03f40039d2b429ac32aad9a3e311d72520594a6c7913ed5bb34d0bb30506ead4e90877540785d29ac3f1a198fe58f88651cc172b96bcd84e7e790570d650306a7d29698e011fb96f6869d66c44f83dfe1154c3822fdeb9bc06b80d9004da6378e616fc5c0ccf667569c5c28c0d783c8a99c13e0910ad6027c1a1303fdecc0e5f92271cd77b67471f18a66c0a81a0f4379c2ed66d225bfaf1bb532c2a3b5dbae11880142416639c19223ccb055e4417bb5ea4637f9fb8bc5c3b0c76610ede5cf14e482fad1570ef660656eb54da6cd09e8c7739807f6865564e92b0a80fc848df00574586aa3d6eef59e119781c3235f3d75b7564e2a8f5c3f8b2b7d1e6cc954e4ddce4e9cf20762546daf3b4159c455fc9816b915c9fbb091b2d4bce21b298c330d02ca4bf13da734bdc1773a305be5301c0e716efc2bca0f211c1a21e2a6e111fc616b33288012886df33c0a9aa1f7ff397f21ee8f58be713add4175d2598f0154d254f728754733183d198b6826f2b5cea868f5bc697cbfb9d2beca3da7fcc75470494c006763df6b048a5f02d156fd7a1951f80264fbb07405e11f0a7ebc5deb8d9705bad368272016a6f1830c591bd68b3781acdc8d97e0620a83eebf44338211afc771b40cd5e695023ede48baa2cf259c6e29757950602fdb615f0201db56f888b06b761a799307f4d654d463296083d6b5bdbe48bede1167d01441f888166792a44048469f11ba5e6e00fa5eebb064e5645f60bc4129d314634058f40a7c952a5adea752f29938a385fc06a85eeb16a79fdb69d302c24c89aa44e563e520b2ec69ec37ef2ad476d638e9923777be727b7c4ea4823279e786dc90bffab6cd185a9686228f01a2e0341a758f78d72a9625faea4620c19a3b10f341f33b17dd25582f31397cddcc94ed5c6ad23d6025a98e09e5b4022271a9aa7c8be4d84a90de55be2e16f6ff7f9a1ae994ec30cbd18d710a7e354c485cc570fb96f9a41e60238bc360ddbd4ac4b97b3dfc43f7bbc30997b75e65f93e7489f71f38a6422f58da990e7fc0e411305cfab4a033a2deb2d823d24660827548d6a8bc3004dc9da6d037c9de625488e527e90c6e15e255c1452674f1e950627143799c3884c71ff420c008bdd4db538bae5d5821dcfb729f2dace0c4a192b3d4d4947d21793f59badc3666a0a47414a1c6a58a6ff822c689751361166be3d66b0180a4f8708afc3e4da26285ec132dd4a4eff102cc24a3f7a220cbbe3d2fef1ab1b447bbded16cf428171c0b57e12dc8f32a564c4df8b5fedc2d69cc5272a2a987569219e1e2dc1e4cab03710f176507aa98a0bce12ad7c4ff4f2e171f26b976a2b98bbc7978cb93d26004ecf3052ae7496cbf2aafc1ff94bb5c8cd2a3eebdbf210e6fcb91e8411d8e90b2981e16b7c74935b17829f36fa20f92b4d98c0a76aa36b2d83bfe7bd154ad5fe0e59c8a9a8c75d76a26c6af1df1851c60d986af6e618a2feb4ec32051eb0684b70d41da68d72ceb0e07b026d874bde3ba9f94417e8447803f5045731102095f9632a2d61cfdc6bfdc614113eca5b7e45065940f5b8d471b697e3b5e85a5cb7b675d0bff9718ca390b403851f0deab6ca6f434d533ea155a554c5f27f949bdd428eda2f1835ee8b54c4ecd4ca07ef44cb5a611539bf0cee9cfd5c65294e0a9759c16e210a088506cf04bc5b7bc001895603cb4f5eb58c3f0126c76dc273fb3b9e3f312d7413c2cb9abb6851f2e4288962df7fedf8472e5a510fdb1dc8429760371ae4832120d6101e9991ca517442bd5e804d8bd6deb708fc4981a486cecfbe11629bac22c00fcf8548483cff40752ef381baf2b990421095da172bac29c4b8360c7a6678e3b3702e72fcdb58f71f33cb4fd58b9a5d237133fb89108a59850372f4350b10d37bb8c46fcf75276f07460080c92f43f3171be95b6be86defca0252932b0a7fad903425da212c3d0e85c0ba3a9be763d8c449ce1c9079c5bfe167d70fdd982aaf3bb12d0060f035532313f5bc058b825650e1c10729be29146b3332f54cd85f287bbb7e113dbe8bb4349c20166db3393b158cc36a35cde9e2f1c21469f7af1fe84d999ffe8e5c4097d28869eacc31ee821c5bdb957fdab149b29962780c19d6ec436dbe2b0bfd13d36f749bcbf3e6c3a607660831f61843908ff121402418529c7078d5de5e31ccd4de06c4cd2b021879ff51f0ee7ef2ade9c903e8a38f2afd950a372c412a60bf9558f3c12fecd78ac01e08fa121f917914704c0bb8484eca600ec7bf1902c0c7447d27c0072da7b5f94ef2e5483061788ccc06c0b3786cce7adf6cd2ea4e7fac58b3bb062711c6f5a6760ae6a10fbbed7cf68600af076605506a1e5a1122d5b35aa980e171a45c2f72a46cc5c66d8a5179529b5ec1fb4055cede055ed4f0b815887a3f0d35282f563298f4d20a9fea812586786371b8e4f966c91e134e8611b9aa1c72c52aae8dcae8cf1235b539b557961359654e0e585e57d746a2f7a570fbd30928b9f3fd604712a610ea39455a4a5d731d24c3c5660e7a33e9a0b1ec3f3d791fbdb5b26b02701d4ec7604cc62c151ff148146cbb1505f4266690ee3e3a7b4c205094a7b98d46f131a11c13b1363b65552bde1064c7d6e550d8243312d4799f80e550460593ebf544384cca206b7c4f5b18d19644483726f8ddbeadbee42aa154e5e7d055b0fc89cc924516ec27baaaa1529e78c83af569ebbcc4304a6a1476bbfb1560f22cf78c499c2a44deda92aa7929034283c3d30a6b44c37962c3840aadcf004afb1eb5a310936f41c8b17bc437f56f894fc8e3ffd701e37e3de1dbd4f5039a2957e499c22e4dcfe5f7beb3a02b5393fe21c545592aed1ca621d6053cd818fee9a92ec569fcf635bc0e705ac5d1fc936bf4cab26c751a77980398e34529472e795d965d45bd1fe75ae9b91b822939f87bec4c32597a2cacfb733080debdd87534bfee2fb1c11fa36295d6e5cb31fc26c692018f6ff9c42cb60a6e7553a23dec77c2b80d32895798e5a327738ce2006d6e45af52cd2b9f0eb850819b0cd2b93a2b014e9e991bea26dd9708e2796f3f9721a66c18e08ae777eb525d3c5ab94c70ca9e2a80240bb52db261462bfb000693dacceb56b1b40157f4ef8e8418026afb3008eebf15c884d27cee36b80052715027253fb6b2113b2fefb1b305d2031f96586dcd381e0978d65138faed75dc330557ae2778610cf36c1335045dc26fd95055532cf4efd9e8eaae8ae7847d1f739c590bfd9408f0798612b37eef49e7005ca74e08dd5b92d625924ef5a1811dae4dce5926c3521791546344030ec46dfc2bcf2522e88b6d0a6897752fd887f58906631c7738c202fc8e036742646235cb4f4774f627aa7d34c616f8f9511dec59367618851fbf15b31b41ca9351035a3c6cf13969f6bfe73fa78d56a4208ec0d791c981e200ed66b8af089c38e9ca2bf7e4de46b0eb74bca3b35800eed9672196cd7861db2406d260e43f0109044dec839535339e5738d307a37b725338917eb4a8ec6fb36dc00f852575f12cacbc68cda7e94636413a39c0b7a4f778af5b0b8b53c4bc65a57f500fa3af301314a14fd1f5233bec4b6a05767d4926e81c5857d4462d520f0d51d6e06576b249b86e4c4f37fd383057ffe1a39cc39bad100f82d542971ed9599adb671220f05070723d6aa9e36447c9b3efb64f88ca8ee9f882d36756467d2445d240a89218917162d31a1cf0c2eae9ac23fd95786f5293466814fff84697ad4f03e68d9d7a9fe2e78e38ff7c1dbb9a2a8ae2310ce49ce082acd9c91124bc87fde03b86d24f274c2fcf13e38e17da19240281e23472fa4d990ca55bb194a0795e96fbd40c34950b6f5ad39045bee18ea8700fc0d0a81702384cff9d4ff2b9fa1808c3c330b7af7fab63f842d071e2da62897051bd42dc8855d66fb67c08484d439bc5fea29faf9795c8023504c6bbf3bb397e15f04b1547f7af8691369825e43d8a614504b036bdfe439209645d42bebfb21cad732664c6789672c42a5641751beeeb7ee3ea8231e44a08f0b2cb1e1a7262050e82d48253c9a27d6a170469a50d2523644bf0bc7e1f1378724c937fb62d92812fc50f8a1d54e01d205c0dbef84546be5649ee411b63a93266d4a0bc8e7eecd0e47facd4b421b6dd0239693a7a26b89af381c42f6f5f13c11afdad383b3af98e1351c23ee74d49069b6c6883fbb625d58739a18efb94c26f45da94d8fa4d15575bf5797133433ccab427d9fd01358edbf7ab463f039abd26589ffdc3598d8066743c483a2e50a818e63872d7bc7893ad6371bcba6746a61a7e419467cc848a5a8e9e2d80a03350b9c52e86b154ba33703a03e21a22a74e5104a61606e39002d22785798e1d4318033ed3999a81b086b93698c824d0ea0eb1168137a747bf1fb7ec921119eacc16a9f00b5c1ac7f4c8ebf3ab10353bb6e27d1563512fef79cc043550823c75d52a765642daa4e3514e755179f59b79c5967968efc87ab63d5cc46efc68a7d025f37a88c3f5a29b4e92230cc2a1ad2e8fbd7830ab0d62d95b62023e7bd0e8a22b108eee2e4567a910bea2efd637a491567a4c93e8f76eb3345071e2c457817cb6fbec26d457844684ccdcc23c564aa63853639c303872002afc8a832ccea57e5d3ab94628340fdc45205f285d0f3504a234880232aa145f9a77d6b1730675cd683a64dd836931ef53185d0630c6082ffffa8372e26ac77340ac74a935ed54b32091036990ff0786f57c95ef6080cff75dedf92ccf953befbf8f89b79cf07804ae4b0dea8713f1b4800b41a84f47e6625f127231cf829cea46158623166c8d2ef2c7f75ef8d1ef6ff5a41e5cafc11852ee59cd97cf256705f53693744d0d9f5cc184869489b5de5b044f2f3c38d0d606be72294fd9c793f89c096cbf8abf6502c84333246322cc8aa656aa90d258b1ea37cc5cf29c801a9fc818a20f25651dd3d33de6df330553a58c3f5a3ae19cc124104a2108c79a994ab4a361186e79993cf6f8139fedaad7bce35735d25901e4aa4cf95fe04cfe22dcfc44d1214614b9e938279baa7748b96af1f142f0403f388bd44bcfed890352beaa81c1433e234a1df58a41c5ceea0e7e18641ec77262e89eef210cb940cdbf82a136f48f151488558a6fa1b3746d0c1c01b61c91ae5621a62d1c90cdae04604c0bc906a7b9282219b629c59266a9e532113c8bcd82287f40c10ece6c15ce3b1a32bcc50c4ea1d409aeeb5b8e644476e9a66c1082b69ccb123fe4a8926adb8b7be537b6cf126c3208c9015116663965deb4220a05a54cdc57ec48aea5e0d4feb90d990f3482a16c2c3827f60fbccd869eaa02c7bb76635790830c547a6474564d8f340e5f8cde0c8606113548c55b32108d41b0390cab84cf9eeaf6f1dfe751adb2637add3afe7650fc8d988036dd78f1cf50f122aca8a433498b36afb38f5c9f958c9534b350a6a8a565378a12e694f4cac3b2d4b8d78ca91ce12d4a8614a0740ac423ec589b764ba95d179109347ffb402f2159a5f5cd50ca5d76b69b180fc0227cd228ee85f9f895a333d2ce1c9c90ac656913e29bdcb9c98201128a4208889b2d6798a14ec7ad620a3812f55c5a519bcfb46359832fb7778f6a045babdd76edc20a3022e13e4c09877ad8b792bbb64a7165b8d60cce35bd1efc9a6424be5ce9023963ad4aa900e2e7354d342aca87287f236b68b40d1246fd36f2d7c67e4bbe5251775547b9093c4a3b7aec889bebc91bd5eef5de09b21ad463cfbd068d6bbab3b32bca8a3d675b18ff9c0334899bc0df6151944311b5af9cb2952c9d66413afd3244d1d2e159986c53c70ffd9a9e850e0f278e555be3148d70afc01fed47bbfc2452aca1f63c42fc2b0e2a045f203732dd8b61cd1c146f7536de7d61cfb6ec0ec7dfec1a605140c6781f4ad2d6eb85db57f1768b1729ef2bf9394935f8428020e9fb3f2fe242ac1885b43c2b038f577cb5f503e927a8658bff6963e562587c22098939ea5e3424630e0bf97166541d6b260616720646285e7832efd5bab1340c64cb48148370bf03e95b9010e5b03f3ace744a1f2af7cc983c61015f01878ac4f5069af1d10123b0aea3275f248304f25fb4bb995343ada927fad5db91829cdb2fbab02b1385cb605cfccdc5f8ec3eccda74b6b16bf39b34db10f28de056b32255b505c4911c1e1a0b2aca4c306049c605c46af3e1ba7d1b98fb3876b773f46aea62f1deecd7f2682b11a1af15b65f89d6d6a5349a877b5b9140d1104532c5843025772cdd2cfac604c7c1a59eb5acb97b47e52a0d0a362da7c848b9d7521966f18bdb2936ba3f46172b152f5766d6bfc6e3e15cb06af4a50dd970881e43179cf74ea78b038408b32f6539b5af27e81c5070a5f2e1153b602b2e2a331c380e5aaa6245d8d8f1a6bdbbb9f3dd38f075c0b944a2ecd9d8c8147edf1290e409722a99a3bc9089371148b3239b17d52684fc9544b3f93666feff6ec8b2d5f7eeea7f344a4ef340d81fa83ca3e5aa1abd980c200f487aa7806e9afe704269873ac57d3ffd7729a62a5bd922dd0956daea510e4a9c42f77b4c57bf6096e9de07233677a6d93904bce48833867f6de6a4cbba7c697ae87db4cf38255414e20826ae20462215583903bcb67fe47285e1a6989b4ec2434f1c91e101bfe2f53c742c3fadecd34abd67d3804438c80cc7294014a3a4c481975251670744fcf36a99905c408b7512edfbab3704f155dce119adaae876d2ca180fa9ebd901175cec9487f32269bf84e14d0e69e48ee0c8c05ec9e9f32252484096d57b332a3891986d5e3a9740d86ee91fa6db7a56c193c87bc838610af5d7ede7fb4d09d74949edfe5d41d94ebe2001cec6865afd506e0b967dfa567ad4fc1f82d0ed0d142b690870d6b83d3d216456426c4b4e229d02419f4089337a5767816c31f444de5132805af6bb7b58c72da7e8c45bfa6b3185f55b5686ef49afb1dfe4c91591789d112e2188a3c6994c9cb9b35a4175642413894308dd2bfc7a7fc1792496097b0d5f2002f324849f3ea76a2c771951343d712148872e89d3e80c4c31eed770a9908e21a100677f7e3339a7cc56aa6f76c8d14a8cafd9a269bc211e4fa0bdd7b76dc1588053b9945b3a14a5d26e5745d2f63201d8b3b982904289eea8a80c4204dcf74d338f19a13d9deb67d3bb9ec24d37cfdd84a4e02c3174e5e3b00ecb3110772698e7c0534cb744cfdfc5501c32f71884af53823ec23526c09a230a8759b512799690e1cb1b185b0e740a916eb4400873e808785496862ac21b8f219b544e2360909fd6240b371cf5ce2714c22dca3d38efeb59ed94f59906ec361df9ef488506e695dcb73c80032a208822ca1f18366382a0d9cb868cbafeb1b453d73274dbe51118dd0e953b90fc2cee6c11df677ec616a51e9648374c3655e7eb7cf26e64e204b3f4bdc52621ff895402ede7b5f4141c6db426ced779e9cd5e2db23e332c7e7d9c18a063864031bd8fc30a238f933de8f0e0996914631fb29fa39c209f43a559d6400d57cfaece6165acaafc7d715fd8a369a194d6efda373cf203110a1d1fa9e42acfd6b1e48abd6ae053e88544063684b550b495f5fa23f6b847b70210c9ff80f6969c3899cb089e528a7a14e31e83852fe1e6f15eb3fddf6268f0198ddb79b28dfbe9a5c84cb2750f02e4e84a09bd496cb9680bef51ee1ad6bc2d869a3684e0c2b405b7d3453c1b3fbf45327e8c17d32aafefd4d3c19a71e63ea2145bee28636c0e41d0e031d454772b745ccc560d3b4b2692c7287fc4702e2347127c868e1da59059a24185b609d921f1a21bdd9dfdbcbc298582335eec5cdbb1b61211de67b395ef105db1e5bebb6bcc6f03875853ef82934244a723ae7ad0d6a9263a8ce9b5035a60287ac4ad2af71031e439d5f4e59a5ed8922e3758be0cdbf7f66d7325720bd298ae6b27c831f0e3634614224501f174d6fa3f8387ef620e03c35bbf4e062b0986973d6b443b218106aaa07d990c6f48535a19ed4dcff48ac7797375e848c829a26c5e6d213dcfac9d617de7e59182c004747cfc9ccf671519f9ef3c8ed26cc5521c8f47eb95e8ca6f757d575328dd305da992aab21316803ea1f970ebff2aea0ab01e17fcd1c2e0ed88bfe8c026c3dc4b1c1e0323b76971511422a1fbb465cfa30539c8a8c4f2fd94df279ada373c19907a8c465050ac58a58b13ae74675e636c904b4ed1e4c1aceedb5897437337dbd5530b72153a1bf296c4f7e66473ac8bf4a53f4a3328a8e568dd73f9a6a167d5f24a0625a07497f4780e308f0a7473341c62cfa12b35896101175f8dca1711128791d129a015d7e5dae029c6cc605788594b333df3d0512a5183ba812b9fcc1320e206be99f37941f4e870fc5ce2d1a047f0a041fbf640dbf181ee306e57a37f47121c0ae2ade02d5314af5f7d4d0d4079d4c952ac67640b95dc36a98febf38aad4871fd5fed9953ca1b392f8a2319a7c0b4dc40c30580b7ba86759676989f91e17b93a6a5e82d48347fd77832695d69b0aa30813560eceb0a126dc7625ea4d8196ae15d1c1c483456ccdb780031e0ed55b8fbc7af935dcb8750fb78a055b2298886b019a3758f1fdf440b2a8369d9855be9a3f12f36482448d91df549ad4eca4e244f8300aac62253b3a11533c1e826a59521dff240bde1e7d34f684816bb3f0ab79c8cbb00f5b277538aa51f802fb77eda9754967d7e2782bb346c1fb6adb9de8f23bef2bb25237d61b95d230ea71e06626dd78e96761b3bbb401016ef0e87fab92433886bec0d66f1b1600b8cb6c4034e6bdfd215374fb642213dd5b1f66e2151610d0d86e11d9d45d0b7138499216beab520fa6bd64598c100e1da8506680644bd30de11cb065bb9b1e3fce29c0d34a40679be5ea00acdae9ca3730d3fcbaf39ecfd28886bdbdf360aaecdf040878407b73e849e8ac35eb0160a98c4589abfd16db0f91d137a359ccef7e6407271e7b24d6999a3a9d795e9f1997578fb3333e552d15cf0375248c35afef1dc81a332a0ddd68089b799c756589a20b6a8d44d6053aacb5d01bb3c3de2fdb3478305feb8dab7215097a5a5c4f5e2e561306927a667426e30116bdc7eed5cf442454fb169e98a16fab0c5f6b3cc22e75fa956d8689e4fc0eecc8ef924a245a8808e549e0bba7148ea934c238ae5af1308b16e32c806b1665ed6fcd6cce22c407b008706ace31921973d2528e6a371b1abdafa556586ec07586d94f9f42d245f8f5714cb7ae38c23c53d2427fa58db5d70176641d5f61064a962821c6fc03834fc17d888edd50aa514ed4b173d8d3cb6f87ee0a5d5177f199a219906ce1efbf2a0906f6671f841a166a9ee243e30a2557b343568f20b5c61d084bbe27204290804a4a3a2ca872fe872f30b8f8f4aae8bbf77de105341a4ed65eaec944414e4cc58b64829f9d3aab42dbad40b40801a9ae6bce93423237949cc0e846b16f9ff8b880cc9dc1337aa8f15727f85bda5a9bb1c9f174244520bf30dafcb417a764b0c723423021feba05ec2cb339a8b5f4e5a5533ae299350da5a1367ffb5a855ef5b8a42f042373a993b0b82c4e8ba4d2d06d639585094cfabd3b701963d463d85ee6c78813a4a3dde9cba5fa5d6cdb33cf54042a6c7082ee5b1ad42621cb3cf8cd7970bc39742036f2f3384df9619a577a3aea8c784b7c6eb0f0b9ff22ce1d470429a9dd7eb9b9b339b038bafff099b131f9763f13df55f7b504874f4e05b296952bb1647625ed9a24cc19326689f9b407e0c5f93291bf41c7faeaea01f8321c3f867ccd4c23eb76d594e0970832dfdc7964e59a3a7b67df96e720d0a30a5602f64d7f6eecee28494e3ad9bef0232cd8ea0c8c65f60d91c905dac66ef3bdb309ac22af7737090ea7f67b7ad9185661ee621a406c4e80479ef6c30f2e35a817b4dfac8a47ffcdb3fabf33be6e14fbcb76e31081c74c6d279efa0299ce6b658517c771abfd2513a60296609a29cada6c8e0e80263b2e992a59ae3e0e42c575905bfaf99d1a6d8bda078d5c1641eefb3b5769c1600f23c07622f4284e6d5ef2573ccd28b2ee3d55881713433d72bfac5a329f795867d1ccd2b9cc08f22fea97162c50574e1cb5faf11fe7853d3d0df4c571ed4513f441addfb1a4b3a45abe75edc9167727461d6c8d785b5538b91a838e48e6526e804765adb5d087316df8e50ba2e0188abbd528bdc87df448df2e05196b0f0800c733587eed412372dc37fd68b4be24779ffa584df331d829a6935934885f3468cc0baa880e41e28e196a4f836ee2a21e7b938170f75424ab8316c162bfa5be5508dce72c0784a1e13ea4906df0ee9112c6fc74bf37daa57348bd61623c4f23de95eee143b882ee1a8719b8d1043848ba6ebc6a9d421c7cdd48663694d71311b7cbcbbace2586f3fa4cbd1a99b335105a77dc0b9cd45fd848b7411a12d68e76182218839be662e836e5456bfccb2a5fa0a3c4ca7095f747b7a439e7757db85eaa2a551de9d2e462f544b6723b3b1474431455b21d4a97c55b7b730f03b84171b89ebe6f8d16e266913469d04da4e5e56b05bd7026b06163bf8b1539b2d005aee58b4e133d31d0318e514a7bd16a7942d420645d6d76da4a2b3c9d5e524cdba478735d8858b4a820732defa7e1d4cf49e0e728dd26b00fea145dd21893580d85afad91cb85cbc47871c57d891eab7a3e35d6172bcf782ed4882d94b082ee07337871cc730e8bcb64b92859a42868a3993e9e402e9d19b49e546a1eb0439342e34b72ee0fe4635c639c9c3eff2fb396ce7b4a7597ca0cdc21e6edcc22e5416adce56b4b01c88c78e970472b7d5c0d4fc4cc16ebb18c8f4f2f207c7acb8b489b2c711dd2ebdc3c522d7cc14d00ef74f1d8a8daad1d6893ffb3efa3fc41d41af4ce082e80feca58c62caf855c038f641bad397d5c6e173a9ca50d7b8e3f3500e81d5418fc843838514671adbe8b2066d28deeb381948bebce90bc2d4b76e4b5da4d3322b7b01df1bd63254d58277692ee4ca769e0c3795e5cad523bc0e2b35bca6d3c17ef55a60fad06130ffe0749f8d9207fdb93f82bb5b5dcb6f9da534f214b903ec880c468178b9b0fdc73f3bf8d39d3b26d26e1fdddfd0b253bd02b427cef06b0797e7d4c205a9b66b3248a3017d29519e46b48f42455267e98349679843132a68e44051f8c205309895617e19e7d5fac7e299ee84685b669c48b52d3a6f0836650e3b374d086d7567aeddf806f6f94270758d92c0f155f0b2c6c93aa47a9da0d5e95d8162495b980751d83cee9ced0aaec52f70f8508e32c697d5d5b1abcb308f2cabad3d2ca362a0569e98981793017ea085bb83b256adab31b1162188d18ef520235dfc77970f0b866297e4153937298d2b806f6a904f87f701844a2f7fb22be1eb25ac3faf6698d0701adf5df11bbbbedf1ba07df16f78eeca804727980ad4503c50b8f7658b1181dfe20cfa3f239e10342a55bbbbaec537863351bcbebaf856f5127a99b268a07fd78a3f039b56f76a11598b6dcb1ab3c099ec7d75e88649472d3e337a3455036700481737f4c2b0b27e19031a2df534913b278fbec86e4307f6329585ff7163d58bb3df534e6135ff919f79ff21304746b7f50619bdfa8b427d227e0dd4fb6ab7409a09b11b5b76d64b94d9a9d09fc83d7550ce140744a5db9307862bcadb00d149d1bb2e89f5b6f6a5e92a1a82562e82408f497fd72bd70b0eb18cfa1402c8ed88bafcd724d490d831b943a4c11632f3fa3fab9489ed8f58868a6c5154a9ce44db523b5ac2b1d11cfd40a536f343a5b7395a08abb8a77b5f27ebc90566ab301411615c4a376d9357d746c570ce26db9a8c75c7b9843b65b5ebf6db50ac07b294545a26f037e102e83fc35378bcf4a09e17ce7e43e5fbf4bf1915584d4382f267ec08d3c948ea243c1871edeb5386ae2b63d65782cb36071aef09c0feef73e468009e4fba14e2e8bb9e2ea2518795d47155f0b359bc869395229fc185fdfff4e51a5ab0f84c9bdd59c230c0841d6abbebfa35ca3c63680b8709873db90818f8082cd8b382ed68d51527b52261253df1edc704c96afb6643d86bd9715d109e43b578743bd1023423dcee0b4baa9c9893df6ac03f443325c80b990e886270d59f7bc4344a1773835d84d619a375f163ed46cc2dc4fc171de8c9f9ac2bdbc6179d9f88570bafcda93bfe0f5d20b389b99b9abb46af45a7e01cb6808d666f4a95b00feb8490c94ed9818d68fb29e81140d7b8805c7ecf6c2cbabd7276b8af359a2b1563bf63a74da1a3d163c0f5bd2644f8ae30624ecad8b8ad2ff935579f29e02612cbdc67eab745c730ae06b8ddcecaea97f73ecd741e517dc3c7328ec09646e1b659613bb0e62e8e5ea34149d5eea742a740397d5d974f843e5342823ce2777f4111e00a2694a320b3dc45d0be503faba17b9a4577faa637172fa4d2b3b23d4d4e9b6773d14f6008b4cd2390a7dd7c33bdb500035793d4ae9f5989180454fbba65aaf7530801dd261a1f8b7aca8fbbaba5051403c9dbf920b4891dbcf8d3c3e839ee55f0fe085a0e3eb8d8eaa21b5f4deaa5a69a1fe785d3bc2a1ed6d4df24039456a22b6e760082903f91cedbad58ba2cb671e5f1d9f86be422f232a40af1d70418ae215ce7545011ba2d60f30b29f6c2c4de12beffb3cea63dfab99bb4ed23219d95f41096e6bb3bc392c591f8ec6dcc37667f698ded368115b7a48aa3c427ab16e238f4f0fa0a2d0fea3b0cdc52cd47100a55b9f572bb323f3f7e541be143e3d4b9c8bf5e3db375eb726158281657b173ef993d2621a4ec9fa108e0e839c9d37a4a181d81dfe573f10ea43839991e985b87dab1b8b933e6bb7ab47297c504cf1908dbce7e8da678bfb4e12d968ba5d87d937141bf1d968341a5fc0fa9c429745d4fad6b762a0edf89629a0c6abe657f81971b6083b302e1a872f9627d2a826181e7c28d29750ff839e0cdc56e911a6e6a8926d7fb9bffcd88ba7b4c879260b8ec22166b8ceea8be2ccf2a5db5a11a38651533b3378cd6bcd47025ca42423158f61681881ec6c94dfcf6b55b31325b5b402d8cc6eaa70fafbd40eae088ebbe96e2d55640c09241a8dc8c1251b806c63a0e8387823ff5cfc3e2f3cd2be7a5eaf428dcb1aa4cef0fed070598ddcd59d4efbc19514136ca7d859f4b05cad0ab7951f72d7960f5c0403b7629fc38799059bc07ff9dba972cf8713452a3f536f32c063b76a4d3bfb3e400c4a5d64de6960e600d196014c6dc5fe29fa62dd46ff4ded6ea5d01dc2d305d1e0fed0fe82cb3bd7c9bcea08849e642ad5df84b1aff9df047aca3fd393097a0c3ed256ef6b21d33a1642c9b04aecda09d88068eeac2bb45704f94a7b3531d33e13eccce28720c012d58f4345799d46c50a6be171959e106d906340cc8dd651d4188a6506e97fd196b78d81a6cefb3e638e45dd0d41b7d4c5802c3b76740debc2ff90ea0c5fc09d958ecf9b0dc14d22aa906ba5f3ef83adb2d012c437c3be6ce55cad1251330bda4ececba055eff9237a819a4a8b24a617ac8605f191ac8f9283b8d3a35602d21b6ec0c4522b404e1115c313f267cbc1b3ac7b23c38a7f2216b59df8ea854f7d107257f7859a025e9f9adf06685d02328ed0c4dfb7e304c083405cd38aa8402797d9a795d2a63e24ee743a6f616355088f88b0e0b88b8f49485e16c2e6fa3e3c5f83318428bc516d6e8903a248d82b384fb0f3db9e8f19044260804328f3fa84b2562a557981108607846e9f821f9cc38fb95c7178524b32aa7086d248d6c9c99c6f5130ee30a582026cb6c93f30201f143f9a33e2381d48e35ebea5a494951f9c21722989c642398ea09fb345cb83e1e758ba656b0577c04c559c5c8efa163144d623df9955bb9c7095431af1fa383a7cb5800f9835c32f16620cc6980740887be71975e341953171cf17720aeece7d0dc9bb152abdac7b52bfd52e6fd082763521fe8db86664e4ce0fc26171d8425faff3418181581c4db44659a56e8037565c39ca0001fab7222c0d09d604de3d2f6b09670643c262990fee95930e8468129a5921117b9a3ca0465c3017a2157982c3301b99e111d2b3bdc07c7ed512db870a012b3d00b7b4659bdc2cba4a8da3577dc542dc1a034f52173fbac4bd73e7ea097c07cf80d57ecca0e8923359430dbf64968767aba46cc6acfde1a37737ddba5700872c1f2e38b3d4c45590f93154956c076c214198d8f0932ef91236fb7136c027574a72d31b60ec5d6394435567e5ecda5f14b9e837fe6a40d9fb641904998feb0d3263d25730a9a7b4a4e56264967dac5b578273f9397a58e669033d8f969fc6820cc80f5ac1e1cf43d039604dd08dfec8ecee7a7b7b2d230c149fae4613a6b118532f849cf838dde576047b6d874a61fe84acdfc7475456299524b9a0e45aebfc7269a4f6c647dd044356322dcfd99cf747f322b459b473a9691485dfff6d4463125cca02d463cddcb415902bfddac64d1f3ea40b0d9c120303dc24542f1569e7dfd94cb2cb15b9b9ec551416663cab270b43bae963640f76ff1ebd842683e11f56d2843e3e852af4b684bd60224929a3ca88186f1eeec4f3d8312bb6a09de7b04c3214953182ddd3a32ad42fe5d7a9c0e68357d168374ca99201e833f6c5f9022b755e8e60c82d07cf73a76d5cb55ba8fc835febdf33fcece557e12757cbad2fd6f8368e081570f124e2ff922be6eee9977ab4176310c7313f0b06599403df0d72b77c66ef21a19900890aae99f8a4ebec3ac95587a83f4b16c9e9e0455f9454189fbcd0ded071f388c7ddd5b7796697c8e3cdff44a05f481b9f5e097c72a685f00c1ba958854fc920f2d6aedcc1e7660dbdab8b371791c65ecf164d4e9cfe7df597db438df4c5e25331f157092ba3affcbeac4239afd0575e4ae6fb9297c9de8b10dd1bfe96756e2c54b72f04edc0c4ab347b500616b0b8c20b965ab909a2cdf44f33e12e4db88575f89280b3a47cef9da967461bcc8a9ade5c4478ca53c24d2cb83452fe8400cf2421f9c9daff8307e4147a84dcce590a8559cd74ce7e45239b48f1b86409761104a039515259a05a98e2491a3d1ad3430374fd3b31831677b2a898bce8257232308b3602c6877815d4ac0b91b4adae9476235bba3233592ff8d2a937562896d90954e5ec47e499975c9e49bd4dc185c1854a8b7a52ad51660cb3ebbf482cb683ff92c4aee691d7c8613f036765f2341f1fded2cc39a5b4c1220205faa5ddd0d8737b1f7bf1e357c9fa025179e8874de1c27697daa04400c081fcc5ea680d0c3e673635436a870b681f9ca630dd6724022b128113cfed653379351f1e46dda18d7eaa31e0ae28777bc4df8c9cf59d83bcd220e5f75e540a07473ecce0d4dbd2a1b28877ca2bdb855cd701cd1e73c22a4a297c05d5133894d560b10223d9308e5991628b224b8de3fecfd6c33a2ce6da4d094ffacfd97f1063f2e43f17103455517d207882a42858450d9bd50a19b60ac100f5338f6e6afdb2691cf91362f959b9d9a41bfefb5eb4e25f5175ef973ec13344511ee51ba27e8ac42c674b83d14d6648b749bb9912b432d9beb0d8316f4935e9d3afc9f7cf2a060aa8442f0b5d44147b1e61a2ce1a668d52e048c2586818b7099839fee3e19a2089e14881c92a568e305e70db6800fb97eefd192cc6cbbe198edf99a100c8673bac8a0c552ea6e003e9fe3569cd60a7306ed226847d12db190d84e376eb4e6255012702e4e0877c1e0ab45bc8537c43e96506c710a6dce6d85b8892f0aa181e5342f4a372c866b27f951179b0e17d5f09cb3e65c33745cc911e0c3ceadd278063e81b714be9c9278bd1e659f694c4b48a66a461250c88bd42ee38942fbe80ecd64d9634851067e7155596d632bb34b9942b3e6c12e6536312fd0ab694312ba86c89f55278faed412d0e16c16641ecb07146bfdb25767540995aff4ab8af4181c75e71ad9422fb25e3a97a2314cdca749b14d44b245bceabac4a24f5ac27f208e245babbc4bdb3214fef630ba441729638ef25bfb7aae489a1406608889aea05d7f6c7c5126c5ec2c3fa3647fb9eda6bb69a77f8b751a3d42325db8fa23ef23691ca0866b6ebd9bf15317e74b251e04d402f337c21ac9ab17e606d880c384004dbb155879954d5cb61c750c1e378dca2766d3514b7f3e1c2b0051d4a2d19dc4023b6823d99e78051ec9f690d33878c4b87337128c7e700658673772f0897c6d4ab4a6f12b15635630fa1db9509561fa85a6cf9c3e93951a91106718855b7b861130f1e8ea3e45d808cb74aa9c1acc6d61922fcfff7014b84847ea36bf92175dc8de1f73f8053216c0b134c401b3e59b09f8583357f698c584167023f00500ff2b10ce9390e54732566e4e8bbe63bd198623561ada8ca93562d04754862138d0de9f6790cb9ed581eba4574b434cb7fe788105ad80f7b0122c2c74f3880d823734b68bf2b69dba9fbcae326526b10318867f2f1eb60c3faf151fcc3913df65827d3529617b1c48ac8c15fd10dc67f5867259cfe7f341d080c6cb7df8d41022cf7fc7261efe8425180577e03bcb1da018984a1542c9647b3e83a061000af6b72cb1f76ff39b7125adf6cabd22e010fc1c09ca71270bcbb556af4df5e2f46b4db5cef2087cf600d8887d8b451d58b9781aa1b555a2a53cabc4fcfba095fb6fcd35dd67a22463e743bf3961906ccfd0165a5a66a932b0eaed3bba48fa63ac7f6b760898e7e7c7b7b149c97a5de8914049e9990cc6c09479e1f1f19d386516a1521b95fc03c59130cb951ea3107a18fe715afd3442106533c0e8b8494a21d03b3090b5cf3e8fceaae275612f7177468b132726ba750dacd195c1f74225235530034d017c5be68c55eba70eb7d4c3793d4b0f9510dd1b45ae400be7dbbf1888f2c510b18c575ccfb06aa3068b9334c7e5068476b727b676502d471f0fa619fb2da66e1c94e7352e2ecfb3d585ff887fec47cf25aaea0bbf4bd81b9963c649de05b2c13bfcee195614f8ca450ed148099c0f28114d44f66156e52a62fab941253324fdad0e4ff1baf329415d934da004f59bbc474acf50f7dd0f2cdb7e2e5a6762581decfafc58e6d5c2cd056707969c058bce1594ea91916d14fcf7a54a679afd6bdfedc92f5712a7e8d1d43236a2865e7cb920f4f787f21dc9639dcf4b7cdb517f7c58da78fb916bdd57ecbddc20df68eeabbab3722135ebd3f63e09c77b2d4981c2aca3bef71f005b394fd3fe63dd4cabcbfde5beeed0d6193122d9cec50fa8bef73800cdbec3ec146863ebb3d248b1476546691a0f32ccc746308bd593f4e5897a8ccc1d54a848c6e5f535373c346038712370138517627018d20414080200529f77081dd37dcffd8d48679d4cfce0664c073e5944d208a389062a391bd790b8d8ab15c26275ccd6f48be380d97a265910fdea8d8ebd268b0ef22d04c4bb09b78d2f864666e437f190b463c53018f2d242cbae5985367bf3eb010c927bc737ddcc2dd9528bd6a78f22e776b76ebc2f264043805f979b6139cad3f68bd59fbc8c8057c5c515b6336b4ce1fc3bba154846503716c31f26fff9b48114594ef668e9b7257f8598fa33dcb7459f84ecc22b9688d91074b4fe2af676d108e7461489d970049c1ff934b008f848e4f74230e56e6e083f402534e679fb4d727e02db4c611670b099b3dab733c4263e72241e2a0d943ca2c1d378800b98e12f7a164d10b8736076e78edcc3f847d0da0ef7ca0dff99a5d172b4c0c3e4fa119eeb3149ac9dc4543427fc1c4fb69e616363da86de3b31417ec29cd73c8225a3e1916e63811d8c4c0803e1093a98dabbd721681f4427339d34cc62380111d04e8e3bd22c27ee50c9f8ced56e06f26444f9e8fcdb2cee587d39a9c42a16fab497dc035e35039eaedb21282cb28c4fc79ff9fc5394c37480230c48f21e5e148de19ca6ddf7e2077223ccee1d7aefb2614db38c079c9d649dda9ddfb7945170049c29cb2cbeb57e7cafa625b628dc7c73a3a9581676472306dcd92ed4cd05622516a25198c37ee63cf8f20c842feae31e07206f23119555c2a6e846c2d0b21d7d738070f37fc593727f4cb73ab8fe16c347caeb681c12a02523ead53fb3e82e7cc788f0103e3d3c753aff20e56aee441897286f06c71202775cfd9b54e07988c96ff181e62c74da4fb883d75f4298392fedd066411e682121106ccc3893a8c0bd8613920456127ff2a7c5c24d704612b5e7dd51742f38fd76d3da198ade09f4790dd25afec5699ff8df7392d4d93faea242e9458f5ceb9cccff0bfe185e57e1be5ab7f9f6e066daf4d1382fd69b0292e447f671532a4eea2f058b7e4432355a05eabff3db7a3536774c84b8f609edc0a7bc85657b9ced2117aada9e82ebb736dcef0fd2140de8beac515b51be08674352627b2cafa321a85464d4387ab1fc10e822e1f007a149eadaf011489fa20d62cd205254d646ddcf1ad38f728c648dc0ba940bb1cc2df3b0649f5f121da5a8e46f8451352da00ac7a28a3d884dbbca121df70c8aa495626e61ddac8a374f72cc9d40b238f1318eab0b96efeb8b4cafb0b92aeecf3faf232f964e57c94e7c79afbdfe587d9b478a884c832ab96b82a0edcd34ab14390cfd4b6be79720605346ced29206782b1d80332a27900ae558935aa102cdf141b35a5191e1ae95e06c5206bad0f144c1ded86bb76050c7d0f02c4d348b10234de1ed1574cd1bb6a59137ac15edb87985652f1135cd81084a3e912cbf5bdc48dbc074306000dff567bf057da0648a36797be24f0d8711938732262bd263d0539b4ba26ecabed7c824cd84a0a40d4bc8fb18c837de190ef3df501f8e37aeddf977c8ee875e1166020ccd0cd5fe77006f684e2616aa4f77a831cfa541d4f4a497e0c8499c4deb0cd2491caf52041b4d5404c83a046338732e06f536d309090f8f40fe9c52326ba8183ffe1349dd7b6e5be2358d850332237bb9990e77450a144abda058fda1b88d536448c663fdc3644a0d2b0247361c101163f8e825e57c1ebdaac7aa5fb64e4b2c926d53f0581b35cf8b5d0606a025bd2788f501bf1291d8a2eb05e30999bdd9799f4037fc98f9db23611161b7bf209deb1ff4424cbf0205d6466e5fcd932afbfefd3759a7380aae3dd5df718713054d8b00e6387430563e171d9d97df94af897f0e07cf2c9112a47f4f6307bb0d458076a324c52d144b9b80a3f812d86fa87ecfcdb81bd11fcc8e85256c6e5488af0c8e6db71a79ba31b3b2a5de801ba7f01cf60c53cc85b678cdf8ffc940b32ebfc54cc581b21faf61d94cda86e5446aef5c8ee502ae01280041804d7999f3c02a894362ce36597e1b155c280933948e275de3d733b24551e5719c4ee9740ec935f40896110a751c691ff554e0002ecfecc5d4168d8ac11176ebefa751b17922f39120eddabd2a6e2e23ab3cc63938ef28664139c092febece7b0d6b4a37f92ef42011c2181da523c385ccf4077f1ef391f3a6fb61b14377e6702f20e867a9aeb28a6ad1147dc246ef81afb02e6aa6b7251dba31b8ca174aed5a71d08eed8b99c96df88b266ce7ea73161baafa3fe41e887ef25cc65faebe02e6df5993578b1f6c85a7dddeb58058f43d7f3b1e4317d1cb26227657a6c113342b4a815e84ed6141adc0f7de6ad22dab0d5faec78429dc669884775b6c4413ff6f29ab8d5fc505d436c88c8899b3337acfd5b9b1ce7b7b14390d46b2c6ee1742425b99ac838a8694a209bcaa52235d0ab00c2e3d77a25df085e9e41dcd6c392fa770e0dcaf16749a58d4e949c4e9dd29b8aae8dd5792527a87c319e58956dc7abcbc6d25ab77c97c28847c2b525cf723a6982f043295bb5cb3576caa9e2ce28c5cab29acb40c5e7a50ac682e33a1fc154df7543d5edc730ef28a95d9702a733f24cb22cb64bb425254bc4106ddcc53a330a51d46e3a1f75576a02ef3b98799777b491dbe4043a41dd45fd076fadd0e98a5e2fc650e439d41cc5d530f50953e783b1057f7743ebe15c2b1d39cd577459ed57084d86c4c78724414fb30981c2c2c106342ca7332c66e9213f99635b38930d02f499d5cb2b781c6adc2a74d3d9b3fb4977be010fd40392c3d1648eb1b376f76ba79e7e078d78156be5f09026d21b161b7eb02dceb2e481793c6ed2eef4fa0d54428218491367a944afc2054ff4b989a2b1c09c11105d986df58d32542f3c2526c3da74342dfc02c2f928ebb8740bd64f90571d464576c1096f698b2706c036c7bc2cb1e3a0aed4861567f2a9a9714e3034de2b6bb5e35bcf58d19d8de4becf974fe88a7f3034d5af23ce0af505e697cd0f3b07512a4277633290deb709ee84e643c2f2aa372915ccca60dfa259f120169c619e13912b4292e2d41493860b67a01c6c5f0c237db92ffc0a2a2c8dbcbb2745647c50633de9d100d2acc5e246a216aee49d05ed2039d746f43802bd66ac64abf3528bd13d3258d4f43ae9e4ddea7a010abca2543d61e2ceacb90585c999d09ebaf3a46e28c73a6b362c9792c348decc05c74be7d13b61becfbcbd14a106f4bbd68519afcea4b252b7bcbc5ab030c67caa9c11ae4a800aa637b004b8f91811d17a80283ee8c9e26be153900d2436768d063122c9c016756e67fae21f81d7f07482dbe4ce94c2d42a94b364b904459119ed2901cb20e85d2350ecfc09379980d2a3c33ac16c30a15a0b6c7e5ed47ff9c78a98c079550a7b1da9554e694d3e5f2223e208cf5475b4e89fa6798ad2b6e558e76b0a11116ef259bd1288ff955fbaa04c9078ff11bd45c943c39c85eb2f35aafaa14df88b6c5977dbaecbaf2501b16d1088da31b4bcb1d3ea381ea93cba85b0c55c78b52b470920058674b1e8f525e01a0e58893491da264561d47cec5aa0aae8efb273de1977c4bfa6bf360b439b59fd218ac020ffc1535a88b11aeef7c915cb247a3a744eb0f0d1ab648dbc078ecafa0e2b68793f7b582418813e107c60a7f20ede06c37b241e241785a6482bf0bf404e79cbe1d6d806462d9fff711150c591314ed671a63369743d00a2912f4e743f2a0801b6e297044fc995845488162a052419d996352323a093508061de892dc172b12852c83dd7a26f3d48eba4cda63aeba8df15031cef55ed4a7ed4ac186293e32cbdcf79a0ac59c7d3b2b46c10614c11d6a3d1548c74fed600b8abd76db4b5abad3e01961128a7f31c7af7cae8369ed7e47f13a836d0f0508d0a16ab5e0ab48138fa84344a2a37c1f1e0308e8044b968b7828114887c82043f301d6e88e12166a0cda004cdbe688de723503e1aad64bd7d0d41dab5b37a7b68c330c73689489266af745b2d18879f7a65f7ae0800efe5a7e5790fcd2528e0218e44e497ed6a12081e9f8456f1638626a3474a6d1573e1718f6c2515071cf1a9f05389eb2f8cdaaffc9dfaac4c71a98f884af324b7439973dc9ab80fb2f442a81dce59033168ae70f7b71a665fd9766a22b1a34ee80b9b0bbc7fbd7ba969d4d755c68058ecedfb32c9c87e3f6de4f395575cb1c222dcbca5796d6d8d471c679df865a5fd4c3c3d09a010e858f587f728073f436be4e7d9ebc55f68516075b9ecdffdddcce087210852112f8ed0d870db0930badf0a927f1dca2bc9c36e685ef229dbaa42e1e497da129c38f3abcf68c9c303a70b453bbf440d7097712407b9677a3283b149503480f4b895041791277ef8fb703b5f5cabd21a12676977386b55c788ea97acc30a983dc865c163a88c993b1fd704c5d82ec42760881d7eb027fff3908383ea4131c6bc55ae81a4fdf6dd7e0c52fafa5ecea4f2a4b25e1368b1c1297681513b5618b7c76452f67f6205643b5487ff8cdc9ba45fdf59d74ffb55fed2afe065437ad2c8f7f9a58d53588ab1fd3f8fad409b934750fbbbbf1f6180458bdae65f22fc0249ba1fc33294e58f562478754fa02cb347f166e596c8f68758faeea34b8c2503504d7da3d19a51e94802581ea568998b6b3a72f29e67aee20b5798bcc217093f31ffc715b60f535bb79e8699007ddfa01e68caf3199e364fa31369395c3612c6f5567ed054d6e183791a454c84c809094f492c55f112e479849747b110efdd977b61b2c2b095871d4cf17da0c7c584cd97bde4679c87b53f8178f781fb41bc18e83051b81c18c54aadd561a62c01333751f5f0b6ff95ad0a57bc33fe738f1143389c32673a10bcea7610be1b883e41e09d7b1af668bed3ae0b53f049a7b2a8aeece45889b03b495ec8be9104719a9fd44520bb4bd9556663df594827e013fb6e40ee2c0e8730bbe7b13274989f642638a5a3cfd91d13d12067468b11da1556a4a3c0e0a3d678166af9500abb5c8581cc3bed5cffb4ac67cdf10a391fe8099330f9b3b2d88dc645ee331d42e0728af3e8e1db94d239684d67db9b63c25fb73e0019d5aba88d2b3e0d679e90f127a945704ff31a4338cea95f14ea3be35d2d7daeaedd0700519632a8a67a929c23cf9536a58fcd0927a6e84ee36c23bf9e49ef834aaae9691e6a6e1f7806af3d334e5f437522ae4bb21ba644172baf2d7cebc279440b9ef521f7b1c8c943d9f20ffc101a7952e960fcaa419c255947918db02df09d2e0bc6039352e168380a2cea72ec10f3dd90d9321d3acffba5fedc7659be32a89a01f63bebd48ea3138fd6292d872e1c05a20f5df729336e7a0970732739c4f874dc99db73fdcfd17f1fac3513872c933618a2e56a83d9c9c64d85643114e8da168cc226df650e7b3701a2c6f9d1e6ec106793e72a474888d6171e36d62f561056b91b770a1fd672cce985e97015272e83b6727b092befc1fa3fc0fb68d0eec11b5c26cc20936956e157df75c28666d0803310a321dd14d27340ddeecec8a40e0d73aa9b9b3abaa2185339f4042f1e325017082eb3026d3259ad12b18bcf7381efa61beeecee76434a523bea2f1c1cce33d06cc46d9252d69a709e655b6992f8fffab22eadd8cbbe4afd64d7f94868a25cf93064b0bdb86586bd0bca82a5568dda3e772ad13e48317700b297199454519be18a2357605c0a8b4ac877093583fdb647935a145f4c75bca329f3d39a51ab641f31d8880f46ddec0b8b5b9253c0b90171a2719f6ef6d13e129db6c5d9cc6a3a235279511947e22d3ee8905640c0b4d207d8acf02052e0f8b838dff4d5dd45d1d6a7c19f30ea2fce9a0b03700fdc7dfa8408332a9d2b57f421cd64667c056ccdfe8fdfffe47c2aeb370cbf4fcb921b5cb1605ab4748ea239fb8caa13c242e6d2e96db33635ec6c7c3f03d691ad630cc5ee44d39e72b3c49a391c7470ce2f4a7f6b3dae50eaa752cd56b38ae1a95c15db8201435fe63419db01aee857b73f6769431b88a505209f6c89093c03eb52b6c5c90409306344b1bc338764d4fd75fe8b9d218fb4cded9288cdd90210f00c36218d4feba89fa79a09ac70f3427187435ac18bab7b5592b636f916b5cfbe8ce095ca23dcd5bb337141ae8117aff8f0908587efaa8ca7e0c26ca5d0618dc291addba40a232ba0bb3f327b152c49e0cb0c004e0776c198782e6f57b5c32bf5908b7b3e35afae1fc5ce35b011279024ad6874ee0e942d79c902d6763f9bcb1cd646fe6d6b7bcb99e7f4b36c5a6b9b68d50de3ecb898bfd8515df0ff1d418e7b0e98e2bf099fea08c2e5bb5324f35d01ddc39a63c83311ea830a601be468d8a834ed6b2691dda23c406a9a5c170c88af1394fa39027c2a7546ae441f094164327f7a5b3979f7ca6776926940355d6e7b770c8a2ae8004779f54ed426f029f13820e125b02605298585d3e970a9a38372175c7c05c1c0375e787a7ae3bc050d9b5d045ae515c969e8b7ad65e02f6be0756954b643166864f8d7c4acb74d568af7365f90ed1c2e78ef17cb8e5d63d09e83bd77845a32b119eaa630508bcf95489bcb4de23da6541e97f2cd313539bd5ece5921c5dffe8e86af3128e6c071b161f49720bd05124cd4379ca39a6944b3eb37cf503d6a3cbf67c10db089f101a13bcb40d82682b659b57e639a165a4a689a4b97c10cbde34f9cea42af8774c8b5c928d8dfb7b7fdfe7780d4b78ac8461aa336e65178ebdc410593912d9a148ba5ae6daee1c50a1039e1e3b9904b78e082c0a09b797ed1c431b7ae057aa623279ef3c3f734f214957235e8a4bafdda9f23c2b3256b1984b047a876403efbf979e3b543a2a7b977a664459e70cf84a303b404cf6d7c199082ac14e1210a7d9336148966d80bf981e5057a62cd2fc917272de1cbfd0068ef3648192639d30b198964b7dd5570a6fc52c38c9b6d617420c02894bd62ea575797d0677bfd51c3055412f1c652ed646ce9ce5491cfe4da2e65f0a33342b91c38d4fdef9ec18e522bd10a18d678fdbd89d9b97f70a5e7ea41513715d73bc3f5686e00f62b4f520b1fa85902604258968a5906d1b1198e25d02d0cee484048db9473f0d4f915280fe243afe778d35467026ce7bf22a19c483680e2a05a1fccee52f4243c90161c35d8fc6f455bc4c6220b691962089e56e2bc74dbbb238d8db362084d8fd0a05d9eb01c0410049eadca6c9b269d89b3f940ac5c56c1d98fc1216c411239631bb48fc7567b800658ade6458bb81402f35f0d9a8a1386578661209f1250290a35137743b857458c766d507a0e5d784f63500c33752f4008dca9a0ca4bf2cbab5afc74285bd9f6f0e837163f587d104aeb3ab75d8f7318b3055d2fe8b05d9c4a1be420bb51aa6b83a76048f067cb9fb1cc981965c437ea27d67df94e0fb2fdb067168c3e0a65c54de66ec7f065882c5ea6bc98bdee54d76fef915e733a7ac61301c8b13721a7afe8bb32e6b5fbc5a092381de9e5b8142066b5113dbbe55a58362c35333a0fc1bcadb1434af3d58770e5715d9d7e532b4b39ada339e3bfdb14430418d45eb0428c589abc9c79659e3895cb041b96a046a831793259fb007fa12329b409573191a1a33f7ab6d8522252444ac841eded3a91ecfa63d706ef1149c75ad83601f2316018ded38e61e57aa946914a97e8f3fac9eac0d1aa25a9489dfd9abcbfaf2ddfef2f961d0f36677abc949c0bc3b4e80f37ab28f3a49042653b1a77c9e908a8f47d7defff205116aa2bcf5b0cbfc5fdf4fcbbf883d083f252cf3fd86bac36dc52974409a5f1eda5496f33a09fbb8233be05eda3485e4865a4200e73747d9b6586b2ade101f434c918fc4fa2ee063fb01b09ff3654d83760290dc30e0809ef996eefb97df7f7613c61259af7341c1637cee6b473274d13390c752d79c6e4de7a8c35d08b9dd4066ba20c66b05be95a32d2f7fa931d611c4b836b15404102a6b497b198c7b0e34941a3ff2e7d74b350ec18fcf800d8f5fc75b22985a5d552c856f062cf94a4ff0236c68bc4b1ebc257fc49936c10a6c314a6b49cd4b28b1e314a871694abd4312b73930c86be37a9bc25a6c8db00a82daf865d6294ddecd1b7a6b644455c4ce0c72f2d511fb6d601c810e51ac9b14bcec5a1e4c18740465883debf04f1799887accf1a79793d09f70fb5e97d9c6612d2024ee7a86aa97fe91845008e55a143a13269be0ba233d14bc6387ae7603bd79af80e918bb5bb87ed563fe95475209ae3686bf0018b6dc40d17383268b01920d002eb0b687391906d2bc064c2ce7a4f05c65db50cbebee73e3522b7f0ac8a1f8629ac70f7ecf38641e96ddf2a25b35a9491e253ac36b2f99e77ef49378f1ce5b8f17a6aab3a28cf735eb368bc59fb3e85594fa9621706fab7edf1363e44fbea709b75b886cdec02f8a198554625d5a9add9c2f437863ab85fd1e96cf9bcba1725b08af3572a7d139e1e5c47dace4d88baaa487ddd7b600c3c9cde19c68b8aa3137a1c4a3732da69e5541a8de3b06284b0280840c8a76e0d322a046b4ed4a7e8d880032f81117dbb96e1790813523ff2a0164c9552aa384004d07f76ff2960f568862f7d69c41bc1e4e8a1b8e8aa9764f3996d98db7d17a4d8e279ff3c69f03d3aaefb2c279e7b90ff515eadf9b6fa9c1acf46be574bdd696a1e26b7ef12064599640b339647a709e0b9988b942e3a0e0dcf039c16ec81ddc4f4c918bb67c6c5d0217e77919db5bf8fa9724a480fd8ac68acd12aa490d1d5b5c3309ea87ade9585404f39dbdbe0d0db1f51db715b2c383b1aeaaa96ae4f88a09ef8d1050382366b1139a1a8375a81238bda3a4fb99c6070903166c30ecf42951647647848e36c3d677a4065dc915187f965600a7f82dc0cbe8bd67d8218f3d9ed6ae86cccb7cb9afa2b54b223644653c1f2d7491faca85d4a80d4b41bc293610c3352a32fce854164a9a74436eaf79608f891838ce1144586a42a0cb5c2a4420385cab1b8b389e8455bdbc6730cc9f71efcada709ba44487410701e26581744e03adc9879d9320cbd78d4646b9a4706cca82689a81a8d29cdd59664aa191c1c5db7ba6d98c3bb60b3e2938086ca544b6c748ca6c67831c44faf93992aef6706ff3c7e543f65d04eb4d72c1d5dc3a6599c7637c65c9749dd3b865c1b4aff6c19393d1d72ee6e5b8f0b8ff8488351fd0270e6719c5c56113f8480549290e20ec486668e0bf8fe83c809b2b9b7703f12a4b88d8042dd34f0805f569872928287137b22196594434f36300a42446fa0c578cb3de73eac283539b58ea57572a1a5ba27420ccb6a7f30302afff4f48e0889827de15baaab187dad6e10b5f71cad21ca5346c1b8d3bdff1e89636642e1cfa8d4a792e1b8ce82ab4f300602d7c8c87a7190a06a9287ded57fec14470d4f4d76ae40e26139a5f3a0222df7d71a38049907d5361353093686bf9920db0529383605f569ba9609b1c70f79e6352c344a43203db59565efa7aa5784f1490d3ec103ceaf9675e5607af5bd70f84f2fc99d5e5e064d0095a9d072a8dd043cdf451fd9b0e22946e31c7bdacf78a1dd47cc395c24d349afb3050b1150030499d706236fc56e074d0e4a3d30c2fc3d962d9f2dcef14744e32594068605a222d8d11caed64c74333c5ec9ebe4aa1ae26dae8c0fb550949eca853872d0c4b4d86a56fe16f2b95f2daaf3ad50ec4647a0da717502578eb872d6294e878c3cab5eb9e345abfaa86e5d6ec3e1a98e66de3f75883ad8490f1e6f2d0196ee115f1cca89256119f2bde79333ab71b2a9a3ed32979117521f110c20484195233e4f425630bd33edf3bf132fec156adb76581815c1349a637e1631bf1fbb09442e72dc5314cd7262cd40cec6f9b49c58469942b011200a5b22b1539f8d873a80a78b2657ecda7e50bcf8bb16a08b814ffb966d33868c7b7500f5e5d2c1c9773f880dde59c0c3946120e48788a03b423eda1cf6714cfa2df71bf3b695e31a74243c19eb34b050a6a03c50168fcea7df3d6be81b41cc6c44fa79b04f8060b25f40a20afd9e51e6154712f6b50a982bfd9dbd105a3f7820049333877776f02d4549c0361bfcc222b750f52bffa0b4c9ca5dc9ef6df9fc994747224e4372687034578cb4d24f3a980ad9cd6c88942aa05a872c4c42ced7111a1b1a9c786f3d8b82471fe15a15770a9cfc1587fedf73339de4c8b2f0d00c448bbf396b119e23312c6cfd5c3200939c5e8d18a307e6143225d8a3882014e53cafd9edc6926d7ccacd97c06e9a722118eb595e3f6d3957fd86fe9ecc4f44dc97d8ad90f464a16e8936dd0e78c669812e581a1951970e44623bc21524131e843c44324ffd90574e5b7358d1badcf668dd96e1f531caa46fc7d911e10fd880d62add9420e185cd25e3714b3631277a4f5a1f923b0047affa1f6095e95181e9f3c47838a4cdbcaf15da7bb9a02bac89482ef639948e8e654e24c9f5eb215207b40462976a43eefc481d89d93b878a3684d50fdf9e638fc6251a6d2eb1af27af84ba110627d3b8a38b2ac7924e81ea019594b3f989549fe8d92776ba2902e79927f791fb78956edf10094c15ad1cf98b63f58f988317e3f0749ccfe6dce4ca44f698590bbc25e1adb09775e829bb89fbdc9c91ccd1f2db536ffd75b9676a79e11e69723f302693756368ef515f16b91895f133a3b6118cd94611e59718393c3f46d39dd575f9b379009e7ab0d207dbd23ec7e295b40bdb693e659ad94253ecd2f0447ca626e602667597a2685abda4c3b1130aa1326df2ce1f8158b2a17436eac42a9482402389de212ebc4edc59ef0f88ac8835f8b1c820500b6f9a1af670ee93ed40bb2eaf9e252fe39a900f623a0d49d9aca0f1176a1321a1ee28d8b690f8c1cbd037bb33704736cf8086f7e66617f875a79e098bf032a59726ad94974f0c9cbd4a40346b2e81128aeb5f86779ee5e8bb4f3f937ad0aea2c8ef663a9d2d5cf552dfbaf155ded56b848f4cc0f7dc43cb66c01483a24895bfcab8727cc180a93a0e252bab4b8d79fdbb93539ef282221d859d8703ababa5cca663f062fb03428924eb5eab1c61228b116526557b0ba094e3018ff8f6664e222bfcf5b6c412dbf81eff9cb644975c653abd25a20d076bd584e8f99c9e17ba3a4e8ff1778176b6f4e15e6a7aef2e469a22a95bc0918bee8e6f88cb377da73e1a2aa7eec163548fc00aba6a0852ac6bed3e891acf580bc5ba25a0dd8f345c909e1401e725b507b814f18e0326da9b10ff2e7e654afda939719c757a73616d86b4da0c019b387b1433ee9ee19469709aeb8aa762f169032d1dea75500c041bc70de7b72608b88b043ba829abbc990eff2ea92ec9d0dd59880f891f22be98ba40fd0ec0a4f85c96ed2e4292005a9271a0a1c90b7b3915a8a7e84a1bd93410d5cb91ca1d9bb1d7b0f15b443599bab23534f86f830e47920ab03d1e050186d5d3e15897a8f9dd10db2830b6e568848aaa36cc50eab2ecfff849848d4f09c04d2e073a65d049ac63e4e895b44ae3c3cbbbf542a9d2ccaf65c494efa5bcec626c23bd61aa96ea8e844d6caea8b0274bd59fe014d343cdbae608a15d48fdb07ac4e4f27fc56e35ce86b38a731355cfa0ad66e5a6a3438720ec3b4019346a4259fa24f58b48d99fb98c18e68f70133f850b24be8c41d4ab76f4f4b5ab15dcf177a0d36f16d66ab8082d562ea7b75a8186d6eb736c22523441190eb8649c8c9074a0d962008dfd1c1cd95bfc017869a4a459da1df9d981468043778e02be21458bc210c92f97e3325587ff79b8ee46133da6315f8d47942d0d7d71b5c471b4ef385ee52da6a4f704ee76ad626927f4f54891fd90776dc1a5fefb9c5c746478e14cc6773a59667c1b6042e5fa380b725e7d7007e8c88d6e0b19a9e27a3fadcb6837c27eaabde93379d940298183227d5ba9d1584fb22be5fd8d53d987168af7c8b2b073db33008365d5a0978bb99df607bbbd7573ddf960ea7cd9d7e9a5ef24f8506a7f9315cf96508dd2d81aa7c8e985ab8bdeeb172ff606204e8abbf855698313b3ba8c252521aeb9b3d18c0a50c94474632a7e7c921bd645864f4548e1c85ac88b28b14ddbdac77e173df2548547c14e1d38caec29032de96953bead0ccd51c6bd6da439a5b85edcc915665a7e285885b875684a2ece0414aa67e254f5552285ed083c90f2a39ed48d820aff8e56253121d39948d8fd63157792649e33553033ed1e76f35fcf2f2cef0d711fa416afe36e35ab55c27f357732f3240ec099e6dc0308aaf63ddc0edb54c5dec5a935d8b170fb36fea4f056a1b806223bace51fb272cc9a7b1c5ec02c1bc684ca90e47a1441f1182df69d4d1d9fc9c0f881e2e9a325aea610068d60b661a30127d105890efd8f5b35e8581778e3296bb262595ee2dc6f50d88c3b88f4ff068a62792b0d19fb3612ffd6ed6589efdb07ac10e5f3c651b1b195aad4ba3f4eb1c25708562874aec88167e124c430a56534b6eceecbab0c2c07268a768218de095a2a4ce529f6227f2dbc5370094ece614f5228298a91dccc1ec68a65c30359e62e9e84922a30cb2d2a6b75add41dee9e6403e3fb8e1f2cc9b46ace179b17623c2606a96be71cbf5c2e0766f7bc3c4119e4e0d7ff21478dedda1142be92945e297bb989c216eea52907cf0d0d667e6d44d895201474d77176b918ea13e55aa4ade690797d4363844626b9296b76feac06fd0cd9b0fea38516e84418bcff387b51f6faa266b9a15403e896f75f6c5df2ee1d5e4e0f82b56fef10f0c36cd7cd1bb5cb1626ce013c80483daae9b5146627eda975975d236fb5d3fa60896a748571488cd110794a118cc4e4a2ec51bb220cfd29c50c2481904db1d7929433799043db05c5f65745a418760b84ba22b0ea479fade83c26b943fbd7501ed3b9e5fd7f6cbd68f68c94ea5b17c4b1edfe33af13ac0ad8e2a462f973aabe10e94f1108236299365f8bb2b729e0a15eb7ef8d32200d9241a25d0ae8f0a722af789bfaf7248f83c403141228645df1309ab40140ddcda515d5d493b0aae3a2e588f64b0fe467671dd0bffd8d8efe6316c78d650e3e9cd3e37b522dfe609195af94fa763a1102cb4611063bbe825c19cd43381df8494bfc03208032fe06d0a4c1d22528cccbdde90ccb60369f11cfba6a2a49cc29f368fc1551dfd2d33afe34033bb3e15009235096161dbb6e191d4f2fdaa53bd00ceb62d1c3e86ee45e17f82d84c5bb96000df66bfba79dff84e10e3367d7466f0eee5d129c5041dd3f8fd27756ac33aae304e422821062ec1903e20b913166235d91475645d6c895597d98d1d468316b670a3a3c467d917bfe05ad958b308257ac477746f8595470f9d54fabac538a8bd602fddfb58f0b3d3eb40dd6a9aaa4afaae53d22b4f6ffb1f2a553330749396f30e7e6417395bc8a68b8b0f982bf5858651fc88207f6f6af6e6b9e9c4407a2a5ae1a3dcc1035603aa848e1bc2fe3bf43bf2f35a056f5849f976ee90a23cef8ee209824e0aaf9f468163255aeaaa87b4037f200d150d6e21c4142a87d72df3c09f431d8f161ae10bfe0f877995730fb7844addb35a76e7c637e4fc011ea2d5ef176f7b8442ff520852a52ba3006285867c5569e9c103909310c95e5960c3b966405678d963026e03b9c7e9c75d68f0f939ecc540a798b63b3db95003e407bf34c1ee06fc74710414fd13948f1ded6eda74ffc70a6e22188d0dcb5b6bbc0dc06d544f5e3412a531731eefa34344c72a5031cbf0872765cab412795c74cd65bfb11e77acaac22c1e41f92a53e53338ce6af77f0f446ca4e9717ebbf09b6b1bef833961d00a33db176f710af82c8e9d63f98c7b041587b89c60414dde300c2100ee086333157afab16046628a09f55dc892794abe5cdd00d8128fd50f1c80a7c307dfc5cfe1e9eee7d13ef34b51d1c262e8cd98ea2b50a6507e682d0a5270359a9bb26215bd9ec94a497c31ab6af21cb0aad3e6f452c3a84b89a718c99bd821d5f90086b25333f5d70d31156902d17516e41e40d695a6bc171c2e1c14b22834ca56387c210b395b7b8cd9c87979eeb1f91cbe3b0c10c4ca1be68e1bc88f9203d6a70625a93ea6fc0864df56bfd79f3831c6d63e47ae005cc0b302c9d97747d2a92d691ba307c87a2ed1bd2466e443e0d6197c700f051eb38a2368e5dcc589c6723fa4c109ae40b08b785b6cea021bba13e91591dd313e65be24abc76a6e74a11a39c9cfbad60bb4d4f23621ed8461dd09ed10b1f2697d6abb4e242dc1b561cf4013418742602c4c05cd6e8f88ae75ad9f92852a2aef4795a503ed733fb560694e96f06dac19992486f57b634ed1f194357bba5e9ff13fd06eb038411bc12ddaed02fe8e348c7fd8e09b380e3092bcd726351f6cef4748c1f4bf9b97d4fd909da5b36b3aaaed4ab763f7fa24ebeecf376f893a7976ce29ea438c097065f287b1c40c8bd0bb6ffc29eb7991ed759c4029fe9e3d3f48163240e427b874ac8f8961553c45e87443741d992798c3f235cf6d3b09c33dabbca778ddf8608bff056f12a634381712f2b6631f50415bc60a7caa6f57104257165ab24456a214ed265fa7f8d55d1a4f4ae51a8abb92ecd2c08e4fe8478785accf8e24cd2cef9bea6c44e16ce1cf537668f92d8d3bbea04fd0486e443848a25f7a3b7ed209959cbbd3173c7d2c0009e75d1630b08e2fbd1e9992b95c7fd841ee85c4e8d6c6083bc7561403f8cd215be40af7106588ebfa86bd3b04d615dbacf14c3b9b825249e3f4cd465f40ded2f2e21574a12d02f7d4f6b35a7a6f5d8e25c65a6b4c0c6ed6b777d15d34089bbda26ffb736fe639e895e34b84da5e2c879a1b5e104386113b8df7fd70c4e8774d184f3c0f5763c6d77d2a6362a2e2bb87d09fcccc96f0a955d3edae684e08dc004320acd0830f2a2807e0626e4d6901757b029936222a416dcff2dcb459a5ed4953f373993891f21be4a7f77ab1a50b1369ff28904e59b98d1c2703966a2dcbbc155920b7f469757efc59e48aa01fe526b51f986459c1e5477d43a20a40cf38feb0b0d377c2597418285715d7b8043a0fbcc824b44b3fa3b1d463718963495b251e9ef54ecebf85d8dbce1dbcb8dd24be2160ba762090ae517189667f06f47ec37ef913ef09dacaf60050cdfd4489643a74676d1a027eb97ec061e41ca0a87c6b76194cb2285af053b74f0214a5015ac257ab6b61f4cbd3e6adc7598da15d91b8535446982e7a323aa2fce37fa85cd0c190b6d6c4b6f3e01c51042848de738ba0f1a11a98f498644b8713fe0b5c050724ce1264b817ed2b53ff29258af10b2783edadcebc93e77c8f92ad1961f2de14394afda637e4a4b9a10a7216a15f0d0dc6066341ea9308145923fdcd0d53d39736ac8805017daddadb1f0e070273659c3dbd2d6e31cd393e40be06becbd4492dd30a72425dfc2d090c31cac10076211571424235dd18a57e4f8b3e877cf90f478253dd2d485d1c2faa693b58d9b6611724a12fda4ab79d3739d5e5a3c6aa81bac399a93d830b1a97df6b891a18bd0e730cba35c21c4d62b2610179f06fe5086a9dacbeecff6388962d64030089b642b497b782153c9720028490d0135ff7d141d1e72af1ec7fe6ccbbecde8b8c78820942fefd0174f6d03bce71b86b8ee2d0603862db868527157a6da9b3b1b73de888477fa87b45a2ece9df617ca68b53a0d958dc5794641204b06efd3425f54319b6b62fa66b3236000e565369e74f0de76c27d6a77bf8bd53dbe60b1ceb8b03ced054a0fdbaf4c08f98a61ffee9d9734710c83e12c2691509847e7eb89c1f69c5c05f933431cc9ac71c587e1d3eef7d98b7cf81ba55db9fecff771d861cd6a6994134b417d9bc1eb91d027fe9f265c7468d615be2860154444b8f853ae6de94e27f4d918db358a06ecb4adcee36ebe44a17a696e77331e21e89f440ac77eb79416ad038dabc18263ec9843622cb794f79ad35746070be26e70e6f4ba5fac8e7c55a538818cec48962abb542548f17c2ab102dc2197052659ac969f45bbc268a5c0c6226db3529aa942d94554b2f63405c3d50de98040c824d416ac1405b9227b2427f277c3fc31e94c7d4426e2b15dfc309effd27b4f7eead49842d0bd15838640e2c1d3c4307ca2e0d709c51466167de2229d25b355f2f07c8d7badcea727a6ce9d1b7f680a98f228c651abf2d8b74432f237519d90fbd660fd64d23bd61567095eb705927b43c80bd5e99e2f5aa2de7f45490d3496c3f28ccbc7e5d0d8f34cfd5ec5ba56a2c4072dd12d0fbc3682db898f791720a4496891a17258348e3c0dcc62469ae777d5e1add6e5bccdb7e71ae7eb4e5f0dbcc08150f1ba910d5cb4eeca44cf1e01aefbf0661cee0b0886ece71322bafe1360be71f93a30f7fcc47fccb5aad455d53f544c3d070f3ef0c712bdfe79150e081d3ab34ee576cbd1137c1972ca447b140eaf36b4fa6714ed3b1886e5c5f1c18063bd095103b8013ea3153e04eda971e1cd193a0d530a0a56f4e3725c2ebff6a4031441cffcfeb8ceaaf746bb9b4cced6bab3180eb7553a7fbf8a38cd84df031ca9b35aa35c37a64a8a21d6c2f0bb8e456b0935831d677ed82a09ca89062a6ac9b626c8e7061346e04f9eed34fd2ec867fe15ca7cff9c06648367fd796990b5f942c78493e6a9016e31e06e562c053491518cfbc3390c0ace33aa335c35dd4f20c97e0ff5fa8a7ce7ab8dd66fc90524485ef5cd9182e470969510ce3dd50e7c311f5acfd1c537358a91e4437c3e35831d92949dd6bb45706ef5c80d04fe6250cd3fad6520b7332a6c812b82453f83f4c5c3e3dc6ed8e1966b91019ed634d50695248f00ed0aa18b5eb97b6563330d22a4cabad04dacc03dd1cf06250d9fe273f34974a4935db8a85a0156d03b52f92fc5437d0975e3d28063797e52c8829169a1391bcb03819789f09f32adbc49fead961aea2ca76e7b10586fa12a5134d10ede6475fcf6fea0dff7efa33a68cb84e76d1f8a82b122b1c4afeae4d0f24c85e7a6b70e189fbc0050bb6c366828c7c58fdbea33262c15b3b49b0508b4fd1e539972ca4a2ec00ff28f29926be86841b531f6f6c9fd31c52cbfe8dfbb1a2c1b814297172250374d2a5835748e1f719a0294b19179d9865b2c3773782066d3ae3b33fb4e48feab9a504eb1ff2eb9c34dfc012d09357bd5057b18e01d87fc574cf8047971aa50f82236d8b0c642ab1eefaf384bb515b0ca0139b3dd9ee234c409089b6db3b807b21c48b89716a83a0ae6e6a0bae3caeeb0cf9b61e8d6e11f2cdb7f61a4bd43e03055ca19353dfd960231f056c2630505d9b0817667bc227f9262231e48a3f42c472c67caa9b1d9565af41b542bcdb30137616e5375041da618fa5a20f7a694e2cd707fa654cbbb2f022ef82b213cd37359cb0b3af405a4baca60e2564344be27206e469c3150de22056d79a05aec5b95d29f96fccfc87355141a373690c1a9d07558e3a7571157d9cefee34100bf9dbd204aaf730608e964df02904d4ded0c48a697a1219f9c597bbc5973f2a246501890344b01ee2e42bc99f8c0ecb10cf51902adfed65b064984da9068bc9306e06cb29311a3b9f817dd048ba387bf63ce67b62f7a8212c6a3295ebbe85df391e267912213e1d275253478b8607f22d2c0c85d8b5a4ebbd7820b4ebe6e491133765f9a89317826772a649a5e6f0345fca90edee8a98b183330f92da02faa20566a7699d0f2694512fe6b09eb384ec2edef92461ceedf9ee6dbdc2da6c4f32fc4851c80833976b52f12a4c9806f2930cfce794f3fde82aae183a6c2b20fab89007b960e29ee01125c269945b86ceee97b8348f4fb93d4e38a60120cd1b3e465f2874343400307a27942cd25ac541c1f83afd9d57b5b3bc22843c3b34cb9b5caeaf2fb32aa67cc3e41a4f7d1b19e6bc5dd6a2e6281eb8ea06137bc4d6b054fc559aea55df6c0a3b8b0591182d9a19145eb46d30631958bb278f8a4653b5642239aeebb2401f7a22d479a4e199021975b60bfbfb3bc131f1ae28330443d30029033ce6d07e1ff8ba4de5a1ee579f5b7122b38860f477d5b42c6b7e1da835d4896e55fd3fe93cd9bb0dd846e1930d5c827f3a5280acef2c6af2f2e3af64f912bbbb098b694cf8842a5d05b9a69593b735837989493076a2f7a4767d9711a47583f633ca14d9b5a7e7d73a1224067e063509fd4ce44a96913349e6c4c8fda5f4c4bf970f37b2944d13019344779a0661b2d34e9ff6f4aa39dd03504e3bf901d1ba4e6333e47f45fc9457efa5f0bff1d08f90dbae816d21b213a53a14b60f7ecb2bae0b22890f396c2026046f34e7dd30c95c9c66a1ab13decf38e285080216d871f3cab96dc6423034f2d572f903f5ce46e73c5e03dc98aeba7c1b7d3c067b2a7c22135c87766748194f05536b858cdf34f146cc36db0cc2a957c1025be232e7616c14c0c9dffac18ae200cbfcc40660dbd9e05bd7a87458b8d0b2a6bc8e1cb2f1594a62e877561e2114dc2a313f501a6238ec1cc518e6aba7b080e1640f079b40092b623bcfce968330e7635f6e6ee7b76eb8414acf7a264d0c06834495fde76ea1a80c61af2072d62b382f856782b91bea44dafecb1af147a890d8e0fb191cf615b5cf888084cb721c3848e557a924216b1292195feb3ebf6b125a79f67c1a4afb443f90d4d73c8628bf18e62ce7291a14339041aa2c1ebe808f0ce7a8f5f10e4fbc190014a5095b5b189275194b6d8dba6429f31ae2d4f5daba14bdd128ae0a9442bf86c4cfc1291f2735ff731f4620e27e30bdee20f6cb39c33ce0fcd98a716f837f94c99ce02fb2eb00fd51b50a10db64c3db11e415b94098c1dd65c39cb836a53ce98d5f7bd610eabd72f9acc51eca034900eb482084e896c68cc478953debf56a5b2dd8f262ff73e985323d16d55ed47f7c37f41cd07fe77d6eab363114d451132ba2e3360c8ad1363b9f2d95bd180b1b445862a8cb2ff2bed67c2d5f1b895fb5d4aab10acc33122c03489fd98e34553e8131083ef6369a6fe6d79a0ae78416665757cdb0583cd2189d6cbb3dc8987769f8447d893c0d9279574a8fd8028cb71ef14f3274d72485aa94156b1463eceb11661e45019aafa83ad08d0add099f65a45bab526942d6872a16e75c31b8a87c87054944e927e3860059669783c0adf7640da9c5db94c0c20ef0f1b0d9587ca031800b4941d92105c256c499c5e4f3fe292342b2ea89ec8ee9dc2423489c9816fd395c22f828247fb3c971b3c724570bf97e24a161a6c6f3b02a9e0bf393bb0e6d713b28af72b8ba7599e010101bc7382ef0e67779b8b80ce39dd55fe35011534ae510122cdcc592d2110c6abfc0a73302caec4acc7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> test </tag>
            
            <tag> 随机数 </tag>
            
            <tag> 贪心 </tag>
            
            <tag> 记忆化搜索 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dancing Links</title>
      <link href="/2021/12/16/Dancing-Links/"/>
      <url>/2021/12/16/Dancing-Links/</url>
      
        <content type="html"><![CDATA[<p> 跳舞表、舞蹈链（<del>神一般的翻译</del>）</p><span id="more"></span><h1 id="Dancing-Links"><a href="#Dancing-Links" class="headerlink" title="Dancing Links"></a>Dancing Links</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>Dancing Links（DLX）一般被用来解决一类<strong>“精确覆盖问题”</strong>：</p><p>给定一个  $n * m$ 的01矩阵，求最少要选出多少行，使得每一列<strong>恰好</strong>有一个1，如图，最少选两行（红色）：</p><p><img src="https://s2.loli.net/2021/12/16/s8Ka6MjmNoflAdY.png" alt="精确覆盖"></p><p>这是一个NPC问题，也就意味着我们<strong>只能暴力</strong>，但如何更聪明的暴力呢？</p><h2 id="X算法"><a href="#X算法" class="headerlink" title="X算法"></a>X算法</h2><p>解决以上问题的暴力算法中，比较优秀的是<strong>二进制压缩</strong>和<strong>X算法</strong>，这里主要介绍X算法：</p><p>看到如下01矩阵：</p><p><img src="https://s2.loli.net/2021/12/16/E3AVZIfUHBYMinz.png" alt="1"></p><p>我们先找到<strong>还未满足的、且包含1最少的一列（有多个就随便取一个）</strong>，这样可以减少枚举（这个贪心的正确性显然），如图中红色的5列都满足条件，不妨取第一列</p><p>然后我们取第一列的两个1中任意一个所在行（蓝色），由于要求<strong>恰好</strong>有一个1，所以橘色行一定不可取，而绿色的列已经被满足了</p><p><img src="https://s2.loli.net/2021/12/16/SMG7CzQPv62heTb.png" alt="2"></p><p>显然被标记（蓝、橘、绿）部分已经没有意义了，我们删去它们，得到更小的矩阵</p><p><img src="https://s2.loli.net/2021/12/16/A3YHMKmGJOtq9h1.png" alt="4"></p><p>然后再选，这次假设我们选了现在的第一行，第二行也会被删掉，得到一个<strong>空矩阵</strong>，而得到空矩阵的这一步操作所删去的行<strong>并非全部为1</strong>，所以这不是一种合法的方案（如选则现在的第一行，现在的第一列就没有1，不符合要求）</p><p>怎么办？<strong>回溯</strong>啊，将我们删除的行、列加回来，再尝试另外一种删法</p><p>以上就是X算法，它看起来十分暴力，但可优化性极好，因为它含有很多的“加行、列，删行、列”操作，这提示我们<strong>用链表优化</strong></p><h2 id="DLX"><a href="#DLX" class="headerlink" title="DLX"></a>DLX</h2><p>DLX的使用必须满足一个条件：<strong>图是稀疏的</strong>，换句话说，图中的1的个数不多（<del>但“不多”的定义到底是多少呢，我也不知道</del>）</p><p>DLX是用了一个<strong>十字链表</strong>结构来优化的，具体的，<strong>一个为1点将与其上、下、左、右四个方向上的第一个1链接（如果走到边界就循环）</strong>，如图：</p><p><img src="https://s2.loli.net/2021/12/16/yqZnMdzvfl63erE.png" alt="十字链"></p><p>明显，这个链表是<strong>双向的</strong></p><p>同时我们还需要记录下每一个1的行号、列号，以及每一列有多少个1（方便求1最少的一列）</p><p>我们要先建出一个空行来做表头，然后类似于链式前向星的插入，注意我们是每插入完一行就要换行</p><p>然后进行dfs搜索即可（dance操作）</p><h2 id="代码和时间分析"><a href="#代码和时间分析" class="headerlink" title="代码和时间分析"></a>代码和时间分析</h2><p><a href="https://www.luogu.com.cn/problem/P4929">精确覆盖问题</a></p><p>由于l、r、u等变量名很容易重名，所以用了个结构体</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5500</span> + <span class="number">5</span>; <span class="comment">//要多开m个表头</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLX</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> l[N], r[N], u[N], d[N]; <span class="comment">//左、右、上、下</span></span><br><span class="line"><span class="keyword">int</span> si[N], row[N], col[N]; <span class="comment">//row:行号,col:列号</span></span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//建出表头</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ans.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= x; ++i)</span><br><span class="line">&#123;</span><br><span class="line">l[i] = i - <span class="number">1</span>, r[i] = i + <span class="number">1</span>;</span><br><span class="line">col[i] = u[i] = d[i] = i;</span><br><span class="line">    si[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">l[<span class="number">0</span>] = x, r[x] = <span class="number">0</span>; <span class="comment">//循环</span></span><br><span class="line">idx = x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;hh, <span class="keyword">int</span> &amp;tt, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">//在hh和tt间插入点(x, y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">row[idx] = x, col[idx] = y, ++si[y];</span><br><span class="line">u[idx] = y, d[idx] = d[y], u[d[y]] = idx, d[y] = idx; <span class="comment">//这里y是表头</span></span><br><span class="line">r[hh] = l[tt] = idx, r[idx] = tt, l[idx] = hh;</span><br><span class="line">tt = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> p)</span> <span class="comment">//删掉p所在列和该列有1的行</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">r[l[p]] = r[p], l[r[p]] = l[p];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = r[i]; j != i; j = r[j])</span><br><span class="line">&#123;</span><br><span class="line">--si[col[j]];</span><br><span class="line">u[d[j]] = u[j], d[u[j]] = d[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resume</span><span class="params">(<span class="keyword">int</span> p)</span> <span class="comment">//添加p所在列和该列有1的行,注意和删除倒着来</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = u[p]; i != p; i = u[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = l[i]; j != i; j = l[j])</span><br><span class="line">&#123;</span><br><span class="line">u[d[j]] = j, d[u[j]] = j;</span><br><span class="line">++si[col[j]];</span><br><span class="line">&#125;</span><br><span class="line">r[l[p]] = p, l[r[p]] = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dance</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!r[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> p = r[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r[<span class="number">0</span>]; i; i = r[i])</span><br><span class="line"><span class="keyword">if</span> (si[i] &lt; si[p])</span><br><span class="line">p = i;</span><br><span class="line"><span class="built_in">remove</span>(p);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i]) <span class="comment">//尝试选p列中每一个有1的行</span></span><br><span class="line">&#123;</span><br><span class="line">ans.<span class="built_in">push_back</span>(row[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = r[i]; j != i; j = r[j])</span><br><span class="line"><span class="built_in">remove</span>(col[j]);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">dance</span>())</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="comment">//回溯,注意反着来</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = l[i]; j != i; j = l[j])</span><br><span class="line"><span class="built_in">resume</span>(col[j]);</span><br><span class="line">ans.<span class="built_in">pop_back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">resume</span>(p);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; dlx;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">dlx.<span class="built_in">init</span>(m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, hh, tt, x; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">hh = tt = dlx.idx; <span class="comment">//换行</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"><span class="keyword">if</span> (x)</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (dlx.<span class="built_in">dance</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : dlx.ans)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;No Solution!&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DLX递归及回溯的次数只与矩阵中1的个数有关，它的实际复杂度为 $O(c^n)$ ，其中 $c$ 是一个很接近于1的常数，而 $n$ 是矩阵中1的个数</p><p>与Dinic、匈牙利类似，DLX的实际运行情况良好</p><h2 id="应用——数独"><a href="#应用——数独" class="headerlink" title="应用——数独"></a>应用——数独</h2><p>DLX有很多应用，最经典的是<strong>数独</strong>问题，DLX 的难点，不全在于链表的建立，而在于建模，即如何转化为精确覆盖问题，一般来说，我们会赋予行列意义，<strong>行表示决策，对应选或不选</strong>，<strong>列表示限制，对应题目条件</strong></p><p>那么看看数独问题：<a href="https://www.luogu.com.cn/problem/P1784">数独</a></p><p>每一次填数可以用一个三元组  $(x, y, z)$ 表示，意为“在第 $x$ 行第 $y$ 列填入数字 $z$ ”，而题目的限制有四个：每个格子只能填一个数，行、列、九宫格要满足不重复</p><p>那么考虑如何定义DLX的行和列：</p><p>行对应决策，很好定义，因为三元组 $(x, y, z)$ 中 $x, y, z \in [1, 9]$ 故一共有  $9^3 = 729$ 种决策，我们就让DLX中有729行</p><p>而列对应限制，先考虑每个格子只能填一个数，我们需要81列来保证这个性质；然后，对于数独中的每一行，我们需要一列保证该行有且仅有一个1，又一列保证该行有且仅有一个2，……，最终对于数独中的每一行，我们要9列，一共9行，则为了保证数独的行不重复，我们要 $9 \times 9 = 81$ 行；对于数独的列、九宫同理，一共要用 $81 \times 4 = 324$ 列</p><p>而DLX的729行中每一行对应一个决策，即填入一个数字，这只会影响四个限制各一个，故有 $729 \times 4 = 2916$ 个1</p><p>综上，我们的DLX有729行，324列，2916个1</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLX</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> l[N], r[N], u[N], d[N];</span><br><span class="line"><span class="keyword">int</span> si[N], row[N], col[N];</span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ans.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= x; ++i)</span><br><span class="line">&#123;</span><br><span class="line">l[i] = i - <span class="number">1</span>, r[i] = i + <span class="number">1</span>;</span><br><span class="line">col[i] = u[i] = d[i] = i;</span><br><span class="line">    si[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">l[<span class="number">0</span>] = x, r[x] = <span class="number">0</span>;</span><br><span class="line">idx = x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;hh, <span class="keyword">int</span> &amp;tt, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">row[idx] = x, col[idx] = y, ++si[y];</span><br><span class="line">u[idx] = y, d[idx] = d[y], u[d[y]] = idx, d[y] = idx;</span><br><span class="line">r[hh] = l[tt] = idx, r[idx] = tt, l[idx] = hh;</span><br><span class="line">tt = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">r[l[p]] = r[p], l[r[p]] = l[p];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = r[i]; j != i; j = r[j])</span><br><span class="line">&#123;</span><br><span class="line">--si[col[j]];</span><br><span class="line">u[d[j]] = u[j], d[u[j]] = d[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resume</span><span class="params">(<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = u[p]; i != p; i = u[i])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = l[i]; j != i; j = l[j])</span><br><span class="line">&#123;</span><br><span class="line">u[d[j]] = j, d[u[j]] = j;</span><br><span class="line">++si[col[j]];</span><br><span class="line">&#125;</span><br><span class="line">r[l[p]] = p, l[r[p]] = p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dance</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!r[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> p = r[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r[<span class="number">0</span>]; i; i = r[i])</span><br><span class="line"><span class="keyword">if</span> (si[i] &lt; si[p])</span><br><span class="line">p = i;</span><br><span class="line"><span class="built_in">remove</span>(p);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i])</span><br><span class="line">&#123;</span><br><span class="line">ans.<span class="built_in">push_back</span>(row[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = r[i]; j != i; j = r[j])</span><br><span class="line"><span class="built_in">remove</span>(col[j]);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">dance</span>())</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = l[i]; j != i; j = l[j])</span><br><span class="line"><span class="built_in">resume</span>(col[j]);</span><br><span class="line">ans.<span class="built_in">pop_back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">resume</span>(p);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; dlx;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_id</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x - <span class="number">1</span>) * <span class="number">9</span> * <span class="number">9</span> + (y - <span class="number">1</span>) * <span class="number">9</span> + num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> dx = (x - <span class="number">1</span>) / <span class="number">3</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> dy = (y - <span class="number">1</span>) / <span class="number">3</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> room = (dx - <span class="number">1</span>) * <span class="number">3</span> + dy, id = <span class="built_in">get_id</span>(x, y, num);</span><br><span class="line"><span class="keyword">int</span> hh = dlx.idx, tt = dlx.idx;</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, id, <span class="number">81</span> * <span class="number">0</span> + (x - <span class="number">1</span>) * <span class="number">9</span> + y);</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, id, <span class="number">81</span> * <span class="number">1</span> + (x - <span class="number">1</span>) * <span class="number">9</span> + num);</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, id, <span class="number">81</span> * <span class="number">2</span> + (y - <span class="number">1</span>) * <span class="number">9</span> + num);</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, id, <span class="number">81</span> * <span class="number">3</span> + (room - <span class="number">1</span>) * <span class="number">9</span> + num);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_ans</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x, y, z;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : dlx.ans)</span><br><span class="line">&#123;</span><br><span class="line">x = (i - <span class="number">1</span>) / <span class="number">9</span> / <span class="number">9</span> + <span class="number">1</span>;</span><br><span class="line">y = (i - <span class="number">1</span>) / <span class="number">9</span> % <span class="number">9</span> + <span class="number">1</span>;</span><br><span class="line">z = (i - <span class="number">1</span>) % <span class="number">9</span> + <span class="number">1</span>;</span><br><span class="line">a[x][y] = z;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dlx.<span class="built_in">init</span>(<span class="number">324</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">9</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line"><span class="keyword">if</span> (a[i][j])</span><br><span class="line"><span class="built_in">insert</span>(i, j, a[i][j]);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">9</span>; ++k)</span><br><span class="line"><span class="built_in">insert</span>(i, j, k);</span><br><span class="line">&#125;</span><br><span class="line">dlx.<span class="built_in">dance</span>();</span><br><span class="line"><span class="built_in">get_ans</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">9</span>; ++j)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i][j]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拓展应用——重复覆盖问题"><a href="#拓展应用——重复覆盖问题" class="headerlink" title="拓展应用——重复覆盖问题"></a>拓展应用——重复覆盖问题</h2><p>在精确覆盖问题中，考虑将条件“每一列<strong>恰好</strong>有一个1”改为“每一列<strong>至少</strong>有一个1”，这个问题就是<strong>重复覆盖问题</strong></p><p>解决重复覆盖问题和精确覆盖问题一样，主要还是DLX，即十字双向链表优化dfs，不同的地方是，每次删除的时候只删掉所选行的所有1所在列，并不像精确覆盖一样删掉和1同列的所有1的所在行（这是因为可以重复覆盖），这样，dfs的深度将变得无法预测，于是我们使用<strong>IDA</strong>*</p><p>此时就不需要保证矩阵中1的个数不多了，反而，我们需要保证<strong>答案选的行数不多</strong>，另外重复覆盖问题很暴力，所以容易TLE</p><p><a href="https://www.acwing.com/problem/content/2715/">重复覆盖问题</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10000</span> + <span class="number">5</span>, NN = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLX</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> l[N], r[N], u[N], d[N];</span><br><span class="line"><span class="keyword">int</span> si[N], row[N], col[N];</span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line"><span class="keyword">bool</span> vis[NN];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ans.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= x; ++i)</span><br><span class="line">&#123;</span><br><span class="line">l[i] = i - <span class="number">1</span>, r[i] = i + <span class="number">1</span>;</span><br><span class="line">col[i] = u[i] = d[i] = i;</span><br><span class="line">si[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">l[<span class="number">0</span>] = x, r[x] = <span class="number">0</span>;</span><br><span class="line">idx = x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;hh, <span class="keyword">int</span> &amp;tt, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">row[idx] = x, col[idx] = y, ++si[y];</span><br><span class="line">u[idx] = y, d[idx] = d[y], u[d[y]] = idx, d[y] = idx;</span><br><span class="line">r[hh] = l[tt] = idx, r[idx] = tt, l[idx] = hh;</span><br><span class="line">tt = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> p)</span> <span class="comment">//删除p列</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i])</span><br><span class="line">&#123;</span><br><span class="line">r[l[i]] = r[i];</span><br><span class="line">l[r[i]] = l[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resume</span><span class="params">(<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = u[p]; i != p; i = u[i])</span><br><span class="line">&#123;</span><br><span class="line">r[l[i]] = i;</span><br><span class="line">l[r[i]] = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">vis[i] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r[<span class="number">0</span>]; i; i = r[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[col[i]])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">++res;</span><br><span class="line">vis[col[i]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = d[i]; j != i; j = d[j])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = r[j]; k != j; k = r[k])</span><br><span class="line">vis[col[k]] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dance</span><span class="params">(<span class="keyword">int</span> o, <span class="keyword">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (o + <span class="built_in">h</span>() &gt; depth)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (!r[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> p = r[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = r[<span class="number">0</span>]; i; i = r[i])</span><br><span class="line"><span class="keyword">if</span> (si[i] &lt; si[p])</span><br><span class="line">p = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = d[p]; i != p; i = d[i])</span><br><span class="line">&#123;</span><br><span class="line">ans.<span class="built_in">push_back</span>(row[i]);</span><br><span class="line"><span class="built_in">remove</span>(i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = r[i]; j != i; j = r[j])</span><br><span class="line"><span class="built_in">remove</span>(j);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">dance</span>(o + <span class="number">1</span>, depth))</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = l[i]; j != i; j = l[j])</span><br><span class="line"><span class="built_in">resume</span>(j);</span><br><span class="line"><span class="built_in">resume</span>(i);</span><br><span class="line">ans.<span class="built_in">pop_back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; dlx;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">dlx.<span class="built_in">init</span>(m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, hh, tt, x; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">hh = tt = dlx.idx; <span class="comment">//换行</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"><span class="keyword">if</span> (x)</span><br><span class="line">dlx.<span class="built_in">insert</span>(hh, tt, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> depth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (!dlx.<span class="built_in">dance</span>(<span class="number">0</span>, depth))</span><br><span class="line">++depth;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, depth);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : dlx.ans)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> Dancing Links,DLX </tag>
            
            <tag> 搜索 </tag>
            
            <tag> 链表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/13总结</title>
      <link href="/2021/12/13/test2021-12-13%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/13/test2021-12-13%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="2a983c21cd42e7203306db9e1541db64b5d7a17427c1b321d330cdde824a2ab4">91be494885fcda4e29aacd3585d6ad0f2a89c9fc649061353a45080ece626a3ab13c72d1d75a52ba22ed311901fefb4029c6067c375579cd74e5551be5a3fd4defbcc6b39e2a54d4e5aa7e420a1aabd6e0c81f21bfd7dd28e1b81e110c4f87915af4f43aa5ec16acbdb468e59da3e280216cb1cfc339d0060fd004c001cf88c4fe1d01ab6617cbf00e1c1ec2aee9f51355c1be980e5d86ac20a2d81c63c0b98c2413df2a94c125d50a9e6395236035be458d207d4450b1f17c67fd3ab121120da8349e1e231cb665c0511729b5a9ac1848c59110dd4c1b040dc203160f6a78c20534ba3801c6e92a1cf3dfb259bea39dfdc6daea42ecc60e247e6174996ab47b2ec24838cc37c425f4b87a275d801ec48346bfdad8a20c76408d248d1e55f4a84794ca7f3a0ac9be383a56e75ad9c6b33b979a1a70d4331bcf5e7d4a19a86784476bd03706000058820f8b91d6a6b2ddebe3d47ee20bae137ce2fdb0b96572a8ca3970325438cb9b92bca46c9f48b2ffc2a4f462151e16612ec64e4847dde148f816880a49c72c98ae9cad34862ec558578af7674a23dadba36e4bc47e9efeb3d4d1c6abd9029144847cc82b8e70e07fbbdbe8866d803b3f9b8baa16d06068acc4ed3d7fd3990a6b77a63502f9781e087aeb5f2a506dcd2c19696f6dc6df89db3d6a6a92f04218c5f86c8825fc536925217ce93a9740d4137ea35a38b1c40e5a50447eca9f34144504fb702398e67fc43eb430d6146011e5c1ffead362ae7ed416ec3010e7a096560e35b2e5622a8784b91f501ef8dab4e5dadf9e682a32172543ee6f5aaac25accabf6d87906f94a67c776afb84527da1362a6b6071723d09d26f2c82e366e59316f41ded5750aeb4c572159c2e7766311963deb3c78d2ae9de5ee118fc80ccbbb311279f081e55787fdd0e6e3c220a7b9fae0617ce7671ec38dabd0de569b6a66b1cf5c5cb5356502e6c1c94276fa2bce2e6e63ed288b3807641f426a2ec0338639737f10bda4c22eb20a7f72fecf84e7c2c2487e6d0b4bcb011d655f5d18f78d93951e7e6ae77e860876a0d8f1b250aa3e7c8b7d520763066fb66388e0550fce8656633196ae0ce95faa0d70fee151ff7dd111ab48124a91ca5cc801bf3df946d284dbf1f6b543cb5fc4ed8d686fd84f66ca5f37f5585466ee05d12d02090deba71420f9b9833f088fa10218f5edb43673b448068d3085d5efaa27009b491679462210e4acda301552eb10d6e5c688236b6eb0660c9c1a1beee493d937f97d1d121ca7c901075f8a4ed8c9ab3004762dc8098d68188fa62a8dadf54dac070e3a334ae7661d817d65aced8fd49cf7704b46925c23bb5ffcf7e33e64133bf66ff6c56795aa7a6baa7fdb341d494d3ae7754be7ad23c40dde33945ed90b702caff1692b875c7cf152856dc76647dea11a55fb1115055882bb8b05e5be6ebc3c87390843abeecfd11867dc2aeec0bcdf158c3557a64f51f2f102e0cb08aab996c21bcbcb8733feec34908e7b692f92266727c961c5b935a617df34c2f4a5fbd92ed0432491929f77a4d75092c6d817f5508e1f38175d2e571f769d36291a97ceee7a4147f234ff5e17560e5bd5bd82273e5d255ff2f5f041b534089ab647a0137f14c14830eb9e698f7c7cee4d131e506f2b95def545d4df2c9e690e87ff55662a4abb84a2c4b7f60f905b15377620deb42a88f3c2c845923e485bd4d9d4a853886b2d5f5b72ab35b61d1d8a86fe5b7e2e9625d1d016424a17f00197b132b8122c8b6c60c3c5ce4f5e0753ac21bc58c083f432584fd40b157a86be20d20ca18bc31e6c951e2b062cfe3bf60212ad033c9a7feddc236b0d192488d2675a3957d4a27d8cabc0ec01114eaf5d72bbc0d8c7ceeb103c6552a24cab74a0e62ec3ec25d9ad687b401e8058903bf7165551073651e70d70ea1d30a3bcb4e0f5c8f916f26c0b574cee640110b26fabe48aa0793b86234c0389709f16a0a470f2aabb95a74fa4ab751e3f4989bd54bbdec27644d7bb37a477ecd548394b16ad0d4e844a7d8bcbf177f09a9f17dd2c24f5a2797cf4a869f9836ffb8b64c2c4bdea08d92b48baf398eb45cb46e6b2701649b7e46d658142462dbdb6e8770977ad39dba69f6a517e981c028cd36205f7ce49f0f955b35fc5160892f2075569ba924ba5a06e5d3d94ebbfac974d19dbed72fa98a158663bd63b7ecaf2604afad480a19996d6cc3d2f690967007d7dc899acc262f4f14d4d98f55503b84478828a37ce31dd476615ac478b45959ed5adf8c0469fc22600bc8862c5c135a613bbd6a09649adaa9096c4b446b278738d4ef9dd2db4dc045ab0863a679f36b93b14a9c8e15182c214a16817aa6be7e70676137e506f8fdb73dcffe2df51546a287478a2d224961826c8232ec4c0026b10d7a16d9329fcc4c135ed748c20af347ca90b5a455fdd4c55ab1ec9e86dd5469146432b762776230e28e1d92a8278e4cecca880f28adc3f412a28eec0c65c6f31a2b3b6a76e95212dd3c63f7e59eab2c8b4f8adb0ec8b59c451a02705b49bc294da4708152265686201c6dcb9e29e6661afec2c60546a1c16a785d2432eedf4069594eac4dd565961067d3174d1563b6af09fbea905cbbdbee5a94e3c03b32ee76166c1823ff916204b5c8a9e79cd38f8fe97831e6732cf9139697bb31a0fe2dababff9e2168689e60250e8ec52d06752b477b06a0402f4bad8413c9bc0d76224d8999ece0780a014222d5a99e9d25a03193abef9f66840ffdf4c4f2c8dcbd468997dc812cef51320b11cfb84ccc4a5008aed9f5af000692f9a7d8d4429824cbcdc5ade9eb455ba5192f8d2d04d90d6a58d3f412ea87c509227f1e5ea6390f305accfa61451928ea77c0f875c46ce049b99a737fdd89c080db905db48638a1aa1d842953129d353e6c03c7cc8dc1446413b282f9cc8d14cccf06f85744bb6e112e36065e4b2f6e99ca66b937fce6f0ab1dd2e949c4d84fb3887c107cfdc117460b42c74051a02d703c209ff610f8e3e82f1ca25452f0565fd0751d332177bc7d595ec45ed19e67a872994fc70f1a6c92996008cf56bdc429156a5b3e3eb96a3298d4bdaffb66ee1a1e8a87f96f5414c34751d12c504dae8331791654076d1c09c02f255111b1178acc0d1af924bdded1b2a3f4f501600303fd099cd45f40b1bc25bb2b9ccfba1ca6e7e3ae18fd29c5bd921d9891a46e1899ac4f59a8bbeb0ca15543a7b76fe5e7865e307b96ae386e290ada0eebc7f8b4d0abf17b42bd9787ab9d1826b8d1bb1db0e82116b25b97c9ea55c272a2275897844a5d15d4183eaecca86961fbbc9a9b6fc43cd999fd112a11b92599f9d49213fc2b0b010dfb918be9c6875fb9f0be169d92bbfd665a27e94c8db62ba6c7a85a6435f1698beb57ac4db98c21824d01963d6687c3daa6a877a371e68d7cc7c5145dd74f65f07af689ef07920c9466b9832811b638d00fa77202834d15edffb1c8e273c29c96a126b4279e542db2b47bc19f50607a0f55fc43023d280906f4e8396815111717b920507609df7e803b02f4bde87f6abd8b8fb225eaca4f90d6dbcaaf921f9f2d3031d81576e50ecaf3c87a1cb06adfea41e93bd03d94e8f54764badad1ad73e1193646da401210198e5c7df8fa6d317161d6006003709ceef24da720fd27ec30984ba03e8fe66b834c1f555f787de73ef790069aaac538140038e23f00cb9d7742a53cfeb555379258ccd5cc0524a77c9c46bddc44c7cdb82f4ca82974fa7062672fb38645c9cbccd182499e8ccfc24e05b6e0380249d4b0b8ee912c1afdd0a0401b61f7cf8cac143c0c5f16c95fcb8e72661df69db7ba8a2fc6c695fbf4500b7a2717d56440017c020a42aca04f24c1fdd12bc5e073c8a33a6e65566c7d252e2f008fc0a3fd722cbb489895139b1318c44ca5f22894e710d2420eff64fa968a3cecb84ea1fd89213c6fff4912347c17ee00ebb2c63f49593a0cdc75619aafdfcf8da64227fc5bae7c87e2443a8370597a9a77102291854c9c90d9c3f51483490af3483a81a344d50ae58412d6f627bd6485e8198fc654abeae540e5b395baeb01b613551ea1458d5f8abc7b5dada8d2ff25dff23e09ae3c2e01b504e5c8eb438b68c5297949dee83d796467a14d82072eb919d5ad3f7429975977c51d4469b381648ec9777bf7ba3670e00842a3e05094b58dc05d50695e74a3e2f44a059f53ce53e79c0a671922ecda712f739474a613a7631dce3e72fd9bb321c1e0a871b2bfaa12d33e50c10c9bf66bb7fc6758a08996b503b0d19671bafe28c9ef8a6ed31d5ff812d5191fb844bcdf83ab5709339a42d0bc4feb2c34b4cfc21b59c80b1836d6f1f8faa39c37ceb21bdf4349836bb822438cdd6e65f017838d23fdb2fdb874001ab27e98c42ce5ec0ee32ffb15d85fb65aca0c6a62013ecc3877754ccf8c0c03805ec6bfb35667b96da821c78cd2cf464f4532ead698710daf5e5e0b69ea9d5f1b5ad2404dfab3d15668d84741778bd0fbc74ca74d2536ba7d77a7fe4126a4bcd1a22fad97c8db3ed9edacd8886ba3ac63aeeb295baabb058f0061306bc6cffa786555c6816daa215a43ed35aca64ac8c62802e67fd9a6477daf62e94fca6571449b41abb853c84cc7fdb0ffec6261ce251ce33461dee94c51ba027ae5b766cc58518a44abb2d5abad04e59373541c9daab1c7235e5ebb3eb3d47fe739a918de820357324925d25052ba34a6449e97016cabf98a12358a249c703ca22e10ecf3c274ab9d0a39eb4255704ac1c62e884aa4572fe9db7b90d65bd27a75f996082fbbeca5b9417abb67e80c14aebb900452f4b9675bc125c299077917bc071fdb4cd37cd63d40138378968b0fc5fdafe34788f14fa4b9b52d3cd8dd48a00e4fa3f0d64d30add5c3f249610b22ec5aaf45e4372e2e1c15b89782f33f71683ec4e7b83a133d514af5663f0980189c70620190885c3399835fae21c582df74108f873d9dfcce2d86363ed5fb5ed591535e18ac69dbd8e18417f69924eb8d1f1faea7790f31ac6129e6e405e480cf6bb3e2bdc30c2480eb588874d30233f5db12ee7eb979209e72b0f1b853d33c598cc6763cbc611138face70194052bf4811f0539c4588c5e58c353bd407f74f35e8dc837ad03e2888645538b65e0935b249999a59df3385a51fdb5e7b59424cd903e3d049d84b60a92cdf0661115658bf13b77278fb79388c379cd513873085e05bd7f28a519d43fe574efd7b8dd82046fc7c40044967698a5bf267aa939b92904a25c3a6caa772fe5a970615849d7e90bb4b166f73921d76021991e3687ccedc62a54d1d15b26a60f2c6e1d10ee6286eb536f818e5730b619b4dfc7bda74aa7bd4d316b5e4e55264866189e2a6bd47f368e63036c996491a89e0e282d0d97e20256bbe2d616e4527c5759a3356c1bac209e1afbd6cb0a5aa0cc3566dd35c75a3ed7f88dded61d9cd8d248e2722cca80d0d8dc90e835ad34d8a5b97def53f2faf4256ba15a52ffe28d7d9ac5ad32a1dcf9bb1a0ab6acd808a14c7c7c996717fef6fea21d8987d6b4a486fb2b0c5889a8b8c142bbfbb6e51e42b7b0a0f191771d91d309cb3caf745c8ab5929b990bac8d49816fdd8fc53d9d789a4f65bd051efc4220db839d4538a26cc316e3791db41d7b1626ed90c1e048989af5f0b70cef0e85e614919dec5e879cfcdcf9320d53b0b4f097763a9b5bf4ab5fef16b20c5152e24e7ffc6f5e1b15cf987695bda506f97c6ee07966adf03402face2810ca52b822ff1177c030910aad59ac203ce3e56a2664de167df39868d7dae58f02afa547e280397ca58b21182cd1f03bf627c0d68e212764d67e1e5159e9cfe8b0447307abfa17e7ae3c29938dfb586cfb0d4a6505c2bf15a2e710b847d78286a47c42971b417e2d652a07f16c2e71bfb686abde7e457fd18da1c6e23608fd9fd3e9dddde5c31265f5cc695e83e00d3d3ef116a7d6932d6220f02bad1002f586830ee41a8493ed41b3f6d92948542d3e71cba2d01769accc786e0d61d15b380e6d9cde6c9deff92c3c764d984fa541efde91d29af32206c6a4e346866439f605fd92f30e41159e2cf57da866bbc95bf0a9e7a431f3ce333adb6dcfeea9dfa6ee16dad211dd882a6620dde313b6ba88e3eeba0c1ade3483c6c52c14e50147a157508b9570622db82a21557fd94f0a2063812b35eec566047af72aa6891f39d15b1603b152be904580605718a60de391d3d7b4b4e4964c711c171f812ca24edeeb4b63fa3cae964506f3048134594f4414fedeaca58dce28bbeb606eaed19b5ce9b31c3f253c4ec316f1fa6f93d15eb2e94a38b665f911f5af3b5a7957243a33fa0ce035af4b50b47eb677bc49a8b07de40a02b63ee47004b7f1dc30620440c93431cbc039d72fdd8ee09b9643682665bc11fb70ccb36cfdedf41af815fbaeb546605b811cc7c9cbb8f897249cc026d5889226c75bbc4002babfa6004d0ca50cb789724da3c50e493165661c81584b5b5b406c9580624c376899f2fdd3d387dfa8fc1d7af3fddcd343a23a3ae1035b5f58823a3519421fde2d1e8692f4015d54c2e551037873c1d1e593264a63259f3d2635e6d41cf3d6fa60cb03701334556c6d8394f8cf4496190310815b757124afa78d0c18d8428a566b5763c40e9ce5263d5edee0151f1ca30e3235be413558b0d8de07cdb0374bd0d0fa1665217cce85c03cbd0fca6c7622a70f8d87edf2acb84de2928396a95c420101680e1c90f915dada6905178f2997db47a9794a18817a2e2051c6e18cb4be2db92a0bca4d6c7a1f4c5abf2d06ce806ef8c5424e08c620b525eeacc5f6c19273ee88442574bc4886b7647d2907cb8733ce27c59ec9f6174b2bb07216740028ec0a34e764f3bd9b69f879f42dbf946a59a77fa151a5c6dbd23dbfadde916bf0627c68c9fc885403b31157c32ecd4e64be450d2435d2454682c858a62eb79ce23975f897ad5200d010bcffb6570d93a30b53d7ae71c7ffa60954900c003262ee958b92a779940230218252df44e3dfeda7bc21a99ad40cbeee93a22a525fd0bc873d3c6d27f3f4d1a1ab0ac5b230d8ef2354f8475c59abe56e69fcd415fd77bea6701ae72d0ae0517b23a41153abc1c9b4837fa6c0e6790a0918d981c9bdf9bb4c719d15128b91b8744b83333604c255887fb59699d01991c3b09f6833a52dd132e742b41020d0b0918475bca3e7b530707cbb02914fa9dd45471be6cdd2858fcd8222f2506114da28fd07cabbf9b26cc95ee9e2dd8892e2d43d0c08c650fd62dbb721377a509fa0ae287b27022adb6fc2ff26aea96073697121af7b806253ab1d4f2008d3f6acafd9a48459f97bcad88e23faa025eb1a85c4de8fb3267550ba1339ad72cf048157b7320a46089d375e9fd2903a6903eb7bef511475942db8dcbf30da7eb0719069f220a98c3ba96c9764768b2de14dc470da51c4316218a1bb150b02290610a80dbfab69cffdb03cde6c8fa567e9e4291ada5f71cdbd587c4d8842723ac8744d29f2c5f7b14bcb7e8302727dfeb4075376733422f43f9c4e67eb356a66b28f44394256bb0b109740e9a299628e730561474dadf6c962c40660c3db094125887233a29907b9d1f55c360e1bc1bd81153d90e4aa91d774e428d40c26252d6578f8b8d166e7095fef4e027fcdf92cd7efdde0c0b16674e0c2409f14b71c78c2b9cc302cb4caa3da9ffcd36d7a2f021bd363239360ad8e4abc64f7d462ced054b1347cb3329093bc3b7271dd6dfa7fcf60579df0f3301ea156df7d907ee88368d451158a257f9a4c849e638e58432f37bf3ef0a2fbeeb7e1e936c09e6e167ce05ab48ef6ee9a11e232cee4caf9c91991403870c1a064831a14c434f56fb047f98edd0850214bcd0e5197b36c9f8fefa497e91b4ebc2b8f7b9a8ce96aac84b80166362a18d16645fd779e882dbd2b654b7b75f461bd93b435d77879f10963eb8e2dc6d4eb4b949b5611318134508e5b333e9f95f86122141bffa1242840e22c59d617e488f02c9df3eb73def3799e8f567ec030a2ead38b9463b26d9e4f7dd8150d3a9012fe0d6b29d4dc41e63cee83de9933a481e25d786ad855579db6277053a3c5e78116e4341f1977729c40c7eca9f303848ff3db6b9f5ae3228a195f121d36c68b9ed4b2ec5ab998d2a6bb9dc07f6831442db328f17323643b290224ecdf30c07b52fe49050593a093776b141313f493ea956581148bf4d920e8335fc2cfcbbe353629bb791c8226392d698f0000b2c03fd8dc93d411a3dbdbff9c19214132e86c2a2f5f995c69cf7925b484fdb15fce62cf038dcb9755bb6a74a8694662e62c5328a9cefbb9de9a4d1e773ef6fd9af06c52f6cb4e9f7fc3555594b6a5aa0a73725307153daf61960bfe8764e1df68d12defe8bea7f562157d0ded4d2ffbd58346dc3621a070ce11a0412b3d736c05ff753d3eb6327dd0709963ba6a0f5b7686506dda314fd2c3fdb99b0f3c40ab69081c8102438f9eebbd08bd320b58c7d21232f6e1712bb1f25503362e548b6e11c733b10240540e81a1179da5070a650cb9662a0c006a9b1c017bcd49d1705fbcaa04ee9ea57068a85d64d04d73c7acb1faaeada94c48aa0157c29f068e7ee2df989ccf4cd5795c803d101a876b7ead8dd0475a4c3ad069f4cd45e171e831963c73778f2894edbb2d959da8fe5bcbe4b4a6cab5a60c76d83e77decc8dadcd9c2dc90d58f453d3b0d4e1e9498db8cbf743362fd1ab477ad7426d9e9d79067ae79ecfc8d345fcd134e3d2bd9fce2f33602c01ac26be80c75a335cb8d4fb98531959ef6803ab3f8f3dd839159d07ada3bb2af0abe1c88870a73b0a5acf78e59c893034c1fac34292f0912fd9785e431756de1d69ffdb9a0438b103f81259012bbc3e4b25adc22c544fccfde338bffc9d3aa44e2075d2c3c53796274cb2a310ec5804ae7627cbebdea256fb67ed555303efc712a66e8eaeece7f91e262e95951586791e9a93914be5f0579a701cff0528fee23dd75b898751e004a03ca4048cb89e4ad792a2f87935d236f53473b323ef6fe13e50ad625d5ac0011232ef6aae7908b796d996146408c8ce4458b60871d188498e1b753c625bda154c57f3ac194271893c3cb2f9492b7a6b5051c4203523dd461802edc7c2d47c446f6c46e7a4b76f5ad5b10a341ec5bbe3e539c30882f4fc97bce7af7762cc7cbd7d5f228648262c566ecf68be7b1b886330a788a9504c4132bdc484518ebec820b92415d015841d7cc527610cd64df3c8b663817c46bf97366ee385207889c937694a7243e48404806472e2bc6fab9a2791f2c7c36877fb71ed2231f66462c9995bc2ffcd0de359713f5b21bfa73d92c1c1bf9a5904e56774b90c66dc7bae695609b4102f6f41adc9d24a19229bf2358843ea6ed787749c6114c88ca519f19709206bbc4e4030e2b535766796ee535e87426ef459a7176e8a873d770142f1edd1ae9077db3a6bc1068ae78bbd8c769f5de82ef1b79058877e0a39060276c7c59964d2624fcce9dd225d04727fee8cd2356cb4b61b4aa1539f776f33315649a14d572cb884270ed0cf38145a7cc70bad81f7857a307aa064cdfdb5e17d8973e7fbd34da88e8548785d2bf8beb9900ef9305b9de639692ec8f37696f7ff934d9d7312c16603283482db0ece2565b4fdf8f7832a0d77a0602df443a823289642e73a875c268ad024eca52c66b52305ddbfe16cacd00e1c8043e7df153ff537eb75620cf695660d4e76394984ddc000c151a85957c73f8e95d3fd6e8d50ff2fd35e9fa2baf7f8d689aa6a538d1fde82b9e72e1b78860e97707c658701b6b7a227eeeac43df2d3c8ac67b7f95a82d4990064496a03b389cd129b9b8e1d9a72a7d42a8d8e844e1adb59b0b2fd51dee3831f002a55f2b3bc7dd666093098a80a6ccd1ee7ada4b1bfa76c663d7386f7daceb8633efd0b081f7d065d7fdb4024eb50096dfd74258f31a5ef495fd6491b0c885c47a2ef974ff6f0eb125a748578b1819f4fa0ba3548b61e736babe9112ba675ad751ecaf29c934146212625d465a7b4fa7b704b581037978c23908d0b86c27678ddc1ce02bac7ab7d8d701cb617d0bfb854aa5c117b94ebd90c1eaa51f1662d9d7e7c484d02bd6150164e1663e90f757850163a3649a726e7ca8b8fd27bba3a4f3652b1ef6a1dc3676bc7e26e26684965bca7871024ed1dcd5e33d5b37ef5e7c6109717c0f9ab3ea9749e66a0ae5d38c56f622dc58ab5243d7336ffefc4f99b3001b73da013889a430377cfe01b7595e5d997b3a50a414ba0d6b1a993748f5419d6e703d8cbcd52b45c7d80bbb2bbe3db20b764814d245bcd40b718c316be658fb40ff12a01b61185c33e11b77252c2050ea81b5f15345e233d53130ac5823c37af2706ba0c9b75dae83379c9c7ac21be245dedfaaa912941c0c4c9a478b02b93dd1f9de37b41b07062c3ba876a3fa5157c99fe59888e4a408d5c67bd14c86ccc359db8587e2ffb353dc0261eb21bebb264579a348cf51ae389ed0bba6450fa19acb202c8217f60031eb164ee17ed9cf4a3a034e61e7d1dd456db73eb341f4e9ad3ce2345e77a02beb4b110af6ca68e792ea87ba3f90f9f387a6b4f03e5d4918b831579812a4b61bc2aa6bfeaba21839f19c06ec1a68497ce31038075298037da4cccb502e665fe69a81512b3ab6d7213f3cb24a0f1e76c239324e5577cc4663641b8ffd74b358ecb67202fdaa3e932b0329fee9627f26aa28ff23617b5b76e9a0dfecb2db4aecc8144790ac63115a11512923f6816400d2298952978d8a0400923742889b93c079bdddde5effe34252b7102a3e3f8f0fcad66130d82885e1f5519b4553f0568d1d902dfeeb91fc3c66d32396bef1b8c2ad14851397adab761c7d38711f07b863f8215a02091981e22e9457900a6e322e5493ae694fe12f4ce7c9475ea34335451b07ff5f6f907f328d9b53fc5a06c03996cb309211cf1848d765fe456f9ef5346b63e5f5dec81edafe8a6767e94a0b7503ffbe045b95e25948e54067c3d499218cc64c43f7741f9f480fda97e730943994793ea09589b872459adb30c068e2ff618296be761f815a377cdf90c5fda87eb983fd14e6370b16b25bfa120af723d7665a7fd481f82ad63b7a207707cf9f68b3d58837ac95ab386d0eac8b0b9c0c60135ebcd2a5f8817a5b9355d766c643d8e63835e96f75dbe16fce7ff2db2f210719e8d75091b60f760356859a4197cba5dabe8100b77b012f53de2fe089581c2a817fd152b13a0bf1ef5671507bd5453159f47c0622dae78879ccdb38ce7144f766aa21e2b6405ad63f54f1ce60b07a4b7803da9c71e1ba39975370290fc8b7b2f9350d816ce6198f59c5fd50adcd38718b95a990f1c8d09145fe15466b9cdc40424db2e7b435636c2dc35dfd6d1b78b58c4afbfd99d3bea5cafbdabaacea2a19d6fc1a4eb72e42250aa2736e29fc1659e2b6b30ac64d44caa5312964981269c39ccc19252d0e5d42ac6af6044ebfa150330ca30261d4d5c817989ec24f119b30d5d99583d4a162b16b3a6f00fda637ae381cdea16c3769de2307ebc38ac06e8b3bb0642b03072cc70e6e92106cf816c9a3d95a5f392af12f3993f363a5c0d3a748d0f2c7b54d68f96df63f3bcfbd9d56a95d5b44a03723ea710cfe7202063c982498ac736da866554952f58f69a4b47d15e24e97f5ccb438d909a2cfdc7359143550c48c2871b0523c4f84ab73a7aa2aa12cb7d7365bfff5ee70f3b38bcf7be095b3fc869f79a84082a16440f626acf4bd1d82986f2c83fabf5c269726c230ad1e9057d0453dc9aaeba18632a4a29a22bebe4ab483f009f56b07b92b2200f9b813bdde70af1812619add67e5875eb349bbf8abe1fe733806f60910128067bfb23cbbba2b208f1a8894096abcde2203363308d30f3854f820ef756f406125d296a49138ca901ec75ebc01fbd8beac5646817ff3ed1eb91f551935010c2a1b2cd5b13a3c51e12a7ec5571eca9d6fa3d958a22ee027ed168681692360b52e33c36250e235047b9a12144e35c959dae99baaac82c1022b2ae73e9a5000afbdb419b920925133c44f849d9d1edb908493b548f1429a6624a60c11d75d91412686cef9f20dc6936698b01fa0d7e45302539a91f235b6b7640385701756d13557dd4368221049a96d6cfe8d20017b0fad9cb607cb32dedb28ece30dc08f5567e8fe2b566c53e07fa0e28efe462386256b30d44fab236fb4aaf1a419cb21c37b58294b4546f133a503dff1df200ab16a8eea62ffa9047f1197854366cd6c578e404a0e94b8fa841004933682544b8e0ed55c1f20bf95d8df88e3e5f0fbc5b556298fc5218a647d57c7572d9a7d3a40347d7b447ed8b2ad4294a7f725ee65fd1f81f618d7bea5f7a4537fa4e3e78ee0773464de647c197bfe70beae8a84112f0dc6ec842cbf2b5c40a95651770164c85ca63cb7d46d1caea48fa6c1a6665c8c1d42f1507550c7983dd9522bf9c84c3787794c960f21ed26f39d44dfb419d1ec3e951d3b0f71f880fdf47bd66cce8b4b60bd635a793cbd7fd8db31bbd408f42a4859fc45364a58eaf0d2134a44bfafb414350eaffd3669364e3e7bda7ba38c582110622985bc7ae68abd0b9212556be588be40c6c014ed25a4d1d2306494d62064ab0bf2378c69d312f078e45336062b6038c8f3f4355c4605845ff9d59254ef454fe7b604148dea05b31ccbcdb0363eaf7271ac01a29dcfa218410e03337d5ef9da9139fe504e66293f2a417c6363f9734d41c8a2205a2c08931af79415e4860e0b676e073a2bfc1577bda56a15269d979803005585310958f4fed970c3b694cb5c7b9c65973361df8892b91919b100f4a333c1db4bae1d5b7b815f385dd66affdf7575accfbabcf1509259741800bad5850353616a8d14161d189bd93ac846aa46d8a4e0b0633dfeda826c8e2446cee15ccda41a2c309c8af3159a32fb639cb7dbb9d687ca2a098ecb50d6899ef343fae6aacf8edb779f89fb9be6d0ec1b7a3793bd19105690d4a1d0b761d73655ac37124f8bb4e16c1a9d092120b6700733cdcceddd30e2ffd8e5f264b4829d2de0ddce7a8c584e46961994430e596bce2a4202ee61d57303e931cfcef6c2ac3c6b7a222946831d095104632e3d93634f1b89c7ce8e0577e183f6bb53319403c49d980f4c6aaf0db7e33aaae4d38ce97a59ca70a539330627b19a78048f4c3758cfa7ea86b2520b0b48b478261e0e1ff36f753c8f236e9894f29d8a41e10560209ee4cab94f94f794a9fde112e5bd8a371b81a6f3df62c5bdb91166c4bbbd2114e62aff471d73cd6e044536c47b6f72617ca17cd155a9840b120b12722daf9094f56b371feb7021d3d9a244cb9ffabf9621c7818b825d87209545d3c80d7109848a2bfd93b271c4a0fb92f70b66c01de8b13f78a34949ad91e87b31f79110739c3774732eb552529a8672426a51d89e2ce5f10d27cc2fdcd3992bf978094ea6fc7f7fc6e5e7b5b4e315ba6581b73645be6e4372fe7a925c04737b62e4b58f7e02720411f15cebeed181eaf10ee7eac2afffd6d19fdee49d3d096e304816b0c8ecfe56a4b81e438ad98ea6ce0c022077a4dd22ee40e2f3d74430b388d4fa7360a9f489e0481974b5bab70534a7ac1692f55e571d49994549e83e94e95361095f19bc9b6e2d013630baa24b1ba2fdb50bd4fa80b50b9e73dc0689c6a1120d2715ece54019bdc544ea21b80fd09706aa053e94eb60b9c34334353bcc52037653e5e800bf9a395923ed0191488f6e64241c7643571bc95dd29ac11ffaf3d31b803a8cd80f3bddfbba75c655c7a3b18f58cacf022a10dedfb1e6b31a4e8513db977f6acda8a142272ee212e39f33d95d39b3e764ce10a83eb1845fbe0fea4a1e679778abfed7b5d94d234330e23b3007b39f3cb9543727445b7fab57da6bfe60ce24fc90a0c40550c845f4510d2ebd9690985bd2f837ec39b3df1f41be153d6cc1b62a6033c60625862c54f04b2337da013510940ac99332eded59e5cfa597f0b2bc5e94ade4d52dae17410089c0ab9af17ebf62edc3ff8b50ca9a1d8b6ba2330e65cadf522a78882c030f7eb0836580fd9b8af98f4f701f780540b8c044270bee89084abc94f65968028a96636d74efcba2d6f9a47df04eeb91082dc26fd5b138c78053f7a44e7ad09ae87ce3ac45bdf99174a14f654f50813ab2315d0b7e99c2d081f4abf0e61f08780f94254ce534b9635188ce7e596cd78f1bfbcb1e14f133c59b1f4114c62aab9861a1f68ac2954d2f763497546d6df4d6b64ca0173ee6a58ba523afe01b45b2fd4d4ba4be30e79fe67b691beb3047c6d412633f73e556548f2c751a597a276cf8e699178ae18713d9eb5bf53035b3037e0df774117d4250a861f2c6d95dbfa48afdfc932e3ce171d0dc80c1b9e1856f423af5541c937eb5a04a84e29ece3bc9cc3c50236f451c862ac4443d4d7a10857f7f3a8147002106cb11842562f97e21e4763b2c1e50358eb7f499d27c2ba08ba70e6272f551a6c759694b9a14a918776cd3689aa555ddf7ea46c7bd400e41799dcb45bb99217fa0d9520062449f7fc3ab0d48da53744f1109649c81216521c1ba6221400e8470bfffd505f4e9c482235ee9c037684c1ccd204f02514f745bdba634141ec0ac5b59afc5c09ad17b6e6c5bf05344119cc581e8c6550604dd3c441b9e9ee7d75141642dfb846f1fc36a8eee063b0948706a5b2cc1568f3002c7ed0a1d8aca8bf0fbf7e8eb1100046920c3311884cfb5243882879a5baa809a88466e0bbb35227e48686c077f512e46d93b3420d0efb10d4f7e46f0b6cbf168210da77be5a20a2f2f381c5cdf93394d6ac6fa32dd425064c8b16929b976fa53033b9414f77355574301509e016148ce417a922eec8882cb03811e05ef4992a2041445101e762de966e4466820bbd0b984aa0d6717677bc374d35f10b698355b0f6e7ed15fb8a5f3cce75fa167fd5f15266401f5ef5be36b6a059f40aa33b68fc9719828e102c03f2fb7789589ab10da26db2c8fe2e783313d5084b52fd599724b9069331610436deefe3d748351a2f68e9809360abf8ea530c48a01b569511359f2650e83dbf7d518a37570f27d696112e50ef09e72a69dcb972a85464d325874181b4e98fc7963ecf1026b06736c2302000e312c61b3902b76ab803f1d2ddfae73eb82e9cfd6a612513f77e1c2f5e08c51fcaae46a0ca9f1d59c4f185da55ce38787cd26ee06693222f444275ae7c2947d54c9455ebec1ff712fd5c768aa6b682113c34d18d3dcc91a505c2ec2ec16826f1bc3264252056dfdd11570b6ad52d07a8ee853752e96866ab72b276f9008097fdf9d2bfa573c62ffea0c471f52dd48345d83870b1fe1b3a7d9535ffce20d274de6357a284fdf6b930520065746777b2448d28deff1f978e91264bacfdb582a929b115559ca10b8c5ba39abcfbe6ebb1e0506ea0dd5cf0f771970677fb8b8ba3869ca8abe2e1bf7480506ff8a33f4840dc7e02c32b36faaf3c3e12f1eee747b6ababf47a3db7699e3ddcf719d7da2378b2a3b52c259de9a03f21d9bd8ca5fce95c2a78b969dba5fa39ec18e05146a220c536ea9a69c4fc653c4c15ca4f7eaed7c2089977cde680194e03e52323f638a30fe3fe109d93f8c587d7c4e5ebc348ba388605ab19bafef0c695d5ff17446684aaa3133cc77fea0a203dcc54215f8671e320495a1b2bbe9f8b8691c317a99873ed4a30f13b011337b435ca22095d026b974a9d3bc194737dc8ef9cd8f5115553385d4fbf41e9b885a3ee0e576caf4ed2381bbff6c010470f0426e2f1f7a030eb8d77600f44604dbb02ac48522661814e0b52e0bb1b8f0ccb4e52b510f1167a8965da428902ed62d3d8df562ed07ca5d24d166d6de0680169ac4820f6a35e029eaca82ac34035f01b39949c413fe6d129469982dbdd40236657442ce0632489bb5a21ded0e6013c5c316134c2c254cb0873f45de62d742b848dfae7ad71c234025096b23827a7c064b86b736c207e5713530bd4c5568fab705ad056f3ae0714e0f03404c46d9bb42218d68df2fbfe2bdc823630cf64e123a7e208c6a5b9a7758872c30cdf03001533e49228a7566b148a3c85a295482655383b81dc324bab3183f6cc3656d6eaed43f442d6ff55e6f206322fabad9fced893af630cd666e47675b4873be698eea91431339865a605f990bab4edde607e12b57780787afd3a73a3c1ca4426da4cc21635c16bfbc2817752a79df295665d4e2e082566c066281cd09d2f01b0f89df0fdc3d4159186f36849c0fe07a60c79cfebcd124b348edd9869d8ec24f5aa69ddc27f7f8b1b50e9c49c725e93e62088a686db8a49c6f79f884fc2e6799141c155b57d417c11760229ef425e59fcf49ceb7267e84b334c2fa969b787fe7ab6d62de0d923b32c723a7ff8a8febf1335203459b02f107ee7068df2ae2754b50734cdb1f810ff3484df2811c4a465efb5d3ec9291493096ff168bff1a06dd7fde46dd558877370b6d95bcab00593746e877bceb0ad9ca3efaaf7fc1e1c54232ff1835469d37b15a3adb301daaf941c43eb61e73e45b0364a7bb9265746475bf57564cfc5e1897448178bcadeafce30f939c87828a79173794eb7e39756c82f6c30115b51700192c0ac9d21978af7bfe94c0875cf7c9a3f0d98ae6985379f59b57800e90e5e9de4bd6c17e2af641face444dab8f5c66e656748554954905653fd19c3b5d799d94d904aad2604ceb7738855fea4dc57478a9e25d6187e91c9ae61f4204b7a2fabe71fe6bc53dad01b60c4bc134b5539a5377cff5f2bba10d264ec44d798fb81d8f8760113c4b9788aea1cd59bff690323008d58fbeec02d9149ba361ab8b4ee9f158e281893c13ed5bbbfdbd3b7a3a52beb31ea70a66958cd14fa71297cfdf9aeff206d6bb95ad7608532444345d586e3937a9a4eda2ea0a655335f0c67aa00ee8d63f9d55e46405150b6a482cc6bec8e0bfdbabf1de18983303dd16d07ab5bc2a7b3f44a82a4af3892732d911b9ad6f2138b441b957b7f0722037b2cc591c4bbf74299e43e5a54794d774cb4496b8f84444dec3e536137eb3042f169775389e961ea41722a4598756ae7a14c73d6abdeb5c82e3ebebc7f50b8e0a5d294187d130ba484a7513002b25dfd39e32481beaa3b1bf8112e384a4386c455d0fa2dcd5d11913cfc73b8c2e727d2ffb8262819333b67517e77c0b9b9e8b3f2aa4efe9d89edc444fb44c4cece1774cf74c7b17e16ad91570e9f6eacd3d8d9f458b1a5abc049e5e2246ee243d8fe93c76e652e12b18567d3af5187731e6367937d48a84c6ffb75d3215dcd04545d0d6d442684c78816b38d557ef1e58064e35aeb1853f18128a5342ece2cf9af2079c149047cfe3b192e7f03fb13cfb6f5600e0d4846bf1aa64aa18206d8c3959f329d82d93bca148edbd8b952133c2595f686cd83d9363a1d09c4ee75eb8962d3832d6ad2284d0706c51e6bf4ba2cbe984c8c459906529d203e18bc9210836545e5ce0986e760351ad1a089f2307c127bf52f93cd5769acfab13f0bc7b8aa0a1035b07bbfa36e12f8cd5b07632895d128514779be4b06d2114e6a0a743b92f0c9224cc77f739243348bdf024f67fd03fac09005402641f760cef9b9978829e16f2dd930c23e418a892f1c08e62245d2bc58d768c56132c7214ed9f3153686f32552d8e70c72e66cc8cf1c9c190e70a2fbdc04a1a4e83badc46d6117369c58096c7bb0235b0d1c1135162a5e37ccbe21308e3158918a7145ef15ce580e8e8403b618af6da29763fbca6063a6ad41349315af03343c9a129eeccb82aea06e1835001673e7971db68c1ce3909c92c0dd343fcce156d9563cf76fff6099b0b316ee70ab9073d11b0f7ed447d066cf831f80728d5fdc284b2b3040af03fadc24d40a0f9b9841d07debe0bd84ce511db4aab21863e5af786fdfc491224bc31633292bc0ab19c6a68664f2d474045eb375816f8fd0de422183c8b1193d3cf511a847367a9adb75b4d9ad8be1110f7e30b3cc53ae2c63f5a7b4e398da1ae161bbc81a6d1da1bba1f61e07591fc38acb41be8403e120d94c527cc3d08334ff5d5331f9ff14cd29140cf7af4511747ee66dd51d2ddf694208c9bc70a331602db0ac2649f082a1850b20b8dad22b71f4285ba2c00364bd388e8e71fb756b1fc069ea417976600ed90b97f9238b632601ec615d5eb34450c7863cd6c5dbbbc276bda6a0c504641bf60e75afb6728148538b9deefea7aeab53da93d7d2dcc1d19ff67f042db051ee275d052b6f579eed9fa229e8e46452e886f5459c828c963f1262e5bb316c1df10bf09eae5ee0dda2fdb58dc418d46c04ae9bbf569b91b12f81e8707fb08087e5f2e60f6d1ff8196d9a6b9fe2a8b820ca8ef6a07ebf90c0ada9cb9798d8d64bf3ea93b76b44ddccd843c9945e9412c5194d9a2db5947f199cd2e54a5f0fa80de9a6bbd882433773ecd762edee6a30e33ae9558eee9d8bbb77be6ca252ce9ff3cafca30f096a00175644cb13f5ad0604ffab5216502b133e276b83a4f1df3f73e87a2193882dae20be01380130011c6e56c93f9b0dd43e3be46147072f02aa7b12eca65ade0730fb519608a926a6c5882ff7dbf5cfbdff5838f49a3c6b981d6f3eb42752a0b0793890d47f70f2b6e0fdb8cee6e686ac9b81c7c739112f5d798a2c2263e075545875ab143fb234efcc866c8bada423b3956ddafd086b80ce9c371857d24f7333e528d6741000a741cfad1764cbabc4d609636e1c0bc49918f61548436d3d23f7a51eb14d79cff6f845067e4d0c1507db545a5e68f97249a1ff2a85291f298a0ecfdc96da2303e76cf8990d94e578611f3e048eafd13fc66f04f3eb43e81eeb82d967415a4b75951ceaa0cdd483b07959eabcc03cf4c8db30ca3d9e5e4df7428ae0d6225399f5e06cbafb9d532a39c2bf0819ae8ad755390d5f028d64d775a21266019ce2d8a25fe629cd006a99336709613b907c7f8685d74d65b61324f67139045a467ac5f926dbd25721b3b0b0f194cc0421e01b962e44a0e5399f3c07c15eb6d5ce61f1c71c85d2f0af6fdb07aa69dd50fead501bdc487df14ba3972ebde0ed94e472b50da7fc263d9c2b4d78efc4bb61cf94c730235cc134725d17d65af26299b06c2e97009f7e45300bfbfb9f1f4d8e619aa6823245132b45ff3267579a17d7c8dc25413e109e888c06491085850a423b9feb6f086e80e5a3312c5a33efc6c436397586d96da50ae95f8550d7932b7a643e8f5dd99d82f2bf37c3d47ce098493c1f20578d0bac1fe154007983affe4d1cec49ad919e55fb24c5fe864d103c991e67117fcc4bcc344957c62ff609d4ea42d6a1b448886bf2ac340d23e4a76c19bfb2b24ec92ecb4882a0756824cdf31d4ef93207765aaeafeb3b08d2e11e6c0b1c807b4c8308685e3b9f925685c25c5ea784c72e39e64e4afc50f8b8a22ae6f4bdad4a26ffddf5951ab1c5fc84e574c73c8bec978a239ae609c553265ab2038d57fe425981754e25f4565d0d6c524eeea12ab1ece3bed3eca8de3b6fc0d65796f9b049b0de7c1f2c153330cf391699c9c132be1a019b60b6717fe6a20bf1ad9e0fb9008ad3972129a7a9de71f8bbba1397fd237ecc6353df8cf2a22ddded97db7f56f621062fca4bd308762b51142b628187d099420d00c7a25060418c0273d2a44bfaeb5bf86fbd81fd137f8c15a846e1dd24ae21f56a81a7d52567831b49b2eaf0587745c5dd6af30afaa95c58bc437610caa762d3c693d4077eb106aed0b704b70636d9201b9c469f8d03f61882ac2a2246cea4b8f07072b9939153bd011f19cc1fd4e3c9e4266164fbf3fc07210219a7e73b12cd222fe4e5c79ebc04a2ee559c351cdf5fd287d207840bab008cf86cef9f55de2cc9e0a0cb2f29da7ff40afd956a5ad90333ad03543ac97c8520d11f9140c9e4e5026f59996858886ac87bdb56064b3df5cf27d9a5e151e8764534e5fa3aa8dff351f84a148b1855e10be9683b0813bb7b695250012c8c8b747b423af20929e741e7081a7a14c9c1d3dcb4bf97e9dc176a2b0cda9fd8ab31369ad1f497e882d9db46675c1ee1ede19c6fbef80dd359cfb707e8fcbb3597918159de1e641b5c966a2d1771fd1dca5098fe59befe320c74972882ec9efc11a64ffb8095ac9df3f2ac008b9e49e5b1c5a77a4bcb34371d4333439580604af5a847fcdced1b8e6573ec84ef43502e4b3629786d871e1fd5e7e45733a5068f7ce4b8096c736fb511e793b623d0e671cae18b07cf7a61f6fc3d080c7609ac116a2e99c55530e1f5cae35d37d3536dd939aba010158a45c04989bb0ab398bed8e438dba96faf4ac60d0dc6c46d29e731de9802da8ef708638c297cda8f75a3feab306b162f2a44b51cd27d253795b583efd74f62f26fe4f60d1fe648c87870d483ad3746b1339c73b6bdab0f6144a69f3c8e5a69b186571ad67abbd240f4005b7849bb4e605c37eb35da66d933acde15206f98f08e0cfdd37e7bdabcf05f7689404c490961537a6b9eb18634a8e6d1a840f0c87c6588b88f51e5070449b2f523d05e104f0907e0dcb5800ea29dc4a27dec8b9395caa170631acb61adbc71c89141ab5ba43d916fc87ca8f1ef4d9b4ad5dd36ea45169a2a2885219b8b0b9c8fc3715df951a424869a8290f65c77b12d37c340feb8c254bf62408fc02c30d3342d28ab5ad22633f803de2932e8bf22d076dfd32fd5f719894aa580d0b9a893eb53795155bd11c1a7ef0610d1291941678d36b97938684eedfa64153391e98b6266689c33028c9e0acfe93c23ba69484cbb41d9f564b6165d4e1f0e6e00b1c96b74c6b1d2aa08d4d197bc37358f81d9835e85a59011695553595c0b55d2c99bf113cc27c43a198789532dea37cbbd04ab47146b5558144dcc8cb6f6bd63a5e101943fce21e637a90735f96b819c43ac4fb21a266464d2037904e3364aff9783f31ffa4b9daf0ae2819877d4c31351332779dc2dc5de6da63794d44881e178c600a46821334f2a14d56c42a3a36d6069296d0ece3501f509b3142ee45c2e736d337c13c11a68b669edcf7502a14b82423d3da3f3ec58174eca2af7ca570c0601a3be655e042d10033e0ad3f2cbc4ce016a4897fd70ffb7ac149fcd80e568b204a2ba5dcfe8360892ff17e18cbfaf6c1c8c2e588f8fbd9709edaf3e42d69eeff00c0ceaac81376496221164cb04fc6e07da221665eb88f649f1b8b437ec6de9459aebb0ae0974b003e8502fe2223842c589c5b1175f1aafbbd15da5ba8d79b5c829dc1afb7d8ef9736ee3e52d2209c5cfbf0b466ed977af9146c33b7d92ae7882832188714bdfe26cd00face8817ee945190dc7b66557138f6a938507cca80f1b5a575705b9e0d52d3b9f170a4677ce232dd4e833dfdcf66fce4977bfeb8dae08b72506193950ccc93ebd359c34b0da67dcf62eb1cc8ce2bc71fb9c1d26939958a434abb05b680e279f83a87615098abdc4913fd654c066d9e44025e54d4f170636e9c49ad70cd4615f35ba8ae59c31872d215a49c8f7c78590af9fb2928af63846f8d3b4a29a88151cb74dee0d93fbf96d8c88b8105669af5a9ede65415a7573ef7152c5c01f3fc498e0c92bcea2a202faf2c209566301ee640c0484225816ee772db9796e15ee45ae9f6a55d7dbe18bbaa637e8b07dec92bd56066238820c4e2f44c1b02da188cd07ba202d7f69d4ae7b4ce5c3e0ac5e718ebdb1e743c7c86417dde00c9c3917cb0888e9a715b8a9a8555f839dd57d566d43138274741cf439258f7188382e3938a118d001490414fc765c4352b38eae329ff77be4fb2812c7b214478745f92f258f3259582e2a6083b58b6aa46a7d2ae608ebf70eaa4ad89fa20bf7fdebdded47c36665b0325779281b46e0c798d8d60325b7cbc5440767c4c539621178a879da2cd83d0d2903385450e3d7b87df77994d8b4432b77fe0aceacac36f9cf1b5d959a30ddf6b0c5cd45554293acfbe7ac80b2e1204ed42f4563885b9008ed136757249462b88d79b7496801eb9ca0fd1ae2a5bd70ab84b43d55b467bfd632ad696d72948bafeb97f3bc28d09762f75d4dd55fcca1c1f7b1a58d16e108cf061cba0d339ce1307394153f172616592b978a90fc6e00629b271a655754676f5281c7cac2ad28b31151a19b59226a11351c23141f7e455e7b48f8034a2a7efeedb15806f6f7f6c8fc4897f6964bf9e23f5623f951eee8c8fcf36dfe7d6ba566e644371fdd2917688829c4dbd8e69438e9b7711c867d9c639a6d134b708125d6765cacf8fbc4011924fd90503867338f51569d76ab8f257db42ccabf4d4e6af41881989316e5b127a35d4d725fd7f7244016d890c54f5c6ee15d33958dac50438f23a6d365af5ab260b460e2eca74c6e20846120651befa4f87154332d04255cfc2bc02e9a3864e099eff6c7c7e5cdc8419f75ba4281b6f217cb5b104c16d89c2539cdaf168269495eba03c60ee6e93c4eec02c17eeeedf3ce124a46e641cdafa31a42251c1feaaa827acd05d7653492db057e2018a5d11b44258b76006f9d9e550a9c915d4fdd3dd115274b42c3b6f492125a2f08e6ca1cffccb842c9b784ca252c6fb3644c75a0412cc9ccb6fea364a88db59cf5961acea3495793923e8769dbc63be3522e1eadf334f2b67abc4ac40291b92689d8a4c5aa4975fec67f005c66869bb9ce56ece210d57cec86645b4351cbaf7daf7afb6b1035a4fc763427d936a3653cea11b3a5a35bbab981146bdd19d580e19941a6cdaa46906e46a2fbdc68a4ccdbe29e074a8f74a2714c9386d0fdac3d17cc7e784b50341b3bc6594315c8ac2e1d4b6b07d308aef0ea2c3683a18be1273fb4428f7ea5e5df163cad52d6c029ebe6174188e6bbde60b15ce3e19d8ad00fa5f230fa9ba93ea612e33210b5a1095db58d3c362b6ae77d8e21731b786c4025deba28905086e4b82c3544dc0497948e5a22fa9a654c8d622672ef3ce79d63021e6a5578599010ddc5411594e7efe0e60d9fd25209ee96fa62239c9dd96e7889bb6ad443c110f712187a142f1a9d131dad47263a9841cd5b432517b7cc50682e29f95e385c68967ca4356fc0a759249991b7e24b1057dac5bb908995493f4fac16fdeb58a8d9bd15bc1aaad77ea4d5d25427be47619840415f737fe9def64b94ccb3cbcecb292136a5a044961cf84d0af2cac625d830a2c2be5f0e5c50cfd8e241d0c82ef09dcfd947e5bd8380b6d8b606ab9e6583d911384124c4ce48a96261fddd0e1fe7ec3728ef3a1dabc2e142f40f49b8973b5e213a2beae6052863b7682b9e8dda215e7b5a3a1cd8e40a788a04390265ad0be1e36908266bf0d132a35dd7b952a791ac3487eaf086fb5957f31e366bac1f10c82b2b14246544e0b20c62fc8dd161d7b016f1bb46f1a0a647baa3a50c9e1acd808abe5ea64e9a6999f2bea48ec9a841a37e71e88b80203542684c1c2baca8138dbb7e9a3aac46690452708f210ae06ec694f8a4d7eb8c003e671788dc082463506ab702f891dd5e6df39370d8d90b504a5b145d7c78e7d267de80ed9e92610ae704fc6c5047626d479899a19af1fde03e76309c864c064f96a6b8fb5dfeca6b4f2ce54bb867c14628e48c92b439975fd386bef5b726e8083ae8ac4483b850b3c4fce365c651a2b412c87664bf9e19755dc791032bc1a2a3d3ce9f3c1627e857f0e16bebfd30aed171676e20a2457621ee9336e419ffe59445d95b1b03bfd5350cc2ef6f49995040ad9c88dec5790d87113917cf6b42fa92bcd927b8a7b32582d32e12691083bdbd0288f0bc022115efc4d0c4cc6bd4d20b07446d0ab9eebb17d5640f2b8329686e9d9cacc67d856d07fe80632e3720a58b777f1d750444a73d6faa025a291c0afff2dca65dcfad74572050df6e93cd57be0191f9e2e01cc3d64967f868cd84c7d26483c37ae1dd1628422f1637d9469e02fbd868aa4e1e45139d81231e3d4ca967814b82bbd664c7b1352543a8ab9a22e4f3c5250da5e6b372388cd6610e396f5f67a642d6965067c50bf36ed5a7b5cec04da03ea5791d4744559818b95daf3a029c7d0f846bafa7fc64bf0bcd471654f40c18e556a00f6286cdb8d7e24d55673ba81393d0de0d498cd806723b51221c1c88cf32ff78552b19da7c319bf77673dc426118190469014976ae0f7853701f372df8f6d8a208b8f1532184b34a2680eb43e7f70b10cfc916f806476c7bae85e480e121ae830972e07364b88d89d9363aced02b2c9d5114ec41c2590cc4631954823ffb21b356e2d71f2900f1b7df82473ffd683d25d3182bfd4fe42d897c69b517a457aad9237e24527ed525b4d9ac2d4cf420bb1d7819c3c7b7aa2c16d6a3dd4f76045babeb52d3289fc87a71635318a4ece7870e651b4d1a99443de991845361a2b3dc65018176492f42d9dd0bfc7ff530bf7989600f8fe5d6dbafa3370656401b6c9d11603d4b364fb48241744926e8c8fe050b20bda095acf7a398214c578240e481bd8e1ca263a65468767bb79f84ebf6d2b0375ddb6308ab0bdaf11d43d8ccfc34f06e51914fbd1ccb771b70721b6ac0bd6b06752fa08ba11ffb1619e2c99566396030e8586fa7991a47f8385a44e4a6ef7f3ae1db3dfd64b9fd0ef7d4cb867af3eaf50dd04b4b7e66fdcf0a5cb0e9040c896c5c42b42286660dcf9efa4913cfd540e4224c2a6e2715ef3ab61746e98a37b46b8fb9944f75b262e302ec59bfc71ef3ddb7548e40f287dc3c691db5c5740c0aac9ea795f8cba890e62a84c97d669f2988da5ec10ae7754636f6a08d3d270bc5e34edca096480087efddd12aa7b2aad818677f1f5a57078682fd33f537172e4bb9bd5208ebbe0209426350c8ceda1b85d6f34b8bd1046da342993920f92e5d7fb4dee5a2520f5ecdab4c456ef99903ebbd91fa137230af3f2d8d8a398a04c3dc92fed34e79da079cc8f2b3a8ffc829ecce4b65e0a11ec44839e6719951388974ded75e3c4f37caa2cd38256070b04e8feb2010b59a6f963680ad55218d32bea7d3156c422633736a91dc508b53f6feeacfb739677e08a94dba8b01a92c0cedfb40d9be5e0d6726ca8844831b378e6107526076883803e65eae5edd5b53957671ec4362a58916374a8665ba47cfe10c8eb2b7387864df8a7658b3fcebeee8a33a932f5c9585cd6c149a673543179a108eabb589187c1dde14b1c08aad38c4cb2d4612037c0195ebb204ea6bf6bf8e999f7082e6b2dab358184f80e611f2298ef9259d48441aa9749d91833828d359faa89d119298bc793f12c931d9d1d740a7f35ffd58a424352c15bfa7b0f5be233476784ab943c2618d01adf30d697f7c3a35064861e23855f92a9ccc01d67e3e0e28c4f9a521714734e3623286163b0ca0da35a04648bc8201814124092722b75c818dce703edd2044c1d7c2e458da2d67d01c5418ee997329b3a9bddd04cceb951a8e4127e0634e2d65673397cf94ae25a08dc4ada99d7df6992a5063564ba03cb0b10922b79ef89c445135df738e8914a14de32882eb25b61397d6ad74e091cbde67ae449104d3aaf4878a790cb24d90e24eb635f0738781b5f7c1b1fbd4eafe7d3632a02882126aadcec4832689eea1d0ef452a440a99e32bc70fd5e8356306e40215ea345a916d9ba3d8d8366f6740e995ac29efcfd5f785a2cc9dffcc60b284ae8e2f84b3ab838c4cb7afa55f349148f808bd2360aca3b4402771b4fc0d2aa30b6c241d1829ed69c40fbdc093c5aac807a864ef83eb5ab11cce2167866adfe241dfe9d31454727e629bd6c63cec400e0f2ca4375c5f727e67fc4fe248db07bc32cffaad1010971a4b07b4c0f350db0cc6e5916938ab503c42e2de6a3f04d4dd6e358ac9fdaa9ce22aaf40618c92e173e419d10bcf9e1e7570a206a835ac1fb945c21b9a489f17814b6a002ca68f735066caf57cc4fa6ce6426ffb85b8908569cf7f8ad22a50162e71fd24ee5af2ac75a10b483a114755a6abdd7025cb292af770e51f580987003456f54ca66845f5bdab3fbd872fa77647912e84a4635a2ba3d48317fab57dd53e96757b932ffdf021072c0c5f2a24c40879af0306185838d62d2509c425f4f725ea49bd19604c289f9689a25421bc97a9c3d9224ff048c516802f2ec1328e40a5b649128a9d6bec3d386f7451511f39fdbda471a65ab058b697889250fb187aa0dc2b9f104d20b50aebed7056532faa8ef5feaeaec862d73d5639bf7236783f87434b7fe5c51ddc5d2ba5b26bd0be770dec76d8f39adb0e60d9881a7824e04cc438a010080c674326f3beb70f0fd0d07905b6c35fc30be64277d6e29cd43f6a7006d5cbb4e23c183894340f02f5cc62d2d9e67ee0c0eb394eeec2c7f71b775238ccd7ecf9c1261ffa547802139945bca048d2550d86c65c36398f9f55b5fa3eb2e17f58181749019d73e3e12a155949bedfd3bcbfb31c300763895a746b42d91133bcfe707d3dbbc4effe403d1c9461c365a6add7680f1652c55061d26f89780eebe524818c66532c7fdc55988ab8593a22d2abe45600d24af7d58ceedc61021f71233e15face2b1ca1136bf14814078ae107db66a60a71d372f4feb4644ce588f68157560ff2ca13eb8666ecf58af897b4f2e1c0d28a1ae3110aaa4a497fe1ec6616efc33fbd70d691e2646771fd11ec53752572e9de28df3fa1af112c4cdd4b8eb0319dca560a607611d3573912fbdd1f3545ef8b3ef8ab8aa3ce5a8d0b206eb5abe9bf6ebb237a884a79117c7a7938fb9bad5b39ca74b06f84160e90daab401950394048574d776fe213c032749b75fa2617a2b0c3097a2d8b43d44fcc93f63849a002db3bc5231388a1979cd9f877a10edb53067d1df04259e6eb6419700950fe5df30632fa68120531a69555b5cfda0f40e53b485f51305cfcc1456fa2bc8bfb9c320b6b69f22b1ae1e0cecd549f8fb5a771970f0b2d2073a47831671b332bf9e23d7b4f39f50b57fd710a263928954cf570b429e5be173383c9f7fed23fd1c512d6b2d9660883ba892209e9b665d56c16bc7c361762f4362a5120fbba6694e7c7685fdd44b39457c974d327fe6a3f5bb97b84d2c6c407d9f01972080d1de404824d5c6b78710f40e8c4e60a7e9bbc8d8ab4bffec9720091905d868d0e9b48d4be08cfe94165c4921950d84e0e2656cf67e3cf447e9b9f09fe1e8e443f4aa3b6d5d958e85ab859a9ca2d72f4d4c0023fd042a86ebebaf1ea66a89c398cd68a51042fe5dc4732d9a2d992a42807f5e96838c06d8b46814ce9289930833e161589552deb1c5b5112408bf4002f47522808d44a17f7f87ac32f0b423e0dde9eb1d6109924697f17b68bd29dd4b036d4c68d30d387035893a61e7b23654b6a0ef72eecb6769de38d72cdbe5617ce406805730a150d36be6cd2a5dbb78315ecef14fbcb5c3152ef12d95de8649df04a9fcf7b1fb8a372a908294d82eaf42d77273320b06a86ccf2ff0a74beba9b337fd5460b6ca417625215972e58a456babe66eb9df8d421e18cdea4ce30bfb92020ec7c2f336bc7150c8972734165ddbe3276c1b94de3f3ba555d60a5e181dd772f456c5f1f35705771330c43e334741edf28d3f6739d01d48d0d3d577e68425df9246a7e74c97ba7df8a36313ea884768d20523aa52425dc4020bdd1406c7281c99e0145dc751cde99e781eb054c2ab4a24d85b8754cf29b91b4fbd7027e1489f0ff140599a10281c9f985093059d7d75d22c5086044bc8b254b921433ab21e454222441c832a417c672b49b984025a1fcfb64ed96378abd412ed49a57a8231edb75a02deb17acd008ac473f4fa46996e9c49d8da53f30e0f9e12b7426bf91cd674682670b870c291a41a4b42b5d12cd5b418e73e42218cebb7373b8dc51277d15daabd706dc1647c6adbbc85b76d65ac2003013e9031c96d2e0c1e046bc10af400f2878fb39f57371d802a9efe6b54f4833ebe6708cec5dc8f971be2e9fffd005bd81638af367fa2092aa90defd02ce79eaa65a1a090e020d35d9dc6fc491ec802c5f13fcd9de6b63dfc5658e4c7939c149f56fb2caed4e45dae4b9aace8c8747838663a07efcf71b5846401ce3a5e7ee613d42407a779f113bef5081d24576edc1253adfbc96c61489f9a2836e2d53f88dabd50f299fc5e050298be5798f9734df8868438303fdabf02ff568d951f6490a52f9642ae4a2b519950fb8c574646bd8226d3c85664c731b7768a85a32b2d819db25792e9f96318c13b9d50ac8ce45424d0c8a31e390ca2a0e1345b1c3ad2bfb0fb387876f44e1d9a3061be512ae60c1cabcc796c3aa6618e48dba8d85538452b683f730096d78af8425f2fa920b555954a257bfad350b5e5f18b2ba0bd896d522c038550ddff3ad8d63815aebf014fe71a2b7f137bc40dd8891e2498fc23b07cc13c8aeb2424c6586be45984962f75ab18ab971d6eee76890171f6e3f5799cc3cb58144445995f73b208e23478d0cb3e20a31ea7089cfe9171aa80da1a7acacef01219f6f475a910c0254a51d3ae935f49ff7e36217855a2cc75a1ce5e4812704fa63f42df1b612c5fd6812bb50463f8d68576811f0459bd8f24964cf56eefafd2771af9f54fd72fbafb7bb0109431fba6fb1dabc1a6108d74854fdaa07cef5ffb49d5b03a89e66469015609719f0fe532863097938f6330fe9a672a70902f0bebf319010ba8028fcb4761d3cb7345f40874b861592dede54c08af392c9073a1a6fa27c93646833314234a4c9d46d4895b5bc79f0faab215c6f2ddb0a9bc303b61c3941b67f1528bcd7d95893efaa39ea73def5af75e2583b58c1f5494331515adf0de6046fb1ea49a36f5163a40afd3670d6e2e2e1aa82b1fcfb6a3b6d9963b4612ab2840085b48ece9d82be4ff5f5f0e6b1044d51b590c442a23442b1efd2905deac01d0dc5a3a8f258cc637e57edd015587f695abb7b5be0775eaad58776bb67129433ea4acc53ee7dfe072bb35daf58eeb914bd9e20b75efdfd9305bbc3853349a05b2e8f49f56e8c8dda909781f6f1db2449cb7c66913439414a81e2f1b24d2ffb34348fbaf6312b9b6b0783006551789e00e93e56704792bbf30a12f6ff77ce5d8f485a0e967bf705f9123d6fab3f5088f3635e0872ffc1e96a87759ba35f271b89d315716c247177bbe815e261c2bf63e01fbaddb33ccc2df51fd5031f09837e6f35f54991d503b97260ec4a427c24b94750b1f803709f5833f05673e332fd694c51374b201ec02e6635b633a91cd502da6944225f6e5c7509f466f8762c2823cc8e29914d8e5e2916909ec12a01655ad04483cf0cbab4977b65908653255c8cad816695f9426e6d74e8bf34420d92ef09a40f983ecad3fc182cb9b332b695c819bf49c9ecf2f0ed16508d692900aaf6d80b88ea919a277fd2c868d084faecffaf6d45296198561427dd52c636859f29646121c32617762613ddd448eac2db4a6e4fe429be9bbcd355d7bfa1ba81ef078b9e9f1d0a8285d2f0f5247a2e5bd3a961d63ae51aa7b04a976324b6c4db6494d34f20f4994715c741660920c39830ba877bf3fa6e296e77fff4e3835822cc02023bc1aa2efd553dfcff86d260608495012b6a2ee9db9afc94776dbbbc7af6469c3b7d5ff67d145c9f57aa8966d3a88137e05d52b26d53c94ec8110604ebfd307f74595e398ed127e0187d4921bf10c151aea74a1eb0d4232878c275cbe22a3f05cf78437c664ce395356f50f24f4a53dea75e5ce3c3857af848cedf8bc0dfc35532d113516ecde178c4662ad6735e2f08648012157b446a8d6cbbd1958158c9bb7311d813a43e52f5e53cbaa3d1b880ecb314e03c7cecbea8b3497116d9f060b92f7ddf4cfae1c3b0ba0f07542664dd7faf5340ecca10b4827f603d59c7bbe1ae5763ba72b7b831867e07f2a0a2dffc082a0007b369083b373b18c27510597d2730d93b65675f04b0d8347d74fb3658a2de7210800957534ddebf7c773abcfbb5b8394f7ae7b1ea7952b50c895a0701381f3da009e7766ebd84ae47dea7b383a3a39adbc407ed4973108e2505e75fb6a5c7c6d73b7aef72f2079c08b58baa1ac5e5b2efd97f6c47d4b190c080db0121131cdb55837e7daa63bd19a591c557cbc0f747cfbdb34fcb6c7289a61e3c559bb0a93e6ee73037d1894b87e26d382699ed2fb4f16129aa63ec060e29fd3f80ded92e751eb4171f42b02c910f05f2e7ef0ece84dea27e8b7bf8a29054ac67477d67eee87cf884052a4928392ead413a13ed1368aa1d11f18107b53d6c513f312ebd30b41e50ecd46f5ea2313c80c5dba8a4b9f39f44d343b4777698dc7287859781f38ff2ed262a7422c658ca3d798d3ea413e3e65c39b41abebb6ae290696f3ecc8891f0101477e18919a3a6360fc2c154ead395e38a0bdbb5e5ce5f37a9ff700adb7c878946d1b10b40392190c5058a735299a13abc71e5f4eaa9085f8d94835a37e534405bea2503fe96e991c071c0e603006a4ab5c7f9b22ffcbe4a6cc43e9bb434c8985683869fae110dcb5a68a985dc52303e4934d9e41ad433719dadf0c78fc30f2333685178aca4dd3813f0696c6c0ef06c024c34334215d33b198d8e8f33acd9e49b77cadff75b8bc2084a6b62f8daed739b3015b34335a44d080cb242aa4074ee5aeb05791846bf90a15661bfa962b546ab41ff49b3232713424ecaf4a7e0301eaed9f252c16805579dc8a50c7aa59b545e937710bcbb7147aa5650463fdf72e3695072d0acc1c858f642a4660fdf5c838ca149b15865a7c0504ed154b287c6a539eebab58bbe3d5b378d7a919365cbbc179d69cd2769e17b980e76966f89e3e496da4248459a30610b8adc1f5e4eff25526131844b8086b5f3244c5ed0859711a03a9fb5392e6a69ca931755a8d648badeaff2cca8a8734b377f80c23e98f5a85bce159e97ddf8497cd5cdc1f128331a40c02b79e14b6967e953a6d1e61e41176fb5cece47f69d39515cb6bc2a9d52905340fd5cd4da3b45bf6893a4dbb36212028980fb06d1e31a7ec82739184e20642346dee107a0e3ac1f5b0252c5ea05d6bf1fc606b3e1499489ce69924628f88a84b8208b16e7be1592d93da2f2269a836db927d2893124ec5c41049dcb400a54953a90619c3a3c9fbef4ddfa98472df8a9b2ead9161f8b96b00ece5926054fb81f3b84a8dc15325ab0d657d8bb639b4fbdea4fa7ef7b2790a18289a9bd943b638fe182ed760139a9911e7ddf44745966edac2e2555b1d1c9a0c69e4b982b5c3661b28893b0a96f415e80467530ff5a64b02f0c49808df039ce045a4f0414e5b7e9a0ecd8057703fccee354e3feecd16a47d683555e3325b2f7059b41f941c4740c3ec98b5ae0fbe600b851e59e097961b2f931e77ba7fab619ae92c8a66b0e16d710d1be355b5e92784f3d05e0db4a605a15a92c952cf92e1df48960053d57d5da487779331d53814de4dacee7fe486c156a088cd587acd9ff2a2503bf02127a056e3aded7ea666ddaf28d3591a520a16510abe65172faba3af511697a03ec52986124f2f601840953f751418f740a6d317d734327efe99997126e8d1160b9aa75f8a2701159936e17907dfae635e48f7ad095bfd26052ba88aeb37444aaf483253f68a0102fc5c9bd7e2a8e10a09e9015aa067af7658cfa023c22292f67e7235d877d24f9175db4d3dd336115e851afd3febf02ecc8d89a8015c93cf6378d0831f3e177671fd459966587752ea077ec14399cc42c0f25104470b9e1ddc12ff3d44830a74cd079a37c197d39313af85ec656c9570930c621f618932a991f8288e16aee126145aa0cd0316be77d34fcde4f75c3332a3d6c59d78966207096b777ead176d346013d7abb61936fbd5d46681610b1ceae8359ba03e894006d84c1cd89d5ce95ca99bce1bd6c389d9a605b6178e3c95a0705ef0c74dc74040b6cfb901f753e40896560a78a0e478447c0b987751e90cf8ee744e3eb7547654deffef2a90b6a02b90d030783254b54cde734bff9abb893cadee29c0d645a529e0ace442f409667819c5eb9749ba5bdc942b60ffd6378ee73878966a72d4aa994b4842bf57c869f0536fa0e6149fcb1d6cb30bc84fcd92b4a1a6810aa84efe73690a8044c519a1665b493bf982caf0c5d2e39ac8c37300184ad4ab69321d3e93d312bb3ec313d73cfe8299272ee4515c1dc86bc33432907bab73162e1c5fbb4f30d8c79a2cae9aa37c0eeb285d5eaa4316a96745b0422b866904fd15518fac031ddf71ce1d3ff314b18a2c1f14f6574f573e878d72c0a9ce0d006a08b020cb21fc7c93bc5cecbee27bdebe2934b46d4975bb90359a1d1eefddb6cac1cae0b2b398648c92140eda55622c8e4a043069c0dfab463f9944a114473b2324b8280b8d2ca311821b1b3a2b08c430d807fa7be4afd71c0e13cf0d56ee1a3a843a94fbf941c58ec85be3fb2cd5dc69fab2ddbffb5c9879ed77c382b4f475a8ad5a43dd03b0f4f9c8e3867ff406d03b5825f20011eefbb5eaa05ae011140c0297e042bb196c428dbb2a53c29b4a0cda9c5c273bd2919f33534e55a8a10a0c4596a3ceadc65868c4e192bc8372073805734d1553f5c5b6799c0305bc1baa5b5371f9ddab941da2fc11e38c2a4b550e17d98ccfaff0cff162a8ea50d1fc89d33685a90a3c9f657a0210c22b0673ce9af42a72d8f0a79c10f7910e70657a9eeceeca48499d65672deb4e908c0ac1e04e271e82873081b1a9b16a9338f6bf98c0df1c79b01109de0005a71465991b77bfcdf2b54b1711fe09463e2cb4db129f5e28969ce2c486af496b018139a9227f7086fa62a63b486737f61a07ebb07b561b5b143f0d6c3bd2032c4ca68f178425520f5a0df373707000127aff36774d7ba5342fe78087d9a9af5266f7a223b82913a37db3e2bff641bad3fb0018ed5332cc2a9e213beda01bbd4d83cc404fcef25f63632b12afaf1482ee6663b0c2ab0b648018bb3481cd3da1d864fbbbca2fb4bc867110da319acdec172b6b0f24766e7fd472b9128dfc108cf0efa93ed6bc59c3c65e3e332c62465034269d578fba9dc5346151da0009733d9d6f4e5f3d3ec9d09bdf50015b3f5dedf49334e758c296822473352f487edf386d350ed44b32a06a6426783998e324e4bce042bc34af42e8dbd016845536a0a38fc1aeda83f06b99a48c65218a58582e42b20257e131e796bbc07fc525bc3a855d26e9a3f69ef7a3b0e2299906a968a4a0621a1d88d87079787784da91f225f80051137c989fd9af1a752a63e59137139a21baf3895bfa59a31a227c642314c566e67a5571bc45a3e2bfbc5e03c729bdd5bc3990636c6d0a5ea02c216f2850b8e3d4aa8c858f865ba2156cd3736eb4e8907c00af4128da9e5ffe6cfc69dc238d11b6604da4f9f52047f59de090c561d72dcb4e71fe72ff839dce94128ac94f0aa3b340624e6e905b606326be57fc8fb5551fe86401c4ae3b00f5ab9d5a74bd89491e7be4611a022026f3073273ea9203839c821108810c638413229731f1454708ef5ac52f5007df456b22a73a29e94475ed005c64f29592bf013f3e403aa6bea336c7bb31f1601ddb934dc0155ecdd991cd45c1b828c7dcf7592d8e9f85c06931071772a419ab3582d81f658d212a62e5212175d1303d35fc94489fa1f31d70a9f8ab1cb4dc457309f722bed5927c7b26511aa8df916b6f57a5e1402f0c2a0be00895a9eabeebd7df602936255a79fb3f39e767fbd5be7223ea09e73ba2c927ab690f95531966c3c82703cf373b089ec8bc8e303708429c66dc9361f18036972f72d8cab3a236535e291fa1c4c040bfb6de8ed36e514f14bb5710adf3432626c18ae0c8bc74711a6523d936bd1b03beab1b1eb9ce7033e43dd1e1e3f60813d7ce62f87e0e7acc4ca9f80d44112e4c2c9cafca5612aa2a3184e382a24efb845f9ec4afad401693352026175d9a3b8f1af702e288c3162d22f490adffa2fe41266443a309ba2327aad9da81d8624906a1e2b032987f93a4f2a300669aeabd6c5b8a040d05296f28ac756c04296badc86a88ee830056fed08bc8d18a029e97b9a54b38d45239c2e1fbace23056880ca1e7ffd175abba0a46e49e63b815ee76c0ef565710c84f26c4cbfd76de39d725c4b1baca7a6fef1f4cebc0154b1b8f6dde61c1f0caf1bab2c6a2bc1ba1f3a0b9e34ab7ebfbf6496d26ded2bc99c910f3080717f192b4a6c378f6a79534b6600c7071275ad74c0e6675f02e6890c8435a025193171fc541bd0087897acf4a546b6be0664993119494d196c3a5f98667bc54a9725b1a70ec3ac25879d6e002211f6e61b53f1dd811f33b8c279a8a14c3d34caaf742dba7de554caa435f2c73fdd5355cff9db92985f0294594274d84e18b11ea1c0605fb820a282044329a1e0e0a82947050efd8089eeff4f0da9822d2ed4050a20a3f5a29adabce783f0041c8914c1b5218ea5a38b7788d9fd1669bb59515795de928e5a6bdc8296885640819ac5add908bfb19c84d92ec063f3eb276fe66c1d8e0652c1406a73068068e84e0b01714c244e0caadf0df48318eb1d1c84631952efe061bb87e92343d06640a0b880c19331b42f6f3a58e62b1287a906e3243b75be452617665ad07e81366b7456bb00742849ea4351cecb8bcd7690e0e581ef88f6f4c80bc72f87c71b9c590cc851ca428bb102b3fd94cda01063551641c121e7bd4c7ecc50b88d9dbec5a316f9406cdbd06649be31ecb0648f6f21252e07b96b9441409ecf72fd88f8c468243c636104d4895a03f42e4ec02aeba0e777ae44d61effe7a4a4ac2e010a4aca598f4ff21b932768c8570b7195b8fb35bf2b0355cdb8267281cf0b44008fc843a5846a980926da504408ad204de0223d4e5397dfd73064db2dc249ce05cdf3cf6c8636893f4967338ce7fff040eb2b6ee02716b4bcdf52b4223367d91edd0bbafce819ac716a68512a5c8c629ff669e6d5f4c9aa62e8d46005168a20a3eb3a53c96d905d674c0fce9faacd46deda537489306a0b1f537b316a6cdb1633bef2d4fd7e98df8a03aee1f318b513f66d66b2260e8e73d52414a5210390918f1ceca1e42cec1da4223378d8a7ba8428cf1824257f00c2c2b89b8a5f9619a60ececa1297059ba212c490f124c36ee7402ed93317c5b8a6e87f3daf61ef3319d075a7d3fb360e00babf38504154bc0361ed176a8e9254df9721a0e745f487a883c5ce63d006a239f8977786771df6abe4ebebddd228e64029e984d7ee9fa439c24f920f1635a01e706346690836fcbc4c2215d0a31620699a14ff9cea7e6d0d10b738e19998f13e4a78a1da3b53dd53b5ccff2473a8669c3c938373f12ec516eb2c2bdbf6b04b5e70c1f43df3837fd5ca954cda9290436ed0355b44128c59d39ffb24ce813f2e29a3f96b68f32137dae0e8f60f2a4761e1312d99d68519e708b8e4fc15cdeca5b74b8a3618c16e0272a305f617ab23d0d718667cbfb6b52a5d73d3e90664432a3ea3562bf4982a77ad493125b9707ab97da6afaecd1f8c8e543b881a86dd2f156d4e00ad815a819e05e30dc62e0163eb1041df62c554356df4ed59f12eefef4937efc5a5c8f1d90242d03bc2c37a26e0a1d4df464f20fc89d3904d075b786dbf6e2e9b0edaa84819297302a12b75c8c8c90e210b6323d561f23782490f73c712f03121304328d72fe671f3ac12d3c2a5050a4bfe4f6c7161b57256b05a73121862d8ecbbfd33c462694bafcbc785e0aaaaed13e44006cbedab51cd5dc29c02b8e6380d818ca014f074d24a802d7f3d03936b29190bc71cae30978ad91ce1935ea1bff913113b8d3fda64573c02e774198f7fe5682e31e521600666ef8f829b7f9c1365868fd7e8b868ee2ec59f5383dfd34416e186dd7cb6ecab1644033995b8fac6af2b1b87fa853cb4fc9d167a5e18e4b5a611b7499e3a90c6476b40c2ad88ea4ca4f9b8a607262cedf61b8fd191989a81400b0d34c599942c4c360769a2f354684333837351bb0ebac00a500b378d281a60e9de018fab6c811bfe8c11799182af6c3802a23e77d4c2046923d2a347a5943b9067b8c3f83ce1e58b77b65686c3fbdf469c847ec95c53e08590567a24a3053b15da72f2dd2c7d90e7c26883b5d8bcaaad45523af0df6a9af4ea702c2b6ac06c2ee610548bc6feb94dae04b6d2999d6c9a5c11a8167faf046f027523ef307a5654b76751987ef4f928581af9bce5f28b0bd779cd9969bef3f8dec1b852586f9e2e44b1537206dc744f4ca29991dc9aea37c25af6301ae54ea46902a9f41056ca98cd1437dd62fd15bb0be1fc39fee5d8bf75b601cfd7193fc79015fe2b0910ed786ff984dd5bb07c642affbc4ec3ef877ed8199a156ba0ef99b7ad8c1eb77a948a9222462a9f9d403a8e3a89f5dad0f43de120a1d217a167127170b08acdfe49bf5a865e1f287193e2c45144273f774dd8ade41869c7a3353fcb3230331d5a251bf8eb9c07a7bf5c74627e0ffc71c514b97d1b05bcd4dc06901af1dfc997c940f09776452e52047faec113bff674248e9bd7ff7052628a1ef0fb06bceb894c0441e2e41840973bfe2eb672ed4edd33db62fc217b9dbbec4190857488ed1ba6315a69644e0bd79fb5c847ef10d4c58b64eca2d4f7f63ca058bfde794ca891d4eb25e1f726ca944f663ecca633514e177a0b9db7e2b13aaae02015bd91d073ffb9eed14325654678aa34691fb5a41731f5e61a52f12dfc9e2cb6ed7b72ede3c86157790fe152bf71269fa4a7f771815128560cd4b3758e5de78f891e4206ceab095ca8dcffea369ce7959f75c41b568fd620ec0cdcd893321eef6b358068a0a158e29c900760207d87aa5a4b3f187653d63de88754dc585e8d6c2a431d59a82487c02b24a132bbf2cf3657b97f62c1d9b982114e0b3fabd9c84f12a8715bde832adc4f5f97af02ebe69275e49752f45b1fdc4c1dd8fe07e1f9b27bbad6a0c0efbc3518848be6d38a9ca4b9081ba03a579d6b46f112b10062183939267e15acd1a8df17d6931b40726acd08e17937878024c2bbe58de1aca54de2650f9a4011d58ff86ccf56919af1017c04f0e5149a6c190a4295c28d00d54a0b8ed1e781e25c9202d357839171ba86c5ea5894a8242a3b6ffd61fec1b16cf6505668c28c222e9d83197be0e37f52a41ac4515a27ec6b7729deb5c6a2df64a3970a65f3d7bb87f45e344213954bcc5f6a6f491407c57327fa3d7fced8071353a6c99999be8cb4c1f99d89f9fc67ddc2a985bc3bbc4519de34f83aa33488dca586efc665a0a1c4327cc29f599ddb6519bd0f5925e709a11f7d97067e96b3f2e1ed0c39cae353ff4929052f59eb7608230d462bc30588fb59650a98429d7df6b6f5fa9a8372948bb324bc55741cf3380d9ae349d0fe3beba3959e9b23e995d851d4e7705eee944418a2e3166f31fc391c41597a4c609358e8260e71f33c6fc9f71ecf3790781e87c650d8dc0ff3bcfba474e64718f6b367c52b0a2842fa5fe2e92a8924468a72a7064f460691105712b8a4cfce3e21633bb17f8f8b1cfac39bfb46f5e88f6bf762ed3f52c3ca7563777351001c9fa97af624113c2d93e76a5d61a5a7d8a0fc7a99dc9dfa9219113ef5359d8b2931da9e15a748e87608d9fc7aa15f98873ce92f8dced6e53d9dbeba6e519e775f2c7f8ba4d6bbe9adc374590ffdd921e82578512052e712c78ec11ac930e093a78e5a31978029919dda7a9a7d602f0e6e5df9702be9750cac7ef3ed6e55db487bcc8b53b9f8ca8fa064fd4c0f0ea852f15ca0f47717daf0052a2f9ae71f656a36314a1b0afd78ea74ccf87f4e54b48a905ab53b06c448c2755b80f47dbad559e8160f26658183d33617863536f598462db74b3d87a18ee7f1861dd735740f3deec9dbfe1d1152a3b21fd34c7265b6d19d2d86d9bb72a620ed6f5d1b1192d69753f34c1c73f365d78d0ac6ba91810a6906a5b1ca9ac44ec8d989bea7e18b11b7028dccecd93b21888c081846171570fc4b3eedd473a92a195fd8da975c65c07dfdaf98f58877cd0749ced34633aff1721a301b0b16776e9e44887a94607252b390fb3eff0318f389f2f14dc233098bd670d39daba5748cc3c4c7424adc09f11015ccb132aac85eeba4094545480a40ed03c46942b5e911be5e9d487eb25a324720b8f064ddffada9e3946cba3756fab472b369795cb72c113791135ec2311aafe0bb4b25672be0290e462663c6f9c73d915dfd6ef31e77e9098e7687b663abec38b19563ca97df7ebe23f76017c862de5fefeee497c392fe0686fa528e70b4ead1ae4fd72c4fd59da02058011c68fe8e07d7a87f0fbdb60c517bef49f5a2c078996de2dfc6cae757cbc3a7127d801d251406f076d0f09b741b37e8f56f6b4ca2405a6afe135abd37689c63a6519e4d2f8092150257a4ab1368de4187106c886b9ad20796efdfc04f3dd060ebfdf428a3a79f24d90e0f0593a384fce16cc7227738719caa9bb46cef76eb10800f7b88845873bfda059dc39662bfc305b811f045cadc04e59f739324d40f0b6a3d0a720b97f2e173f9a7730cd20c21dc4c64bcb796c476f3a5914cde8e956a2a8585683731d1780ca80cbf873e6c905455a284d690c7f900e5a8d5b464eefce7e58efab40efa5868aae9e63de7ee95d57b4ea8e001f0d15756bbb507cc60cfbaa384f35c34c140ff312b280e96cd9dcfad28abb12802c118f669235cbac7921b55389e525fa64d21a38d872113806ac46662c77189eac16f6afbbb23c8d8c24a85de98974965413af1558300f0631f61f4855c7e347d10986fbbd10af3f13cc1b9bb3cb1eae1dd41d26ea7dfac83df4ea73cc2f704a67ed004f74f6390ec4994209e1365b7048a526caca603a17d276901814bbc1dc901d604e389534d359e9a550ec8eba2ab69c4c7f245658dc1dadaccb29cf35648e157a7149caf087fa7c0d31b8066536c34a52127278fc217249264f188d1448ba105d15e832a2994bc25c07e4f6b114a4d09727d55353c25b8204beabaa9c9e1b4cedcdcd3e22b3fb60253d5fa8d871ee8cbabb84deb63574445fdd972d679013a3c38c1bed9e52ce714d07a451d3b62c18202e69ef1617c7c354620c86ab41cf2f66e4911713ec6a4dfce0a55decea59a4e3a05c3ef34538515cccad18041073e1815f7f06471164837c7f4ee5b89834190ef836cf5a0d4f61bb56e3c32c8d5e95ff93220cbd2b6f61060ba004c918a7b2d82985861985befbe35d0b9f89f81801f62e1edd330d868eaf70972398006443a799725d2f0e67b7ffeafb0d0114554efe6c4497d2a62075e564381d63531ca4f6e20f7eeb5d9cd9b4ac307f473d68c681bb69c795608a75fac662142821172ebd89b88d07096822cc2adee471ea384f760a7fcf96858c4a405912b5ea6880385005596a98e13b23b267206c80917f11727364259322505d7dffd55c8a2997dfef9200c72add935e78e9e8c42322bd86b1fe349505a110d958ef6a876d20cf02748a415869331b8650042406044c496c29ff86ca48e1524f592e1ee6e62b8714a0bdf74327fe56161ee19e4a302f325798319a74da28a24e2f14a9211d08de0dc724f579ba0ccad45ac3d7b264ae4bcab177d2430f855ffedfdae26534365dcc79b1750258dfeb883f0af1d7d8c3d7740dfc7ebdf8287c90334cd341c9767aa811d17a2d9cb43bad3ef03e50fcd7d8915a32d7757d851ef6cd3360330770aa7ee03733e9806b5523e115afe4537ed969632be586900778f4ac632365cefaf3602248c0b9225e55ee21dfa288e5da1ef34406c15d76a0ce9f582b5e538750522586f3ae7976a5f4d210c1a62c026045328d20f65e595c6bb7c2667e5a0e6df2a7f89da14657041167e611b5d25577112f8e29099a918b04c106b348026a0bcd9bcf6ba91eee088a6d1b5d48ec5044844cbcee60abc288c232a002b8e9e5bfcf56435917a472c91fc9706fdf1e8efa02695ff91b8d5011681bdf55345a8754d06f387827e7ba7363b6860153703aef921df983aa1fecedaafe7a267d54b6bafaf6f3375be337f78f149dbbab9988c0284980bc8b88242320975aa18261919d301e32973c58e6567489a24cfe45fa0fcc3eede8696a4380dc6a221f74c06b853b4fa2bc6d4062229b7f3c54dad19451a1defbdb82721d9a2ce2e807fea414b7fa3efb3fd6b4a594294140af04ff8e1d649d6c4e4d6e7909117b5fa166df5e88bc3e1b62c77248d5e1f10625ed5e270f5e42c7cc51e68b5fb9e5c7a9bec1becdf6b798c55ee775332226d320fcdd59136203edbd4a2c4f81670af7ad54cb87005c4f6d21deb51cc1d3b41d22db6b2160d0a52365a32a64b025a6afdc6239f8d5c281a6e61edda0824ea933f699d9dd7878d9c5557cd687318aac8e860045f93bb575455d2ca6747a25d5a1faa0d4f787c8f4862bfffc66d9b874694ccac8f00edd912623603caa259ae4e2d780c550422ea65832faac82e95b97f186eca831c19017057b64c0e662ebd7d9934648eb65bff303f659a36fc1ab58645f59a547ea7880b4991d93a7e68d2177801ab69aad9f542260494fb67acba1beba0ee93e3138212075c20a46a1f474da64517e2f8e686eef1a82aca5a2bb3ce71a4b02c7220b24c6fe1a3447c0a87e78e95ce5831e0b34ea2236c84e833a9e0b1e241e2b44b1d9c58111ecccbb3a925acdf98daa58a71b67668dc68a47f1d421c99a1588755749cc9b428633bbb7bb2fee9656f8842cad96ed3c778f21f66a5f9a5998dd383955a147a269a5cb7ce02e4e9ff044c9b2e0d919955c91e3244caa6d8e2dc6470ef41c4fecb757bf0b6b0b3cd40d481082fb096f20409fb8eea9fd5b893bb822e6a75e7f69e51fd9ca870b8b8b830cca2eca869cf165b25a22afc052676f667219491c7d90a07aa5473b66bd26498ac0bb74b65f894bdaae48d6eb18fbd9aef3090c8a5f81bb49509b231b26624f6afc3d51965ba26b9f018048db3f53218a0fbcdb50996433b4695d4b366d822c6ef72f1b2d2a1b525e56a40ebc8557c9d3e8b7f4f3c85b47a4f806cc7452b78ffa8dbc36dafd9de793ab8be4b82b422346e4adf5a34b7dab4d99db76449a90aecdcc443782ea831f0e4a5b86ecec3be53eadc85e56c94d1bb11743876ffa656b63a8c582490e0857a2cad605930d0d952abdf8080cf64bd5fa268b587605c1c25e70fae4a83e4e37901551613078f5e8143a41bec6c0f9c0ca15a5829ebf855792514d0e496df1bec24e32c130125267303feeb2e1680c0601f34eea6cbc84e8082e1804d104161e16058874440ad54252ef873c31f965bd4da313ae623b92c69e081d9bd145591d54bec4cdc996a5904d57bcacd4ef8039c418645b5bfc1b1602961c99da04d7715c15104da83e50c1061a5ebcf2a4ac7148b0377b09bbb330b82c978e29095f81a9886c86fca0571e1cb8cbc63935b0e8edc21612c074c238fa135cbe2e235dff0e0600583742edf8c5812c7c0cd41ffc02d8a39b303f819ec6278babc6ed0024876adf5bb30931e55bd4830fe7909dc04ca5a2a9c7c83d20e86454f68c0e8c17c8d73a202a742540401a6f6c021c14a4729263c497dd5f55eaf2f16984deb650f7da68f0b852164d11325b1b39a453f0ca39242b65c7a64f73155ef57928ca602a91d66ad212f70c230b469e993e180d00cde218ef573fb4e0bf3f98335acd046e4504f5028db0c3f68af8f455c385b60db22f3c3971381f5386521ac0a002072c521f09a169462c37db32475326cf2b27cbb21463e514975061f0d4fd7a1e0189b45d527ddb87fd83861f50b0f7047c3317c66b9c09aac5ac737a4db408f0199ab5ad0950a40a989c95f919706a5d8c08dca827254a77bfb399cf4c0876ce8fadb136896386b31e089658c6182a5385db556eaaf5cb333c281d29a6ae88bd22618d8a0570a5b54f33daeb404e64d5d4cc76503ef8ec3f0d05e5e185b1972aebb72794f9f985b278509655d63371317b088adb3e442e4556610956841da5401a1e2ab38618e2d7b831de3bad309b974fc1f600fa03cbac93664763518feb4501929b7bb5bc823931f3925d18e03ae38f5bb400b82a2e03413d06c9c8bacca62b21a85c95b4a0033f9c95e4f8a1d22b43cc759ce4fcb66b6ef3f6c4ec2f1a6c8c68e6c96a2123835cdc4cd3093e1bcd77010149f04aa098ef98b1bc389b3c42c10814e86a41bdc7fc04de9689720cafccbca2cebba5c88c842aef0915b60693691a86a28a7dfc2e8d88be39b86443c434bd9f15bc57392b46a892d8232dda72320a5ffcab839db7a2896e2ba187186e743af5d0dfe8f58fa558d69e6be9feca92fa3a902544802122cf9d939e390c9bb2a5d899f12ee1a60fd31914cf8bd1249d78dc48cc67eadcf6ad58c4a8c937969ecdb611eaf4d1aace72dfb35df398015a9fc018c97b8b40ebc617a9fcb71b58b26fcc0b10963ec025886fd670d24fb246dfe04e606a184f343747699110885064b64652456bafa5dc0936dce106dd78fd9c6e099770065eca5c4e20e96877ac59f1a660f684b4ea81daeaa394ee1a653526b694758de071d15642d4daf3ade88df8e2a4eacd1d9bfbbcc8f1a7b962987ec0b8f65e04fc125ee0b5da86f3a5181134e58e25ee877181c000a08920086eda408e761fbbd79860e6d230a22542674ab5f5ec3e66ee19fed8d5cb8de55cdd826c8cf14302082dd5715660c9f6479cd0df18616179370879c2897230c93b97bce1ca1709f136b0aebec1bac4e2abbee4c22e96c42b656d1e2f7cd6c0cd74433b14f7a15ff246853916f3aa047181c73ea01daf382364a87728d3e90ee6ea5222956b4889c69dc0a10bca6ff720d5fbad48ebcf1cc4756039199f7f00fe40638391f219c7632275301ea130285aab57fd5d6ddaa9e3ed169c71e96415120c3b2054fa517c40508b8d6eddbcc84f76bcedeb1480d763c220f2aea3ff10203d3adbaa991f2d8850d272ad412c8e80b66965e011a58d0c9674cf8eef61e94ba79dbd11d21ee336b1e176947cf5f755e690fc8f41a44fc615ddeaa79c03159e63fd024877edaecc1330e613f5b8e2a6ce5484d600ded959ea37d345c5d1d7ae216ab703786c15bc71b9e6d20f7ebee3e5cea992e98b46afa97713ae838a4fc7abc00cab6d9629e349b4d8618f2b998439754dc839f26c18053ebc2ffad80b8c3caef8e4cabd6fa8923b03b795e86cd0786d679583980ce161de660f2b23847f2be2703a5da234c77e700400df9cea774f22e208ba6fc6dc509f712b6e2f2f71603b89924186196854d720caa3fbdaa9d42eb6bcfc013805e6a1ca9bce556bf218d7e3f245bba6cb628fa73b5d52bcf877440ac104f5a9b5509d280ec916a84ed9f2b44ee2e9babb7e0bb01b8df1882bbc3621c283a189d94cedc9e46c4379dcc7012698821d2da25e18083912bba434c8b9b3c5b0b5efe2a6763e9d40a1d757702e809eda1917da3d6afcd1dbd5fb7c12bff81e21116ba19f75bd08c7004d94d4f0a373b8d6ca44f8b6d2b02c7bea23b5d673ff2a378062edd51cc40b4acf4193c279bb8b0da58090424056054afa94e692e261e26ca43036b5cae24d35889d1c6f17e0afa6b172b89cb8c8e4ada814b0277172b5e19eaa621822e257a62d054ef3c7b858b8c9c0e672a032d601c4877cb4e868a6094f21f56a1e636adfeeb4c36c488b24046836046728971abb5417b0c20419049f5b46a15adc0c1d66967c011dbf376d7a5f1a2cc0d8f1d4865e92271c429e1d0adb7245c137d639c0c3a0abfcfe66cc3a78c379db3bbe4ffe1b9653977317693468b3ee71530e952125cfbdcf60b300c34f3628d034844b8c730b65e12f0b07245096da1fb0708cf6730aab8e28bed1a3b76ef139d3e370ec3add610acad2d603725309a64e02e8aff95196e26fad4483215af22497f4375413777edfa9d40e8b164b4c58beb9d5233549fa8c61675424fa284940c2f941858099285fd755a086b503294fbeebcbeffb45a63f2f744610f9d40b465be1a04c4ed26c020c036708af31dad6712468e2bb8118cfed51cfb1592df22d57bd320c61ab0ef93e72e735c68fde3cc22b67ae1240041f9582ffd64e44dd36259004ddb4db1b7c94b1a253003c5df56d7140263be04fe0b63c92bb88d6ef6d38583dd8f5074df6861cb2b909b7ad482c74b19d3db22945d6edff62b64f12998b09b0fc7b4f145e479be37f61704d0edd5ad7411ab8b54f2c1bf1f01f13d2df57e4bf7c6abf1afc1b7f8bb1721d9ef104fc0917bef814cbadd9f5317933995349c36adcbcdee45bbbb9a67a97b7019f73aaa6a78e3ed2aa62212a9e791ce4551b0c43e845208597f5fa31e9d21e1f97ca656562879c48e309da4d59b8219eeb04a4690e122d2f325286dad6ff88ec5afe7346daefe4c7381e9beb5e7f2153329a97c35a1fd2036e8e97a96700c3cfc37e2f4f24385b92975b25f336617dbc7deca96640d4a7555d9c7043743496589a2117223656273e14cfdef4c8f81ccb896164e0dd750686bfcc82613598cf31d62e69ae22c30c7212f4d9db92726ad816fb62a34960c96444515ca5641a793bf871757664338f1648ab0741ea30cb7475b168c5e7d1fc964fc8c6225f42149581637ee38c247be78008a1a1764579b0101d1f0eaa82285f6ec1a28e33d840b74684416ec3064c7fbfa197dcacf77c87c5a7a88adf9999432001131726156f4754e61388a688a8fe1ad605c6c134ff0992d777d203c91e63ca3507046d1b0ea2c23575304fe8c3d28bffecf5aef1a058e1bd8d1ff228e9a5703955e5a339c662d32eadf8a66612af54fa3c1c4ca08318a28791b226b375a6aea7183ce595928c84a93b926ff5fd5d8766b68a9b639af04919b234c9d18e05ef6e0b4b6840ee659adb8685e978c60c8844f406957d6e7c6a5c2f8c02e1852fe2ea3d698a3d88b19b8a0a08fc889516a82269fc300b96c081bfa622c4a49f24a7603d6fe18cef477888871dc4d178a656abdb2f549ce74a160223a62ce3e66a90d1847d64727236842dc2d1bc34f76f88f38b0435bea8675474aaec7bcb5cf278dbaa23624fb5b54a93fefbb8a21330566fe370d1ac2c008463d95a62bdcf892c039305783f2dd7b14aa463ec26125e7acbdf36434f5f2539e11e72e1945412b6da4fb2204b0b71f8a1458caf30dc6aed6c621095e7b51d755e4e401525045b826a7950aa1201d4b342eac97bbaea19feee9cbce5480deefd70ac99970e5f69e0e2ec7c91abfae35eef13a6078885751e63a2cad04fa5814c8754819ad751c94537e375b7968eeb206398163de26a95297497097847f6fddd47fb5bd439f1a0a995d3af2f8d88b10fe90d2506cc29ac9c3b5e2de0b51f0bf8a200dfc0e1c0f7eb406e70e10a2fb0dfabbe4844b9b844657b14508c38657dc52bc4771cec9869a835be7e473a6e9dda0f42e41e7a93c9a4c7da6f318a2edcb3fb3c2d949645ec70c9b11cacc4a99f1f28ab7de49a18169a97c48c8e27c86d2dded74f32cfe27ee429d1dafa6ebaea9d6246cf5afdf73ecbe756e05b774ea049067f383d629a756bedee9a0521db7ad56d9d4193e6c33021c3f984e763974f5436547e83c5dafd01fee7153f29f008ae871e9dcf4b63f9ebabcd5ce29eebad93588115571f4a7e70c67793e5cf085c829af10df2c13f50d7560cd7431c9d406f36d3687a549dba79ae7d369d819d3ffd9ae6afaf4818f9a96f8916667e3929678a250a0a57225908c48d7390710cbf4412becccdf0719f65aabf0678d39ba8019d168077f6b44c317574bce975935900dd6b93a4ca86e1837634f56b4a16a351db86e28e470010d76cb951300e76a6a1f8a03c664dba9ab66340747a213051826095a2b433c0ba82e0579a6aba242d683a7dfde3934d1523165b54be7418185ff4f537b327f9af0c9f79fe4b851ed17bc31c6bae46578e397fa4df1cb7563bd4e284ece9ee3053e25b7e2785e6486b1215c0ae91300be75b29d3c7b71da02ed8bb837f71c7ca73ec64d239f570964c379fac91f93f505b4accb3c4d283bf01b00581a6e47e4d71801e3766cd80ad1d44c3a91e965ce3c32c40eb9b0ffa60e4e5858884d2b61b1db77205b0e18d7a0cb006644a7c9af4d9fc0bfe198251ceabbb58defca8954d2fbf38be77edb68fa13e632d9c1fadf4dc89f512e8ce7a594124d1d758337bf7832f32c96b5b7d5c290d4fe8bbb76822fd57183b9c7afc059158f48969a60320e7a2db86748d171f676d0068852bec2693128dde10fc3d1d97ac58b5e70681ed7bea398cc289d679afe46461dcb539618e06876a383fcdb65b904fb0e3fcbe5ceccc60d1cc633a22fa7fe67d18f35e0a0cc8d0170b3c571a10626c0d81ad6915a19deb99a3af757303c657b446c0dd03a98bc2286a667ddc9e26b5c1937923988064adc028eb133cacb3bafd642ba206f03fd6a00b2c6bc1f8db9399db64c75e6b115231e23a0d715acdab97e3c78d08f91a67cbb836874a73fe17a3070c83e376109dc82e89b7bc22d7b6cf47a585279e130b5ffbefcb8b62084a5787e44b5bb616d0077a0afcff16073feea4c1afb4213ec1d19f9b5a8d33b932c4c80e9a20bb3bd35e2cf8adfcbec255c70652db482b3d3354a1d7216707061b44c563019151440a81a270fa715f062f87feb37b73349ae68b20c77801ef0b66767fcdcbb9b5eb7e21073ff953ddc105d9b8c4407cb3fd2784c6151b3827b316bee63ff1abbcf2ca2da08c930b7a8a3bcc82e314ae683d140107d02daf7ef521cda146f2bdfea7cad80a7174b70e8ae2be42dcb2730bfc7ea1a3ee57ebffa837c4cb89ee4b9bb48aaa18c82861b860b0709f823311caf2c84f5510828defa628e9c2eb14ced936a41c984f840b5605e6ecea3a52abd2c68d8344e21e9efd8e5dd61859d7551846b963bec33a1621f73bb46595fd838db1e0fb6b3acf4eb58de63b30663f3136481977e40c6aff45e4b9ba30dcfd094111bf062529140ef68044618dea60623ac90c7b3369e52f8a5e988df1ab0e25920f0ef69fb14c95b87fc460bf91ea7c599f9bb10aaea22bc6ae7b9b531e398326a970a217e6e5c0734dee359e37c1f5914fa6f170a7e5b32ac2d3a5ea7aeeda6f7e9e692ac3f0d69e4a1395f7af22a36ce612c89cf8d3965e42ec5ab90c55c1472e7595470900ad8485285c1248863de15daf180aee9b8f15ad756f8c3f2f880987133ad5ae98ce156ccf4ed8a0a20f72779d8c2c36948ac7249b316bec3da2731919bb51535273307bb3acc9dda55031d84cdf47ece486b4d533af8866f6695b8842e5c6faceb0cb983ef3d98009d9f2325de8099957194572b7118b9ce3f1bb67e5cbd56a49adbac398bf2fdef3bf88c9bc8078f30dc4a7ae404987c2c2487f4b9de232cdd0cbe1b1c2fcef1bca12d404fd72f62bf387b23b4dd1e8ccb33fb593f1d9a6e1076f3d3251afcd2404fd7bafe361d905314c9d1d4dfd7172370ca86c52d4e119741fb2c92626b30301020ef761d7ccfd2d140b88ac77e60022a11c70d9760e2b06cb46de0114f62a5495a172c5d7f74a2bff05785af4110c750035687a8bab3981609987db2b2a1495f23fd9908c25f1b5cfa2858584d45f5c1b7a35a6473f43c4da6ef40d6bb5140e7c2add38a5dae0878a09e0eecf6862be222808402e722cfe6cae679608caa38a245b7f2974d8fe2f233e5a2d53a132da2307c0ab1ac55dea78734d7c154916ae971deb03445557b0762aea687ec4d0fdda92e8a9120aea43a705711c20bffdee2eda758635bc74873a87a701b7b200d75976ce19771883ba8b96c21575698997e87fa3b4c873d5461fc73db90a708045ed677c324be9ce68b0f9a9124d6cac79f541c4b61a0bd143b0b4d9c6bceba3a998d9f6ce2808b6eb0c5aac81096c1f5b0bf05098b833e33850403b944bb6d02248201a5243b6e678d4d0b3c85dfa5efa43114e9b12a258d1e0ea0cd114119afaeb0a6fcfbb51f5c07ddc6cbda8df226110b99fca5e814eaf93d03fb5744734e34ff5003487bb70e55a4d53feb716346d231fd0d7034f70ba12f63dc7a84ec23e379c1a6574ade54564790b07759a972b144c66d35c2fd4008eb540878a3f72665ebe6a3ea77d6e6280dd8acc3ecb0c2ee1b309c6b5927b8a93f03916945f38359e7d03315316d907ed634798cdce7f9992995a40297ef51042d2c307052fd853c2ae671d9f895bd20c85ad31e534f8906ba807bec45b124fda4faf80c2561730f1d38cc8f137d18ffb3a3ca940dd44fd7c4a73569ad32d061d5a9de1c2b0bf9fa6d9983bbc87fca0e240a2a6074a1e818184fd774748597b0e7692b0555ae28b7b7f2ba025b18a8e29b85695d807626d1edba5c24e8d738d63b510e0a78fe3a1818b69eff991974d53c8fe7b9ef2fd69b865955d575d4ece2dec266bead597509405a8cb6701ecd110460e2a153b68b7b69208e0405a72e523917480e4c847cd4274705904d081a1457b663aac368b3e96de3224d6584a2776e125335e634c625d4e0a483a99951d6c7b3f6c141c180412c9bb3dee860a724564182f1622983b1d593e0c434040e32d3f6d3a1b4543a570ed91703e29b068b789e2d0ec71ce14489a77d657f8b60a7dbc25dbd039e2a114817a0b72a7685c046577261af042fdc4a6db6fbfdfdf77e28a12442cb52413df5f46b2e1216692691b2350ebe7041670a38062f8ed76a7fcc1c3e9eafdbc7790c6f67e215da5e80a71ab5fe72ff2797add5946167291ef52de5572270bf50e8e857772cc45ef16b991b8fa855db0ee1ba66c58be0770dcc3b1cdd1cbde6a6e8a4adbb8e166e39fd89bb48d5aaed0a7ac7a5803384fcce57101e07e65c4bef83a69c49692d278de82ec4b7e32e0ae3b4c287cab5e6cc88e35fa74186a659df0f7043351f419195816da15b09c95b8318f20e7bbc01f0ee8af73dcf7f06875499a8b2530fb5f35fffbb01447677a5e1a5da0d0b1ea5c310f4a39440b36d02396c760140c29ae14fc16b55248597e33f495718369364d7f71665c7a9365eaafc06945204d6019f8278d3595203ff81f3d326ca8a976dcb9a13ec6855ce47a82d43ae3697a4cdef48b4172178ad823ed59f290ef5a43a9323805e3367e5746ebc87821e1c17900e0cb99f3e1601c9773cee136a424cbc2c429ce8363e5b46d182c27db13e851d66bb5df045c934121448a71d37e1470605ae269e7ad1ca4ff44a1798035fb3b3aea3f582138fac5169166c0b3aa14d2bc32047b5901abda45b33579893e38592759ce2ed84e4391d4abceefd691ed4674028620dba040e48850525db446036ec0e3e29e4ce78f1fcd5d19fbc4aaf3b3c4d573318feca014388b655ced2fde1e747d1f6f88b19eba8b95a15a0bdce39b0b8ba634971bc23acb81a63f0376b63df4a7667fe6bb01dab6d08381a6a4ae0ade6dc5413a1ec65fb2be8f5691817dbf987ea482374ed3f9c28f54066144644e9c76b4fe984f840d35ca113261c9585560b1f1ce31544039b700eea01df68f8cef6fed78d09bc61c83cbb1f392717b18a6430ec07180cf29364972c8f293df30c528dc7644fe5713a9a975e88a254ae71193e17b4a23a33f04d52e5aa8cdfdaaf186a1b8168921598c5125599cf50a66b5c6df26c8c7c7edbb6d1d72ab1599661abfe2abcd74beb3472177db9e9603c48ecc29ba17d064cb0c70a99a50b51d8e2fb72df53dd2ee149fead9c8c879fd3a68d7d8c6f5521ec6ed41e9da2188e18f699d60bcc244fb5238d59d550c74556b1c40188b4c55c342bf8d09c0cbcba24107dc36d65ce9a1b793b00d9f69e08e5b9df9568dc548eea4f2310bed16d1a7f7a85407b9b2834ba58f457922d82bdd014d3ae74e450fd9cd5b83d912df22a97ad0b24b6b5a4e656f7a5c7129bf4c647f168dd06be05f78b22d13bb8953e8d738c811d6068368a83e205582335cd971097af69476d124ba181ed0f842b583b21969ed63621b50364a78e51a7f02a4d929fa72a30553a8e74513c9a8e233839529f5801d4756c5bbe0cda5949b62694fce35dfb2f351c411750f960fa7245c66442a6ad2fc44fb3c4f9223056cbac7fbb4b859fe47c4b70e0c08f2ce5d37c7c2b48150fa84085a4f74c5b4a3dd7379d9891bdbf878640f3a1763443dfc4342d3fe3c9f2d4b755902f275a928a89e7cf14cb12ba36d62a77012d935d36b4b1834e1c6c740ad401950e4102c847c0b3e480b5e4040f8bcf94e08c3653ccc26f5d22460bc147d83a1cbbb1d4532fe6f775cd5bace754743b05d1ff4804e21930336d03db3c5fdd5d16990472537061a86760ebb5b6c2ac8a3998ee80892921965652cd265f117f18b9242bd7affc3461dc54fe1ee7ad9c03fa71b3da5dd84351f2656c9c8f931de90665bf4c3f26ead6d7a1d10987a7745655997ddba696ddc239338dc06d7bf8b2457391196961ee9670459e8907416b95419e9278602be5114d88d88ba74b1eda9ce81cbc9cfb1bd7d4567d97c2034a3d2c8090cf5d5ed967ed32ac1982b52294c654836a3ebc78ecc2d17cee0ef48e7338f352ad3686efc271c450411632b73fb589c56c0e039f79cf39e28725ddf6f0592fbf50a7f91950ff0d2bb65272f211624ccb3b874b34a84916d88b2e32ceb7d600fa7fc9c985955d5b0f6a6578b76730348883cebb382d83f7283f93ae2735d2f91d7bcbf9091925830e2c717d37ce97e9d0e829eadc1c85eb92518182957a8580a534222098a0db3442cfdc731ba5d1ebc62e255c2fb6001e6179371dd88b246e2edc4777dcd7cf4170aeb6de7cfb3760a50e9284d3363adbbe2c7d762bf253ca1363e121e60c667d9014a8a49913fe14c81156320d8504a097fef01f7d6c9acbbadaa0a39c4bbe064421fee6716a45f0b5d4ba2aaefa826c752bcc531c69f124369849e43d71fbdf29fccc24c9a75622d972167ea914e0c7c80ad27d13052114097b45f23dd6442c6fb9511800bdbe2a1fc445ac415b2a67326029af4e8c8cad9624058bf91d2806c99712ce0f2bfd4c2ec6cc1a8e17b27e09733476d3d70192f28843953ef9a3cd5283691506d4df3baabbff3f5659ecc175e73f4cb62879d9aec94604279ed33c7c0d5eaf990815c9f0d1b479e1aa0203d63ad328c8963d1fcb3d0449cbda42838de4aec024217a387725b327440b16e057b900640e273994e5e00453409557ff13b1c0e32063890a7a05e4a2b79841420be665bee179468e335789714c8f529e4af3d68290a4151b6e807d8f11a4028d332df35855fa8c50f7b675ad984732504ff9a2aa299728ff7aa48e6bf415a39d6420d0f3466d930a81acda5f9678633bd5870dccfac6bfc2321fd63f571ea6e822c6edc803ad20db2929c5f8948cccc60eca38d4ece8b2c092e0b35f537ba92ea1d752dcc811b0e318d3dd1ef7f707b02c941095e9dc60aa4f5a940a7e2426e2a69495d4a77d1a38c6653243444633114d22794ec7764b3574029bf5062d92d6b0609cc9124054e0aea6ee015967e0f3156afc5f13f4ca27b653d602eb5b688855024cb683255e0610ac1a4b304c9d7d14cf963d0869c8c53acca64487eff6f13864551d87d16597f244c3ae31753475f27ec9e5cd5d94242cce13e73ab0fe206cecb7195682696e3ea7ec673184ef08edd4655933c279ece905fefd5cec7888b2b1032611ffd81ef37f447d525cddc987b4412561c1346ae2dd254cd1b2f5b29d4b89df33a13d56d6c5d6f5beed2e80fea9ce6b7fe80ebc5983697671895612615f3d16a3353b1112d4480b7eb96b0c7556fd0492ba206c212db0de79a52d1ac1374fe4e49913be3ed02fda46043027ed96a8aee43ad42a491b679ab431509623be3eec5eccb5c9b8b95e098500d66fe0375311b2ddcd432b19948ea67023f56a5583ecb0f0ccfe50ed05c84645b0c10317366bbd4572505932ba59ab9ca00339cc448a77f4e4a133ce5dea39071ba92c44683898d0c4fbcd91a5805b4497e20ac4763c95903a5c2b72c2551d6abba79ce1199cd538d070f3cc0cd3e2ac785d3cb68ba26d7a3f6b1d7d8d516055954861e10859ddb1e842aadc690a0f95346a3297e01d5ae7dd1e900ecf0bbf815332872e7f3a39a53e357218370fe69baacebff31c70864adc4c31c9addf27bdcb57eabe002871017ae15ac93294d64aa442d8934f4af122d42584b40410311f76e25127107487a554d5102e33934e188f3c36172afa388d851d07f24cfa5164e54ccf2abcb9a55a5865ecd646ba179409dca1195f7505f5acfd4fc1cd57d5b6e029e8842f1c3373f9cb5616fab6a5ec3fda663e4505aaefe3c9c37cefa806e75c4c61cec6abfd8c6118a810d2eb0c2d69ffb0924f6b7821a60f6809623a4ca03621078467eede77d6dd6959abde7698b5e0da98b8069fcf2de87d610a889cb5f529c56a01dbcfa8aab89cdf7357271b3856fdd230970a9d50d56c2a212aafbfacb1fc75add932070c1a93aeeed3de41814e1014bd9423a1110308f4910e02398058e36802970774d879068fe1d91f92a700f249cd8132954896329924b581bcb254e9eb3b66a9ec62e039315513c3f0f01d04f3c16fc13314bea8c07bb0fc4bd24018141539e0e9b86e40c0ccf0925adfa56d765abdf71dae923a718dffcf4d6d5a03933c0b630582b9dd4842c883069db4b6f6c0bbed82c63a999bbc6daf42d2809e2f64bb1aab1ce31497774e090260b82c335cb75a8a6b060be9e9be1367de6324c7ddb83c3b0045638814186e58094d9f36de5f1405de02ecfb85cf377d1fe7fb8310486cbf1d0bbd5190ba3fc91c920e94d1fe6ca75cc2624097622ad67298cefd125dcf71623596d52b9b1c1a36fcfa2ed2d88d075d8e7410f8c434c4574323d407cfcb7f1f92f7166a9b9ffc39f926471533732e4cde6c804c34c7716c6944de9264ebc8b83b8112b4c830934b150dd39b180616711697acf0e60ef853720b68ce3beb6f7b71dc49593ed9955a2e8941d20bc4e042b7f6124aea3e279df44d697008d710f22378532469f96fde5ffb60c204cac6174e086125e4a079c072fb24778f6b36790b3d4caecdbf559d46375458d2de7160fe8c3585ec5a66a41afba6136f16cd675066b01fad8b8b0809394eba003186b7a3bfc22e7f185681641c109f6744f762ee5be0311a40ec9f74e5fc2de7ff4b3f70f8ed92b4053b26d6d8109403f998d0a7881404cb50bbb34f923b6f00b3d6fdd403fc088890ef282a1d2376766d07447fd828b3594c3133e60a8f602d5b0bb406feae5cd4c8b01562011087b6fe58e91652acde9226ed515ab900e302fc3249a39898127054e573c64d84c7911f9e7c6f94b036e612bc61e5476ff476da7982c1d7c241fa03010ed5baa1b9023d66d6124f8c5a964616ab5b632bef4e55dae38ca029dc2a143f0635663ffa9820c7642050a5ec9291119b718b44be7a175c78bb8cc294bb1fe43edc0b5b32a4dd784a1b0b96b4ac7992bb3f388475b90238e8a29f506116e737ff33c05b6bde5e678117cf8c9b164084e2263af17ee07e9758d8ba5096ef66bd006c40ae87bc011b67a89727a516dc5333f00dd33a1b6c18c1e51a93ac6bf893daacf5c87133901e32df046ab4b5923d930217897b9ba013a10569d6684d471df354e3fb949bd267cc37f9d5081ad6901ca64ad55c8d1c367606390894126943982846e17bcf61846e04966523e9df9af86cd19a065dab1405162e82b37e57ee44139598f0819062affe62710201866f76a82bc74b5b2746fc04220dda26b28a9dd29a2d1d867f3552403522ee824a6d22ee9e6ce3db808cae4ac229154e4c69bff1685e04503c90547b9b5e5ed479cb679df37ff3a40d97e3fcbd8a0a6972fedc3479c6bedd09f4f29285dcdad7e93e715e31e59f167db3fa8c49aadfb35c00c03af50ab1d0cafabbf0864c3c8cea9852383428ec9a4f67ba4fe83e27af76365720cf5a1d06c3c1a3db3b99c6d9e3436650dff01768b8ab50a706a209ac0958d33fd3716b6fd7d65fbe1950a9f0a6d217a9af4522d1fb787ad14dcee140fa909fdb70c42ca2f3e240a027003455e1c18218be21a5484814b3980ea20622c9fe56a186de917f3981942644d10f24535a1075a9b21557a95c38b347339d52665a56a1fdab9a351d991a19f5b789a10b4a59c4426f70f193c7dc361780575f52a004173b559ad2f8c25ff61d538f128c14905c5658457358f9461311bd01437c6d2803de2d07630378ed868aa29ac03f7c0531fb2ed4a668d45118dd5435bdd6a7a9900054f3810be0a9d7af1b4dc7b5799ef80e56c85a0970fd24159641b9447b41419b8dbff3aafb14a6379a37afa7e4e3ebbd62fd96a39a1b66aa12b3378f46a553cb620fb8cbdc9dbf56a25e00a8da69e6ed416725bc045fd03e3983661ebe04f30a00e7f67368ba5d945181ba6dcb72118d31e2774c9b6dfa8ab1d6ced7a727b7a8971e7b14c6c0a9506611c35c9584521b35fc86ff77f57a2318d66cbb11713b022544d509e9a03f9f7bd3fe13cd0b583dcef14163f15debb191d75fd4b03fc5a0aa72588d8cf790d61c909ef65bda52c799b32a4be4ee2ec3dec3895d0756553e3176a0b83249d21af431ac0abe911aafb8fe6ad8d19931f83f5cf86671c65a03cf5a8981227a8c10b5d4a7e5132c46aeab734c7eeb59ee7a3b597dcbcacd126950b26793f7a1cdfbd190fb1aee3cd0d8fb652e9514125cec341fa077e1437743c0110790055ca96586225339a14060fd858ddf16998c49af1defce935e1b7dea83fa0a55067fee0d7bd3f0ee6a818a5434cb2ce3e052d0048197b5619ec6bca961fb0156cc2ac2b3ed1962ee2587f31f2aa61a471cdf8ee3f46b106d904e5decfbd935a99566165686eef4c2e891f633ad5aef8c1b02719eeafd778ae9e93d3b8efe5436597d86fd10ddab9e0a3c1d683d3de1459451bd1630e9ca844c75687e44253feb046c7b0f26c62306df793ca87e7ac5fb808751d7297369ebc32a92a724f3e508a459b422a2561276f990efa525749b39028584d12c4c1cb68dd3c8e59e54db9db44a398d5fda5fa5418f2bafdd37815ea360cf1e203571ee1372d0c38de052dfdd0700a7419c59ca4ee74bf77e715bbbcf44ad5c2654702c3e29ae1b18e759822efcd564f0af433798c9aeb3f4d5d04fbc265e4083e9f5736b4c26e3709745be69ada73e6a95a78c2f91248b891bef9015dcc442ca754124df5184770946d0da203af6fd7ae766d004ce1a909c8c9aa6f826f9a276513f69060346ea71c36ce52d6056a89faf7cfcd785890f022a073488a901376413b70e1ad120f2c1ca5bf6ce7159f16ddc3090d0caaee3fa59188a3a7c53b4916ab443edc280fb3419808efb8c87e2d4d4825f4a4bc1b12c63f4e2e4d435fa4c1d643687233951da94589efcd6bcb1560e4a6f3c3a943f646f79ef498309937692e8557b50fe1526e29fc4a502718c6b4af7e628630fd8487a42994f23c77cbc7d136c3e04ea5c6dc503d150e0b7f4b56a6d36c7bba3b8ee2d38ab9a0335f039882d404a1cb694ee80a542d4dffdecbacbdd38f87eee5a3ed15c6c56e0539380f79c9ec61f2d4b3cb282462652ea5351f10cd7035b1471138d88f1f627ea7ac83c0b5a8be4742453ac16096ae8c812e8757351030cc03cf205f0043e7fad300550077bf66c46904d26a436200dacd351f50413b8f95bc17e27aa484eabf0cdcf84ac91b5e21b0587eeff098ca0156e480823bd486dfd6c48516744126ee29dda4be257ea19171e0671752a6aa75cac944e78f29ab44040f450674057082975a8e4b2165868a21dc0859a8d86730d6f6f0f48d9e8cd1cea86886006da5443169e2739ba7fc12440141cb397c0328ab7d00b7a1d3998faec2681b696e25373485b9b1cee9924b7269e2ecd1b9291bb144fd02d5f2d23891eecb5bee8783981cb6c2574f7186ac531102cdbac90a30755ff5fe39612f19aca7b238c8ece05829e3473bf5cebc221aaf9498fafdb93592453d90298526bbc5166a97a4bf4f92b3c9a1098974c445da255a8ee16f9b3be66915f8cd479314da4659b62bb269bbc7470dae7ed90c7b9b7229a5f79973e8bc9b21436276e943a98347b114b0d24cf84dd800a4f4bd60d30e804737c255d0a414156eecb96eda18b4243ae516bc163808866b58a2a9cc471ba66e18e9672ca8565892a418fe2c801aaa0ea54f767812181f64c7ba4c35f2443cd4d35a028f33efbab1250d22db975754ac5d3fc78a634c135ebbd05b10d2ed7fa5279c1e1b262730df6bc42c13131ce443cefb4f4e7fbc5233295e1b7c269f7b5c2522c6553a90875e0e6b68489d3d82299db44db53d21415867e59edf916be6c06285e3d4523e4dc8d5f1b4fc23adb89ed5b354d44ab6bbab7ef0e5719cc411a39b3ad5d126604fb4b7d4534ac252fefca7ee2ff0a3aacbcac9c812105d589de941ebf53c7d6173f0af02c4ff3285146c443a2fdb802f83b1761638344cf1ed594dd4916ab16abcda56d2d31f93ba5f62587ae3015e2fede9aecac42a6bb1a77217ccb22f39abd1d525cb90382ab175136b0b8dcc2ee80988d8c573a5121cd3b54b8127f0bbb1ddbe736a9309d73eecfd0e5ec325ad02a112afeb9e210cdb129257348f998714afa36b59b31816e50e2547214de62a5a4ed8683fe5fbe9da2248e1b9abb7597e3fd7e2a7ff0f45f983da71910394e45ddbc586b0d3ba8f7402ed7cc20804502883b2b813e742bb8e15c1a57928e3f8f5e448bd8a81f8deef11075b9a9179b861f76848b44e06f8ac2ad7cb6fe7988ef2c81e855ea6000e11b42e510fcfc49abdd05202adaea31bb8018ae1c66eb06f6de767f87625cc4a4531a8b4cddac6929ebfb06bca15353feacb72d1c45a471c904e10d0a44bb0b03895192df1f53501e7453f849ea41ccb9491a7e229103d5f9a7d7c52527976ce81e98a04cee6231f9f35d46c7a95be24fc9909a17955bb2f97795c796f422b458d2335529513ad6a6fd4d6d576d607f0fb9f56e5c6e61f0dddd772b3ec3f01149614d88fb011adac3be5a2916627ed2bc1d17e5010b684fad7768e8030a16de983057c27a3fa06cb459b4c6482c6c49fcd25916fff43d75b2248d18fe452e1b701072f0429e9b5fdf994926b6b1168b9591a95e62ee9c20e05441538c0536549891e457b306d22ac2ba0b6f813f4adfe41f349aa35838c449228a20782f5d79f5c7a0d7a2c482ad1af97e814844eed2bab03ff1afb3970481af11e34f98d1dc6110575b74d98789bc15c4f9c94819622664928560f99e1633af25bdfbc74809841ff28799152fc93c394970bbfaaa32576092ca2d21492652b66e0fcb64e8beacbcb57849574b53bbf0232631e7e73410fa8b67d4402efaaab133c4271267a54a6052a3c01b3bd841ec8b7d69a752d7b7c76b6b77362122fdb275d12e97183187e06451c5ea7bb2c76453e9905c16bf476cc47292fc2d7b3c668e40eab7ab203f452640647346ba5547f480013fc22cbcbebd1d55f47922f71370605065a9ff306e0bba4fbb788284ba8bf1ee5efd1f77cc62f47dc6d1e49254ea69a3efa5f84783c650e9ac58d40d3d23995f488f266443b8a24239e1c6b9626a9278f0c5f56c9f49dcee758e53b6b3f2490d4580f7530b3c50067479c0f35e6d0c92a3128f48f0bcf2e45f35983215ea7efc033fa599473dedab8092579607cfbfbf79f49046ab791cb8d3b6744542bc08ce023141e17e464a44a31edf2ccabef014c47268c949e9baecf836339feff62cebaaa9ccf2bb5fc964a507bc5054b8993855a9c8b64f6c06d38a3c47aa2e8506cc1e4f09b349da6f6b88669007d7f82df159ce479b3b844846b898eb0f0aadc6ba8d729a251cb04d8fd1f5bc4406e6d9cd78865b32ff243a1d9f92dc7a0e05c8fcaef49daa6e901ff3eb4f5e1198dd627821e0cc12886feec7bb1b3ab502cc84f68a4eaf5fcbfe9e015fe311fe634ac2b1ad372543369f6894906e901b76fe5f1f3726577dae8397bb0dd02ddcfdb131e41b245f6b371fea01339552972dbccac7b1d61757be058de2bf4751ffa27940eb002217fbbc5ab5d7940f55cbe9dddd2a4a42625498af4191d166dc362f38b961f00f40fc94af27a18e37a988eaaa0bb14d14567ef08b1a3f04b36d0179f02ea8eab3adc9a14377ffd73e43825462d8a2612b6c77579c9f0c394ba35c92d4aabc7462557bc7c3160cae8977681cab7115f9ed5965aedd8479304630251f2484728b1972a765271646b211bae1e9e1c17da81aa8880632e7eac67d5ce14100bae8b4de03b6a884af65c2f0b54e68d479f1cbdb21dc162a3ee879c52eede91b32bb5b742b42f2d3b44b3d221726ae7cf9a9923d17a0e10de8f8223b347f099d26b71cecf314b1d420361c06e5abdb8f73657f99d6bb1a87136bd494590a79080cd483e1fed6b247dadcab6ccf0c5719f4a14bfa557abe9910191685e2804e96239b8cbf6e6456df4a1e690339ce97b51609ee12b0887e8e17ed4611bfdb236b2c96f009bcc7df7c6fb7ba1d7cb62b420ded928585bdcce91b1a83c91e909cd473e5b5bde30361db2889beb83ad253044a25a71de32395d5a91c7f276c2e931a4774c8bf9912cb445dba707a0159dc918edfb01177b5f1ae6a1d62b3f09cdf8f4d295d9790909c5bd242087f0c27c38b02703734d370325bce1f0a57a7d414cc84c9c5ede5227bc0d69371242eb8a27e9d6612ab697151ce16ed76ddf140f38c7de67bb304f10a17a06a9947af41d22e9fdcd57521411d3154954f340cb397d7a948ef233d30ff3837f1241ffd5fcfba29a5e1fd34472d376bd273e4540a1f1f7d1b24db86780b8fea7763ddea7b9fa77571eddd5f5beca85bc3542a4da61d4daf819c09e6797fe98410998639e627edf75eb4e416bd1bf40b4211eb0f9c8e2e2d404dcb89d8062c673356051aafd105b0770966423df87d06d62dc248e1350f2e814b0d60af21782d1a21f9ea1272479e080ea87e0939a2c4095593d3d4c829bd885dcf3d95ff2ee53510817fd2ab980d23ef5bcfcea3fe1bd7529b816b1a85948793d08d8f6b417939983cf7f3b87b5708d7bbaf724c98515fc573a32d41bda64fa8f8c5164078b9dae6e9046df9c310558791111ab7ba21c643d9be9f4e325ddf579e62fab103a94a31160bd95e83499b376bba58ee4641bef5cac078d360b7baf22bd7c4d1d2b64e801c492b68a15ca6d83b442a20c324ff14819668adbc9bdd0a87d395637fae2fa569f0ed3c786a8f001a935d1a654eb408fc4361a19e1d5ca377cbc320e1649a3cb43acb8696a9f0759eca66c28d76135fda715aff35ef03cfea4650dc4aa2bd24b0f42e279a2ffe59f8eebe8770d76b76bbd99d0c6c6ad35d4ca8047eac7c6686d345eb5aeed97dfa866270b582c7d2c5aa8090ffa3457594402eae16e032c873e845874b2b55a73320fcdfdce341bd02221cc5f87fe77cb6af61864e3ee793d5e0a66f057042ef641be3260891e2b0c3209102096edf87d9e5fe329082fef3b53dd6c83928be4c2f6c22494d6e2e438752d686ba286b11606a0237d1f945e5bd9a3117e7fc276b947a3933dbf1dc19438f4ac2e2958118b3e7be390b4b8a7ff8c23e58b28aa6aa9c01cc09cbaa74dbec84629b985944a9deff4908582900fea2a3e23c83ae751725fd8d59309ad0603554817e1fb98254b70e5debae5e6805261ddb5b596dae98398e8d0822a97c902d86d08645522ce41df5d570d07be9ce8dcdb15a6ab927aab0a0db02d4cb15111d39110b4db28ba4ff5a10babc4ac4bec558cc25207d72f597eeac3eb52a40a671eadbe3704d26fdf9dcdcfa51f20b1f965b02d508395b22e8823244f670be95d9444eff060d4279f923667a097a8cfbe7d4492abbdaa0b58fde76697c1455750277d8f5a0328c9c3d9aef71b20ca0017f386e801b2ce98d950ae8ce7af4b8716d70a0bd06ce5c878824e49b2b1b3f884af7ed7e525f3e381b7efb42eaf34bb750a38ebaf6a5ee14d1a3728d3c6c7d179c7fb70a9aed1ecce00d5c8d232eacc15b762efdaf5eac619fe07ec91ea2b78da050638bda4341ae9ef7bb958dc16c67f910f591b0904f56354a7fcb6c78d8584ff6c1333d28422cc1c4ceb49009062d0de4441e08b75449d2da58892710507feb8361fd500106cd64ab3d48f7ad880f913884c0d49272e5bdbbee970a63d4f5159f5ad2ff46bdb6f687320fb0619c9d201ab12855ee1b477d46a43f058f30af259e16cc72569da7f02453097b2014c9da9a54efbad9fcef6cc17c6c00bd2693ef1ced996612f0203170c3b8a8ee1b680e485e4e0f7f02089350a83a39974c907b7554f41a072aa84e23ad5e9b997fb5f50df7e34a92ae20c7adc2f7d40548adc1cea44deedabe3072b628ea8693def6e5a78d76c622244ff8e6bc74c61fcc118987139934cfcdd8472702014498eae99add6c94561b5c44a64431b17a6399761a069c6c6eb9ef7b9aede89bad87060eba773e7d7cb68f49ddff3fef5a3a0290dcf984542a48e52ef9acca956256877aa6c006b02dd538dd5d20088388a8abcd2193eeec9912109f38840b83b644a9505c95beced29083838df6f30b6ba7b27b260c8a155c318ab42c60d8a28978ee0b5a627f1f02c0942e835ad7ebe8c22f73aa81c5d8874d34351aaa877264ef0ef291df1552be95b508baa095aae3b40e5fea4a229e6bd5e69b8d00f74efbbda1b60d9f2483b401e112c5c884495cf6b5c3a2d58f27310937bad6fe84425f9e99871019900a91fe692a79caf700f63659aa9c72604e6c11c9c4b834cb74a783ec241e62197dd41b3c8ebc39add9e817f970b1b484243844db3c66e5d5580d24c627db43de4336e8fcc386fab5a74a4bd3400d1ecd0b5034b9204eab20673259940375cb68217e44537aed1236b32d9b311111c7029a42727b3d1efa08232318b8142af33c5db1c597f88b5dce1599b73dbb87ccd613e764422fe9caa8907cff749ba44246f1f668e917e00bffa70d848e9c2ed2a154d937eea6514ca85a0476ab2c4324819d2d8d8ff448ef41809f9cab6d39e1182f557384f7c4a4791cb228efe18dd660ce982efef8dab2b79588f4ebd124ab0b4a7f457652eaa26eeb40c458777e418d0f734dd67be02ed1c2db2422a6527114ee0c4775710328aa51a82b6ff98167a41d83ce3fa7ecf4ef54be52589454a56b26a6672bfc378a493567ec001fb04a1a8f6aa64bb7a33c0c124106968c3b16d8005eeac5fd72ebd7f87ab14bfc10dd6b8cdaa3309899622e591cf9909bfd578b9b1e50adb1a44ea3781ac159f0d39ccdfaa3cbec099775279cce706c823e773e6a4403bee79da4dea9846211f8d1e19cd3aad539f539c19fae910708075bea80efc369efe734bf39fbef34ca5ea525b84593ed8ed65d04e15b39c4a4ffd06b023ae43284e52a648d401eb4f18bc976f33ab5cd16d17d8321e35409a8ce170b183e99a3fc6e846d693808c14364a5429b5db99151ace678050648a4cc8a09f3fd80640482449022f809a6e207fd2659009123fd8a3ac8ae363182bebf365b27eea829f163c5318a1dc86432f6d259e8259df86ce3554443eded3ef1bcb75ed28215494d608792af84f095384a51232efb06bd2b8b2b3b112d805e29287feaafb5ed67e2bf08b1b812617c3c25d255d56128da6c23bcd41a5d68c3dbb4265d35bc8f4e644a60f4e3f3e34a913d7eb82156f0ac99412aa767655ff241362b37079d68121d9217275d605e3430edbe4324341b42635999f7b7119d43a32ed3d1ef66e6e94cb4ed194fcf34787aa783ea275c0d2d22704cb1cef2fe19a86c95d57439546d1cb290cf0de4d8b60f2c4c1995f2e95dc3e5e2f9baadbfd195954f2c3e6dd0a24ca6e3c48ecf19eaca381718355a56a20a1187d37a168a6db6ccbdcf78c69c6bb55ee3ee8521689bbe4596e72cbdcc02615f4f30ce493ee960fe9e1e106a843871b1cfd8c6bd67d688589ec48835eff7e519cea3d985247cd17f9681987a614a044a11494a55b8d1d67dcc9e65eb1cf0409e6736afd824fd434f1a34506a19ae29b67303f98e415e97ac39544fd03c8db560d81b6e387a4934a81f851f9fe8cb95c729ea1b3db44562d185a4cc3022c609365de12691354f6d962b4e3e8f39286ff9e7125ddf945586ed0683de34d24ce0c44fa3f63004af4137e2855dc912452ba996a6fbf9dd1936b4e6ee96e0a2138aac11ba539c7198a42c24c7cab9c8febe94136ec02ac7041e7639ab2ab982a75ba9f40e7db6b70cbef29d643a544b6daad9ec6055c2c7c8cc9ab5b4bff892558bbe5c79fd5cc4c4f7b658e20fb6e8c11117752438c52ad5f8b3dede5822b69b536baebe9064d0b3807dbb048eed66414e4a607ca16ddadabea6acef8e35ed7ce44216384bb9a9a41331ffb99647ebc64979c5d5c267fa2b51123e382ebd6762df3b58756d7b21164527ac52ba41a1b9f668ca8c88e277573abe7851bc63c0e053d4a39299a8fb7d11fb38dd6b6706daa08147455d29304ee2344f913b1fb4f2df1fc5e7f1e09f0b854a2e279b881576d43052c0d83fc2c051b9c9ddef498aa61c3675902e9cfe166ce991236e625362050e4a2eb4edf6bb69d0db78752c89f6c57f76b74c35ac27d372ba02c83cbd3e8eef52a6bfe92cf7c0f06bd19e77fcc5b972854d085d1413c8d7282077202001a0552b2e91378b97f54317858ca7cb4838cda707cd4a974df37ebd1647f8c5be1169c8cd443255b82853c51d6396b6629a005351af38f8cf1fc9d0262e6fcba14514763048e64306da5cc1549a41fbb242e51612de5b749910242980a026a4dc8a30491bb8a00dbe5e0b8dea220284e212e1dc5711f7eb5afa69bb34f57b3adf00d5e3de09a50198346ee0cf0f8daddece30b58b9e7c6763275b2680976e6966cd532e35ea8d044a834d2be25a97d43184fab7117b707b82382516867cefd62d0602d1c279dd5d283f3a10aff91a8c06745ad32665e8220ac8599134c75502937f1c629ce0b4c46bc084c4153f318c1e2b121888c9c9dceb6034fe778d193172bf30276f5ebd18dc3fe32f2abfa6eba569b178d267bbda5f180e73fc832d9c06773104a5bbf10271a6e1bb8ecfb648f339775980313f750113339e44574e125eda1aa14c533a498248c2b7636ceb7b63ea5d232cd236a24d7ffb16a994ec0afa179a00d7602ccdca825f47329bb5c5bc1f4830e0867258239f7011e37dff9a7977ebc53ca7c90f05fb6f01be0fc915753a947db89a7d290f89bd948b200b7303b7f98c61faef45a1576ab56256c74db6f0aa7754263335258a2bd1d5c1893704bf258d55c5d840fc730ed67878581dcd8d136d23a20535308b2d39844489724c0cb5fb8306224ad8ec18eb05df062350da08bdb366a0d60eccbe36758698062c2ac95ea4930c0bd5558f03a7033443d20133a1b56569f9b559a5a13d54fee5722aca92e38b79ea1aaf1d1cb1715c079a5aad8f09db308eb5928cbbf7b01b56477f05fe7193bf4648edde3b93aae9831a00afceb8ce13dda9c57d5bfb435e430383b176ac14573a1dcf60c84f6110b4eca852600fa8006479f19f3cf55c59acc8f76654ca2fad55a7981753fdb7c6e3e5ca8d242fbc9aa17dd09fecba1f1e92b56bd5733b44376ced176fd0feadaa3afa385ebde5db5766093a20a1f5526fa609238cda9d372651c0f9b9691931281b1746a78190f10432c5568318d2e858f34d2589fef22f092bf6d7a4a5ab84fe5be515327e28dfb81efca3703fab5a89df58357f7fa594c5c7ac1cde69d2bdf632622b2a0e0044ebbefc6c7db254db419dc1a3633657c48f229b12a9170386d8057fdeabcd4fbe10a78c086b7144986a7811c398d77d2dd8c143210378b4b0bbb2137aa4d8071c6b62c5d6fcdac7dae1b8624975b5d6f09516a4b1830c386d65a1293bbc417ad4cde553ac9f14d0b3b70cc663951cc54a07fd07c4c14d5c13ab98249f7b459d93cd43b11bef0762c8a6c2f500a55f5e775898909eddd6e96e1fc420678329591c488b7b510df726a6d17f61271b15b60a6b002926dac227e2c378b2989290d90ae419d9f2d21fbea87e38e51cfdb8add7474e752d97fb2321c575e93ae3ec7a307b42bfbeedda8e92be7c2e1b3a1638efaa4d52566503bff1bd9211e1f2214c8a9167efb6c9d472f1f364880e648818e900c59f7dc52645745f483d9571284913667becd4dae42ada39f39e462b504f3b5cd15569b49a369faffa887e9aaf813c7ccf1588a7456a9273da07105f2bc338412eed82af433d2c3fba3a7c4154269720028da4c779ad8ee88bb28aff4b2dc4de518937c677e21516b8977336939688c0619f1ec28b1c67cd0f1d43125a9d8411437bb7ccb512081891ebd42bc52e0e559eba0f40f2ef773fdbf9df3e9adcdd811e214c0b77eb23c63bbb1f9961291652ee7bf51cf017251d15c8e2390ab1bf03177f5cc247783f9e4dc659a28a5a66b6d1bf863661036a132b3a6b8b4c7d4f7de2bd982e49888c20b17684e8025aed7760d4a60bb9d6e9aaab6dfc803b9211f683926dadf46798af060e452e7b34aaaead232053c0678c6822888681e68c4ec7a5df5b40faafcb7a7a776f9ed68e7cc743f4b2b9e742a326a66906c5f23d2885b0e9eef8efdb624cb7437cb90e42a96f8d069c8599a0b00d3589953da00cbf6154e94ecac358622c9c83c5ca748edf6cd2e1027b5df8df8e214c3cf88da86be3e172477841124815cb118f2524e76a81b4fd73b9be5fb07c0385fc6be91b6ed4d7b4a23c9a35b3aaf760467e5ac93e189012256f6e7e6fa0b8982b8b7b7cb4ef7dda5e3e0b27a5eb3d947889cfb3ab196a3ae2ef38b66d0978a1ba3908ddecef757cc1c64f7a79ee42b4cbf476acf95f22d046f650dce7920d3d418c7197fc3700825a0a2bd73710861eaa14665d18048f7541113f718b45c0f6f789bfda1d73fa779b9ea110b05d8e963a3c80d71880f9249c8fe25a3bf08fb445036d68d556c0bf3c93aaa9e7a919c4714e5faf0d949ad2f58ea85fe1f91c0b694cfde4cde44817effb7c35fa6823f42af7a46430c4825c45289fd267299cc446cff8c01da05fcb3458a175e602e5cb66f02a6851a47284b1fc389b456c8c7124c3f6f2dc1b9eebf5853020e0aad35151cb99a1f5bf41d39ffcf589e32bbbd6881f166400b3c5d5fd18947a7eae872a2e5fd6230c10d54a2361370e0307238532f9a8d98cebdb494d6b3fbe90d9d9d5ae86817f181dd58aa17c8ccdf0ad5bf63da1e173600b125ad43780f4b75a2920b6de8794b06620ab86b603d4517c6b3b9635db38ac48f1c28e8e1ad1fee063d9836e76ded1823bd16a525ca3e5a511b343f0c5e6210313ee4254a8ed2454e7a9f459dbe31e1be2f85f074e5a56f434523ebd630c1e223b496ac00699d7cdb39214c1ebe8afb68178e21279143a44a9fe50a6edda5d4d7c27d15bb332b3e2cf0ff3caf2392b897bc5602e986e5b3652e1921a43a7750649e166c672a1f3ef6dd05174b705a4922f62cd567fc9a0be11692168450d3d85b549ef85f9975af18889a75b9ffe2f3057caf3d942981b579afc3c15573cf7c123aed3f4b3b001ef9c72189d1c1138e1e435ca18f2a283b6928f2c05588bde3bf22899dc8de7b32c54c6f82fb07049e139f77d843d47cea6d1dc77c14ae949324280bc0e4be66e3955412c009e075a1846c0cdf9d1aaa1cf644276999c8f0d97cf17a0beff55c126c6960d19661161473ce78f4a878b842dc295d0d5f84b0ea6d3ccc41c0dea0d68ba07d20fd93e994a06fe85a2d6a4a06cb71b51188ac48d32744f40f74e72dc664a9572b3ea8748b5ff20770570b12cd8763ef1a592e31460a46068ac862c7d84a997ab8cef7e0555ec48ed9915e12f52db8ef7696b90035d3449d20a606734237089f2a96ad5a17d066b112b60ed579fead944f03aa67aa46fd957956ade3022277b6400fd77680b3f82269e2a9f40306813c23e32c1be0d42ec6edc746ec09f9519ca5f57bd49cfd828b85fff9c000638e5e6f6b921838926c617d6b850895409b5fd616d2a60c31318c7e6e280556b43196ee1365e70a54a7539d9241c44d25e604df63150b670205ffd61d34eacf52d853bc2172af5738f59a8231a7fdf9ae446a022b5df97a23b5a6da8d572632caf5b75a0937a567c2b53bed5a5ecc9491e6df829c5eb56a4e44c04309ef6b4415619e03af7d8192c62619dea95d838f631e57d795c3be2d78cbde6af97aaf7cc4f1204c600d30765cf6e21b9383e6680aac7b3fbc8bc2fe2098a14e7b9c5da1becd763622a9b704d2bbdca8b2b53eab7083696602c9200a678632724c29d92b4e8f2b51255e11398f966d8aa0f276da72a721a6f453710b43d9d671d7c7ea2b9264ea110439f429654bc2fa4f9ddcb0ccf9cb9f0463e38c032930c33d01320d960b675e4c42c2bcdfbcd480feb7fc3a111be3e4f050bccf6ac7dc08ecb496c686b2996eadaee486ea657efea03622df1b997b2655bfdf99fb4400cce6842c5861bd5063ed0986dc2632bfdb5fd4cb9ff89db22f47e36ca9f59969303994cf8707b6e5c758007896e5b755ea5c39f7fa35ee44fe528c627c98280d1e072957ec3d4c72ed7aad74ea3fcddaa761fd510c58a7dacbfd226dda61e17ea67a975bac05bd27af7722bb8d8fd5a2da69f1e615d5e58dc0152afb0fd347b0f6de0ca99d3be1bef81b9ec52730b1828a917147c7b5ce02f72145b4c65179253cfafdf76549b74b538580af350ed3aefda1c87553090f1f66ad513b225e4d7ae6372503d9cc5216822698e92a4800ac4a48bfc9491a73808fc73f01ab1834cf9ba003d6f5f03a956dc374eedda7569c057ad3f6044d1b8ec63fc295f7669f7575a1a91870961a626ecaae898319d98aca3a8214a0c634dec09ed3e677597a53a0585c869d41a0eba20fe0328c0b7cf2de1d154fab1e5a4e71a0de0ea59b726a686f357dadfee966f3bcbf8938bf4bf8b588cfe56f13b4bab86c900f53cec80550ced8a0769257cf31082adb63e06f8778d56a458d872b0357034a0595d6b7fe9a0b1f57575ee165774bfeac922bcff62cfeaf96aa183a15b12faf65ee2d728d7a0bba3df330233acfa6c08404042c1db7ae0555012704a1d46b747465d598c0b0ff698efd003f8c7dcfc9b55e70b9d440f2d45870df8768a29fab57afb1ae4067c80f4cafe08db78853890d56c3c86d7db188f4dd5bad6f3152736dc87ea1d195701c6723d5de7b3094ae33372c3495d4a327f187ed0fd8b65a8eec1659e49b3fb3642583d708792b439182212132be0f76c674170eab25ddea6fdee769c257d9f916a3cbc87c445f1683bb9382aa59bc6df183b3f074bf9c28b875ba87ef579efe3a2235f7b15ad4f8d06fded7b34fa42b6a2255843cdae0379d685208871b9a6e56b430516c3b314b39daf541d29990134d501cd30658984722fd8b54aa423a040c07605844514ec33fe8f50b1d6566c34cca163c90a316571448fec462721adaf97eb92d7d1e4b5355d45f396886bfe396c68cea809c7d739c6ba0b8eb1e6a8ff58eca8852f210782c906c964bb700f6cd41b3aa2df87776e28a6408b3c8a5418b746238e050853110dbe59a7f7e85a832396b3fe76729c46cbbd7d46ddb6afb2847cb2257515df0fb0c7199b526e679d6b3d1579b791c0c5fdfe4b42fe3a415ba127b538519820b976f3c6be1c0790f0d0d365547c83406d5a749f6cdbe1570557be9b988acb4097eb1f15789d09d32ba5a27b0926dddd55f2871ae28c6495a942c024b00130e62a6b0406a60d9e54f661ed08601f3a4ab998fc1ca26772899a2f71b4a754e3efb4e6d10ece164c470e59556b135e0fe5d408d21e98d579211afc00aef2e03f3831a658a664122ed671ed0bbd34a4b2cb4a809242a2d2d11ca03c324d883ada3e5364d79a163cafe79953359f7786e336ce9b2032ef0d3afdbe59f5b9aab5b9742a8c31c3323301dfd9134770f41bc063cd174c7642e35242ea6a8786f841f7e95af23d450c8d4ba97d6aa9ff6cbf9cf9a56e88844d7145e12d1d7cee5ffbd75a1e341b220df5915044529c6b04fc93f6e23f15dac3a9fb202f294cabfe06faa5e7255664aa1e03b5c2565dbe2a9f1ff574e6f9a945cab283ee5698811a824698b03ad25367573c2c16a25fec6aaced796ad7972880c439d080fe979ab842fee7ee50ebe21cb674ebaaa741e840090523d683aeb929f3c4467606786e77de7c2e7357971d3e3c61cbf761188d2a2a2f2b990f79b46a0c27987be363b0a1619fd42005ebfea571fb748ff3ffd2eb023d18d87023d090946227d289cafc0834344fb467132ba67757c1ed36f3c090b9a29246970d557182320f36604f7879cac1881128e1ebcf15d1765feec65ed57010fee4353397e40e56ce6e53fba364ff6b0f2f75a6fc1468d68f474c12c92615042c83f4099b94a35e26f2aed3d7a996457ee5dc723c66253b8f359f1c2fefc95f44d94464a708a2077fa51b40bc8c34a9816bcc0005f8db16704a108dba5e128b92e36461a89da868b31cd96158c585ede2808fa666eecd2a78093fce8dd729765e5e96612004df091b5fc7efe726867629cabf8646f88f81057dabbae0cc89780a9ba09c63961a5a62be80941eb7bc8b89318897c3ddd6eda9299a39b16523212b7430107f9ffddb8a0630c7595b2ee7e56fd5779fd91ecf67cbd3856c9937c90d484a6a59df3d7ad86acdb54b718ef89c1eb303f0f432d308d32865b79e8d8f05fcc88b34c7bb63d081be4275567d9a9b45efe3e718a93e247c91aa8d5df2f566e366cfa1faa9fe65ef3cab3ed96df002ce0bb77b699d1a7f5e7b74a5b793cf6bed024068fa267977c20a0d3547c268838d80e1d3c27dc3a6af91f376c89606ef862ab22ce88100ea4faa199a9d3c897a5e9c4011ce1ad5101d8fcdcabbb2c2e580cbb603e36af964f1885505ed121df28a213da9416185a4122b523060459dbdea52a31e98938a31bdedd5e595294051354b611da19846057ee7b13f5ea9c530e28aacf3baa7e0c6b55a8b13f25fc388750c4a5b4c1ce3459717eea8344344a09a4712516a27f78d6dd55a08311f1b035069928c9937c683c4adbe0fa9588935cc4f8c70b75d675a0f7ac275f73b84a26dafba91d9a897b145b0d030337c2db0c066ba1796e8a1b24ad7a6314779c6696500568408bde9712a9079967f6e857db2994fd4467e519b30467e8411b581be447742766d4a67fac4d3f4929cae4a08f2922572eb759d2898860d3c2f7b18a834a2737f028dbaf6315b4ab279c702521aff321c3cdb403f34e25952f675a519d4f16ab84e7ad60456d16c8850bd002859732966d9143895ec8a9b32b0ec870f51c34d3f30b3794ec0e103bf1389216557cced5e769021345d2fe8665e9172345b7b8b446f4767ff33fffb26664a0fd75ebbac247779386b94fd5ed824b443a092212e7243af282423f269d4b7ad861efc4c81d9d12f63f2db6a62b32a7585be166341dc77491f9d743f9d09e8fca1d0f13a542346e9e5d3b4e417dcdc3f800f321ae0ce612d149c6cb4755d1aa97f3267b1148434675c07c35969e23c49de4495060016e9105a868ab127d64bf39f2baf5075e3c893e88fd82296fc6f835e701cb04a77077d7dc565171be41c8f0a145eac322708d4462228c64ae15b91671f87508507aeab10d65a6132aa09df930a58f34213d1036e54795f54c947c98216e771966526164d0faf57c1ffedbfb153d898649b187d324e7175f72bafe020dd7c5e70bbbeee2c39891f7501ac70d3b47fc4ad9873cd8ec281eb1ee0e14b41adc34bf0795d4d1b1b1bbb2fa9e069fbd0c8d4ed545267022ca9833e139aad3f0dd3414069aa1b47ccdc00a259a49d57b2f518ba5765736d75e6fd5bd2f32b8235d95f29f739c674d1b39781a72bb414e44f898a650ce55c704ebce2078dc9f4e417110292b582756bebb7b758ee10d05da3ab309fde3cb872f0af9a5fb54143814831768007a7da515602b5e56fd6ef8fe6b86b6c987408991c03f95740efdfe6740160c6100cfdac10d0bd49bf87942b38ce990075a1c80768735132a1e55d9d2813667e40d737b5fd69fb539164c3aa7aef9238f26ce3a8492a85b743bdf5c4640ec9c96bbfc13f39e316b2cd81c8ae20310f4e6c73012fdb11ec72161d2f6b0c642d9e77ec3f716aded41d821f89fd2e502f79bba23ba57abbf4039e03ffcf950165a386175c6731d657d22da381840cf5987e67fba4d528a4a4910f84abc58e836a5c4744bf31eae4196b83c109afa9db6f4c93b0cb6964cd2b71bd4bc26438ac50ea13a2f06c9033ae2f8d8b205660767060275b91116ceee80208addd51f1d4f599db4fb8cdd22a873c4685f339c9c7a99a71722b7af6ebe36c4ae5ff817181a0c3685594adc5d865dc58b9dd7b522cb7febdd107b6e31c210f1b593941a8f08165023f5c49bc76ed0d344082b0cb3f3304ecb8ba57f596d753973d85363528bdd9dfb0baf2efec4132774765352c3cfb28e2b0138eb6f1efcf2a3298c0a165f68887e7dbefe2458415059da882f93691bd272a623d103c8d31e665f8a4421659c77e3e479be36b9463c9c6f4e5bba62d38f00bff7b03e3530aab88647eea96efa60f600f1915b03998c556fadf82149005e472fbbe736973e0856b85bce3b80acac270b3881805267bb6d176e4043d6318166cc65b109e9772338636d95a336271dde1d478bc7ef24e083f85e254cd8a7841d034106cadd158fd274bc1af37dbf6a24aa4e0aa1cfd8ead089ba374579125e3b581fc9b526cdbadc98b1c8e5beefddf0c8405005111c8ff77e24d9b6b6a59961a86dc3d9472566c4c3f2195eb478abd0b39c5ac9b6500e9e13213fafde4304429e143ad567d09a9279ca6c602536f10361ad4cf93fbf9c8b38b14a2633feab53a9929688f05ba6340120d4b134491041399880b0d9c930d17e025c8209b49c220829c74c3bafea88793dccbf9258ae230d8525fe244cf34aa588c2570cb134c7999b5b7ff96d496daba0853383fd94d9955aa7cd5e64ec29a3eb8edb1ce7c6fd8a40b093b94443cca4beb0145500b8c2f004311f37ace33a9b5b013b3c3fa75453f8478d73da80d542d428131c9a09d0d39c6dd13a5b6e1de9da7b4d94de96c8cbbef3d2a5582e5b5d410934b993ff6d60b27a6e2e8fa2994aa6168f27fd9e8a334ebe0070b8f60ec2c5193934a2925f2779980c1ca2d72e239b05d1aca15210556eff31c03caa6aa197a4603bb519d08d7b93508853e6dbd3bd3d0c995ef4e66a25eac46fee06eea4e84d170614bfdcf7f17ef93f0b4642d91e47a055f80655fb459b696a83c9be58d729b587fd415e5732008a0517c4fd9c7d58366fcef41625643fc27e0b44e1ae5ee72574fd6155b4fab6a68826524e23170a16c64ff52b676a8848dbec6f21d12c85befb7a24223deda131d1a1c2f685b73f5e126494bb2690f2f42e52e49f625a33f6144b713f3aaeb39150be11563c31a2926cf87e6520d2e446025be3c0e949171da2df10822224420d2addd32144d2abeb9e7c57ca26193b59baea8d158149d2af7d92ff296f2117936dc051d16c9e3c2287f1fca81f62dff56f2c91d0d0a5f34311696d807f375c54a6780d4bbb049168946c3b0740b2ea466dd008183d46064fc21e6fcb07b968dcecbc8cb93d601c995674d0c31af39f680312ec45ea217fe41b39718f8415b91a47680fa3cfba0bec41a07edcdaca1a94b51ba5178c630730700f40090a0a57753cf02dff7522368c9ea0771a5d9847becba47a86cb0597bb1d947758db10ecaea695ceac4ace6ee4a39470280df487c4a60dd656bd53b983ddb6a81d142642fe0340da3ca2de14b28193653c2354c8f1d028fde2122434ecb9a5338eb30af92722d31a5b583a5d4ce474bc5f064ba329f00a885b1033b37d1d2e261196693ce7a5f712ab10d3e2589e25d24fb240d4d6210ece7e0f23289156d0175b4c0c85ce63c7a2300cba7b53e4823b2a74808e557522c2b1e63ce3120bb200346f9a55d510e127e0e2abaccf097e869fb26b8d8f117a83b1dfab4f57c6a2628dbf699c5000cda2eb953c73aed0283265a9490987ef1fc986ee08748b5c8c845a4b6dab831f66434a5a25e20e2fc96f79d5474052b1ce9f6d6b6eac66e85dd837fc1ac97e56b857fe2420eb4a215bd6e83fc234e686f09767d1ae708dc396cd8ecac343dba660865e2f6ab5eab47f21d3cfdd5bf316e2497205500effe36f75970f75669ac7d4a7feb685cc830f2b19ecaecae715d350c852231853590e168df88a31f775371a610b1a0e3306feea0b1933b8a59dd833fbeba31fa4ddcfad6c29f46635b7ac4487b39e3cee8d349a1611fa64a00e142400ccfb9b07d51b02bfa5025c5ae094705dcfb1b5e5993a479b1a48fbee4a888b037643e1f7a1766c9301c711a8ce3ae7dcdc3e0c19297c7d314f88ddb23443835d1d10f746071ae49570e7665053d5604e446278c198ff6bb8e69e0c13c0c4961802961482ca4048d98472e6f63466efb4fe7c062bb181c85af8c83ecbfc345816c3190e61f8297f0ce24b1e797348976581c5f9f2b84dbc281af2a54267217625b8fa24dfeaf0d4098a04a44b55727b4d276420e5abe1bf2ba9b9cf01f340e393697828f0b45a46ab61d70138f8f86362221f4b080d94788a41ce93ab270aa744aa26415a1325cff496d6cd7f35d3b5922ca97ed64a602f70351fa8b8fdd997d465baed2bf73f2b10aa6c5820dd340f7f312f125ff7d0cb72e4f35a70acbcc0a9e5dd1f5406cfec4b6f583df02b31d44c53995180a2577c5fdcdb5108f47f1596163f1e025345d068318ce60fd40017e94020786c092392a05b7672f626636b62f82b1bc5f11e953dc76b6ea61f1eb8cff7063b301b996bef31f684af98459a9eefb69d5e631842af148b3cfd6c32bfaefbbffcdaa0e3cb50677625d7851057c9aebb7d5916ea1978875f9e36659655f5018c9b1e83cb3d94c5679aa1f1534155a87778e3855a2bfd265878160336aa75d58ed6f0f3429c83c5752943b870723c09feb23c938ba39a71d6da02cbc71414516bc4b6c319e09d35115ae68eb098d156d191355ef70b53f967ce248155db4e0293920510d08c485892e6bc46ba27b75ff390397c039327f1d6798b4c7a2cf3f794805f75190ab2429dc5902a28596e4c9395f26a4e83afce30e32d606930cac36b5dc68f4732d1f27ecf8116ab612f0bd3e9a94469c4b9d25efe6d97a112759db91194f18958fe5f4b728a9f29b48e91e9e3f56e50b9e21b9d142bf3f9d81545fe4f0f797ae5b5b145429814c7b0068f12765a85afda525a7b0df4ab9938b561315a0c0790819c27811dd81874fcad3d2117098e9d37d6c43dd33973f1303b474a994d1ad5ef6043745abd89dc0aa20bb3db62d549a2bc43523960de4e05baad5f428e6d3c77e43617ac15392366c1608bf96bab6db90d63be6c4813cd59c58ef06c7f70ef770860e1d03e23f296c787504797f6c56e599b3be75bef38d304aa998dccdfe80a010f58b10f2b4801cfd40360716ff203b9e676d8894576b09c8b9fc629de8d22cfe6df2b8908b06ff6d26e2bbf4c21b069cff573393165226e8cf214544124c7567870265dc6efd47b963ab1d5a333a40b42eaabe711eb3ff7206db092f945687fa7e71a41e9dd5b782d5b51c8da6856cff082d9055600dc1e3e4d0ab1c2b4d0c757a728196c5037189eac90afea277212981af2470b38f1098cfabac668a481855f1022cb6699c4ffe3a489bd877aa9bc7433e8d3becb9f29e551880c0a9a63885f8db1422695c805df8e86bcf2d57d35cc9d73cb47ac721458ea165ade7e1b8ea8c5982153b33ee250abe08bc7be5133f74d5f915aa1d30182dfb59047122fb58e690510c2d0f0fa754b7e98d1e9788a7dd2b23973aa95783a837d803eee7e8d81cc335db4f2c9aad9213effdc8147390e4f9710a478fa6ba5462cafc1ea5670806a92e13c217df244cfb4bd17bea41909a87f209c1833003d1bcfc6bfd98001ac623e9ac839846b6dfc284de48a5e5ef09d1832dccd7ad058c2e0822db1cf62246892203e343751a6eaa1df314bbf29b54985ecce7c4c051445f3715919780e12f7d7094fbe323ae8a667206a83df8dba0100eb9ee8316808a91a348696f3d0cc5b1f0b17441aa368e94be2ec3ca8778a9c195c4a6b473c2f58a3a30e648c5736e41c1bedfd3376070ccf3b8cae75b71df8e4570b65b49ac8a35aa5d0efa644e305a5ff7c9571ae435a3d98546329e03738433338f8b3accf8a2a2612f87401e0edc3f7f64fe4d14090a1f30730392cef0ef56e50a201b95c349309200259b4b17d46b391ecc80456c9a0c77a2f20c4c583395184ba77966c849a7cc30b5b0482759e0b180f3b3f36ad2c612de89d4b67d3d67bc92bd3250df86824df4568ba8df716beef3b937d2b979246e9725d8296a68c4cc4867863c5bbc942cb3d840934b64a6333bd9ce953a675e7a43a4aed0dce3093f0b41eb6320c6c11b9230f99585e4cfc6061bd48e9c214fa704d8de32a815fcfb09378b79875795611eed9a1bd2d83484ce332843a64e585a05c91518c2a611117663f37d1031ef489e6c91707b6c6e8fae363ce681e1fa3007af7bf6b148cbaed31e61a836917568a8d75b10c5f835d62b589617d7e97fa98d09d9c98367acc0bafe2d3eb3aa5ff017961668771e132929aa99bc7f117a463478080e055a6d8d41a9001bbc4fd788ffc44ab34521c4de21c479e1d6d3461817a8d636e543e5aa8a2552a2a363f205b1da044f66b0b4a6f4c219a727c4e68e94e2f6ea84eddabdd2e83473dd6cd8b7ff2a389bb4690bc2ede055eeba6a70084352e1bbafa75cdcfbc6c7242c45821339de4f76e159fc25afc30bb3839ce8ce759c0bc7a2fb2080430f1ac761e76e56f27232f7662280b5cae1a3b8f9bfe93c5c5997e007d562200856f7780c63e8e5e4dd3ef3255a91f14e13972616ccf5040e94bde41d123b5a76669280d7756b2f23ffb6304e7d041e9a86ba6f8b23c7276ed3fe31337ecafa0e87ddb37c8f8f1ace4de803164dca405effaa0ea56025995ba5a468ed85042ee6b4305366e4948b8faabe7531ca3f32c0ac227eb6c5a40bc0afe8a5ae008000e1f05e85d4a6288e1357d5730ab2ab0d3ebae0c5ed290261d3b4cabab23c4f254ef909b1eb4ad16b003b4729bc24cefc1aa26d5a39d05774b809e0fc024f895a9eaf65f42d9426b42d998c2ffc6ca0f8614ee56f10d3c53cf4ab2a57f5ec4fc1cb1d3fca67292c1fe40b39758961ca814c0b73f116ed033d6e0c801b749bb18c02e20ee012fb8d43fc9df0232084e00c01a3afb63ef56b5136812fa113384c7fa3488c79ae224f5ead07e2e51b01806f3d06d4fb7ac4ce12e8a488822b02e51206f3639f6cc7426e33336f3b24154a23a9f2e5facaab277ce53983c7fe35773f8af52ecbda80b2917abf829944a0b9de0a4be6cc1e195745c3f771cfd64148e1f2680f98c53075a39459b50b1dae54c3d83f74fb14572fc1708f09cb1ff3266feb1add01c2bb702ce011719d2cdb96d08ce736de0c9f65d111b77ec7ad6e2b1149cce99cef654bbd7783c81c2de792be398e68544a5b6a633f5a32cbe835008b06aff89440ce48d4930458351df1c54d7e9c07c4c3b1249b083c12a5bf33b8bb66884589edee93968564909010786bcf51adf80a20607a9b45c2d7749504ef210211b03fe1e5266f189534a07dc8ed43c84e957d4bb5af72b8b8cc33caadf90476e4250064f6480015d4a0c0f2b7493d92f832aaca12e3961d8ac8fe1cd2d8b1e8b6438209946b8962af88f1d44ff066b47a6f0b463dbb00adcc12f6f117e981acb437f95a5e11825d664904987def358351f22d03c7d78fd9edd70499ac820330aea384690a64a5ad02426da4555122be1f3c7012238aa3d24f1fc39790a738a282bed26e2615a057bf4589aec98128a7f1ff2fc9873107c205e4eaaa10b588f01999f433b352744db0cc3e47d640f7c701d90b35b6a3dc04d66da1dce9a61d72e3bdb97465093279d815a1ef1357ece89020149df97d3b6484cbf92bc88438bc395ef091b618090116c28a1d5df1e77fdaefe8f260ab3911acf1d97c2c6eb8c34073f017f79bd62c14d213b3a1306443ec5f1e2960ee37964afc96c48b995b1309cc67b08e6a09297206ce54a3c96d6e86029347e878ed13cfc3568edd96d9e7fa2f77a25a4f199d631310bc1ba126523f402b526ac1c365891b8af13b1f08d4343c8e9dd845f3655864743cc612ce12fd79f2c69354f4312152424512e8bc7740ab3bddcadf41e07f19ad3569306e4b76abcd40d5dcfae703c3e89aab49830319f44d0e54a7acfd49c66fc7e8da2b32d8d41439cb21a2e004c67bc5be0db440a60002db03045074112b53f836f1d557aa68053124ac6a39f51bc25c3964ff7f67793909479658609dfc5007d4c41fc697340538e37c71384b99afcf9e1216b4488e1aaf4d6a2e9002ff7c80ab90f1d39230cf0728e3a6a7a55aba9d17a519beab1478c1a7523d0378703b50abafa8375d513394b60c65fd8cc119855f72c54c289bd6e45d9c01857595606c41d12f27f0ea85d65219004560853fa1d29cce8bf9b57c080d5d3d8cce7393e6d4861e9f191d3eef88467314b1efc840260d03f65dbec8c5a8325e177eeca525564c54bbc4c38bb140598a85b089e6599c50341e7ceeca3d2c6b72a9a88c869c91ddad75e0df778a464efccbbc81e1d981eebd76f34a694f8e9a4b163f549744e1a1000e8040b39544c888e9315b236bdba7c58059a27ccc55735319d0b083263dc672d611e01dcebb2472f1c35528a3c4844c4c79448b8769548b4ab15ae3a5b1556f65bf1091f1c7e6cbf72b667f6ef17b488498c77bd984510ac0b66ce713596c11acb499c3243694db5fdd5f6f0b12aa5d63ea6b624df4571d21368250ffcbdea7f9261519c34d9e483ea3c266ea092b39c49dc745cd2683216ef1baf234740005cc92f52bb61f16b18b15f438eb24d991bd34168a6d631f2b28f1e80cf1c6d87939ae7390fdd5464b3be7bd8b5964935a804c9f1e2a7cc430b55c25ff550c1f82c8cc9e37413eb53db6847e10296f1e9dd789e545046bd432f73c132f9ad1a5268796af387f0897d9e6847fb80042a31234c551a9625f28c829130e04d5d7f358b1db05b14e660b2fc722452d46e2a766e6cbc91eba7f6dfe1d5daa29288a812731d6c339149b5bf4fa9529d0ea51fc04f08c3f3cc2c38051f3b15682d6673adad53938671056020e57b2e7dc1e9cc099849d0b54476be3422979c6d316ca6527e0ad6758b5c3ac6c75b8ddcd5f0ba6f6b1506fe2676632ff655c216ec681718c9fce635fead0391044e1c4321c7e45ccc2d4f871feeca08532a9c299845a80722e4cd5c210404cc2295bb4b6057b14ba1625b66be784e1abb1948bf6c28555bed15e18bfe427b55e550d084e172d8a5de4abf84386112d1b87c0c19a1fbd45af859f32c82bcda103221dc0d8f73c9821563d142a1ef9f1f26128b6381e8815e46ecb57d41c33b4cf67a174fa0d0df0f62f19b2a2182a1f3cdfb46de15323624d943b5ee811c2eef9339cffd6975c47a2326ba2fbde5386fee5496981400ba68e4da098fd9d6c507879da9ed5a81f8becdcb51ac3fbe0c8dbcf75d12274b1bebc6b69dc28cbada9e575ac7d37c15609cbdccc9619819a2691084f939e39cbfa3846582b873b5939d1b014a46788bbac8dd54fa44d42507cfa883c35d5645ab7354cda4820f7f9f4a8984f04bc6d2b6c07a9b8dc3963ea34e4c93d697604198ee3fa4618fcb128b57808270b82f588db4e3fb32568889989aad6c6ae4aa7015c0646426eaa9025b2473950f710354e24a713850d6dd8377a9cf1f4a0db97ffe24f49fa679baf016fe1ae112c22b76ff12de2824c7e95c6b70025b27bc38c0d6d5b1c276eb68ec35e4a03b46793b9d0c25a325abf532effe55f867cc1f63550d13ed6e272b7ec7b52baaef2b7d5656a106df97b81b88c406a127641e5958ed36514c029b2f62bf7baeeb4bc455e589ab1794eb410a1258b93deadaf77ab81c768bc41f67e9af5f10d762e2e0bd6449423eefb7e12986f5a8f5834c390ca17e2b0b9032026f486e090533901dec540eb30dda7129d79e37f2649e8c55339b3675ac716f198d7ebf5f1da11c876bb9dc1b6bb33202b74f1ea2e9c84e3ca8888c65264b6614b6d53e0a819c01844fbaab2bceb54296c5d509d83667326099d867639338b5402c5039bd4e4a06234d7b33c7d8a35390e450845f7dff2752e75b342f231466f51d3ba7b6c4361dc33542894ecb87be5e751a74eb1b2f2fadecbdcba28d7e3d44a7c3557a487b95e8aaf57acff3cca065198dfbc4cbf77834f42764a78fa7a46ef440d3363c8f383e3d99653a785cc9076701df4af9a79aba4c42ea965a9abd9202143bc23249ab385c0c881b6c5c30956f0009a39164db6f5a534bc5f1cfc20be5852eafc1be17824e279fa06ddcb24f924ec5f838a63f3687b52e2e52b9435e7d4e40483e8d2a27d9a1ce85d13b686831d8b9d4d8b0cfd7862eff43ec72fef065bd7ecede16160c7f45c6c132192badca7763d338ff3572c3314194db287d2d18a5c632b2fa6242001c0ff683e55b7c69f412b6fa0a6e31bacb903489fb6d482847cdeeef6e5c875abe59206074eac9ae31b695ab05c39d2cd8c97ac6cb40f75268c8ed84a07f38686a093492ebd30e1e5b0c0e6a3bd7f1f3ee58bfa27a9afb2c3d374388b4cae5a1300f7b885380f8345530525c3e49ec231aeeda24fc3d18fbab80ebd70579d8b69ef840e04989ab63918295f66d7eb31153ed9824313819879c26335045a5d78a0674f7647824ba6d2fc967f486adc82250f819343e5e6731ea966106146302cb9734dad363e9f6cd6832bf19bbef7a4642b97d8b67fa86060d67fc9e91daed065d5ef09e1c11f7b9e202a5ed8fb35250d3cad3ab06cc929e5834116695da31bb8c5fb05e3cc5b596d2f46c9cdaf03d7230ffc7c205d4e75657be5f42a72369688fe76ea6ddcbc36f1cfc5b96638ce96eaf7c0fbcf6571879ab5da1ac2497dd88bbd4bb0f90d7031ef7281c4c96f925b13410fdafa4cee30b1cc0f0c3f2158dda632f2d7ae944bd339a86248824605957fb0f5d2c1822d341e35f06e3066b9cf4ed15c68f12965dc56b034afcc0e3a7114c962b78558e78c58bdf1267d8b4a46d5eea1edfe1382eb4f69de6a749dac292967ab1a015bf7d237454eec48532dd0b8d0228d6289ecc4b25a764b40b7e98295f84f6d9485317a68a23bb638f8f00b34c0af134a122444286fef287d50aa147d58730e4388e28e58ace9580227326304578d013fb39ad59e34b79eada34396523a5126030d3408792fefb9e677deefd1200b0465961feccb354a93d0c672c157c4b8cc6b69efbe3ec558153690cb9e04de12e6a1c673e42ee59183ce970be479e998d1e97d95b2154ed7c2381010c7e6b7b21b882d3e192f2179b14f45ceb4b0ecf8e45ff014bac4f74b383120a79fab36cf599a2415b718bed10957139eab429d919dc0b3c0bdf0d405af1384be17a3d802cac17a78338af004ce557e86bf0559de23f3e49537062095854f69254fb3b3a5b3bae90482d50d4f2493a195e33bb1f8c1911f0204896facae01ff3495240b14d3cfaf8c4e048d67d1f2e028c5f4f58d0712e0b1b4ee4194fffd7dd14f4f5f8f5a6655af8d7e5b9535cc4361564eed3fd067a2345d783f36c53d603cbabe989f816e93b927ae9eaf741745497abd0d30aa7ae3d7cbf6a29ddf5982ec31602550b65245a7bc319a0df06d520af0a619c373805fb04e5362786968369b3a39f54dc14d73f50e25e42e9017208a2e33f851efb3676c57c8d7bac0a8106294d8bd0532c511f9b0ac95689c9da8e242171c1c4c828cfa88fa48008aa8497580c7dc110fcfafc20a03712beda809ef29fa7301892775f9a0b9fb15ace9e9bb5e79d5a09cc99575b1eb5a8794b06859a0ef82e99dcb87c65439f8a9ad8da0a3b5d0b8dacd64d6d157db2be95041b3c1b1a0f263ab426004c8f1c8dae2233ab027a3dd7ab1a5c0a58526d2d5d88c7134a82e5fb6071ff0c11cf9dc1ccc26a32831afd02b074dc205e26ccf87c144d382e317f4cc3007af2ae125e5aab7b76cf6e8b9f117be408f806d65560bef6100e1d11f1b6686d04e08bf0ec4960d4da7e85652cce54e1b32d5443e8fc3b068a3352e1b92c8fe1c17d6693534c4fb9a1edc0e3c2bab15f74b5bd39aeda756f86688c2711f406b9b605809c43fd031e9ec7385572bda89ff345ce53d1c376e3ae6c9d723e317edb16a0019b9951275455cb54f7e147e61491131b10fafff493dac1c7f17d1d612b9233732ea976e6f4c67dd633d0087c2870772df4e9798c3cdbb9d9a8a60ab7b96733ec0a197376f1338de467abc13a5b1c1800e0da3500ea9c06ea67e43d1e62290980bc0f4ebd4769f31800cf68b2a20e17bdd46d71af0096f8315f8b7b84bad8da1fac3e1143db117305e6a1fd18576d60c9173c9c424fba3f2a95091dc94b65369d7cda56cb8c76c3380a5ba577c6a07acad5d5aba0b8122cac71fba624092744c07e86a90b92bcf6dc5a5b818d8a7b33e0fc168f64f8b12d83a9a1e73cb83c4d80eb4e75c047f956fa26ac024e4282d26933c68bfc752be89b3a76501157ce90918a90bca47ac1301f2f21ca672480fca1347c1b2e7a42e80f588578f30bf84e571249a405f104d7272bcf0a64cebd15ba6e4c08f93c72ec07bbd7ceef4d3e4f20cfb00007305039f26142cfd1e688665a9374e654546013bc8579c36e554875b8c2ea67eb1847ec0d877bb664b873ab46dedb87c55001757cdfc11c8d2c69a8f1be081172c6f5223c2bcde7b173987d877a0a28ee0104bd656675acbc37e1fce44a04a10002e1f2e82b5ede0f4e0377b4014b7676ff9dffdf5a6dd635fbbd4cccbb692d1349aba1e56203ccbcf731562ccc03c65c8dbf30015efcbcd5f6bcd74383e39aa85b655148655e3f5a8fdd68751fc46fef5f64d2ee17ad4b0e9dbe373704df8e90b9e2e1bff2543fbe8bb63dffa4df1fedf1d1b20e397b1521d8bfa995bbbc0e484afece538f58f8af363ae0dd4137ec2699c23c4d66ae80a415c1159b07b6f8c2fc808a0dd46dec378cf4515868293e4684750a76d4c8d07aff4c27e6543bf0c7fbae163c8611a4c145c2c7c0aa1497350b01c8aa23d1f2c14b0a0b2e028dd08c6595bd7f4cb25e67bb4a08d350563a45dadcc00a2d980c3f2a8a9c836cff380bb4cc567798fd3ef28064d32d883212f51fe6b3e59ca414363d3d445ecd44593ca9b062de49503b18116dd4d8be802b379cb6720956ba89aaabaf2774e8e0b0f422637eae144f760301990d47a2dabc9c29aca980b7cfb2e2be8029ec7e4893a831e55b2ef10767f5af0d558ce7cde86a314ede338f9f0afa273e13669a3b72b3d7b26173db82e8aa689c8bddd1b8b5d7b35cbef3ce7ddeda2fc0d40591068cf30335a35cf632e93d37b1216f9450c370076f5c528db13c6fd2117cf77df42681ea5ea89f1c5b50279f3c992f947d2f84ee24bb9645da236168e2c50048a096178a24145a44250f84e4726bc772f1ab231646e94c9bb189c7859a1da0487964fb9c685c0173012e29e9776a29cd6979408b2740aaaa645f3117dc19b096f57700877c527b38b5ccc9e0db3f0e6aa1e826986c419f5c3262dcb7ef87765a240748ed69605871cb1e0316ed37e60fe4386acfcc169cf8dd38a9b4268103cf4c52ba215ca5940e95279ac0ba6b698264912921b0ca9e68a61001c157f97ac251993eb42ce83bc1d4aab68e7c83585e3ddaba3c3147f36ac9cd36f64eb95ab2f3f511a3799829bd2d75b4eab23f097b570196d413b380c10eefb43a4b7b336d978d219c54a5b02935bf86d4d700dbd8998cae9be6ad55d3b367b70846bfbb07c8152de1f85fb5f721399cdb41e6c32a9a974f8130d8995b4fdbfac3c4d79e7ea37e4f2d1b32cfc8257bbd7f06b0d1c23787fb3b4a7efce34431cc9dfe7bdb99449934c08a39b0c99d45a8c8fe74437af74ad799a6e8cd55090ee51191b9a5e50134926a4513dac632ad4e698011641f3e9f8b022a8b56d21da405ec37bd375d5f56ff93b1433058640f330566b3acf8e978a32194e17cfd75f81ca69b5f8ffbef2b8035057141c9b5c16168fe29783ecfa832f75913854c0e1b5bc93ab96c94c5ac3523bae7fcea148f0042dfb1214bb882c0cc80df87e9e1ff4084025cc0614b5e4064c3a61732aa7328b0f08ca8acd99a4950b5e312ba7dc2461db3556299a7a3550a016bf002e97c5015d7c2496c3e3acc0e499e0e26d5117083d1651da0d416850e0c2d4973666d56dcb571f71cb64f96cf961831932626ae3b214ebb525199a9fe235d604c8b9edc5860d63cd642bb2f52f44377f445b364afef6cf1c990d42ad54c80a81c5d319c400b22cfaec8943fa0d3715ca3328e5d9d4594d6cff3222c98a79c0d1ae6c0eb7f8fb450126fdf0e199332bcd5cfa5316c049efebbb3e009024e94107dab2943897559229466e678abc08bb6074e5883fd6cd2fddf3aaad4be88984fdcd531270a7e2b9e6f8315351b04a6a09392cf7cfe904dfb0acd5cb2e1b5ea33192140b99f46e2ae23d98f0ecb62eb28a2c2aa3574daf05d4282089abc301edcea6a397943ff8668de4ada459ca76d93f9c62a272d90967815bcb2fca5a5f8fb419fa66d2dbed7c5b223445fa4f79932be3b050aae76751dc3dee03d6ec40af4721e4095e2859f1cbb4d6830cf8c036e62a42d23defd88ce135b79464f708154db2bf7786f0e2964e30768ac6fc8da368a1f6f485f802b5504581f73a793355817562f0a05f7049b79800745ea6efa2346f10fcd08e7dc11d4c5a5cac905cb51ac2a7485e30385d9b892ecf8aceee188544854c490152cbd4d8d4b084a88893049843d686966ee4821506261eb1194a058fb664c5931f344b8b81f590e504812a53f81d62532f1abf20873ce96d44aacbf2a3178132c3d9f74e2b6ea20a3d751bfb554d22d9ed71159a848da32063abbfadfd0c8293270dac6923c8e41cf5f658eef2df586dbb83011ff69dae2180736632920d848b8a9d88b16acc16ed49e3bd53987c21535563a0f722a705beeda6aa7c738902a3fe302ddeb1220fc8eafa5476f3b64de67a9b4bcf276cd63ea8c1700804c217197112e20cfa3dbbf9708e4206b185891e81546edc9f7fb682904787f89a1abcb587aab05488c7c4ab4b491d27772dbe17f91d9f731d52885d084913409eb34ca3f7cb857fad563cf8dc71566ad9e6b6de7c61d865df30b49ff327fee7f5fba271f99e2611b2b58477c330c3e3a3f54d5288ddfc0b4ae5278d8c2a1c345b87fada02fa387ddc1a27215b4c636525cb96c97160d29ded9e91a20fbe1e93cc24bd58e8b73c34e6b62767c1a84f6568db32d1745f66f953338067166d96cfecbc36da2198616e1f6886ef442fe1e652181e79978d6ba02518fcdb351cf218708525195d026efcacc65ed269ee912836f37c8c018852573753f5d30cbd8d9006891f7dcf9c2a33693efa6cd4c9eed17c43676ef9e5ae28ec7194370149d736ac31edaae46e0b06632ff6d06c9e23fc1553c89e1c11a9e809482cccbd2788ddc45b9ecb140f4714852113e4ff88b95049f46b27f1fbf62c53ed5b058a6c2843006676511660406e6e145f2a0fd232f8921ea841efa7b9d165da524555a5891afc013f5a1cde3560b958e9ef557d9f9b4c9d768f586a2f7543213b428a5c9c75104f17ea2d00d023e6d5b2b7af1f2ef9d4d68cc0a349fc2756d1e4870b19449579e2dde99595dd1f1c0bc10c10a3323ffdf4ae4b11b055755a5eb16d2357e92ff324d44383c15eea69a39b54f3637d76716cd1dbe4f0e0503ca9a33afa9354b1a68852da3584ec75c5e6de61c4e12c15853272c7651ff6d61aa97c0fa2120663598aa3c423eb645495e8a6eeb80c985b2267d55f543b3b869c5296943e7b0f90e03b60e88485f1fece9f4a090e3fe1b301ab50e73b863e85849b7dfac32b21dec003a990c85575b24c600589ec98aec75b73efa9a51e62cb84630ad9c9e9d6cf2bd79431a23f3c55caded10f2b5b1420112431f1d22cf6afd40ef87f4a6f5248aefccaf146e7a3fe65ba4cb5eff85960adad5cb9ab05dab5f5b6d0597d1e6b3744ed9265763759ad0ab95ed969b258240fd5dcd0c5419cbcab356d58cc8ba52c46393229be7a17c03352ba92cf6bd6ce6052bce0b47b8acd05b5467e5ed0354cc47198aeca4cc6ec18e1277fde230ffefc059fd827f4b83c85cf72a536788b30dd0c7b67678deb8c0417016d1cfe7e84c1158863ae96a8c0aeee0f30b8fb15523e311c7e873a3bc5105bd3835470cb0255a976b5da214dd170de94451be1fb202270cd2a27cb611bfb7c975bebaee8b5139b0cda0c6ec75b34e5aeb8fe4b240670c3eb526cb9567c03afd138f5df12248e118da1b9fc28b9b1437dacc02e92fd3b8918d8263f9483284568c0b1475fe1c2b1e1460450d75f57e86d8ffb099e04b5a259dfe10be92c0465084107a54cef57552568d588d9af6901afd572b784a882ffaf23af9ea44fbe7edc43607718b222dc30c0d381bbc77df182439a0c0ddd684be0d9c18fd3551f9f93013bf44a597d5197dc6dbff1fb83efbc44468d75384a8d3d56412da80a5bb1cfec50149ea19ea82f587f12f505a18e93f3dfb9df8e23a87afd7d0f5b8abc9f82cb7ed3352a6d1a289a88b4321efc5bcdd1392c90190c00923f4a01426506c8231781b682dd41eab59c34953e0aa92b25eb40c330900b5e4263f3ee58455f82b9a0d8fd425a044bfef50f1f9fcec8d2030cd11f6e3936f6da146b890def19fdfa0f4e7aaa92649e6b2f9bc38a3e6f936f1d96157581a70ec28fd7a1991e0d3bb25705ccb2b363d3023de9ef3bf68f5ee75fb696a0da9c1e02919532b0d2cfe1b66797aa361ebee1efeb31387fe3eb95ef943f7ec219e7af529c7d156a1278daeaeb5a9eb2198532ec56ad59cf75f13f87dd6381ded2f04b6288547c977da7e62b87871d017500bd29eb2a56d31abeb92eb7694bc21ea76ba06442bd0f56b1d40c98c2c49f77fa990a88a29caa4c75b145642ff4319d5c3c997c08e8c38cd4c5db942de8d4ba63c75ec5f80126dde0ee3cef09fe0b9426e2bf3b6e7b5b5a692dc9b3c570d7385b2479577f75c894a7803315fc9e82d938ceffa92b2e49717931ee565a77d288fcaddf74f309ae7502cdae3d6d881e22743e44101877f03061e8da08596592c6ee86a1830c1ffacc0a8c0777048583608ada58e1701a8ffd9d25d3c8d69b323b4fcfec51285e18d4b44d2c4234305dd34c38bcacdcf389788b89235f0a967fec72adcb8b03fbf821068765fd9e9c0830ccc07ba3206d79bcea82febbf498d8ae30b64216cccf6c8d72c48039c3de35d534710c7bfac59af6a74e166611b7f0887b5c631099542d45e77c891890d7c481357d68bb4a5d6428796d22cb241e8e44312d38cf47719983c5ecbd29a37c925a082b4ba505a58bfd8b7a098c29e8088e2659b89222db0f3dfe190dc8bdb78562f74089c4b1fb8f03a9f51653c5836da1a2d019745dccf90c9b1bcc6fc75be9d778aa06eb6216f1f51b0ead589ce8a74aea3bcaf5af77ec5502695c00f0ae1757648538483b697539daf236210496a21ac5df69d7d69ec58a5b4fbad5541c32b89d97f614efdd6e848968f25ed2ab9b439ab6dffc05212061cdfae274a7157b30ac77c75cc9fa7470c1f44726285dcc8fb6fd563dca55b61f2f6bd6d3ad2ccc0d1916da41095ef1e7e5db217b96202dc39bcf9b718885c0e619892d03f935384ce62d9131c479eea349a436c522a4becb845a83f133be432d1402fd094ec8451fc22b0d34b083902151ccc5afc767e503a8acb1806844897e140d53e817fd3fe91706160e00c0bf42a564d45f6df45125c337ff48091d8abf4c52ddda821acd9b5e3ec0c6fb4c8e0878b486717a7b51d2c372bf9208f004f270f8c0ec508eb69fefc558ec2b72d1c562911cd09a52feedd4e21f8f5f17e474ce07c6c44028c3cd37e8825c91cd5beefdd41bec90778ce89c88ec43369d380b9e6aaab01ef74500b511b59897922c88b4bc489a2b08cd18d4ab8945948ca7ff3d12c9edc7fdfd2e770c172c04aa15e533293806de723232417c673a45dd82f49a6cbc5e9f64562ddb641962a15e0be92f92b4854885da1d0f9c22fc66885ece9e0f0d8d550366094b187e66c5aec4fe4b451db2f753167477d5dcfbb3452a6947d3ef49ec54449f3b0d29c05e5fa34b877cf66690873228b0b374b8dba294c7ae3c00db740f3f63f0af67d9c87985a0cbbb1fbcf5c04d2a5fb1e772888671faa5ad86f5448fec13b3c3fbed91d41eb1d7dfb6b052dc21e0f9a5f8d6b534b23c8c45fee01d4154cc2a9b7994f16ecbd4447b62a3432ae80a197ab7d519ae55309c09fb4ed13bcf1961ef98b6220f35b17dc2a063750dc998d6ef300ab05e87861f9112e1212242a74fa20e08ed8700fc465e28b81cf673abed3e8b87410798d13e88d70c9df9ecc1823ade7e6086fe322af79c114a5dd9b7d23df1621e2ac73eb9e685d9a61a82f8028a89bd206ab1fe4cca083ec13b129a2d0b835e557a3faccc9342cdeaa220ef4e8e146ebf28e422f036b381e0b173d311c0dde64de10afcd48af4d085ac903528e7e684dc444b59b0821e36751200d020ba1fc507d44ec5a12416a7c03efdd52520055855d7039320b25d61fd1b422c79f5a3cbe29613c6ea4b948b56f31f662b4fa47e0cb09bfa6dea0ae68a86b633be397890cddf7b4724039b2ab149a59e6c83027cc701df2a3af6cc96fe67e9c104b1f9317e2f3b9bf64d64515bafee67161d614ad1a343d8071267d926092c2236d64754f769111eedebfd2fcbe8776a472996bb9d7f4184e0ec5803f51edf98babaf44d5689ca7225b2fc7cd4ee6d1559ff5bec109c8d2c26cc163782acbe22e3ecca3e6241f0d39b3911d48a95aaecaa996493e7bb49bef2e7e7898ba632fdc8dbca7883ca81ce32f75d23c595210b14cd54995cc9b90ca87f1fbdbd4888ca319d9858cf07288f6f48f9627d793364c9366c3c2071b7f5bc6da0e4f25af1aaf7faecf831f919414c80069c357d01e5293a4a81a6cf2eef3963598f5ee5f53590d6647c23cd4e6503738aa99dc775109226c15b43a4ef243911f5c301bdac1aa6dcba10edf19872e6d14663766f5b0603804ba461666e89f6e2bc82d3d26c2d97f1e5dafb1df7ce393314c6122e5004b3a97afe816fb3567e1afcba52da53727e46bc40abf4833a66ed37895ce6bcc85fcd11373ffd9aa64fba80e11d61598264053e9f1ec4187a34987f5fa3437001d12fa03bfd64fd06dc2d15b53799e3bc9189da0a1b964a050c2845745731d9cc5b723e938a579f532d242da872c083b46860247aff1c7b661a25f9cfc211427e7baf4f901d1841ee7285c119229310237df3ad07799bb3db0e99c9cf79576f94dd07bec4f379cccf6341c9626e315cb2c6db89bb6e6d89e569214ed22fe111c7b4d195806ad80515fce4d0600d48c408594bfd2bf05c1ed3081c8ab3c2f479e06757763f9a3ba7ed15891ef5918d21a5626400f469ac7b97e8ab5872da6c5f40424580fdfda084ae01b6d7662e2c9581d74fb6fa467bc8d9471ccc88e6417f926d03b33427a1fbc47ecd7f2c9433d4e5ef8ba5e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> test </tag>
            
            <tag> 斜率优化 </tag>
            
            <tag> 树状数组 </tag>
            
            <tag> 状态压缩 </tag>
            
            <tag> STL </tag>
            
            <tag> 贪心 </tag>
            
            <tag> LIS </tag>
            
            <tag> 博弈论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/12总结</title>
      <link href="/2021/12/13/test2021-12-12%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/13/test2021-12-12%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4aceccdc1b355770e7dfe5cf2ddd4b7f41ba444da9af8da97cadd25b10000008">111e7d6409c611e6b63fd1363c3273c867b615f02d1a730432e2fa9b72bbb2ecdd91f4dc45f3966a10021ab68bdf2b333f5fd5323b6b55ac505c90c5c87509ffa4416453d1e4cc1e356f9a66ad2a7ccb341e5e13feb706f99e1fea7f60af62cd7386860dd2a9279a1fa5b54ad3b9f7a582ff6fef18f054fadd023136acac068b6c30fd18a880562b8c443218dbd6e8973736f33ccc3afb7889e74d40812fbf7d3b4e46e353ffac721a19c14e42a697d7247d84c21c27352dede5b28abc7c689825bb7b1ec3e8a8fc8e0303afb01cf86df07d1a7319c9c593237f5e213dac4395ae7400693608feb61f9d3e3e7345720d5749f91e0e9fedceb598eb8e560545a4711fff18fc9491c21c6c9ca4d8794a8575b0df0291ffd96e00a2da8406555082aa8acb4ffa63fdb484e1d9e46ccb3226605b42095ec7c5bb6d6af07ca02c01eea57eed539a30780240725b2d905e49e8828b4fd46ca50fe0ca9f89243b5416a379dc2309923915c2d2fc183b44c3c8d3763c818bb6ffd8853474da8bee5bf74a3108bb12e1014330d468ceb46cbb5d5670e04fb79022032156f3b27d8b79eddc9d782743a00c063e77343cb02237f8219300ad1c233c2375f95ffdc5a074b9a485f2b941ad42de6d75beb774a76795ab1f7236eb0d1dc82edc6845b99504dc1120d05fef50fe66e35339f7283eaec9716b42f8564a163b012c379ad134cb0e1615c3708559f60de21923dd7441cf6124fb94a7b023399871259f6aa7e3d852435dfc9ef22e623daedb0462f7a88dfb188468a5f5ad462f1a6a9a1e6ebcc368b9ba088afd745f23e459be1064e04bf56b72ebaf927e51b536b6ab673c0674452c519069ea48029742d73b97f46c300f3100a0136169a28872c394055c5e63349b53547ecd2b204e8e94ce68c3bbf7baebeea0891ca151f669d641e8af148b904cdaaf2d2f1e697fac5cd4a6f07768691e28e95acaec8bfbb4f26219025526757d4aa280dbd79b384c21109003ad547c5a89151d6c321ec60ee7ac5974278d95ee3b39a0568208009a4fffe6e092d831ef6f946e71426e9da7a1c86d3bd8a7db8dd1fbf8e7e709355037c73f1e79f17b7c03db22ddd7bd2241ead0667ddb8d3b95208f70c5d298586b8474de4a033b700dc2687471e5cdf726b9491cdcd5d6507ab2e70340b1d162674c36d0219f081307a9663f455dbc03048cf5e163117312d821788b51f244dc79863f897235838299168a4d87eb8c70bd1da2f4b1c609f6de917b342c2d5ddf4f82e3837de4a07dc410c69705405841c09551e0ac60be7983f7f34e510966dc21b0c4b7e49ec6156e16627d1c8744a5beb5a77fa5512a8842ff4969f86e9718c71aa13880f3a92c6c93d11be840e8283cbc1513956579dc8dc0fb58f827bd67665662dbe57c8889fe695c2a325bde5a1cff4fa4152da1aa78dc327ab75a5d6fb67b02aa36e8bd5106e8e2a59c255b0f087ccd2d05de4037080afa6f52bfea8f2873faab2752835e25552141696bc41ae3c6251db2e2d1da84bb7e66556f1c5f36cbdff3d67d82ed28001c02c3099deab7f69cf6703cc0dfe0b1cc7a260d232d76caa269ea8f6c99719f3a63ec886479b88bd7678f3c9231b56bef822f5a77eef70f80694039fc58f2fe64e9f0bdc777b073478625a67db36a6b5c7de24b94ced94ff3fe1faf0f865944ebc7d19042d3cd287930b6e32eba2d89a1979e2279c0c0f8d5a0b6f70ca93af9fa38d97bc4960edbf6fbcdccf19d286bde7f19804f91761c3d6493cd3d96e53d062dd0f611ec5739ac81b27156e7f642559526a6ef9fef6174db9bb529a8f5c3de48d7a1c824b5599f551276a419e11ab553e0ca72a731d43adebf625d58c6e06598d83c33acd5c4f18033c7415e3adae51a60a390f9d6403c79c7875bdb5e44f3899064b0a89e85378b2ca68b2796e374920e875fdf8bc366e305122a7cf9885e686441ea9c406c0f940cde9ba9fdb12bd5ebf6cf503bb45a17d4744df90d7d3ae1c5bd9fc8fc9478c9f299db448881c437c11802aec6f9f607919dd92403cdd52304b43ebd1e0b93209b4600897da5af00f5c5428f037bef0def3029ac1bddb9e6314526af9e28d6f897fc4307842d63b1c2ba78c8724183e03d59f757dcf625fc812d0806e0c5e33cd0919066d7a41110716de7dd1b57632fb5407b94775df3544d98690cc5daea1d26708f5531efead9577720ea14b2a232157bc9f1763d86d67eeeee9fe03e4d7737b21a6f6b6cf645dd4ac6de452330606be27bbe58ad6a24dabb71e00d37a31cf101ef84fb21f86dc00b60a1771dcd8e8886bb0f0d58c7e3b440f506edf5002a663eabacdf0275853a9c725cbc6b8ba6bfabb2caa6b39fc13ea3420e0ab20e0679892d752c213343c75428f45a6cd91d82c8bdc3cb88085c93baebe16f74c0670ce4a9e9035bc2485ea1949d01fe1a969f64e7540e9a626a8177efd2223430c7160e7b71c27d6c02775135818a3e36294ba4268446b53a33a5274747edc09f2a88910cc3472afb864c4baa4610104f7688834c091e617a0e5612cf95ad68f1f27bc787eb19e54c942f3d34b80b80859fcc1462eee0ba9ba5bd234e03cdf665b3cfd311cace939653f8d9ddd9b9f5c085c3780722fa3eec37ffb3136a2e4b592a086d8fcdc3bcdd5c217082d7a291ff7f2e3c33457e5203c665acf80cc0cdbd2995b1b9124511126e779471af25bbdbb71a4a37398a0bc5c676526d024d9df590f7cc0513a846743ed04172f8ad1218275dc8411fcb16702a1ef109f2a700db6fd41ce80db29959fb5779f38f7bba1a2d8eecb9f826cdf452d1205ff42d9674d00285f4b836a259acbe9f065800e977c46dcd083afa2446bfc927bd632d28aed1c74e11f0dfd0484cda1664b7b42e25bddf3a7a78424173dbf2de274ef69b8ab9362a37c626fa1bfc755d3ff75f69468d09c9dcfec4aa24c4ed8955f7c95c9842fd06fa7d6b36c62024006a4e9d13c57402f07a2951dcf349a573c0202f932335766c8df91261d9198467465058b44e670b994bee83603f03263a1c57bfd5a4099ca517bfda43f5ab8c81ce43ecc6bbf8c309f6b965e06cae4d7502de2cc098c54d7a8634d526272de7f8176b4c2dda25416428c011aadab09328d86b74016865d486fb5cc4e36c9a187c037f977f61990fdd99a173aaae0f8ae780fcc08cd12fed75cbd66eb76e95fed9140f7644f551d3484f643285e1523bc2cbc53cb91247fd20af14cc2414af5adaf36be75f51e6d57d62b34e14a857456e11f857ef89f6dcd904a995478b8a385b8c0cd1bf5d56e603f6c945fd1cb73897153594976282314ac0c675b8906c34be6f6b0f906b85505023124b286d5956ea48b48b17f4cd7139624167b2b512e28298067be79f85a8249a4d0eb7c98901020fd2dc1bc3631c538a2a0683951b66ad7b8c5b8aca194d7a8358c12b33c59d2c6abb2acb6a3aab9f2deb255fa28948402633b32d825325b08292f949cfdc01069e8eabf4ddbc226f428a59fa4715059e43fb3eb4aa88fea0586eed7cb880078400d82d2cff984b6aacfa768470fae0b90ff43e02e7fa24d0ef7ae3cf65465553a1fc304400c0a486828ac286595fd232720e7c32980ae156e978b00c37867fb8f06ce810a29503aadf30cd04597003c3ad1117b8353250e27884c3d0eb2e81c7c631f817dbfeeee9881252115725ad98b78fb67aad3320da017c5f0338a0d336ee226b66b7535d78c97b94f737782588ed11f52a515bdea78731c3ce2bc5f80f6b3d35c3ff624e5dee0388554626d8e66d27697091b9bb05877e0202f8d28dc19619b82c9066d7896d6ee97d0210650c53a49b3cdd15ef3af80f2929ebef065f0efb25a9db54a4fbf208dd1d51d3bc9500850ad736e5b27ac35488b1060d7a13001b57ad5394128609c0ab799ed33ab4f9b566265bf7065675ab8c05e7c77bc07694e16e9e937fccdec5f402845818cd0d46d67b456184bd74da5de4faa0c3f131244a7b32224416dc2172bc70cd0d091413ca2a1749189fe1a7109d0baa8f14ab21795776ce1fe158dfc4e8ad5ddbb7814fc6498d071e476e6470a6b0bca8464750f82038bc235bf77d275d06fd826bd29a02c945d13f2773c818c35629661e1af15d667c12e0664295982121e83a8d4b848d52e0009a7848234ec60a2e685d6bf8d80fc9e806be2ed7ea69ae9a40c6f6d490dffe15d0d6b881d951d0adff93193aac58e15837337e5ac992ed78a885212d6968dfcef3b61aecf0ff692d03a5b47db51eaa5ed4bd649129a9f2f1cea96b5342faa8d73435ae41faff9a25ae0a351e110575635ffb59c7a14b91cf59d58a7e2f39039b624fd07c52e47b193d37b0705a1bf33ef2b97a0bde1ebb020d58fe27d7a65edd6541200e4f767c9a9d1e746ecd00634d3d67978826329628873db9a456f0190a5216d38ff4c9782d94f493dc0a58aa8efa0d572aebd458902bef7cd3dca96915883f64642200d020119466e7837c393813a2399d018513108b706b4abbfaf5e60cf99fccea177cfe5e3482f61d8398570192acfcd1f2eaf8080f0d9aa4207b9237792a437f3805906948adc28158156879281e6a807363c994085c205d27b98bd6c244aed4201d7a79d0fe0c169038b70726ddfea44a058e0709f4dcac25489977e8511b519606d570ce5d853aa341c3dcec3285d41cfba7221a3706516f7130bcbe675639af3267d541a8a7a542716da8fcf3516ecb6b6fbc229580a617cc80b4820f05b66d703f19f9cb03a660cbf19617292612870b47dba7a5034030204a5c145f61fa200a5544725632e18eb4f6f8ff939aa779e8da307f0d395b44dbb5d7fa3777ad0ecfe116312a30416e5d491d0a90fef193aa77e56c56070323bc7fe132586d0577e22ccce493ae5557c1b39913d80ad839c9f8b6a8d8d1e66e88e5b53306fda6fbd7d6ef0875747262a9f4edfef1db71d2160b908623248ff2928b0bd4cf1b4aced0d09930eaf88fc10edbb067b0b5dae3105d3b7958973b83225ff9a7a5f48041eee74405286d0c88f9c3fa59705aa3373a57a30364f71efead246a02127bb00315a41dc604c40845d8e4f1a75421ca32818b5a164c2fe6825b043097ba6e6d725d23b4faa1b850a3568fb529cd8d84fb9606b19f96f02fd83706b338d0932ab06292400e2cd3265a952bea8beb5d4a1f507d52d636fb39c19a5a9c887501ed32435df30876211ff62ff099ec50dd082f9bf631e64871e45eab6aebdbb054be22bfb2654207a8953fad876dbbe5ae8ebf6538d9aebeb1f29e1afffa475b7dc1f14ed4c27f73c09058db1cd88956cf51688784127e7ff0a28289a4bb3277ac61d21b24fba8c52b4795928c1f2b941eae92f561537fe6ec6ca390854d1cc97685e65532faffae3625becf92fac7e4d5611b58e26666a369554cb5a5744319e0d686332f420c196298b65a517c893f87c1cd72240224a4a834a144f57098d66b6abef568c3b1c8607eb92014db507b50e03ae21b6de2fc26feddfa1430f4757b6a50ade6a1b0f1425939a427d515e5dcb8b33ef11abc7c7bfba73a9c84600dc7135dad6a0ed26e8c92cd7c1820b66146f1fdfd1f85d330656b96b41e4dee0095fcbf6f66ff47ba010e4d79fa919918d9a185f75024c715a326eb1725b92c6c5d51fabd0435c78d73535c0306e9bae9427987005267d21550f91ce07f4eee57605827d6366aa2b9aef0d1d87547283234a08a118cd3db2de34778c73f736d0c3e492f99016d3d6dfd4d05d9b46669299979692f2f92c7d165e3d27379f154be54172014ed54fa04d59d69fe5ef2ce47ccc3760916719bdf8e40c076dc219db1c46e1f91fc67cc76e96b1ebd393c97cb16b2c3a92beb239a735a7dabacb37bcd20d17f3d97379f18c6d9c0b204aa9532a6d5bd3b75264cec71352157453d2f3a44daad9d6d67c7649266569be9baa9500f43f96cc5f735e91b82a5c1b20f20f2782a21d5ec7555bcf23aae7115063d84d47fa79de1ea953bc90a919f6cf3558c3046e1e7e166e94cc46eb8fe46b1c1136604936bcb65ee5420480acaea1b1ad83a81013567d694791a425bf3c84bb036b7cd47849dbacf9b612edda6bf82b63d783b8d28770145ab1022b1d434f5459833446963fc53c1deec4d012724c3d99517008978f2839f41cc5e13140588dedd498876931c59831fff1e6261f260af2368612d2ea9726181f5a4b2cc7aa0d5811810ce5c16216f3dcb018d26bf30e16cceae19127629d32d2c5291a4446b177ea1f44912b21ce1ecb0c070e8ab5bdea52f23a7a7e14fa531df6dc815b696581e173692ae865ec1ad0ed83d9fd9fcba6f32b1db8b0cda23108ab3b308a963d416dd1b12ee9bce92e46f9a9d4cae717fd356ea2690f1fa728912e03ed2074d5388c85af28a3cf4ff599309ce2329c707c39ca0262d809d34d1a01fc7c435572cf72e3a987dc8020d06204302f38149e95eba0a16f94d031491e46824ad1bb48b9c93784d74ca6da898478a9954bbd7500b5d497a23e5747e02bac7cb1bb34ab588986f192b7a706dca705031e6f7d74ce98201ab5419c0c537d59a58aa03cdea27b7818720b014ee0b7ab4cd0a75ae005a2e1e81723635f39963d02119951817e08ccbd12f8b919273dc0fdac9b31353c38e8ec2625d5d39664b448fb5605b8206249dd199a0f4ab7e2163c690ebe3e90838399e3cabad8641460b871a44cf0297a84fb0add2eedbc6b2a9d9f4d76183eba649f8749d81ff7024e1d8b7c205985989d1ed932c586204e378360d959438743e7b489ea81303f42943bc44998dc7869ee2e35af27b9928afdc2ae930a16983460790ba78759c8309f4c8d704726f6ea70572fd4c098f7edd81492b55f1a3b142e769862a22099d2ef576e04a076cf4a5b92c3cb8f47ae5f022b8019fde86da1acb7201e8de48a83d5250e03211f02a9be8711adf29efe884321d895cfb978bbe72bc019655b4dc05039b017bea3f090ec3ed9a70ea881ae0c03d3402d9d1ad1ae0f39134370a16635af6406bd01370f390b8a0729514776a8d8bee1aacab87787f210c45a8dca2f6f949de5ef6ea3a23193efd29214362327c924754df2468da728ecf4011ae2a07a9696a5f0368bdf68ec82e54d6ea9d1c2835271101a605bc914ec90f4151e704c68f3e0dfaf5c33610387401a6c46c3705482f41d180470869dc0182e4ff0750fb8a2f2a23794df9b4cde1c38af18e59f6a210af39f545ac97f6483fe53c78f965836058671b1007bad5791eadb45b83da56fec6bd3f573b33783dfd00532a40f45ad6d8edbf2ce4aece7762b75694bd6c5c67885aa3cca1c62700b6e7296d879322b3035012030963146136124034280979df9aed47918ab5221341326d674e8afbb376b511793db48b4e042017f051a7117e9a960e41e971e96cd92038b8c3754ea1aca63eb2c662e3af7d18d35d3bb4f1af3f6ff34e0e19c1e1b05f70e7c04f018666c402e069c1d5b258cf29643d80dc672f9572dea39f510a7d69a44d766619f238577f471e25de96a30ca812e5af28b4e79338727516bbc06e95aa7d07de3cad1fa2e0f35fe9081ed5d2d7b39d23b87382a122890781b9d6d78f4234d501982429a8cf8ba4e1c521a8512cab3ecbea2e842496cb15d9567998ff1306d76c4b7aa8a419b396e7ae4608146f8aca8bad5f4f364d3f48667f633ef341dfec7aa025a2becb40b9a91222dc71a2d2052b561811d29eeb79983b84b5b8e13fcc199a9515a7f83054e662026100fd72514614353b0bfa48f5934ad01de23daf1ff724e7bae7b97891b42591ef9e6fc3a563c71764d5b105f38c7a6e4a731277ec9ad32de7813577bd0327e5059bd24c47c86520c69bd3e1816c916edc6234d9f53306df363ee8947498b4a63d3e9b6a1936bb9af22ed76e11a150ae551df0f7b8ecd809312bb492a25aae7b171d82706f2065ab57a746963526527272d1555eaa96dcbd94edae60d5a2a76ab8635ffd46c37bcd92e50b2c7e51f8ba4fb893b88b42a382a0e8e8d04f5d590d940b86f38d46eb6aaa2fe8e8916ab6bd91dca75cb93714a83f840ce44a800515a8728dfd5c35576fd8ed24f70ed5b3cc59825f5abf65a665355bc9c73672b377dcb5f57ad6773863fbc181b1a4e599424a6c20d28642f8eb4eeebc194e658c408f182961b748ca60766c87d1e2a6af42b34b6a8a35184dad908816053453aca3fbcbeaa306ee819e56639b298844424c0771ba6a5ca0f31106931643250363d25115b013a6dadfeae04cc165fbd29b74ba48967ae7cf3b82304739b66c1c54bacd2c5ce26151d2252bbdd4a8830231fbaccf16bccac89471df705a31d039a84591be2d895ee6167baef357a490dd5cffc0a6ad7993c519da6ef4017d31fd6fc80403ff54c9bb40e62ea1ec312e1f7bbf558d61c578f07581718922e3fd052a3858e166340e84f11a70496de116dd94977235e76200ff559fb3bbd449c3e79117a02f270b81e95656dc4d9f4cc7eeb82d5a78ce786deecbda4bb7e894c888c01373b2651cc79d56496206e0d3a7f9c049d3e6ed4cf6729ba1af8b594cbb2c2ec668dab31e219b31d914b08bab8c1dc0e0d02b564dfa8252bd89211917ca5af69c5eec86ff32f314b3121a739601fae2c5ec665e336186cbbe653e090961bb1b6a6fa2fe6a748e359fd6cdd551e0f217f94a08ab658b1d30e44c5adf71133becc97811d1eacf561e783b51d6a32f5d380167f2a43c69a288393779c67af1a527b4b71687052a4db5e0e41ab4d6c911247768b288b258d3d325cbc2d3512753cabf376929a7c544cb624b7f02f8779fbdf7469a0883fc02f53a8866f103010849f56435d792d1b71ee18ecf368981d3ab91afdb5707f497fb11bb5289e49fc18a1231b50bfa4ae73fb953a54e373c803caf6bf70a14c07cd641c7f17eee871b82baedebe8d94f9eabd2ffcba5a2c4deda57f40d9cdf3c2a73fb295e815c2b01a11db116277b0d0e35b339fb1db9f595fc304459d405360bcfd7dcf1bb0c38ecd047de20f681837ae1b0c496d0fa635394ec2938779c87fc70f062f27ac50817a9ced9dea23ba1e7a57e30596216a2de4bbc7f2a97f13585bbb00bcc770db204b9b0f824525207d31332af116d6107a1ca2f73695d50c762bb71be11558608f52e08d857373ce702d22e3723c6add591818544581a39aaf1a102f283ffd0b52d4385aa4779e732c82c66eb7bcfc8580d0b1d57208e36daa6b1af29aa3a8bce3e7ee6d728a8aebf904f4236db0e357e1caddc0aa829ea1d897a1596823b6b1f295d9e258a0c4e4fdffec097a3bedeab8b4d86e260d1411345ed968d843c7e43483e25424484704566597b0b9280e61343671a97c00d596512e0e000b4a5b6f8105a05fcbe7aa6c5a98686899b8559af68870b2f4e26a16ffe52b5f7eb9bf156edb269defb1f517ddffba2349c9163c19b678b487364bd2e5cdff898c4ce51c4d3170b082313d174a005cf380144e99ba431b6756059ae6439322b5bc21d0f52e790f4a9ceaf237324abdf5f63dbb99b5886df5d545dd13875b65696d3f2687254b2695318be159087e8b1a8d271945a4260d6143eb7623810715277ee065645fedfd1c6cb7550bbb5e30ed8424df8d3a7e051db666be74dbb606cc0900aa45ea8c1cf24b2de39c8b2a9e5ba5f3b0728af35ecf01880771aabaed4cb0af6c54cd7eee2069a0a7fb7bfdd42e05dd9a20b4b5aaa857f05e68ed40e53ccfd45ef17ee5761e7a8a20b9500f7e5d19543c4da9be0dba77bb1c645bcf516561d28a404fdd8083bf72acd60268617cefd9bd7fbac75e6cb830d92ae2d820a3b419bbbf8d8ae319269f740d62a085163099b2d49230792ab76347af3b95d87acc8646181c0e06ce57f11d991fcccbc714f23eac5c2617a88400db6ce1147cc995a4895ad83feaa7a82b59684bea1dd2b71757c5461cdf117821db3fb01e507535594466afe519bc616c04a9b45c2161bb315577ae45d1b40c0365c7ba46b13925e5883b041f502d0e1661640ca9bdd7db76d0c421c9ec115e060201675e28d326d8352ba3d12204a2fdf53ed621feb0081ae828147513313b46e91c1c5bf8d4c902d1df685f9f45457ed95ffba3441d831d39492ac8041127a850dff397ed921722d62a7405414a653d385f59cf1ff44e93d0432343ed735984e60e72b3d54e2a2cf5766ccd9162cf07bdf07cebc8acc2a8b5e5155e1aef97a8c3af8fef2311076cebb4bb0dfd904cc443d7699d8ee2cb8f7895735c94962b59187b52705292bac29a8f262d738cf10b4be4b1924b8c728b5fb16c1186106c85d91a7f1703bbe3e032f6e3c30b702a06df1883a51c29be433f28f99f3be1b688113bf7f48a7b831946f87b89c8d3ebaf2f1f3209085c4a73776081cfcd9e1ab7466c883d1d6c3fd63c513eeb39fdb8adcc9e8bc8232ad2b91e58dedb93d7ec0b843ade503b0c8d306ec9ec90b306ce860fae13caf26dd27c37a64469b59be47cdb797f7d5019999c790361cfff9d92831e1284c38c18ce23ed608de49be4f4676c7b291c86943dc34a937b73a66b5a61682fcdd9f0efda41e2834420615ca0ae81dcf785645f95ac9abc4901857aed8f0733041d32b0fc3f869d484ca7c0e2b23487b08c74c26bfa6c5ed7e624dfa6aa6661f5f42a79054824aedd1cf50681f56027e67e5e8f5dfbbe56b551780368df2e6991b14b5688290ac9807b34062fbb0bec823467de44503aae462ffd4c24b383f844767d7305ff83f19a188668134a8cb749f86472dd5dd9a069de0a75998bb1b278f33a6fba7c715f28944307ebc74465092014cfb3e7125ba1419798ac51bd41763487603fe090fc02ef45e65d940223a3f7e84e968dda22de32808898d6c7ff1705cf4a0d925e7cb89bebee4f249f42325043cd7d75bfa3fe08082f6529d5518612c1ce0b89cf330939e68cadf1ee665d0e25eee143b5fe3c193d21907e74458de887a525acffff34e26a970f7b3b8ff909416ab2298aaf166db83dc672cd725f59ad5722d106d9b4df0807f63221b79b706bb974b086c88691f62298e1b77bf5a5db2afd02f0a15dd67bfb058645adb8b741148ba0a0eef744374646128e01947d01efec85120926b5388e17eb68f294f7865e6752c2b4310328e3ee869201faeb6f161d49619e3ab10934e5eb34512b8ed31eff5326a142fb9149d79ba495e2d4a77984858d063be2a947c82c7c9fefe7d5091aff5359d87fbdf6bc68bd6304f6d3a45c5ab495e954c018c023d312d27cf6d8c538ec443a267cfd438d72fc921a69554f0f57deffe42220ce29ae02a5ddbfae3f8cf05a98c3e16abb172fb34a76bccfe6b2682c696de87068a4f399fc9d4cb6dd794016e2ee22887259ad5ba715b86df15854fb4b4806147baf5485ed253d4f25de75c44c3af26a3023be76872a9efaa782a8a10cf52d9f0fec8839b786fcfb94b3f305d63e3dad8b2587f8e776231d31ecf378e109e11e6f64ef0a528acb8548095aea38b4af8b9b5c579b9cbff74b4e4f13cf5327c3e599b1cd13d44f4b3496f2407d6417c8239adb0e745f5377a9fbe671ebada45c5a37074fc585da1e9a5a8db8c39fb1cb909dd0aaaaa084e5ca2ddaf0eae3214ec7e10ba68fc2742007b485ca3200fd4f6aebd9e4901cede5a786ab5f01f1559b551572bdb4615087c0beb86e5649e153d5705f41ca76f087c5e102b897d0f1e1f36b499924ecc2017cfc7e8a23830ff76e2e52f945b8585a5a7e9eaf94567895fd975bc5a01d807dea258258467eeefc15b014ecaa33cc15602f286a96945b6f0be757c08875e33e5c145ac83256e4b0e78c5e9530edb8822eab12a083e4eb89acb26823a4cd180a43beb4d21e7f1c92389c03cb85329e94d4fc49afc7f34ac0fd0d416d20fcf882b4dfa162f008e88c85a97b52440d86ba6afb960061a9caadf8d1e4943229d1518906288e019a7448141e758e90363e35bbb62990a7da2cc23bc308568c10e0d91ed3b45fe3d1ea48c1d7fa2b9db245c9016fa49a45a2fc1ac6bedecb505a59a9470db1e88dfd4286f3aaf03aeffeb39d23d4bc72376281fd3f555c77f0fc4293202c2379ba0a93736d872d1cf39242b9542ac650b4f6250a82e34495108f3af68aba47289708df648559ac7af44e9f966e8b6b9a2c8908891bf65c0d12df5d8546a5104e56c7c4a81e8b6e48deab2400a9ec2b0098924be3d19a3450e738311312d9cd2bb726cb340d968d28459e6b2c89fe02e2155eb9855c3d53190ff08c8abed72e2ff71cfabc43f890b1271039999917ed75028956988265b4c33392559d3405d6b66b878cb1bffdc2fee2be367ff9264b2c7990616514d033a9f1f971ee979e4d3f161fe84b3b6da122f4c4bd75944fd404900c657b2f1a90a13dda1277b2e0eb75ac35dc771158bbaa0039f521114543c3ee264a9d875dfca2e8afce776b23c3754cfe237291531fe246ac7d1fda62e7ae531e565ab7db6a910ec3def71466c60c5cb658f22180aee47c398145c4cd3bf501e0e2efd22077724a51227d37f0d2db1302b285946e6b2e9a5c6bc41f9bdad61efc56437f3af235ce453de42a4dc25908a6d1ea11fedabfbe2651b6483f961287a7696988a1fcbb94352053d3dbbfda7b492edf5a3742eb93acee08b0e13492a5c031f07360a41945730a744ee34e80d963f8422889bddffddb19a9fc795551d829cb805f9d89ce368091452a5fee1fe2585e7795e9f603ff58894e6b47c5ae70e438fbe97d1bd0a2f814f9897453de77352116e6a8c14ee624dbdc8648f2a463cdeca61a826def56bda442757bdea78a60de4cec82f1bf3dc8104455b781b5cea4a91ba404be6d9e26e171ad3c51a792b6caab4664ca4d619fa7280ab809f4e3a1569b1b66941309416d9e989d871639b169bf158ac6435c9a9c7d51c9c33b8559fde8a6fa15307af4f1e598dfc098aad59b3938ed8188edb7f7e4dbc567988fe49a43c857b906826a189942f58979bf7f3ee637a30367822f27ae9f258cbcc34393c93843d26adb7c68445a0d54237b97a3ae4e8fcbce3195f99629933167b1d85b2e02086d192a7b7d1a879d91c46db202f17111257b832ee44d1594ced744dde01ab3ad383ba1a42d9a7d9277c2ea4ff0e767c1bf840130c486d442af7e0b4d75e7f69c52d8e006cc6317f802624092e6f7e905283b3471633d67a1996aaf714baa4045dfc03a614d39c5fc74c196a4e3407a769096ea895c14dac96e584fa7ba553b41efe43e50b8fc616f3cd85eccd2852795b33c8d14f942b00b0ffd4f54d0a1da75dfd25e8b8fc05a67d68d7d2790a6976000c7644e320cb731af04a0090b3f9188579e86604e0dac0a153ac760872bf36911784f62a48e93c5e7ce3ae11bbd3dcd0d172a54e45bd9f9d13c6478670b2f02a99a507f847b41087ae13cbb309b36a675e4579e10efe714c3bfea0fa20755d0944900c2ab741cba933c589a5ece559e7663ccf507164784706bac81de74de067d63469ff37dbc20b083c9b08264f7f0e7fc3b5bf7eb0f7df2fad4b74584e89cbfd2f8647540a8d011998ade7add1d58230a0ced1e43908345563a84f42b6edf2b451ac937f096c83573127ba342763814d1e4b84e46a9b9ae933adbf1493a42cdc97ecdc145f592936b254eea15b4277521c2040c092a75923190146772c8aeaf047d2249c8b69bd94b1b41f66c44beb8f6945f9b01f65bb55f70baba1a76640f568448b0a39dbd8678d72a64d1deb68487a5616c465e7c3063417586c7974fb90f8bb187bd56f94f47aa9853bb6fd974e8a6fadc39be0d6ed6577b590714118160bf80d845e4cc83b525d0f524a00ee8f141450ee044df8ca6273193146bf8121294542f251805021e922f30fa51acc34715e74e856c01514dadb7b75af12471f0da83eead96f72467028e8c503ac63c9a4ca85140680d7648600e631519031d76bf97a1b03040d4bb95a9cfebd2a951d543e44fe64ca4da58d1464be114aea5ee9dd29db4f850b0d13d2e012143aca656ca317e16628f7eb62bde9dd0dff741398aced006cb40e32a3b36c89c71199f6fc80127e1be487a3d73cd5506c828df3fa8b8aed5c440a82d7e3c6de7d3c35eee9d6fae8f06b1fd63ed30950afad444be1dcc0d984b0cc3375de43fe70e254b9ff842d2020ccbba01f51a97b43ffe9876962c64ad34f498021b4a1820373e8aba50ea9ae5a685362d97aa92569867adc293f917009cde87b9f142d70230280b216d4ca847796c2b7b5b36d1d05c7f66da0528e631043a702bba46d6cbef2d67f3be7c351e5f986ffb40a5f1c82276488b8d4183139507a98d503f064f5762bd8ff053ce55962572790a78c9fc0d79cbb8455ecf0b4e2bc3a57ffb59a14867ccceb36452c87d7e7d1c2ed62df47886a6d45b41cdaad881395f845a5f1d32c1a2e904e2a045127d3abd887b65d7f97286fcdf8e10029723a87c7c1c7194c1a57d4d5974150d2eea6f199f586dc899964eae3c995685a57377d12d17d544fbd1aa8d54498b553989d3c0aa728a0dff62313b962005287ee82ab9e8027a42050d1ef8c824202f10a27449e4ccd29a04672c3bcbce492dbc1b643e6ede03e53b207ac3ff624943e56a729cdfe53af6be9e73910cf284a4c9d1b44d14d29ea508acdce190f7238ee660d915d99d26d3044398d5ece70e79da585d347c7d50c007392e615b34831f0ab450731c75c1d0d9855e4b4d03fd659316bacc0d0188ef42e779cb72564103b2b60c443f968f12b717930c9f2c7ba358edff343628c428b65e3ec3f417826e0d462b514d607a39191205b1f7bffa22205607d375ccd2aa86178c04935ab2c2b925da0a9ff6c655d148c4041d5bf1032df7ae1a52cdaf1a4b9d3a468177ae00141cd841565a456de213cf06a1447522f3e3d32041abf4f6c2edac928d0160f28841191626797f947933cffe42af109ec61240ee7f715693fc400eb33dab874253f587fe54519d78de5b5ad9a21f9e0599a82597fc849dacbe319b9d339150323969d39a4c79a563ab3b0e4b0e9f55c2af87e11214106f1ac1cf2c9ffaf60315a2f58e899c5ce3159993ddc967adaa6352ef13d83a29ea0b22c5a709b17f7847706e75bd23c2692724afe33d0532ddf59625f40340c37926366989eabf68bed8199187e2e7e72027ea2758e27b81f8e03580f047ee62dbcd8ec1e3eeb981d416f66ec945f03df780d222080cd71276094aede53f26c1100f067b0f930c0d7ef2d42776e2ea09800bed969c10f263337394d043d804b5d4088b444f1cea51c52091592521ab92988e5df2edeb47ab922f407462284c159dc4c31c307a14d8fd879d29fcc9a56a1ea5c11b009bbcc5a51d81c72501d39ffc821b7758a49daf7e9b91e18b76dce4c78bdd02294f120d196b1cdd486d7d66a2552c0b03ae25ebba5b1db9775dde0b744fdf103dfef6e8952704a76b5a25f408ec958b3b38a76ed1d5c83664429bbae371055813c6920b01604bd0f19408c994927cde560d4db842e77ba6d0556f335a9f06ee00c9f83afdf0092ec8a97706fd041c0b675b15b21b0cc51d2a9bdedc653e9b964efd0d5dfa085a57f17993f6b2a00294f39ff3a0bf541a7cb8c548c655333ba9213789302d1dca4f0aa02df2dbe5e83f579d7c47b7345f9e4dbd4a552bf503e1b1a9337900b641ebe0eb41ce051bcd1f76405c2d73fa98621f676d6e6532dddb4b2d293b35d27b4dc4c9251733e37f99e01de69741c53de4e7508d960282dc933b5c8d6be319d3eb8ce1236870cd99a857cd53e22a22f5a7877eec50d8bf892ef19100d24168e1938702c07828336e0680b959364eecaa7d57709258b4b09b9e9b9e02ebdcf2a2ecc910dab7ac9814848eb8968b00b81a3195c82b93544ba1d985df018cb43ffa44fa6f800393abce3752d3eac7a71a9d253199f1e266b3b4c9f991d532392918ff9bd23f5d1d9ed730a39f5936fad276ced3ae8409bc7bd00de2a05949c9110c6dbbe186fbb5c77bb5404ddba24d5af0efdd7e104a8012d680728e87b75d54d6316df3c8a2995810e7b03accbf45dcc2088f09bd6fa6e8ff0d4ae3d3cff28e779c1eb6d9a27657e9514f69cbbc547b7d4697db367b8d0758d5be7758accf5333369afa006d219e77063f6f9737f41cb79f1d252e3d7ba63efcb4a83a10780927c3fdb16513f8601792e178097aae55b2b1f0a25b2aee6eb64319e5b4e27df37d7f79841ad4de8a7d6014fbec0f6093744772d1dab481a07f709f3eea97e8870e7dc88dc67066eeafa7c66245aee458c01fd71f796db548f82ded41da80cf8fab6c9f99f2ee153e6d95f9636de0d97f6d1c37e2f754c4c428c3fd59d44490421358466ba5ad3496d297fc1d548faeb9ce93b678ed5812800b1b7faf00977773340878e5580fcf73905b8843951e78825cd0bfe92100a93c2de14812f72f573ca5b6721322100191dd0be544320ff9d94a07271f7a1eb3722d77629c1772f9353862f8d6fac5ad5e1f1894f2f73950e0a2ce164d6576b14d8ce6a09ca0df79b8a994a9ac7b457d7b4d23e51de2f29ee0aef80d9adf0ad124a23a9aac7d3edfafe0eb97951e3e5902dacad2d36fc31aa7540d7f84d9e999162d7112379d0718387ef7ef58f1a848e61eaab76dfde6c6cf741e1550296ee45653a6fdacd32e12749a5ca33a9997b4e062fdcdc63f190989a864e26bf5bd6617ac3fe6deabb50c36a016fe470c4fcc52e91a45dbdda93bf4782d2ad4a7aa2e7367cc279f01095dde6cf5dcaa4ec7f28ce3a6b0f4a37a311db55d9ad6d298e00eeacc387e034367ca9b13dacb2681297d3a3d0f85570ae877d67475eea0bf9de6be570ea93d0b488f233d3b21d8fbe49fb5c1dcd4395efbfccdae95e94e1d78e2c21e391196b0b6edb6981a329f4a821de879da30fa22b03e1b036e77ed604f8f8e16138624941ca649fcc7c05695e34e81656b7512438fe86568c5fa7a81c7f483e1fc03f585d5773f9075fd8ba508d6fc48e85d3457cc930bb962198b851258bf76e46bdd0ff9b0b71323c872892861e798861b886be0bf3c8196f160511d0638ed4bf414169925e69364a1e0e8a95e8e215cdd33a5b8ca1eb30aee582f350316167777d117317697d9c5328083e582d25d15b7fac258093e08aafe1f68df7be3dda170ac3ecbab349e611e865c809ceb41db06250815feafa3e922cf47aeac828943fa57afce78b5befdae178abda503ebe0b69ece2a9f59c84ca639566a5ee0192ee644b4ccc8862c7d29ff59fa18c43c291c81183cf53a8b9039c832ca3248b13ee04efe20a81f6529cd4d0e443c7c0d7daa369a175d85ffb0dbb0963a281ce56d6b4dbe1c1ed8eaac898b707c4fa7942b989aba17b7d5d76e23ff5a49132054d9866ea7d233e09464790e7c2f703e2ae6a2433a42479c915bd47107477390dc6516531fd51812ef50b06781c75d672932cbcb5107566e4a61fbe8a7e5b95d998f64fc3d97e9f5abaa5893bd7ca965c0277b3c7057ec741dd373376159862ab1299229df3a6210847605ec0403b68b8a775e24607bad573ff5f7d9e3a90ecff5d45972d9ccdf47ae91e595ba1fc3d29039881190657b7fda653e4ff5ebc9982a4d537a3bc9640df60269dfbbe2b7c9223d83f0da7b6e6bf39290278017a915fdde2a2261750f7654d1356ae278432f04aad66ae1f2cd9eadfd84dc83507f3e2f79adc5a8cbed49bdbf2ddb11e60c1ff7e9ffa06081928d52d3fb8ed3e1a6d5d0983b80faafd1e26b328037d85cdb26a814909198514ea22959792e96b85f58f4e677a0569d89cfefdad26929a320cef6319b4760614c92be1463c3eebfb31a280dd3338a8b39b89c15c1d75416d0c717916ae0659afd48cf1cc7e00cf88e84ad3392dc952d6ff340938620dc34fc07f2285647703c72591bd91a4e7e6d9998717ac3ee4b7c43bb3749497967381ee66007c7b6412ea45bdeab58f62d764812b4baae702c8c38dfde34ec25b74ec0fa8215952c1408448367e487583fc94e030ed2399e821f4c7d31a1b28dbc61da2ae1810eba5941a721345639af66ff92b763dcb2a523925e552432e846d64d13b60c9e80b0abc05f7f232689ba8d4ddcadd11787d654820cd3adccacc23ba4ecc7b4bb8f33d1170b0d393a05b60506a16050370269dab211a0aca98b35079ec312720051d3ffdf93a0a40fd8cd44a79e6c4bb79879d28a98258c60220c885376a52cdb7d0585b85137dd2a61f98916da848e5be1f8e23d82e2b31f87fa589d0bdad4d877978281c2efff0051c165a08138e5787f78e4ba7d4ae592dfa53872445daca91fb4299877809a2bfe4bd8b83ddf7dd8ef51674767580b28ace08688e8654c2b94e74f01a508cad4645289cb87173c6013f63b1bbd1d21edb67be8bfe92403ccf24d1846077879039f322526a644b02e689de53e0bb7379d5a5aa41ca8f01788c1a77913a3f7e6a765b4569e84a5fc8ff9e6e1a63472866ed69369c08e2ce79d9c0a711860207880f76b87b5845eb1490267b7dd1a16ff1a612e4a5ec279c9cbbc607f24a6c822ab1a5e48e543414efbd72376da3de0d95c82abaf11e0cca605898fc5c30bd01712f5dc2da404127b6e1ae9fa10103d1104c4b3250c44f637a09b7029dd2087eed74effd57f92d067764aebd058fe689345c4b5200bd75f702a56cbe42340f4b312c6a124eb636e0db1e66b99565facae7f289015d4cac60b9690808fbc21f6c8ff131fc0d133d4370c5acc66cca72f9cb6245ee6955415450904f2e5a0f247aa92eb6faec656a19b5a6a8b626443d6bac4cff5db0faba25364ff9ddb7112aa9f82d06fe5fa6511e1c5d3bc393e580511e028f78f16dd5b1886560aa7b65c3b1836299387e32df84d80f6ff1919dd58c191e7e1445e48eaded171503766b909f0710e97f3ff78cc3a23dffc4be1720ab3ae618051b20dcc0409265848a11b3e86a6a2de10610db8d255bffd9987a872be1bf430443da371991640e6f33cfb9d606110f02f1fe45a033107117524d76fa4ef956640c74742be51927ba1ac2fd34e9f6348d364dc39695ee3a8cc361b84a30b4bb36d26b431954a82e9b3a310a31e1402e97cf015ac145dbc5130b7abec0205917ea2568a98e40faf5082386d4824b6e23f183e83cc6765c71d8c33762901b309534627b5da5ec1b3490c4d7be996868fa3e543b2bfc11ed4da42f10bc2566738c9c966a96a66921351d910fc4d11cc456dbcc4ebe865e9fb9220ee5ebc564193bf40067c26e752c95ae5f5dccc735e97860384ee6f7c9042d95bb7f2d0bc1c0909b58cb9690060499647d9971f7ce21918d2759531d0c28cc9b73cf29f7dbde7edf49e26443fea3f174bb73c3003034cf35c205c60c80a690c44fe16147d2188864235f3c6a339b63402ec3fe343f6a89ebee14be32e9988922cd62aebe58d145b590d8cefc8ddc207b6a3d9083226c14f2d03cacf26d97f6ed24665bedecc794936e24c563148b0d4fd59a974dae2bfb9e2a2f02b339520a460fc96417a14a922f242ef14015074c4f53221f7481da401ab704cddfdb6a3c6ab0fb486ab353b280a9f8832b43680452b48a1292f10df8a548226e5acc127b8e149ec6304428e0f324e89a33c8392f39949abd73b83bccebce5869a9cfefe7dd1610c163693a64e5638c978895ec9cb189d292390d96c1ddba44b1c523f067d80d24f20916f79de26377a7a5a60c359db311e3503d5d406e5a2869f31674d54f579bd71a3b89d1116e435008f344518c86cafcf703e54bfb6eeb9c34c311449baaba46450e28a3d87ebec7d24bdad111dbda26a19f9467a1e147c71cae447d663575e8538fb70ff6c4b7d024f088e3b142728acfcb20053c95a5135bdceff5c7797ec4613480e322808a8a6683cd4802a791e517416dff665af887c7e7df82ed51259e43975408c2bba24b0a368aed5bd2ed4d45c0600d79d350bc5e5b999b43212ac3a779fa6116fa86a88eff716323af10425e59aa607b54b3d262226c18c6b5b9e78352bda01d18a2b283222a03608c95cfd7ed14e52b5459f788c3aae1f9ab57f85be286957ac13eb7656dafbda0fe7bb1d709438946685873d646b1c0616a350327d484dddb2e0db03137e07779eedc2f10c11ae72e6002e3ac657c378ed42a1f2499bd23eba2acb0b3296f55f05cee3866be2d44df2689c8186b01368467f4c3c83bee7a410c3266b109b145c2c17563bac3a24467f9fcff1ba8eb2d951a6536259e0f4d2990c48ab9357f4001cae0c147aa9606fb2c4e40be9998e79faec3b2991225f859d4f87f10747bd79b733cc8baadbfcf766d05f786145c6dd6687f93f2ceb6b24a1568f66a88151e8ed03a6d2642ad88c4ecd8b48e11a4ec1938876d2c080095c35c5dda0be45f0666ea8311ec1ded501754afc6db52f387052f9394b2e551db1e6b4cf7027cb71672005bd7d09aed8808972e8dab2f4458ec3a860c98b8471f4bea39da5b11c2234dcd1dde1d9d5e11bab46367b7a4155176fed7c93b6a9951896e995ccff091aeaaeedf933c207dee236abcf2428dfdda9e9ed3e6b567ddb46830ef4825d2d99ee872f5f74089939c010edc25984f879f5dabeba259961eb33d319a1a2b8cc021b021939bd760338b0194bd9bb140b30fd5c97d04119852cfec00825b89ea092a76ff3828f745ceeefe68dcd40c0ec54135fbd529a797c22008751cdd290b641501767950d07efb83b3332cfef68ac32319e24822858bb80ec693729b52b7d7b7d67aacf550914270737e1d65d251c0579f871b3855c06b386de17bdc45b63d958dcdecb8eb58414918fb61307163a0e2a412fa09515c85c5d844f314baa3bfe5acc9c45488fd0cddf6d38cfc90651460c2a1dbf9bad7a666b6e4c7592d982a396f732c36ae90b45de0db78132a4052f72704b72d20a34839f8e7da04be6670f266da368a59a305bb82ec530bd90c08525c2b3c12550e4b5708ba0e8783b5d6f627edbdc431042067a4dfea020765b402c9750168a46b775ca50d7296eee1c146aac815be7b9f89c7612c10b23bb2e404335dd4af13df5d28ec1e8dd8c1367cadab311e904dcf0a95e950696205c4cad1be1f53af10b845f6731a690322bb64977c8cdb55058207f326c108f961bc1e61d2c2641ac60247536fdd7856dd3b0360b1103a35f9e47e46edd9bdc7668e8b799c0b3268fb9ad29fa607ca3638043ad8867a5364aae4372ecf7e42a2a2b6fefae939f31457a6cfa9cb0df6dc21bfb3a1e1729a328b73b21e78b2dbe24a7f70cfdec06f730f4969a1901665dbdbb8bff08bbe861333d9ea28d98d9cda1e2fcd299314452998c93d7603dd37ad4d20d579269fd00b0a70e0eba2f484d60c21050dbf3304fc26d8469edadfc4d327d5a69c2c13dc9408e2f31009c30a0c5767df078767f192c4dc01b4ee719722de423daeb970e22c090599fd5effeff21ff982c406c17f7669e7f0ffbacbc296e046cef3127e1bc1fecb1238b186d8429ee406c532d52a0f2487ecf55bba1748c8d055ec508da54dcb6fa96a3f3c730661f95a6e1eb629879da06f8f463849aecee7ca2f8c7fb9231699dd221c89be73bfe71d408ce51e677ff485846404f1101ca81fad7c273fb58ecc782a701e80e361d0da983d62cff117ae2f1bb91325d8777a8b37dd5c0ff8d6e1fbfe1b36ed0803f9cc80a197568261ff43edd5ff9d3695dc4155e5a5c048dd50d9205033c670ace97b5c85e83d4a7d34f38bc52b28120bc2279d677fd972940f1d4105fb6ff3b7b4ef7fa2df20520deb081ae32e121966b9703b7e990bdff725deeec411000db0b6946e2421338afb248258760d8f945e01915c1b08784b43f34ca5a8bfca629fdb14393865ea6d7ea15c085d02710703169b6a1f3b07b9a808ac4f6cfbadaa7f1a56f37177256a0164df71bfad95ccd231003ffe4123a8895420020661eae771818efef00bb8dc05bdae0ef3956d3d70725f1cd7254885765686367eea97e7520045d413101ca0cc2cfa964f69a619593dd7c29075489b4500d067b3d5fd4349b27b9d01b1d6f9019db218517f2cae09a70b248e6cffc7e25cbf9ca6687c803d9ebf53b2413483b8f50b1a57bcbe86055358886c1ad0d18a1d120c616d2d41ab3148d3906eaa4d425073394445443175500380f02af3d6234a94f6e146625c377a2fd9c2eb2c7ed96a4262c38b24f431a7fc14775578034ee738c6f20d1eb329c3499e706290151743268fe89360dc13906a4b67b7b786fb748e53537a36d3b219cc59145687cc89e98f3465bc464c4326890fa7000fc70c95e53a64e8d3e488ea09e71652123c2373c7935ed2a1d240ff073c62a0f58d3b2a31cc553cdf4cfec8f053ffbf3ccf6ac272bf4163aa440557f52af58fc7ec0b162041c43031ac778b043a3c96ea823518bb97dfc3e41ef23287de8e2f7551c34b264a3234f2db36358c66e8c654809d7fd0c4678ddc709c58f437f8290b8e237fb8bcb00f880ab69e5fafa1f2e428dc65fd12cb6a3a37698c5f12c2658925b2ae4a2f072a097c549864d4ea5d010d9a94539488e4aa3b0e95a6a6c2149763923ffe7203e7ff3b7f87d45e06d71e3eba766dc78bec5cc4312360533c84c5763e8908d74f0bf7684a456decc0e2e3d8b2be56cb032785fed1f16189fa9a32d2148d3b452514034a296737dcb3266d55951d7c4c2da7c21b360821f6f9d78a2cc614844d88c42df382a09aaf057b878b1d19273af555bf74a94f084eda4a3076593e8551d3d590d76a6e5466a4ff196f0f2e41dc3e1f99e94debeda7ab8be5aed1be3312c4355b09a8ee8c7a2b3a51c83db7c102b3dac4dc1fc6ed85e2a165487932c5119749d051ee55d5db94fd641dd272db392f53861465b7b3158c89bd423174c4a96e37d4ea07bf2c1b27d41fa02451d6dc9f7eb60b23d73f5dc2ea1a1d4d15bad4ee78b3b6c496e6295ae24c448e3994c66323544723a7c0700d34a1020b31ea2cba16011196bd7f6079f948fa954bff9c8e588e281fcd91c9139869eacfdce394d458fa5eee5582f36e2a039345ed8b5a81ec030c75916b76a2803c8d833fb45b539acaf3629fff89d2b330eec5adef79d5f879833356114ac990bad77baa2e20a069ace38acf7831c8a7de3603625a4d973a17ae58aa2478537b523b2a2a41494463e44cb2cddd914a0897872de9fde92e0aafa0858a381a2ac66eb9c65a7e05cae055121303c2a9bcee9ad531aad4fd2eba4a0884489e498601c3b09f4a6f93d9354a3e0821baf2299e80a426ce9b59c49583f60352da8c5198c59cca91014dcc8a0c6a8ab61428c94aedac083fbc49f3e0281b6b358f56937027898fccb94928aeb3d89b7719ba3461ee8fa47c42786541a9bb1dbcc98aa9aff5687d7b7f59c45f70c049bc444728d9fc057cedbc3f319d526066d87ba2dbd3e0d2b2b7be72b125da947f956e3853b9e08752a88af6ede55b76cf089798e9255df1de2b44ac27f043066cf5dcb18ee385b40cd1c6d224ce3a6ef0ea2625a4c1892fe86fb03fbbbdf9dff81869631b9629222b15461c50174699a9950e2e02b5d72bc1db2e09eb27c0fc628da0d56485187c68325239d668d9cba897d9a2ffdb9852756ead731ded19498fc3844650f66db1d8f9e8ac65c2fdde16b23e80b0f0dadaa5b166890a2f8c65cc6fcb515dc380fa945bdf267578d248ae21b3f6f2264f242e2c48d7054181ec2499bc70098ab81ff9d5fc0cc4b3603314d9b9914f93c7182e431cb1fa28694a5b90547230fd5028f5f1457f60c0278eb503dd2e979186d7c6afcec53ade038ed7974acd2e20996ea65784ce3e1348fa6c128eaac3f020107ae3130bffaf25e9a8c0d14dcb9162e9698220a6a7872242dd893a2462e2f25a09d1e953b20c62748cbad9679df54788042f4a1ae767832572bbe292d23a3b6c9c848be9d65b8e4d465ff868dd92ce270a2cea65469e9e7ab3986df30a86e4609f1a1dfd55f1e5621d3c063ff8feff457dd2cea3d814149e2e8ad8c093e66db1a4144f666545b6fb61ceb34d12eb0fbd8fb61a52e076310a1b9d98778ce6de6c6be1864ffbd29fa3e513b055979204a3bda946276dbf74d9ad1e0f1fdbd598e52c38d590c45fc29c5d5b650377e4c1c4ac7b9cedd8cf7e8a9357650e970008464b0cea8604618df153b144e8af94625b29f05ae215471faba2dfc24ffed9456fd0a448a10229d1a07f947e507237601844505fda382e593b7f3c84b783a3d54f0c72d8cc64d318372dd3437ba88b90de3dfd889c887df56c6135062827dc8991dfdc72a26a9e1257f914edf1eeb5ccca3bbbf431340caa88a8d48fc655e7b9072ab8e8474cc4ea8e08af9ec1da6f18a215154f3dfbc43dc7a62d64fa333bff8ad98e1dab1e96b7793cdcf735177c1c2a60aed77c17ecfd2cfced736cc627d248277a8769ef714f166bc9548cf373a6bba2289721176e7736f4f6e4b3fea7634878afbf08b17d98ce5ef7274df797a285684ecf1f999f8a6c64f7b21dbf54c43ace2ccfffa46c5312db8a1ea0994eb424590b26a257ace063b5b0ea488037d441d4f77c58ffee828c835b72ab1e11e2fdec72bab9ad4e47f9613e83fe8598539b1ddac903ddf51f4b09ef38b3a4828cebc7eede703f275a47b94e86d9fe5f126f4cca5a4e229b39f958d3f5b2b5c19afe094ac1b93b400972caba1e9e78a1f4d4479c27c7664a13810f023af850c305be526623ce3a400dd57ca6dcfdcf9f882be485d88cfc85e35a22a4cfbf88787cb1eb926ac6cc689e17b3cdc72931776a294f012b6d42c0ac3196f6941041b4528a599a708ad4293df2b5ac4e7cb1385e77ef12c942caa36f8d8613f2c3014256a96ca07bb4a24b64becddcb4803de4ad31a1a4d627a473545008f53570a07759cc8eaa4c0026a15a55af8a13d7ab2987a98514e7866c27bc8e5d3b622a2f0fd915f318c2f5d194e64d4ac7ab0c110afe855ae9229e52921dec1ca02243b71ec2c94c3914a86330881e96498edf381552ecc3d3bf9c3cb182343af2dfd5a23ef7768c8878f1118f89231de9b416c97deff93efcfae021c79a5cf743951ce24843bf9dfba686ea1c2ae2c127b55633e1147734ddae6f58344e4fcafbd7de7ac12afd6866a8347676f0ce18ba82c9dc88b7f6df3de0d169a95aef46f2cb3e5abba5d2cef3064d5feed445b8d66e2efb8813ccef7a610bc606e8419633baf9125e7be90fe030657af7c9760c34345c0578180b1d1cfd2dce397198215fbfd37982f1fc3f19e7f06313d1af8cd3dcfe8ee35f97898f9f815f3108442410a8604e8cbbddc3d7474c0b741fba0993896a4c842a9de84a4c0c9e4dfcef526942cbd8ae4de8ba2100a31d0fa373339dcb6a23670924875358625ef73dea3380db5ca0126bd3412d3e1e6db72a20bd9fe9472d401d6913c1ea3b224dfcc89bae2a072917a6aa0d7fffb69ecdf8d0be09584fa1667753c7a9177a836aa2f8adf824a48ce647d21e4bd6abe76a802292b702fe67ffce175dbd0b468351585ae7ba4f5bd2d9f591bb8bf3eba56b580e227acd9b27e24545f81b8679aebb219c79720e3c5dbc05e5b2b0745009e3d63d2b03de7c51bc9963ac1d511ff89b82795f2cebf2c6e1eab7d43aaff0d080dedbb061f1b4c8492d18f590df913bef41dd9f3c87e34b30579adeb378c792c68a1b31acbfec993c09ae7742629601dca0f16e8df18a10ee11f4a2a2de418c353b2757e2e896efbf3d1314cd53748644544cfebc497d452a785fe5e3f72cdf81153f32f5c2f326e49fc6e08dd0fae96b7980ed75b664ac089dfe26acaec5937db62ca2d55c6bf54256e81b2804cf7d3bd65aed9ebb1f82135847c3d2f3775ba386276177fe51d1339c28e559f06bc7d99b9a197ef8635e1e2149ba97947b3b31651d10b05b4b459140cbbca80cb8740a5012494d339fdf82fba8694c0a0073dea0e4cf1cf4528133aa9bd050b542403e15228b2151b57facf39a0189c47bd960390dd40b4729af0bb505fa293e4e8a5b008306bbacfdbfa01a352fb8083e45faceae77b0173bd8b6e06fb0dc3988feae356d677e58bd0d11b607bba7c75b9cd722ae31f1eddc89f414f23ec0d822496ae07bec5415b958635d6241f7026662c7eb360c47c4403310204a6aa963a4710f283a08c7763e61fd6c4965d18f3ae173eee34f442e46a0b2673a31a0d574d6873b946baba58679e6c14dbc5237a010b531b21bb09363d5335a60f4aab457281f2eb97f2982668cc3bf3b36b115bbf5ceab5b2562499566441acc48a608b24b25600efcf30836c8f3a00ca6dea111c99214b7ae3057097293fe183af56743b24f00504761e032a360fd94429e74e5038ebcc4373ba8101fdce003ff8b9cc1b8db252bc609a964451f66468238a07959e4781c1b68c5aa3d61ed9445a647b2bfdce7f681f7b001f7876ab61f06c4297b66ef2a4529f28b1b7145f76e46b10ef152f892f11cfe7b82f21c01e6378dc15ef82a668dbd2fbd16f3e43f3ba56ff6afd02075a76c82d422733c58ae19ac0b7b81d97a7cc0105c81e3beec9661f8e3ddbfccb9a9c55bf13bf2d926da917589ca08ba757afd3d310447e8cae6ae38c917400245b43519571a76b5362e5069cdbe62cf9394d8b103dcb3467885a7df42cb567cc58a2e747094dfe802e1b25ac13bdaf3ccaab0f760b4d59e42768125bf25a8873f420e6ce288ede718578400d4eacb1990e4d76beb8dcd45b5828e502f701fea78efb98604826c3808f798423d8d7399bdb4de717549908b391ba8c09966c205e505b707df6d54fd5c24e263e2150bd58e6284bd17a3ef8031e907c2bc27e64fc624473e1035643d1c42c45e1716c9f41abd9687240228026e664d3326433352f63f9a1421b6ab8e4cba0646f6d9a0a22c86faed01e608e7d94cd5fdb7dec14d4b0f7f896800a92841f948699a428b0b790ffce980acb34a5b8c46c7f7a95781dd3b021e34b7c58e0e1560c6d7e2eefe90d28143da5b7a6e405d2e354184c09de290d96ac2e2b1bd299f87515923bfd554a8cc8f4a5ef0b268ae087db1a2ebe8d8dbb36aa084bb27c2e92300cf6eb6794d66bf599a199e32db974366931d2c7932b54fd1abbc26ef57d37ecf8f274ddef1ce6e05d74e7fcc04f9c030599db3d40b35ddb6d36c9d3c08773a1acf6c7ec59ed9b30ff7d01d3f3d51255e84c956ac65ca37677ba9f9cafa6a5cdda7d86351dd3dc33cc5507960845a19f81560e1159785fbb96731f000e2496fb334d66f2523dee0a482220fcc92326d5048b3794350c9aa3e593b995ffcdc67274093a7b92fcfe1c8d7f0983ebbc409bc222716957e768ed3bc9f2a0f5a7e94158637f84cf300a0498da40ea2d27c5486d57e3f5791cb4f0e403182586b7ecdc312539d23a484d4c0be23ee1cd7a34c5bc80fa17a83a0cc731a5244e6fc609b9e10cad77806c57a4ba37a804b9d5f2dbdae5474b7174e0f2a3800a9df26dd5e116244758d17ae2e310c80db84d5136976a88613d89cdd04d138942a55cd9d5b606a9816661bfabd4dee28c9617a6769d1ffa881361c14a03cb5a9cad367ccc966682cfa5e119a6a473ffcb9b1b6bf02e8a6c1089b0d2d5a0bba6163271d534c4b08619cbe24f699f2277d5d03ee69bf29591121c2135e5cb602ae6eb39469761023e9f78f122b2d33c6e5fdf7d2e0f720e920d65fbb673f9cca88c65a8d1bcbfdc16e45c5285b29c139f67ff5b8dd28016e4753a85bc13261cbf7b44635f4511497b4f918d7c3219fe6f3b3fb0555f5d2dbb7b2b709c08188a55c9a2379e54ab86ba8cd2c3d910905717e32f1a5bc944e885b66d7aeffc467c2f0bb8c36d6e613c7b590ec4962e18c66f8df0bc328210cb99d012c47c518384724a4c5e54920300046e064cbde3736a7db4876d3d4dc588a95efa19c0f78a13f785cca5fcfac801685deeae29f8616590c75e0a256b2f33a3661ac4114509ce54be1511b04b9a09841cf42e017b6b5d7429ecbb220c6221b231cadd92e187a254586cd0eacd2c39219dc87fc87314e380dd758b94e3adb11dc0e217b6e4a2de94a1ee3dd874fd0a73258f88879f26a95fec930c6a5dcf46dc8237e252c0d37bf7c1c3124b1c963b018f2da8bdeb4c2cf09cdf67819bc0721530739a8dda64fd67e9143ef667ebe75450a70cc97beef4519ddcf464dab8a3df4f5ebae71a89be545cbd5dcf76ffa2fa4e2f95f0523e50b4b5242ed3c6b5f69c9b95fba9419b2a102b729f68b9c1b5a78775938892cf49f3e48db6d224b7550b6ed75f346412fd78a4623844aa4cff8bc2bddf532bbaab9b0609516f8e59656bf373dd25272e59c76817c953abdf108790635921c76202069c3713902c7961e6bb019f4d0886a09d7652a365c1b06b5227e99e8cd1bf274862b3e1f1893ef8dfb23e3f5a9f3f5181acff979428ec30fd15f06eb85fd9b463f1da598f8c8ae8385ea33532c09f3bda8d17ecc32b11538c5007c880bb1250e61e27e4d69b6a2dd9c8a17125c0be568f2028f02da611f54fa6185b3a63e8eb55ec460ab0de3b0af4b6b4583c7ce0dcba078d733485f025f3408a5a55d525ee035ae8428f983b73387b17b3adb7680eb9db36cc667c8ed1abb186184feced61f0879a8a984b2b480a8edea962e3737c12a0751e82617610ba45945fab6970d10eaa16f85571ba54b9fa9df2ee7776cdd2752748f31a1f2d06c3ca671df1adcf0ea4cca18402342488ad29f6688165f8707061bb7f05f5dae610f2dd2a3073234f1435f8e20eaca0d8f92d97773b5f425c3e9c14853832caabbaf42008714e87116bb7f988bf4511e826177dacc71e93ca8c03ae47d3b82b658b9de798f44cb901a74f986c452429b2668e753b264b3ba9e9101afebc4be9f7497a579aafbbecffbed2fc4413b4b5e004f531e78c74ec2008e2f004263b3c4007d990dcbcae92f28add14d657a44b38cd104cd7e4c0a34591f405fe4be4123f81839eddb5a67e155c471b938376583c2d988ad5efbf55eba1b0b49d530f29278b6a5929bea5a3573d10f81041f803a925064435b35f87ac32fc29bba1cabe3d3bd71b36e33f3af0538240d9e7bc56a4032f721bfdf8c9a2eaa0b36427da5d51775429221ce905ef2359cde345477e56a4fb8df65912d13cf379001ffbfc05a8ef5a1689b4919681326bf965225ccd1360b71cfaa511a927799279e665bc5df5abf112699b046b8671a2de11aa549b8a029df47cd1c0576608adb262b60708a3e4000d7d672a9d11547233dd72c41c576a0dc74f3093ffbf2df984a7054e6497303ff033458d26cab78640f488b1eaa7613ea641ed92f78381625440ee5a3b56819c70b0e77e976643e55a90dc92f121212aaee8658991c23a0964da19a9944c4cf49bd49e8de6aec044c23041b23f780db2f57ebf9f4a7c8123a02325484928a3ba3f475c9ecc212849cd6ab747601bb41d8c6c54cf740b121a3989539cbeff7a686437b3c1c451eaa211c0d41314f73c6d7441e31bcd1dfa836ef2eb14b07e8610dba1f41202a3e3a81c6d7658acf1fdbbdd561ec4cbcc6fa2aeb75adea9703c3b3088380ebf945443f5a5157fec50cc63f2f8856b26e6aede491921f1096f895df78aeb211495f12ddb9e5ecb899818457f19713487b0c9ef824db1dae7d11db09512ba6934eb00a973630ad3ff11d127e9287b43129bf7e541c9fde75b295445227a448b5f7725cdfa759bc4efdb676fa0eb0ebf2deb15577d6a7bff06b010150d7b0344aed690243a67832e1a93e77a370931d8f1dcc0a5cd0253f81e90a9f9cf00779e0a5d4c08fad01352625c8b24e891d40388d7d02094e14c62d925aa654ce99637b83757ff7b9beeca0ff6181251d0d07a5a6329ad11b2e2b0e64821c7fd1136bd6cde89eb3a0b527ed7f5fe8de2cfc288fb3c97adaf138416d4d91c10b9320c09dbfa046d638dc435281d38d6575ef848f0f754e2780ef82bb096d6890a2ea273c64f8e9f8966eff9514659b115a875d02b5e87c225cdf854bd86c89a333dc74a8254c074eb72a7c3a989668a85e9c0497dd56b76fff9ebd6e60cc6e5b70a7a7bd5fbe8305af743c5bc75c4d106405b5792baca7e2d7268f6bfaa5a0daa25e7740541acf603acf50b5528daba2e64c635a8a340086eb76f1a2683aa3e4395d15f3674f37a02be5558adee5d7e753d81832a78bafd43fe00089b1b04dd93376a89a3ffeafda855b1d2f73cc97761c4c05c7fdb91d6d9515d9ac39d35e241e44e92b882fb02da8505484c4cc3fc96feeae7bba4b606a0093fe8e9c9251e1d6a27be4dc9932c4f1e64e8e95ffc7375214a1b894c9c0a65f7e64a1386e42d4b5b49297e4a1c3e9b809969450c57bc97d24d1dee5dd9045c73d350561f9dbbb2329f8d8402981ce715775eed11c12329c4f874425208ea5ae12f480df653fcf5104fa3bf9a471a4243fb1dafb1ff93e4bff066dd1d006d427fce49d33dad3db407aa8845f57ef1b53a7f88c0c90edbe56ae0c2122a82d11d5dd6f9130102cd7c71ec735950c26c79aaa16b96f33eb4086918f6048dd28d60dfe4328772dd062d6d8f4f74063932ce1f10f70f197812ad8f547bdd9eba1bd46adbb749421c667ea44e5091a6485c03ce9b8d5f346a82ece54311ce2eedbe20edd2e6cf239733d5f7766be9bc3a380f772d49fdad4d1f6b63990093a683cabae1e8a49379c41edb60af77a80c0508aaae89726017c10e5a275298808d477374e44f352f5999d6b912bb609771e8898641610226accc2ad56aadc8038a959c9185a88be6647665209a14ebdef33ca1af56f441dbd7b997d1a91e2acf079ef2c673108a4f2030118a5b3dd96b8a355a28ffedf70a0d25336ee3ddbbb712332c3ed73983b0ed55c55bd91d24c6e0e9c19c6e1dd2ec71bae3f448de0d812947ea50b3e125864734b9eb23ba72d8e8503db8d64c4211561fc9f8d4c3c0271697d8befef2f3761d27723ac2b87faeb1bec4a794100a3629eddf6ba2e345819ae6d85cd03bef2159245e97a6bb3326a91c211b3092c0473ca2135b28074ad4e936ee5b7b93acfbaecee9d92e1771b624503d040e33959f9a9f55039daed0a453b6b99c830c39010ea76bbf855662b6aef32f098fddbd6eebf4cd7c8f62c84b9785a20bf43aa4a566729cae87e90d77f908d20c23683893c6f1e9d376291552af3ec597839be4828660e9f240253eeed0edb39f385c5ac58bef8ef223c9e19e12310943087faf575bd516afde48899ac1115650c72315806480a826de026623bd1c49becff63a6a53018796e341081b75c9b1a13fe13a367f7b8c8491360027a00e3c83f7e0be0b1e3a2de6728696217fa40596a62ff9d0604915b975cece9503ea91bda9dfd8074c619fdf0dfa60182b093444b474c400bd4e93fdf61f5d3f676d8ccec0ded185530374732d0fb200add5cf6f9c766428954fc0836381833399f028321e4fd1f3904d3724d3f96094a3fb216d4f5507688915d9a8805a6959e6e5719b15a6c7b174e98d2b9c16bf0053cdfa5e51c9933e3f7179e6f0ea686dd99ddd8e0f7330c6aa2c425dc4a492334cde4c2e9cdb39c538dca9dbae835467f29e8963a5d3de6e7da7351d8af270e4f993e2cd8b5493eff2027cd78437595e44918e617c0ab242a2f5bea37a84a29a8d43f5eb0d8c26f1c29182f55033cd1dd2c55fe4ac335d137d8a5d632cea8bfc46809920759de78fac68a3619fcb0878b2498016fb2bc8ecdee9143f09cc3d236ece3252d5c2fd8af57e732022672441c071e3a10e90929a2ef6a85b168f9e4eae46016cffa937815719fdd962cff5d2a3315f253d8b4eb3353403c4d82f6ff91b89e1d983f38b4f37306b5123c401cb7b693763a9012225995e6e962388cb4c7b21d624251ed3d0075ea2d9fe025817c022815d98106ff6282d822e2a873b4442d01ff77557459a4496915300e2e0d35dba557bb291eee5b3db0176c61f760a96aee5e4800fa407a8e7dbcaf5159148995710b5150b3acf61ea5dfb65cba7d4ba401315c7bf002b1d0218f59d58795f1cc00cb7b90025880ad24be3095f9a2178a519f3d2523bdabd6b0ea0aba6b83bbab39bc73eb64121ce44acd62a0b8153c3fa6a8db6ce88d9cbf6404c551e535d412fdc908b7027bfbf7f697013041e01e1d7a78198bf873e1492d8cbd79f8681b991778bd9225898f1aaf8570754ed37cfed4b84f74cc706f6ea2defd091145664724c699844d1516081201fa7037716e6fed4ef2494795fabb983cdc77abc3ed39f73b48d3cbc624ddb435d2b706311ec95e4ee7ecaa0959746de9b4a0d74fbc945da6ef9c309a875c8400f28d7b7b140fba162810bfa57d55b49d7cdadcbaa23d95ae7837b99d20f19aa6f4d3efbc162f9f63ecebd84c118799004b2ad932b0be23b80ef871e0e66e15d31320c245786584ce0cdc620409b5d7f4da41b231715f0001fbf5c297160ab230c72a1ad7c16acbecad4c760176d0235f14f6c63d1dc45e0e1ea7e40f7225f023fb9d27b55e2b3693e095ff62bce30ccff78481a48e0911537c645381c85f6542c2dd856f3815c1ffc8ee60d8027b60fb2587cfea43742ffc2a917e43ac98574843ce2b6d3ccef194f3c1fd8d3c1fbc868fa7e452b435febe0ac16c0c1f625d6a3a712408357780971645351c97d831a8b7426fafd3c82fc59e13437f5beb14e267f10541541c1437adddaa5b195dd4ba874071f65ec1d874ace6dfd1ab082174cfd553797f5274b1fb5dfc117f0f5a8364cb66d4c74d3286cc5e726df96d48de4e69068a7fe008e99848fb39a1861bbb18ef700605f0499bb5f09993ba5f837dc375c338e3e92bc1890c7ca73648793dfdcc9b689c71e8214e618307eb4cb582d347fa6656b5bc01c797b8a2a95fc7e3ab66ffd55c31f0d79798eb27a6c9406e41f233a22f7c3910baf395ff1db258625a4f25d53b47533d708dda874739fc4c2371dbd0f1bbce3341ad0ad186bfb7533354f06a0dc9a0450f065a30544c6d865d8e60283716b2119e1fbd7f83465449f6391b854aa04feed0b1b04e3b59204180ad1754b51e100418eba2ce4622c3a1e70a447515a19220d46c857cac17ec7b11ec09e1207dc50ca822ce1c50e0fc065c974dac5eb76b9e34f645aa29073cf66f2ef4acedc20d455ad63c3d2c57c22b17e26742094e6fdddd5014ade5d2408cb0784ba27c55c0de3ce843243939aad22005c8444e8a50f126e4c64278efd0892a75e1b6964af71d2bf6ba82006143c036decd6ac7d8086137a3b904b66e9f8939c343d8be3e715c53c70ac89032875b65a0b511f8e04595e872961306ab133a17c2c577f9fc78d8071d3f301346eaff1372b4d7c33587c31259ccc65b3215d1116c9ca9ffd645c680b28bc513060dad4c11b077bc64736bd2090526c9f584d57d7fc52d92aa2e184ce9bd5f32af71bf6a3c90af6ca6d6c01daf5454a7fa31af2f7e7861198d80c5fb8e76e5bdaca9440d6d61428c6b74f281062f7af03d2eeb03667eca8aac3c5efdbfe4c648af29ad6e4580515d71467e10c2cb3b3dcd37807f062c197b517abffcdfbf57fd602a9cc5d73ac194139eb9a12256e96cfa2d8e6b4ba02479bfdf4f7e6a767b8363cf9f4fc76a52884501e7d421e427bd44ff6ea38c278b042a3603dd35f5266181ebef7d4f86cc11cd4c5f0aee4ae66eeedb0c3119e863c8ada9ede2927fa10ac69f60793a90aaf8313a7a0f4b9476dabe4b719c51bee9600343fdfac03e8cacfcdc08ae87f1945c63ec7817152c6a905db33ab05e9cba42c9bf24b16a747f127ebe8b0000864eb339670467ca0d4c8c185884982ea1626346bb44aa4474fa73025f27cd7f9b3d739c591b6bf338a6cf756590dc7377a7686a99663b2d18bd06be0c4347f135e88dbc583e19d45acbc4929f58effa0c3fc9c558e67767fc110be2f82053a01feae9ebae352b38120f324822eeaa5e509e14ef37b7303647142c25d0a6ca9ac5ad9a4f8219f9ff1ed5edb00581dce04a5c9e63c663002c7fb23fd7043e933eb78aa4c8f6424e388e3ac620896f306f56b2b5bfa82b8d4ce1c92bd60095893d4e1e525f37fbd8ef50960befba632e20530958c7be8e6312cbbbcfb4c5241aa99e79d8d344cbb9c6be330ab2507b36c0e52d42befa325f7f2c4d490f96de7ebb40a941f3dea559193282a5331ca6fee99efc6c92784caa32ae97998c91a55e94defd6d30d633c3f078f786bd42d06d1ad07715bf553c3dec76f1ed75b7e2401a154272f8e786dbd9741f14d7dd609ef37d83658f179979584f6a31d173ebee2bca81b3b9dbdf17d47e002cccc1700472ab390c53a9523f5e7e70098ac6b1bb603f5743468712a4fb69e3e0b9596d63543622becd1d46b5a5a61bda40acd513846c6bdd5546418e43f32ef807de85a9b0ecb092855f5f5be4a2fc71d0237c4f79c965ed2eb6a5b4b2e9b834dc257787c71825b6ac3ee6e451116e2cbc8642b978964270eb6df70a598ae5c3450bb8996f9634fc721caf779f5752d1c66dff02c51e2b0df3b7d228e35ec1af18f31f6a810592a7afdd9aa1a8112f573c65b0044ebf7430a98f81848dd2239270bf8f15e3c2c5a5d798585065986e5239cef46b063ee2326d76a96ab6aea2d8cba772fc78d2006800c3c749f60d61bd2b68204bedfa885e91e567c5eabc3f0ae2c66c3165dee40620780b174bf2fc84a072f77150d4231fc33302312892aaf43ec4524e99c4e169c881e8bf3612a68f82fb2844b23c9c32e72ec6e398fb2a6234e7a2b6429395a5304837351580320f82f0ade26c7660d83bf241fcb5c3d0906e8df5e1cb23ce622d934a0d167579066f901720a2562585ed6b0e7f602c186ed43749eaf1c53b34255c87da24c459c4cf83f6483a5d737834d4d6989d3afde31534c9538fea300ae3c24b14ef121c1c942b9a5a6bb47e1cf1fb4a27f8b4619228495c8de673b7b2b22ab5f3ed5bc220fec7a64c5ac3bc23a623a55f7c4dee7c0c3d92fa83f1733205c5ffd1a5887430f4a44a2690950ab6629d216ca3d8822a2e821937be231c5adcd3e4e270a9172634e82ebf889d16bbfc68bd7e704c4f0bb1a06544a7423bdeca727c8c51d8eec40fed774a215a44f92f01b9be8827711f6203ff62f979d31b3fb30f31d6cdf10fd6607dbb165e522f3815a0d92253970d7a2bbfb5f379dba38b727ac550a64ee202ac13b1cc472bdd4abea8676b08176a993ac9e12d2c06b4ecfab4aebba4571bfb4b383e77a94e0c5caf9e5d831b877e0bf4439f9e0d30624d601df46c53571b86545e70c5a89d6d630773a0a59f552fdb934669aed7b7da0b022fe42f43e40e7fe06564676480b8f81b99d2fca03490a1bcda632ff055baa1e572b9dafd68e2e9855cb74dd86e1120be4486d8a061ac0fca3ea500c7ccc271ba4d4d2a47a880e64943a2f38249dc553a44dda14b5fe29fd6e17e88bcc291e1aface0d2bfe7996b27b1f3e7451181621a7ba30860dc4d59adf36a6768ca58287f5ed56466fc321d5882d9ab2c4faf7064ab42bc8f3b59a589fd8191bec846d5aab99815c99f65dfa3885ee05d9930159a3d7e843f2916054aee0dfa03996cbe7d71936a683d21d7b4afaeda4bf95f86ed55b1f4c58738f92ab0a462fcbc7c48a5b04a5192eefc395bd95c0bb62b4fcc9a036de4a599b2c71fe6249bca848acf45ab351c5143ba1c7df4317593003282d78db3beb260dc64900e98737e7e40b734648a678aab7ee1b237000638b067d34a783c073ab337d2ad001273acafb09619ce0c107e461a82674b4c5e8997cab7ec8a0f68f327ba1a3c37d33dacd3d40ecb50b8056b7dbbc4fd2057885acddf45b77396564f564a9775f0aa3afe1c34ace6932836e3936bbc7c662354d33bd11c05cd4e932a6fdb6918ef1163b4dfbd841aa868b04b64ad6ecdc66bb1597da76d0604e288936c9db3833ec466cc14ea68a7cf86fda31726d66ee7b98ac4e7e7fbf2ec5b1d7c409e66208c6946e8388218ac4c4e4a5a6cad59ed746130f574d48742c27e98f6dd1017d72c749d8605562a8ebcf47299a18ad8c6c9c4fcf28524f1552323f67d95632604b0dd0850a5232b03cbfd2292ea9b7f6b8081a8adceedb0f7ac7d373286ea9f5ce4f9cd80d5b459870e0f6fb1193b568f22bcdf435c1913bb329cddedd9c859936823c4382c3dd0f4810e1fe09e098c9851bb5892518c67e28ade456f242ac08f4bb110e645f95ccfed507292da62b2cce49f93573692cf2e12df480ea6c30fa5c32d4cbafbad518d86fe03e0652c609c3f6f3cfb4d2219a94fcd24efb11f6d2b8ad4620fa566c1248cc0da52dd064f97734f9d88273ec1c28e026cd7ddfc655fe59878bd47ab63122a3381c373cdf73426f00cfd001599baff6d1bb6b5c4ce123ee29c0aa58f042011a1f86b72225ba4e610e8c6fe737e4d1fc4463f19557a0baac4bec06db7c7a575cb7dae3ed63f6940e6888774dd72d28145e290ca82c023fe330d56eba2cbb43f5e7a6eddd52ea4e8f0fc1fe70bfb8d532dd85f4470d0f447dafe9814438ea1c25ffae98cb57c7a5ceff9fdbed0411c4337046afab3f145845e7ddaaa3a4204eaa61f2d6449f40da2097fd54ed64a9fd41af4a0abbcc6d0b7f67a356ea5f1bef75974517650516f8dd74e29ada07b623c17ea53fe5542452e6f430fb2efb3413af40db08f770cd327ec214a9c55942215be3c2ff5a8f8b0d46a4e8c7092f71acf5ab87ebe6794f9eb14fb9a8d86ef99d4810a38258fa0c9cfa06d1093bb6533c7e19cd272b978ebe9d2ba747b7624439cd47db23b8d9979650a7cf542df202ca195164c03fea107264ccb58a4cd7acd03cb03c616743eeba040f30de2dd62fc0e59f67aa911efaeca9ee8cd70792471b3ba5af9a9102a1ffd532acff28a6bcaabd066f7f55d87cdfcc7d16eba9c33cad4dee2b714ccd48980f839de24252087de435fd0cdb6aa50eaeea9fe59b9cfeb2043c3bafe3bb156067e3a2fd27e3177eea3ffb88d434c1aba35c0f23d5f248aaef576dd4604f6db152bb2b8efa94dc9b81b1eca06bf4d9e4e58e2fe3d27a229d5dff940b8d713ad2f86aa2f7b87ded0d9606d1aef3b267e35b09ffce3cb0e560e0dc8e532e7dd03c91bd6930865a8b9d3eaee83bf1528fe645e92a5a7854cf70244ea7c15cc74819344c82f195eb0fcef65c73d754729e66794a8232f28c6b63dffefa83a7341d4d45501453099160c776f949eb83b839e48cbfca32b6224808bcb460c1d86fba4f3e47ccaf31112c15629db83beb04f55de6d8cae7b1365fc781ad47b58599b983642e0d440a26055ec11052e4f3cf9f5f6a02ee41cc9d6e857421bdcf400ade26480639c116a3839a67f4166cc022a4c51f68f927debcc40848b12809164eae308969012d2d990daf614104ef2d1b8bb27ac9b0c80aa1b3e55c60e3e0b1b356482d85c783a73aa82338583883e97083dc9f394dd84d8a7f41c870dfeb1b1538d8b0f60712d8282566d01f993da8793952c66f9300bbdfd106bcf5cb0c9cd125e7c7660de9c5b28c22ffc2c544401a2100e5ab20e8cd5301b288277243e22d7881199d4b236d8266d66cc5c9ce6a61df87cff75494a115963ae8123d76f0def25e6cdff940180eae69ec4564255fcfe11e98f9361a9640bcbcbd8866a28d205ce666d1e3f14db3e0962285c8774501d2b4e4a9e90690b8440833364b0cb8c9f614177e7121a8283123376118cabb50aff8d1d3779b7ccb60c8d2678f5776cc82dbae411a3787c3db9c900a6797dc31343e48254e0161d26070bad2eb37d2bd5ba36255645648b71ed24ddab81956413d9a9f855000cc8b730b910101727f0cec539e1e4acccf7d0732c9717f56026d5d3655d13bdba1dc9ea24f5cccab4e76a58c80b4d11e9373c2eb67c928fa6b444c470a35224865666bff32373e58b3ee6040b86ac7487dd37a1fc6951ae175dc55a26862a8b040f6e15332031caa3bd00e5a32d2e5177912028f5a226bb8356bab70d195550c3c811963f057c0cbf1de8479cf7536346ad2408b7265dbbd9c0999c168772d5e0052ee93f56252b9e163f140d054de5969be9bae95a5bf48c51d8f19a30c1cb2b5c68459eb75b44218174e91f8850c5b05c693d4ec6d597fbf971a376a9bb14ca974ce53fb8e6d10d95bca3bc393627e38961de67d213bd58d009bfec4ac7a907e8a4a6e555ed6d51eb70fb62ae2e7916b5f1bc03a8e8980393f282f4f6173119fc5ca65af2e38f6ea243e08aa47b12f320c34b52d2296e734ed1bb0a5a159ce73e7f67fcb09930d12a399eab1a761ed4f1d0ff174396282703280bb72eabff38a999dfd33edefdfe108c5cb7c835e86cdf1f745c0d8de7d57947463fb53f76ba84445bcbf3db6e0ef4545b596f8d0afb2da6d8f76c7bb1376c0514fb7c8d3b7f28db1b90cdb413441c30e2326b3c71c5309d3316c7ff33b109dfaa572e5b4ff80cd29c7cbf5bd38f8fdd67b220d5cf9461f800eb2947012c21e95c413e12be4e5e4129d8ea3711136294598863007edb469fa3830f09f73c70cfdaf82e7cb4ed3c92afe1566febaf3617c54b197d97b0f431ad5c3d386ad9e94e63520abbd603606fd593cd288b4feafe3243bf077cb340ee31bb44da01ebd7803812fe2b1be8fe99c19e345acd4090d565dd46c5ee121238d0ecafb9f83eddcedeb4b3b629e9e0f190ab219a5afd2591ae4a018b694e2ab165d6bf3fa6a17ec508a83f0bff568c5b3b38d13b51278d726ae63537aeb0deb7d8265c16c034568b9f2f2831e8c0dc7758f1cdc6092df88ec512a73607af2f310e66e6c2c8c6dfd7f044775f84aafd598f6526991486724ae1fe4cc55309efdc1ac91c0e94fbe9dcb2c7e442f1241aa94aacda8770f4b8c17c29cd43448752b438b7d688e1b5e997ce9e209a1aa7ba4d5b05c2514449062e5b6a1ebdacac008a0d20626090b8bc9c68423e22f11874a4c77a1c25c1e7d1e373e4a477b4542b12541bc50c567e48d25740855e5d8eaad993ab77de3626efdc4eb2356134f863ece93ea071ab2ff58c713826ba22843b2e775b9e99d6928a5148f05505438838a81bed87b607ee9c594202ba1a07ef15139fb636aa007d004a3632b9c782ffe01043fd74e3d178c46fd6e0f33931c3e9f6ab0e56291b4e333ce3363cba294a512d47ad0b932922bab7c64087fcc4282ee6bb416d9de63f9d95246c85c3592ebeed18b3fef6f9824376e28db4467607207188f809cfe8136e32313822b0d8fa92fd20c002eeab897d9a508853d2bef69ec1180e1996a33273925c0ede541401009eeaf9d948eb4558974183bf7d2eeaf130247bb26494272aff8bfabc7c16ff56ebde01d551eef34e4d31206a99c74965b3465973e546f372080eacaea438b20af0dd8a742977ada840cc5143cd9acd68eee611f9f611537c8a66e8386a42cff8dd0a22e24db9f287ce384e0db1a1617496500b441ada0b52849bed03d962278ade0926366508d7535217d45cec69bb4b4fa3e44a45bcbd1ca319a47243be71fd8a3b76909b78c289f5e435889ad65b0bffba0eb0a9ee649e1cb57fc4edae5b754aa026f4f42e3ca759cb776385c14315efc749f4dedbcfd05574143d41d73500c3edb24a07941f197de285ce501e78b16420adf65d1ab776d4758e23d401d6147b5c79040c4fbe9dddf64e3edbbe7a26f87302a59d13c98bb03b7226a2849fb60b4b14a2f5ac2abac612af5d4a65f0b661a5837a3f20ab4f45e1a6701749acf049feb7582edded5a17d376b86ac4b4bbe6157c850faa93daf3a5d833ca1bda62d8df2ca602af93401223347e33fdea114429b1cfc9e613a4ec49f4b5d3fa115a88414fc3b51188c8eafcd8eb6a5b39fca29602bbf9980373a3a32cf8de8c3d8cddef8a3d75e339d237d3dc1a75a2dab3c10770dd31b7cdc2ab96b11168890afac000c8fc86ea73cd5b7d0626fc5de7b33c9f48c772a11e3f9ff898c6c23598df7584e08ca0802ed314510c4246fd6d814d47607a2cc96c12d86e922cb15981d6b0e5e2dc5eb2c30961c57b30160aaaf73e91ea6e16583bb5c411fe04eb06e86c6360deefe57fca1832d19bb4977c4105bf806206f8b75fa59010a6c004a5a90aad1e21a9d1468d4f80e09fbc11a8b3e25ef748534ad1d62ede0cc1ed82f1c05142da63f4ead49f3c07be424f4271219dccb939cdc8c91f042a8aa68ed7be067d32c864d5966f2e942dfedb3a46c9bfedd05fde7fcbd72902189ffd56fb42f4af37d9f4d00269a7823166f2232b544f58cfe8c3578da4361cfecd3660651d4c98371ef1e640e57a0cbc71d2c241e669c23dc4a202cc9bd3c5d159a8cff1dd81b0b9b8c3258e8a5e8c2f019714cbfe25116e1f1288408044eb72ec4abf51ddc6d272283de72836a8f0b4cadb2dd26905eb2bee402bcf958c721462d147c096840fc08c8d7004dea721f427e0b91b67111baeefe4de865ffb2f04b1032b359d39e383f8bf059a0f0737e6d9c4fc57dceb8f306d0058bce5873a81eaa354bce2f889f2496acf176fa49619f6ed3b474f2f14a0ea863accd43dc15fbdf31667fce884fde6da0b80b7b0f8c7b73ed8d0c59c117970393ca79d99d01b89a55d192a980286096887705875c1c73667ecf0270bf6704192f76c24ae4bdf07632c8173602e165385b19a7deac42862f84a84546da295a0890728cbd8aa140bf8e0727415fb7f7f2ef045f52aad11ff8f28f321969fe6a6556f891b1b57b6c3b18a1675fba7fba382082fcb68a3e43559a4c9a63eecd2e6ead9b4d51602ddf3d07a6fba1e56f3ef3cbdef8191ea328d5e4cbbba47387f88a30994a5ed33b3301e7193e10a4f921f1be2c5c47ce5a1034d9b45f01e2563ccd928fe2dfe4263c61ee267730e9376c8f3d487326ac4fc7ed443cff196dedc4c45f01ebafc9a475955871c6a8a066bc63d0958b9b87aef0567aca7a4db2e27e00d9bf7b883178ba9c5e54e995eaa22d300ace8061b43b0745560807dd8e01c3314e274ab6e1b6c95b23c23224d973c5351f187a2d423c6614b7a0c5aba93f9226261d626faaca7b46ca96a441d68d678b5aadd5af686321409cea8e9e9c68aac76e045c1a0a73f101dccfb37501deb7f37c9ccc9962fdc0bab49d854a58afae328b108cb204e08b35efe930d44435be5ef6618a5b7a60829e708fb6b29b171df899d73bb1ff05842cad6225118594fb352c5079b252d9949e7fa428632fd9cd651a7ec91168b6f9416c6c32384bd7535c58eca9e7610be7bb817f78b24e44627ff153156135b9f12d58b0770a34b451b79591bd1c08b6f6822828e80e132c2bd8e167c1e135e89cc79521fb7f44a7541026b19afddb88e6f94231b40bb15d0c7524eb783a40de19b6ec11d6f299edbd241f2353bf93f8f195a4ecd7d47bcfd767386c1d09a4a087afb97edd2acf0a70007ff25463a44cc7d7e0285b8dd941ef36346c6e3b05ce2fbc73fe5eee23cd71dba99ef444161c44d496b5f43f8e175acb46248a17c4b2a41a875f455ffcd96e08957345577275fad1d03c446283a9097f4a04e8e5c68b5d6c93898d8b184187d84fcfa8ca88c8812dd08ece72fdb94f75d710ef195d367f776466860c1a9062f20fdad0941ae467c4bafaf1cabadd572071372bf524c5c0586d945f3188699b74ff0cbc40f820d34c4b597ccf323f427e2151d9f48e02372634aa1473c610cbcd585ec1106d1396a99eb06c0fd58f0317ff990849148cd25f98c6ff47a90f78279025b542d03f98a671b6d71baebe81dd5eebcc2025261a9d34e8fef1064edbbf16db18a3f9fc3b6edd04012fe0ea85a6eb2c301f74f8e3c40d04bffce6092efbbd61f789bc7944a82868d0a6a72eaefdfdb30c20debf9424477709abc189b56c6d90774cb04ffe6006a8bb05eb9df6148b35c7273b97d716b5173f50802ed847cfbfe4fb58d1095246498a839df01cf16d6c18d1dde11bcf270716c834c6a8ef239ecee58ea74d9a20037fe4a68c5593c7011400c9294e17045e51f09c397288c0aca7969c223d0e5894c29afc4da6b0a1b5def88adc09c3cef24b1b83ebeea2a025e63525e6c683ec19bb4eb633d353c9369d682cef12cabc6f85f3d5581bfdad48c1288bb04301cef5a3a3d988df490068772a2d4e836c183a6f063e30bf15ef673f273457ecc6f589f600b407f5549a0e084bdbf1e65590d508d0347dd53723133e5907c27a9629b9e16351722a575bb81f0b83b833106e08e85c114bc783bd5d0f0290b91058607bff07ea0df58b0b0936cc8dd28db0623d09e949d7d7a997f2cce513e7547c0965d211896ebc8413346d65c6bb258e87a357178b5e2ce11335bee98a77c3de21fc8797c8fd13302dc2b478319994429321297153efa01390548be4d0a5b1f23fabb7e26fefb69f886c895df7a4b7db5641f59a5cabbec22a4756c4931c2f440f6886eedcab10febe825fc79bd954bf85bc063cd2f7cb8c225187c5bc98607a8907f224da4cb518aebd6f56c91e131b31407bd52a79e9a78aa73fb81980c576ab708b1f46d11b15c2ee54ea3fae1dac9f836d0cf5fdabb4bb4416ba78a53aeb52003ee1c9cc0088432bbfef133c2d081db538503c71a9f9f85e725ab25c3a53dcb67820116dfb6358287c029e2adbe27367bc8c2a531350a7af284b8d5124c2990a3f7c6fd4f9bd301cb597ec62b5966797535ab0b742e0e6f42872600ad2ba01531d0cdb8adadf81a5107b52ee223dbc33227ded05f149013a4d50bda5ba26d6eb608a167fec2f6af1b9629ca8adef4d93570b369c78d5f1731958609641920fbb173f4ebd659ebc19c2d0fa8e1d3a9fab0b3f0ec73757097bce045c085163d66a63e4edc2ecd12fd30ea6b79df807812b6f9c9d6a7dae0365ab4fb2f153c391899337e3aa34efd7582376837e4046ba5bea919fdbc175e0b983c7b3579c8e7223abcae5e83b991e587f4cf26d7461c0ac2ce3084d751a3f0dfa16e60b1acb8053b11570eb9c5a4cf0d920dd54925501166febb7053ae2f8124d3ad61150dbce6b19120b0179739e07e76ce13a661fa71df9e6929731c15b7261bb8ead6736c8518d48ccd9127c26ecdad48c4d018e599028a37cf2848b804f4ee50068e02b0253eb3bbbb348f7910607e651b38c4a7b4b94f7fca800a91c20fb533da6fcba99b7a869e052cdd85c81908567f25f1930d63f8918f4f96b5e643cff6c0f856b4b025a1c33788d729abbf711152c915884d80789d29abee42d6651cebe808484024e4064454c1d509bc2acc5654f5efa9a1e9bab9c5d45ef76418095c941cc7c9e2b40b505be5f89e6a60a9b8bbb0002bf0793aac9710504ec50fa2ae0c5b7fe6f287fa567ab4fab972e1274b585575a78b11280274ceb9e0555c100d1394bedbfc9c9a5075be9003fa50612cc532626d53f44fc9749d038c3c57c021c7c3ac2939918a5a90f10def3e0dbb24b95e59318980f10ee298823950d3c9e4ca5f8fd533337874cdac4093066886c6f8f77a018d68d53dbf1b7f952d163b9c39a541c5365b7fddedbe597bb4da6c018ab31e2553e7d3e25e7aadee985c89913901fc1c13baab4ae1d67d5d8976485036486200fa20f7c6a7bb8afe59fb0437a86ec872c48c43740cfab5ae53e7c0de0eb82a246e569be2b281da2a327aa0d9561d5c2c2ee2ad90b871a2336fbf8e77e49926ed6d9fb0c8061cff4349caf64f79263f78d78eed54b53aff01416c9e23ceca0ca0deacf0cf33045c2337271a2eb127c4c73cf50175e56500f4e8960e07ae750f5ccf60bbc4b16aa892db61a6ab5e4f92389039d5c898c6d36ccd2d488894aeb0723aa7a57454b2dc19970a81da6bda293742fa62d5aff3a5d17c434ebe6ced4541520ff148e4aa67a8f7a11eaf18c0319485e57a2640777fbb2257b9866cb9d51f8ea47625c634228878d486c4a6fc4fa8e6e6fa827f7a3029231d9c4ab90982e826d73784d273e9637fd1f53db01c2cb53608bae56e0ddc6643e0bbfa260e7458fef81e96254e45d1b049541c8f9182d2f340a9d857758e568d2730ee5eb246ebe11d6f43b147cb07c73618ee6006b55891cbc7e2b3bffb666de32c62596a64612d743b4b8da6d4a009efbf3d2f2d2c1288e3859172909f1eb184e6ee686f129c3d9128ba2a3d17420ad1af5c6522dd75bb38f91d6f1e1634a957c01fd5793b7f35b159d53abc854d6c672d6dd38cf68f905ad019b886893a47c9ff52dd4740dd2a353b2a2acffa1004a2f21b7b6f1685ea323f4eaa8f0af64f46565070948666b12a4abc70e133013ac6762de5c73eaccc595a08e53e72db4a988302198bd52f29243521772865428568a79d53ec9433e5d2114425d980a1fce967c8b27ed032ce2418698b2c05dec19cb349a0d33efa46d9a3352bcffcb32756cae8f5e9bee0fe3d6d54345c69824737fccae298d71313f74447190acf849df21da5375bb7a4e69394733d3daa8c53445ea9bdb2e60876dfe824224a42d877c58e7430b06fbd73c39539b8446d03fe14eae355e467308bfabcbcc1ddce5cf70ad152eafea3c0eaaad8becba3effd44c6f6cbaa8c3f7ae8f6b9ea5ceabcdb525743979a42611742c1ad3a43b22546121d3b28382ddcf530afa8ff95879eb4a8c860a940264af6e69fcdd128685bfe55848ad2c0b4783e6e5f073731afcb7a92b8bfb7eb634e3bcd0f8ba458d6dd10ce63b075dd3cedafea82ed3488cd08d309f0ba62d0403975869f862af8800892f658b7d60d12f1f8cabd235674fe4bec0d40107861ee68cd9867f074544e6091b8c7b9a29d259b6587e6a9c50d607a0a0de2051e82b1a8ff5152c14f294267368cc65453e092f3041b6f0aa37da48a0bb06f0f9f0e8c268152475a5ef9c51ca2dc5b5567697cfe9a3f35118eb6b86215fa88884bf5dd4f55d6eefe5c84d015ec6e952174c06d6d9873c3cce4f477ff00f3e73e8afd5619e712cbf55a794ddf7cebc41ab7584645326af32974ba9eaa5da6e0ba2ccf5971c976d75228e6eea2c3f7067162c6557a4757600dfce29d86a43665e061b9cd54aca33df653793c6ca38e3ac2a0e607e8417a3fb241166b5952bab4329b796adaeffe2983801bb6d9f95e0e6d1e703697e61572c0b3274dd7e3165a82eaf0cb192c27eae134aaf0b414b33274bddcbb566df3a28b179c0c6fa6766f826a3bd8e20048d7da8d1f07fcd5ba2c2f08211993bbee8350040e25686d4c513888613a85fa938081ea21ab52fe3ef6a393ba9387ea0f94de2947aa1d86edcfdaa4b675e8272b1055ea898ac05dcd9d10e8ac86d3b81996ecfb74bc4662356073124dbac25450a8db69284d2466c71b2b94c1bcee5ce08e5fc3f5c14985a1615a318f7de7db300faa89ff06971046875b2d5a3da3c89aca4ee89f671258686164e402e27e81e4a41a3538546884daac3cc9618076243741f1efb9948700a1d6cda01fb5271959e8598ee58516d9a5ccb0a7d9d313397a600cd8d470d6605cdfcf374a872c2113d127c533b81d900f074f7233838063189dfb4b9b83c661afebe50d8aa592a33c6b07508944729b49ad4d35627097f796c38b2c1b2deaf29174faa62c9c9ad78ef0a078bf2a19940ac146eaa1a3f7aba85b1b7e885bbaa01d51e3c2e276cee7a7516c152a11a01be0eebf143089d8d5b6d72fdcd29fcd33c42c082ea245d5c7973bd5fe8f56614e9aea589d8d09e393afdfa20af3edba16d67b79041a7ce2159cb79a48c6a505df5a1fb9fb50daf97ec9ed27a69e45dc90ae9d5578ac0b66e31c7633c41963455b66d186cb489eadedcd17cf721ee2d183af29dbaad0b94b06821d7ac838d8ad43bd775f55af55b3037e6eccfe30299562e9c57de837bbd33d6e9b982747f80c261043a575bf69a38444b06569d0adeb642821f3b6aca233859290a8df1731634cac8b8f043a13720396af12026ed6ab943207921389a42b885255ddb88945df498ddc3f9e9924dab32f59762f9b2ddb236c2d3dc7433466edc99b0edebaeffe48f972fbdab652ef1988494c784c49ed15a2974e102cb5115c15d1bf1b5089fee5b8c93d0afc67e91e9287c6eba50dd1f7f4f5f44310cc8995fd880f2c9c3610ae83c8ea9e778b776ca2e23a24032d2ada56ca1096f4c94facf9096baa9d9e355b02f63fdc3ce2b28d6f1b992f3614135e5795076efde8e3027d69353dfd73cc227c78b1518b3d7a3da3cea20ebba9f1f0eb286d1edbb5d0108aef0a7e564d570583db621781e73f3c9d9098c470b530a648eafe521dd5c789fe83b78b37736c10aa509f92f55db3efbc059b142dfde42a8aaedd418a90acdb33ae7427ddc76d5c355ab486fe50a2ada1a8765d491c87077eca64e6c2d54c11147c62dbf21291b50a997e5aacf94d21eec90182201cc4bf6f2c315484884928cdd6844e6283f7bc67f167ebbc08b8a372a49f2c3b17571b7d8e5c7683196b8521be9ecd95fbaa005789d52ade4992cf308c0d7c2eaed5b163a0af409ef35a39b1b514f9cb04cb3bcb854ee04cd4f624bafed5f3a02f253f5e6f509e6d0033cd0cec745087a9f143c17afb39283f4e634bca8df87f9d5a7a687fe0f5a5aa79ce9da7dd5ac6a689b3a4b34b531f4f2ff68945194dfa165745007433238bb2ab6ce1561de978b9872342c5ca87436082eb95398480c62d4c191ce4ac453a7830d401570adf6b4ef82dc2995729f8d12442cef0f92bffc56ef88b4a4eecaf7a7cef738c4da318dae77de955a1dd1f58416b1567a540694c71397554f8c4584ce2b83c38a2a2616cc6223203618fa27011390e5ec0a865971d752e632e21fc54bb9de2c1bc706cc88ead561d0d93f36535d3759b7075939af53365f45afb2532c11d95bad6298cb86a33ed80e83305351cd972d461bb609cdec83cacdbd743c11de5c23615eb023a085ce0fef733282633f9dc212545746650662ad5be2bdc69282fc7749dbcfac65a6c61e805e9c3c20bacb33ba7f2bcf8643dafbccd9a1fa04ce89cebb894154a708b232c0fea6aed8abfe39a5f3dce5cce1dcba3a902406746f45c13fb9b4c9218a9fdb8e37cc4cffd45393e4d2ad72fe56dae2afc235b033b95202ad0015351132f4b5e7b21ddea4129e52c967438554dbef1032cb4ef4a5a2c8f48da2c4515d58375b9b7f27a79c071177c0747966db09de89cedaae3f5ddd84cd59b7f5635792096b0cc198542106782cee5ecd31ad3d31bbf76d8f70a3bc5ba9de1589d39bc2fd579e14d368642bc1889b3861d098814a714e023c1283842f0e9599aa7bd9ed1f77b019d930440140f29074301934b4dafad2b7ffab6fce2e3766fd84ab34edffc20195c04c0f35c8c28dc7cd0a6f8744b266ab505497df35b57bf781ffa0534ba73eb70bdb5f9c48a416392b533e75afa13e4f90ae3c2c90e0065f8f96ce6f4be91072958c642577a360d8aec2789d0587182ff9be681c5b2d482f514d675fbd0a5ff5410ef2e84b11fdcfef1c61f54b0e770d6ef54b998f4f87669611de374ab27b3203d0a4958fe48a05d77c24a443b406bb4e4438643f0de834821c9ed9e9e8fdc4851dd1379c112fad60bc6648fd7e675dcc2e224bd191e8d11e497621506d6fc99f7c010f496dbb18570afd32031b5278dc29364018464bf24146f9dcf4609e303022abdcb15bbb660a4ecc987717dafa299ae4f75659071c54cfd02e5534114670b211ac21eb375caa6ac17dca8ca8c26bee91c7852669dfb093675934f8ea48730e7bc30e9666835d9ee499d529c67833c2ea863fa899747fc283eb82f7178fd898a219a1d76f18b0413c248dfd2fa4f76b58bce9146b57bc84fdf95534c47c79ec8e9001cb81d45392de2b971ade52e1cd5b7296fec48b1c46c0d9868f43e92a42164933bd8d1d727a7cca76734e6e3d0df6ac925e3ed1f6dcbe28f6a10287e137159765a79f0892fcf63734ef343bd5e9adbe6140a62fb60e2c30b1e08a7cd8a6659294a68d2b0565b89118c8c938eaf839dbe58e267c93c1b7d2c0a55655d24992e34beb86e46e2a2701c9fd4bfbd776538ecebfe6d7c1e0a162374f55ac7999794232b3b180d6bcbba0625f25868aeba5615836c14ed83ab1a4cd153ddc73879597b93c60d45e092d41c11da49c8e5abf5d23628ce634085efca5e7c566405d880d118a005c5bc0b27722c43349604b62347bd042b5c1baef962caf2917f662ffa6b7d16393c2d8a5f0012f767077e393f5254e520bb335f9c592fb5d035bc42bd1a4e32a50cbc4393913b318d5134b5695563c616c7baaa814e288ae8109c06c64072357f805ea22cd3a69ada2edf2683feafdc3e5bbd4db418e18958eaf997074335251c2151549479ac09995fe038010225c168c12f5014d042a7e8feb4e35178ec392b3e039320e3ad40e87559b107951f6aaeccb220757f408abfb08ffe286827c0f5ce442f5fcd77b9676f0cd023af029f53cd3907008f1cb3dbe9860c03436fd258c8c9e8ac7c5f734553cfe806686ab3904072adb4d21e14566c1ed1a2df7b262794a2c23bdea8d74e4dedf0da8aaec33e157c856f2e0309b4bb6bc32933a65af94505d0eba7b4bbe09af154976cb4ca0406b58a8a8bd7b501a917f333aa7425196352eba6904e5bd37649aca801e90e54d82638fd6c428fe1d16d3ca2f1932647c6531ec32e7c8a1b9ea9cf35ca5a926f3013a4cd7e655f7a33eba7b77cc7a3b7183ef2b3ce589f0e5c5004483080c7464cb1e82a8e860ca739a6f46c63589d0bb2e239630a7d46a274ef07b125abd4b3fe02810ed34a9538cfeb3ae7a84df06245e4ce84f61feb3998d8c3586b475151da6849900b51d7b20a05b97c707b750954ac50895306b2b1d03e920b0faf0dbed61c87a532ed56eaa4b1e8ed994999604017c2e2596c1176f502ec52d95eb3d4394fc5d29c605eb89ef43cc0d584855d3c83e4d0902b315d9cb6eb20d47ece5183209df8020f3755dc1c6e6102263b00c1880194d62194df7f0b3d8a779df6fdbb5f790df34ee31a2035f575571b84118cf8dd3e4a7e86c3f55e9fd55e718a4643ef476fbdd2591352cd4fbcef1c8169d6848b8f894983cc01c09ac9e335b38cf877ff05ce730633d6c5f4c46d61107b7c8f14979ce58e4c561f946438db396d4f29819a4d6934076059738ce0f1856f78ae3caf67918a9072ed3a3f47e60743c0c4e0253d4e527e804f9fe31383a6e114a1a53cfac7854057853dcc83f15deee9505cce30bb2003cff5f92ee89f94fc052a3cf1d81b55bff84f8bd7ff688c7d34f2d9f05886a84c0dd784d0fc267a26a6fdeb5fcb0d936afb5c62e17315738630bb63f62ce8f3b18011eac9aaaaffeb7060aca60537fd0d32c8ef0e766be0890bc543c9e5a4432485afb60cef3231461839844342ce2bc4270864c5b48e7b76699f0c291a1d0f0860f836c22b29b6fbc88d2081fcd86606e8092abec1813d0567739d53d0aab5f4c23f6b5b7984449f60db1bd92aa3f867452a6f21ca19c0fb7c15cdeb717ca3285ed190cf37d2aeae924043584ffbd4f6106f39e2bc54f7920ef80f1bd447c403d24c642400d9ae9ad4e15dd28d71c924374f18142ae39134c20c85dfa08ec602ab893f17be0e6b70554547d66ce324078d8b980334638b30241f7d75814e57c842dcda31d9a777d1b94aafa4f6bbd519fc813691b4a5eaf5c490589b36facba1756d72fb53ba6aa0b8f49cbfb5a6c8141c8615435da578473e8982d263f2062459de786639c74dc100d318e8bb96392dfd46f676105d721702d5286dfff781d011f5dc03bd130ec33e95e55cea389088541d98b7bd2be95db475b2c5ace3a2a1b385af3e8d8f12f0d62b107ab986a1e45fa69deb8508fab4cc7befba685e4afe5df25b6b2f20f38981b05c7ba09882d31b519b3b680b586bd7621f261822b6d1fdf62e267a40b7afdda9b1fc6b9c4b1af439e47bf8471d1a8b992327aa5e0210ec2c2666e8f533dba17fe3b922357a69d2f1382d7e02f5aa86ecc685db96d1b5220614a768432fdf2fac3793dd87dba2a01a061845c177099ca7a88667c4accab68eec5445f83f92ab37377b788578bc18b8be46551e5a2f616b43f4a1f5d84b444cc9ab6a48885adb3f7ffc7cd75baedfd9c1fafac1c22e503ea747777cb6ec7b03b5741833af7e89654265036d85f7233cd6bc9ca928f86d38762cb1f2f67a57f4feb8e56bf44179082d432874ba032f1a6dbfcd00549cada0d4da4e82b9c8b513e4ba1cc956f44fb28906533d0a93be60a8763af6354f3593f3eb6d44b6877faa19f7473b5c31a111bc62235f08d75359fb81eaab5c6b6ec321c2f9af51498d23eeb13f6b29d6497a9ab5494c63e66007585d6dee7b64a936404d9bf7c7522d1c70c6b2b0978c1886ccca47dd72334f5dcd6e48d66e6f95e82d2c558d92f8fd2751e8abc3cb72ebbfaed721880f2549a3840de150f77ee8eee18bc0026d4abda62f702c9fc253402642a807e43011dda1febd124068791bb3b38060c6fa216f3f25ded308b7b2314d763538f7e8a72adf3ed856da40fdcdb5902378abd242662d8e5672c4a3c7ee99ccec4c7aa24317621e4a552295b86b20d5768ec3233365027721e3bcfdccf5c19f31a571bde8ac99333dab92645f55f56b972498b9fd69ebaa033a5e3c9f88a75bc9e11757dac607b6774a773b17aaeb45d5545acc0c8fdecc2bf30da902d5239c427900dda288c16b217efc38696ece4a4f77d5e05543a600a133b590e7a8f1e2312d756bf00bf2cae8ddd2f392445738c1a71a7f04fa402a5efea44aceeea2266751a2e8616a2f06179798dc223104856165b43594746f8fbc868713bb243e1692ef1427e917a76d7b033367f1cf7fd0d4116077d31e9431cc20c38f8a5e6f60937cdc088fce6a87f529e4ad89869b511c7232a84e2a965205c954c328e1192df22ccdefd758f8b1570354fbbdeed4846bcdce4d4fc957d9a02a605fe8acc499aad17183619adc3f7ccc454cd738ef9853bfbd1d44cd264811854d7533162864880554864801814e2f8743d6877139b4b175c8d8b7832a962a75c83405b6507106a525a129eae681d19007a16a6a46eeddd2ff0f04d427db2201ed48a44667666de996827cd630091a4f9ddbe1d8fb1a2de9204c31841812266bea4ac74fa4212ea623750decb6cfe7cdce2aecc9a9ee503b959978173de6f36b993d59a63cc9027bab9620dc0da6d40724d4fa053e3d0eb3fe36bfc196179300541c47ae35607d07c44fbc854dcf7ef5995553cdf37a30a6685fa1b5f16a77ba7322cc188dc009c750ee473a6fb09f0f0db3e53c4fca80d0cc7d3e2fb5d7a65a1a948cf1b8f5234cf82f1a7afca1b35c1be97113b9c8952bf252a62388565808e9ad890ac76e2fa4fddab49a86b6150fa29f7078edb00061507d85b3e01c893bda68810376b1eee73ea595ff730648480dc562edf8f88ea60cbc6414a32cde0265da3d5d590ea81c8c959f0525ac0f5731d7f6f5473a4b15efdb949cbb9b7a5c52a647e713eb32b1f9f8433801f5cc9cacb9a83a9b784ed6265f1b013cd111a176d2afa69e0a5f9f10787493b149f5cbf13c4f11084a8690dac1196052a23d6985ca44f6f0b2c6dd7ee5599c90a57390e653fa84a65e4182a6ce2583a5e4cbe04324a6c90ce6c4099011aa181b4c11291475f757f7f867b40f486bf3522d0720afd50cfe098d6d835cb7e1adcf6d488eca2c036965474c7e10b5554cfa5ee5bbe92135cd7865cb0e9d950620aab266396441f1483a3e00b0010c8ea9f17712</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分治 </tag>
            
            <tag> Tarjan </tag>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> test </tag>
            
            <tag> 优化 </tag>
            
            <tag> 单调队列 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LCT</title>
      <link href="/2021/12/12/LCT/"/>
      <url>/2021/12/12/LCT/</url>
      
        <content type="html"><![CDATA[<p> 背模板吧</p><span id="more"></span><h1 id="LCT"><a href="#LCT" class="headerlink" title="LCT"></a>LCT</h1><p><strong>LCT</strong>，<strong>Link Cut Tree</strong>，中文叫做<strong>动态树</strong>，顾名思义，是一种维护动态的树的数据结构，可以维护一个森林，支持加边、删边操作（但必须保证是<strong>树</strong>），时间都是 $O(\log n)$ ，常数有点大</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>其实主要思路是<strong>将一棵树拆成很多个splay</strong></p><h3 id="虚实边"><a href="#虚实边" class="headerlink" title="虚实边"></a>虚实边</h3><p>和树剖类似，动态树将边分为<strong>虚边</strong>和<strong>实边</strong>，每一个点到其儿子节点的所有边中，<strong>最多有一条实边（可以没有）</strong>，而于树剖不同的是，我们用<strong>平衡树</strong>维护实边构成的路径，具体地，每一条<strong>只由实边构成的、极大的路径</strong>（特别的，<strong>如果一个点没有实边与其相连，我们认为这个点对应一个只包含自己的实边路径</strong>）都对应一个splay，splay的<strong>中序遍历</strong>，就是要维护的路径（从上到下），而splay的<strong>后继和前驱</strong>就对应树上的<strong>父子关系</strong>，而对于虚边，我们用splay的<strong>根节点维护</strong>（具体的，根节点的父亲对于虚边上的父亲）， 如图，实线对于实边，虚线对于虚边，红色部分对于一棵splay，不难发现，在这样的定义下，所有点都对应位于的实边路径：</p><p><img src="https://s2.loli.net/2021/12/12/aHpuSNOeUBWkoqM.png" alt="实虚边"></p><p>为了维护虚实边，我们有以下操作</p><h3 id="accecss"><a href="#accecss" class="headerlink" title="accecss"></a>accecss</h3><p> $access(x)$ 可以将树上从根节点到点 $x$ 之间的所有边变成实边（明显它们也就在同一个实边路径上了），并且 $x$ 下方再无该实边路径上的点（换句话说， $x$ 就是该实边路径的终点），这是LCT最基本的操作，执行完毕后 $x$  就是所在splay的根，具体如图：</p><p><img src="https://s2.loli.net/2021/12/12/GA6aSNO9JPIkzRQ.png" alt="acess"></p><p>如果要把 $x$ 和 $y$ 所在实边相连，可以把 $y$ 转到它所在splay的根，此时 $y$ 的左子树就对应 $y$ 所在实边中 $y$ 上方的部分，右子树就对应 $y$ 所在实边中 $y$ 下方的部分，然后直接让 $y$ 的右儿子指向 $x$ （我们从下往上进行，所以这时的 $x$ 是处理完毕的，并且一定是其所在实边对应slpay的根，这相当于将 $x$ 所在的splay拿来代替 $y$ 的右子树），这样， $y$ 所在实边中 $y$ 下方的部分就变成 $x$ 所在的那条实边了，特别的，第一次操作时让 $x$ 的右子树为空（保证 $x$ 就是该实边路径的终点）</p><p>要完成access，只需从 $x$ 开始向上操作，直到根节点即可</p><h3 id="is-root"><a href="#is-root" class="headerlink" title="is root"></a>is root</h3><p> $is\_rt(x)$ 可以判断 $x$ 是否是<strong>所在slpay</strong>的根节点，注意判断的不是原树的根节点，只需看 $x$ 的父亲是否有 $x$ 这个儿子即可（slpay根节点的父亲维护的时虚边）</p><h3 id="make-root"><a href="#make-root" class="headerlink" title="make root"></a>make root</h3><p> $make\_rt(x)$ 可以将 $x$ 变成所在树的根节点（因为树是无根树），只需先 $access(x)$ ，此时 $x$ 和根必定是同一实边路径的终点和起点，翻转即可</p><h3 id="find-root"><a href="#find-root" class="headerlink" title="find root"></a>find root</h3><p> $find\_rt(x)$ 可以找到 $x$ 所在树的根节点，并将其转到splay的根节点上，只需先 $access(x)$ ，然后一直向 $x$ 的左子树走即可，走时注意push down</p><h3 id="split"><a href="#split" class="headerlink" title="split"></a>split</h3><p> $split(x, y)$ 可以将 $x$ 到 $y$ 的路径变成实边路径，只要先 $make\_rt(x)$ ，然后 $access(y)$ 即可</p><h3 id="link"><a href="#link" class="headerlink" title="link"></a>link</h3><p> $link(x, y)$ 判断 $x, y$ 是否联通，如果不连通就加边 $(x, y)$ ，只要 $make\_rt(x)$ 然后判断 $find\_rt(y)$ 是否等于 $x$ 不等则令 $fa(x) = y$ （因为make root后 $x$ 一定是splay的根节点）</p><h3 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h3><p> $cut(x, y)$ 判断  $x, y$ 之间是否有边，如果有，就删除边 $(x, y)$ ，只要 $make\_rt(x)$ 然后判断 $find\_rt(y) = x \wedge fa(y) = x \wedge y\text{没有左儿子}$  ，成立就断开 $x, y$ 之间的边（双向断），然后push up</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P3690">【模板】动态树</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Slpay</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">2</span>], fa, v;</span><br><span class="line"><span class="keyword">int</span> sum;</span><br><span class="line"><span class="keyword">bool</span> rev;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ch(x, y) tr[(x)].ch[(y)]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) tr[(x)].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) tr[(x)].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[(x)].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rev(x) tr[(x)].rev</span></span><br><span class="line">&#125; tr[N];</span><br><span class="line"><span class="keyword">int</span> stk[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tag_rev</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">swap</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>),<span class="built_in">ch</span>(x, <span class="number">1</span>));</span><br><span class="line"><span class="built_in">rev</span>(x) ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sum</span>(x) = <span class="built_in">sum</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)) ^ <span class="built_in">sum</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>)) ^ <span class="built_in">v</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">rev</span>(x))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tag_rev</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)), <span class="built_in">tag_rev</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>));</span><br><span class="line"><span class="built_in">rev</span>(x) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_rt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ch</span>(<span class="built_in">fa</span>(x), <span class="number">0</span>) != x &amp;&amp; <span class="built_in">ch</span>(<span class="built_in">fa</span>(x), <span class="number">1</span>) != x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line"><span class="keyword">int</span> k = <span class="built_in">ch</span>(y, <span class="number">1</span>) == x;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">is_rt</span>(y))</span><br><span class="line"><span class="built_in">ch</span>(z, <span class="built_in">ch</span>(z, <span class="number">1</span>) == y) = x;</span><br><span class="line"><span class="built_in">fa</span>(x) = z;</span><br><span class="line"><span class="built_in">ch</span>(y, k) = <span class="built_in">ch</span>(x, k ^ <span class="number">1</span>), <span class="built_in">fa</span>(<span class="built_in">ch</span>(x, k ^ <span class="number">1</span>)) = y;</span><br><span class="line"><span class="built_in">ch</span>(x, k ^ <span class="number">1</span>) = y, <span class="built_in">fa</span>(y) = x;</span><br><span class="line"><span class="built_in">push_up</span>(y), <span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> top = <span class="number">0</span>, t = x;</span><br><span class="line">stk[++top] = t;</span><br><span class="line"><span class="keyword">while</span> (!<span class="built_in">is_rt</span>(t))</span><br><span class="line">stk[++top] = t = <span class="built_in">fa</span>(t);</span><br><span class="line"><span class="keyword">while</span> (top)</span><br><span class="line"><span class="built_in">push_down</span>(stk[top--]);</span><br><span class="line"><span class="keyword">int</span> y, z;</span><br><span class="line"><span class="keyword">while</span> (!<span class="built_in">is_rt</span>(x))</span><br><span class="line">&#123;</span><br><span class="line">y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">is_rt</span>(y))</span><br><span class="line">(<span class="built_in">ch</span>(y, <span class="number">1</span>) == x) ^ (<span class="built_in">ch</span>(z, <span class="number">1</span>) == y) ? <span class="built_in">rotate</span>(x) : <span class="built_in">rotate</span>(y);</span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> z = x;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; x; y = x, x = <span class="built_in">fa</span>(x))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">splay</span>(x);</span><br><span class="line"><span class="built_in">ch</span>(x, <span class="number">1</span>) = y;</span><br><span class="line"><span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">splay</span>(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_rt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">access</span>(x);</span><br><span class="line"><span class="built_in">tag_rev</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_rt</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">access</span>(x);</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">ch</span>(x, <span class="number">0</span>))</span><br><span class="line"><span class="built_in">push_down</span>(x), x = <span class="built_in">ch</span>(x, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">splay</span>(x);</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">make_rt</span>(x);</span><br><span class="line"><span class="built_in">access</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">make_rt</span>(x);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">find_rt</span>(y) != x)</span><br><span class="line"><span class="built_in">fa</span>(x) = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">make_rt</span>(x);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">find_rt</span>(y) == x &amp;&amp; <span class="built_in">fa</span>(y) == x &amp;&amp; !<span class="built_in">ch</span>(y, <span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">ch</span>(x, <span class="number">1</span>) = <span class="built_in">fa</span>(y) = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;<span class="built_in">v</span>(i));</span><br><span class="line"><span class="keyword">int</span> op, x, y;</span><br><span class="line"><span class="keyword">while</span> (m--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">split</span>(x, y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">sum</span>(y));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">link</span>(x, y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line"><span class="built_in">cut</span>(x, y);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">splay</span>(x);</span><br><span class="line"><span class="built_in">v</span>(x) = y;</span><br><span class="line"><span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> LCT </tag>
            
            <tag> slpay </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4883 mzf的考验</title>
      <link href="/2021/12/12/luoguP4883-mzf%E7%9A%84%E8%80%83%E9%AA%8C/"/>
      <url>/2021/12/12/luoguP4883-mzf%E7%9A%84%E8%80%83%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<p> <strong>“我的splay常数小”</strong></p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4883">mzf的考验</a></p><p>一开始要写<strong>平衡树</strong>我是拒绝的，但是没有办法，最讨厌的是它要求区间旋转，这就意味着只有FHQ和slpay可以搞（其它的我都搞不出区间旋转操作），最后，决定打splay（主要是FHQ不会），然后看到讨论区说这道题<strong>卡常的一笔</strong>，我留下了历史性的flag——<strong>“没事，我的splay常数小”</strong></p><p>太久没写slpay，写的有点困难</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, D = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> p[D];</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i, d &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">x[i] = d &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Splay</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> root = <span class="number">0</span>, num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> as[D];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">2</span>], fa, v, size, cnt[D], txor;</span><br><span class="line">LL sum;</span><br><span class="line"><span class="keyword">bool</span> rev;</span><br><span class="line">&#125; tr[N];</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ch(x, y) tr[(x)].ch[(y)]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(x) tr[(x)].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> si(x) tr[(x)].size</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rev(x) tr[(x)].rev</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> txor(x) tr[(x)].txor</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cnt(x, y) tr[(x)].cnt[(y)]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fa(x) tr[(x)].fa</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(x) tr[(x)].v</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">si</span>(x) = <span class="built_in">si</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>)) + <span class="built_in">si</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)) + <span class="number">1</span>;</span><br><span class="line"><span class="built_in">sum</span>(x) = <span class="built_in">sum</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>)) + <span class="built_in">sum</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)) + <span class="built_in">v</span>(x);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i)</span><br><span class="line"><span class="built_in">cnt</span>(x, i) = <span class="built_in">cnt</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>), i) + <span class="built_in">cnt</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>), i) + ((<span class="built_in">v</span>(x) &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line"><span class="keyword">int</span> k = <span class="built_in">ch</span>(y, <span class="number">1</span>) == x;</span><br><span class="line"><span class="built_in">ch</span>(z, <span class="built_in">ch</span>(z, <span class="number">1</span>) == y) = x, <span class="built_in">fa</span>(x) = z;</span><br><span class="line"><span class="built_in">ch</span>(y, k) = <span class="built_in">ch</span>(x, k ^ <span class="number">1</span>), <span class="built_in">fa</span>(<span class="built_in">ch</span>(x, k ^ <span class="number">1</span>)) = y;</span><br><span class="line"><span class="built_in">ch</span>(x, k ^ <span class="number">1</span>) = y, <span class="built_in">fa</span>(y) = x;</span><br><span class="line"><span class="built_in">push_up</span>(y), <span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == k)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> y, z;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">fa</span>(x) != k)</span><br><span class="line">&#123;</span><br><span class="line">y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line"><span class="keyword">if</span> (z != k)</span><br><span class="line">(<span class="built_in">ch</span>(y, <span class="number">1</span>) == x) ^ (<span class="built_in">ch</span>(z, <span class="number">1</span>) == y) ? <span class="built_in">rotate</span>(x) : <span class="built_in">rotate</span>(y);</span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!k)</span><br><span class="line">root = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tag_rev</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="built_in">swap</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>), <span class="built_in">ch</span>(x, <span class="number">0</span>));</span><br><span class="line"><span class="built_in">rev</span>(x) ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tag_xor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!x)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="built_in">update</span>(as, d);</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; D; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (as[i])</span><br><span class="line"><span class="built_in">cnt</span>(x, i) = <span class="built_in">si</span>(x) - <span class="built_in">cnt</span>(x, i);</span><br><span class="line">res += (LL)<span class="built_in">cnt</span>(x, i) * p[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sum</span>(x) = res;</span><br><span class="line"><span class="built_in">v</span>(x) ^= d, <span class="built_in">txor</span>(x) ^= d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_donw</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">rev</span>(x))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tag_rev</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)), <span class="built_in">tag_rev</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>));</span><br><span class="line"><span class="built_in">rev</span>(x) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">txor</span>(x))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">tag_xor</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>), <span class="built_in">txor</span>(x)), <span class="built_in">tag_xor</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>), <span class="built_in">txor</span>(x));</span><br><span class="line"><span class="built_in">txor</span>(x) = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">push_donw</span>(x);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">si</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)) + <span class="number">1</span> == k)</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">if</span> (k &lt;= <span class="built_in">si</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)))</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">get_k</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>), k);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">get_k</span>(<span class="built_in">ch</span>(x, <span class="number">1</span>), k - <span class="built_in">si</span>(<span class="built_in">ch</span>(x, <span class="number">0</span>)) - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ll = <span class="built_in">get_k</span>(root, l), rr = <span class="built_in">get_k</span>(root, r + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">splay</span>(ll, <span class="number">0</span>), <span class="built_in">splay</span>(rr, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fa</span>(ll) != root)</span><br><span class="line"><span class="built_in">rotate</span>(ll);</span><br><span class="line"><span class="built_in">tag_rev</span>(<span class="built_in">ch</span>(ll, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cxor</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ll = <span class="built_in">get_k</span>(root, l), rr = <span class="built_in">get_k</span>(root, r + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">splay</span>(ll, <span class="number">0</span>), <span class="built_in">splay</span>(rr, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fa</span>(ll) != root)</span><br><span class="line"><span class="built_in">rotate</span>(ll);</span><br><span class="line"><span class="built_in">tag_xor</span>(<span class="built_in">ch</span>(ll, <span class="number">1</span>), d);</span><br><span class="line"><span class="built_in">push_up</span>(ll), <span class="built_in">push_up</span>(rr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ll = <span class="built_in">get_k</span>(root, l), rr = <span class="built_in">get_k</span>(root, r + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">splay</span>(ll, <span class="number">0</span>), <span class="built_in">splay</span>(rr, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">fa</span>(ll) != root)</span><br><span class="line"><span class="built_in">rotate</span>(ll);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">sum</span>(<span class="built_in">ch</span>(ll, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> ff, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> &amp;x)</span> <span class="comment">//类似于线段树</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">x = ++num;</span><br><span class="line"><span class="built_in">fa</span>(x) = ff, <span class="built_in">v</span>(x) = a[mid];</span><br><span class="line"><span class="keyword">if</span> (l == r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">si</span>(x) = <span class="number">1</span>, <span class="built_in">sum</span>(x) = <span class="built_in">v</span>(x);</span><br><span class="line"><span class="built_in">update</span>(tr[x].cnt, <span class="built_in">v</span>(x));</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">build</span>(x, l, mid - <span class="number">1</span>, <span class="built_in">ch</span>(x, <span class="number">0</span>));</span><br><span class="line"><span class="built_in">build</span>(x, mid + <span class="number">1</span>, r, <span class="built_in">ch</span>(x, <span class="number">1</span>));</span><br><span class="line"><span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num = <span class="number">2</span>, root = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">ch</span>(<span class="number">1</span>, <span class="number">1</span>) = <span class="built_in">si</span>(<span class="number">1</span>) = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">fa</span>(<span class="number">2</span>) = <span class="built_in">si</span>(<span class="number">2</span>) = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">2</span>, <span class="number">1</span>, n, <span class="built_in">ch</span>(<span class="number">2</span>, <span class="number">0</span>));</span><br><span class="line"><span class="built_in">push_up</span>(<span class="number">2</span>), <span class="built_in">push_up</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125; tr;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prev</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; D; ++i)</span><br><span class="line">p[i] = p[i - <span class="number">1</span>] &lt;&lt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">prev</span>();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">tr.<span class="built_in">init</span>(n);</span><br><span class="line"><span class="keyword">int</span> op, l, r, x;</span><br><span class="line"><span class="keyword">while</span> (m--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">tr.<span class="built_in">reve</span>(l, r);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), tr.<span class="built_in">cxor</span>(l, r, x);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, tr.<span class="built_in">ask</span>(l, r));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>断断续续打了有2d，交的时候过去的话语犹在耳畔—— <strong>“我的splay常数小”</strong>，然后一交——TLE40分，wdf</p><p>果断无耻吸氧，含泪AC，完毕后不忘说一句： <strong>“我的splay开了O2常数小”</strong></p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 树 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> splay </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP1512 伊甸园日历游戏</title>
      <link href="/2021/12/12/luoguP1512-%E4%BC%8A%E7%94%B8%E5%9B%AD%E6%97%A5%E5%8E%86%E6%B8%B8%E6%88%8F/"/>
      <url>/2021/12/12/luoguP1512-%E4%BC%8A%E7%94%B8%E5%9B%AD%E6%97%A5%E5%8E%86%E6%B8%B8%E6%88%8F/</url>
      
        <content type="html"><![CDATA[<p> 良多大水题</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P1512">伊甸园日历游戏</a></p><p>找规律：</p><ol><li> $m = 9, d = 30$ 胜</li><li> $m = 11, d = 30$ 胜</li><li> $(m + d) \mod 2 = 0$ 胜</li></ol><p>完</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> n, m, d;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line"><span class="keyword">while</span> (T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;d);</span><br><span class="line"><span class="keyword">if</span> ((m == <span class="number">9</span> &amp;&amp; d == <span class="number">30</span>) || (m == <span class="number">11</span> &amp;&amp; d == <span class="number">30</span>) || (((m + d) &amp; <span class="number">1</span>) == <span class="number">0</span>))</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 找规律 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP2747 [USACO5.4]周游加拿大Canada Tour</title>
      <link href="/2021/12/12/luoguP2747-USACO5-4-%E5%91%A8%E6%B8%B8%E5%8A%A0%E6%8B%BF%E5%A4%A7Canada-Tour/"/>
      <url>/2021/12/12/luoguP2747-USACO5-4-%E5%91%A8%E6%B8%B8%E5%8A%A0%E6%8B%BF%E5%A4%A7Canada-Tour/</url>
      
        <content type="html"><![CDATA[<p> 被STL卡半天</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P2747">周游加拿大</a></p><p>1993IOI的题（感觉当年的题好水啊，现在越来越<strong>卷</strong>了），疑似是<strong>dp的起源</strong></p><p>dp比较简单没什么好说的，重点在处理字符串，注意一下问题：</p><ol><li>map中不能直接拿char*作为key</li><li>string不能用scanf输入</li><li>别搞妖魔鬼怪，就用cin+string+map挺好的</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>  N = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">map&lt;string, <span class="keyword">int</span>&gt; ha;</span><br><span class="line"><span class="keyword">int</span> mp[N][N], f[N][N], ans;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">string u, v;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">cin &gt;&gt; u, ha[u] = i;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">cin &gt;&gt; u &gt;&gt; v, mp[ha[u]][ha[v]] = mp[ha[v]][ha[u]] = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">f[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; j; ++k)</span><br><span class="line"><span class="keyword">if</span> (mp[j][k] &amp;&amp; f[i][k])</span><br><span class="line">f[i][j] = f[j][i] = <span class="built_in">max</span>(f[i][j], f[i][k] + <span class="number">1</span>);</span><br><span class="line">ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (mp[i][n])</span><br><span class="line">ans = <span class="built_in">max</span>(f[i][n], ans);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> USACO </tag>
            
            <tag> dp </tag>
            
            <tag> STL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP3896 [湖南集训]Clever Rabbit</title>
      <link href="/2021/12/08/luoguP3896-%E6%B9%96%E5%8D%97%E9%9B%86%E8%AE%AD-Clever-Rabbit/"/>
      <url>/2021/12/08/luoguP3896-%E6%B9%96%E5%8D%97%E9%9B%86%E8%AE%AD-Clever-Rabbit/</url>
      
        <content type="html"><![CDATA[<p>  一道很暴力的题</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P3896">Clever Rabbit</a></p><p>一看 $n \le 30$ ，时限4s，第一反应打表能过，仔细回味，发现 $10^{30}$ 铁挂，而且20分的 $n \le 10$ 都会挂，这……</p><p>但不能浪费我辛苦打出来的表（由于 $x = 0$ 对答案无贡献，故保证 $x &gt; 0$ ）：</p><table><thead><tr><th align="center">n</th><th align="center">x</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">-</td></tr><tr><td align="center">2</td><td align="center">-</td></tr><tr><td align="center">3</td><td align="center">495</td></tr><tr><td align="center">4</td><td align="center">6174</td></tr><tr><td align="center">5</td><td align="center">-</td></tr><tr><td align="center">6</td><td align="center">549945<br/>631764</td></tr><tr><td align="center">7</td><td align="center">-</td></tr><tr><td align="center">8</td><td align="center">63317664<br/>97508421</td></tr><tr><td align="center">9</td><td align="center">554999445<br/>864197532</td></tr></tbody></table><p>9的数据都跑了进3min……</p><p>然后又是全凭rp的找规律时间，浪费时间ing</p><p>发现一个小规律，看图：</p><p><img src="https://s2.loli.net/2021/12/12/repxRFMSVkOgN7f.png" alt="竖式"></p><p>我们发现 $b$ 数是对称且单调下降的（下降不严格），证明也很好证（自己列个竖式就知道了），那么我们可以枚举 $b$ 的一半，计算另一半，然后得到 $b’$ 排序后得到 $c, d$ ，计算检验即可，然鹅， $10^{\frac{n}{2}} = 10^{15}$ 次方也是挂了</p><p>突然发现只需枚举 $0 \sim 9$ 每个数出现了多少次，计算 $max,min,max - min$ 判断即可，考虑时间复杂度，看似是 $n^{10} * n$ （跑不满），但实际上用隔板法可知为 $O(\binom{n + 10 - 1}{9}n)$ ， 注意解决一下高精减法，可以得60分（开了O2可以70分）</p><p>再考虑我们打表发现的性质，还是生成 $b$ ，但和上面一样，只枚举 $b$ 的前 $\frac{n}{2}$ 个数中 $0 \sim 9$ 各出现了多少次，由于 $b$ 单调，故只有一种合法排列，生成  $b’$ 后暴力检验 ，特殊处理一下  $n$ 为奇数时中间的数（一定是0）</p><p>不开O2最慢的点1.89s（时限4s，能过），开了O2快得飞起，最慢的点412ms</p><p>考虑优化（毕竟1.89s太讨厌了），那个排序可以开个桶，把 $\log n$ 优化了（然鹅 $n \le 30$ 所以 $\log n$ 几乎就是常数），再就是其实可以先不求出 $b’$ 用 $b$ 的一半即可判断是否合法，合法再求（常数优化），然后卡卡常，时间复杂度为 $O(\binom{\frac{n}{2} + 10 -1}{9}n)$ ，不开O2最慢的点322ms，开了O2最慢的点205ms，好像除了打表的大佬（竟然真的可以打表，蒟蒻想都不敢想）我混了个最快？估计马上就会被大佬们超过</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> re register</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>  N = <span class="number">30</span> + <span class="number">5</span>, A = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">int</span> n, p, m, o;</span><br><span class="line"><span class="keyword">int</span> t, cnt;</span><br><span class="line"><span class="keyword">int</span> a[A], b[N], c[N], d[N];</span><br><span class="line"><span class="keyword">int</span> B[A]; <span class="comment">//桶</span></span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= B[i]; ++j)</span><br><span class="line">c[++t] = i, d[n - t + <span class="number">1</span>] = i;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">d[i] = d[i] - c[i];</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line"><span class="keyword">if</span> (d[i] != b[i])</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">b[n + <span class="number">1</span> - i] = -b[i];</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line"><span class="keyword">if</span> (b[i] &lt; <span class="number">0</span>)</span><br><span class="line">b[i] += <span class="number">10</span>, --b[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">t = ((LL)t * <span class="number">10</span> + b[i]) % p;</span><br><span class="line">ans = (((LL)t * t % p) + ans) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> <span class="comment">//生成b&#x27;</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i)</span><br><span class="line">B[i] = <span class="number">0</span>;</span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">9</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= a[i]; ++j)</span><br><span class="line">b[++cnt] = i;</span><br><span class="line"><span class="keyword">if</span> (o)</span><br><span class="line">b[cnt + <span class="number">1</span>] = <span class="number">0</span>, ++B[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = cnt, f = <span class="number">1</span>; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i != <span class="number">1</span>)</span><br><span class="line">++B[<span class="number">9</span> - b[i]];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">++B[<span class="number">10</span> - b[i]];</span><br><span class="line"><span class="keyword">if</span> (b[i] == <span class="number">0</span> &amp;&amp; f)</span><br><span class="line">++B[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (f)</span><br><span class="line">++B[b[i] - <span class="number">1</span>], f = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">++B[b[i]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == <span class="number">9</span>)</span><br><span class="line">&#123;</span><br><span class="line">a[x] = r;</span><br><span class="line"><span class="built_in">work</span>();</span><br><span class="line"><span class="built_in">check</span>();</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (re <span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r; ++i)</span><br><span class="line">&#123;</span><br><span class="line">a[x] = i;</span><br><span class="line"><span class="built_in">dfs</span>(x + <span class="number">1</span>, r - i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;p);</span><br><span class="line">o = n &amp; <span class="number">1</span>;</span><br><span class="line">m = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">0</span>, m);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans % p);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 找规律 </tag>
            
            <tag> 高精 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4892 GodFly的寻宝之旅</title>
      <link href="/2021/12/06/luoguP4892-GodFly%E7%9A%84%E5%AF%BB%E5%AE%9D%E4%B9%8B%E6%97%85/"/>
      <url>/2021/12/06/luoguP4892-GodFly%E7%9A%84%E5%AF%BB%E5%AE%9D%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p> 随机跳题都给我跳些神马玩意</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4892">GodFly的寻宝之旅</a></p><p>看了数据范围，感觉 $m$ （边数）应该只是做权值的，时间应和 $n$ 关系大些（毕竟  $n \le 18, m \le 10^5$ ），先考虑了暴力，暴搜走法，以边数为权值，时间复杂度为  $O(n!)$ 期望30分（我也没打所以正确性没保证） </p><p>然后继续以  $m$ 为权值的思路，考虑状压dp，设 $f[i][j][w]$ 表示“走到点 $i$ ，当前点集合为 $j$ 且当前代价为 $w$ 的方案数”，转移很显然，下面以 $w = 0$ 的转移为例：<br>$$<br>\begin{align}<br>&amp;\text{设当前地图为}j \text{（不存在}v \text{），和为}sum(j) \text{且存在边}u \rightarrow v \text{数为}mp[u][v] \text{，} j + v \text{指将点}v \text{压入状态}\\<br>&amp;f[v][j + v][0] += mp[u][v] *<br>\begin{cases}<br>f[u][j][0] &amp; if(v \mod 2 = 0)\\<br>f[u][j][0] &amp; if(v \mod 2 = 1 \wedge sum(j) \mod 2 = 0)\\<br>f[u][j][1] &amp; if(v \mod 2 = 1 \wedge sum(j) \mod 2 = 1)<br>\end{cases}<br>\end{align}<br>$$<br>打的很快，注意了取模，结果一交——WA</p><p>想对着样例调一下，于是翻出了2018的比赛（这是那次比赛的第三题），正打算下载样例，结果……谁家出题组样例用百度网盘发呀！下一个百度网盘太麻烦，于是放弃，只好对着死调</p><p>就在我万念俱灰之时，突然感觉 $f[i][j][w]$ 的顺序怪怪的，因为dp的无后效性是用第二维（当前点集只增不减）来保证的，那么是不是应该先枚举 $j$ 再枚举 $i$ 呢？怀着如果还不过就只有手造样例心态，把第二层循环调到了最外层，结果，柳暗花明又一村，AC了！</p><p>代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>, P = <span class="number">19260817</span>, D = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>);</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> mp[N][N];</span><br><span class="line"><span class="keyword">int</span> f[N][D][<span class="number">2</span>]; <span class="comment">//f[i][j][w]:走到i,当前点集为j,价值为w的方案数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">have</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> ((x &gt;&gt; (y - <span class="number">1</span>)) &amp; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (x | (<span class="number">1</span> &lt;&lt; (y - <span class="number">1</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_s</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">have</span>(x, i))</span><br><span class="line">res += i;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">see</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//debug</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; x &lt;&lt; <span class="string">&quot; have&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">have</span>(x, i))</span><br><span class="line">cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> c, d;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">d = (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">++mp[u][v], ++mp[v][u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="comment">//每个点只走一次,故没有自环</span></span><br><span class="line">mp[i][i] = <span class="number">0</span>;</span><br><span class="line">f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, sum; j &lt;= d; ++j) <span class="comment">//将第二层循环移到最外</span></span><br><span class="line">&#123;</span><br><span class="line">sum = <span class="built_in">get_s</span>(j);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="comment">//到n就停止,故不可能从n走到其它点</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">have</span>(j, i))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; ++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">have</span>(j, k))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (!mp[i][k])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (k &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (sum &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>] = ((LL)f[i][j][<span class="number">0</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>]) % P;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>] = ((LL)f[i][j][<span class="number">1</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>]) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>] = ((LL)f[i][j][<span class="number">1</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>]) % P;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>] = ((LL)f[i][j][<span class="number">0</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>]) % P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>] = ((LL)f[i][j][<span class="number">1</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">1</span>]) % P;</span><br><span class="line">f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>] = ((LL)f[i][j][<span class="number">0</span>] * mp[i][k] % P + f[k][<span class="built_in">add</span>(j, k)][<span class="number">0</span>]) % P;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= d; ++i)</span><br><span class="line">ans = (ans + f[n][i][c]) % P;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>感觉这个状压比较简单，毕竟连我这种<strong>奆弱</strong>都可以做</p><p>说句题外话，找样例的时候虽然样例没找到，但发现GodFly是“牛虻”的意思</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> dp </tag>
            
            <tag> 状态压缩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP2441 角色属性树</title>
      <link href="/2021/12/06/luoguP2441-%E8%A7%92%E8%89%B2%E5%B1%9E%E6%80%A7%E6%A0%91/"/>
      <url>/2021/12/06/luoguP2441-%E8%A7%92%E8%89%B2%E5%B1%9E%E6%80%A7%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p> 暴力出奇迹</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P2441">角色属性树</a></p><ol><li>第一眼看过去想的是分解质因数后建图处理，一看 $a \le 2^{31} - 1$ 完蛋</li></ol><p>再仔细端详了一下数据， $n \le 2 \times 10^5$ ，估计是 $O(n \log n)$ 的算法，  $\text{修改次数} \le 50$ 似乎在提示我们暴力修改，估计是个树上倍增的算法，但具体实现还没想好，就被说明/提示的最后一行吸引：<strong>本题测试数据随机，可能是假题</strong>，随机生成，也就是说……暴力的<strong>期望</strong>复杂度也是 $O(n \log n)$ ，<del>本着能偷懒就偷懒的心态</del>，含泪AC了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> w[N], fa[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> y == <span class="number">0</span> ? x : <span class="built_in">gcd</span>(y, x % y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">gcd</span>(w[x], a) != <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(fa[x], a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k, op, u;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt; n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y), fa[y] = x;</span><br><span class="line"><span class="keyword">while</span> (k--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;u);</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(fa[u], w[u]));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[u]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后来看题解，也有树上倍增lca的做法，但是那样要维护区间乘积了，需要打高精，直接放弃</p>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> lca </tag>
            
            <tag> 倍增 </tag>
            
            <tag> 素数 </tag>
            
            <tag> 最大公约数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最小表示法</title>
      <link href="/2021/12/06/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/"/>
      <url>/2021/12/06/%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p> 简单的缓和一下</p><span id="more"></span><h1 id="最小表示法"><a href="#最小表示法" class="headerlink" title="最小表示法"></a>最小表示法</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>给定一个字符串 $S$ ，通过将 $S$ 循环移动可以得到至多 $n$ 个不同的串，其中 $n = |S|$ ，例如： $S = bcacd$ ，它循环移动一位可以得到 $S’ = cacdb$ （即把最后第一位放到最后）</p><p>对于得到的所有不同的字符串，字典序最小的串就叫原串的<strong>最小表示法</strong>，在上面的例子中， $S$ 的最小表示法为 $acdbc$ </p><h2 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h2><p>最小表示法的求法比较简单，把字符串复制一倍接在原串后面（破环成链），然后用一个双指针 $i, j$ 指向两个不同串的开头，初始时 $i = 1, j = 2$ （假设字符串从1开始）</p><p>然后暴力找到一个最小的非负整数 $k$ 满足 $S_{i + k} \ne S_{j + k}$ ：</p><ol><li>若 $S_{i + k} &lt; S_{j + k}$ ，则说明 $j \sim j + k$ 之间的所有位置开头的字符串都不是最小表示，因为它们都可以找到 $i \sim i + k$ 之间对应的开头的字符串，两个字符串到 $j + k$ （ $i + k$ ）前都相同，而 $S_{i + k} &lt; S_{j + k}$ ，故直接令 $j = j + k + 1$ </li><li>若 $S_{i + k} &gt; S_{j + k}$ ，同理令 $i = i + k + 1$ </li></ol><p>有几个特判：</p><ol><li> $i = j$ 时，让 $i = i + 1$ （加 $j$ 也行）</li><li>  $k &gt; n$ 时，说明两个开头的串一样，画图不难发现此时 $i \sim j$ 一定时一个循环节，而 $i \sim j$ 我们一定遍历过，所以直接结束</li></ol><p>完成后 $\min(i, j)$ 即为最小表示法的开头</p><p>时间复杂度为 $O(n)$ </p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_min</span><span class="params">(<span class="keyword">char</span> *s)</span> <span class="comment">//求串s的最小表示,完成后答案存在s[k...k + len - 1]中</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; ++i)</span><br><span class="line">s[len + i] = s[i];</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">2</span>, k;</span><br><span class="line"><span class="keyword">while</span> (i &lt;= len &amp;&amp; j &lt;= len)</span><br><span class="line">&#123;</span><br><span class="line">k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (k &lt;= len &amp;&amp; s[i + k] == s[j + k])</span><br><span class="line">++k;</span><br><span class="line"><span class="keyword">if</span> (k &gt; len)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (s[i + k] &gt; s[j + k])</span><br><span class="line">i += k + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">j += k + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (i == j)</span><br><span class="line">++j;</span><br><span class="line">&#125;</span><br><span class="line">k = <span class="built_in">min</span>(i, j);</span><br><span class="line">s[k + len] = <span class="number">0</span>; <span class="comment">//加上结束符</span></span><br><span class="line"><span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//主函数中：</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> x = <span class="built_in">get_min</span>(a);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 最小表示法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/12/06总结</title>
      <link href="/2021/12/06/test2021-12-06%E6%80%BB%E7%BB%93/"/>
      <url>/2021/12/06/test2021-12-06%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="da24df42867f600101197918d2fd144fc62fb9e6296df5c9f16af933be6f08e7">111e7d6409c611e6b63fd1363c3273c8c836a380abc1f14111e9a401fdb032105c75e83029ec712782100df7123fc640dbefbc9583d9cb5dd5e96363ffa3e5784d91c280c44e6e78f3e5a21557edb0ed8c0f80d5be47d82dc4c8abeafb32078914dc5c94af3a4ea1631d4d0555f7c987f39a163daf6a7b7218915d7b4fa4dc2e078ab8aa1f492d51a648eeef08bebe544c0778dc9f49f09175451dae6377219ee7ffed007df5d0fe4f716c4b71211ce091d51ad03f72c88f956515e9bba3245f042628b4b75cf10b435e9c7a23adbcfa2285ca06848ce2bfd2e0709cc332b57bcbf1ebfb0d7df6567ea0b03d2734128da2a52f3e30b8485e164f62388e5c4d87aba37876e222baa5425fdb4cc84f3de301bcbc87a55c13bae585737936702592f04db72ceac40b2e903f9e3d2ddb8bf95aebbe0f2315dca4ecef11df4817d2b368ddc912316f21f0bc5ce6ca25f1d8336f3095294711a5fa5c6d5b00096b01d68c1c045e8651af536da2c15b03a2048db3483f3faea1fa8b88cd6e474aa98927f82790117240eff6240962c93b1f24b8a10a83ed9d4ce3afa78cbf86fde9f7f367dca58efdbfb0928149828efa20c84b18a28fdf73093a1dba663e0d67706db444ab59303ddeaa9b8b9bd9d2c88d072c19e6a280fc7ac52dbabd90fedef79edf4c0f28d6896b9921601996322f59d153580089b77f293aa7d3b6c9b0ae8925d97870e3fbc0b7f1f768a838ba50fcf4bf8ebf1a0fdbfffa78a0b2f52d499127b073d24e7e25b15bf01b3f2263b11f9988953bf69a5920d9e811830684a500e1b28fd4ae94e0dd7b69612029f5023dcbafd6fa051122a58b155668738c43e3565a97d0a8b7d3d86de28b20d332080d1df0a0bdd7828aba0fa7784acb9a311d0f2ef4805f46bab1d901ea0a98237f5638fac389a0174d71d86b55393f77d1e5cfa0768bddc92efeceadd2c014876a72438bbc9ad9fe17d08435aae070571c038e7812a3274383e01a5d766a3bb22230aab8689bbca72a2197c36393af3197bd07e4660a53a30dbdb9e614ffb7d6d6a3f1c0225a29e31c46b48e1fb485086a14c74acfbec4e9c2d1545a1680215915726f62c4d389d580b18d966f9dde419484b6707e4595831f3f56cd3cb2d2bf9bf202ac58c72132213943155ca259e2b9a8e6369dbec97e03fd32e904a7e84fd011a62a9ca76bd87230cdb214f26a2ecef65c64402002f23ec3fe415e72b18f7b150cca96875457389369f29ad66858b1e50e7cd24c8630387f8ec084702edfaaa6717c2ad14fe9ab6201d5f9b0b0384919151d59c683fbe76bbe8771853bed283efdbbf632b8b87d4688eb67fb8131a4f4caffc9f70126d273e4f22e1008589c3d4b3c51427bce7c072f138c605c5c515808a5ce28d5e4fe829c7d88c7f1fc9b0e5b98addb374cfed9d3d68716530af767f8ea1acc9d2157d8adfca3df8a1c0e2fa561dc4064a19eaf3744931e50cb76f34d6e81ce3db7ce9e9857a2baf099e3cd4254d3f9946072a033e5262b5964d30d2ad47585fe937058920052345a19f984bb22b302b76b7ba01a17efd07626dd24740092ee6252361bfe1cd6a99849448cbb2ffed336f0e2e9a12ee5e10141e168414a7e48045dba5522d7febe7f4e9322021af826de77f3370a8fee58cdde2f913c4b41be73cc20360c9284206e21d333ed3c5279ebb0a9751e4cb3444843cfb2d53c76126e15bc337204c8a2a5fba472be570bcec5aa7123a2ce7e79ea27c501a2411e2cb4e3a847fb6e3045537dbc672a2cb4ecd42011224a346386bb3f89b5588b62b0bda2d23661d760d06080c9a3f0ff75050814adb6fc343f4a0997cd0ebd4e309a1999f5d557260c4a3be386636190e97623b5337058e55e09cc3e7f7c97a144bb8ed713e0b74726b875bbe7117713a0526e234088a705c340b75996da2316984d3c6acd6b0420b41af36ae41cc49d1cd7bd5fea3128fa78984156923fda19c60e072deb34d06c5aacfb2bf8e89d86c1bb02037af733150f04f418ed80fbcbd9388ed99190b7cc049f36ae503f3ce0e726763b7ea6a3305448e10e86c5a682249092a5761e4d960f6e24666cd69f3ca75c81eb091d0935498ff2cd356bbd706c95bec893adbc4ef49b324198def61221569587177889a7206ffaaf7e57a1354fecfd29b12bd36868194feaf7475a9db170b3ca4774bd4ff557d2fb769d6fb05525051f2dc56bc348b9b9e54fb28de1170f500815ac6715bab31e6cd94db9a7ba25e3b55e461b1a5f8b5e8f89aef9280de124614a72a0ab0d20f677837b738759d568591191c0f1d893d5c41fb87f06592a3d29d80455588983095193ae55242b671f0b10c0e917d00f4a347c38bac534ec130d5c0de7b04e1ce71181696334d6777583f4dc1a4f7f3f0e6848abdaad17255c8aefbe34d357dfbd58901f165b5fd5b26709631fcfaf750651112cc05b295344c835e7efd7bf1f6842ee62cd4da8ac103e97514a9172798eea3934aa747a093230a2e32b5c9baad53ea5c47e1887bf2837cb1ebe274eee7115acaddabf8cbdfa9a62ad66a2d0c84b2e363e35d35640a40606f13f40bf899eee895330bbe5dbdffe854e43b956a7bf5d10f9af59227279392628835c7986b1c4647bf3b4664172bd276677fbcb541ec6d81c9e61e59705df2f8e7ef53e3e4d35ee35e58a974845219d19edfeeac6eb19e0f5fd35c27261da7126cefd14b5125f7f8e2b83a76cf5e02bce7efd86551f38a17f1b437f12295c599ea0b777a137a6e7450d7fdf4bd9413d6fbef27aa8236561783d79acfdf189727e3b209b00f95542128ce76da504b06fc0331437e87fd19d97c9dbc9ad71c3b4653b2bc6a4a2847f81c96c022f5ea2d2d458b8736d19a2c3484e1a8c3ec6ea8b62b839d754a34eae81435275d54de6a9ea60a7f991776cccf9b48d04192a78cc7e3e561a76fc04b14ca5e3e883d315d285354fe6f4b647b1f1b8556ac1db3da04945fa761be215290d51dd3e4b1ded93b2a6c42b152e53470f27c64a1e486ea6e85864ad1cc3661a7d8a4feccab508d6835e3d7b9af17b2747ea5bcf8a50d6f23b4b6c7973605c992eeb359b79a8ce8f52a1c33249c7e3e1ba36275c198d2b84792f965a000f5b8513be490f9705bfd02de2a5b5474d45a2934a3514d7bcdd3f55a36c3f066a3a34260722fd8b4c4ffa5ca8c8c262149066668709af89d22d7a936170e23abb31472e363f284caab2b7f987f7e332abb72e08c2db446b51396dea208ce836a5ff90b2761da43b20746e34bcdf0d4a15009139c84e8dbde62750ba4a03c3fb1f0dde95cf45cacbe79312a45d69e18d58114ee5e2bfe08dbc58256d61deab127569229bb7d27d3aa4e8a491c798a5787625a584b592fe58341208ef9947fe22077e14ce5c263ea5c0fdf1a4c8857deab3269038385cb38979bc4f28ee903eb19ec86e983d2d936c5cd48d7b20f3f480acbb58171c0c660107d3317f14fe999903ff52cdcdd70649f88f1f5fcb1c90175c24b7364ff43833a0f917517ba5935eb279c52d69e6c461b6a66c11775599e96360c7dddb1a7a583c6e329640b5ce4fac74d3e797419fd8701195bbc2655a69559b205e4057f98975903494c5ea797d9d6a3d63b666d0bc32f3c02623ebf0bdfda65bac253a817909f9c6c80b11878cf40d04e981cc45375530698434324b6ebd7c5c196e784004e5b33ebf1a511cf0152f2df5884a443fc00b39693450d66b844f3883e1199835e6cd1c2ed65c4d5b221f2dd4ed2d387e3f53f6167c9bf7aba2af7d00e4e682ec601c0f1958021698687cedc5d6fef09589929f99b92f4f0bcc5b1c2aa8fa839693cf6e9a55a8750465fbe85ac153c1dbfd76ff2122efc5fc77de606f6ac45bef75d818f8d52fb06ce8d093db93b6f214edd1cbdd0b8610336aeb7f4ad9593be10ca6768e30fc8fab1b4f48096df245137f1e8623a9244107f96f9af84af2c0bf74fa2f946cf13eeb32c5cc37db6a6c99242c92f9d4be98e4132063ab062ab89ff3558faf81483c20e02c9f82732ade0049ed51ba8a3d11fcc4c59498405016695f5290c474a601b86ee1f10a0bda01ee8bf96f41b8c3c60e75c9a39c831d373c91082dafe3d510a543d18ff8ed127ee99c3f56ef378cfb17aac25ac9d09b6ee0db80801cb28e0f66ef528a4a1e5a6fcb4147c5ba992dfcadb796f59b1bd5052dc567dff8a278c26eb9ca0ea00d74df336279250dfd80bbfe57992cfd94e8e1876215c68c152c6faa93d07c6ed1fff58dc782462f657d01148c8d22e2e34f367fd3c73c3e7113f116aa149d694890a23ea94870c778e9ca33bdf8261c07863f1e46ea849ecc594d3a165329f083737c460dec34e40cbff0d00cfb2d7b53a6f1f2449f4228e0204c24455b2f853b2c42275dc74ab4c3a3b579d02bd04c93ae1aeac4549252dac37649b55a5ed972e06b11048e005ae2052641b941ec4cd427c809271bcaeb07caf9a9261e7c5619bd792545cfceab41273f78fcdafb56f5c438be7472c2de85cf979a7086fc73de2402ef00133fd41d0ed704d9d7d0a683cc37bc8bf1d3383013f872a2aec42828377198d8e07239798175479cb422c8d33ccc3b8a005c9a5ac0fdf8b470cbafef2f5ba8941c9ef9f0bf0c672754333ededfdc2b2201c559f8bdc96f87749a8d944c8baba10a29d1df1e00ff428f27bae6297f003bee57cc2c9250f3dc8941376641dd885bef55561c582c196e0eb051a719567162f725e14a7ffe1f098e214ba6656e2d21144b0924b69a92f89e3c49dc6c925e541c91e34e5beddbbe9321afc8207c42af6d0edf0cb7b7fe5b06247b14f0b16b4f00582052ffa9bb79c53950fa0ba8f51094c8832231ae9b3e2d424944e02f4a866c9a38278a8474f50fe11d4b53956dd581a4bace3e3dfee34e280d4afa807698ed5004266aa764a95b4aa277c8828e56b04cd4b6070fef739ff525a33435eb7bfb6a0fe2f63e84074d18e6ac174ad1a9723cd6d720b14808b37b48ba53b80109613179e9b58273426bed0eda03fbd5a134e1b4eada26b4716be53900af765fb9bf0c7a7b0300cbfee6301c8aa64e1f1e164abcfe398fb63b3a64b76949c2178a36d3ea6a681624ee41513a2c4359944b28d6aafde08d887f29c24943fdba1c958f336244426c4c9987a64eddc2a6c42a545528bb6ee89418b07620b8dd84ba2f469f70de630ab6dd5a5127124076dee0e0ceb86430fdd090d2aa534b35ef48f30e39fafddf92f710f513011399278620eecf3462ea4082fbe96cafe6d3839e602c7f6d52e9fd6037aaec72a67ce7e958ae35fcd434951ef5f406f0db46cd2b71e2d694e82dfc05642ff0d03e422450e409db87b68c8915851a291234307d88a8e320b50d4ea87089950afd0f93687ec57e6bda2f8f8c5e5609163b5c8ad1b574db10b0e5befc1855ec6898208da9e6ffa6964b2bd9fc4b345320a3d4e78a89ad652ae902ad6d92e1cb03435729d029c9f3347f4595d687d237416d876bf0acff1d582573b2ad71d39511e81cb611c1673bf7d2611b11d3ecd654de1ad0f433512afbe004ed5ac62b152a9c5038e65fcdb14da5ab5fd9e531ad1ac64d6e5e918de914ac3a371383aa3b7b9180ed54a8767c92914a8f1a782783ff6f819b5d1bbb0209d0dfc0b63da58ef389cfe13e7dfe26b344b32ba915b6e292f29c119bce1a41a98ad10b94dc52a48bb190227b22881c69e9f5bc32b9f7fd607b7629c7fc7b78ba659d6207360c095f37eb8358fa3c494d06a0fe70a6070e2369af2eededa9367ea863bbac295733842aef92473215cd898279b4fde67e80ba72130264c6965173d98a6cd9f0bc5784c116f4056b4db0f2ccc8fd911ed838e95b59c8b1664596f091e9f2bd5deecb431f169ef218ee30aa3f312a8f787d1743b2d13933d67158e36f535a57b8151b9037c33b3c50c08f00f1899bd97f488c311d5ec9e8b10de3f7e564283930cf1a4a0e57208b8461d1bbd417d36f12dbeb1501aaa7405eabc586404a102b6946a47653584db1c7cce2542948f3f33b21ea37346f3d7c8d8fcf3c3ed4a328ae4fc10d35e26c50c39f509936fff038429ecb170d6b691ca753127a87eaa7af9448525f9594780d970cf866c4657e55e1f88407adc0d9d00ec66454e07565da3b0db01ac88af68dec4ed92c386e0a21a8755e97e3266696da7268b69ddde4e7518322e736108d1fe3cb4416037186fae4b338ffa54291a14dd2d4c5f0aeaf0d1d2393c5740612394d1d906874a1f0f2b16cc64234ea875fc895a0e2ab9ae5b0254c2323c8c8be04af07aba6972809df9217d2a1c664950c03b2b3f7221361677abae76297b4a723c36388a035e76e34e875eef992aca232ff2f21f9be48c1782d816a1a07868d9a0180de2e6b5837d21543dfa62bc97a809a86b828a0c9dc9dd984f6aa784a1c95f74e89a040392f97717b9d749697193b5706d1d3d2abbac112fd966c6be8151859d8aacfc4b077fea4abb40482110148d1ff4e0253b842acaf9eb97439a11bc42014307f29719adf528ba85aca47a04e91ae3fade4a942ef167cfd58c965ab1090ab23792610ca2518ea3176c50154e396fabe44c6cbbbe964fbaaa2569f81c835f2d1a3f35b326c7b15d4ebae0f190a2c2f5c38cb0aea606ee131a04f5ebfc8062817548a8822bba0066f0d65a6f620fe98ee529be73e8dc10592285f5878f9bdd6f865e3b46f7f497e9a168b4f0cce1484b84383a57dfa5640e0c152dd024dd553aeeac11bb91a5a695ea3d2080c0048537246ba6f3efb9acf249b679f285958fe9ca541810b1768a417b6d26c06cef8f48aeb921f45596517d6e74a667933c8c553509a84a6e9e62c050758ae4fc152ff9fbb44292540c7ae1c5e6d0c44fb829b0e687673769b18c3e3c83cf05895da4e41c2f2f2173560d9a153d3b07a28660397abfb4f9ad37a6a7cfd0caf7d77ecaecc25e20177847f5eab16ca0b8a010e24993e9e1f38d4299b5f310556bdd386a29e0883591d7d16611b294b6bc674cc4f53370542317c410d5a5d12b6c5e4f9c28d3c000794cf4a0e1328f1ba04c8f38aaf5185a19d4cf865b9d5d130a33c8edb75ddbdf3301ae49b36e0154cfa42244a3c6700527380cb79963997a09eee633b9b95513c2087471c8ca3ed32a5d0466f47c74dff46a54511fb09c7976ea3c8a1c0b14ef85763d74a4984f892ae26b3df071b9a61b155d00e482e88abf39eb38eec1c43cf1313a55adaa0f91bee9dc9f0e0a0eafd833b0e69b9e53d5a09749343449298f77140f6af6b0bff4c49e4d57895088a7fed4362755e9ad0b19774838b2725d36e2b5a18bc8e96c73b261e10bd105538229ff6d3ea0460c0719ef800a1ac45ec8eefd26e00a3d354e49b2d62c46e0e45a805290d13f22ad811d04ba37935903e0a10d99dc281cc8fcba4e9b1f518e9d1c76c15304893c25f27d75a99ae746f3f172fdf2187b807633359df96cb9482d179ed771169b1e63d3a41a94bb4587262d447bfcb31bd656ea9c5d1e892c1b152a7596dd3bcbe20f9c822f14402b6e482fa2e039a6cb4aa85253eb2bb491da3916df4bb65e3940607ae3310be4cf1106cf2ebd1b5aa14e380fa7a6d4398fbe517de320b44f97c63e6e7964ade53ef00a4c526e8a23d8ca706c9606fd64e4d52be1252ff41b7e7157545d2099c58b67d7a1efd20f1c7bf552d707fb5889180e5fb23e5b0b5da34d0e416653fd9721f7eba1763800e021ec001eca6f07720fd4b64568dd19c1db728eccdbc20039a5823e635674449e7f358c4d4edeb4bffc9fada12e75dae85f650b29e909b8c6b4fa350a7271d351478a259338e8f1b7b08a416efe59b413035ebbde0a5dde08589aeef3eb7d12d9a4af17d5c4bcb02f1788676ac1a22a372f95d37bdac55485d1958cc5c1b276aa0679d3c2c78df67e85989fd2b60f736b02028c16b56b70c663b94225119a96f1313a3d97f49451ebefe460a1c9838400a5fd73683bb48a88718b3220183e197819a3924626fe1e37d35d0cbbf39924ffc47ee7d72751214c40d9a2c30ad6bfcb2c3b3e0663c51c65ec16542b836cc3949a8ef0db9174c390f7accda9b51b4ae84282b3b239478a547a80726d6fd42e7b01848b254d8ed227664e0f14715cae00cfa394bce726484e8bbfcef180fa259810a93a003af572afdc45213e1f91a4280d92d0bd7d463c958bcc575a88ac9e81aacd32ea0e4ffddc4c2730e2fbcfcd6a44e26b813faa72060d79c241e86d2e5afd4fff7b32127a1b56d984e0918999887e88576f747c594e891dc5417b184daa3f6234545d8269f8bf0a40aec5690eb6471d45857c6a90528a2cacc07b987bb6c90c2789031438ec5f6a9e68cf2534b225c6c2a1f39d2f8b9411c3f3f3604727cbb8c00ecfb5af309b97f94b071f16ada3937d2c793df3644e56ba43748c653235b5d97dfbcb6465fbd38b58d7f13b9d1d06506ae59e3b9058a68666ea4f07e2e20a6cd7b41825024f5cbd5f0822fd3aa255e2539e142fde855dbaaebae07d7e7238376d26c68e5d2ee3d3f3d7156199c05477f05a2699e243bccc28921a39cf52a823519b6befef0949157ed976b41c601fd37c7d3fd0d1e4da28fe127e9c3009abe5a80e380f6159995e94b595a895d288e7d9f9791a0502f406671064baa0baee2568546b776678ed5db45ce231b4c673f485410c9218a9402d3a44175442e631c6027bc28100ded93ca53a5e57912c7f5847f56e0eecefebf3ff328673b3b977d393b16dfb8d9fe319efe05b29227ed9b98333d3803c9941ecf480047663693f74d1af11a308613536a8920f82f35bd5ba5dc2a1f8a45e954aac3b7a5ff73119bd3dae7a8c8a04189487c7cffb819c0e50a2a51af125ec48b7b1207c0ac2f9a1638d76d739f4bce2228e989d0506c01417f8cb9292844fcf2b9a2ff382c19499da412a11cc808e518ae5a79798f0ae04b64f3a4001e099c9b5dfc813a8a002798d0714402fc0cd8df990d4a1155a0cda44f551f0b45101487eca851297b54665941f0a0c86bececbb8b11431d4e654e80f6a41f2f0602b1c16c334eaa9da6089c1b7db8009c16dcc4a86c655152dcfef74d8d95ddb37a4f0bc2e3bc4559611dfdb7a218717f6e8dc951956ca98f7176e11231f9bcfb79968323c225bc2b80dca41fec2e86c0b60e01ea3d45a3772568fdd221bc0fbe6ac573fbaa803bafcb41d0a2ddbfc7acf95b34256361ae35ae4ff2253fd849843fb5da2969eb5dace6f0b7eb1296c2a6aaa8c790c5fae576ec4753e49778b21128b489356953cb19d501df4eb6acb94bfd70bd50c081474c75bf657bf9ee934d6e77bbb7174502e6d353801dc688506349feacfa861042f8fd6be4be24e5db9a921f0526c9140cc6277a638f066690d3250bd07964a986ceb7c0b5d5103acf9581e81a0c6174e3bf9d500f8ef3ed2a32b327d48654035c355712ecb2c48a5190788a98b5321cf75f49e2088bf071085c2956cf162fe0b3364c0ac175c1ce94b544f610e58301c866a174eff9dd2d00f455d1d0d7b22ec4daf9f56a5de5c66fc62fcb846bb03f924dce678e1c6f687063a259b7ba3925c140356c79966fa9aa7fdee1ab117551e3b5df5404e16f13fee74e193550c0ddbccb744a93ab7c2c44a6eac9b0aad096b29958162334540d420bcf9f8cdd78397246882f1b6c48f469cc5354ccc2cb1d015771a0e13c20528e645dd47c764f9a706c4a4745a3f9fe7fa5c15b4106e37cb7a9b3584d9e3a4df51b4448685fc0393bb71f6489a47a0e375c0d60b4ea7b5a99824b984c586c20fc51f52dfedfd5274861b79a3bc8869c2fe58b9ef7865ed0340adbe4fc39ad18985b16bc1c793b8d7b79c36009fba4e7f614ec09037795a61131e7a21c5129977ce14172ba34bb09077447a76c9f0a0263d8634aaf4b9ddd1228504406da5d3f1336c944990835c6ff00dea46b853b9544add5ab40e1169092276fb7eefe52164d7f6bcd208d21cb358efdcb829988234b3804ddcedef1373bb7b0ac8ea145340076560e7edf16daf87e8bc721ee7079202b64c89f6aa595b35d687961fabe8bf4334d6f89e03e796d93c2e1ed842aeed7cad5cbd450e223273bbf089e67924765b7c66d5cd2d2244c84a9763ca7b0c36f8fa328ae23c69f6056865fcc767bbe2e10e28cb4f37c8712fc7f773e497e6f59d285ee889728cf5f8904822d81eeabac63828051b5ccbcb655c37ea75aad434ba5f3187fadaa05c1e127154f71e931d8e60f036bbe4a50be7060c80bef15c79a0d3f229ba3b7a1e71cef6841bcdcb0c528236f6fa81e720e89a35b9d2adc00216b787097e5bcdb2673e98dbc0e9a9dd80a386ccbda06692717e90a739f1419ffa3bd98cda6cc0476c2642a853f778a9ce3da2dddba81b4618163320a18b28457c93080bb6531658314df55b93d621eb615cecb27fcb1e3ce25431d40bbe5a137c02351875ef8067d7672f3abcf231229143f55d03c740da4863c27e0979f6d062d8a755e13faa9de3bcaefa690e5215a362a44a96637d025fbf9b19c13e01b79f20972fdaaf0e9d169761b5c6c55c0e886b153eb4a338d9cd2b85be9af0f3d1d222ac0c05b5c9e72dd8be7eb4f33417d69997b4d8aca206d4b61a12f5b385593a0ff9c85129e5748acce8816710dafaf0955cda29f71e12586bf8bb3ac85baafa6578940796aaea91efc991d077151c30b388358e17ccda859968f860642ca175a89b319f6de7a6f7ff883093922d0664049767d7e27a3f8a31bb814547708ba9a620bd4e5b88acf84449eb9300fb4f56a5308704a2c501a3fce9eb7a334f6335193b098db03f4a648516c80a709bfe805286cf576583aed958df5d0cebf926ced0cc51c7c9d8cc45fd1f4aeee54e2e233e26e2983a479995fed660debe50f00df38989e93de062f63105eb76db6ec10099b26c61595fb94caeb5305f57a444f71f7a32ff2f3a05e0753b840ca3b47a9df28c29430e94e96669098b77f7eaf72049955818fa556e5aa6f3ccd4f2b837253ae31e59608a64cbe30e0ad89e52210b39424850d17fee708fbe811aed6729c48fd12bb1685df3183967875dc0fe52c4d14744f94c3db48e17e491aba7cde16f5301e305f4b3a9699f3bb614d0f37ea8b6fcf19ee8d24dc20dd5c63f2499d611ca7f2b84567ea8b748590d88dc0446e53a28ba251d6229692f4ad3a5e93ff3f7ade7359d6bfa45b005bac04cef84f10ab4563a4905ac0595c8cdf7e7ac4b9839d4c47c9694d81756e9146b633d44671f7a32ccbe47f06ee9dc24f927275d5cad2940be7722ca5b443fc4182659d29c9ecf1aa505b867c3697c43b58e3a05e85a6d521b2325ca61c7592a15fc28b39efd896c6670523f1d4e21f13bb00f2eec9b92dd3b3f90147126f1489c24a1221a0eddacd2341ecf2fc7d5397c4adb11f242c835a334f9efdd391229e18327e493eeb7ca4abfbe3133ef3438f6c8b9a72742d6e0fc2e6c186b5ad42633a0c05b82f441299b4abd7d584805a6e44ba50f46cf40026952b3b790364b9620fa80397ef8a2ebdb5d9132a7ed83cb970b52cdc2b525233acd45b498d7dd3ae8eadb932fce7c8c6afbb1c04fccf2f4666cfd6625f5e1ae0157c64c3e984613868f20df1976af3f0e32258497aed9239ad93fa35d5db65debd598005d7786ed9c0d0814dd01f1ccc1a0d1630f8bdf3cbb84eafd7e23dd8aec614f9ccf3415c8f8cce6083a5bb53b1f3970d3a4439e8d9e45c76e1179ad34a51ee24c9ee54f0468ac8d6bab354d93c0a07abc7328916892a0e7547a41b1ac7c4cb484c01b2d543513bd21cfd63084dda713fa07c61838e77116aa0c90dccf9977d65feb6cf5577719e95b31a0b60c5aff9f6e4e68f605561324ec60a992423878d2101e343afb0a0fcf918e0eeacfa3758a44747795ad236f32fb2352f248e1fb39eb0dc8b7bf5eab18dffe7d1747e78b0133a3bb8712c05c02014b7f81c32cf3c5c000ff384b6a335d503e24726246197707e1686d8f46ff2f20f56121ba1050a1f9c78d7efd523dacfbb3c4999c2e173e5ad5163b8738ee7f7f1e09a03de417e1d50f50b3e2e5bc8662f2506671a9720cd5541cb4d7a142841006701a4a22b53efcb7b6dabc2fbc09bc2946dde4eff89504a596a1ae43c010345a09e9de9be0dc7b279b6655df12d8ee11384b3f254f80a42d662cdb79607b71b5c4dcdce171c7244654a7b30a55ba2b81080987524f414fa36d96f3008a64189a6a8d317feb6e999a668ac751b36dea00d6c07cc5372787c8cd314c652d8eea02cc79b8b16c501b8e665c5a3e3b59fca7942ebca8f0a33cb72a87eb0c80b8e9305e047391e8e42dad9314d49fc797318c2aac613a538c9efb1195d034f8b45c17917894a43f60ec547ed48c5b781ae8ba5b710a2a77412ad41379a69b68cfe3ff8ed5418214b56a77b488b4553cfa052fbd7854b30e8dc828a5705b4eb4ce3c632f2d5fb4f9d9a6fa5fc8b3a29abeb9508522b26433cd6a7baacf63d750c9af0d4f6e4b728516fa7c23c9efdf9bdfa8f890bc5209c083bbf4c1194a711d46f8381ab1e31f1d7862e4ae6ecd1191f3a9481ee71d29fb1aadb1384ec4596f19143c5544ab3a67115aa1ead1c470373f6d4ae75a716df5a7b326a9716740fc99b9457869dafbf50ad58cad573690c72b521a65f8fd61efcd4116015824f84a7543a71834eeaeb2dc6ccb2ffcb309c4c74e2b89143ab0f00e7242f06bd8914791b2be74f07392e1c3f9bc31839d274377869e7fb2127239a0dd1aac46ce16ba7cae2efaecfe064d52ca55bb047e7e66919111af9e717e2d996591eb9ad18dcf8f0e6f82b6a2ad117889f4b44b263890d8425fe400357a918a130fdf14cfa3b3a69065c102a80c76768f7b64cdbd1c5a0b197d9caf3ec7b27633efb7aa79fb7ea0ba4c4f9e5441e18abc1253aa04f4edd6ad5f47ab7c0949c9d1e334c29e725eb14a3e783a4b562b13bf496f0faa67db547831d8d0be2cd416dc17405c40d73e50c010a790d1bec5956f50a8e50ebf5802390fc15030944227110c66b6af4f37f2d95965cbf3a06eeb16c6247f446e474af682f29de56d8b057dcd0cbd3d93a3989b67ff26d628de9a8e9ddb1f83c7fe4bac2aa04578110888d07382b491cce80898e2b171106389cfce96ccad14d27be65c18e622ee76ae8a43adae6daf1e9430ff9941d3780bf4e5a666a88842dd89208ca8a04d3ce6506431b7861c9ff4d32550d6250ba37ff0ed6363bd4ca47568e3c91db601ee0c536fb56dd8d045f9a95a2b64ba357972c3f0b8b0c19a1f742a6a50795200c1ed3fe64856042cfc46e6fbc2683443ecbb6703ce276bd5b88c3edddcbd5cefe6f66ca70477ef1a5ee0bcaaf9ed903f13d95427b3743980b6062f4863a5aeb1f26ddb0ad2f8847d59ab418257ed56b503e937da68238465bf7b2ec92ecb20d4163e3d1f723a7fc18d8e6f3d2bcf5d73c469d956749b85c64be34adad62f3940220ea8a622bf1223ae28a94e08a0ad8668d7ce476153924a0118672099808b5d03d8487bc5c830c34fa3f653353e9dc4cfed75f21a5455045a85c4d48cf818fbf498c1402eb07df0f50e669fc22d9e91b445a70de3d5c4bbde12db77879ee8702bf98f0cc6e0df56f3c4d55891af8e7f8d41099f52c3d4ceed89bdf0f43af7ce607100c7811c22384db699e0cbe7c2845279939ef7413921275a3178f2b8917f5bde55ac2afe0eeace5213e5bebcdb0c33902413ecfa614074ffa42bc431091b9f38293187f748045cc9c3b41f41d1d719809e1ff141259d6f6f0500d68e5185f1038739c4458b2a4c269b43ca3948bc28230aeec833ef1e23168c7e7066ef3f4ae7b6f72f604f18cc2696abe6dfc444f321e0058492b92dc1203478494132f150465eb07d8d5ccb119e9dddc300f3bc3cfd042bda55034757c0c4c622c5f3dec34320d232657a2ec586b7382be3d7880a180d99374ccdd22f37e4b2d571cfd1ae8e202216572ddd9b59d96ce14c913fb744cd76cd06859da8a63251475cc830c08ce611c184a41c3260d163fb3dc80e6711d836df8144b0acf0dd639bce9fa58615c199dfa1cb86cca7be78dd99b8610f4920665b8a04ce7a2222b99cc20b5c9451097963118436da4cbd0ceb5edbae28427d13d2e3b424d3e3d7357cfa83f9215872e38e56d1e28bce4212968d520454c961e8c6072de5ae3c4f067514cfe1963ac66bbe54f5d3d58b72c528e7fe1d529487c63be1111b92d198ff37f228e3cfe5ffb2f952cca05f011b106d134a60239a39ca65c5d390f077ecbe35469e0cc4a51f73ab0252369b6d974ff56f83c4004740d9b51961c6a810ff3d19dc47141984b6fb8617b1e78fb6f13a0e004c0ca0420282cbfda128b4220e5604cddae2465a69c43e6f4e278878717617056327d10af76b04ef654b4bd644042484f78ce93a1dd420aa34a00e66c0000c124f049f6ecd305dce4d354fb2d70798d2bf6ff8f6feb897571400ee68aff8038c9b89ff68c60aa6030204f2e275fa432fd9ce4f53a73b56ebf28db0143abf3926d31c44e7bbc6a3406057dc5f1f8d58435b85b0347582a2d68f521c6d5b5d47bbd7605ea42ead44f66c78327d6141fdcb1753cf8fcfe7142cbdf92a8221a3c6a27dc99acabddc28343b6cdd9aa903a8b79310e5eb6916c2e7fdeebe91723831643630a2d9bdf6fdb4a9d5e7b9776adf79947cbe1fe9e5ef62ed7b036424272e090b684ded92e78c309539eafeb2a6e322927d21ed1a71cefa9db4c9223d41a71dc586e5d270fdfd8000d6afe8978891e5c3f628b20724e983e97468a687b97452fad58ad103d621d172369b80f0d77db7a79a0ad77a60ce7460f1276dc800e9b2da2c1ce8ae91abff881d1ac68f83a3c866744edfdcab53aec00997cccba700fe628131cb9e518a4c5c4234dae6c45cf126a2f427f0220e14e52ba49744472846327a3f4997dfee28cd5ff77212d9579a059d9d2399f0ed6a0555a264fd592af8bb88202d81855eb118e8d717d96df227c0ae2c09989c9652899b44973e853888f278c4fabf2496d13c16293fbca4d1c2cdaf5310f9f0c04a7b98a99596852218e430b37638f4392331ed1d5b3e8a34e91e40b56b48c874bea67406c658842b588ddf160402fa474d66a720f691982b6fb5abc0acffe90afe5cd68aaefbb9aa3e04030006c6385bb9ca667e98ada66727f359b1fb81442d6e295c8cd794a32c2b4a6db950c79230f00d95714457685ddb8677059b4c1e1752662667401a4f3ee254d19afaac1652f8790a958ad73a4422c452a69c9f467210099037f06d0f8d2559d698978eb0fbd7e68e998146d892e89fce689a2e51abb26fd68138e05e9ed212d3d0bd48959129b22739ef102be4be0e1607e09b2ae3eb00facb7539cdf986b2c0d6111b4e5dcb7dfe6786a0c7e201769434c640b4d85419db068f8e61e297f5b934d6a91e625b8218788a142ce6ac247fd10c8bd557ca7bc32943370da886f5c398685d7192c733dfbe457e879ff623ad59dba3bdf9b52ef55952f9b8a5b7573c19af05891879f4c1c87f1b26dc02090d658c994a0d622597ba3fa04c03c7c2745f2c7cd8cd10802d5b86e5a3eb96e58a2aceac23e902220577ddd08f6edfd6e88e82c8d48b7b83fe927d249639fae1ab560079fd99fd67eb0995e5956323b11112c3416a0ece0712ca1fedf8f7ae1ceb70913c43795ff7e8fae42d1e11ca453eb7c538cb77d585b78c9d7bd70852f2a21e5ff676ef2c7a50717c244f821dd065a6699bca338de9f564c180d93c9679352eb216afdf4bdbd387ab3d96032782db434ad4a4dd2b9c251b017ebfbc55e402547a5ac8a2e2353840fdb664789028edecebc6cfb44d2c1c001b51175b3c0a0d0003694eb6b547b5c25ae247c86dbb3604a5c7297abd7f0f90c3b7087fac692233cdd7360f55f7ec66e856669f7b64b8fe94d78dfed01d5e6f9c3f1d4b20371fff3d3042b732c294cb4faf120d5d65d7aabb4189cb39050885ae89631ad37818e4649d32a6721864f04e5ebebd0757d9a8a97e74f44abe4a5701bb983ea39f541bfbbac3e352843d30a890b5f7c3a39bc7b73e194860eab23411b9006ae2f35267d1ad41637e8daac90dabc350df6cd78cf414fcd99385c659a463152d9c1ec1e7d0db0067ee0c8efd7ddfeef40f92f4df4bccb7cd5da7bfe6c2c0ff2cb1c1386d5657cd0f8f1b2705c228ac3394c717335c89a950f87a7626e35e9fc3e6b68689089f7e8dd73d56a13b48d854143eafd142fdbd90e1115a40fd57f27a860a48a5647fc14889ae991699f1ef5d396cc906b65e7f57e4cf4c15b507493a7de55219abca7dcaadcd5b07b0a8a603449f00f66b784252d63d5c3182343dba678addff540a64ccadf2aec94c76ee247a42575151accb709ea155ab6fef3c1ea8ea82a3f9afca66675c789659a41f4916883354ea5ff396e8c7650c6af423f2cb347b4eeb76f748483e5899213b7dbf1c25ab61862b5fb8b9bc3fae6b956a01e149e95dfd01004a529f027d0b19343bfbc1be2ae76b71d6bff6bc11f0977753a91c0e3d212771d13b00a7fa0ac9dcd96c021cbedb10cbdbe41c8125c9649063abe659eb64dbd0dae14fa43f2835afacfb9119f5eebf501409e7714c20c02e38da1b85e0b2ef7e67ec869ba22beaa94bbd5f9ff263abe43446afae932f3475dcc07cb5b3c86a17db60d5d3d9eb28b03dc12cb889b926fa7efb950f39ba9a3f78c9979fdca4fc36b7eaae127af1842b66e0c528b0d5bd97e452f33ea29b1ad43834dad18af98a58e1aced12c550273edc06a24ba09668dd072106edcdea8fc1805e57036863137a43f3d307b80b97083fb6fbc7fe23808c2eafca7757811b5cebe3ef1020e6de6fdda76f441ecc0a697b0c9b3b9a9b1b80873dd006bff7ce93e3ff0c75bccfbe81e4e3fd63cdc93227dcbc6d099591f9b9d2077b4ccba1c4caac21f9e49f35c40ede7f7d37933f78825da901ac86a379721ae4d61a1373f4d8b483df249c9f5407839aec255fb12f6831727492a8bd419afddc4eb73494dac3663eb89e3aebaacdaaa54f743f1388766aa4db3e321beaa0ae0d99009c94e60b1a41e80b1649d52bf3c90870cdca6a98a59d39172d42120973da44198059a8fd289f8228e056134bf51ce3f128acb440e8932b4369026ed2b9270abad261a6b1a1ed868f4e0622fcf28261ccc3c9e3977c3368f06d4bc40c08517c9ae7710e11c5436669babcc6c2c561d44198090af87502213cf07b2d05354bd95d7fb033a0afe19fdee9ba0d2327b1ce0ec4f47eae668fb1f455d48b580b7cc08cd72342a1d6f9c17d3b49a579ab64a18328c9527380e61c3d8fe337cb054eadf1c9c0158e607206fe7499d2a530f4f305bf552aeb7f0fa9df09d99c26ef0bd8ee0f4de2cf0101cbf148c5e8d04ffc5e14a46a2d19323930f36cdfbdfdfe09d7fba8347148c4fe6e339ac7d1bcab900171f90ab7dcfab341afa9e101e01039fc51bee139de73a786d4ae121e6ae3e975f0dacabb91821fcc8b7b17a30f130d3b4479a2f0c4d275ca9309494c42d7119090eb222336e63b098438ed8411703664b3ada0af9689010b191e9e5723c0422e25f2752f46cac6f226db604d6f762dd2c956663246462aebf078effff14b5bb4a7ad0852749c81477aacd3a60cf46ec7d93f81d672bd27bda8ce2f80f5551027b8ff50d928bb8d6b82a23bb82789a265580ff71b62f5bbbb0dc6ca5ed637c5fa0664fffdf9cea88cb572849a5190237881aecbbd8f6f42568cdf5703a7c22003b1f57fa9c7a2e2f2e64eb5f9c07ddd96fcb65a49aea18846c694254a782062e786baaabf5e798b8f843ee5d4a9933776d9a916fd52a6fcf0c9090626fd6a35abafaf94a79f038bcf337e76ef0fbe99b6651685e4037e36000a6344551d8e28bb5b3ce2646a006ed619fd57645a82779d550aa4ea819bcef9bd61f9788545a27d24179e6c606679403cd5ff1bb10e22630277ba28410fe68c3644bae4230441ce2d21fb47c9dfa39ba39d476d3310d48d401a0e5933d34843a598a5f44c2cd1b2a643fba82cbb41c7471b6ed4105fcf89123a43d508a8f95c10920b35a8486cd1d46c029874922dacca11387bc669e9e0ad93f0308f1f4b8206eee1bd3998cc69bd7004f98a133316da759e5cc11487c950e5a72f64ce60df2b952ed525e795f7f0175d6b6e4fd915d4ae03b0ea06e8db2298367deb2e997a7c4fb402f651fb2f6cb6f6fbefcbe96da1b847608c4de14329a2d3c06a732c00434124b30733f1528ed1ae9c1a74ca92f330db23b734ca1e466df7e27a28d6978f86463ed6f3e7cfa35c36df6132cdb3a29165c37ba52fadbf7954e69600265190e7b4cb8a5464b9ebeefb8f3e0754501308bfef64662a479a4ae395e185833f8f1f4232cd6735db6dd5bfa8e1b3c80a83a69fa2e20bd357734104b2878d80bc5ec9fdb22eaabf69ac1b079ac6bfe286dad1f651fd31c110af7d41a1098ea027692634aed8d73069ab929f170b97c51159f3b4c54ec532a91cacc965c26d8c33b58ceb00594ad3aa03d57020385303b050254b0cae872d1c00682da7996711b099ed964623cc99fe53e863aabe10cd016a4d38c220c787b3ad54ce07e8bae29da67cfe04ea6ad9d6f8c953e00d8b2a2cf20e3c8ddb72d318dc074b48cc575cc4830859f1577b40cee689418706939b0ba94841a309fd0ac8c99cbde138697c269c4ccbf83390e5334f44519d60fc98e518f99c98af7b4228a0d5f13f074b372585f15caf4297410fc029feccc4c0a67158c66ddfda102a54884f0001a48c7f69333acc29512e73eee7cf87bdb50b75c6d87b0d0c6ed4e2492d8e32613216f0112cd3aa71623a6a38d528790630f7327a6a20a14a7c0a1d5d9fbeba9f4be0a2babb3029aae5564dfc4cceac02e1bc646a53de7f896348642ee5d84aedb6b557d542100be6d6155911377cb10897253e0ac8a1f84321cbb7b13dcce91a959221150ac809ba500bbc19a950b3320af95a46821c8e704eed88d72a0ba46d78b8f863bbb93d7617af2aff2eebaa7507531e6a12335467ef0100f34db7990e5b195425392c4d5ac81a5209608950b07ee3f84e3e2fab5e3474ebf3e495774f56c5c53af9ec82e48120705e0a8eab05bdd87b336a0503c4fcdcce225150c34c7503d6afd4f48706e3526b4fa5856c9cbb9e045538d4f5fd90a083c802b237286e3f47f614ae9f0ec6ade7fcdb84d80131b6c45dfff8612d823dfde91c6536baa532b4f667243fa6bf6da6a8bde9176836474a9f79c0ae64d001425c67679c753af0a2bab50b67ebaf1aca422b0aad9d6cace2255cae12825a885e6d1d3600959f70ddef25f82a18d7a56b83e03b047035e72bff00bc0bc564265dc0e3dd6efe7bb798985d5816d2f284bacd356534adb7cc03f0a62aa2813a5631aeb277b1157ceddecf5c9c37c0a707df0ecd6990c359fd9a38c1c4469ad98bcb3730b788c539586b6851b49b36ab65a459e10f44be6940fc5287cccd37f794d4624de5929df4410a7e376a220b65f4ab83b011250f6945c175db94c8cc571178fb48cd24c5d152393616bb84d594d47586fa0994bcabab8dde68beb2de751aebd066fa3ea82e78ef7ff8a87956fccac44ff212be78105c5cc620c659d9e0b6c4937511b9f1367cbc6edf6fc2818c943dc78d97da8409a5b89557d9b36b323788d0ef6acf4e893dc0adf0dc3dd4d3fabc5c7e368b4530d82cfc3f3581fde8d5385f0944628644a33fa82f85b62a6029f60a85baee86bd2499a9f09329722ea0a78b7e0723267dcefee83da3d31bcaa6c898bcc9ecc5258fa466b908e66efd6688b369eee545ba5db660b0e3ac3df56118c299ff541b0f80a4a18f57fda07147ff096065fc59867cb00e96fb2334ed0953637f15e76e607ecf571b14c0823f0c047591c8ee4be6f82e9c71f4b4daa6d085f93edfdb4fb11fa7cf4a2d4d86f140aa188a84ea79fe4518dd509f7e70c971e4021a9408fd75a7c1436bc4518c7668360d1de611188ece5267490b9db790defcf91169930afb5563925c2fb46300386b6c5924425e02df7314745ec62790f30cdd3f4398c7fa45e0d1ddff81d04a384eb3b324963fa34a23eb0092f052bcbff1956de4de8a005756047cfd7dac0d544ae4e57a61ab0f9e7f3cb014fecc71e5b6b18c97ca184b18bc9ebe03d766b66f13bb344b38412559189028b20b3e6acf8e5ced92035a17e25b285c69d7052318a07e69bd861abd6546d0e0c227fcea185eb69b17f78bdecbcd5f71397c4d3d5951f2d80fd539274469400383aca70d888752d67180badb64894561fa132c9060a5cad460605177bb3c272cd7b83ba8b9b3fa5038cae05a8ab6329474482481c90c52f5242992be1f951b5c8198a93186fa3a278eeb219db29d85184b3994bda794b48b2a0cf4aa72dfc7bb2085e02f1293e5f3d534672c5c521dfb010542fd1ada3774ec9c26a17fc0babc3ed9adc68aa5889f5e977a022fe918588c3b65ee2315ee7b7ddf7232c433d65fa473af2c4f8e75f4618d7c4ea5622756f4b2ee6562af18fc0ccf67606445f209b44545ebb88fb94bd89ba97b08426002652f7fbc71f60bf3d1fb35685278a8acd4e93df7aa7685d90c622709bd8e451e26a81d4b0999b85c72a839d762f623c77fc9c32e94a57af5342811643f37406c1f516cf46d28fd0c0a14864b35bd7af163640611bea70f800784f7cb76a97ae16f5464272593ccd7b1ce8b6b8d4c91f4e20e78815781addecf7b0b9757068bd1431ca38932878bfbb90508c93bd515e49bbf6a4a76f12abc39e4516af453ea34645de56f521ed50391261df105b368f188715b80bd678514f1eab492a88fe55501602ab659e01af5e047295d0fe2b93462596a03ada76437c8831c239311ab6ec753e9b4df1b3475a19880ebd7e2d5da6a232f194990e157a06c11fe7f9e9d9c9616e581bfee04a7a62fbc16c44adbab798700d7e0df12d7b42def195e3abd10244824dc6574848474aeb9bd99ed45fd17c97a8046121ba7b55363d358a2faaa5440b7e56f5806e6cd87befb7284bbc3b9480b8e61b377f9e7ab1191fcc7fe6a9d153501ccc4ed8fc14120a106627e1c402e3d2719c502deca7fb02bc655b341e6319f92ef36d8b3e14422b163555e27faec0e56531a5ca1fa5adfed8b2679a8d7cc86e742ec2691b422e43ebd268b1a2bd81d6afa6a21b1c7ac5f34806ccb70b6618b98f6fcd1766c28efef9ad0b17edfe3f4d7679fc4c96e5c06a027e96f70a940a3c0667dd8b074460d4666d8a2e53e4fcdbb7e812512c25b9a383c0c28dcea369bc95d5c5a8a8e5d60a4f2513e74a4a96c12786946f4f28509d31e95442f0a8b9005c52a7699df18ea982e2469464c312c40b9e505c0bb9fb5e9543bb08fc2c902ce228cc0678170227a6ff3230367b244b6b667bdcdf8a66e350e35956d33ddee66837abf51a4d3bd9df9e25d5e03fd16621a100622baf5ad63c0c48b742c9cf1723e5b9f3049921be729ef6c0c65f8ff94483e188d57ce78b8fcd9fd94e95f3ac42e978a656c1e3e4866476cc6e7d1b402e2de55bea75daa490883260e8746d03ed4e1de7558c2256190391c52f1e3f948243390d05c48096411b5ebcc9b787521463d35ca3b5aa0cc8d3db6566d3677f082dcfd974b508c6d7b4132f9cca00dc7a0c3e76a75ac86d326180ca97d11e62b201f35a2d4bd6a8dab17404b9292d87e73b32e80a37b8ae13d4daad5a8e4144155c0b729877a4e6e8467a630746baa0e4240ad8e6450a6de7c195ef1b56524e00a80a151fa3114aac79eca9b3267560bb8770a3837fc13d81c4a21c20e074cbaae28cd6b57c771719657f79b94a5f014c34bf5c7d9a16a8a619d337cfdb6b544dbc9200e60ddac4028af5cfeb2d6c6edfb50ab773ec00dcb68e9201b87f65fc1a82ab95b5c578956c88ac8e210ab526194a86367c68a286bbfcc289e56c9b6871acc094d675c10ee073ceb42ad300de805b11b8d24fa0450e3623a4541f1ec95c0013cd4db51ad09df5510b335e1920a62eb2e0b40fbbc3c5e804c254f4b820136952c0da0583c0ed61013f19daa47b498a68bffd7636f6e44fbefde315fe2f8b2dd69476cc6f63a92c05fa4907c2ffb9fdc78878960ced547f46ff6fa378506a8560bcf7f7d0c879b71c61cedd36030a4328444cce5b20513ad15c02fc43391282b627f1225d9e0a7c5147d6302923d3275e45fc46a0d39fabf4365a13a1eb478bcfbc52748e8bdc28ee0fd47d1b1bf4f50936f71ff2eee99664204b5b8e8b2007e0f162906dcf634748dfcf800112e8134379b55b715a42d1de2cad300cdee879ef2cd71d42b0d35b52db6a39c3d79f3e8526d60464052e02a0e79fbe9ab96f07d9ed68b74b34edb89c168909af120167a9b1c541219ed8061df5a5e6f56d25a7774be43c28157ebbe1a99ba6aeac5c411f22caec272ccf7146e6eb5e1f44f61a82b2bf63b9a2522588a8ed249114da34a941c3d346bf154c765fcf5003f8325701c2072772722d60dfc628a80157fa55bb7c2bed80c0b44a4d9078b6658901fc1413f06bc04f3d3a8eb23a5f6d88904304edf1a1f5026ea1ce37f3eb0de8bb6bb2f7d84257c6472c7acfeae112be348d34831adfa83efdcfb098c5dac1ef7e6340bbbf68b41f16f2728b9084c591c244425e715f2bb039630b9505ee2ca4686a9ffb48200a746bcfa0835f6085fbaf96939abaa13a40082e9fe2176b4161ea2b9ad6cac963aad0aa7adf20ec600c4262e9f2b4b3bc24053041bd8e8f7863c9791947d92676b5db7607dfe7c6d1658ca27cef16fdf603c1e6bcd9339215fa16f9016a70437cdaa66ed9775fe49b0eb914b89e0b6e9c2bdf224da60b6e0446aaabc11bdacd7c1b8e9d66b4620871b6488a2b1178485fded8eb309506b5c969d313a77f7c3cd88710c63a60284c274140e686a8d93722cbf3efa18a0500e18ee33caab8d3c6445706656ce4f66e05d883cb80de75623a7c5af4ac0bb428553a015ce60c8af91a54e0af27f1577698d4270e22c34f3cfb9d759a02943eeac6675126369b8ee46205bdc0da66c3ca4b2d76ace0775e39af988e8556d43aef635e639c0a008963fa46713a982ce6805da5ddc8798c1fcce47bab159fc91fc4f6fc49c1e6f45f80b8503effd07fd6091a58d3126cb572b786bb78c4f907c75f03c225ddac9bbce1fb45236f544a4d1e6843e553f55c766ecf225ad5021af1b6a67895e55e2f7837a59958dce8b866515977bf56afb8f7c96c960f0f872bb997873d16b25ce325930a77363a6311c7248caa39faff98a0bc4b4743d4a510396656e5df80b22c4bb1b32b732d7e7682b9037713a1be87d98f0527ed2b296b514da6ed639b7724e1bf2e6816c19432eb694be7271742d898916a13f6435edd300de3fcb58a745aebdddcb54d2bf22a812ae1ec1e012896b09b17818aef6307689ab56efe703c8cc0107cc47c94dae4312cd3d3ec58c5f8f94e4ccd9d6cbb7123ac2f9ba0fac0bfad033a667e54215d6d8796b1fcec86e54a7e945b6dc4585403b26da9cdae09b1594286e901752e18a7609110e9be362f7e832f38dc75f0cc816e5173023bd4a5aa9325c7aacf31dec5d631156154192938062b19603998fa9967a9c36cb37d57622477d8d782ec54c037ccd3fc2d9b8d1d0489a727334807ed6bbf96001a80f629c0405807f410aedd2f83e4c1ba7f0bdbe7e09ab4515ef1604dd0961384c7c29655f83ea393202853b22ffc0e4181dd4e774efbdea090f042ccf260a3fe1854e6a9ed19f64120aca33ae4a2a04f3457535a0b7cc4681f32e635d80a42ff76c35ccd74d11c873d60630f78529efb9ba413d6c1bc40cc627c59e1cbfb246ebd5822b1755c17e1fdf5eff887995d23abd2f4f9721c80f6bcd27a9f202c0746aceffe59f1c1a51b58800fa957bd8bccf9e8a0b78ffdc0d76cd3397b00ff6ba345f9c102cecd0b42078187318f102a0485ba1d17e5748d745a95d7e2de9a93c9db585e419654e2831158e57af7d334528706c0b52996b3c89486c2329033e4faaaa13f1a451132eefdeaae99230f0130683f5a1402b6c6ca5687c32dfc9ec5681a1f3c5f3861b0c77631ad79b935af2092b12e759acc51beed38b0f2d9d012257b34cb51003962a4da2d8fb74b9319291c62bd60896244a2ac16bbbe30fc01d0ccedbc4bf301ef053c6c480d6ad5c8183fa71ee9707d24d45421860f91ea54ae31e8bd1adb422dd5b1d5afde8b76b1c0dae365fcf3fcd5641cabf03b86607e6de5dbfc1aec69b6d80563fe733d58fda98acd00ce1736039c621d27f870451f634207ad6210a5a957b3b13184aa0825127a22b6973e526103922236f702672acc8a1944d7154d8b3156c1af5eb1cdfae5ecd027deaaff309c8008df007dc17f3fe48574cc9624ad628fd0021f0eefc7ac25e0b3080b0a06ebdf187f7b0a37ac944aa1341e3d594a10cfaa019a2104a04b0163d6e0d52f634d40b84c0ee144995691cc67273eb887b2b81a2ae838f5222f3d17e2f9c162939a7d842edf9cc96a61c9e3e8614487f69386583aa8cb426bab4ad82255bfd1110846240d1580e591806bc90f3d481e48acca86d3e2a8796dbaac2ef23c204cc0735f4969b1cdf7e98d548886f08efbe42093c5990a4f7dc0e463d984f25a0ed404e21e7448c6d0ec19f49f622a1eef54a8ace5ca93169a167d6d23b336d50b4da23604ef6f5cc876ead23871ef9da3d14c1329c36a098f1c3b1543029089ef405d69cc7fa25d71dcb1fe1969d4f530db21e2cc81a58abf4aac60d19a785aae290d9a7f30fe33d69e81c3d6be86513d3cf0c525b147fa63377cc105fb61ba31f55b7587d973857dc74eb306f8bac39eee9da65403fc42011101892772291f5108cde3a2444b4377904ee9380b2cfd1a3640beac67eaad872034e17fee567a25166c4915a2d7920cf367b9c896f2d53c5d556dbe2d18bffefb0f50a73df00312999a05a005655c3fba42157a208878a750a4b111c08e9442fafcc4b6d91b36b1494fe8893ec47f8233f5081ecd01e35e4b1e69861160dcfecd04c13fb6dfa0c1db8f9f43afca4a60df93dff3fac47669f6385bc1fcbc79e3ec476e1ed07f79ca51a73e847dbbae945e4b50b3142336ceb5b8c766d92d8d7f7b744e4a9a088181b4e6203c1e97d9c0987f850c802bf520052d6314c397a6830c19ec2866a098a5bf905029dac1c99fca7043d16aee22415da65e38b8e2f665e61717faa1741138b698067f580d5a968be0499f45efb64e11c272589f9caf4334c679a69c9b37a880c5538ebf4ffad4d7464dd672c2fb08a62931cf0f991ad2269bb6da528a31cba1c76aaa53a7231cc5bc0bdf52a02780bc5544e96a35440ca5f9cef8ce0e272319810c1466ea494237254937917cf55efa68b39233b5664c5d4a416f2bc18faf73438624592ec3d4d8714f2cedc883cdafb6aa59b18fc4e50825e078d99733a076079f3aeb67f352de7cfc3117de06694b997d7e7047e91e411d3825812483c35512577c19835b4478e3e1c8f5477486958dc4f01612528048a50c969dfb7179b06f40d44970f9bc8a3fdaa2730de3655a71328d59eb397808ba457b0eab342c99370ffec42d06d3b58d667776c684abec9b4b16efa19959db78c4fd4281093a5ed2320df794388dabbfb4466b637e389fc44836f085cf6ac9e21a80ec4aca3b31a2a2f2676dd8e0b2fa363923d1e5d0c85661b998a0acc83d1f1cdc31090b1e1a06856cdfd9bfc50ddec89ae04b7dfe3ef416da20976daa23f2a8714b4e1228074878d970365f629c6e033ea8cc7b2d1f2dc1a18ad15f238b00e2ee6ad4cea9b8c59b9bb87a5fde3dd03a62b40e3e5d8aff9374dc5830550927c24c18b6abc770156dee77c02f94c559b2449d6c89f7a3105898f53117efd7f987a6975c89330bef1eeca6be21b01448cc18fc248b1b3e682c914553a1479aec8a28f28928cd884312ffcbec9315de72906f88f3d9f0845e9354f10d7f3ba639b5c0e83341d9a02f3c84a73549f23488f37c612f1bf24a88477ec064d6f80fc277c5312c26be9d53ea6b0510f7d84863b3f14699f1452938607a46a5d1a389206e693362f05ecef472eacdd2aad8712ec3395c099fd7733eae9a8dc28bf0419de7b99f16818c4114db2059b0a7505d35f28eb22ee296d7c497d711a2203d24f73e556c2460a5442677284605356862f634d2f651125b2037bbc2acbd19b1e51588f50620b97335ed7a490333bbc3844075652cf90033f50af8d258170532aafb70c0202f977a48095cb7c0f4160599a0d6a7c3076a85731327ca77153c045dd1de506221175894228e45d6566271c86f39c39ed6241dde788ece17b50b0b22df20270a08503abcdd2f2cc683355d64e6b5bc131866381663962ba6429d448dc81fa7f0844e37503b4883edb19918f2bdebd1dd6db6627ee1996b86418368bf04fe49bca7b1519404d2a137c7151a744d855a87e841d5a8897709d7eceec53e2fefd9d05ea4554c52ebf89b355f5cc14d83cd765ff8392aa430a0ce8da46bb9374c915f4754a699fda146b6a6f6ec30865e984d87e8e166561b644dbf607d6fa0be0e7e6dd0e4804b7488379e24ad57cbfdc84505c8ba07aac5a65736bb8dafb9a1324e787718200327142a11becc9c356591a5a6974f4159864e044db86cf4894bc2a106fb36cc494eb91225df1cd93e8ddfbe9a9f5352e4d13b21ac53340d1f373143c9956c5319ce612a57cdb16ac95ca0fd65545eaf11e5b1e4427b13602d0dbd54361f7297ba7a97032cab1acec3a550a17fa6ea45b723f187fcb0b8a924795b6aabb647c9069a2b901d5d30e1ce5c6c5a7524cec2ed6955a265d97bbd619ff7e88a2f8ce3a2079c4722d1fdb1445e83a104685e348cba785dd3bc9ba15607785c99d9a01e88c1fba50994eeef85af3f4faf5fde217fb80e331d48258b47ad94c8259ab66a0328a8d58b5dd221c365fdec88ce16a1e53a4b23c6947814c55bf99bb27b9700eb53fea5946ba9bf93a913e4e086b8bde5383456e2387a4bb9bf3356ddc502feb533b57219b92a53903abf82327fbc7a737750878abcec3b5dc683ce73663b875b28ace95baae3c12b02bd400c76e6e9a4c78ad1d43cb944865838323ded5dadd68dd8dc013d6af168e871d887089eff8991a3b293a3d0ea1a57d53bc303b9f1813c4c553b48d3c3538e583e9ad1047956d808d3fb0dc437a1a012532c4df07893ad617ad691099d31afbaecb9a8ae3393d67f5169952029fb190bfb987fd64e20e076731956ca561d0d6313e6368fa1e57c8450be1e7f1c8c9ff24fede4b514dfab7d1d2501da631fb37685c44aa93804d4330d200ad458cbef2d9457f9c1832fb95fc2e677f61649d4952a9c19be9515d375895a75821ee31a19d5908c07777b689bcb43e7c9f201f1bd7f54b41d4efb733696b364d8982392a64380f542c254383f06ce76d97173ba2b284360daf3188838ce515ffb16c436cb3679dbc1fb367cac2fbba19b11e79d8d2c70a7228082b3255ccb9184938ed89e1ad0a5c0468e15670b3dbde96f8df7335f51eab618a349e715d2790c2a465403da650f6b7e73208fdb9c1000e2f6be0c76fa5aece7ed59ebbf146a835fe5e3a354396682f5ad7f973e685309401b3ed578f6a09c0dca00a872839f4109d0a076813be4640a8f1f169640ab3a95d2511e9e47b1789a8f93be788dafcdc8bcd883e0efb8d883380d057bc80fad740681cf3d8d4a2705efb54a5acb82169246bba6c9523d073a110c4eb14f78c8ea85954c448d144ffd7985715e4ab3e04fd1b3a2d865a7a5e6fd66da98d40e4ae1577730f5a56990bd5fea94e8353ea9f184365b885ec41797ad22091cb550ce40693191a978e03ab1317375fae012710d000b04bd2fb60f0228c87ffbc77fb9fc46b4ea9da2fcda09986a6babf03024e8f67f4cc7de1fc060334240f0db68759580c18de2475681eb231cdb669557289a92e3a0407334b97b127fb3e800f11fb87d51e7233409379152d88d37ab6d4e3a726815a46c377fcf42aca3dafaa338612382ba46a1050b350490922fdfe513f11a502e4a7c8a87c1338af2ee5f0ee9c9c7689452a7c829d0e508aad036d86b10171d2da99964181992493e1b9544bad81b49bbd2d64aaecb160b3fe8d9b05d434e656e1e811358b1aacffee7c202ef579d6088d45d1e4a531a0e711ba5fc497d1f476fcae581b71812a4f2f373259b7de3d8be155eee7d77880dd0ff69a9505511e81ddd6ec77a2fbc96b02fa184052813ce420981a1c42d94a17ff1db3fe6e38eed55c91f52d3f485e9632a6cd17e6e378556cc9c70616c1b4bb13480552fb4df2ac1e05928abfbb4cf692159e9cda81897c99e90c125bd645833d0d39ca9229548d0ae20118dde52c52bf8243b6c6879076156ead9189459d44b4e87ea1d0bf7489eae5ae00799b76c93ffcebced8f3e3541376e9889075f40e99e46e038bd54ee1fcb4dde17b85b018af864dd3cb6da3b7cb85306322e01d487f36134a6ce0595fbe79a7a09248d1f5f34568347fa39f14fd24c1881a035706359ac263b950b9fa12682673fc082800453b26e082879bd3ffdf0cd493945ac874b9b453848024d973d9e82d5eadfd4cef7bade7c6145ef013bb9debc0af05121180146dc9078bde6780aa355ad2f29d62ab29457082cb64cc453025263d686baa7f89e4bb5b8f114f9c2e37f0d73047f7cf41533dd2f7561b99cecd1f6f1afec0fc981eaaee70d1247ffdc154c1ab6fd44de0c846c8a7650f622c50d81c705bcc366a799c5dd6bc2d8d326cfcf6a9338e3440c00c4b4361928775f1c4b414701d55acc461a43932467b4ae0513c83c8f68fbdf30bf1e763a0174e782dc1b83c4b8d4f51ba2c3bcf7203a78524370c4e9de888ab9789c9828c416a185b82a45ee1a512eaf0c311d107ad7d50bd1f85dc16dd4da1daaecf5ef51ed60e95599d84ad66dce5407049090e98494f10c54c609e8cc41c814879aeb7be1b4713c641cfab3b86dd9c75c88f7aba138e6d89cc4e810c87f08ff25f8895a90bb56b88818b9ce30579849fd15679abcc09dbd91b58255e0d37a86fad4a3c7c64ed3f43177e81255a4619568984d280a546dbb18a9fb8d93db4b3c6a08bb7ccd51acf53c17867e1992688567a47d8596101c03848082be0828eabc55b4c3123ba3cd9e19a7a8817d71547790d06a98777023611d9795cb5dca89adc218d1081c3524f866962327081d3a2e7254b35ba449be5e96a6841f0ce60f23d11776ad3ba25e965db4470bc9b0898b1e99d6de5ee897f4c8e9cf56d4d52ea9d48047a5ba4fb2e92ac9c31e1c3eaacfd1c2a223ce281cd563246b74622bc1505d90f8012c82e9f31337d70b0ee091f65f1336aa5169429c8c6bb25a48d082dc3bac54c93ee0723d93c8913825c4586ad8fb4d24af27a6a4eef08078cf70fd1784cc0d50b7abf8784c43025c25827c5556fd27dede371e258f0661a71c76d71dd58bdfba369408cd78097893bfe41c87e983c87139f74f5b3f9770f592dc0f55557574575cd63800ed1a563697492ff035ec8048276c270ec3dfe14296e6257f45e88bdacf29341a80511d73fa8afa9c54452afb6741a18295d5300df2fbaa3f6148130af53da4cf7030f23bc10c8587e7106b6c05cb7c2db621ba66d57dcaf534b32426f0849b49f06d788bbd746a1e6894e4c79bd4387bc34c6e7bce86388da047c1d9c249bff31f2604033aa4b9426e75bc6c12c8bcfbd86d1bce1c1443f1610c8b9de94924a933f1ab0429b07ac2a6d7182166860079e34c937f047c783d2a750954518bf704aadb9389e708d35af09d9a0db8e695d426cf73c68dd8728060b09b2fbabb37fc9c9526308bfb7066eb2d4822efdb2da945b7c037ee5353e5cf8d85c91675d8f3c0aaf34c6e08d0bf65a5b7e9ec9346966c81ad31988a8e81338780e61ddd7beff5ad550f58f0a8768891a180234928bcf44da50ee9bbabd06d9d98176a47aa76ddf39b17823126bcc333452681cb6aaafd940d975796d35ef38fe95a5298a03ba3967e8a625432500f7c041d3c241e39e3f8cb7d0b26ccf76e5fcf5df88d272f0be03b7c4e3167e4a55038f684cbe4b4c5cfcb687bf3d79e1c85c8ee609a15240b983034bea2ecd43baa1f8c1d06fa8126656a5e7af0ba03af711ffec3fadcbc639cf2703a54f644ab54b58190595570e6456dddc95600d6b7ea90bebe3ca4f0eaa652c7a842712c746c02f0123c901fb57c0e7bb8e888348e59f85ed3d6e97caa0c1c38a05d99979258c96f0fde94639f0e42b04d0cfe419f5dd55dfd748f4cfeca39fcc37ad7252046b4ec4cf9425191d91a821b826b7a621f86e94f1900c74fc9d0881566d347479c47f7ac3e9fbc8866784d96ba9c7a4b8c5cb004357c7874337e14d52e6a3047695dea923d9d0548e603290fd9d7665d04105707f26d857f8bb4db4f11ea695ca327d2a4fd6bd013518e6e2c07b49cabd067f7b9e915b02155c8c7d0e45e42c9e4f0ef75cf27b14e8049bbdd383294dc496d475c858c523174e413fa92c0c6bb14b534c8cda614a98da88d42cd57d917716080396e5b04d99e7223e765b14aa942de533130e32b4fca9b23b9221b4581c99a2dc206af3d9981a40e58686284aeef60f35d27a417ae772f04de73d8d7fd8d1e651f5b1588a1df4c72a888455708c9a877d24f299a84de8957e16c4b06df844214797ec59bdf8cb586bb943d64637c8b871724ee3b5f09b99b4f479229934c85b8c57773603379f962e4e86ab83b2cd617e931dee71550906b2da66f33120d5d13200b23e1370858369ae5c4d39d25335a9c9905a3092bb2fa5be0ba4711c409666536a0dc02b2318dd691edaf597c5ecb5c4429becd5e0052f8e44a4c025ce5081de13b1c4ea442d354230135e56fd35bfef77b5a0eb4cf122d79b75964019661a2651b17d1f16ff00fc070929c4f6c4fc68ec336daf9313ccbe6f871a875999b1bd5fd3ea477331831083c2f260274cb7c078c03db1505b2ef942c27fb08b972a5cc60712e1a481ecceafde67353e9378637d837290895cd0e86c6fd24795935de54359b0ea63872c42330efdae74ae146023582bd1d09e687977982205b8a0b52148ad08df0c0896c96c03b53093cd10aa0cc6f78b62c7f129b6825ee8830a8f87d450854fea0af30cb256481eabfbab971845cf27c0f311ac69b242890bff156ff0a333aa74689e305b7864805bcd9c998378e232a6676f00310c8f7b985949190c5ad25aadc4c0484b5b18ca1c2f1f41239c53c1972da29a87fd41200dc705368b441801b5838948f6bfd10a811f74d0d47abf73746c3a4431ae3bd358c697193ac505ee486c3f528a230e4f694b36ec4b7ee2e6dbef63a4ec36d0adfcf4b11ef02fa6b924504d5686adcf21258ffa9bb8c8c77782188a969c3ebe869aa67c2e9083148dfd65d1e4e7ade5021472095957018889f44e7f5c15d995def8eb69d714378fa61ef24463882645264ff55d3f8cfa302bc11c8dfbb50c37b6b1f128de00433be509185296786e4e9612f0038e31a740782eee1da4e60e3681e74dba73ccbfd08b8fffd3ef51de1d092216854361eac025b64d964bf89ae79237b2b4e1a7396687d9cd2acbf8a6fc3635088cada07ff457ae4987eaf993b5dbbdca5e77d7d11dfafa0c7a072efbfd5e2ecc5e311975a840c939b31ff947af23004953359f8b1d3ee365ae0ec0d1ecc0423512290150bd863cf67541ac0984c6063187d32a6b6380d4847f9e161e0224d17710eafb11f8734267a551390a562b72b52be60f325c7f4cc45592cb13e256c424a270bedede3d8ff684fbf354258343206801af7b64ee2a4dbec7155179009292c27325245fcce7628667400f6c0fa177715d21e075724607b44386414e9f54bcf85ac14f358184b82799844d44dffa4da65903a8a9016ecf7a893415b142aabdf879d90f74c5a8453239e0315fd9f5a12dd73fdde1b028c5437d5e887ec7d400b54ab2efb7187e9b07c0b25e7e7048cb683d34f8ae1ce86dd797fb48ed4d15054183854bbe6f9e0c631df83579560337a099a025ea7fb654ddeccdd3d810c632ca6f659f35ea06a52cd5eb16cd101f1e0d8f02080aecc38d8d9295f855b6ba7d169a4fcfdd05fa121d4f829376219b9234958e9401d6f2de92a8a11873f64d1087261beb8c48ee267936aa4eb51f2f7ce74ab6a6d5a263ff036636a3c82ade7b71a3637d381715576875435efdf69b30e5bbf54ae697db0eb44a124dc74dc6799747ff169729bd646b4ccee73218ba306eacd865fa6047bb336cf286c35cfdc6b9e228ec893901e2d387560fd2869de54dc3a4de9c7d819953dadebd08b61a74804bece1e0c5e6b9762fa0763cdec071b200b6bdc6f261e0d948c6c9067d81a8c77ba4e3fe05e263b743161fa993203127f9e092d4f7b262e66b5f5a5f6c25b9703422290fefece86283125f6644c3f789aa7470d9cb65ce4d369b7ee9fc7aa0189a2eb815c5cb663471fb761a5ea1afd2bf213ae161e8199f24209517cf4bc4b9923310d9e3d11eae2124adb03d3548d95e401adab6c7b054d7a40f792e49a8d4155f26627ec87f2a8bf1229590ff52128e067c143ff904c79832e1f301676d683ed45cd558f36ae43e19dfb9b0e65678be81944e9d4854cb0fc648439f2f8b9e71ffc2ff9187f79e84e3b1bd7eef75033978e8dfdf19a619c8db511d13e4f13e28a4f4bfb807e77cd394f3a0f05d1f8b1adc831080a6a8606ba12c05612deb0db2ca1275c8fc1b3ce435f45be58c911c3b84b468ed939a14f7d84fd5ca9c4bcf2f29fd5fc2a9e7551f5a32a6896da5b3d43471ba862ffc786dc436f497457b01aa8c3ab9cc7072de676ed92af86632aff0f4642322725e94889e6b21856c472c96842caa77706ffc476dc2cbcd9fa6d61a916972cb031a14a6eb9d4e962e48e3f6575094b909b96470d02f7ccb3a788af682cf3154c810a6a0473b613e23b4a5191efc619ac29aa0c3751414b7832bbfd1db19e535e3972d8ebc845c4a7eea7b41049b127436108838c8b7ea942031347d252ac3be3512204ded98a3827ab0fe89f66c3df2a259aa7c15201f972b0729d7251a81897b25a4c7a8f9b5d0340ec4a6a4ce074f7ba51de1aeb72b7d373bf1ffde2d036b7d6776ea1b6f974653ab525996a9651a6acf653e230b111af9457791885d3564ca5d95c0476dec15da74298bebb2ecaaa4ef06de78223fead7ddf1395d91998faebf9b81d90837b08fb33460c07d8fd6d5a889ef18a3d5fc33c52052860196542d9a294b91b1c8dc80e8e27479b11c9246baae8d6d211571929c20740aacaf704c265afa061e8f15732e29d329d5adec54e56e10f64674a592c2c1b52bf4064fdf7134cd64df84ce068eb6328ed32e1dd9da6b2480567f6a2ac24a973671c34e3b5c5691a79116773b820f2aba373f02ca46411f3797405d9ed75b25ef2aab493139c7dc3ba3e91be3703f5947c5da330f288d92bd2df658962e001b8f408c67fe9bc1cf58f49d8d132b396658a9b4ad035b61497f3bf190b5afbbb13e6aa2a8c458450dcb694c2eaed483ef516a1495a25f1193e6fe0adcdea989a7fd68ae2f179be2b2fe6509350c866fc572764a832b1775c320ea4e132444c92fd9607c89ea1235a74f0160c0f0552c576b0dd9bec29d472018062a296d834f88497a35f9a9b80eca8c84193aff4cfa6251f6100f4f2ef915f418b2976e3932e2f87978b7cd68bd1ad5a4e266e4c7c656326670736a2cfc673e3e665d663caa3378d7f229f700b77196ba1efab1b7875e67534199c2047a0e17f16cefc8387dfb2c86773f569adf2677e3150d0beef67bf900bb45f1d7eff792a599a44f2c26d7d62d9ee79e9ed8931e2c797f2a1b413e83f6723b88327b5c42d5a018c5ca74f37e81f9317206f14a607fc38820c84a1bab6462a249e36960b2fd3abc6182842dcade051214ff49344ebe7ce570d4b8be3e076c8364ab3e10163d23b84398cd65850db0c906b29b0b65489a228baec50bae31160686f162fc367e80339d7d43a30b14bb4b31e86812347bae19060aacd2c94f46f8c2134584e13aeab170923a9840224aa41f65124b0c4eafcbb43f354ad7dd30552db18bd44097e3493e4b9658ee6f9cf57212172e8522eda1b9975ab66a31cf03be5cbe6d2417d451b6ccf0a0a46b29f8f71171fca0f854489ab9ca3912823a8bc0d1f3b6da16f84a2b1dfe8eb6dfe0bee5bbd783d1aba1c6941624f025b72e4cdb29f5c56ef7f71c1d9bc0ebe99c6c52a63039094d0b6ff78fc8006d396de5a8517db1bcd93da79fd72983a48812872f9c7c2c4dd9eeeaf1b15978dfde41bee16af8fdb9ed44e8a6f3c45274b7546391cf7a74efe090db169c0aef76eb08cd8ea6cbf7d0bffe94939d126579943d0cc91747db5c30904f4c9a22e087c062aeadcb22cd480b78d52365f2ecda31a14acda164aa3aa139bcf3be6627f30db64000b2a034a0f5945a77c1a96e76c6a98f951593042afb5577d22ac9fcb323c0d16e95fc100383b3a3ca44a287b2c2f0e440efabfd72215a36606a5811bdeb08f566328dca27bb977cdda7cb25cd2e084411d26e69df057dc6234d921e009261012e2d5711026e16e5b7f2461bc663a5da94b94d61fcbda7a42bcac2d093ab2a9fcaf385b2dbf568ee989687781daa2f7e679846d3c5fb464db2f8398c73c009395e371d38cf7901554796a5062bd3bddc5356c6f0715e93940eb46c209b4a409d29af743b4a61c2c20a4a7c3616357451b72217c25642e02a563c33e764164a85fbf8b073164c572d7b309647bf72c98a56e6f81f75fb5cbce67e6142eddfa0f6348fe00d7df71eb6d7e832b57e5afcc90fa19b9bf37c6caf5733e4607747c9dc66efd2eaf8204a3b66b43c40a82bf119bde030823e31e38531ed4b96acc732603b2154d1ef1b7d72e88c42d40a93c0c9fdb5994581d8ad7d7b9c7deea40aebc644c3d44a4c5afbba96df43fd8ac438a4c890fb859138289d408206bd0142549a728ce65c148c20a5313f904b8ce7f615022b3ea2b8c5a7d395002effddb7c7afc2133def3de959f8d45f25750d5ab4373fd80e915b42e461f430ce06440f87768b3b5fadd428ceb13cea3a6905405c9048af00cffed9252fbecb1d64d5288527a3be8cc5568774f3c15dd6eb18d47300b35fa0cfe5acd548deed874047de1368c8aba4535caf8273838651e34508428258bf8080e498a7e8b8811958d178f2acf2d79151342d92669c1fdce0e51faa4d8c3b5646bb714f9747db7dac9535d0f997c5dc4fe0ad95528b0744ec00ca55150b86b1f887f94a98b748e2a031be687a3da596709b0e83c2591ea751fdf2791ae036dda33043f92110c29494cdc8a0998cb9bc3aadc5e7c5f15e59ec5742799d242f259cfb9f117b9ba6b32e6c18909c2f077cac6c00a81de39f40b2a5a015ece1ce7128c7a05587e7792f1e3de787686e656102118cc677320c65f98ebfdaf1e8fbc0728765a670baa528cbaf64949e8d2b5bdb936ee9e43ac4977a54334a8bc701342582003538a3de13fdc3ab808d52d8965e295a41c812743d68b691b6488c67a399397d12fd20e2d1015b042fd8bb5249c42767a62a1936102cc927b8d05616fe61cbe7f27ed35040e817c3d510899cb831cc0878a545aee1410e6ef3c8d1fb172a613cf89f168c63f2ef4726d06c2d4d09e9a3bde61c97ce4200d5df7e6b8b4eb70455e2ba10a84dd8834d94b1b32e273ad53e3121d9b7a85e5130e8a7cace4ef6359b696f454fc13269091dd900b952f69427a7e0c73d7af389bd36fb88422775266a264d4e537a5e2f0d8579ccf8e8f12351fba01fe587772d94d180bfc60a1ab35dcb875b542fe903fd6eee49b668793b9ee50da1c7ed855d045ec159fa2209e7d2e84cb0dec9440b8bbe855e6a5876cc3c172c6727f7068de010e7b5a5b8289eab5dc8521a0c1a55739da418b77ee173c74c15298bb89011ddea7b1d507ea264ecf3d4636386f9811b65dcbe8c5bfcd69911351b70c0962cd4a11177ad0b2155392ceeae783ae5e4e6d623839dfbb7d7809cd4918e3553b20cc7ae7c9e8cd70ef534ef89d32adc21aed1a4a85085b67a513d5986ca6c5773d5d68d94ed58c79373fa10c67adf3b79095e36212707c414c04ad4f96743f231df04fb9a9c1db116fdcce94b7b512d4cbbaeb915b58072a4eb13e1c03740b34fe0801f880a545645ff50a75c7e997ae668643c4d05963632bc3c46d104f23c97fc062a69c471d14231ca5c58756cb72d78c9be0cfcaefcfa3f1d923533a246aa0b809e8409cc5507c67f4b258051eb49badf262217ec913e0b8340b5c2bec138bebd75b09090667a63445e349405e5558c9a94d36a02623416786e9a5b725178d4bfb54df416512838335ec30608c0b287ea3c20ea181211730c1caf41eecd861771a3b4bdfa794d29546e34fcec25f93d14f5d44501729af08f7e183bcfabcbdb2fe063440bb13efd6b140b2b75b2fd9906ca9677895afdb334156369f34296f6113265ab048abe28a523e0db6e080ed80e635fea8125d4e1d6f6af94ce0f417c9c386be6363c09901b84649548c6cbf6a1cf98ec6a830e3f8504b819bca35b994435cb8658fe160488f9cc739bd53b05e6bf6af8dfaada7c33bb2959996903b7e4b242ce4d6b1334eb033d85faa9e90ce923a3bfde06bec242231bcab0e95c1c4d7dfdcf2301872039494b598cc5b9a2c5a5a0cbe6b91030a679103c54704bee92b5b20cf7cba5da68488959035ec7e893136a68e4261d4ecdc06dda8c57ab3f06bf11b0da4fa0d5c24fc4a34fd9101d347e845a980de5fc96bb632e183bcd03a0175c48336e7d5147838bc2964f8db4c75521a75175a30403601dd422c7cb4dc19988fafad162236ffe03f72d3ea53d5aff2a1935f94440fd6ed5e8f5d0b25292a860f75a2568f46d5a703187eae5c4b78ae2e1192143a4c783596c3e6a132def6664d81b2a74df118d2cffc11d31cc85e92be6e4135895187c95d6e5513abda5d6364bc11133256907c791498e9db09c163b12f8b37132f7c218cc92f93d277a08ebe9608b567fc8a7e7811d0075d21cc890c9af68346d1e4daa608c3a5aac62b1b332000e8c00e64771cc41321310815a8be85052c8671cf1af03eae949947c9c1b016fcdee0bf38feaee8fbd75e300c2af1fc820972b36197a672afcb92263049ef1b5b0ab63e4b387e0458577fdcd4d6f660d00bfbfe17ce2b47fa4111f2012934e732239e9b4359fc6c2ef71f1f794722bff54ebff28012ad5fd1713cb8f3df384b20402095eb06341e2beb18f7274cd39a309677f73aa7ada92a1da477836b21508659dd5a24db0929c0690f037245a907daaedac39dc7251c0663ee1ef3cda04bd028bdbfe36d41bcba9248fee033a39e0bdddc1924ad2e4db06c8f463eb2181fba20bf78c977510e7d35f187a8ad213358756dbdd761b8f9d87570736aeb82a3b8afc2bbc9471a0fbe431eebc33d95475592a65a2fd5e854e9d425a3aa4a685dfb22fc37584163b945cb3a77312eb74faccf9b18d080f48470dd448793ddd70988e7f85155318df93e279b6d71f46e6347b1469b422961ced4728eebb470cbcef0f178a1bcdb379bf193fa7ffe6e2170dabf531b93c0c8385d34a2a44d279f4c2165cc63a6b283e47058830943aaf0397e0e2acf233b6ee7d40ce2e854473c539a17362ae5caf466718553866dd5957417415c0292ffa0ac37dc38a1b044dbf37a8ae6d5ebb02fab4811f22144b7347ce81c796da71b960ecc7451848fce9751c547db9f615e2e3ec816752421b70705421ae1bf178ac292a105e9ac622232cd75366f850a8824baff5527a7f4acbf99a13a30e21750b70a86fb61a6b32a2e7712e2a1f9435e7686d59d3fc65563fa1d5f5f0e41a06a20f1c5dc81d73395f578b15b66e8d08087dea2855893b4dd151188218e881e792ab613d628e7492e8e03190c1f6a28f0dce56639f89331618fb404718c6e67fe39f429c813ce252a63154273b0ad8fbf3dcc61ef524d4093199e6bd12a709d3636ef46eb7d44d52df50373733ed294a0eb6c5ca0ac5b0830494cde580fa2ea050783fef0f2036d3e90b4f1401df2c2b80b767e97f186f7cfe4091666facd66b1b43251a8496c8997296534528989bfd45d00d06dae0c4de840a457181c007c501b85f2cf3e58386beb7eb4c700c473f943424cf0120c94edaff998766922f99279488290d791bd8396a7558494e4f717e8822234e8450dd23f87f22e893a5d021dc0feccd3a04f3b6fe49745dac484d9b748133f349204dbfa0055492f98259aef7a9613199b59ae000768f18bdb3b7b2cabfe574859e00f28a9f6812cb40abc51b1a9df35e8b2f09f025c27f1be486dfe59125f6916ddaa5dc02911124245a725ea093e17885b670d75dad37202e3350873f8dfe604d5e1dd58d51fdeb1cb817d376df2e7bb66f3b44a57c501401f5781a2a8e78dcae795966381329e31c0af5b666f5de0811ff70c4eea8471ee1c69e564affcc76a4eb6284b2b1bbbb1e9a140d32e8ce548c1e8dcda2dcc4dd4bd027c1e560c6a1a19d00b6f7d4dff37a7a8be9658622969ee2cb2aee0727c33f361141486b0401e6b3227b4b750ffabbd44cf5526bc36ac2f91630fb066d1f7175958e881040f71649222dd143f47ca9424c97f53cebe51b0f22999140e87732d841a48cbe2d10353f9370552e991f50409ed14e49b79a19ecefdbf522b8d3e6e01e5cf3800d1a6b48428ea8d5555cfb4bcd1a473c115b1b25f5cfb9b468599d7c3ec08fdf0edc19fdec36c57a46d06ebfb362ba4ea6ffae8c195cabb74b170271c48aececc04e69f2d9b73c0602ba9fa43dd6f21cb0a20814106968ecbc503aaa1a2c369e3468a533445427b1f654a262189e0281bacca6f7b665ab112e3039b4e15512e4105d532e675de779174beeca0c71286d39cada40fd14d7352a1f1e804297520f10549e34967c17c0264b522a73b3ff111bb7a9a9775765df5e0e9aa4624f0f523c12a0159ae75f9acd4add2a8ff87552455a9d619b21e07fbf626c949e5e7a45d9602bd99e5af0bbdea2a6555dc68f04ce0db3340d1196d7159aee77d2de63a9003396760745a6511cf778504e2a64231af45aad8c1c0b0c47f377a75535957bc99a893e9e701b1b620a4eaa73b8caf0eb868dbdda8c7cd44e17729cf08ba888a2c4547114afe3584db07431105fd927b886ce4e4c4797a0a6402f88ecef0815fedba7b35802f0e5fa9ac9df1663d0cf81936f3b28ae3afa97518a37782f6f66f58d91c1b9d4d5c28a30e0b6f325631de3c3e423c3354d532a2c1f4618590f1ac7f845492656c815177bb006b804e4992edd3f1ec7460efaa75d9c066c29e4499f7c10a91684093b1bbe609acc3a8ce72f64e6dd1d3304ee9ef4f2c60b52448be21ad6d98c431896c674d74828ef0e003ee46dcb50ed1f742330843d261416b6047810fda8bfef4e58c7eb970472f5e265d6591fb94d59611ff821943014cbfae9303b781aaa3fcc51d8df9cbb4bf84b18a29a74d6f4f34c5c58e7feb0ee3dd03bc21316ee8ded4e292bbdf16019d5274683850054dff073a75ca8c1df94390762bb0dd1bec550b5bed752fcc5deba09e36fa3f8e2d1512f196e3084f3b1ae4e6f6d3012828bc73f92903ea94a5fbd897d21243578428f4f1dc8e127b5b76d00509c870068147ec7395a10267b8ff13c3c6b0ef8fd1f38a6889b520f86866d9d2e247ba015ed8317f17b8c7e26dccb5cb63c29346c30ac38448ad18b3821cfe108e074ff6e6f814f4cb4805ae8a616d222b5ac1c585af6eb1c862b4b0a65888c2feb9b6348e6a41b9c4818ce23fa602b325ac5177802b854616d4f9d9ac5c222a1ee387da6c4128db52991f6603b1c0a17c7e325577ed9f55011007b1541a32dc34ae13c589bcb856226a424c4dc1a789e0e488f5856545458dca6f8919ffab232b7c42ac3bfc41a4cdf2eb1c0b88e0fa1e7bc42c6b6f0bf6c9882b29ad4ec42eb0dc7a5e26e551efbf02affebd75dbd5cfbb796ffca180a9b24c41d1e2cd28b08963006013694f83d32e1ccb2ed306b95b8aa1e9ed40aba31401ee7ca0de7715bdd2a821cb5a17b28e6a393b839f935cfd216c508480bb1e963ae59f6a5d90afe724f0b7d63b43aac58cf87bb7e5a67e36ae0aea37edfd8090931de7ba4b39f9f1036349041b4075579f1dccfc125ca230fea3e1f1187a1e04143e927d44f379590d23cd4ff595b2ad103ba2262b85cf4bf13a81e2c6a0dbcb7ee8259c412dcc43819264532fa8d25bbbf2d48804666d23040999879edfebed8b6c631110b996b708840b95650075ab9b29065ac38b4bd00a0edf8c670ca7966df6bf8490b72832c626b995e88f09e55e88a811a3a8db7cff8f286d9c5fe626ae45b82d1e80c96878a84edf1d6ca5f28b0c7f0992b858229456bb2958ad0cc226da14c93c7de851dbc64fea60accded84f8714ba2bc032e61b47091a1936ab86b5bc408be7903ba9fa4d222abcd608aafc7ef82879225fb436d4a6ecb3b91c5b1f61ba0524f1b550d7fcdd8b21fe2da4207294b7b35d781818c35a3ea8f038309388d8fa7b6fe071f7e005b866c0c036a6b6dd27615854ad21bdd46410d15a178a9165592d32d58d5aa0dd1993e7bd8c6944a0066e3b142df320fd9663263478024483b9cbbc1c12018d2e7d05c802056ef28eeac9ae04efa58ccd206a28cf4b6aba8d007279fdf5cda3a29c4536a85c2c216c877ab77462f52e3d2a736f136f7cde987b7f244083350cd7d0efb8794655b5c92d98c42e94b818e2685d4e0cbe47a990d3560fb4cf46477a9b2ede4bca0a2072e856f63fbcd0889bae1f8d58752cf21bd7845d5a3bd1b7b5c311a1d56a90dfb13607887bfac29eaf196de8d7ffce9e33aa3eabbf7c31a1321a538c15dfe9f87cf798682c98a586c0e988fd8298f02c441dc4223b14b1fcf699f3ef78b752e5c4d981fa17c9c8682f01f573790b85feccd0059964a46b7d533b1bfdddfe888b6e8cc5dcdc877ae63e3b55b7e93461cc52bbdd8e055d16a0c2eb05e6cc5d39dc2beacc1d66cc59e5bae82ce51701f0728d554fbd38d1d05632622b7baa7d264d17256c17edddceb7860d6e5a115af776ba6735dfc446e68715d02ab5a5ee6bb9f8cecbbd5cd5339148095a86e80d4f92190644bc383fe0345bce9dd448f4976f1d983c4d819a3fa3ee42b421cdc2f621af903339cab6f741a2650868f5115af3d28dff9da3a39dc6956e44892c7adaa26f1e8c8b0b1f85fdbc3c869e7f8b92ba226c4859c4a94b4c67a33b9251f92d84ff69051c993eabf7d41e5566290e983d1945c135789f5bd098cb71adb2086c52139d510c57de7f52b72902513b091f1968c5160410b512944c55072f3af5008a0da7a8874c2352d762db3f8f33ba9c91b8b929afea22f69c534c0e30acd351141742e2a6d5917f5d773db3d31e9e7b31760f2c33d770069c73f04e7cec30a9e3f7dd5f0d27397f99510283f697a98ab0a2139de15ff80672a64561360b3f87371fd985f4792b6dd96b68040629678e4ab9036b458251dabc39d5d249205f112d590c0c47b302703bea15070923badc46762602fa15f53426cdecd899f65191d114acf4d1333cfcdb4764618b5d7497119c4d3ffdd38301e7c5107f72f1ab678a153010a6452710d9fe584e6897aa22b008135961635498bc382d0348a6ca8913225b495c15aa8ee4fc97d31ef166a13e28f738fa7e524a7d071d4d75886165ce605bf24f04ac71062d9d69c5b02e10ab816d2a4694f1dcff7a110a3bab8c8a50cd9e5c8ba61289634d31c532dbeb2cc513f321dfdc1662cc19f9673419dd554627bf4ec840e2cf15b38fdda7a045eff04f5b42280ed5f9770eecea2c9816f330db912a9bb65b5ba5c735e2134a037ba0a9dec03ae2c6d7e289f3248e6f379e76007da18e6f6b897a6affbb1bd4b2001c4a72fa7c292dd69074c62568701ed35b5d8439e1270d9f7d57a649c5560cd0395105f5da9a19a51770ac1255299ae7743d74408080c4dea587e61a868b90d429fa3b782f2c9904871a47edb7b6ffd1faa5800ac7b8833eb9a620948c19e59180b94aa602c257036850f038b9f2d065dd1942d564297dc23115856955204c2d78de290d8f4e039634b832d0873db220d5213fb787e589d665997272d5b3955f47d66c6bd2ab7632c6ff1fab98cadeced2fd1c92fffedb87682f503f91d6bb23450536d99ff925d7a27ca52b51cf2fc9e3d130dc93ba3d9da6ed1f77e13edcbbf76d2ee76fc495c8919d0ebb1c38085717f5501b3a002565e2413d4f0759c16c4a9fc67182f5687f905ac227a0fe77c7472a1ba97b44e7290ebf18780f2913c92e5b021275032abd8b010bf46cdc1ac04db87e9b3be90d4c4ab19ef1a9dded25946965e23e26d58aa9ab2ef39dd2647dbd1fa4bcc16e7e07dd48473975313b4c24d7e72f5a3c70144901190446b5d44b62eb8f41605e56fe57f6b3e53b3ef2c0068bf6072cfd3706e97036140a57ea1e3ff4c93311da9ab2b8b1a603f6066d87216c60a573d97a800eb064f27109a5ec20a26bc446b813c9dd089c18743ac88b6c82b4caa2ad00addfe725688deee38813d649008f868de7fd88f73b7162fb23da1acc9df14d21a2ca7d58a5fccbaddf87620b11a73df24d76627c011df073444d526c016e8b05e3c8ca89a7be224d90a9eab30b795fe8c9dc52b53787ec24474bb58afc3aea4357c627001f84e382d5160934de6e86d4830faa1bb652e66dd81bb874a88a650a1348c825c2a1e0780e97027e370b1a63cbfcecbba431cde157f6e4d3f9d17a9a23f1f6418a95f71cd0a7a32eca93436d179e8db34654ad933360df029bca9d8712034a148270f0e651c02cfe4a14270e3141fce09eea87eb8d39e42a3d6187ebfe351ef5e90e6822cf4065321cc632f6fc4eb5465142dbe505c52849f95bfbe05e2de83063578f3e041579cfa6143d421aa22054d63337876e6e0e9f57c14b10108ebe0e76a22c890afef61c39dfda67f38659c1f82f1876a95067ab63c34b38b050d79e56966059938107bd9fb69dc818ffcd5361da33618cac8ea9454a9a6b94d67b53b6e43c17f4e816df45a45b310870caf475196d73e13378caab7aff01fd37bd88653b7723cf60cd472fa0da6446749c6f50112626c00aeb1d8a3e92d02d9c39c8447e2801be05af39af03a4a40c0e30b40e9e637d8d25fe464bad0163bfcf536743b258942244b2ecc3441ccf51831fa0e648a4a5064e3c63781e302927d89a91ad4a3c4c7af2c4900826cf94dc22ad1161321946a211dec7b192b2b32e5ebebf160c15cddc1bb57481ab7567b7178ed17aec8cbf4a2c938127e95826fdc59a0e001a44324c9732ba063bceb9c0afb6be0b897a0222ee7aad3088d3413e7b4cd227b2265b74caf6b7d0db82db92d4544b9b4a887a9b66eb48e68b07024c11834ea842f2da2d82a808a8cf7b6c5b1800d0c32b6188cc31419f0c8bdd9546454385a188c24bdc358a4941db9c700f929f806b1e557f5630a40df4c85532a686aa42eaa5ebaaee7fb095c3088c486c2404968a9fe9682d3f32fa167e8d57aba65bee5232c56b24956ebf9eeddbe85278046ae9f19d04c495893a3cfc9eef5a7e4809440e15538b2923503796b313ea6f37f5baa02a31c382ae9e96d3a38204fc0896b283e8c4dd3b69bc4fe59e23df57407c7b4207279576837b053f4a025a312a3761660bde425c500104bb9fe7ce704120338c3decc24f359858d3daac50b8efaa0d623ed002f1b675b4d812f6c2c4f9edb67d4f8a70f57efa57ea14c5edd286ad629af65de58c4b6052cc1efa875465a72c621a5e6f3fb51b1f80827035a51f64410d37c6a41bb9ea5ca50ae101380d535660fb706c78d5209934cb5de3fbe3683c593d20d2c3c2639b7b5e8fa7d5a200b1f2e101c6ef7778e1792f506407ce096f4ed8cc0b84e9e23b205a8ce2d3085241d4060bc7ded6c23ee2d97248aee07da6ec5ccddd2449f2e2534d871b1857e45d2bc2ef70d7a7363e8ecd7a938c84d46c6b80f969f90f2ae15b07e6e7c995480833de79d6c3ffd6f9be2803852a0493a5f422c0c546399609577e1e424b2072c1d03670335af53e301de8b35b99b6434b017f46726af83c6a902b69b2ea8be859d8e1d05a8d50ece5995dba8933a09b0f05a8e56cd17e0d6abf59f98aaa32c4533304a5bfebb4bd39f3f86429e6e15c0d301c7377d1e0134665e13cb39a8ce08ef7ace66bcc45eec0257b00ec85df5eac592716ec8a12c05db4637bb783ef61c3116a56a410973f100fa166d46745817875c59241b6adb22328d19dcc19e94fd548863187c0941c10f6594bbd0a59e6c9ed8960805fb4fe28db2db23796197adcda9858e26645eb5f6fe9568d72ca284aa8bda24b89d4aa15dae6e13891bab9ef42cad5dd85ca6fa6ed17815cccc1ecc52a111ce00a809b47118e8b4bf8a0fce455e79d4241e22cf6bc5f5ba4e75dfcf961a1a4629cd8c0bee435cd3dfae65069ac6a4d88384542cea0d2c24e01e467b582f6325048c7c50140aad7ac2019d012bc0253ce0e209cfc076b8048eb81c09869d5484c5dd5297813bb02fe0946b19dffff5183e8821ed2347184bb6a56a78867d23e81be2d6ad26d87fc0fd332c435d1d1860596619b4d91b951b39939e8026742c977a72b635ecb5331f19411a6985956c5d9c7b696b16508458c9b7c332f5b71eefb903d58411858f5abd444f6b7fc98699abdcd93133e88c1f04e096482392a310f9da05607dd8d7140a72c8743134564b1f021e3a41c9254945bb25ef4c16f7205b7cfcb913b25e900561352a029d213d04b0c626145799d257b1ed8dbe1918484c01746e60dfa424c0dd535e3a3fcf0fac0395ba76d3f50d95f4eb3300989d37f684860cc504feade0b7948948a620a0a5eb2b36dc00b81f428ad1301e88b20828c0aaef697eb4b9e7b8dbdd7fb722c5b52ca00ae2972fce4a961052193a888ccb3948e147e4f4b5d603d48df674b89de682d97ce29fd36862e697cb8a621b1119ad0d9c827999e3188b250e2455f2c1b3dc4672c54f4532b2910ff00e7d8daea9c6e98203f4e6245188a483047e2abb7a80111e9edc6cb3d368cc018abee7921d23964ae863f942e784760c31607957db00cb44afc5c81ddd3ade2b30216a2ff8a929cbca2b21eddf4931a6b07b80f8df269ffe646d89e313baf56de738480b5fad05e8dbfe1d048ddbcc2643efd4001e3a901d3d0dac2d5e196ea26ef540b05eb826219dee82ab8ec3778150942cc19ac388576d2b7510d7b72676af5324966dfec3d1bb3688dd83c711e3aa60a03ba0f75bf04e218f28c03fb322d63240de34230a172e72f673b672ce55fdf65826a2f94a61b0f37d090addcfabea08d3abac915d2dda6d28f8386b8435e3352f706625067291a83958f4033526f11a7c80ff15afffa4ae08ec0094517ca797df2b72eb5b1bb90bbf1f3994f037ebd5d9fdc9c5c514179ef92f9ef246adbf48dbf1d0daea8fb2d8e11a0602b1a984100d58f14e43f080db071ac1dca574d38c61cd4a5ec90851ad495f05b0c72092479d343aff807aafe42633a38a3cda63c388c9681f86013af4e3b3ed25e1a44076cf39e730bb580f9efda21dbb6593ad6c18b0870e491a41dd4f8e5c49f00d877d86d5230a075b852709f09b23829ef5f93c0ed001a695595dde85a77c51855acba24baeb715dae80bd66d049b69899014fdf0c502bfb0d63164d15337ab401fdeb3423498b083636903475daff76d9599be7dbd13d05c463f2e7913922b76dc14a554e01677275c80a880c96e5288f69ca2913ede49a62ab648247236fb5b56a16ea712bab14096242f2394c14beb754ae5f252dc5febc8685ecac081cf093a44919c5784e255ee997fc0b3d9ad9602bc4f14d2708d08fadd0846cd5f253fa85d38965c73f7eb1d680604028cd4d299f26b13bf714be93b6a7f7e54bb1ebb58d94f553b8fba39924e0aa791d91ad78311ab9a0f6b93552dc9cc5952b447993053423c9c7a19a9d9264db49fa00082be1add224d6caa4de4cc0d0133eecf648d892728561be721242b62d4187de43ffec316dbafca310f0dbf64a0d5b86ce12da52b303612e78dcc8363f0677b6909f199b622402a943dc05a2bf052f4b19175265cb7f53f51a5c9aa7331057670a81d862a17cb9679009a7af5dd2e9a1e999d12db403698cc8130476b9ce7f6cdd7e6363a895bc03a20c43dbd180d5e1437e93c3f378581c7f22457cef3d2209a3380b159220c03912cf444541f581a7e3bff2a7855011ba1d8b662ff1feb3622ed6e84090fb560ef5ea6bc3c7df553adb38fb87caf9d677dabab71fceeaac67692077d48f6ef774bfc44027aab8a07a6d9d51e1f515fb03275c9bb5b578fc2382ec7b9a5db6324869c0c48ca03817e1f17258ca75f000cc9a9fb0b2a45157869aff6753f97d438e3abde1f1ed0d503ca4ab99d1daab596551de93a25ec9ba1b847c78d9e64d9843e8b2d9b432f4fc3a4bd5bde7517a6334701b3d72c476925e9fab0179874cba0d59eed5878f42dc3a0d6fba568ab5cf7fb0ea7aa2f3ef0cf92930b67a2db2e5ee2e2c4c428a144e93ed6d9cc8eadbff3e5d51fb623f2cbee7eeffb68ca6ce879f60bca4a4950cb04724744cb5a3f6470cd65a47234f2934c39689f1d663e9fb9963ec339d04dfa5b4dc8c22025a34e3762b3b00b8c62319c0bbe85872be090ad5bf4221934d561e317b2529b0011fc2408e5768ab9c70f7f536e68dbb2c647444ab72505f79456a2b754a92c5589f8e003ac75998818072b3ef7fe244476a97595311cca3e79112695cec268812620c88dc3aa82d86ce6289dc5ff3ed800fb88135d032f52ef76ff128a56f06056196bcc4459083e3979d70fbf727ead50523719653652fc275894dc9e34d424c22d3719fdb4a247a76c1df41b071ca62974aa676a29aa1b49f0fe6a7ba861c81653eb82419ec0036741e840f9f047cbfb870a8db2760e774cdd07ddfe386182a3406a405bfb6db2bb9c0047492ad6102d1e33fe691e6048e640143a36a2ba74b402a7ea01d556be35715e5b687d14b9245716ddcdb8e8f6b26648e91f7d84946541eb932e3ca628803012d022f485f7e9eaf068804fcaee09b0369f50b1a39be2b399f9863d5f229e19c9ef39c4cd5eed133ad5f581de726c8bc05ca791182fb1b4caea5a7a26ad8a41f27216c95d8c72c990d376b6201909e737635307925b8dee22d147640c8e6bbcc062cfd46876f4317302a663a3bd85f2946fbcadb5a720ffae012c49e737b440de528bccbe51d25b612f9c506b7e741223cf836772eaf7b5c42acb496e221430b9b462a5b1629de9c4ebb93505b7122c199a416c43ff8c3da28f28edd7141c4f79c62b36c1156b28183f93c338f7fdc40183de06bbbaa6201f57481ef227d82ede72c9b3f1acd58ed8b516aba62cdf4edd5194d0388740afb098aa11775d954a940ddfcf398963f62bfdb1f47fc0bd66ad27566a2290b07deba2a5f91a3586dfc3b57fd3825f3f9593db3d2c43b5db1f4eaa26deb9c76128ad7e4082061fc9e6f053b691af89f1b25284d316b39a168a5aa7cecd82d7ca2bd5b32031d976508f42865d5c9bc7514987e583c59281587e0bdc5dcb2b6247a3c1c594ce2399d41cc3c6b083195e89b55485e15acf7c7fe2cce49da1a5c1e8631ffe6357f219d4a98a0a7631b79cb4b67d9ca4674f4b890486480da10a12e4167c762d460b6c8c77f6821d225bba7a60ec1a8ca4497bdccd769abf96cda46e176972549e78b3c1cde01e6af5709da41a839b9cfe9921ee6f820d8c08fb121d3963ae3010fdf4d595f844fc8900fbdc90ccedec0c7bfe95a6625b1bf451a2fcbcadf2c8ee580fb075c4c5183309b026c3fa2573c02d899b5502ec3abf6577cc3f7b498878f5ecfaee46a2a3e4c1837d2c5aee6421bb67b4ef597514c40c7c9228d2a343d655a2d5d58bb4faf7e010a0ec398f8a6f9550e49a22195aa11710a637bae5e874c94a555403cd3947271bcae26def330bbd89d2a7b018f6e5f2d90f5a7392151718a9a646982ca7e66e638a14120a7c7986ab49c8eb75b2fe7f9812932bc49b95d9d7e75fd6dce2987a4c6fbc4f541cc354f528d87f20606f50635fc35f00fcbfeb901b9b86a0cf28c44a3c3a9088c28cbdff85ee843a2128e77a6690b32fe240cf16cc1c05a87bcf90a9b79fecaa67cf90db72162840993092c5a5bd006d0a0abd0eb70452d13da776bded799d83c7afb160e8a20a15f190016e331007b3a007b25b975eee874e9d383f742d30088677976fde3eedae69232268053962cf3bc4465f5d4588ce9a7f565775793a203666dd1bf2d9928ec537bd5784545485bc03520aa3f8e32388c25d3a3925f347bd3db1c39c8cd43e07a22dd91c5739c4b4ad3ce1ed958bf7c78e12cf4ec221cde9158c52e81b04879757c256c995dca336c48922ef2b6161836670174b51191b8e61f01aee02963d1f515cd3fe477b0b53027ffdb02a202417f0648d4aea3f427631be590afa71366b69d6935b5231301601ac49751c5899e67f8d059c744046965c4b1adc95d51b2f1f1fa30324c5efc76e58d29f29e9eed8d53a41a349752cf17d17d0775c1c6d45d485e07e7176d7a212b236fd9dc24ed6f949a79fafd6329547e97bc4c5d67ccd2c40b4efaac058f9f75980f1c37535a59e31f79271b3e4de44381f22abb213b330fa8b4198dc0111dc56a4cbe9fdc1ddf448cab5ee9db2506c8d65d81339c21d73155ca49ded9a42e5c8954818acf91b58b576a631aa54ac8188c75a15118a661598519a5c6fed05b5d78ba5f5479fb1e8cb85d3a9d70d63271e573dd90c94e1e2461a90c46e12ea3bedfb8e842bfeae42a8311d19a524fb48ebeacd4543dcc20289084fb035d2ec0c8ff8d25f56584e87a534efa3a20c0e61de4b205feb5ef3d459b4e0a79f6b47f94f5740a8edd8c7d4e6b3bbdaacbcbdbaeb34e04da6fcf555abb66ce8f83c300844db1383c3da1209160ca679019b4b94aa9a4e42fba9d25e66b15b198098bee5d2385e03d639a656a6578fcc5361b5d137f6f6baee2cd8e167a847ebb8d3318a6e9cdbfa478cdc565135242e52d5641289383daba9d0babbeac0a8b46ec8d70f5b9f2d54d9533b3bce31ea7142aabb3f049f7d1e625987d3cfedccc49a81de1c03d7061fd6e72bf7219b7d7220af35914e55d6b89c705c8df0d5a1ecebeccbee27277b5f2706c42cc72e56eae5ca6d7322fa6df02712a42fadb251d08286f001f09094e4228b044d8f2689a17cd38dbc13b34c8318adb297551b9c748e2d399a427afb59cb0d6546be78473f7ac174f9449288abce8a17c792f52b01c347c9544959d9da94c2ad3a366c0be85654d4b0b2b5835cb5ab37195943aedf461894cddb52c85590233feb670752e5b56a1b23133a283e5420b35a9aca98b40547ec34523bb6c26754fda34f399b3a0ef9eea29e7f0286e0cc99e378d39a1b64a2c86595a23929742ec46f7a94fa2f1e7c1fb2202afe36a7f3d0661c5d13732fecacc02bdd3e17d870d3abbf4da777f289edd8cca6af17e2d31b3ada3b56b5f9b3408d16b303b203420c51b6cb7b93eca9db1e3feb0c978fa66dc4e5c942a23d26644ed5e64d41886e01c3d1889eb79afc720cdde1d146d919ac423cda757b3f690ecd3cbd0ad3e15ab9b70e51f2945cfeefeabb63e2a029bb2abce64bd0a0a1a0e6ca10806f1992793458b4bce45c4656763f1071149b8ced47c70a9b04b1ff62e450d9cadb6e6c279471170ac2da955b235b2e67cb9ccdc543475e1e612f1b8e551f5a10d8883870f2495a98b8a799a08efa259d68939bf1d31a71d14c94870db660e0a6489b10d5226195d1d17fc88aeec18d495f84342a111b87d2c7bb53735969653530230b5fc3ed8c457b2ab750da3929b98ad1dac04c15b13b4ded07fb8a0c50d10387b4a561a8208e8f03bba30157e5b4f1a7c3acb605640a8e79726fdc75b640a472ddc55bd24afd49c8e6831b84e28fd2bcdc4012b3d6f1c6d4dd86e1233305dd9cf35bd5a313d109a620012a33aaa5ed7a9bcab55bda935aeb59a5451a23d4158c1d3f02e9eafee01cd4b6c957274c70e2fb1ff00362b5d8d0a9ad1a6d804db8cc1c73d16a5174a197176713de0146468fac7f39bd25927fc082e19d1c67ff94a6187621849f81c574198c5cbd12d76cb0ed5484c6206fec5ed28ebce5f5cdf72a1bcb509e7fe5dd0e7bd357b65a7555a19cc4f29b104e45b344a7d90708bf9ecfa9d893560c709f08f8e150fe459f107623b48a7723407cb9e4e674cb9d16d5ef0fab1959e13e6746d4763959987ec9868429c8aff03f269cfe5c4aa9bb244889b7c8c2a930ba7af4595903b24de2836f1500dca792cb4f9daa4c0e5e51e5a67d587187793beddd6921a0d56f99029614c1ee0a4b2fa495f6e5b3e761fcd6170310455553e4971d5dce271a16c53e2a9fb51b7157224ebcb95bf353cd8ddd6b9c897ceb39d708b37b0c90f7cfc6bf23d62abcab57df7ca0ef29d881f0e757dd5a601ccf9650d2fb6dea49c6293cecf67018254b585f4f06662445ef2a08286692c792861d8a875e6c7cda12c718fff07690ad136e8ffd0d257ff04ee8aa29debf056d10d1efbd62ddce9f8fcc7fbf3a96723561642c863612afcdaaee250aa71e6488755a39fdc897536d77e989a9731db05cee903e8c76744d353c6370c2098d7c6fec91d8c33b8c0b677e85732ecca3146aa9101259878bfbfd5a4a1f0da0e5d9912117ae8bb888ca69204c0378710abf900a1a50119b177af33c40c520ad3377bf04893366edb6c3d4c16f6242b1f2249d4631acb27b6390c32fac9027255120d8c320c916c263efb37a3bf0a4d49a441ea23a9f2f2cd2f8362c9dfd7fd589180fe6f508b4fc186ffb5d361d7e39e0e08274330bcf549a625cb0b9160c8932c9618e39a70653dd46ab24b390be3b0e3872d47d7e24042c29f5ccb95ed4da135a5e3aeb4405577bc489b96fcd9e2776f6fd1d7c1bdcc65fc460e9f936254b2d0b2823948eaec54065b61a6dacc74796ffdd6844b4b66da1f6a59e6c48ffb9c7fce2cece473e8ae6bdfede39555d5581e49ab87e0d2cbc2af54e6e756ebeec431133a97952f23d5f44f80c310b809bbaeaefb76e0b7688ece4ab46e59e97b78fc2c02f9f5f05c22d15bd08c69aca5089639b90af5ce90f577eae045140ff7ac3e8a403e3b97f91c525cf10feee2ce1f95b3199a7ec1a75e7055d4ed7a2458100b6347463585e197a891d05088f6dbb01c2c52d65470c4ed778a18a6dd97c5ed05021f767bf235a6bdf9ac4e74a1e5b2351f19817cc42987241d2057bc66790bc133f6159c075c830fbeb43ee03e231e86837136cecf0140fab54666136814021ae39dfdb6aa2ba0a64f70773f3ba0d2af4af25c84f216392cd0ce962e409c214f350dd15efa040423bb7dca99768dd818a69f487df4f75b872ff2119050ba0483c0e4a9ab97e727e1fb4a989db21d4840cd423406a8bc024a1e8d11e39cf20aea8131b2226ccfb45033e7e0715a8c86f6ab8eac204bfc2b15bcb7c93d0f7a9be3f14e62b83e9e76379d6eb043161aeb7a1445d776d8a469d8881f9d439b239666ba619af91d4bc8e631d79ef1d4bfe535c54d5656cf4acf00d8289e006472317eca84e732ebf1b2850ed7ac44205459de973141274e5fe0f840c615dc068e50202555551c0ed6ce08129f2084989f220e43daf1fa28322bc0f0265cd75012690e40e345f120d1431ff872cac0b624a7e68c863133ca870f1c7e879752d31c99b8bc367e6cb20dc16671e1418569849cf3cead93db72d967de9b8c2d86b4b83dd8708f7b5000ae22a4eb0cf82131eab429d8a7c390226c2d4707b60345a1d4a95d6715496d45a19309f54729ee2a0a4caa2ea888c578e3da5665bc18607434b5f3da66409e505f7163e807bab6b3986d076f90bc554bca9db8a48bf5d7cad201d3005625c0b0a192d48722315b0db408ddebce691fb22c7fa18808abde0f975b418abb5cfead5c38d79bca35064a242f8d9f4d67544fa2a0b85b30ebc6b9b7c28247ee84489075ada07c9681299c1393c55641a9896d303f01ab8172394b85f3a93de416806f1feb9dceb864f6e85f4e187857015e284665aca88c485235531f91089ffd7f0fe071fd96eb24c1693c1ed1bc33a1387fc5f6babf6c97ba2b0f8a5f63e38780cd5a119d91db464d314e9a49a1982af2371d0daf9cbde78f01288a86fbdc5cb1d2a20d9b8457361c93b2cfc9341d3eb282935e039f6869cb1853771449de585058641877bd48f987068bae2a1573e930a562f976e5f3ebeae9b22db41f6af80d4fe6ae900caa37f7f57ee6813a7d6701e966c22b6273359c566f464d2c2a9a4cbe68cac3d4ae804bf59e8717785879f579c00570f1a87ac4cd3baa478da46f6bfe2d4c78618d8aa386121c9c1ad06d44d0790b1e997e5d67bcdeadb4c7d20c18a907989d78dd25d5ccae77e95e7ec1213ab1e414f4af1860a751d45a5dcc7ca73fa0074ccd071bd915d071a8079400b65550e334f62632e64eb9825f8c65559222862adfeb682fccb0c9ed9d506d2033eee300d5f8a6e6cbdd225c97bca790365b02649ef076bde8875dca9fd6192c0db5cd827b76f05f48b3a895097e25787e91efed172074cf45b10349660c1751265dcda03c385f1effde89a0793896a32fc064d46aac87cc3b8cc93d4e50c4496a1711d8183f85c003a8631d94fb697f8dff96d28c59e564450cc055330881819732fbdef678579a72752d06a2c48a88a5bf2f115a8241f511b4812ce220de9c8ec06d772bab8e1eb8f8299163b90fd6d38ea9f3af37b04ce90f2acb3172dbaf9433ba8f6fa3accf271836003b80ebe77b79e6d579193b8337ac8f227f28def92e68c29c78926bf63683ed204b53a7f612ba50959570a945c098560ee3a7312bd48095097afdf591c9aa39e6e8902e85f14428caf45570976b0ba2920725237e9dfe0d89eefaa339ad81d986b635724191166101e75a250b0ddb36c314412de7da5479375901f55cb9dbc2030e8268ffb9b250c2fa9793bdd0a239f309f9e511d8c535ebd7b5ca50a5e8b0a1e3a400c3088fc35c739a9c1183dac8ab2e36057761098badcda9cd930eeef0026e31ba5ee24035b6c45dc769c49b0a9cb9bd51d04fdb37e4b970b14642f46bb722b4052730e7d324dcfa3552913b1b71b494fb2ca078db52c62a49c34393802f9eca918d2c1eca4d39687878b6a19eb84949a3a6ee45721139d1c152f3299a13d29d6f31ba3ba76695b7d38b4ba87f9ebddd83a84f2b5ecf19d25af8350dc1c45666e7390497850906ab1769986e03a2dc11ab1d04731063dc25f0fe428cd2d34ab721fadbb636dd7c00fb42b3e2c5270292c05706d3e4be82f86ca934aaabec7c0e75efae848753f2af6efa9387d955de85537e62fd478286d1eee0bdc7028f361799f5acef5f8185f29a9e587c1b840528936a8faee83df8c91f3e68351fb80b9d11a3798b1d5b49f107e406974919026b16a23a68065369d770bdffbd461d9647dbf08a975c1cbfe993718a23bb45e44a2afb7beef2b194b0b02445034b1d68ea36a28ab62e3cc63e765c0227e5185578dd425e64fd89864c907bf27e49cc5a07533686c879e680badd2592b607894014db067200b55c789fa6201ab5875cf2c087140612921a6c05df027145de14587670ac9bd5add957356b92f49ec8678106f50d5077f78b1be3fac03ec19e8b219866f9cb8b6a2e15f22c321646a3d00b55b76e2119a60eb37a09bd19eb39f7686b024396a92647ff48a957e7836e99d0c330bc9c680822580859864af6c9ba93bdd1502e117a235f8c224381d42ca503ede92dee4b2e482cc390de9c91d64e1c45485927c48e265dc5d15a2d11c1e801ac461c7a6454af0e94ef1a076ac901cd074bb9b6790bf36518e30c241d3508c8815c783e0c1f1c96cdde8a93e4f4128735244f7866fa13cba65790860368a513af49edd773ebf4509a9eb15ec9c91e4df7af5880c88e6513d078c4ccf9291a90964d141e6a14ed0cfe6a7c4c05af9ab0d398a922513abf0857e7815f6ddaffc5d68137185fe9e046e0b4b8f6197687956d4edbaa38f10a35be18a98db9d64e271701ffbb83153b516a3798625e0da7120a8bb8b93f1fa5c5b27db5484639048999a9ff086c0592d971c796a03df9139a7811f56d78788f368bb2730f2b91f65436ae63de0ca65a1b7dd67a4f4f982b46009ae6e4f50b68faba695ce3279bf10cc8090af07a746958234207800bdd6db86b5d9684f04d707f32c9ecc13a80da298afe6a944217c7ccb21d2cf42e82a239730a3286635e4edfb74fde8914000313a7f75f37195bd6d7f02be6e8a6b028d5e5a25660f523df38000369683bfb5e2f1657ce286c07f24788ee16d6bf2860e5259149c3f014b539b01b605627851fe57e2633ed35122530cb61eb8913cbcbe186ca19a0ca40b14d6bb34a31fce7e8cc3dd5a4e38366a85154c0fa8ee3f65a712a0e4b30db1263bd4c7dab55a815e5a22cb28da35059d77dffb222027ee845c3f8a9782845483f9ddf94840bb96e58d200265da8948ed801e666428acef72023dce4b0ec142de26dff17394cb21eae5af3eec6c39e8ba366d3c080dd0d26dace50cf255810f187ace9dd0fcb6cfe4ab8e34de75b0ea2efd9576983e30bf16ecad9f9cb41c10e5ab95ba00f3eba7bd4c2927a6d663a1a41ed96a275933e5c7d526653d3855785eaa6acc9a063c9ce88cdcf5fa921b8e21049808fb955692e0463d7a66c9017bd17688cc309c45365ed93a3bd7f4299cdef52bed010e5378f586a1d677f276d1c64de82e0655447dd62897ba00dcffa9a65e2ebf40e92841832f9c98fae1b5edfc2ef81ad0e405d0ea2da49393f499af42f66119d4075bc17d4f56432e7c2d5978bbce63e9aae3a85c239386a697f8a48f15c24f1009fbfccb11899edfbfdbd15468527b6e0430e2c2f1a3d046a6ba09429d0fe110b83383dc84cd0acb4ff9cf1efbb6c054c3b666214241b27262df45897fae9a25af253ca645aa34269d99afd4b48c9da16533b4ff77b779d7096a5db78ff27b2a1194aa87cf60e5d5b0c767ff53d448581308a80d18daf768591017a2bf4bd07e507cee39f3e9caf478514ce6d374aee22f03cc67768b51e1168966bc9895154ed4f1f684d6e3c723e12fcc5ffa375ede44ddee10d328fdfb60444ba08fd1d656c4fffb94f9c076d56ddd2c14f2b7f83ae8c5008d6670a0a85fd6bb6075148e7abfe6a690d1d80cb53b3616f787c86b124aeb964747ae4d5af918c855dce48b3815f7c814f47f8e3db9c07eda5ad3fb7c1a2474de79ae2cc8306f7e3ea73bbfe1de6d27cf71de36dd31ac5ef5278f01061f27f9c9b70cd8c3e9567a4257065b0297addce10f5d23f65d9f615a40fa4e9fd3770ea80906d337383c456f5d21dfeb7319f1c7fed318ad53fc9419b926b6586476ce8953dcc84a54b0c3a18a0d024e6c91c3d90ddb240eea13371f6dc25351176618abf4a16de42e6f86ad15aa2f3b02d5b8712c2e33ba5e5101cc7a46f1cf1a951528ba4be39fac414f9200e63b6c1d1d42b52c8d3ca4774b2c415d5377c90772a63d97d302e17931dd4b4cd25d5c5f8f87b4c77a6a08021bf531c0fe8385e590d6f79f6f53fc12e4613ea835f58ced39a6a309d586c966ceb1ec0fba8e7d87f7a640360bc90eb9fc36628b541d1bc2d202388ffc55294423cdcb722aa059982019b6d8540efd281ba7e574b3a173e31d20c665e12cd83a83379088ae68533689fc2ea7f888b1d3527f3e3af30e0964a3de134c9e318b4e42d6fb5249eca7bd24c68cfb3dd6ee032cbc8f9b3bd3690d3cae4fbf4ba1bc2fbef637a8237034a378905dfe5be50d81c2a58cfb30d6456d87a78dd1f01fe74f7c4daed46eb94db216425f43b6161e008918c21d77a73c9590bbeddec0d0db769aff7f524c5ec8a66bea8cd0cc2ecb3a9605f58e6316913586d34eb2bf25ca8bc8d13bd3699c81850fb37d42f05e7350549d81a63e4d9ba6be708d2b2e9a5135fa9d404f1cc0ff33376761170d7fbf29b3202099afc49a23ee30c7da5c9cc657b57335a4c23d98da9fec7e7a866e226b49b792173483d55b34d07a401b95420b863a0c931c656d7cce54d023968829ff658392f0ee58adaf12e69025decc44fa48dd11429cdb6adf5443ca7c5df8caa19e1a6069836b81639fb720b8d07e667de0fa5e19dba87f33a2451c77d07582b5309d2c5b7c9e54bcc4d75cf5ce1a145f60d1d99856a98eb60b375a96846efc8a4f46398f853b97846431fe16018fc516c64802e9c35775ab8863777598470a4c1fd4003b0fbea9ae99d2cfcb3e4430d1b6ad18be12118408525b0810bdfbb81cd54d8d65b7a6530fb47a1c08aca49cccaa8e999cc1e434c03dcfbf55822f11aef028da1c6d5ab7e4a27ed8366e23d1f99dbe41089fd4e63fcbfda4366207aaadb2aca85db591c7cf398e3081dbf8fbfa0a5254b7c63751c1f470e97baba659642c4e85118ff22f6182d3f5d7017a6aadf140f5d9555b862b2d17f05ffa50cead3aef56d15a155dc2934ebb5684ccbff18faf578b120336a53376d65b8a7bac0b67befb35c11eaa58969d3d56ff9774263fe34789a6e72ceffe9a0555982cc0db1b8b019711f999f80e285354c31321fee220de3f75c5ee2a4a8254f95e8b176d0e48866a0a8683dbc78317cd0ad13274d5675fe96fc1ca31ea954ffbee9238ddb597fd36c127d48625ccc53612ba77917d5500975c128a968c04feb4a0adee4fedad2191702ebf9ccd645f93902828c7fc152e82e52163ce4be65b8d34411f0b989c6d7f0f7a2f37472dcc9c2607773355cf4ee8254f26bc21204c304d3ec08f8483b51eb38e528f6908036abecc689a67bc10acd8bd1361e8dfc09627bcf81c0d7b0008f2ab19994d456541bdb2e4d679aa1c541cc6e1002d6d193ee272b99b9884748d9ef907025e98c0d964eca811b6f7fdeb55c9e486619488ea11768ac78b3f669270edc826ea68bbb7f0656da1610db99d09f48e6d701963a7c84cef232a578dd839d818b8f35eb4f82e74398e410b3ac8caa9f5d414e0af5a4dc5b90c6d265aaa143b2c611fee00f6caa775a7fc69421ab3c242335611bc151df9fe5bb107f14f7b3ccfc69932c9c12ea1e6dc2138eaae21ae8901788bcc757f9820ea07c68f0a0cb5974ebc8d0b0f93fca4e76a904327af808cbd3b9653d5da7966429d9d68a5e85b81a94df5d2627c42bc147232b25cb826bb8a49fe5a0a9fc3ad73aba1264faca4fae4f7b0b47e7d1fce85c6dc80a19e4d0f0ada1f99bf06deac2a7eab48880db8cda3e78c7c060d4e835e7e32a3055e4b134508088a4e0bae886311c9578a1a7b5c3b20861c556649d7ea3c2ddaecc3d0cb87248d778330d5f091db1eab9ad3a0da7ef84e0b13bc9bfb37e9fb239bd87d3bd77ec798eee51b64d98446e53d8febc586b6fdf1c5672c9bbcd65d5e0e85c6c7e4adcb2c56f64353f88dadf40882a92b4c06b385d5b25bc1dcc6ef49ffe5635c35aa8649e52f0edb3e4adc65bd0b9e55152c45da49e3366fe92911878622007d3c06f434a537ce7988dbbf449cccb4ab6ccce0f98a380649682a74fa1ae93385b80bb91eca86e66b384bf1c095320d0f565f499b49c80cb27d37f2a38f1ec701a4e16d134ed57c04ee7968d322f7a36a8f504a497eed03b3f8b8d165f043601561d2e1cd917670137966ecdc3fc43233e1ea3c973ef07e88d2da69c7cd4be2876437f3cd7b0b6e571899430c9a938bb180cabda1cb9af1a8c3fc580ed4964b74b9eabcd8e2f47f29e6a34aee2bb3d5a1abcbcd573b6bbd011174afdf401ca55d4483848b9a6c6cba92c3bc44452baf7834c93276d2b9a2ed915aaa96ce6a7f3e3147433a68113dbb641c18d590f4a3799403d02c58bee0e789e1de27a4672317119fc91796b1af5b417df7f54e1c79d46ec4a318f3f7cb9e3ac577939f1c07f77fe685fbf4f94bbae1ba8a3740af816c9428897798486f312623527674c19c3f32ff03f42582f23bf583c1a2565566fc8aea5f2b1053aa424084db9c02b5c82c67e8b718c15c640cc1669e2917c67874b3d5e4ba883f14407bfe05e25b99b61b1c284627b1e31fa6495731936789e52e4c609c9e27b8fb1f2febfad7644f804b80c5fcee0f04d6dd3edbdb47c972eef62050459f9003f472630176203a62ebbd05c0523583d0961a6e44c18eae0d70d087ca12515f4d04a67e5da4a9c8281379fcffd8e133b2b1fb8454538cda104dfb6f94a9c9e3d6541874d85c5123649768d82e3537c6f3bdc155ac9d2dc83401d9e6ebce783f755979365cd12914886ddb1f318f21c86607b869405e3641f8d49a53ad5dd08b1d3d31a97611b444e79916f7ab42524ba7a29a2e9f86ca70fddf81f23a0f4b3f94b0728e907cf326b662c34c3449440fedf106f3421afd2b41dc4a789415c9c31b5ca8742828086c3ce8e142002f73ef8d919a4eabe61abc92c82ac2eb7e0c67964b0937fd854f60d5b608c3a040a8e9292626c5ab48381d7161c9430135d69022cdbe48f72323b15490c54a13ff042d80bd328a31365d020e3cffa0f48dfcf4e41de26bdca6f44e0425e10111e7e536540595956cd2b11dfa24ed3bb5e7831a308ed04737d298b3185c71326341d3cd25a7881099d8551a0894028fc09c94029a4107787d629fd4af3a05d7a94c9ec9ea3014efbd21ae1f995094f6a6c3b4be18f9981a961cc7e6d2abeb9d106e732f8dbc49ef72325d725f3d3ad7f638a0778ee5a229ff4f35c2001b797b363aa34020c8cf3ec863488ad9c0b86dfb347c6cb655a28eafcafe09989c0bc16f5499a20330a468bd4b915a01d7045d6d204930fe7d3c664faa7040895d6ea57adf5657a7d90b22f99d6880d822a5ce89c32b7bef011278abf1a29d030abdae0156026be9a566a197d4f48a2978ec7465895a86195f322d796ca2eea92ad6b609fd7826e9ad46e7c0dbd53050ed9e37d915e2b085cc3d542ec8780c6d3559da0922505c6154c9477bc7886e47f4b4c20a1ff499875338821694ace72ab9ef26e3bd8ee7e77b1451ed9c207ccbb5940dc21819087deab684b043161537f0f2cbd97d7b84aa7f410e33bf4e80af9da100cd59dd2a799917df7d0385a4fa44b3b796e3ba0e195adc672b1dd3cff00138bf8894d19abd290d4fdc5d2f6cec3ae2dd72cc984b64f734b147d2f66da998685c2f66d0e3483780bc36afba4fef37b43a9ef365b031f76c38a14fff55d3a2caa6ef905c55ac90b794cf54b51f0e853b58021cebe9002770f67372c3431d8be85f933195f802d8fc8b44e411aea5d28c70b3c41386078a18c855e3cc7f802c7b44709b83bc5b302b81a98d0073b07cda0c6ac679dfe8589916b89f3feaf4296e2202e48e964333311a08ecbad88669b0f6db882d9b239d300c4393413cd8f2f9c496ed7b20f02e62bf5078002389a5b22016d3aa43922a554cf1e265f941f0e4eb8f26b056e04cd83eb70649a8b0d9d2a9eac668f4c8f394cc99e0b00fe37d765809f72919fa18ab253328ee16ff25b09fb92473897bb62376259335d1781eca1ab4219e23caf71245a363fc7a358a000a2a47973c2c7c07e760c52bf238067253ebd3557f8fcff48fe43103b456f76e54dcf8356adf5fa7c825efa977918c657d50c9c0de3f34a1e9a1afc767f13f2fe00122ceb8a64e658f2dcf0f2e90f9f4f58b9f363c260355b5515ddf9b3a596b3839b3d4f1c8cdc86be60fbb4151076f16b19d310210f92ddb9c09eba1582edbea4984bf84dfae18b6490630e2a9bd4308c3afce34b0714d68bb302eb912f2c4319f8b49bcf5394c7d89ea8736452d21bded0a5d5f099f7ca696572ae5ea4898faed6b3a74153811f10b62350cd3593af9cb78dc60eaec422476ab2db77a74ec45c1f1d53163c8c53c66dab958fcb473a02eaec797ec748ef44fd502898e7391d78fd7fd12be01db4acc9232a3c40841e9690a02ef9c16e26278c96be0f85618c9a3c54ff2a7</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
            <tag> 点分治 </tag>
            
            <tag> 启发式合并 </tag>
            
            <tag> 二分图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Manacher</title>
      <link href="/2021/12/05/Manacher/"/>
      <url>/2021/12/05/Manacher/</url>
      
        <content type="html"><![CDATA[<p> 马拉车算法</p><span id="more"></span><h1 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h1><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>Manacher算法是一中可以在  $O(n)$ 时间内求出最长回文子串的算法（以前的 $O(n \log n)$ hash+二分可以退役了）</p><p>在使用马拉车前，由于马拉车只能求<strong>长度为奇数</strong>的回文串，所有我们首先要有一个转换，把长度为偶数的回文串化为长度为奇数，具体方法为：</p><p>在字符串的头部插入开始符（一般为“\$”），在尾部插入结尾符（一般为“^”），然后每两个字符间都插入一个分隔符（一般为“#”），例如，字符串“abbcac”转化后就是“\$#a#b#b#c#a#c#^”，这样，就可以把原串的每一个回文串都化为一个“由#开头和结尾的长度为奇数的回文串”</p><p>然后，考虑如何求最大的长度为奇数的回文串</p><p>类似kmp我们扫描整个串，记 $p[i]$ 表示“以 $i$ 为中点的最长回文串的长度的一半（包括 $i$ ）”，考虑用已有的信息求出现在的 $p[i]$ </p><p><img src="https://s2.loli.net/2021/12/05/kiKbhwgSEDUZ7YJ.png" alt="马拉车"></p><p>如图，假设现在要求 $p[i]$ ，则  $p[1 \sim i - 1]$ 已知，定义一个回文串的位置为 $[l, r]$ ，则已知的最大的 $r$ 记为 $mr(maxright)$ ，其对应的回文串中点为 $mid$ ，则分类讨论：</p><ul><li><p> $i &gt; mr$ ，此时先令 $p[i] = 1$</p></li><li><p>$i \le mr$ 此时必有 $j = mid * 2 - i$ 与 $i$ 对应，再次分类：</p><ol><li> $p[j] \le mr - i + 1$ ，此时 $j$ 所在的最大回文串全部能和 $i$ 对应（图中蓝色部分），让 $p[i] = p[j]$</li><li> $p[j] &gt; mr - i + 1$ ，此时由于 $mr$ 右边的情况未知，故只能先让 $p[i] = mr - i + 1$ </li></ol></li></ul><p>由上，我们通过已有的信息计算出了“<strong>保证合法但不保证最大</strong>的情况下 $p[i]$ 的值”，其中没有保证最大的原因是 $mr$ 右边的情况不知道，若 $i$ 所在的最大回文串的右边界大于 $mr$ ，就无法统计，解决办法是——暴力！对于分类讨论得到的 $p[i]$ ，我们暴力尝试让它加1，直到不行为止</p><p>最后统计答案时，由于 $p[i]$ 只是长度的一半应该要乘二，但由于我们把原串扩充了一倍，所以实际答案就是 $\max_{i = 1}^{n}(p[i] - 1)$ </p><p>需要注意的是，在具体的代码实现中，常常让 $mr = mr + 1$ ，换句话说，以 $mid$ 为中心的最大回文串不是 $[l, r]$ ，而是 $[l, r)$ ，上面讲成闭区间只是为了方便理解</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P3805">【模板】manacher 算法</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> a[N], b[N &lt;&lt; <span class="number">1</span>];  <span class="comment">//二倍</span></span><br><span class="line"><span class="keyword">int</span> p[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">b[++k] = <span class="string">&#x27;$&#x27;</span>, b[++k] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">b[++k] = a[i], b[++k] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">b[++k] = <span class="string">&#x27;^&#x27;</span>;</span><br><span class="line">n = k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mr = <span class="number">0</span>, mid;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i &lt; mr)</span><br><span class="line">p[i] = <span class="built_in">min</span>(p[mid * <span class="number">2</span> - i], mr - i);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">p[i] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (b[i - p[i]] == b[i + p[i]])</span><br><span class="line">++p[i];</span><br><span class="line"><span class="keyword">if</span> (i + p[i] &gt; mr)</span><br><span class="line">mr = i + p[i], mid = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">n = <span class="built_in">strlen</span>(a + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">init</span>();</span><br><span class="line"><span class="built_in">manacher</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">ans = <span class="built_in">max</span>(ans, p[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><p>和kmp一样，马拉车的两个循环也是“假的”，简证：</p><p>首先，如果 $i$ 所在的最大回文串 $[l, r]$ 的右断点 $r \le mr$ ，while只会执行一次，因为如果此时 $p[i]$ 一定是与 $p[j]$ 对于的，若还可以加1，这与 $p[j]$ 的“最大”矛盾</p><p>其次，若 $r &gt; mr$ ，则一定会跟新 $mr$ ，而 $mr$ 明显是不下降的，当 $mr = n$ 时，就不可能再有 $r &gt; mr$ 了，换句话说， $mr$ 最多遍历一次 $n$ ，之后就不会再跟新 $mr$ 也就不会再有 $r &gt; mr$ 了</p><p>综上，马拉车的时间复杂度为 $O(n)$ </p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 回文串 </tag>
            
            <tag> Manacher </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>启发式合并</title>
      <link href="/2021/12/05/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
      <url>/2021/12/05/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/</url>
      
        <content type="html"><![CDATA[<p> 聪明的合并</p><span id="more"></span><h1 id="启发式合并"><a href="#启发式合并" class="headerlink" title="启发式合并"></a>启发式合并</h1><p>其实我们很早就接触过启发式合并了，比如并查集的<strong>按秩合并</strong>就是一种启发式合并（<del>虽然基本没用过</del>），但还是单独提一提</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>在解决问题时，我们常常要用到“合并”操作，而该操作是<strong>可以</strong>满足<strong>交换律</strong>的（即可以把 $a$ 合并到 $b$ 里面，也可以把 $b$ 合并到 $a$ 里面），这个时候我们可以通过一些额外的信息（如安秩合并中的秩）来决定合并的顺序，从而降低时间复杂度</p><h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><p><a href="https://www.luogu.com.cn/problem/P3201">[HNOI2009] 梦幻布丁</a></p><p>对于每种颜色，用一个集合维护其下标，每次操作就是<strong>合并两个集合</strong>，合并完后颜色的段数是<strong>不会增加</strong>的，考虑如何维护段数，设合并颜色 $a$ 和颜色 $b$ ，枚举颜色 $a$ 的所有下标，若它左右的颜色中有  $x(0 \le x \le 2)$ 个颜色是 $b$ ，就让段数减 $x$ </p><p>不难发现暴力合并时间复杂度为 $O(mn)$ ，无法接受，考虑启发式合并，每次让小的集合合并到大的集合中</p><p>要用启发式合并，我们首先要解决一个问题：合并操作是满足交换律的吗？当然没有那么简单，由于操作是“把颜色 $a$ 变成颜色 $b$ ”，交换就成了“把颜色 $b$ 变成颜色 $a$ ”，当然不行</p><p>但是可以通过转化让其满足交换律吗？考虑用链表存储集合，那么只需要将表头映射一下，交换一下颜色即可，总的时间复杂度期望为 $O(n \log n)$ （<del>然而可以被hack，但可以过题</del>）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, A = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> h[A], idx;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> c[N], si[A], p[A];</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == y)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (si[x] &gt; si[y])</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], z; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">z = e[i].ver;</span><br><span class="line">ans -= (c[z + <span class="number">1</span>] == y) + (c[z - <span class="number">1</span>] == y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], z; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">c[e[i].ver] = y;</span><br><span class="line"><span class="keyword">if</span> (e[i].ne == <span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line">e[i].ne = h[y], h[y] = h[x];</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">si[y] += si[x];</span><br><span class="line">h[x] = <span class="number">-1</span>, si[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>, p[i] = i;</span><br><span class="line">idx = ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</span><br><span class="line"><span class="keyword">if</span> (c[i] != c[i - <span class="number">1</span>])</span><br><span class="line">++ans;</span><br><span class="line"><span class="built_in">add</span>(c[i], i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> op, x, y;</span><br><span class="line"><span class="keyword">while</span> (m--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line"><span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line"><span class="built_in">merge</span>(p[x], p[y]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h2><p><a href="https://www.luogu.com.cn/problem/CF600E">Lomsat gelral</a></p><p>其实是一道树上并查集，类似树链剖分找出重儿子，暴力计算每一棵子树，但最后再计算重儿子，这样可以把重儿子的信息保留下来，下一次用的时候就不必再算</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> c[N], cnt[N], mx;</span><br><span class="line">LL ans[N], sum;</span><br><span class="line"><span class="keyword">int</span> si[N], h_son[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">si[x] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(y, x);</span><br><span class="line">si[x] += si[y];</span><br><span class="line"><span class="keyword">if</span> (si[y] &gt; si[h_son[x]])</span><br><span class="line">h_son[x] = y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dt, <span class="keyword">int</span> pass)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> _c = c[x];</span><br><span class="line">cnt[_c] += dt;</span><br><span class="line"><span class="keyword">if</span> (cnt[_c] &gt; mx)</span><br><span class="line">mx = cnt[_c], sum = _c;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (cnt[_c] == mx)</span><br><span class="line">sum += _c;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa || y == pass)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">update</span>(y, x, dt, pass);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa || y == h_son[x])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (h_son[x])</span><br><span class="line"><span class="built_in">dfs</span>(h_son[x], x, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">update</span>(x, fa, <span class="number">1</span>, h_son[x]);</span><br><span class="line">ans[x] = sum;</span><br><span class="line"><span class="keyword">if</span> (!op)</span><br><span class="line"><span class="built_in">update</span>(x, fa, <span class="number">-1</span>, <span class="number">0</span>), mx = sum = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line"><span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 并查集 </tag>
            
            <tag> 启发式合并 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>点分治</title>
      <link href="/2021/12/05/%E7%82%B9%E5%88%86%E6%B2%BB/"/>
      <url>/2021/12/05/%E7%82%B9%E5%88%86%E6%B2%BB/</url>
      
        <content type="html"><![CDATA[<p> 连分治也变得难了起来……</p><span id="more"></span><h1 id="点分治"><a href="#点分治" class="headerlink" title="点分治"></a>点分治</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>点分治是<strong>树上分治</strong>的种常用方法，主要思想是每次在树上选一个点，将整棵树的问题划分为两类（如图）：三角形的子树内问题和过了点跨子树的问题</p><p><img src="https://s2.loli.net/2021/12/05/mJCZwSPnvaE3W4K.png" alt="点和子树"></p><p>然后每个子树也这样划分，这个点每次取<strong>重心</strong>，可以保证最多划分 $\log n$ 层</p><h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p><a href="https://www.acwing.com/problem/content/254/">树</a></p><p>题意非常简单：求树上距离不超过 $k$ 的点对数量，点分治的思路也非常简单，每次选重心（记选的节点为 $c$ ），分三类：</p><ol><li>对于两个点都在同一子树内部的情况，递归处理</li><li>对于有一个点恰好是 $c$ 的情况，直接dfs求</li><li>对于跨子树的情况，可以先求出每棵子树内每个点到 $c$ 的距离，然后对于所有距离，记录任选两个距离和小于等于 $k$ 的情况，再删掉同一棵子树内两个点距离和小于等于 $k$ 的情况即可，而求解“一个集合内任取两个数和小于等于 $k$ 的方案数”可以用排序后双指针来解决（也可以排序后二分，麻烦点）</li></ol><p>考虑时间复杂度，最多有 $\log n$ 层，每层 $n$ 个点都要排序，一共是 $O(n \log^2 n)$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="keyword">bool</span> del[N];</span><br><span class="line"><span class="keyword">int</span> p[N], q[N], cp, cq;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_si</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line">res += <span class="built_in">get_si</span>(e[i].ver, x);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_wc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> si, <span class="keyword">int</span> &amp;wc)</span> <span class="comment">// 求重心(其实是一个保证删去后子树大小小于n/2的点,不一定是重心)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">1</span>, mx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, t; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">t = <span class="built_in">get_wc</span>(y, x, si, wc);</span><br><span class="line">mx = <span class="built_in">max</span>(mx, t);</span><br><span class="line">sum += t;</span><br><span class="line">&#125;</span><br><span class="line">mx = <span class="built_in">max</span>(mx, si - sum);</span><br><span class="line"><span class="keyword">if</span> (mx &lt;= si / <span class="number">2</span>)</span><br><span class="line">wc = x;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_dis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dis)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">q[++cq] = dis;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line"><span class="built_in">get_dis</span>(e[i].ver, x, dis + e[i].w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> c)</span> <span class="comment">//计算集合a中有多少对相加不大于k</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + c);</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = c, j = <span class="number">0</span>; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (j + <span class="number">1</span> &lt; i &amp;&amp; a[j + <span class="number">1</span>] + a[i] &lt;= k)</span><br><span class="line">++j;</span><br><span class="line">j = <span class="built_in">min</span>(j, i - <span class="number">1</span>);</span><br><span class="line">res += j + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_wc</span>(x, <span class="number">-1</span>, <span class="built_in">get_si</span>(x, <span class="number">-1</span>), x);</span><br><span class="line">del[x] = <span class="literal">true</span>;</span><br><span class="line">cp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line">cq = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_dis</span>(y, <span class="number">-1</span>, e[i].w);</span><br><span class="line">res -= <span class="built_in">work</span>(q, cq);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cq; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (q[j] &lt;= k)</span><br><span class="line">++res;</span><br><span class="line">p[++cp] = q[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">res += <span class="built_in">work</span>(p, cp);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">res += <span class="built_in">calc</span>(e[i].ver);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k), n || k)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>, del[i] = <span class="literal">false</span>;;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(u + <span class="number">1</span>, v + <span class="number">1</span>, w), <span class="built_in">add</span>(v + <span class="number">1</span>, u + <span class="number">1</span>, w); <span class="comment">//输入的下标是从0开始的</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">calc</span>(<span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.acwing.com/problem/content/266/">权值</a></p><p>类似于模板，看注释吧，时间复杂度 $O(n \log n)$ ：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, S = <span class="number">1e6</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, ans = INF;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> dis, num;</span><br><span class="line">&#125; p[N], q[N];</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="keyword">bool</span> del[N];</span><br><span class="line"><span class="keyword">int</span> cp, cq;</span><br><span class="line"><span class="keyword">int</span> b[S]; <span class="comment">//开一个桶记录到重心距离为i的点的最小边数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_si</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line">res += <span class="built_in">get_si</span>(e[i].ver, x);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_wc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> si, <span class="keyword">int</span> &amp;wc)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">1</span>, mx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, t; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">t = <span class="built_in">get_wc</span>(y, x, si, wc);</span><br><span class="line">mx = <span class="built_in">max</span>(mx, t);</span><br><span class="line">sum += t;</span><br><span class="line">&#125;</span><br><span class="line">mx = <span class="built_in">max</span>(mx, si - sum);</span><br><span class="line"><span class="keyword">if</span> (mx &lt;= si / <span class="number">2</span>)</span><br><span class="line">wc = x;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_dis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dis, <span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x] || dis &gt; k)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">q[++cq] = (Node)&#123;dis, num&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line"><span class="built_in">get_dis</span>(e[i].ver, x, dis + e[i].w, num + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="built_in">get_wc</span>(x, <span class="number">-1</span>, <span class="built_in">get_si</span>(x, <span class="number">-1</span>), x);</span><br><span class="line">del[x] = <span class="literal">true</span>;</span><br><span class="line">cp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line">cq = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_dis</span>(y, x, e[i].w, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cq; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (q[j].dis == k)</span><br><span class="line">ans = <span class="built_in">min</span>(ans, q[j].num);</span><br><span class="line">ans = <span class="built_in">min</span>(ans, b[k - q[j].dis] + q[j].num);</span><br><span class="line">p[++cp] = q[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cq; ++j)</span><br><span class="line">b[q[j].dis] = <span class="built_in">min</span>(b[q[j].dis], q[j].num);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cp; ++j) <span class="comment">//将桶清空</span></span><br><span class="line">b[p[j].dis] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="built_in">calc</span>(e[i].ver);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">    b[i] = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(u + <span class="number">1</span>, v + <span class="number">1</span>, w), <span class="built_in">add</span>(v + <span class="number">1</span>, u + <span class="number">1</span>, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">calc</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (ans == INF)</span><br><span class="line">ans = <span class="number">-1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.luogu.com.cn/problem/P3806">【模板】点分治1</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, K = <span class="number">1e7</span> + <span class="number">5</span>, M = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="keyword">bool</span> del[N];</span><br><span class="line"><span class="keyword">int</span> p[N], q[N], o[N], cp, cq, co;</span><br><span class="line">list&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line"><span class="keyword">int</span> _Q[M];</span><br><span class="line"><span class="keyword">bool</span> b[K], ans[K];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_si</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line">res += <span class="built_in">get_si</span>(e[i].ver, x);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_wc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> si, <span class="keyword">int</span> &amp;wc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">1</span>, mx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, t; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == fa)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">t = <span class="built_in">get_wc</span>(y, x, si, wc);</span><br><span class="line">mx = <span class="built_in">max</span>(mx, t);</span><br><span class="line">sum += t;</span><br><span class="line">&#125;</span><br><span class="line">mx = <span class="built_in">max</span>(mx, si - sum);</span><br><span class="line"><span class="keyword">if</span> (mx &lt;= si / <span class="number">2</span>)</span><br><span class="line">wc = x;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_dis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> dis)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x] || dis &gt; K)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">q[++cq] = dis;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line"><span class="built_in">get_dis</span>(e[i].ver, x, dis + e[i].w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">get_wc</span>(x, <span class="number">-1</span>, <span class="built_in">get_si</span>(x, <span class="number">-1</span>), x);</span><br><span class="line">del[x] = <span class="literal">true</span>;</span><br><span class="line">cp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line">cq = co = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_dis</span>(y, <span class="number">-1</span>, e[i].w);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cq; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> r : Q)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (q[j] == r)</span><br><span class="line">ans[r] = <span class="literal">true</span>, o[++co] = r;</span><br><span class="line"><span class="keyword">if</span> (r &gt;= q[j] &amp;&amp; b[r - q[j]])</span><br><span class="line">ans[r] = <span class="literal">true</span>, o[++co] = r;</span><br><span class="line">&#125;</span><br><span class="line">p[++cp] = q[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cq; ++j)</span><br><span class="line">b[q[j]] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= co; ++j)</span><br><span class="line">Q.<span class="built_in">remove</span>(o[j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cp; ++j)</span><br><span class="line">b[p[j]] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="built_in">calc</span>(e[i].ver);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(u, v, w), <span class="built_in">add</span>(v, u, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_Q[i]);</span><br><span class="line">Q.<span class="built_in">push_back</span>(_Q[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">calc</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line"><span class="keyword">if</span> (ans[_Q[i]])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;AYE\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;NAY\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="动态点分治（点分树）"><a href="#动态点分治（点分树）" class="headerlink" title="动态点分治（点分树）"></a>动态点分治（点分树）</h2><p>还是先看模板题<a href="https://www.luogu.com.cn/problem/P3241">[HNOI2015]开店</a></p><p>既然叫点分树了，当然是要建一棵树，而这棵树要保证<strong>每一棵子树的根节点就是该子树的重心</strong></p><p>建好树后，考虑如何解决询问，不难发现，一个节点 $u$ 最多属于 $\log n$ 棵子树，不妨设当前子树根节点为 $r$ ：</p><ol><li>若  $r \ne u$ ，考虑形如 $u \rightarrow r \rightarrow v$  的路径有多少个，计入答案，然后进入  $u$ 所在子树递归</li><li>若 $u = r$ ，遍历当前子树所有点，计入答案，然后停止递归</li></ol><p>由于每个点的度不大于3，直接在每个重心上开三个vector，记录每个子树的所有年龄和它到重心的距离，排好序后前缀和+二分即可，总的空间复杂度为 $O(n \log n)$ 时间复杂度为 $O(m \log^2 n)$ ， $m$ 是询问的数量</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> VS vector<span class="meta-string">&lt;Son&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, A;</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Father</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> x, id;</span><br><span class="line">LL dis;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Son</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line">LL dis;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Son &amp;t) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> age &lt; t.age;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;Father&gt; f[N];</span><br><span class="line">VS s[N][<span class="number">3</span>];</span><br><span class="line"><span class="keyword">bool</span> del[N];</span><br><span class="line"><span class="keyword">int</span> age[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_si</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line">res += <span class="built_in">get_si</span>(e[i].ver, x);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_wc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> si, <span class="keyword">int</span> &amp;wc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">1</span>, mx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], t; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (e[i].ver == fa)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">t = <span class="built_in">get_wc</span>(e[i].ver, x, si, wc);</span><br><span class="line">mx = <span class="built_in">max</span>(mx, t);</span><br><span class="line">sum += t;</span><br><span class="line">&#125;</span><br><span class="line">mx = <span class="built_in">max</span>(mx, si - sum);</span><br><span class="line"><span class="keyword">if</span> (mx &lt;= si / <span class="number">2</span>)</span><br><span class="line">wc = x;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_dis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, LL dis, <span class="keyword">int</span> wc, <span class="keyword">int</span> k, VS &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">f[x].<span class="built_in">push_back</span>((Father)&#123;wc, k, dis&#125;);</span><br><span class="line">p.<span class="built_in">push_back</span>((Son)&#123;age[x], dis&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], t; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="keyword">if</span> (e[i].ver != fa)</span><br><span class="line"><span class="built_in">get_dis</span>(e[i].ver, x, dis + e[i].w, wc, k, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (del[x])</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">get_wc</span>(x, <span class="number">-1</span>, <span class="built_in">get_si</span>(x, <span class="number">-1</span>), x);</span><br><span class="line">del[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, k = <span class="number">0</span>; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (del[y])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">VS &amp;p = s[x][k];</span><br><span class="line">p.<span class="built_in">push_back</span>((Son)&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;), p.<span class="built_in">push_back</span>((Son)&#123;A + <span class="number">1</span>, <span class="number">0</span>&#125;); <span class="comment">//哨兵</span></span><br><span class="line"><span class="built_in">get_dis</span>(y, <span class="number">-1</span>, e[i].w, x, k, p);</span><br><span class="line"><span class="built_in">sort</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>());</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; p.<span class="built_in">size</span>(); ++i)</span><br><span class="line">p[i].dis += p[i - <span class="number">1</span>].dis;</span><br><span class="line">++k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line"><span class="built_in">calc</span>(e[i].ver);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (Father &amp;i : f[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> g = age[i.x];</span><br><span class="line"><span class="keyword">if</span> (g &gt;= l &amp;&amp; g &lt;= r)</span><br><span class="line">res += i.dis;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (j == i.id)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">VS &amp;p = s[i.x][j];</span><br><span class="line"><span class="keyword">if</span> (p.<span class="built_in">empty</span>())</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> a = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), (Son)&#123;l, <span class="number">-1</span>&#125;) - p.<span class="built_in">begin</span>();</span><br><span class="line"><span class="keyword">int</span> b = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), (Son)&#123;r + <span class="number">1</span>, <span class="number">-1</span>&#125;) - p.<span class="built_in">begin</span>();</span><br><span class="line">res += i.dis * (b - a) + p[b - <span class="number">1</span>].dis - p[a - <span class="number">1</span>].dis;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">VS &amp;p = s[x][i];</span><br><span class="line"><span class="keyword">if</span> (p.<span class="built_in">empty</span>())</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">int</span> a = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), (Son)&#123;l, <span class="number">-1</span>&#125;) - p.<span class="built_in">begin</span>();</span><br><span class="line"><span class="keyword">int</span> b = <span class="built_in">lower_bound</span>(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), (Son)&#123;r + <span class="number">1</span>, <span class="number">-1</span>&#125;) - p.<span class="built_in">begin</span>();</span><br><span class="line">res += p[b - <span class="number">1</span>].dis - p[a - <span class="number">1</span>].dis;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;A);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;age[i]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(u, v, w), <span class="built_in">add</span>(v, u, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">calc</span>(<span class="number">1</span>);</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u, a, b, l, r;</span><br><span class="line"><span class="keyword">while</span> (m--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;a, &amp;b);</span><br><span class="line">l = (a + ans) % A, r = (b + ans) % A;</span><br><span class="line"><span class="keyword">if</span> (l &gt; r)</span><br><span class="line"><span class="built_in">swap</span>(l, r);</span><br><span class="line">ans = <span class="built_in">ask</span>(u, l, r);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分治 </tag>
            
            <tag> 树 </tag>
            
            <tag> dfs </tag>
            
            <tag> 点分治 </tag>
            
            <tag> 点分树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kmp和hash（讲）</title>
      <link href="/2021/12/03/kmp%E5%92%8Chash%EF%BC%88%E8%AE%B2%EF%BC%89/"/>
      <url>/2021/12/03/kmp%E5%92%8Chash%EF%BC%88%E8%AE%B2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>​    water</p><span id="more"></span><p>临时准备一下，有点水，就只是当一个提纲用，主要听我讲吧</p><h2 id="前置芝士"><a href="#前置芝士" class="headerlink" title="前置芝士"></a>前置芝士</h2><ul><li><p><a href="https://baike.baidu.com/item/Hash/390310">hash的定义</a>（只要定义即可）</p></li><li><p>char数组存储并使用字符串，尽可能不要使用string，<del>但如果实在没办法就用吧</del></p><p>原因：string的值是不可变的，这就导致每次对string的操作都会生成新的string对象，不仅效率低下，而且大量浪费有限的内存空间，如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string a = <span class="string">&quot;1&quot;</span>;  <span class="comment">//假设a指向地址0x0001</span></span><br><span class="line">a = <span class="string">&quot;2&quot;</span>; <span class="comment">//重新赋值后a指向地址0x0002,0x0001地址中保存的&quot;1&quot;依旧存在,但已经不再是a所指向的,a已经指向了其它地址</span></span><br></pre></td></tr></table></figure><p>重新赋值并没有改变地址中保存的”1”，而是直接再申请空间，因此string的操作都是改变赋值地址而不是改变值操作，类似的还有string在函数传参时浪费的空间，并且，时间上讲，string比vector和char都慢</p></li><li><p>一定的抽象思维（我会尽力讲的形象一定）</p></li></ul><p>不管如何，看下去吧</p><h2 id="字符串hash"><a href="#字符串hash" class="headerlink" title="字符串hash"></a>字符串hash</h2><ul><li><p>为何使用</p></li><li><p>正确性如何保证</p></li><li><p>具体如何实现（<a href="https://www.luogu.com.cn/problem/P3370">【模板】字符串哈希</a>）</p></li><li><p> $O(n\log n)$ 最长回文串（没有模板题，看代码吧，重点理解p数组的含义）</p></li></ul>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.1e7</span> + <span class="number">5</span>, H = <span class="number">131</span>;</span><br><span class="line">ULL ha[N], ah[N], p[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="function">IL ULL <span class="title">get_ha</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> ha[r] - ha[l - <span class="number">1</span>] * p[r - l + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL ULL <span class="title">get_ah</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> ah[l] - ah[r + <span class="number">1</span>] * p[r - l + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="built_in">min</span>(x - <span class="number">1</span>, n - x), mid, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line">mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">get_ha</span>(x, x + mid) == <span class="built_in">get_ah</span>(x - mid, x))</span><br><span class="line">&#123;</span><br><span class="line">res = mid;</span><br><span class="line">l = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">r = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="built_in">min</span>(x - <span class="number">1</span>, n - y), mid, res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line">mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">get_ha</span>(y, y + mid) == <span class="built_in">get_ah</span>(x - mid, x))</span><br><span class="line">&#123;</span><br><span class="line">res = mid;</span><br><span class="line">l = mid + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">r = mid - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">ha[i] = ha[i - <span class="number">1</span>] * H + s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">p[i] = p[i - <span class="number">1</span>] * H;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">ah[i] = ah[i + <span class="number">1</span>] * H + s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">ans = <span class="built_in">max</span>(ans, <span class="built_in">find</span>(i) * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (s[i] == s[i + <span class="number">1</span>])</span><br><span class="line">ans = <span class="built_in">max</span>(ans, <span class="built_in">find</span>(i, i + <span class="number">1</span>) * <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>其它应用</li></ul><h2 id="kmp"><a href="#kmp" class="headerlink" title="kmp"></a>kmp</h2><ul><li><p>思想：利用已有信息减少枚举</p></li><li><p>实现：ne数组（别取next），重点理解其图形意义和其抽象定义的关系</p><p>对图理解：<img src="https://i.loli.net/2021/12/03/t2A3eYZLdJCqsu6.png" alt="kmp"></p></li><li><p>代码：<a href="https://www.luogu.com.cn/problem/P3375">【模板】KMP字符串匹配</a></p></li><li><p>应用：字符串问题、辅助dp（有点难，不要去掌握）</p></li></ul><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><p>AC自动机（有blog）、Z函数</p>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> hash </tag>
            
            <tag> kmp </tag>
            
            <tag> 备讲 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4558 [JSOI2018]机器人</title>
      <link href="/2021/12/02/luoguP4558-JSOI2018-%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2021/12/02/luoguP4558-JSOI2018-%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p> 我以为很好打……</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4558">机器人</a></p><p>一道很难的题，但可以骗点分</p><p>首先第一眼看过去就是dp， $n, m \le 50$ 说明dp并不简单，但看数据范围，反正我是想打分段骗分</p><h2 id="数据1"><a href="#数据1" class="headerlink" title="数据1"></a>数据1</h2><p> $n, m \le 4$ 直接dfs，注意题目求的是<strong>扫地机器人在撞上障碍之前，经过了多少个格子</strong>，换句话说，没撞上障碍，贡献是0</p><p>20分到手</p><h2 id="数据2"><a href="#数据2" class="headerlink" title="数据2"></a>数据2</h2><h3 id="打表"><a href="#打表" class="headerlink" title="打表"></a>打表</h3><p>除了起点外所有格子都是障碍，明显答案就是所有的方案都输入到了扫地机器人里，但 $n, m \le 50$ ，暴力求所有的方案数时间复杂度和数据1是一样的，但是，通过上面的暴力程序打个小表（把dfs能跑出来的全打了）来<strong>找规律</strong>，发现对于 $n, m$ （不妨设 $n \le m$ ），若 $n \mid m$ ，有如下表：</p><table><thead><tr><th align="center">n</th><th align="center">m</th><th align="center">Ans</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">1</td><td align="center">1</td></tr><tr><td align="center">1</td><td align="center">2</td><td align="center">1</td></tr><tr><td align="center">1</td><td align="center">3</td><td align="center">1</td></tr><tr><td align="center">2</td><td align="center">2</td><td align="center">2</td></tr><tr><td align="center">2</td><td align="center">4</td><td align="center">2</td></tr><tr><td align="center">2</td><td align="center">6</td><td align="center">2</td></tr><tr><td align="center">3</td><td align="center">3</td><td align="center">6</td></tr><tr><td align="center">3</td><td align="center">6</td><td align="center">3</td></tr><tr><td align="center">3</td><td align="center">9</td><td align="center">6</td></tr><tr><td align="center">3</td><td align="center">12</td><td align="center">3</td></tr><tr><td align="center">4</td><td align="center">4</td><td align="center">8</td></tr><tr><td align="center">4</td><td align="center">8</td><td align="center">8</td></tr><tr><td align="center">4</td><td align="center">12</td><td align="center">4</td></tr></tbody></table><p>而若 $n \not\mid m$ ，答案为0，找一手规律，信心满满交上去，WA了</p><p> 好吧，看来没有想象的简单，我们发现我们枚举的数都太小了，它们的<strong>合数</strong>只有4，而且4还没枚举完，但这已经提示我们<strong>和gcd或者互质</strong>有关系</p><h3 id="性质1"><a href="#性质1" class="headerlink" title="性质1"></a>性质1</h3><p>再认真看看打出来的表，以及对应的合法方案数</p><p>发现一个性质：对于一个点 $(x, y)$ ，若它走向 $(x + 1, y)$ ，则 $(x, y + 1)$ ，一定是由 $(x - 1, y + 1)$ 走来；同样的，若它走向 $(x, y + 1)$ ，则 $(x + 1, y)$ ，一定是由 $(x + 1, y - 1)$ 走来，正确性显然</p><p>参考下图：</p><p><img src="https://i.loli.net/2021/12/02/ka14GUhuOMKz9Jf.png" alt="对角线"></p><p>若红点向下，则黄点一定是由紫色向下走到（因为红点已经不可能再向右了），绿、蓝、粉点同理，换句话说，红、紫（绿、粉）点的方向一定相同</p><p>再参考样例：</p><p><img src="https://i.loli.net/2021/12/02/oI9YTryJAwOt1G2.png" alt="样例"></p><p>推广到整个图：<strong>一个矩形内任意一条从右上到左下的对角线方向相同</strong>，其中“一条从右上到左下的对角线”是包含了循环的，如图，颜色相同的是“一条对角线”</p><p><img src="https://i.loli.net/2021/12/02/fBTEp2Oxqkjl5uo.png" alt="对角线2"></p><p>这也和我们上面打的表相符合</p><h3 id="性质2"><a href="#性质2" class="headerlink" title="性质2"></a>性质2</h3><p>由于一个点左下和右下的元素属于同一对角线，所以我们下一步无论怎么走都会走到同一个对角线上，则下一步的方向已经确定，推广一下：<strong>机器人的动作自然就是循环的</strong></p><p>循环节很好求，就是看走多少部可以回到原对角线，手玩一下发现是 $gcd(n, m)$ ，这也和打表的猜测相符合</p><p>证明的话（<del>听大佬说是</del>）把这个矩阵复制几份拼在一起，如果循环节不是 $gcd(n, m)$ 那么在两个矩形的交界出会出现副对角线颜色不同的情况，而循环节是 $gcd(n, m)$ 的时候相当于一堆正方形拼在一起自然不会出现问题</p><h3 id="性质3"><a href="#性质3" class="headerlink" title="性质3"></a>性质3</h3><p>设循环节长度为 $d$ ，且其中有 $a$ 步向右， $d - a$ 步向下，则有 $a \perp d$ 且 $a \perp n, (d - a) \perp m$ </p><p>证明：</p><p>若可到节点 $(x, y)$，则有 $1 + ka \equiv x \pmod n$ ，而 $x$ 取遍 $1 \sim n$ ，由裴蜀定理，若 $gcd(a, n) \ne 1$ ，则必有 $x$ 取不到，故 $a \perp n$ </p><p>同理有 $gcd(d - a, m) = 1$ ，又因为 $d = gcd(n, m)$ ，故 $a \perp d$ </p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>有了以上性质，方案数变得可求，考虑枚举 $a$ 即可<br>$$<br>Ans = \sum_{a = 0} ^ {d} [a \perp d] * [a \perp n] * [(d - a) \perp m] * \binom{d}{a}<br>$$<br>期望得分50</p><h2 id="数据3"><a href="#数据3" class="headerlink" title="数据3"></a>数据3</h2><p>现在考虑撞上障碍，明显应该dp，由于 $n, m$ 很小，dp状态几乎可以随便设，反正维数管够，设 $f[i][j][k]$ 表示在 $(i, j)$ 上撞上障碍的路程的最小值为k的方案数</p><p>同数据2，可以枚举 $a$ ，易得，若该次循环从 $(x, y)$ 出发，必然走到 $(x + a, y + b)$ ，所以只要在 $(1, 1)$ 到 $(1 + a, 1 + b)$ 间dp即可</p><p>设格子 $(x, y), (1 \le x \le 1 + a, 1 \le y \le 1 + b)$ 的权值 $w_{x, y}$ 为走到有障碍格子 $(x + ka, y + kb), (k \in \mathbb{N})$ 的最小步数，则方程为<br>$$<br>\begin{align}<br>f[i][j][k] \rightarrow f[i + 1][j][\min (k, w_{i + 1, j})]\\<br>f[i][j][k] \rightarrow f[i][j + 1][\min (k, w_{i, j + 1})]<br>\end{align}<br>$$<br>考虑时间复杂度，求 $w[i][j]$ 需要枚举 $a, i, j, k$ ，$a, i, j \le d$ ，而 $k \le \frac{nm}{d}$ ，总的时间复杂度为 $O(d^2nm) &lt; O(n^4)$ ，而转移 $f$ 时要枚举 $i, j, k$ ，其中 $i \le n, j \le m, k \le nm$ 故为 $O(n^4)$ ，总的时间复杂度为 $O(Tn^4)$ ，大概 $6 \times 10^8$ 的样子，由于有很多条件特判（如 $a$ 的互质），跑不满（实测跑的飞快），加上时限是5s，可以过</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, d;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="keyword">int</span> f[N][N][N * N], w[N][N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> y == <span class="number">0</span> ? x : <span class="built_in">gcd</span>(y, x % y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (((a == <span class="number">0</span>) &amp;&amp; (n == <span class="number">1</span>)) || ((b == <span class="number">0</span>) &amp;&amp; (m == <span class="number">1</span>)) || ((<span class="built_in">gcd</span>(a, d) == <span class="number">1</span>) &amp;&amp; (<span class="built_in">gcd</span>(b, d) == <span class="number">1</span>) &amp;&amp; (<span class="built_in">gcd</span>(a, n) == <span class="number">1</span>) &amp;&amp; (<span class="built_in">gcd</span>(b, m) == <span class="number">1</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// freopen(&quot;t.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line"><span class="comment">// freopen(&quot;t.out&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line"><span class="keyword">while</span> (T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">d = <span class="built_in">gcd</span>(n, m);</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s[i] + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">1</span> &amp;&amp; m == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">0</span>, b; a &lt;= d; ++a)</span><br><span class="line">&#123;</span><br><span class="line">b = d - a; <span class="comment">//枚举a,b</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">check</span>(a, b))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y, _w; i &lt;= a + <span class="number">1</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= b + <span class="number">1</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line">x = i, y = j, _w = (i - <span class="number">1</span>) + (j - <span class="number">1</span>); <span class="comment">//设障碍点为(x, y)</span></span><br><span class="line">w[i][j] = n * m;  <span class="comment">//先将权值赋为极大值</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k * d &lt;= n * m; ++k)  <span class="comment">//其实是k&lt;=n*m/d</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (s[x][y] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">w[i][j] = <span class="built_in">min</span>(w[i][j], _w);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">x += a, y += b, _w += d;</span><br><span class="line"><span class="keyword">if</span> (x &gt; n)</span><br><span class="line">x -= n;</span><br><span class="line"><span class="keyword">if</span> (y &gt; m)</span><br><span class="line">y -= m;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a + <span class="number">1</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= b + <span class="number">1</span>; ++j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= n * m; ++k)</span><br><span class="line">f[i][j][k] = <span class="number">0</span>;</span><br><span class="line">f[<span class="number">1</span>][<span class="number">1</span>][w[<span class="number">1</span>][<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a + <span class="number">1</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= b + <span class="number">1</span>; ++j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n * m; ++k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i + <span class="number">1</span> &lt;= a + <span class="number">1</span>)</span><br><span class="line">f[i + <span class="number">1</span>][j][<span class="built_in">min</span>(k, w[i + <span class="number">1</span>][j])] = (f[i + <span class="number">1</span>][j][<span class="built_in">min</span>(k, w[i + <span class="number">1</span>][j])] + f[i][j][k]) % P;</span><br><span class="line"><span class="keyword">if</span> (j + <span class="number">1</span> &lt;= b + <span class="number">1</span>)</span><br><span class="line">f[i][j + <span class="number">1</span>][<span class="built_in">min</span>(k, w[i][j + <span class="number">1</span>])] = (f[i][j + <span class="number">1</span>][<span class="built_in">min</span>(k, w[i][j + <span class="number">1</span>])] + f[i][j][k]) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n * m; ++i)</span><br><span class="line">ans = (ans + (LL)f[a + <span class="number">1</span>][b + <span class="number">1</span>][i] * i) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> dp </tag>
            
            <tag> 骗分 </tag>
            
            <tag> 计数 </tag>
            
            <tag> OI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4616 [COCI2017-2018#5] Pictionary</title>
      <link href="/2021/11/30/luoguP4616-COCI2017-2018-5-Pictionary/"/>
      <url>/2021/11/30/luoguP4616-COCI2017-2018-5-Pictionary/</url>
      
        <content type="html"><![CDATA[<p> 不要老往数学上想</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4616">Pictionary</a></p><p>第一反应是 $O(n^2)$ 40分的做法（很显然），直接 $O(n\sqrt{n})$ 把每个数分解，建图连边，再从大到小扫描每个因数，由此处理出所有 $gcd(a, b)$ ，这里是 $O(n^2)$ ，然后暴力枚举 $i : 1 \rightarrow m$  ，并查集维护即可，这里是 $O(n\log n)$ </p><p>但满数据 $n \le 10^5$ 肯定不允许 $n^2$ ，空间时间都挂了</p><p>仔细看，上面的瓶颈主要在求 $gcd(a, b)$ 只要我们要求出所有 $gcd$ ，就一定会有一个 $n^2$ 的时空复杂度，这显然应该<strong>放弃</strong>，那么考虑题目可否不求或者不求出全部的 $gcd$ </p><p>发现题目的问题有一下性质：</p><ol><li>这 $n$ 个数是 $1 \sim n$ 连续的（我以为很有用，然并卵）</li><li>只是询问图的<strong>联通性</strong>，不询问具体的两个数的 $gcd$ </li><li>答案求的是一个<strong>最值</strong></li><li>图建好后，询问<strong>不会再改变图</strong>了</li></ol><p>除开第一个误导我好久的性质，我们来看看其它性质如何使用：</p><p>首先最好用的是性质3，它明显提示我们建一个有权值的图，将询问转化为求权值，具体的，可以建<strong>一棵有边权的树</strong>，权值对应的时间，两个点之间的路径上的最大边权就是答案</p><p>现在主要问题在建图了，再看现性质2，明显我们不必也不能求 $gcd$ 来建图，正难则反，考虑可否枚举倍数，发现在<strong>只关注图的联通性</strong>的情况下，每天连出的边<strong>等效于从第 $m - i + 1$ 号城向它的所有倍数号城连边</strong>，边权就是天数，正确性显然，而这样建图，时间复杂度为 $O(\frac{n}{1} + \frac{n}{2} + … + \frac{n}{n}) = O(n)$ ，但我们要的是<strong>树</strong>，毕竟如果有多条路径就不好处理了，于是用类似最小生成树的思想，取最小的边权（其实就是天数最小）加入树中，用并查集维护联通性，一共是 $O(n \log n)$ </p><p>现在树建好了，性质2、3也都用了，来考虑询问，上面说过，两个点之间的路径上的最大边权就是答案，但每次暴力求权值肯定不行，结合 $n \le 10^5$ 和所求问题，不难想到<strong>树链剖分</strong>，如果是树剖，当然，本题得以解决</p><p>但是考虑性质4，树剖是支持修改和区间操作的，用在本题这静态的图上不免大材小用（<del>主要是调不出来</del>），于是思考，可否用一个预处理后在 $O(\log n)$ 内回答询问</p><p>当然是可以的，考虑树上倍增，用ST表+lca即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, D = <span class="number">25</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="keyword">int</span> fa[N];</span><br><span class="line"><span class="keyword">int</span> f[N][D], st[N][D], dep[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_f</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x == fa[x] ? x : fa[x] = <span class="built_in">get_f</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = m, u, v; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i + i; j &lt;= n; j += i)</span><br><span class="line">&#123;</span><br><span class="line">u = <span class="built_in">get_f</span>(i), v = <span class="built_in">get_f</span>(j);</span><br><span class="line"><span class="keyword">if</span> (u != v)</span><br><span class="line">&#123;</span><br><span class="line">fa[u] = v;</span><br><span class="line"><span class="built_in">add</span>(i, j, m - i + <span class="number">1</span>);  <span class="comment">//i枚举的是m-i+1的值,所以这里要变回来</span></span><br><span class="line"><span class="built_in">add</span>(j, i, m - i + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">dep[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">st[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (y == f[x][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">f[y][<span class="number">0</span>] = x;</span><br><span class="line">st[y][<span class="number">0</span>] = e[i].w;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; D; ++i)</span><br><span class="line">&#123;</span><br><span class="line">f[y][i] = f[f[y][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">st[y][i] = <span class="built_in">max</span>(st[y][i - <span class="number">1</span>], st[f[y][i - <span class="number">1</span>]][i - <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">q.<span class="built_in">push</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_ans</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">//类似lca</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (dep[y] &lt; dep[x])</span><br><span class="line"><span class="built_in">swap</span>(x, y);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line"><span class="keyword">if</span> (dep[f[y][i]] &gt;= dep[x])</span><br><span class="line">&#123;</span><br><span class="line">res = <span class="built_in">max</span>(res, st[y][i]);</span><br><span class="line">y = f[y][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (x == y)</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = D - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line"><span class="keyword">if</span> (f[x][i] != f[y][i])</span><br><span class="line">&#123;</span><br><span class="line">res = <span class="built_in">max</span>(res, <span class="built_in">max</span>(st[y][i], st[x][i]));</span><br><span class="line">y = f[y][i], x = f[x][i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(res, <span class="built_in">max</span>(st[x][<span class="number">0</span>], st[y][<span class="number">0</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> Q, u, v;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;Q);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>, fa[i] = i;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; D; ++j)</span><br><span class="line">st[i][j] = INF;</span><br><span class="line"><span class="built_in">build</span>();</span><br><span class="line"><span class="built_in">bfs</span>();</span><br><span class="line"><span class="keyword">while</span> (Q--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">get_ans</span>(u, v));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 图论 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> COCI </tag>
            
            <tag> 并查集 </tag>
            
            <tag> ST表 </tag>
            
            <tag> lca </tag>
            
            <tag> 倍增 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2021/11/29总结</title>
      <link href="/2021/11/29/test2021-11-29%E6%80%BB%E7%BB%93/"/>
      <url>/2021/11/29/test2021-11-29%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="77f9d5ad25ce70d3b112f9a387fdf40938573fd6b417f59140c8d1acdacdd9c2">91be494885fcda4e29aacd3585d6ad0f8e221024fef0b471ff1e7214fe95e00860c3cd3067b96d82c28b9c2a39a59a8edb7d0e67f3c7eb8ac44ead807142204e0dfe748c2933f6405141a11828480d358d850c5e1a3ae695dc0717306387f612dadedbd7aa23cf664df57798c63c06fe1bd1ec5e737d3c8c086f5f116fa5f297684ee975292c87744ec66c021af92a2fa72235635e16fc497a664ff31078968875aaa5b086c14ca6fdede931b31fa7570ec96814630feaf20e11dcb5595cccc54a340e00d9da4fba68a5a679ec5caa992e7693ef2d40968f40ffc2c60b1ed186186d5104e736e12fd57f40a699b2fef561c4967de14964016c208cd3c6b0190e9c567e8483f6fec0e38330dbed4808585f5d4c066bf22c02c296dc768508fa640fa05076175e541aa5c5d21eabf9e9af7d72c84b5d47673f75b548cd95633f77cbafc62871001a33a09dbcdcb352024a314f048e97474c64aa529306d84f137b6fbd8f46b7171ca03af62f88d3ca35a16e890f9447ab1ec58aeb49dce80912ca97abdfef53594185ecbdf4cfbe7bc5838c586e86974658d060a514080202e09928139784468fa853d187f69f5d394e1149d34e03f51bba8502c23783f4cb9455edecf25aea8be7d28f8cd8023896a967b33fbe34a2af53f4d006de8a58f6a834f3e534a50dca5bd7065bea55b88d87a3564a343ed9c4472a3de1d84b80089120c1e68a4ae1dd749310d293db02b4d8f0ebcb4f86a349ae8da38859eda35711d4f0e71fbf381d146a6ba986ee3bc6a7fb9f66937b034c61d2ae00902a91e4b5a0cd3cc4a3fbb76d66b02aa3978b8f33d19088e12096e2188aa14f1d656c35e2105090ff5f667b9d0c3296d2b05b76b73d090035d375db67b48c31f2f21adc4e250ffa5dfe28a525e0187bae30b6ced5a50619581020e949384ee8237d574ef9fc616ebd8c33e0ed4f70dab31bfd5da213825a655a3150be3b3ee4f8351e9c6bc6164547d173984ecd7174edc347236a22ac470a503ff04107cf19e1d93d9a635289bab201c165b0e0f96b9bd271fda37069528cbf9f76f5cd6e93f924aa2eb857937f0d0b511d13c3f460be569de9895d223fbba230771067f9992db23dd1ffb10f804c6314bb53216904908ac6a0ee3bb308462287f00c2bd47622bc57c5e0eff33b66157c8fccd541db7ae48abd82c7ee57c86e7cb0dbf6009b98478b83967c865c2e1010dfdf637bba9efdd2ac5fd0aa2a1964f84b3b4a2b0250aac9936767277f26653dd3e4cae98df6b99fc220c0e014b2a94a21c66e3f973d479b60caa6b391fd5123f417eebfd011aa29dec99349597cc42fbfb08743cac000f5c779f4e7252d5c10779497df1a01bbeab067729ae0f27a59b7ee2c100828e2539fbbe1e523b5f704cc6a4fc943a85e4305572f2eef542584fc82a10263f65e11265416f40e75230ff4cdb0d4dcd84fd4fa198e23a1e88286e9ec82ee8a56eb7e43a008a25ad9a1512a2eb58fab834ea71a577820fd7bbb7cfab10cda1005169f65a8bf4ae27e43671ca94b109e1abacf7cb49041b4c21a6ae80511c38b207018785eb27bae1e8b034c8ed67f70059803a5e3f367383d4eb04842607638bcfe0b6ade4e474d4792122ef2854bd1fcf3d7005823f5d1040a990ea4ce8bc24f396572cee9e5a64af10fcf6247901294846f926c30a7ebba9115bab7db0a7a82483a6d343c13adc77182c65f6055c06ca5fbbcba04d0c7e99123aeb3fa003cd6c5b228352599c8173be6b1db38518ffd0be47c37e889c157458a17658da7e872285baf872c51f5cf8be03a5ecab6e9b9900bf8c93290d6423af4405e823ec995ef9506e9d9c9efc406756b449cd37aa7d666cc7b7f3c99e463b7bc27ce11620bf7a8761801d433dd2b3f49cd6bf1c3de62bc40d94f7b4adde9e47334a36bc3d5362c8d6092a407cc17c0bc9fe447249c0bd928319037bf857cae632b1c3c6a2d889c6fc1e2b7ea9bdfb6e51e4b0533d5b7408255dbe7799e512c8a1c8b38d37974b90ec57cadbcba15438e6567098c20835e5752eb40be23d0812d056139387685ae6b82b4d5cd0a66291484dcf8ce633f9f09d4968646c1c961a5b812224289916a9458c1580b75ce26fd8eee5b9fe39efa5cd22ae439081e4baad05e4797e0b9a39ec4bc311ed99361281fc905eccb0c45ce1108c942c7897956cc30d94e0b9c3054766de82b9e7caf53f0b126662fd6edf6ec033d6fa676794bb6eb5aa78ab2166c39f157912ac5a8b552310e81b4948ae1a2f9d5d4b50e0a90ebfe61a31429035dcb073375110eab9bc02da15e8848c740164d79396e3a0c38ddc65d5b0684651ba4a5b549d47529b139b416c216a41f3358e1643dd2ce3f1332bae5077be14bd7b1a86813b81aea78abe68b01ba1296ea274c6f2b95fd289593608a4c305f005658c7302288f097db47f839044f165cc3e0acc8a6a2825a139dfc48f322f5e410f7104ea2cbc6e5431db14c5662704d9eb5acbae961f435dea378f7ff70192efaaf54d74adb5e5b89f0aed355db88d35915a3844180c691fecdc033838ba2c19dde5c888bc32b24c3f675b7e8c776a44d7f519c7acd9eae7a74b2317508519185b1dc6115c75ca5ec71236e83869fec69356db2b4876b90e30c98e91190bd14a7ddf37b0bbb00a5baebc065cff22a98f7f88b309c8b065fcbf831783c04eaf8cfd5e57420d4b2e619316e2fd0b66033a5a085927a052ca3976cd0ccd83d388ddf7a9fcef276b279fdbd7cb74562990f618c60e8687decfa0d4c0f61a24f90f4e2867a8de086ca7ba6c3b920befce25d59833785309723f387a788bf5f4e7fd0258ad7c0f2f8a1a78121debc07cbc4e5906c88ecbdb5c9388552f9f9d764119a02e7c1c45ddd037665600b6b085b9967682c466c4794b43fc623ae13ff0ad08445ce1b86bd163930edb605684168ae73a2f0044fd2ece5a984cb94c4a224c24a30e4f1ea20d6550cd64594892df389e0db327759b41482d8a20b1729e66bf6a94f25c797fb118668e9dbcb5bc7adf7e19bdef866760a35433451357ba74b81343b3cf82968b0b9e71d5c464506c4301b6dc98c598f8c9823ba5a7e1e149e7c04769d09496b021666191abef3131dcc067ea1c84ea5c0597ef6ebc5d3c63daf8b415235ec5ebb37010c71bc0947f84f039a90be703df1244b9a4398ea353c99ff241e9f0f9c403e34b63db0ebc1777f6c79e33b71f98f211a5e11d5eeda74e113fa60cb14ca03c1792d8f52aaa7370d2c805d2aff3c21ea748b0fa49961ee49a143b2fbf0472a9ad7154b02ae6b9bef871f833711ddc174e9ff9cc85411f500b83120fb042371bafeeb9cccdfc6029551e01df102ad50b41cf1afaac3a6f29df35c11b1bb6d9e232f19a2020acf29fb8e20bbf9b6e6060918a5a51ca1787d955fc284dffd0cd5710efdedf3dd76f0feda111d93aa2593f240d70e2412032e7997d95d3d1157a389b8053fd21d1127aaad930e06fa2b1c620a92916cbc41fb3fb61666365ac833875650e6e6e57a50c1be3d17bb0ccf5f98dba50747797a472ff1e51ef6f2dcde8b3b481d14d0f9fd4a744b27239b52ea54a71f45112bbf5c09fc6a6d854b04dc1abd7f4a4f15ee4babf8ab03534369fab5f89d1d3c3a9bdfe1b4c258893a4f0a58d90a6becfc8d6194267c36d614d643dec6b78ef603ca47447b73e606b441a67778c81011bb329a3fbecdaad12d4b71b00c6e17e88f5f2bb8c22420b57f6ecc60db58b5d1c13e549d1b889b088b96f0fe7c652c0c6be73444792f145c12ab881c84dee7e22e6849487ee05c0ca57ba703c0fd83f2fc96574e1432a1ec3e15c009667d9990fa79b4196640cf0b93cda08aca36b1e28158ac2836e585cbe017aaa4f754a84aa8e05674f0f8f007d25d38b345c431d29bce06d79abdcb290d59939e3a10991461cbea755439ac659282b3491295207895ddabf6004e8e4971bdab480f03bc9eabb9263461ee526a58fb764a1882d309c23b3df27709bc2514b45d516c945278697fb9a14c1bec758642d574be480ddb215577390da4df7989cab95eb9d512b581cc1e1bb7a12d16a119fb3719253c75706f34c31615bf6fbfdf781e9d5d40b48c27d905e39488c8b1b21c2051e25e34d0f6a3dc753612efa73a62356940f1cc710e0b16eaadba95bb965d3a905cf896bdbccaeaff2dde417bbc76155edcedc967dec866253b9683ee9e334471594876de2aaac9b48b979373caff03e3398f03671e8390a8358401bcdab33722ca54a6799efd0241683efc4d193ad398a272878a5f1379b9022c61066e5810a235d975c3a3851313c60bbd14403e3d98b8a9bd7a8e595ee6e7184f69ef91474326ba7bfb028727919aa0076bc9aa6a801f2996c14a8343f23f54ab6dc0823ce36a34553934857d61559fa4314082b7a64cf4487ee23f05767d927a70c9bfe5acd0c028fca3db879ba0802a4a4551d8f61aea270c030f52297c8927ea3c3b7aed70d61bcbf9624eddc5179054311c678e7911f5c7372a0d803424c67c984f2d0b62d3d4554afc7c7adfa0dbed975e76f84baf68869f6391b7c2a748709295d10aaf175a7d1361055f4ff8d6bb620a329f6c8e6cb1ed86190351265e3f8b543a7ec43a1da57bec83ce233cc9e27c6ef59bbb83841b4e5ab7443ecea01b13a40d480a8ea6b3adec4296e8eadfa5ec096d98dd8ca0b089b897607dd77bb311e9686e5529b5321f9603560ce95b09745ff40d94d435167ee73fc7cdc177329379b90cd66a154b04e0cdcd360907ecd44ffb4a182f5cc5cfbea0b9706cee07b9016d65d4f46bf27dab1f06f4f6e895854d4a596c9a71d3c32f40ccf580d8a74320f571c6d437fc96172b0ce595f7ae949257990bd7097089c29b6d32504f49d599e6ba58c06521f6f5c95d461e9e6ce65e2cf4e58bf2df78ed87f1a4addba1e9171b62187ab65c6be9460321d72e5236529a89f1ea6529b75b2b53394ffcc4e8601a32585e1ae4a437bd1c740b65753ef6abf7fc51e386dd6ededd84f3faef58f62c5ee0dd0d6a38c29cf73b4e587f67cc657f7a6253a77c2a6ad9d032d695c3727c5d65ab29582368b64a0fa553ea25cab212ddfeae74da99fccda5a335a8eaedd976bd57e9adaa434c87e10d1fb8a427c94d1dad44fee68b33337a2beca177e5f95351d400c059a38e820bbef58972040a2150ed6649684a6b4c6f0c19c2c10d54c07fbd781e4ddb45ff27e198966ce9183e292984928f14f8ac25113fff4fe985bf91bbcdd05ebcbb85cf57d7b7dc73039f9aa56607934df0cda6f04d52bcb7e17683fecac14c48aac9556d9a4abc32e3c9e8e82fa6f896b3cdba3093c7b5eac7f5772e6371a68dbdd9f654e535da09d0ccc2f205b2cb8e1538b7aa19aec2ff84fe8a46a38159bab4ae784bcffe07308eb2d5c4e2a2e95a9d152e2f2148c514ea33cc477e9597cb411d13d81e1a5b6e1e1b9be4be8c9ede3f678e76d7bb6676bb17bbbdf72caeb2991d58ce77012ea7e2051a0597d351e7ea88a92e942d5f6ec7f90839a04a5b2c848d9695ef8b259f804f6193f5bb9c80df614dd85a98ccf7dc80c6b8f5e61b2abf51a135a822710cd6e609d18314721e4af66526383bdd92a6c5f1957da541b10e56bd644597bb6f0624d854b5818e4728a9c92eeefa751678d3973d1472403b114bddafee3aac5b187f4c6505307c15e7b7517ab49b6282548170c4a87a1782ab3500a667ccaa209c3084fee81b76e8625c7fb15ee1fe5c9e3bf8d1fc96ae02d8582cafedef12628dea91eefe77e49404a64365c89cf57e431fe016441e73f592f147faecd12f8c64c882b8a0c7396c07e5486c11b210d8ce6119610644bdeca78322d3b6b062f81215a517f1e4f94ad9b7c9f9b0acd8ac7f814eb5076cc3ab7f6ecfff68f702a6c135aedd0d165582bd4be7a442b4f78f67ab365e71533bf95a888bd20c26a21815248988deed74efc7f290da65f73b84a8bd9365f0c293d84eb6586e3c3a69d783da8f7f815cd63eed69d2eac4ebae207c92e43405ff93ab4d1a6cee73b8e5d678281a54f79e43d1caa27d2e89926f0b83ef38d6ad8a61e8d450a9124c4f8c8bb4df49cdb03dc3f9aa0648d740ab21dba358cebd26ca4aa54e2b75e85227a94a22fdf861972b27e8ba78349a29e8555842d0d64c1417a3ec2e3f5230763fb7a2c9d708995af696a0635d4b17bfdff2aa1d65f7d07589d318f757b6d50958ccfec59263c8f2120c1c32fbd4b79f36270ab0666fe770a25e4680a83bdfd66efd096cb2e2b0b49b79acf11fcd7f5eb6a093b0e9f115cb6c37d96eaef624128b3c67cce5f55451add75c30997efd77af917e901ff2f3c69efd742fdf9375698a6c1fb3184fdb2ac5dde0324d9715a4a1300b8188c5e775848b6a96fbe0d90ea4942d2ef08070b5935d392aa2942f7bb137dba540476a7be87cf370a49e68d71f44a1a0c61debc02ecb02dcc0cf48d40806827bc1cde56788779f3a170ebff3676bc9099abfc73e9cc4a1b153f9e0869ca75335ae0e47c2ad4e2ad11fe158c45bed9ec2cd32d292d12feb30a4e5cd65776aa1ce23b17a1c353f14408cb128f13ae5aa24e61936a54d7ec9b9481ad18204582b53dc32ac8b57c30123065fa5e5c9b6dc2ebb2710df7922cdab921972128bcd6f7dfda325f08dfd284c32522be11c77fe4844fdf76f77addbef9042e6c414aefbb0c0be89dac41ed716d9e9b6bf0791a0b7081b66e70fbc74cf4945aafe19d9a312352c7c45d44c465b0b76a45fe4f2218cbfb054315981b2610dfe7dbfed8f12c4511adc46c6843559041d60576826a646d557314a4f532f145b47146167f69f4bf8fb692eecb2effbe09f1f98851efd0e8eb99d3ee8b71f84a33f148be650f823b2ee32ec6baf9847a8d0902811e29bde305df1791bd53633d15ea108285b3946e0beda1e819489186d1459dec45b4d2c0e6b1b19ed0bc720f49b7bc203e10f93247f6ee2ca40e1658b64951af43daee44796e24cc93d95eca482a743a18dedac86a238667b5e95684e0d2930e84f832f8fdada22fc96033b7e4ffe20fc6a5d539bacde9bb9bf341241ea10824afbb98c27d2977ff5c90049d6c22dacdd3ef443c94b1453a6f210ce179e81721c1ae816964d96ab61d7cf528ced3c33c01779b478969edfe98f2da7f6c019a1e9c9b77f92cff508f0e735fd45ec6074259129a6a9d9e7e2660924c40ff3940577b61bcc899749b80997f66a638c0761e4cd7889c5974f2b1e9206a619de1f45d0bee0d5a52cc6b425ec7277c6306623810b188c152ce01988dbf6385942d235cd47d59869ddd34fd1f1478a3f917ca73abb309fa853effd245c7287a61e1c3fd5608faf4c0ecd5a414a2818c56568265d6eb1b1c5f3d7166a35cb0d277d50439483253565d394a75108ca6e23b336e46d68ff3ddbfd5562153d7f645a776961447b629e6569fbb0617aafdb2cf828b1cd3f45c63380d0f1eb11cdb4231f0f20551a134980e582c14f2795e7599c67d038dc907baad626114c422bcba12e8aafac155ff506530047c05555d87aae1257bdace525648d30ecd25cafed7434b4aae7b035d57a5a96d4dd47deecce8283b7416fca4e28e07f997f8f44843ebfeca1969399e229702630c7d3f35920fac8e6e3b20e610e814a934999667153c8fab93c3b43f17e516b460d1cd76126751c8582ccd8448c9c242c9e10e98dc32516fe9407c9b3e6c5d95edcac9eae4c9cbd933ee52d63fa96f64fd60c5e988c98b83d6fc345d4282bd3dda796cfb5f716cf4c26daa3414953ac3a3ba901b1013220faf6c112e27fc41bee6895aaeefbd6b4a7215bad957a85a75b3b70430062cfa87c1c41f475571ed5ca9010711e351edca8f5e2e77ce8d62ff4c96584e99139d014cf96a99a96983864a0b4682a550562497c6bec7da5648199011114dcb0a96f0271cc70f964572b92f802b3015c92286717447cf371b2c169c38aaf949f747d444fad6e445fc4d623b8e06863345d1b884f40d302f187e1555e73e1af90937363ee3d6150e0f6029cd24114db15e285018b4171a0c81eab293841d7a93667b02240e5f22aec4e4ccd520355b3db25b784978ec2368a6cafa416ff5b942735e7769ad3139d5bb1559eec0bc97a46bd8f32b30a920c55aea1d46aaab140039df748a8ee0223ed7115781675fbcef35e223006f8702b1dff9d8ff86f4268788da8adaf6c415e7cda0490ddda49f268b6062ecf67e7157ae218e8f31be30261439774941934631d4e8ef1856e50eeeedbe7d9af53b884ad61dbca51bda41f78ec9ac8b6630baa4774d11d899ed0c31be8494bf8026e1e42cdbbf1883a247d6aa91399f88ff5ca140751e26eab4c47b5ea670139bf1304489536ac15b1bb064bd12fea9647bcf11a6d72af5760ac148329fe84263161f64984671aad6c0b5d4e5f3260ffabad51211f41d1927a4b3deb1409914d69179f383ba04a9f24b0fd4fa1f50f5be14e42552b3a5282268e93a5767d9afad204a2ece6b1c37ae788cbeae546eef7c659e371e43ab278cd587fc31634630408d60cb159b839e895c027879e1c150d8abd1acf01e7e9216242cfe27270720e1184e1065d3f7ad36abc1f6980add0aeb7b2b6bd755200719136596be25aab5b5a56f2c213df2d1d42de22325c6fd0f03afd29d7e3e00b4d907eec64f90482afa34ff29fdd168c14a23b8c5e935e59f7e523021a495de253b2e58ebfd69d5956462d0d9bea4be3a76194bffa59765ac8824d3c899f6d3c583095afc34c4de6dc4e94ff7ac5ed392e1e7a3a09d732ea99fdd9e0475bd2f744646da3db53d9d459f91e1ac901b1330e6d716e2c7ca51c8d52786531b43b13f5c2ef2ddc8ff8d41f27e3893b3764bc4baecf15dfe7aca8dd6da315f3b9943165c038dfbbf4670f6800c5a3262de9ae497fbb6e2f5e0cdbfcc6fcf7cf00666e4e4e8bcc419f726b152f5e8272f3bee80dde67f17f4b459820bca9ae69316afe5081dfe9e3146ade026ba5b1d1d740d1f1fb8f2a73d8b553c72106686c706055050127d43b721815affb3ce5cd8e5e1a67bd382cd75e3c6ff773c7e388d736affcf4c5d388ed92613e8f97fb69533f60c7087bca5f2fcb492957bbbe35493565d19c8a63247ae5ffd19c18f002b12aad149ae6f5b72359bf7cf1a4b173acd0315eaa2f2d811e3324125a26cabb51c44d2bfa9cfdb9be01f0f71c20d3729322d1d313648a7c5ee3a35e93cd04d4642f5487e3903fe9d3067fcc773fb60ab0653e1f5cdcf5189553cb59c9744a33836fc9a8d069ba851c103b54bff20dc7b9a1fe90af98dbe73cbb0329c7e88b0f31823637bb9d3dbeb479dcbec94da7c73f6f4f27d2ca95f1f38b43603e15e75dbbab12a170fea894a9eed61de52e666b86b65e966f9d114361d546e6a1716ee7d69b9ce27766d053f17fc544375f61551554152de96ee3b1f7f149171b1eb7a959642b475995d2eab2df433f75553aa5d6f586dd22c0f0636ee0f6e29c1f42fc8f79a584736b2b680eb7accc5fb182ce8b5fcb8c2094bffa4793b4905142b465ab623986a89fe361274bd8456bdd7ec139be0f16011a8ac96b007456549c8476f39ccc0412dc77a250eb6cae1ec0414edf83016e7bef904834967e11dc0fb237608ec1793adbbe9b8db12ad385b15eaab3a995b394c57f97d0073d06bb924482249f0e864d12f459c211e40daaf857e6d706504663691bcca786b6e1934cd9176205071ac815b78af6b6bb40299c2bbf05abb7acc0b9f232cf7f26ac5c43a95f251a3cf280fbc4aca4c70dbb0e2df003366d6c1bfea96c70100189dc87375c12f358a7cee3a875b73d532c02af764d280233e85fd6cdacb2a53588623c09756d95013d0dd014f569fd300c7cf865fd14c4fbd17484042e2dfbed53e3a8f790b189e13786ef016b9018bc398d8fa099da13e2e210641c50c45ed1a6001bbb747d07819feba23364770cb364455ae707f08bfd9261284024e662217fe84a5dc4f6db6f107f3a07676cc63805fd2d46d70554961ad2c7e0a2d70a13c3b2f9f408c9eb0566e9eca2c0ef3a9ad814f16cc00ec2e390cf95c48e439dd37fb8039a7320e0fd2165a299a199aa6261b10d253b25059de9438ff4c9aa087426038443f2efee92cced62d069c041b6a8922e85409da0bfa03e72aab87616af12c94762d61ab6620722027872afb524f753ee6b6fb0613252dee5598b0f137aa198e86f72087b1639dd42fa44ee50bade543c0efde545f1c973e73a38f7378d6c8b9d542ab0ec1e6381dec590f4322d2314ff4355cfd95907b86c55082631d5fb3f0faea7757fab2fcc2b81bffdccb94b9640e46d41728329f1d86c956dc650b0c340b2e64592f4513a8e3958de2d1b1fcea471e845096d9d9637463fa6bdd67ead511e78750e5d15c86882000dfce474c4aef5e6769e54092ef3f6257881ddc98c1e8059fcb081b0ba3f0dfb7c4b5eba88fa0c8988fdbffbc3c8873d95085b3df2230e9d3474b2b2a953a844d94c418c86b98f2ce1acc665a3b3d7b51841f7e0b61083b48a8c4e73bd4665ad0be563d0164fe5d6ec635d4c8efe2d24b3b65b50760e8adfb5c300ab27666c0a228df7929370d5b65ef0bfcaaf6bf32990142af0c95cdd30db66662f474e5c208bf254d8f222860044ce6314b841a93b52d37157c29e34c0e819215a4df49aaf1d2507b108db09e6c9e79c3ddd8cdaef06204fb175b4804ed66b5537f4baa0c3f48899deb3ab154c330e2e0ef399f1132850cbd1d094e80ec9b013f6135edc590569419295749e933e73534078ccafffdf0f1ef9179a5ed6d0885985073d7f6b06f4f5dfaed50d4e6aadeff53f043d2e7c53464d8cb7dd81424ee4f6a757769c1ef01e095850c6511ab562bb1892e58c1f2484cb4a34ee7b7853431a645bc0135ca04004f779006bd13d872d0d18abc51029e5f07d0f7471d650c9e2deaeb2461663a208906b95c8f20dc8845dd08234ce1be8f6caf64a8e93e2734f67aa8761015c00a60ea68f7f80abded4817b5e43f1aa30919800375b0609e39b1de0b71527e0677e45e12b4bc17cf730110c72e3729bdc9d62f9aa6ba29e5f3fe837d4287ba95b30fbab91b1db2f41d8edfb8cb7e7a26006d6f8a6e37ef22e712a0d66651d7b7cf80747ab0c41306509cf176f58104abaa6dfb29978623da82c50d72b6a09fa121bd33f7c42faac9b40c8b412837ab2b4640ef00d113a2573d26c679b0c0f028642b8398a4c53df78556ea58a435ef9f21fb4b5c7e11f9992e3e2ef8402d99eb5fb2e5fe9a82a65a6bab2e0777acc5834589c712391a51d170e214a60cb9e3731e018610a639aba42208a0074d71798dba8b7cad169f9e62bd9a22b7885a29d63650b704a4d83c42080e7822649303739d8041ba26f747fb58555e122d1a1ecba5216255c84f9baed95dde343faca716af29b45247b3df640b902f244645f2b4818c0bbcebc95192423a5c675326c77bdbac8104358c0d7b7d21f428f4a0fbec45b58ed75e891de0101e5d4ddd340a9b5542bbe3e3025d76c47da1ada5860443a6260c2b6200c12512c6314848833688060baa8edaeac54a58a666ce457bd9c950695dc82ef960b0a7a97c084e632a2bec567087f879f9eab6fab352506881a2201233f37ba0b624f0bc72e17713f40a2ae15232637a07af218f3bf86c3c434c10b10efef7aa1bceb7ef928630d37b66e4ae6074fb26d8054354b06bba22843582b42fcb9c46a2c69f1691f16a204568c8869d473906ecb92e6dc10abd9874fffc189e4e656ed25cdac49845154e03fc73c8568004bf7f71ea3ec8ab644dfb77f2f90c48d25799075794e7b4fd3a2a095768258513d846c94d7c52d8a426b8d968323c3618b27ef30d413e760cc7a006d23d7c8c618e85be78cc4b89c791c58459658d7b2b379178c7532e5e3f638ef632e5569f1ba63770abaf7daec7e5d533efb0656efa17c3744fa95ff73bfdb9f719e00b09a591e8b64206d6edfb22878cd59d8256029ec1151f28ad87a0d480a4d7a9397753eca2165600f00c97d183b977d5b59dfbe780c08df66d777e011db3b7afb5038553ada731ba5f14a972084843a54d5698c77893f6a535bccf10a93924b44996acb2346a5e8305df527cf21766369e97a0ebd27e0906737f7b7a1635eabd9c37e1a18fc3a2127fd7fd642c52188dcbf5f215cfcbc0acebaf05164e0bed16a5a960f4802964e8a929a16c4731dfae380789955c00d842adf06e9e40e8e62a9cb2019c7148d1cf6427952f73ea0a80dec7d9cd7862c22dc303231af3e1d61a13fbeeeb7b3178e488da4dfafc131f92ec2115a9ce71acb7dbc8df51e7891f02816e23ecfcadb932b3ee5915df4961c33b7192ee18471971ca1ba56099bc7befd78deeff6c85190e19ed8f52c0bc7e861ff132d6fd75630201f55d48e46a8f8dbe3cea8df5550e64bd622b01178cc469999aca4b84dd8aa06009d65b04b4030daad14f264ac1aa541c17b7d5ae779880ea92ac770ebb4f60ded492b3f944a175c3a9051be9dcf232c642887016591541ef60965b4bb32c771b44a784f5abaf49170cf5f9c0c0748286d90b9f482dd13f9d5a7e4cf350ccc65d745a8bdbcff0c3eb201a5258b771313021016f90c0b5554eebf120302ba0ed22d5984587b5a6a715250bf13c3d5d4b3b47f530eeca3a625ca9220fb912642bb1b89fe00e7b45d942f787ac8099a5f9705af02f665cdbfd4db58da48ecec7a9805407d70c859747f2a9c08d80b5f6c5e30a5f4970cc4277e4bb40f4adccb8e7699f1400a9d01c0b39b9f172f413fa1fb6cce6a49cdc73e45d01b68cbe7decf88195dfe8d80dc959567fe54cf4cb6d6cb9569493e339983df4652f0205b2986750403a4edac3f0ecf4734ea7dd8ba7b1f326dc045ed10d9e7236a76d13ae1bd2bdac43f69fa0469b3d8d05e16259397eabb9c08829ea5622a6192c26634f4e2b62f645c0eec8817487aebe2cd6afa9f9f1716021eab3ab10120a0b38451d9a201cda6640fe527dd36eb257309a0979b4ddf106dd15cf4c67c9712922a141b2a5c72f5c7110b4c3e655281605aea66a4602dc26ca509bdf61533884b7dfcd5f36268b3a8c885be3d9e4b7d6af4a3d89d8c7215187d1707ea3f00788dfe250db38a14260245fddc37ffd6bb7318da9d03b17ab3722856549d275a0bd225a50cfdb9a251bf249615738a1ee772b7d92c31c725322f3174409f781bfb4bf313b012719f12c7428661e7942fdb5903fa4c4837331b32ff078d89cca390782bf883b6e5b903616bfbbb17719df2404dd818d5183883afa87330c264f667bd0cdf6d261ffde4e943c941f27707fa26e250f91e6153a0c17c6572815cd4d8a9f1166c31145369a9aa2d1c06d7880dc48cbaea5fbfec86a9f79907c5e682cddf016fd0b9cbd733f4e4feb799597ca88b3e60c4d7a201b88f6dd1c823df1619574449581a9707837d9427905cd63eaaccae3f4844fd5354b6b6e10823493d1fa9e56960e2bf95a8721140dd4123a17f4da27db9e56a8db62b247216e83a503e3b947f96d446e803f4f68916767639f1383c93adcbceeaa17ab277976cb925d0d7a6d30199569be6a11e3f9b39495e9fb45788b62f85ce52214dbba95e18fe87395e04ab3eb72e459b29facc2d729314c4a7b5080ccaf13d786d0a2c0ebb05b58bd35b992232b3862ed319da02d3c118805c31fd38c4ef1ed0e03c3fc541a48ca3ca1dc4e330cccc129173c9917ad11d56b29fda5b72b079b33334070b72cd019e0616c0d4bcc41f3886d3b82ff0c552a12a4677aaab3ddb68bee263a35b3c335c779f8bb6b491ee901377458923f53775cd361817d87e40f1eddcbd1c39e745ef09122f9fe209b19b9e37bc518a2d45631b031c8d8b1ba71c5711ff262956b49fd176c300380dc390a3ac88ee62a10bd7e7a1a127f75a175cb214f4b7bdbc95eb6440bd72ac04495135fa76ffb175e47402c2bd33f7e07e6fed52fc82fbbb5aa91c6bc6881c5a372c6bd460780813a343c3fb5e9f06131d3bedd779c136d5922f3e2f5d663c137691b796e6e758a7ad0b42240c75fe8ad8272f4300f51eebd5ba6905f4d85e9a4a3bd2118f4ae3edbb91b3a587d75147c2126c45ff2a0728858d2afdee203fab1c37f3a4ca049a8485b40ccdd9d6d1611e1f7f696813199d6806f207fda6e3c71e5ab543aca8eae837e7e9892283932fca1bc9785ccc27a773e4c763c5fb655437b309826e6021c0ad9b15644692c60ead6f690cef93e9f5353fc957c2ac972bf96acc2ed6e0528490b80611d191b05e7f8634f0306e949ca580c49f6374368ca0f94dd18182b730b86996dbb33e1fa04479d307f2f9c44247c860345e618b5c60de22dace6e6cb5162da74db19d869fc10f6bd148ee89cbaaf9cda7f8155caec0c1ccb2dc7710950264ddaa1aa27babfda087b258a00b32a184300d213ff19525cf15fc786507783be6e8d195b5b6c95b21cd5343fecba977c94ca6399bd9712873f3a86d20af4373886c5ac3bc69aea3fbd49baa435216663008794d707e4c0e6207cc464c6744e10c3fa5bf39f06e59350b7d30fcaefef32363b6286858fca37b9f54189c357b2c78b70dd112381a44bfc55dc3111770bd59b26a960c5d1e2fbb5e2856a0aa88689df8b6a773fda45395627e36e64877ce9cab08a3a62e5b79f60a60e08157a01c13bb069e6f130946bd1f0ed8c91b0921cbeda0dca52395b45aed2f46ad7df3fc1d13cc8d198bc96aad17a715d6135be24cd26c80f91ba38eb964b8bccb8668841bf0191be9aea1dc122d1fe5eac90bf6a46b4c1c0f145ab35999c2cd62d21d8ef00678958d36e16add4835731782aff51d96e563700a87d2094c195e09e68a9a7171034903bf3d79c6b9ebb68a0b705f8a659f1fb4e478f4542a101449fec16e59bffc0dfc7e5f7b7153a1f7fe145b4804a458709fc4dd5ce0a343d1a892b377ff6534e8e294a555f43b04d594b203420a91852fb1e572e851ab57cd17131f8688481a77ad625e247db2957e445805d7ae6b7367779de7fc6b21fe65a0c79e5cc149f6d75f9d57d62f49fbd405d26353b035cac3f36ec6006050e0847be98e551e968f8953c3eb40a234b0de1bc684e3f7c60fc612754b6741cdafa40fbfd3e09f325e3c925608aa8fffc046b14ea5c40952d9ef1eafcfdb3f441401576316875fc52ac3ef91b3e49de1e07bdfe5229f5d8526eaa8f1e7aa39cb86c30e17e3753bed6f96e583adfb6b9ca65402e7a89d2ed93c11d4312d9ffaf8d30b8145548b124533d6ded1d6c1c7a281e8bb7da5e6ea3f43090675f3a2f45650d964ffac49c49f6425c5df55da42db8a49754d35169edd26dc27236c8ed6abf5a3ec22dc24e3ddb18c0ffcc35f27e298b50dee3ee1f1fe69d441f1f2f17d3c0d8af0054b103c8fcc2b225141c1f4ac800974fd5cc95db50f22183a9567252ba813f3d9c79f11d000f423f7b0cde71fe3017f86e46a006dd7502a596596bd7e0db6c185d44c64a047bc6497870b30a234200b3a92a2806ef0ec8355d88f955610c488a66105f5baa62ed0b6e335079d255cfa1de4c621538b6b13a75beefca5e22195ba2529c14c85f1161ed3e11e7cebac007f336cf90c16ba9c485d5586b5259643a31e0d93fe93f567c32fa631af5ef07d830ea5a45322e12c1dc9bd3d057951e7f411ea2f6b3ee82f2f821243f2461a94b85f4c370be34f28d49fcca6dfcc87763ef262bec42b05dec3fde47d71af6f67b324cac2fad1455a32888572aadc1008218e7ffcb5eeaefdfb89e83bc4604252295f8179d1c7e84cf7bd025187c96b64f0a2efbb3f396d5861e1ac8a584bb8d381ade08a16df11a196cc7edba8fe4d2eb1a6d82049eafc6499a2c08ab638b6a5ade25ca66aa3767b522b59cdc29b5eda6e8207d4f54454be7ba2de185341b68156dd105ac2aead66765c828ae3970e5ba05a61d457436e240c32c5c8af2ca35710630cb47800ef800d7ea3281309704358d2b28b2a471a01c681b61a9f25f947f6b8cbd0c59ed81ef48a3e334ae0647fb277c3a55f9e7a35e8b74c7d2cefa3f450960b9db8d4b78c337ac86fee72c445f81ec008dd79335d270df5aad3f77bec0547982979978dd747e27db05dd588a7108da663aceb16e445e08a56e1997ff92d718638e957cb24d430104dcb58dbd6b92ebdbe44a99b26957e62eecb0b15aa101e46adefa3d0b3a2df5dd76638ccc545005b358dfb86e9fe26440a9f2dc1e0fe1007ee82a8b2587cd3e1d95a68aed9378fed3dd9f8b426dce6b6eb35a02f3ead372478db4da0196dde2f24776a95a232b9459f72b0adc3ddb5306bcdc93d29949a060890847f936bd16a58458317e1e922fe48573b7273ee2637c07752d8a61ce8b644f8a2d54e6012ef0a0b3741e71be24f8a1cba6022a978c8d8296c57556b970cf34e58741f67782c86a861c02971e871dc8e3cc1c3c9b3692f11e0e522d9ca2c30553ffe3682cac528deafbf9839ef709619927029cee023f225fd209622e6e595f411bb474d6390fa65ca5c8036d3c0a44f8b7797f545268ffa27131f9a5a53c2f9c2604583acafd33b4da59e09b6fbd4f381ca2598fc50051944963aff3990e824dd0612404d1ba576a20fad1ef845e3ae27dbdbdbe04dea9bfa5c8cb12ad1ee86008a9222636b56a920ed64337f53d212aa31f8ff348de8e9b56ed2602df446b9588c80c7083f6a8e07b75d0d10e5039f91e81a63ac8e52ecf8e37016a6f0787e018a2bbad0ab7c971cf52ef3d50e233df911a599ca10fb63a0eb5be936ed71667aa4ddbf0d7017c8342669e0c2bad35bfc9e3ee197ee0ee84fecabcf326aab12e9b37c65ef32245af8643a812c2b04a767e5aaf3213998faabbbfbd157fb84f0f19a4dceee20c091815b1f4981b25fee426396d2af91917b1f7078528f7a5534efe11e0a5625402f21c84c7af6d8fa4d8bc7e808215fa50d56a9e7f2abb248aa9ba0bc1150e19401eb04dcbcd8cc8eb6048538426adde01bd4163ccfc1dcf220977c89b3d94105f640008a00685a528e495b003b0dca61a76013aa13dc2367fe5a656a1f1302aca47cce9a3087b01212f1792b52cdf27c88c5904c9319086b11a3bda43dd2f60d343341e9d49861e94a6b019219f25269e85f8ac7aa1963f708b10809e69aebc73b02538b8fc8253665d38980815b3098f418c65a9467374ec4abab2f39fb5edb38e3776903fe79ed4777a30d062e851fc63c1207cb1848adcd38f5a4363ce6a3e217cd431e06e40d53a795c05682157dc651d95876f670336e314f33fdec3e9912e6cfc49ebb39d1d46d5473bd3e702a1c31f8498d1477e31569ee727ac48bc02c4002efbccd517ad3d12b3f69b611a014ad6ed11067cf1558541bef52aafa6447beb77ac9aff9e50432dfca34aa086583602c81a69f003d868fd97b7f9bc68a445e232c970cdea377dc1cc0951a8fd2124c37de0352db13c54e722e2d2503e579dfd125aba39cd4764b4866be59a413038830c05db0a591ce0eb8348323a5d71ff127d5d464537131790f2598e5683ccee26a876d3c3e17e864f4f226acd2929ee0dbf7cc9bd209be2209b5358b69e76370c272d7dc018ee798d9086426a075666b05e8ed1e676040a8191ae5698a664b101b31e67e5f425ec15fccb5caa49c14a664bbf2154291ea586e4074bb97a86cfd575fc51574c85074f00d75babd90f555e5747a17ee33cf83b09e74ec070fe42363f4eab6075cb7dd131b0bf15a4befc262b1d9a6088038badf7cefac0b70e63680196e0906c00baec797a452158df5e02103cb58be5bf1bba178d827aec49581243a1955637eaeeac6c93d117961470de599a3e65d39061e3ed623f7b8d6a594a1335e3281dbe9ca146868acea47efb8f6e70d04ef2504ab5169bd45debe8a033cf67004a241179c4ad6904370378f1db2de7945cfe438007b9d16468f910f772b731d094aaf15b429afee79f2355a29af9b659fe933f419550d395c89d863054a19e34dd2cec03489e8a0ebc2a32debe19ce49d3851be041c0cb17368f98e377f22f3098be08aec3efc5359fa598afb8e5038a4e4072e70655bbf0b083d74c6ff410a6bb0b959b46c01c16ba144a1286b76d2e841b389a61eb7fd059b90de485a36e52189caa61a8d0c0f2332815de140feb71a4138c11e29f43fa1b21c767598c466228a12b7452b9ed1c6fc6c315b00afeefbae763a3e87390f1d82ef6b2701fd7b974c9bfd9abeb2d512a6d196018ddb47a21e2c94419fe587d43d0f559a088aacf402140822ff16aceb41ba632655ff33e3ac696ddc875cf2f37543c5879f05081e68195605e5c2b8fd465f72de286145fff9069a5be8a85de76e16a800806c053d00a389bba8b56d6511e79d251fd0cb569af113825a01952b1d6192ff57e0bc6ab9ade4144b00cc7e5b5168469af32889f0ead7a86acd1e03c4a08e1f8daa7b4e7e1ae39e06fd86e5bd3684c4a569b9b8224d6d000ea36275015d8c203961468f39203ad19758001efa6b997771c7a8758996af012997a764de21acf135f376e3d3e8f4fd58e972683c4448534ac976e5c98ea3baf35398a6e7ae75db7a6578001f2d89fea86c2909c2df7b076213ea8a26e7cc53babbf608cf59388658d9e3453a0c686413a18d4ff2bbd657afcc0399a52f7df395db8db7f8d07b8ad46842d2e6bdc229427b9e7c1609adfedf3419415c43644b6f2b78d7e7191cedc188a5e0817184e9ac69109ab5145c22cc6efe13a33088e9cbf26906e5d31429c24a178578440f4a3471bc5208176cccb5881d62439464e84ee8437857e8fc33e222e44c4ba4d1991e1428a5912a54f85fa417bb8220da112202a621ad5a79820a03dec40b927a41760ed37a88366da0e994df4c90bd282cb8b9a6e1d4cbab8cfa251287f8c22a6d13b5aa787d506fd3bf45323243371afce0d88c1b1eb83ed83fbced0c290938d5a49cee0fb92994b92c33507f4cf6b966c659dc5ad8e5a94187d197ea73055d55ee62f9a7c20ded9591024b915b1b8d21b8ddce438b4c3c9f90ad45f0cfadb95950303d275d5255168a9f6998f4e133d916d9c12e50c59a75dcb1623be5d3d18a7d7e377d31fa0f6cddbc47e5033b1e51b879325924fce15d312da6e0119123f2a9d9c402a1529690fddf30bcfa5fe14a1d48bebf50e540f8b955e3528583016daeaa0108ad492279ed86331334e4e9ba18f80d1a1c431ff1130d61bf686b067a666131c47206ec387453ecfb01f0e9cea97347f28d038a91bb136caa13a50c3bae7dfd7f2a5130cdae00f6760b049f4c097a2209b81866ca10bc76987fabb82d34246889d8f8cfb843abb7fe4b9c3806124f360313d16512e33b457980eb0b04f043916fed2b62f431404155bf888c11982e362492403e389309b57252f4fdb1f1f1975b4e520caae5e76ce0ceec7c79f74488931f2005ccd5d88ac76d5c17fe0573b5ce291b65d49c70fbc828590c55acd88afc4c278dcd1e939a51c01b51af31b0317d74547eda0b5b47fd2248d09b5321da62afb018eb31ee893a2d843522cfd3bd2bfdc4295640d029f4ff134e4bf637a848cd82bf3b958931739b6d8ce56cb8d00dc9a25d5a09c85d2408c830a4e64dda24f5b258b0adb95a09a9f6beabedd28655b13e05709cb9b5885cb8b42a77147ca5cb3ddb32b6c7da316b8c1d7c1fd001a083ce6bcf77d78dc3b85fc0a18e1f97ee7b865d48db2f140e8c736db70091fd7e8f4111bebfd184c20fbf5cd64300fee6d8ddad150ee3fc25b19e3b41c2284d7467504e568010c431d43e3546dce648358acc6f3707c2a04ab97e63eafbeaaf03f687ee2a8e94c93e7b76beefd277c72fcdfe926636dbd05e3675f126ea86ba01f875e033ebc357d159b426b99d062238d5e05043e42cc6dc2db04182928ea2408d15858873678191dd2a72979a07162ff0aad35a255d5a650e8c6c2ca3fe558e9b01f3aab530d630b82e9bc6085608e2ed7dfbe005a0ff661d0362e863886b759db16e9acaef0cdc57ce1b7aa8317348294706c3054a0dc9d3d7318272cb99722a165d5ee65f54306cd1fc569a0a1f3772f625083b6e902d8a23cc0f9f9068f293dc6af6f6ef48f5afbb1ff22fac11353792ec63b1db71dfd61bc14401740e51ff02e2e717ed0deaae048c79011f5305834f80b811b27dd7f1e98b0244e33b63862f2ff010b7734c26ed59f0ee319eb61bc966380a5d02a350d5a5db7af6bb2234fc7dcd0d704228780829e8c45fc7e5caf68635459556b9a35237b4fc20fda496f40e003902aac613d65803dd5a51e447d36600978a02630b43fee2dad113479b0284e4a276408a01e683dc81adf9299daff7d9a6686f7c140364cc75b65cbe9a74ac06837a36d2a4ded2efb36ec76369393e136f35f0522115a636e69f0ffc0d89228cfd73dbaffdc78e07e7ced5349d34ef4253d50a7dcde5266a4e52eaebbdf0beaef55ca9c06380f27f25607ad2d13a85a1b040d37c2f9e64c8dde591cb7ac9dc4107610719203c1c6760ccd85e3c02c5d6dc59b09e0fa03640558fa20f1adf08bc3378a398d8c78b629c6a58276c3ce30d8fdacfac3d96e3ed4c653f1900e71052c1d5743c5401c8ab10990352a616578ed4fbd5ad2f3d1449d2f7c4012f3ed8617c2ce5da5e967c5712a3a49195f568caa445e2d40fc090b5127521c0cf42e7bfc1868e75513408cba7e2d6e7e5a9da946bb005958a2b61b64e0c1005d7d609f80e2e1fd725e8201bbb01f67c7be933308d39324715d38a9aa58eca2d688ee8965b41ecfb7ca99a6140452e75e772714c7880bf682e52f00b77322adfcf538044824c16cbb0bfe80863494412301f1ef2401fdb7f604ef5159bb30a1a40e47eb7426b6f19bbe578f3a6e256cf4d140b6e06cd4efad6013f44f5d2a453ae42b844d2bdfdabcfa637d828063ad00b2ebd452dc33856554c8be050f45ca5dfa315eb6047f1a51e837b99994b679e7c21f3f82d72bd890c0400a3ca32f300faf6a3ec9bed6e007b1d3f74c7c332ce47b099773511f88ca13d9581a20b514376281d5cff22e4e010c5c8ed7650ee3187babbb85259e7e928925d91e93a75a24997e8afe35e9be9cf9ebb2bfad155e701ebfd425e2fb24f000237a38d5c9cd80db99c3f8de8645af9183a18040b4e933e09bcc69ec9686f27028d84c22a9f67ea281d616629dbfa89a3a8327be1e074d5dd8473271e30fcf1abdd2cf6886c7a2b16cb38ace97fc865bf4c779dc92a83d792c5fcf4e4ab5a5f88330633395727664729f1bce9a92adcb606e0fd6cb48e16d7d4f97b536db93e03b0c2f60e4d614a9f7063eddc741ac980e78d49bb47a01f4aae015edca8ec0c43e926487b1b3ce3730e2534db9cce5a008aedb9915b5961cb1bba1700f0a43915808ed1c4175697c8238693bf961cc26f90e580b43261a9595fcba32769cc74a8257908a1aee6682715862a4b49001ffb6db50757233a5659d7a1d9bea8b6ea25a509362f332f58246203377d545d092d8785536f00bc70c2c2c34f47fd8c01661233ab3de9f2007463d9ab429097d8e2d204e53bb95c33a5c4e5b7fea2d47fd23cd1682566b03db2a0d01c8beaa94be7d088bea72e47f2dc9951532257009df810c79093781d5142eba941aeac9ae71f0ce58d86f8c534f208664cf58856483c4099f9548f91a24a65d86aaa9b09c5665031e35f5eda5318fcd3f5a8ac93a5003c33983c84dc0583f6177776e20bc2bbdbbc7082d7bf78d490aa88e4e75d9c693d48e9bc543359dba796fd5f8f6aa7e7d1efbcb3e4cbfb0668500edee35742fa8fb8dbc0e8d9f2cd8d86294175a5053951d2c9400fa620f123d9f74c11aea9c28c1c7c11ba4b63f58fc5de1b30c55ce25dfe784cf6d3a42a7cde6ca588faf775e95da336a0d5373cfd0d134c0196664f7026f67927acab5777a8c9b28179f7c3b08fd706c51d605c6a36686faa4574937729f3a4def7f966e34ff44e111a2b062069794ce4945144a6db0548dcbf5da13c49e27e627aadb7afd28b322a980db982247f61786cd54aa45e37312b15b9aa291dd12b23d3bf7ed7ffd37581db121502bca6d98b205bb7415fd8da1f831ba54bab2895f5c5344904394b6cf5e52d5547641613a6e340231111d52db974ffd4c05327ba0ed1e6c5a3b6a54ea85286a74ba6dc05f3b1654f404f5ee979ba3cadeeda38168f9ee5fa436b617cc6520d74cadb3a17c2ea2a5a5ca9c05fffb22fd76f5b76a8ec11287f9b1550cb49cf9e7d0deee3cb63f20f0cf0557e286bd2a67a846f935c5b3f7858b4b839207831dc20a59ee103a36802ff1e0b20a1e45c8a3e68d55eaf4062ba912b2d96d3286a0fce836b73e7fdf72ea053dffedcc94dc421cf3acd73b9d08a0f95a291992493fca0024384954330806b0b001f97a3b538e4cc18f9146a8967846c7c87a89723fe379777910f10393b9ccee6cfaa6978c72366d4738d3ae61873a9b5fa90938c84edbd3e18a530d93b310cbccda0377da937064e3360b90ad9caddcf2ddf7159ed6cb3267a0c0da91a167b9a3323a627f8ab4a00723286adb052324f389ff01840b143b698be03e7556e29519bf943e56b4c700784a3ab817f43a51f8297469668cfd6c08d86e127c84e2f329d8bb566211626f53cbd90976e17ad2e76453ced0ee8203c6b49a4e6a42dc99952a41a6fd5e0d5b8b70b4e6d7235bc6c2ad83cd8546384ca412a3577d588729a96d84ff7ea916f32634014154a083334ecbdb94df220553161785fa32b9449e043e883d4478e2a04b0aa13df4737c435b4b275aceae839254c9e628fa2863c96121ad71d6da7734c23ed08607a36c1149646979bab12d512cb3fd59874b000a3540c693b7f010055d54a8d7ed6bb908cd2fac1dbf53c363fc51793126c7be79f7490d2a9a3bfa83f09f7009e18a45b6541ba9594af313d659d7461c4318c3728fceb403c91c90aa20f87320d135db3857d6dbe0cd8abf41759239d34789ab10ead1923e65fea490e3979e38c27b36db395e67c61e1167c48f3081e0373d652c8a0d409af366a8969d1c3b0d2c6c84f5d2eb31b525859806fff13a1d398c4290ab59280fb7c2dcebb08f5013d17c91680f840e21a7a147b0790bec6e5123bb9943070a5ec856e2258fb7f6fcad7825b12080452cd5ec9528db55c073e1581e0f60d5f6b2e350d3c27de31c2b07b81bad0cfa9217606b55302ffc601e58cd3e17475b0cd5885bddef94e4c68f02dd212bdcc22852dddf2062f998232676ebabd22ccd22a52517c62ca078bc076fef108de1d5221e92d421397b4c2ea7e7072dbc4ce467a1284a329713fba6dbadd1fe994441fc7d47a072e39fa004fb5af69b69dd19b4a9d42f2bb17d871416de1cd3c2af5dac980416c6e7d996497379d5ec1e3bbf62831267d531ef9a485bea7d05a999c6f7cf69fb6179b5ad14b225e3163ea40608b74fbda389b47030ec0d46d43436ec9d5dc73761f31d8a8309578690801faaa8b3f9a5404259ddff1f1d27f0d011e4b158fe11d4fa410ecfebf615d93e043900a96ad7ca0fe722971a5bb7a90d680afa890c7f696c167f70e1acbc8b8559fecf04d2da6c7057cef36e586e13fdfa4f548e402772be2e68256fcda8cfe83bf7ecf58a4c7b03b1cae3507518ec0ddd65e6b998c119cc04505ecf4d0f55c602c5d4d9895469de1878b5315b151ea64a91f960a928c365914ae7204ba77c13807e520f52eee4dd182ccb844b0ff42a58ce28a68bc189ed6cde3030278cc3bddbf91e08d0326c278e86a2ed07eb602d7e81224bad102d16fd9e4ab62e6f5fdeac80161f96fed1bcaef499ac5850c13886a6da450f314e459a104ec11c3862530bc94d5f82fcc540cd06f196603787279f0a24b14377018f7aab3002263cad1f162495b9f3674d1962b091156c5e8ecc18d28ce5f5aa40011296e0faa2fdcf38f35e3eb887642ea3c86016b9008540652fd6e8839cc7c0fa5721833a5f452f6984d7c2b9402b9b58508def68d7368ac962f880deb18161198758d7dc584677fcce6403c88f2590a57c15890b8c9169abe694a3c6c5dc24e032e2b2a0aee97ecc838181a747129968f60d11ea5fb810411c93b5ef7d1f42f27157893e3ca50c304ae18100aa9cea5dee714d00ba3d08483cd430b32b8a685f686b5776369e92b09919db029eb8dbbaeaa5aecf69b997003f439621a2f6b3bb4433897562e25d2e43dc1f13185e35871253d719048d309dc75410a237b5341eb80c56dcfc9cc4931f25eaf57283854735754d6855912457a01496fd453f3f869f5f6a2b26cacbb7ddf194bd5412e981b9dbb56bceef603f699769a303bec90449d165af494b2ecfb34fdbf6c4eb003699fd8ccd0c38cebd33087157c29c0d6ce4e468785721cb700a25d7e365b062e5123bb123766e1575811669752cd2dbd236ec5cd70473ac27e9648b400738af1dbf9f2d80178d46a727f5978bbcfe30198d0949aa9288e8f3df80294e94a553bd1f7222882a0af5d9f68f7fe8c2cd62723d97a22774e916573de753a9f8f92d7a7493ecc950072b121f37011006fc71be2058e2567ea4f2c035b9e34f113147a96c8bc93b9ec2d8a11a9ab0d4bd16d97a180266d56c460e55c0425d745900bec94891b1c927c5d7e6885a6f47712246d6e1f01d578a9b0f44727c3cccb7a5389a0bcf18d3ad07b9d2a531f520aa9b7073fe5ee58a75438e056a2b208ec3de1196f6c30213af9c706a0dbe5a1e9573ce9bdb814a7cae60f32bd3ac9b411d1c9c1617b4543922a8593a817d52f614c4413ff9c0f1011de19382d9d62b8f126fba972b35e0db58c52f877e79c0a4c5e7cfcf8291c18e8380c041ed213acd4205687c5dae3e4e173ff533ca839df361defa619685a693437b6dca9a8170180407b107e400044587606844e0fcd2e11c768a4aeb4145fd42cb9e838555861a656cfe5dc2bcb1650a001dfdd8dd82bc5e3539af2ecfd3187d075eb4b7ffe03301ee71a05a46c3be9b92a93ef7b013492da13a9f5187e36c1d8242f23d880c101c4ab82c6b2127fe3e1f4166cad669e2ad25a5ae6e00e0f1a8d582654dd023ead11798dd0c0f9afa497521bb777604731fe04b28c2c5e7f727a769eb88b6728164d213f1cb5392c660401088f2a25da68fc72be9e31c74e5dfd3109c7ad2135096bd1efbc4dc431c73a9ead345cbcafd74158812b60e6ff546526d75385ce79dc5c97fa7c3f5e8e45928e4d03981b021ca3249e1e1c6f6dd459db0b70ccf90963186d13f7f7c1b42c58e8d5d1e07173cb269685b0a8a78d3d67ce9f1de8b1513f56e94a2ac5cff022663fe7901fcb0475dd7248b575b3caca8c58b983ee67b659530b1676e84d130c5b9d6d6c027742c3b4d87f76de45b9942580f813121dd05902a3874a2d06c154f66f1acce00abe2d9a7f05170a99ae001e62c03d8171cd6b70c0549edb47e168837123d9278814acfd8c0dabccf9b09ab7435148ac86440ccb8e065be15b7d16ce53b705729b7aedaf2572222ee9b2ea7a106c1d7a781a3e11b98cc1fb2d7d1e45e0813ce4ff1e47dc83bb941e7d5586dfabd5b3b0285e6600719b6bde3a635363bacd228390ef026981b4e5bb1c9c52c6547569e09236772a3df5a0519cff679b5076df34d3e9a876a80b932148c03bc08a6130dac809731f76fce80cb3bdce048156495630987dc22d8f540d36cb43bf71808364cc519ffdd6d0d7a713b334457519210098d013907c32bf4abae6d0ebb937a09f06be3f7c17d419cebe835b4660840e128b47ef9d1d91b72d2825a38e37b438c254928342b20e81265db4ce73d85dbafbe4cf865dbe30fc1f951916b47b7c1d6a2d26285f956cf77677bfa15e0bd6c1617a731e904e75a43086185d520dae44bc7b0a1f0410e2aed369a5ea33a2575d2d6fa37366628a29373812a534404a9c2c552cf160bb6976e3ffd672ddbaeea4e5a3d47f330057a2d03adea08cf42efe26ea7b775bc694b188376a5bc63ec7e927f4ce52b2c0d2f80d9f9c1a902364f2ed3488c1f68b7785ad995f65ab12ab9485565aed7a1ec8d35adddbe2be5ae39dc5f28c503c3a7862cda6dd1bf6027647fb58a16dda2b9733b94bf6b2dd055a38fbe7ff08213c030da41e241f77d9f88f6e31dce98f2b5e261684df0e7b0cb6f02f056f8c21d45e610db620f3b18e48dfed7269e9e64cd775c46e218d3cc057aefab95de9ed2403c4e012462b4518653394335c5700ff689dfca0911f40f5ce9e3fed4a688bc6851056f7bf27b9ca8f2bbf22e0585c2d61b014436fc17f3d5fc958bf969b34233dca860022bba6293fa28f08023328a554a17d7c1236785964ecea0a1188890e186c32c3efb0db2cbe47f6d4402890a8146cd90d2b76803b22d9fa5df1183e882bbed512fb089cf2c7f415f925898d854fd3f93eb186677a3a005dd3b90f2453e080a0dfb19a4d6826abe51a0fe93eb43672b359919478a199a92f5ae44318b84894acbfcad5ae363c8242546f206858d3bf8de2e80b1e8783d713b6c84518460e2235176e1bd898e311539d19e77ae8d5f785c17f57eea16fdf8805d34e866c2fc56ca97422e3bb7996c24e5975741a435e0964ddb235fe15af6cc93178ab3696f32ba7776f7d69fa0703be66ee68e16ab91cb1d69b67e3b4d9a28fd81f4f11bc2742fa42945fb4c28ca4c86ab3ec293e425e9452bd9803647e5eb92c41ad26e0c8c1a4704b9d65b9ad7989ef4d2fdf43a29e874558aa3632f6e5752c40389f2545a77cbbad4c75ae3cff04540889445b7d8581fda0452f2342ed41040ddbc3fec0cbed6ebf688f61dc4dce080d34de61aca6d93233a881bf8625de0619650b11b060ae57d5a97f508ebda2d915107f060dd2ea88d7af3d79dbda17ba9c794d5e109ba780450ae32f1a9f0e0c8a639ddf9e2603cec75a49d9bf32a09ebec996854910b8b7f644ec06f399c70dc4da058e81ac5a04300a305f62096f123c0843783a71e7ef326348eefe6ba35c6b1f14d1c1a638353d39269fb0ddf5b89001588153a97182b5b5a5ced4021d510b11cf93f6c739b920d9657971a8546ce1b11779fe250d102a99ca0f8fcfedc71d67e57708994722a1c6e00890f43e2c539f01daff8a319aaa9049f7b0745856482835abbf7e757c0aa2ec4dd2416c6895ff7a2f42309012fde725e0edd6e944f0fabc3ca064724043ba574187803d9f22d898dc25b9452f329989fb98bf8b27c75648d53448430837534e3aa134b94b8b6329ce715c3104eb1b24cc3f15d0df46e9bfbc1d4712cf3e99024c0df4e1750400d610697fcf53b9cf42f24ee40ebcce7d716a92d660fe1c0ba3a16930a36461d74340f74f58d94dd882cc1661d8f016debb1a78c80ce0a471bbabc6baa8304902c6b4f5c44365b430cc507b19f17bfcfdca881e8b22f4bea2ee2425689d6a9feb40edf29a522881a59633135d0a791edf2aef3a485186042dae2c20d19a2f1349787dfca27dd73fa48f8b0f18151a8d8f0b8a75e42e29c3f4f3496b089855ab387e0ac50a9db6ebf437ae68b9349ffb803a281da331871ef37057a6fddef9e6a6d1d3f2e23d2275fc1f2a0561f88b303b1306988cde54987c57a5a7c08f09f65eba237e36b67d9bb04ad3cbc735c20c76c3e771aa797c3fa7e3fe41c8f26ce5ea92868cc676c425d839f556f6e8f5f36b4f3100936955d1eceaee1c7ee265a977874f64db7280646c34ebca0e28c624582b3867e29a2313b08970c89df83e17ccf2b70bc159c7e96ba8fbc04beb6067ac2f05bf896dd277fcf2b890bdfc6c89052bd68ee585a8f58fcf7e9e27d12ce685c7e3ad1d55527460755fcb66c30d73e2652de6b6c454f281966bb983a8e52aae2eb5f311210f38a0f9582aad487b53206ff28dc5af19646debf277ab5e33554ab09606a7bbf9c267eef7ea432123b8739e539076b98dafdc802c1f1c2b0638876b5b9d9f92b713346163371806d0d64a4e45479286d65df41e7990ba18e5681b3959ec41e9c557cccfcc90fd50feed6238214af3d6a61d357f7a351dfcf97574e7774bb4ac8b301cfcdac9aede66db2a27e7aff6d9e491316f62e556ab6e6e97b8fc09895e10c0a455a788932fcbb686c529e83fa0243bc36799ad62ebb29706c5277f43cf88c622feca0d1bb929bc7f423f18715d3a14de241b44bca29c0e202c04df46197abd93ec119ea041352df04078331058039c6528a257dd2e1acd18e78ff59fb18616651ef63d7f13e7826dc0f76b2e0dfcf6c265c4892e6c5f1e237bdf211b2b77e7f5538a1b8a10ebaa76d1305fe5ac04492240beee2b10308b51868b8741429f54b60e19a86ae5a8bb5ad1a52b178d48ee3d1547c545c7efe264c1fcde1363a296d419a75b5226bc65ad4dda41adeeddd583ceab1c6b4b0ec0aee6d3f347036cb424e22a8d8d731618a74c909eb56c6f95191ed9e099c93385b944850b58f34015df57685094fee898028fdd9da8d64ff9a88ffe46840671f13c5cb365ee8d059b479064723fc804ab562ba17831b458485cd9b2ff6bd8d08431a330042678c30d5749baa357a788ca337e573349c1acfdcc6041857ba85be7529871b0f48991ebf222ea5c734e4c54b8a5fe1299417dc18e51b85379479edf1d062f953cb39a83610ba037824e943c6383a1b7008028867a6c824689e5f3ae1da3c87b7d90f16bf09e5e17d0ee66f4dd390a17b439f300431fb9093a42f4ff64bd337598c9258cda80cdddb959bb11aec84693ddc8c0af69814c58b2cfc63b420d8bfbd1c8e36886f3e18ebc5526cd2b282f4092f0d9953b0c1bd6467173b2dddc2097a465ecbdc75165c78157f5c9c56552362fe376a516dd170b6ba81e981a058063fcec55d6921473452ff54c6fb4331a722fbb718f1822c9f58bbbfe978c834049093ade96877c509620564ed3ea78c4632b60c5f24914476e24d000e93c5318847148c5ab6d741c6138b32a6518f11846a3c7f7d44318bd9661db4220f3ba346689293b8a09354fd9d36ca9af8ffc51c4c45db1d66f6f71aa3c0015037d4f01ac7d091c5f59f1310957d0eea9c2f445ecb89452b409702afca9058e9aac7304cf33202382e233e5d298ba2d0ad9d340baf759a50c7ef8f5b2e03fbbb7b8903a3ced9ed612b62469f2aaca65cb7b9dc1a1616c4824fca649ae132dccf8be073a62f90b9fb5d1ee5765d2ee384451e6f0c99e867c64613067e9921b89839370af137c7f4ebed621889e82257109de8e8607ca7e471cabaa24a5a4272081bc555ff107d5b33c98c8524b19c20ef01824a0af95375994b3e8d89ee15d3ce1710cc717bba66debd70b50c8d653b02214bb5363a33c2f3170f70c3df9a61fe51502bf7549abca1fcaf635e56434c1ac9163d622bd85b3a2778f977d1fcacbbb46d7a288174c2947371770842b4ec0c170332171bac5af884ae25e346f0fb4cdecf7e57e509f6f2d153ae9ffcd65800522cfb98f34f88b1f2cbc51f52f648de450b6f3a6af75b6e22341187aabba2add518b1ad9d23c25dd2c0cf02b8e9a5da2d7700c0f7d5535faed59e0806a36aa8b0e378479a5ad6b92240a6b971b19eb7706ad3596c6cd58eaf7486fa6fb715adfec708383d11f1c81564cfada82dea9567159e80b085c49e5b28722c4563f8ab3d443b870e57b4d23771583a9c6fbde54cc32ee64487ef52bba77cf99466f474353c59b08b2c883014e0c0c79e2199ac417373bc216b574734d1233198a3d5431a08b7c6dd3234b069179ca71359f466eaa016533ad58b760f3dd15eec1844ff36457e2badea9b82e6f5475044ef5abf6fc59d24a25acd8777614279f74661012e1e42ed70c2c09c76c6484f9ed5719fe5666d079142a402b946f9a0224f5bc6772293c1a9d4cac9b1aa89de4efafadc0e2f28ffdaa454f755b13508291db16f82e36069c51827f874af1fc21de8d1678dffaf69fa83fbbb0c8d0f53adfb8305662cf14bc64358658b3a7302d89b71d6564f4331d003ee92e9889128d4fef65855fb9d6458f49f152033327015646d017868f7a337275f0cfa961afb9abb43354d63fcac2b83577a64d4746c446db76fee843a814b2f50923894140f62c3c94aa60a3494ce97bb7d9e2e67e2837536d36487c4b407a28f691a0392de8e097bb7a66cf39e61432fbb22a4d57522fa2b9c5f2019c93bd77290c63eed21437c38517830623cb146de3a93a4d7db9966a559b7f393a58b1fe7fdc2fc97f91fea353608c6ae5c979478c3b86ec4d007673b7ca5e7a7d393c9b9e4ca814731ab609221da49e95de80e6c634fc24cb534567dc6c6a67a7fe2ccc334b3a2711127b7b65dd70cd8c997a282aa9e64ce2bb6dcc806056323a4970ecd43b371e2b77e1545be215024372f5c6725eab4ec05db92a127239890454ca8ff8c03a51ffbe919317c0ec3156a61d4fc0316988859ed321bcc9e9b05a75688bb70bf00cbba343a675ca5bc9cd48f50472ced54ce8222576a663deeea58edac4a61d94a35188108d0b1c5f8d45ba717497ff0e2b60195c6bd9232a93acac412f9fed882faad41619a00c0c986d9d417e126d8ca893983961b8cd235a8d3c52a606bf36aa2ed02e17336e9d434096fd85c7219f5b7c006e3ab693012fdc45f0705c516ea35daab308f7a8e88890419c1bf00a8ae90c2de69681cb95d5308d8fbcb313944ef98346baf15eb3ebeb026e5392ed2dded0af1295958930c6059a8e1a6896cede9ac3104bd48bf8d30a4ec865ff4ac9892a04d1b90a0b25005016efef1db3f0224d40d0507f492e5cb0af02100daca9b75ef70c5ce2dfece4d8e3932c2f1bbee35ba893ea58dc997a130f4e3c3466f9db61da0012cbecb3fb5f1797d43949f94cf0a31acd10e352027d616cb389fb505080fd09e550a3be2fac7959f62533dfd6861c462a58d06a1bdd0e1f7b6885738f151d38604c20b1543996b57e73a9cadf71b1e5e284c6a1f1eddd5f8882cdd6828a3b24814f29890d12fcd4342ef53080e0ec405978e5acdf5ed665975f2b4428d192fecb75813412da3d0ea92f6db6c8266265966ccd882d898525043c6be9562a2fcedfa7b224b134dfaa5416ffd01de750e8cdd58bc4ce8b9344e3d00c23764e7477e016fa35470c33d0463bf2d43b0bf000149d6c585afb40014f87b734564586442d3774cc402b795eb7e704d20b525f4e5c</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Dydは、パスワードを入力するように求められます</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
            <tag> 差分 </tag>
            
            <tag> 支配树 </tag>
            
            <tag> dfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性基</title>
      <link href="/2021/11/28/%E7%BA%BF%E6%80%A7%E5%9F%BA/"/>
      <url>/2021/11/28/%E7%BA%BF%E6%80%A7%E5%9F%BA/</url>
      
        <content type="html"><![CDATA[<p> 一堆无意义的定义</p><span id="more"></span><h1 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h1><p>线性基是竞赛中常用来解决<strong>子集异或</strong>一类题目的算法</p><h2 id="数学相关定义"><a href="#数学相关定义" class="headerlink" title="数学相关定义"></a>数学相关定义</h2><p>一大堆没用的</p><h3 id="向量空间"><a href="#向量空间" class="headerlink" title="向量空间"></a>向量空间</h3><p>向量空间亦称线性空间，具体可见<a href="https://baike.baidu.com/item/%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4">百度百科</a>，反正简单来说，就是定义了加法和乘法的向量的集合（其实完全不一样，但我们只需要用到这么多）</p><h3 id="线性相关和线性无关"><a href="#线性相关和线性无关" class="headerlink" title="线性相关和线性无关"></a>线性相关和线性无关</h3><p>若 $V$ 是一个向量空间（集合），如果存在不全为零的系数数列 $c_1, c_2, …, c_n \in \mathbb{F}$ （ $\mathbb{F}$ 是<a href="https://baike.baidu.com/item/%E4%BB%A3%E6%95%B0%E6%95%B0%E5%9F%9F/9551710?fr=aladdin">代数域</a>），使得 $c_1 \vec{v_1} + c_2 \vec{v_2} + … +c_n \vec{v_n} = 0$ （即 $\exists \vec{v_j}$ 可以被除它本身外其它属于 $V$ 的向量表示出来），那么 $V$ 中的向量就叫做<strong>线性相关</strong>的，反之，则为<strong>线性无关</strong>的</p><h3 id="子空间"><a href="#子空间" class="headerlink" title="子空间"></a>子空间</h3><p>设 $W$ 为向量空间 $V$ 的一个非空子集，若 $W$ 在 $V$ 的加法及标量乘法下是封闭的，且零向量 $\vec{0} \in W$ ，就称 $W$ 为 $V$ 的<strong>线性子空间</strong>，简称<strong>子空间</strong></p><h3 id="扩张和生成集合"><a href="#扩张和生成集合" class="headerlink" title="扩张和生成集合"></a>扩张和生成集合</h3><p>给出一个向量集合 $B$ ，那么<strong>包含它</strong>的<strong>最小</strong>子空间 $W$ 就称为它的<strong>扩张</strong>（也叫<strong>张成</strong>），记作 $span(B)$ ，另外规定空集的扩张为 ${\vec{0}}$ </p><p>而 $B$ 也被叫做 $W$ 的<strong>生成集合</strong>（可以理解为通过 $B$ 中的元素可以将 $W$ 中的所有元素表示出来）</p><h3 id="基和维度"><a href="#基和维度" class="headerlink" title="基和维度"></a>基和维度</h3><p>给出一个向量集合 $B$ ，若 $B$ 是<strong>线性无关</strong>的，且 $B$ 能够生成 $V$ ，就称 $B$ 为 $V$ 的一个<strong>基</strong></p><p>对非零向量空间 $V$ ，基是 $V$ 最小的生成集，也是<a href="https://baike.baidu.com/item/%E6%9E%81%E5%A4%A7%E7%BA%BF%E6%80%A7%E6%97%A0%E5%85%B3%E7%BB%84">极大线性无关组</a></p><p>如果一个向量空间 $V$ 拥有一个元素个数<strong>有限</strong>的生成集，那么就称 $V$ 是一个<strong>有限维空间</strong>，向量空间的所有基拥有<strong>相同基数</strong>，称为该空间的<a href="https://baike.baidu.com/item/%E7%BB%B4%E5%BA%A6">维度</a></p><p>空间内的每个向量都有唯一的方法表达成基中向量的<a href="https://baike.baidu.com/item/%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88">线性组合</a>，而且，将基中向量进行排列，表示成有序基，每个向量便可以坐标系统来表示</p><h2 id="线性基-1"><a href="#线性基-1" class="headerlink" title="线性基"></a>线性基</h2><p>扯了那么多没有用的，下面才是真的要用的</p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>线性基其实就是上面数学定义中，将向量空间的加法和乘法定义为<strong>异或</strong>的意义下的基，具体来说，在异或的定义下：</p><ul><li>用<strong>无符号整数集</strong>来替代<strong>向量的集合</strong></li><li>对于集合 $B$ ，在其中选出任意多个数，其异或和的所有可能的结果组成的集合 $S$ 称作 $B$ 的<strong>扩张</strong>，记为 $span(B)$ </li><li>对于一个集合 $B$ ，若存在一个元素可以用其它若干个元素异或起来得到，则称 $B$ 中元素<strong>线性相关</strong>，反之，则为<strong>线性无关</strong></li><li>对于集合 $B, S$ ，若 $S \subseteq span(B)$ 且 $B$ 线性无关，则称 $B$ 为 $S$ 的<strong>线性基</strong>，集合 $B$ 中元素的个数，称为线性基的<strong>长度</strong></li></ul><p>个人觉得对照这数学中的定义还是比较好理解的</p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>若 $B$ 是 $S$ 的线性基，则 $S$ 中的任意元素都可以<strong>唯一</strong>表示为 $B$ 中若干个元素异或起来的结果，正确性显然</p><h3 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h3><p>设 $S$ 中最大的数在二进制下有 $L$ 为，我们用一个下标为 $0 \sim L$ 的数组 $a[]$ 来存储线性基，在接下来的构造中，我们称第 $i$ 位<strong>存在于</strong>线性基中，当且仅当 $a[i] \ne 0$</p><p>首先，线性基是动态构造的，我们只需要从空的，每次考虑在一个已存在的线性基中插入一个数 $t$ 即可</p><p>从 $t$ 最高位上的1开始考虑，设这是第 $j$ 位，如果这一位已经存在于线性基中，则我们需要将 $t$ 中的这一位消掉（将 $t$ 异或上 $a[i]$ ），才可以继续插入（因为要保证 $B$ 线性无关）；如果这一位不存在于线性基中，则可以将  插入到 $a[j]$ 的位置上</p><p>对于具体实现，我们采用逆序枚举 $t$ 所以为1的二进制位 $j$ ，对于每个 $j$ ：</p><ol><li>若 $a[j] \ne 0$ ，则 $t = t \oplus a[j]$ </li><li>若 $a[j] = 0$ ，则 $a[i] = t$ ，结束</li></ol><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>线性基支持一下操作：</p><ul><li><p>求集合的最大异或和：</p><p>只需倒序枚举每一个 $a[i]$ ，贪心异或即可</p></li><li><p>求集合的最小异或和：</p><p>先特判能否为0，然后正序序枚举每一个 $a[i]$ ，第一个存在的就是答案</p></li><li><p>查询 $t$ 是否在值域中</p><p>类似于插入</p></li><li><p>查询第 $k$ 小的值</p><p>先特判减去0，然后从高到低处理线性基每一位，对于每一位向后扫，如果当前数第 $i$ 位为0，且线性基第 $i$ 位不为0，则将当前数异或上 $a[i]$ ，这一操作可以在 $O(L^2)$ 的时间内解决，我们称其为重构<br>经过这一步操作后，设线性基内共有 $cnt$ 个数，则它们共可以表示出 $2^{cnt}$ 个数<br>随后，我们考虑将 $k$ 二进制拆分，用与快速幂类似的方法就可以求出第 $k$ 小值</p></li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>一定要注意long long</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">64</span>; <span class="comment">//这个N一定要开对，大了小了都不行</span></span><br><span class="line">LL a[N], tmp[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">a[i] = tmp[i] = <span class="number">0</span>;</span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line"><span class="keyword">if</span> ((x &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!a[i])</span><br><span class="line">&#123;</span><br><span class="line">a[i] = x;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">x ^= a[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_max</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">res = <span class="built_in">max</span>(res ^ a[i], res);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_min</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> _c = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line"><span class="keyword">if</span> (a[i])</span><br><span class="line">++_c;</span><br><span class="line"><span class="keyword">if</span> (_c &lt; n)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line"><span class="keyword">if</span> (a[i])</span><br><span class="line"><span class="keyword">return</span> a[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> ((x &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">if</span> (!a[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">x^=a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">()</span> <span class="comment">//重构线性基</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)</span><br><span class="line"><span class="keyword">if</span> ((a[i] &gt;&gt; j) &amp; <span class="number">1</span>)</span><br><span class="line">a[i] ^= a[j];</span><br><span class="line"><span class="keyword">if</span> (a[i])</span><br><span class="line">tmp[cnt++] = a[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; ++i)</span><br><span class="line">a[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_k</span><span class="params">(LL k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (cnt &lt; n)</span><br><span class="line">--k;</span><br><span class="line">    <span class="keyword">if</span>(!k)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (k &gt;= (<span class="number">1ll</span> &lt;&lt; cnt))</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; ++i)</span><br><span class="line">    <span class="keyword">if</span> ((k &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">    res ^= a[i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还有一个用vector实现，比较短的（太香了）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line">vector&lt;LL&gt; b;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (LL i : b)</span><br><span class="line">x = <span class="built_in">min</span>(x ^ i, x);</span><br><span class="line"><span class="keyword">for</span> (LL &amp;i : b)</span><br><span class="line">i = <span class="built_in">min</span>(x ^ i, i);</span><br><span class="line"><span class="keyword">if</span> (x)</span><br><span class="line">b.<span class="built_in">push_back</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_max</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (LL i : b)</span><br><span class="line">res = <span class="built_in">max</span>(res ^ i, res);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_min</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (b.<span class="built_in">size</span>() &lt; n)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> b[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (LL i : b)</span><br><span class="line">x = <span class="built_in">min</span>(x ^ i, x);</span><br><span class="line">    <span class="keyword">return</span> x == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_k</span><span class="params">(LL k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (b.<span class="built_in">size</span>() &lt; n) <span class="comment">//减去为0的情况</span></span><br><span class="line">    --k;</span><br><span class="line">    <span class="keyword">for</span> (LL i : b)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span> (k &amp; <span class="number">1</span>)</span><br><span class="line">    res ^= i;</span><br><span class="line">    k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 线性基 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>斯特林数</title>
      <link href="/2021/11/28/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/"/>
      <url>/2021/11/28/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p> 还是卡特兰数简单一点……</p><span id="more"></span><h1 id="斯特林数"><a href="#斯特林数" class="headerlink" title="斯特林数"></a>斯特林数</h1><h2 id="第一类斯特林数"><a href="#第一类斯特林数" class="headerlink" title="第一类斯特林数"></a>第一类斯特林数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>第一类斯特林数（Stirling）分为无符号第一类斯特林数 $s_s(n, m)$ 和带符号第一类斯特林数 $s_u(n, m)$ ，有无符号斯特林数分别表现为其升阶函数和降阶函数的各项系数（<del>反正我是没看懂</del>），形式如下：<br>$$<br>\begin{aligned}<br>x^{n\uparrow} = x(x + 1)(x + 2)…(x + n - 1) = \sum_{k = 0}^{n}s_u(n, k)x^k\\<br>x^{n\downarrow} = x(x - 1)(x - 2)…(x - n  + 1) = \sum_{k = 0}^{n}s_s(n, k)x^k\\<br>\end{aligned}<br>$$<br>对于有无符号斯特林数之间的关系有 $s_s(n, m) = (-1)^{n + m}s_u(n, m)$</p><p>组合数学中的第一类斯特林数一般指无符号的第一类斯特林数，以下的“第一类斯特林数”若无特殊说明，也指“无符号的第一类斯特林数”，无符号的第一类斯特林数还有一个组合数学上的定义，为： $n$ 个不同元素构成 $m$ 个圆排列（两个圆排列间没有顺序之分）的方案数，记作 $s(n, m)$ 或 ${n \brack m}$ </p><h3 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h3><p>第一类斯特林数有一个递推式：<br>$$<br>{n \brack m} = {n - 1 \brack m - 1} + (n - 1){n - 1 \brack m}<br>$$<br>证明：</p><p>考虑第一类斯特林数的定义，${n \brack m}$ 表示把 $n$ 个不同元素构成 $m$ 个圆排列的方案数，对于第 $n$ 个数，若它单独成为新的一个圆，则它前面的 $n - 1$ 个数构成了 $m - 1$ 个圆，方案数为 ${n - 1 \brack m - 1}$ ；若它加入到前面构成的圆中，则它前面的 $n - 1$ 个数构成了 $m$ 个圆，方案数为 ${n - 1 \brack m}$ ，而这 $n - 1$ 个数间有 $n - 1$ 空位可以选择，共 $(n - 1){n - 1 \brack m}$  种方案</p><p>两种情况综合，即得递推式</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> s[N][N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">s[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">s[i][j] = (s[i - <span class="number">1</span>][j - <span class="number">1</span>] + (LL)(i - <span class="number">1</span>) * s[i - <span class="number">1</span>][j]) % P;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, s[n][m]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><ul><li> ${0 \brack 0} = 1$ </li><li> ${n \brack 0} = 0$ </li><li> ${n \brack n} = 1$ </li></ul><p>以上三条由定义不难得到</p><ul><li><p>  ${n \brack 1} = (n - 1)!$ </p></li><li><p> ${n \brack n - 1} = \binom{n}{2}$ </p></li></ul><p>  证明：</p><p>  依然考虑定义，$n$ 个不同元素构成 $n - 1$ 个圆排列，必然有一个圆排列有两个数，其它圆排列只有一个数，有两个数的圆排列有 $\binom{n}{2}$ 种方案，对应其它都只有一种方案</p><ul><li> $\sum_{k = 0}^{n} {n \brack k} = n!$ </li></ul><p>  证明：</p><p>  令升阶函数中的 $x = 1$ ，即得原式</p><h2 id="第二类斯特林数"><a href="#第二类斯特林数" class="headerlink" title="第二类斯特林数"></a>第二类斯特林数</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>第二类斯特林数实际上是集合的一个拆分，表示将 $n$ 个不同的元素划分成 $m$ 个集合（两个集合间没有顺序之分）的方案数，记为 $S(n, m)$ 或 ${n \brace m}$ ，和第一类斯特林数不同的是，集合内是不考虑次序的，而圆排列是有序的</p><h3 id="求法-1"><a href="#求法-1" class="headerlink" title="求法"></a>求法</h3><p>递推式：<br>$$<br>{n \brace m} = {n - 1 \brace m - 1} + m {n - 1 \brace m}<br>$$<br>还是考虑定义，将 $n$ 个不同的元素划分成 $m$ 个集合，对于第 $n$ 个数，可以单独为一个集合，则前面 $n - 1$ 个数构成 $m - 1$ 个集合，方案数为 ${n - 1 \brace m - 1}$ ；也可以加入到原有集合中，则前面 $n - 1$ 个数构成 $m$ 个集合，方案数为 ${n - 1 \brace m}$ ，而第 $n$ 个数在 $m$ 个集合中选一个加入，方案数为 $m$ </p><p>两种情况综合，即得递推式</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> S[N][N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">S[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j)</span><br><span class="line">S[i][j] = (S[i - <span class="number">1</span>][j - <span class="number">1</span>] + (LL)j * S[i - <span class="number">1</span>][j]) % P;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, S[n][m]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>计算式：<br>$$<br>{n \brace m} = \frac{1}{m!} \sum_{k = 0}^{m} (-1)^k \binom{m}{k} (m - k)^n<br>$$<br>证明见<a href="https://baike.baidu.com/item/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0">百度百科</a></p><h3 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h3><ul><li> ${n \brace 0} = 0^n$ </li><li> ${n \brace 1} = 1$ </li><li> ${n \brace n} = 1$ </li><li> ${n \brace 2} = 2^{n - 1} - 1$ </li><li> ${n \brace n - 1} = \binom{n}{2}$ </li><li> $\sum_{k = 0}^{n} {n \brace k} = B_n$ ，其中 $B_n$ 是<a href="https://baike.baidu.com/item/%E5%80%8D%E5%B0%94%E6%95%B0/369479?fromtitle=%E8%B4%9D%E5%B0%94%E6%95%B0&fromid=9227873">贝尔数</a>  </li></ul><h2 id="两类斯特林数的关系"><a href="#两类斯特林数的关系" class="headerlink" title="两类斯特林数的关系"></a>两类斯特林数的关系</h2><p>其实就一个：<br>$$<br>\sum_{k = 0}^{n} {n \brace k}{k \brack m} = \sum_{k = 0}^{n} {n \brack k}{k \brace m}<br>$$</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P4609">建筑师</a></p><p>以高度为 $n$ 的建筑为分界线，左边选择 $A - 1$ 个建筑让他们可以被看见，右边 $B - 1$ 个，如图：</p><p><img src="https://i.loli.net/2021/11/28/lhKaJEux2kpqHmW.jpg" alt="AB"></p><p>问题转化为将 $1 \sim n - 1$ 划分为 $A + B - 2$ 部分（即红框里的），对于每一个部分，将其中元素排成一个圆排列，放置时保证最高的在最左边（如果是放在 $n$ 右边，则最高的在最右边），故有 ${n \brack m}$ 种方案</p><p>然后将这些部分划分给  $n$ 两边，有 $\binom{A + B - 2}{A - 1}$ 种方案</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, P = <span class="number">1e9</span> + <span class="number">7</span>, M = <span class="number">200</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> s[N][M], C[M][M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pred</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">s[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; M; ++j)</span><br><span class="line">s[i][j] = (s[i - <span class="number">1</span>][j - <span class="number">1</span>] + (LL)(i - <span class="number">1</span>) * s[i - <span class="number">1</span>][j]) % P;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j)</span><br><span class="line"><span class="keyword">if</span> (!j)</span><br><span class="line">C[i][j] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">C[i][j] = (C[i - <span class="number">1</span>][j] + C[i - <span class="number">1</span>][j - <span class="number">1</span>]) % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">pred</span>();</span><br><span class="line"><span class="keyword">int</span> T, n, a, b;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line"><span class="keyword">while</span> (T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;a, &amp;b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (LL)s[n - <span class="number">1</span>][a + b - <span class="number">2</span>] * C[a + b - <span class="number">2</span>][a - <span class="number">1</span>] % P);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> Stirling数,斯特林数 </tag>
            
            <tag> 排列组合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP4429 [BJOI2018]染色</title>
      <link href="/2021/11/28/luoguP4429-BJOI2018-%E6%9F%93%E8%89%B2/"/>
      <url>/2021/11/28/luoguP4429-BJOI2018-%E6%9F%93%E8%89%B2/</url>
      
        <content type="html"><![CDATA[<p> 结论题，靠手玩</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P4429">染色</a></p><p>拿到题就先被吓了一跳，然后又看了看数据范围，毫无提示性</p><p>先盲猜一手考的二分图，也就是每个点的颜色集合都相同，然后……<del>理所当然的</del> 错了，但还是给了我们一点希望，因为我们发现明显，存在奇环就是No</p><p>那就还有不存在环和存在偶环两种情况</p><p>不存在环，即 $m &lt; n$ ，考虑节点 $u$ 染为颜色 $A$ ，那么与它相连的节点 $v$ 最多只是有一个颜色不能染，此外便再无其它限制，明显是有染色方案的，故为Yes</p><p>再考虑偶环的情况，若只有一个偶环，即 $n = m$ ，我们将其断开，记断开处两个节点为根节点和尾节点，从根节点开始用无环的方法染色，设根节的颜色集合为 ${A, B}$ ，分三种情况：</p><ol><li>若尾节点的颜色集合为 ${C, D}$ ，则染色成立</li><li>若尾节点的颜色集合为 ${A, C}$ ，只要根节点染为颜色 $B$ 即可</li><li>若尾节点的颜色集合为 ${A, B}$ ，设根节点染为颜色 $A$ 如果要让尾节点也必须染颜色 $A$ 则与尾节点相连的另一个点必须染为颜色 $B$ ，以此类推，每个节点的颜色都是“必须染成颜色 $X$ ”，设于根节点相连的另一个点的颜色是必须染成颜色 $E$ （这个 $E$ 可以等于于任何颜色，包括 $A, B$ ），由于这个“必须”，该节点的颜色集合一定是 ${A, E}$ （这样才能用“根节点染成颜色 $A$ ”推出“该节点染成颜色 $E$ ”），那么只要将根节点染成颜色 $B$ ，该节点染成颜色 $E$ ，由于刚才的一系列“必须”，尾节点只能保持颜色 $A$ 不变，染色成立</li></ol><p>综上，若只有一个偶环，必定可以染色，故为Yes</p><p>那有多个偶环，即 $m &gt; n$ ，怎么办？</p><p>先考虑两个偶环没有公共边，看看下图：</p><p><img src="https://i.loli.net/2021/11/28/41UTVmnNBcKjADr.png" alt="偶环"></p><p>不难发现在这种构造下，最下方的点只能选颜色 $X$ </p><p>于是有下图：</p><p><img src="https://i.loli.net/2021/11/28/OhjP4dcNZMFwrt8.png" alt="卡"></p><p>明显为No</p><p>推广一下，考虑把节点 ${C, D}$ 拆成多个节点相连，换句话说，用多个节点连成的链作为广义的“交叉节点”，我们 <del>玄学的</del> 得出了结论：如果存在两个没有公共边但联通的环，那么答案是No，构造方法类似上图，可以证明（<del>我也不知道咋证</del>）这种情况的充分条件为 $m &gt; n + 1$ </p><p>最后只剩一种情况： $m = n + 1$ 且为偶环</p><p>这种情况下，要么有一个点度数为4，要么有两个点度数为3，度数为四的情况就和上图一样，明显为No</p><p>考虑两个度数为3的点，它们之间必定有3条路径，设路径长度（经过的边数）分别为 $(x, y, z)$ ，<del>手玩一下</del> 发现只有 $(2, 2, 2k), k\in \mathbb{N_+}$ 的情况为Yes</p><hr><p>最后总结一下：</p><ol><li> $m &lt; n$ 为Yes</li><li> $m = n$ 且无奇环为Yes，否则为No</li><li> $m = n + 1$ 且无奇环，若有两个度为3的节点且两点间路径为 $(2, 2, 2k), k\in \mathbb{N_+}$ 则为Yes，否则为No；若有奇环为No</li><li> $m &gt; n + 1$ 为No</li></ol><p>注意以上结论均是在保证图联通的情况下得出</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> VIT vector<span class="meta-string">&lt;int&gt;</span>::iterator</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, e, v;</span><br><span class="line"><span class="keyword">int</span> c[N], du[N];</span><br><span class="line"><span class="keyword">bool</span> f; <span class="comment">//true-No,false-Yes</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[N], cir;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">to[i].<span class="built_in">clear</span>(), c[i] = <span class="number">0</span>;</span><br><span class="line">f = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> _c)</span> <span class="comment">//染色法判奇环</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (f)</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">if</span> (c[x])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[x] != _c)</span><br><span class="line">f = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">c[x] = _c;</span><br><span class="line">++v;</span><br><span class="line">e += to[x].<span class="built_in">size</span>();</span><br><span class="line">cir.<span class="built_in">push_back</span>(x);</span><br><span class="line"><span class="keyword">for</span> (VIT i = to[x].<span class="built_in">begin</span>(); i != to[x].<span class="built_in">end</span>(); ++i)</span><br><span class="line"><span class="built_in">dfs</span>(*i, <span class="number">3</span> - _c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topu</span><span class="params">()</span> <span class="comment">//拓扑处理非环节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">for</span> (VIT i = cir.<span class="built_in">begin</span>(); i != cir.<span class="built_in">end</span>(); ++i)</span><br><span class="line">&#123;</span><br><span class="line">du[*i] = to[*i].<span class="built_in">size</span>();</span><br><span class="line"><span class="keyword">if</span> (du[*i] == <span class="number">1</span>)</span><br><span class="line">q.<span class="built_in">push</span>(*i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span> (VIT i = to[x].<span class="built_in">begin</span>(); i != to[x].<span class="built_in">end</span>(); ++i)</span><br><span class="line"><span class="keyword">if</span>(--du[*i] == <span class="number">1</span>)</span><br><span class="line">q.<span class="built_in">push</span>(*i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> T, t, tt;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line"><span class="keyword">while</span> (T--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"><span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt;= m; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">to[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">to[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (!c[i])</span><br><span class="line">&#123;</span><br><span class="line">e = v = <span class="number">0</span>;</span><br><span class="line">cir.<span class="built_in">clear</span>();</span><br><span class="line"><span class="built_in">dfs</span>(i, <span class="number">1</span>);</span><br><span class="line">e /= <span class="number">2</span>; <span class="comment">//存的是双向边,真正的边数要除以2</span></span><br><span class="line"><span class="keyword">if</span> (e &gt; v + <span class="number">1</span>)</span><br><span class="line">f = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span> (f)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (e &lt;= v)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">topu</span>();</span><br><span class="line">tt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (VIT j = cir.<span class="built_in">begin</span>(); j != cir.<span class="built_in">end</span>(); ++j)</span><br><span class="line"><span class="keyword">if</span> (du[*j] == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (VIT k = to[*j].<span class="built_in">begin</span>(); k != to[*j].<span class="built_in">end</span>(); ++k)</span><br><span class="line"><span class="keyword">if</span> (du[*k] == <span class="number">3</span>)</span><br><span class="line">++t;</span><br><span class="line"><span class="keyword">if</span> (t == <span class="number">2</span>)</span><br><span class="line">++tt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (tt &lt; <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">f = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (f)</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 结论 </tag>
            
            <tag> OI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP2723 [USACO3.1]丑数 Humble Numbers</title>
      <link href="/2021/11/28/luoguP2723-USACO3-1-%E4%B8%91%E6%95%B0-Humble-Numbers/"/>
      <url>/2021/11/28/luoguP2723-USACO3-1-%E4%B8%91%E6%95%B0-Humble-Numbers/</url>
      
        <content type="html"><![CDATA[<p> 时间复杂度的计算是个技术活</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P2723">丑数</a></p><p>第一次想到的是用一个小根堆，每次取出最小值，乘其它数的积插入堆中，最后取出的第 $n$ 个就是答案，然鹅，时间（ $O(n^2\log n)$ ）和空间（ $O(n^2)$ ）上都不允许（ $n \le 10^5$ 太艹了）</p><p>然后发现其实真正有用的跟新只有 $f[i] * a[i]$ 的形式，其中 $f[i]$ 表示第 $i$ 个丑数， $a[i]$ 表示质数，由于 $k$ 很小，用平衡树维护貌似可做？（<del>黄题啊，平衡树个寂寞啊</del>）</p><p>最后实在 <del>不想打平衡树</del> 想不出来，一看题解：艹，暴力求第 $n$ 个就好了，加个记录的优化，时间复杂度 $O(nk \xi)$ ，其中 $\xi$ 代表玄学因子（因为没人知道那层while会跑多少），空间复杂度 $O(n)$ </p><p>无语，这个故事告诉我们不要一看见 $10^5$ 就想 $n\log n$  </p><p>似乎要long long</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, K = <span class="number">100</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL INF = (LL)<span class="number">1e18</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> k, n;</span><br><span class="line">LL f[N];</span><br><span class="line"><span class="keyword">int</span> a[N], b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;k, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line"><span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + k);</span><br><span class="line">f[<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">//有只有一个质因数的情况,所以从1开始</span></span><br><span class="line">LL mn;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">mn = INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= k; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这里是一个优化(不加会TLE),用b记录每个质数对应的最小的f[i]</span></span><br><span class="line"><span class="comment">下一次的i只会更大而不会更小</span></span><br><span class="line"><span class="comment">当然,也可以写二分查找f[i],时间复杂度更稳定一点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">while</span> (f[b[j]] * a[j] &lt;= f[i - <span class="number">1</span>])</span><br><span class="line">++b[j];</span><br><span class="line">mn = <span class="built_in">min</span>(f[b[j]] * a[j], mn);</span><br><span class="line">&#125;</span><br><span class="line">f[i] = mn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, f[n]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> USACO </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 枚举 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP2991 [USACO10OPEN]Water Slides G</title>
      <link href="/2021/11/26/luoguP2991-USACO10OPEN-Water-Slides-G/"/>
      <url>/2021/11/26/luoguP2991-USACO10OPEN-Water-Slides-G/</url>
      
        <content type="html"><![CDATA[<p> 题目描述过于“清晰”</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P2991">Water Slides G</a></p><p>最开始理解错了，以为是一个搜索，大概是预处理出每个点到终点的最长路，然后bfs，每个状态由位置、失误次数、权值和组成，不会TLE</p><p>但其实题目要求中失误是走“最坏的”，而不失误是走“最好的”；我理解的失误是走“除最好的以外的节点”（<del>太nm离谱了</del>）</p><p>再看原题，发现只有两种选择（最好的和最坏的），在暴搜的基础上加一个记忆化，令 $f[i][j]$ 表示从 $i$ 走到 $n$ 失误 $j$ 条边的情况下最大权值和，明显有 $f[n][0] = 0$ ， $Ans = f[1][k]$ ，由于是在一个DAG上，在搜索时转移，方程为<br>$$<br>f[u][j] =<br>\begin{cases}<br>    \min(f[v][j - 1] + w_{u,v})\\<br>    \max(f[v][j] + w_{u,v})<br>\end{cases}<br>$$<br>最后，记得开long long</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, M = <span class="number">1.5e5</span> + <span class="number">5</span>, K = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line">LL f[N][K];</span><br><span class="line"><span class="keyword">bool</span> vis[N][K];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver;</span><br><span class="line">LL w;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="keyword">int</span> h[N], idx;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, LL z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (vis[x][j])</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="built_in">dp</span>(y, j);</span><br><span class="line">f[x][j] = <span class="built_in">max</span>(f[y][j] + e[i].w, f[x][j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (j)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="built_in">dp</span>(y, j - <span class="number">1</span>);</span><br><span class="line">f[x][j] = <span class="built_in">min</span>(f[y][j - <span class="number">1</span>] + e[i].w, f[x][j]);</span><br><span class="line">&#125;</span><br><span class="line">vis[x][j] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> u, v;</span><br><span class="line">LL w;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(u, v, w);</span><br><span class="line">&#125;</span><br><span class="line">f[n][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">vis[n][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">dp</span>(<span class="number">1</span>, k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, f[<span class="number">1</span>][k]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> USACO </tag>
            
            <tag> dp </tag>
            
            <tag> 记忆化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luoguP5091 【模板】扩展欧拉定理</title>
      <link href="/2021/11/26/luoguP5091-%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E6%89%A9%E5%B1%95%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86/"/>
      <url>/2021/11/26/luoguP5091-%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E6%89%A9%E5%B1%95%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p> 我太弱了</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/P5091">【模板】扩展欧拉定理</a></p><p>本来以为可以秒杀的（<del>毕竟是板子</del>），但遗忘的比我想象的严重，主要是当 $b &lt; \varphi(m)$ 时，不能让 $b = (b \mod \varphi(m)) + \varphi(m)$ 这个特判改了 ${\color{red} \text{三次}}$ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> a, m, phi, p;</span><br><span class="line"><span class="keyword">char</span> b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">res = (LL)res * x % p;</span><br><span class="line">x = (LL)x * x % p;</span><br><span class="line">y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%s&quot;</span>, &amp;a, &amp;m, b + <span class="number">1</span>);</span><br><span class="line">phi = p = m;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, j; i &lt;= m; ++i)</span><br><span class="line"><span class="keyword">if</span> (m % i == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">phi = (LL)phi * (i - <span class="number">1</span>) / i;</span><br><span class="line"><span class="keyword">while</span> (m % i == <span class="number">0</span>)</span><br><span class="line">m /= i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n = <span class="built_in">strlen</span>(b + <span class="number">1</span>), bb = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= <span class="number">8</span>) <span class="comment">//特判</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">bb = bb * <span class="number">10</span> + b[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (bb &gt;= phi)</span><br><span class="line">bb = bb % phi + phi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">bb = (bb * <span class="number">10</span> + b[i] - <span class="string">&#x27;0&#x27;</span>) % phi;</span><br><span class="line">bb += phi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, <span class="built_in">qpow</span>(a, bb));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 练习 </tag>
            
            <tag> 模板 </tag>
            
            <tag> 扩展欧拉定理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生成函数</title>
      <link href="/2021/11/24/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
      <url>/2021/11/24/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>too difficult for me</p><span id="more"></span><h1 id="生成函数"><a href="#生成函数" class="headerlink" title="生成函数"></a>生成函数</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>任给我们一个序列 ${ a_i } ( i \in [ 0, n ] )$ ，可以定义一个函数 $g(x) = a_0 + a_1x + a_2x^2 + … + a_nx^n$ （一般为了使函数可以收敛，定义 $x \in ( -1, 1 )$ ），则称 $g(x)$ 为序列 ${ a_i }$ 的生成函数</p><p>我们将序列转化为函数的原因是为了用函数的知识（一般是数学知识，数学不好的慎用）使问题变的简单</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.acwing.com/problem/content/3135/">食物</a></p><p>本题是一个常用的转换，即将乘法原理转化为多项式的乘法，具体如下：</p><p>先将每一种食物当作一个子问题，如，对于食物1 ，定义序列 ${ a_i }$  为只选食物1能够选出 $i$ 个食物的方案数，由于食物以只能选偶数个，故 ${ a_i } = { 1,0,1,0,1…}$ ，定义其生成函数为 $f_1(x) = 1 + x^2 + x^4 + x^6 + … (x \in (-1, 1))$ 由等比数列求和公式有 $f_1(x) = \frac{1 - x^n}{1 - x^2}$ ，又因为 $n \rightarrow \infty$ ，所以 $x^n \rightarrow 0$ ，则 $f_1(x) = \frac{1}{1 - x^2}$ </p><p>同理，有：<br>$$<br>\begin{align}<br>f_2(x) &amp;= 1 + x = \frac{1 - x^2}{1 - x}\\<br>f_3(x) &amp;= 1 + x + x^2 = \frac{1 - x^3}{1 - x}\\<br>f_4(x) &amp;= x + x^3 + x^5 + … = \frac{x}{1 - x^2}\\<br>f_6(x) &amp;= 1 + x^4 + x^8 + … = \frac{1}{1 - x^4}\\<br>f_6(x) &amp;= 1 + x + x^2 + x^3 = \frac{1 - x^4}{1 - x}\\<br>f_7(x) &amp;= 1 + x = \frac{1 - x^2}{1 - x}\\<br>f_8(x) &amp;= 1 + x^3 + x^6 + x^9 = \frac{1}{1 - x^3}\\<br>\end{align}<br>$$<br> 设 $Ans(x) = \prod_{i = 1}^{8} f_i(x)$ ，则答案即为 $Ans(x)$ 展开后 $x^n$ 项的系数，证明可以考虑乘法原理，每一个多项式 $f_i(x)$ 中选一项 $ai_jx^j$ ，代表用第 $i$ 种食物凑成 $j$ 个的方案数有 $ai<br><em>j$ 种，乘起来方案共有 $\prod</em>{i = 1}^{8} ai_j$ 种，这些方案共献到 $x^{\sum j}$ 中，最后 $x^n$ 的系数就是最终方案数，正确性显然</p><p>现在考虑如何求系数<br>$$<br>\begin{align}<br>Ans &amp;= \prod_{i = 1}^{8} f_i(x)\\<br>    &amp;= \frac{1 - x^2}{1 - x} \frac{1 - x^3}{1 - x} \frac{x}{1 - x^2} \frac{1}{1 - x^4} \frac{1 - x^4}{1 - x} \frac{1 - x^2}{1 - x} \frac{1}{1 - x^3}\\<br>    &amp;= \frac{x}{(1 - x)^4}\\<br>    &amp;= x (1 - x)^{-4}\\<br>\text{又由} &amp;\text{牛顿广义二项式定理（广义二项式定理）：}\\<br>(x + y)^\alpha &amp;= \sum_{k = 0}^{\infty} \binom{\alpha}{k} x^{\alpha - k} y^k , \text{其中} \binom{\alpha}{k} = \frac{\alpha (\alpha - 1) (\alpha - 2) … (\alpha - k + 1)}{k!} , (\alpha \in \mathbb{R})\\<br>\text{有：} &amp; \\<br>(1 - x)^{-4} &amp;= \sum_{k = 0}^{\infty} \binom{-4}{k} 1^{-4 - k} (-x)^{k}\\<br>\text{又因} &amp;\binom{-k}{n} * (-x)^n = [(-1)^n * \binom{n+k-1}{n}] * [(-1)^n * x^n] = \binom{n+k-1}{n} x^n\\<br>\text{故} &amp; (1 - x)^4 \text{展开后} x^n \text系数为 \binom{n+k-1}{n}\\<br>\text{所以}\\<br>Ans &amp;= x (1 - x)^{-4}\\<br>    &amp;= x (\sum_{n = 0}^{\infty} \binom{n + 4 - 1}{4 - 1} x^n)\\<br>    &amp;= \sum_{n = 0}^{\infty} \binom{n + 4 - 1}{4 - 1} x^{n + 1}\\<br>\end{align}<br>$$</p><p>由上， $x^n$ 项的系数为 $\binom{n + 2}{3} = \frac{(n + 2)(n + 1)n}{6}$ ，问题得以解决</p><p> 代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span>, P = <span class="number">10007</span>;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, l = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; ++i)</span><br><span class="line">n = (n * <span class="number">10</span> + s[i] - <span class="string">&#x27;0&#x27;</span>) % P;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (LL)n * (n + <span class="number">1</span>) * (n + <span class="number">2</span>) / <span class="number">6</span> % P); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 生成函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>斜率优化dp</title>
      <link href="/2021/11/22/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96dp/"/>
      <url>/2021/11/22/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96dp/</url>
      
        <content type="html"><![CDATA[<p>然而我dp废的一比</p><span id="more"></span><p>用例题开讲：<br><a href="https://www.luogu.com.cn/problem/P2365">P2365 任务安排</a><br>明显<del>看题解</del>可知，dp方程为：<br> $f_i=min(f_j+sumt_i*(sumc_i-sumc_j)+s*(sumc_n-sunc_j),f_i)$<br> 故标程如下：</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P2365</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> t, c;</span><br><span class="line">&#125; sum[N];</span><br><span class="line"><span class="keyword">int</span> n, s;</span><br><span class="line"><span class="keyword">int</span> f[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> t, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;t, &amp;c);</span><br><span class="line">        sum[i].t = sum[i - <span class="number">1</span>].t + t;</span><br><span class="line">        sum[i].c = sum[i - <span class="number">1</span>].c + c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j)</span><br><span class="line">            f[i] = <span class="built_in">min</span>(f[i], f[j] + sum[i].t * (sum[i].c - sum[j].c) + s * (sum[n].c - sum[j].c));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么，康康这个——<a href="https://www.luogu.com.cn/problem/P5785">P5785 SDOI2012任务安排</a><br>令人惋惜的是，在数据加强后， $O(n^2)$ 的时间复杂度似乎确凿过不了，为此，我们<del>看题解后</del>想到救星——</p><h2 id="斜率优化"><a href="#斜率优化" class="headerlink" title="斜率优化"></a>斜率优化</h2><p>我们先假设所有的 $t$ 都大于0。<br>我们来康康转移方程：<br>$f_i=min(f_j+sumt_i*(sumc_i-sumc_j)+s*(sumc_n-sunc_j),f_i)$<br>不妨去掉 $min$ 看成：<br>$f_i=f_j+sumt_i*(sumc_i-sumc_j)+s*(sumc_n-sunc_j)$<br>它等价于：<br>$f_i=f_j-(sumt_i+s) * sumc_j+sumt_i* sumc_i+s* sumc_n$<br>设 $f_j=y,sumc_j=x$ （这是所有的关于 $j$ 的变量），然后化为直线表达式 $y=kx+b$ 的形式：<br>$f_j=(sumt_i+s)* sumc_j+f_i-sumt_i* sumc_i-s* umc_n$<br>不难发现 ：</p><ol><li><p>$k=sumt_i+s$ ，故 $0&lt;k&lt;\infty$ 。</p></li><li><p>且 $0 \le j \le i-1,j \in Z$  </p></li><li><p>而直线上的点为：$(f_0,sumc_0)$ 、 $(f_1,sumc_1)$ 、 … 、 $(f_{i-1},sunc_{i-1})$ </p></li><li><p>我们的目标是让 $f_i$ 最小  </p></li></ol><p>我们带着目标，看看图像：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/u8nbza21.png" alt="xoy"><br>对于一个已知的 $i$ ， $k=sumt_i+s$ 是固定的，而若点 $(x_0,y_0)$在 $y=kx+b$ 上，那么截距 $b$ 是可以算出来的，又因 $b=f_i-sumt_i* sumc_i-s* umc_n$ ，故 $b$ 最小时 $f_i$ 最小。<br>那么，我们康康下图：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/14w4y6tp.png" alt="xoy2"><br>图中绿色的点是所有可能的 $(x_0,y_0)$ ,红色的线是 $y=kx+b$ （只有 $k$ 确定，所以在从下往上平移）。<br>不难发现，凸包（绿线）内部的点对于 $b$ 的最小值毫无意义。换句话说，<strong>最小值的点只会在凸包上</strong>。<br>那么在凸包上哪一点呢？<br>还是上图，令构成凸包的三条直线斜率为 $k_1,k_2,k_3$ ，由凸包性质可得 $k_1&lt;k_2&lt;k_3$ 。再看看上图中我们要找的那个点（不妨设它为点 $A$ ）， $A$ 所在的两条直线斜率为 $k_2,k_3$ ,且 $k_2&lt;k&lt;k_3$ 也就是说，<strong>对于一个给定斜率为的直线 $y=kx+b$ 让它的截距 $b$ 取得最小值的点就是凸包上第一个斜率大于 $k$ 的线段的下端点</strong>。<br>由此，我们想到在单调队列中维护第一个大于某个数的点。<br>我们又发现，因为 $t$ 大于0，所以：<br>斜率是单调递增的，且新加的点的横坐标也单调递增。<br>所以：<br>在查询的时候，可以将队头小于当前斜率的点全删除掉。<br>在插入的时候，可以将队尾所有不在凸包上的点全删除掉。<br>我们便得到以下代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    ll t, c;</span><br><span class="line">&#125; sum[N];</span><br><span class="line">ll n, s;</span><br><span class="line">ll f[N];</span><br><span class="line">ll q[N], hh = <span class="number">0</span>, tt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//除法会损失精度，故改成乘法</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check_slopeh</span><span class="params">(ll x, ll y, ll o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (f[y] - sum[y].c * s - f[x] + sum[x].c * s) &lt;= sum[o].t * (sum[y].c - sum[x].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check_slopet</span><span class="params">(ll x, ll y, ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (f[y] - sum[y].c - f[x] + sum[x].c) * (sum[b].c - sum[a].c) &gt;= (f[b] - sum[b].c - f[a] + sum[a].c) * (sum[y].c - sum[x].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;s);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll t, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;t, &amp;c);</span><br><span class="line">        sum[i].t = sum[i - <span class="number">1</span>].t + t;</span><br><span class="line">        sum[i].c = sum[i - <span class="number">1</span>].c + c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x7f</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    q[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">check_slopeh</span>(q[hh], q[hh + <span class="number">1</span>], i))</span><br><span class="line">            hh++;</span><br><span class="line">        ll j = q[hh];</span><br><span class="line">        f[i] = f[j] + sum[i].t * (sum[i].c - sum[j].c) + s * (sum[n].c - sum[j].c);</span><br><span class="line">        <span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">check_slopet</span>(q[tt - <span class="number">1</span>], q[tt], q[tt], i))</span><br><span class="line">            tt--;</span><br><span class="line">        q[++tt] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是——60分！哦可恶！题目中的 $t$ 可以为负数，咋办？</p><h2 id="二分"><a href="#二分" class="headerlink" title="二分"></a>二分</h2><p>我们来看看 $t$ 可以为负数的情况：</p><ol><li><p>$k=sumt_i+s$ ，但 $sumt_i$ 可能小于0，故 $ -\infty &lt;k&lt; \infty$ 。</p></li><li><p>$0 \le j \le i-1,j \in Z$  </p></li><li><p>而直线上的点为：$(f_0,sumc_0)$ 、 $(f_1,sumc_1)$ 、 … 、 $(f_{i-1},sunc_{i-1})$ </p></li><li><p>我们的目标是让 $f_i$ 最小 </p></li></ol><p>其实只有 $k$ 的范围变了， $k$ 可以小于0了，所以：<br>斜率不再具有单调性，但新加的点的横坐标仍然单调递增。<br>所以：<br>在查询的时候，只能用二分来查找了。<br>但在插入的时候，仍可以将队尾所有不在凸包上的点全删除掉。<br>终于，正解如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P5785</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    ll t, c;</span><br><span class="line">&#125; sum[N];</span><br><span class="line">ll n, s;</span><br><span class="line">ll f[N];</span><br><span class="line">ll q[N], hh = <span class="number">0</span>, tt = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//除法会损失精度，故改成乘法</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check_slopeh</span><span class="params">(ll x, ll y, ll o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (f[y] - sum[y].c * s - f[x] + sum[x].c * s) &lt;= sum[o].t * (sum[y].c - sum[x].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check_slopet</span><span class="params">(ll x, ll y, ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (f[y] - sum[y].c - f[x] + sum[x].c) * (sum[b].c - sum[a].c) &gt;= (f[b] - sum[b].c - f[a] + sum[a].c) * (sum[y].c - sum[x].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(ll o)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll l = hh, r = tt;</span><br><span class="line">    <span class="keyword">int</span> ans = l;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        ll mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">check_slopeh</span>(q[mid], q[mid + <span class="number">1</span>], o))</span><br><span class="line">            r = mid - <span class="number">1</span>, ans = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> q[ans];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;s);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll t, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;t, &amp;c);</span><br><span class="line">        sum[i].t = sum[i - <span class="number">1</span>].t + t;</span><br><span class="line">        sum[i].c = sum[i - <span class="number">1</span>].c + c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x7f</span>, <span class="keyword">sizeof</span> f);</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    q[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll j = <span class="built_in">work</span>(i);</span><br><span class="line">        f[i] = f[j] + sum[i].t * (sum[i].c - sum[j].c) + s * (sum[n].c - sum[j].c);</span><br><span class="line">        <span class="keyword">while</span> (hh &lt; tt &amp;&amp; <span class="built_in">check_slopet</span>(q[tt - <span class="number">1</span>], q[tt], q[tt], i))</span><br><span class="line">            tt--;</span><br><span class="line">        q[++tt] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> 斜率优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线段树</title>
      <link href="/2021/11/22/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2021/11/22/%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>有点久远了，有点丑</p><span id="more"></span><h1 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h1><h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>对于一个区间 $[x,y]$  , 我们将其分为两个区间 :  $[x,mid]$ 和 $[mid+1,y]$  , 在对这两个区间进行同样操作 , 直到无法继续 , 如图 :<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/yiorodlt.png" alt="例子"><br>不难发现 , 线段树除去最后一层后 , 一定是一颗满二叉树 , 深度为 $O(\log{}{N})$  。 所以我们用<strong>父子二倍</strong>的节点编号法:</p><ol><li><p> $root=1$ </p></li><li><p> $x$ 的左节点编号为 $x * 2$  ， 右节点编号为 $x * 2+1$ </p></li></ol><p>一个 $N$ 个叶节点线段数最多有 $4N$ 个节点 , 所以数组要开 $4$ 倍 。  </p><h2 id="基本实现"><a href="#基本实现" class="headerlink" title="基本实现"></a>基本实现</h2><ul><li> $sum$ ：当前区间的总和</li><li> $add$ ：懒标记，表示给以当前节点为根的子树中的每一个节点都加上 $add$ 。不难发现，为维护 $add$ ，我们用一个 $push_down()$ 来下传 $add$ 。</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span>&#123;</span></span><br><span class="line">ll sum,add;</span><br><span class="line"><span class="keyword">int</span> l,r;</span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].add)&#123;</span><br><span class="line">tr[u&lt;&lt;<span class="number">1</span>].add+=tr[u].add;</span><br><span class="line">tr[u&lt;&lt;<span class="number">1</span>].sum+=(ll)(tr[u&lt;&lt;<span class="number">1</span>].r-tr[u&lt;&lt;<span class="number">1</span>].l+<span class="number">1</span>)*tr[u].add;</span><br><span class="line">tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].add+=tr[u].add;</span><br><span class="line">tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum+=(ll)(tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].r-tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].l+<span class="number">1</span>)*tr[u].add;</span><br><span class="line">tr[u].add=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">tr[u].sum=tr[u&lt;&lt;<span class="number">1</span>].sum+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">tr[u].l=l,tr[u].r=r;</span><br><span class="line">tr[u].sum=a[r];</span><br><span class="line">tr[u].add=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">tr[u].l=l,tr[u].r=r;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)&#123;</span><br><span class="line">tr[u].sum+=(ll)(tr[u].r-tr[u].l+<span class="number">1</span>)*d;</span><br><span class="line">tr[u].add+=d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,l,r,d);</span><br><span class="line"><span class="keyword">if</span>(r&gt;mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,d);</span><br><span class="line"><span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r) <span class="keyword">return</span> tr[u].sum;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">ll as=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) as+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;mid) as+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> as;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line">    <span class="keyword">char</span> op[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> l,r,d;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;C&#x27;</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;l,&amp;r,&amp;d);</span><br><span class="line">            <span class="built_in">modify</span>(<span class="number">1</span>,l,r,d);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l,&amp;r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">ask</span>(<span class="number">1</span>,l,r));</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="应用1——扫描线"><a href="#应用1——扫描线" class="headerlink" title="应用1——扫描线"></a>应用1——扫描线</h2><p><a href="https://www.luogu.com.cn/problem/P5490">P5490 【模板】扫描线</a>  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line">ll n;</span><br><span class="line">vector&lt;ll&gt;ys;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Segment</span>&#123;</span></span><br><span class="line">ll k;</span><br><span class="line">ll x,yl,yr;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Segment &amp;t) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> x&lt;t.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(ll _x,ll _yl,ll _yr,ll _k)</span></span>&#123;</span><br><span class="line">x=_x;</span><br><span class="line">yl=_yl;</span><br><span class="line">yr=_yr;</span><br><span class="line">k=_k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;seg[N*<span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span>&#123;</span></span><br><span class="line">ll l,r;</span><br><span class="line">ll cnt;</span><br><span class="line">ll len;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(ll _l,ll _r,ll _cnt,ll _len)</span></span>&#123;</span><br><span class="line">l=_l;</span><br><span class="line">r=_r;</span><br><span class="line">cnt=_cnt;</span><br><span class="line">len=_len;</span><br><span class="line">&#125;</span><br><span class="line">&#125;tr[N*<span class="number">8</span>];</span><br><span class="line"><span class="function">ll <span class="title">find</span><span class="params">(ll y)</span></span>&#123;</span><br><span class="line"><span class="comment">//lower_bound()函数用于在指定区域内查找不小于目标值的第一个元素。</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">lower_bound</span>(ys.<span class="built_in">begin</span>(),ys.<span class="built_in">end</span>(),y)-ys.<span class="built_in">begin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(ll u)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].cnt) tr[u].len=ys[tr[u].r+<span class="number">1</span>]-ys[tr[u].l];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(tr[u].l!=tr[u].r)</span><br><span class="line">tr[u].len=tr[u&lt;&lt;<span class="number">1</span>].len+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].len;</span><br><span class="line"><span class="keyword">else</span> tr[u].len=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(ll u,ll l,ll r)</span></span>&#123;</span><br><span class="line">tr[u].<span class="built_in">init</span>(l,r,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(l!=r)&#123;</span><br><span class="line">ll mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid),<span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(ll u,ll l,ll r,ll k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)&#123;</span><br><span class="line">tr[u].cnt+=k;</span><br><span class="line"><span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">ll mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,l,r,k);</span><br><span class="line">        <span class="keyword">if</span>(r&gt;mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,k);</span><br><span class="line">        <span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;n);</span><br><span class="line">ys.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span>(ll i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">ll xr,xl,yr,yl;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>,&amp;xl,&amp;yl,&amp;xr,&amp;yr);</span><br><span class="line">seg[j++].<span class="built_in">init</span>(xl,yl,yr,<span class="number">1</span>);</span><br><span class="line">seg[j++].<span class="built_in">init</span>(xr,yl,yr,<span class="number">-1</span>);</span><br><span class="line">ys.<span class="built_in">push_back</span>(yl),ys.<span class="built_in">push_back</span>(yr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(ys.<span class="built_in">begin</span>(),ys.<span class="built_in">end</span>());</span><br><span class="line"><span class="comment">//unique函数功能是去除相邻的重复元素</span></span><br><span class="line"><span class="comment">//它并不真正把重复的元素删除,而是将无重复的元素复制到序列的前段,</span></span><br><span class="line"><span class="comment">//从而覆盖相邻的重复元素.unique返回的迭代器指向超出无重复的元素范围末端的下一个位置.</span></span><br><span class="line"><span class="comment">//erase:删除</span></span><br><span class="line">ys.<span class="built_in">erase</span>(<span class="built_in">unique</span>(ys.<span class="built_in">begin</span>(),ys.<span class="built_in">end</span>()),ys.<span class="built_in">end</span>());</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">0</span>,ys.<span class="built_in">size</span>()<span class="number">-2</span>);</span><br><span class="line"><span class="built_in">sort</span>(seg,seg+n*<span class="number">2</span>);</span><br><span class="line">ll res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(ll i=<span class="number">0</span>;i&lt;n*<span class="number">2</span>;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(i&gt;<span class="number">0</span>) res+=tr[<span class="number">1</span>].len*(seg[i].x-seg[i<span class="number">-1</span>].x);</span><br><span class="line"><span class="built_in">modify</span>(<span class="number">1</span>,<span class="built_in">find</span>(seg[i].yl),<span class="built_in">find</span>(seg[i].yr)<span class="number">-1</span>,seg[i].k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,res);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>以下是一个维护最值的线段树的修改操作</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//单点修改,将[x,x]的值改为z</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Modify</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l[p]==r[p]) dmax[p]=z,<span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=(l[p]+r[p])&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">Modify</span>(p&lt;&lt;<span class="number">1</span>,x,z);</span><br><span class="line"><span class="keyword">if</span>(y&gt;mid) <span class="built_in">Modify</span>(p&lt;&lt;|<span class="number">1</span>,x,z);</span><br><span class="line"><span class="comment">//从下往上跟新信息,也叫push_up </span></span><br><span class="line">dmax[p]=<span class="built_in">max</span>(dmax[p&lt;&lt;<span class="number">1</span>],dmax[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125; </span><br><span class="line">   <span class="comment">//调用入口: st.Modify(1,x,z);</span></span><br></pre></td></tr></table></figure><p>以下是一个维护区间和的线段树，支持区间增加，区间乘法</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//洛谷P3373 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,a[N],mod;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span>&#123;</span><span class="comment">//SegmentTree</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> dat[N*<span class="number">4</span>];<span class="comment">//维护区间和</span></span><br><span class="line"><span class="keyword">int</span> l[N*<span class="number">4</span>],r[N*<span class="number">4</span>];<span class="comment">//区间 </span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> add[N*<span class="number">4</span>],mul[N*<span class="number">4</span>];<span class="comment">//懒惰标记(lazytag) </span></span><br><span class="line"><span class="comment">//建立区间ll-rr,编号为p </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> ll,<span class="keyword">int</span> rr)</span></span>&#123;</span><br><span class="line"><span class="comment">//初始化lazytag </span></span><br><span class="line">add[p]=<span class="number">0</span>;</span><br><span class="line">mul[p]=<span class="number">1</span>; </span><br><span class="line">l[p]=ll;r[p]=rr;<span class="comment">//以p为编号的节点维护的区间为ll到rr</span></span><br><span class="line"><span class="comment">//ll==rr的话,这个区间就只有一个数,直接让区间维护的值等于a[ll]</span></span><br><span class="line"><span class="keyword">if</span>(ll==rr)</span><br><span class="line">dat[p]=a[ll];</span><br><span class="line"><span class="comment">//否则维护的值等于左儿子加右儿子</span></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> mid=(ll+rr)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">Build</span>(p&lt;&lt;<span class="number">1</span>,ll,mid);</span><br><span class="line"><span class="built_in">Build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,rr);</span><br><span class="line">dat[p]=dat[p&lt;&lt;<span class="number">1</span>]+dat[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];<span class="comment">//当然,具体的维护视题目而定</span></span><br><span class="line">&#125;</span><br><span class="line">dat[p]%=mod; </span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//懒惰标记,规定乘法优先</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Spread</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="comment">//如果懒标记不为0,就将其下传,修改左右儿子维护的值 </span></span><br><span class="line"><span class="keyword">if</span>(add[p]!=<span class="number">0</span>||mul[p]!=<span class="number">1</span>)&#123;</span><br><span class="line"><span class="comment">//根据我们规定的优先度,儿子的值=</span></span><br><span class="line"><span class="comment">//此刻儿子的值*爸爸的乘法lazytag+</span></span><br><span class="line"><span class="comment">//儿子的区间长度*爸爸的加法lazytag</span></span><br><span class="line">dat[p&lt;&lt;<span class="number">1</span>]=(dat[p&lt;&lt;<span class="number">1</span>]*mul[p]+add[p]*(r[p&lt;&lt;<span class="number">1</span>]-l[p&lt;&lt;<span class="number">1</span>]+<span class="number">1</span>))%mod;</span><br><span class="line">dat[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(dat[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[p]+add[p]*(r[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]-l[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]+<span class="number">1</span>))%mod;</span><br><span class="line"><span class="comment">//为该节点的左右儿子打上标记,</span></span><br><span class="line">mul[p&lt;&lt;<span class="number">1</span>]=(mul[p&lt;&lt;<span class="number">1</span>]*mul[p])%mod;</span><br><span class="line">mul[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(mul[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[p])%mod; </span><br><span class="line"><span class="comment">//由于乘法优先,加法打标记时要先乘一下 </span></span><br><span class="line">add[p&lt;&lt;<span class="number">1</span>]=(add[p&lt;&lt;<span class="number">1</span>]*mul[p]+add[p])%mod;</span><br><span class="line">add[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(add[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mul[p]+add[p])%mod;</span><br><span class="line"><span class="comment">//下传之后将父节点的懒标记清0</span></span><br><span class="line">mul[p]=<span class="number">1</span>;</span><br><span class="line">add[p]=<span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//区间修改,将区间[x,y]都加上z </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Change_add</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=l[p]&amp;&amp;y&gt;=r[p])&#123;<span class="comment">//被覆盖的话,就对其进行修改</span></span><br><span class="line">dat[p]+=(<span class="keyword">long</span> <span class="keyword">long</span>)z*(r[p]-l[p]+<span class="number">1</span>);</span><br><span class="line">dat[p]%=mod;</span><br><span class="line">add[p]=(add[p]+z)%mod;<span class="comment">//打上懒标记</span></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果没有被覆盖,就继续向下找,但儿子所维护的区间可能因为</span></span><br><span class="line"><span class="comment">//懒标记的存在而没有修改,因此将懒标记下放</span></span><br><span class="line"><span class="built_in">Spread</span>(p);</span><br><span class="line"><span class="keyword">int</span> mid=(l[p]+r[p])&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">Change_add</span>(p&lt;&lt;<span class="number">1</span>,x,y,z);<span class="comment">//如果要修改的区间覆盖了左儿子</span></span><br><span class="line"><span class="keyword">if</span>(y&gt;mid) <span class="built_in">Change_add</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x,y,z);<span class="comment">//右儿子同理</span></span><br><span class="line"><span class="comment">//维护值</span></span><br><span class="line">dat[p]=(dat[p&lt;&lt;<span class="number">1</span>]+dat[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%mod;</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//区间修改,将区间[x,y]都乘上z</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Change_mul</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=l[p]&amp;&amp;y&gt;=r[p])&#123;</span><br><span class="line">dat[p]=(dat[p]*z)%mod;</span><br><span class="line">mul[p]=(mul[p]*z)%mod;</span><br><span class="line"><span class="comment">//乘法优先,故加法标记也要乘</span></span><br><span class="line">add[p]=(add[p]*z)%mod;</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//否则同加法,向下找</span></span><br><span class="line"><span class="built_in">Spread</span>(p);</span><br><span class="line"><span class="keyword">int</span> mid=(l[p]+r[p])&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) <span class="built_in">Change_mul</span>(p&lt;&lt;<span class="number">1</span>,x,y,z);</span><br><span class="line"><span class="keyword">if</span>(y&gt;mid) <span class="built_in">Change_mul</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x,y,z);</span><br><span class="line">dat[p]=(dat[p&lt;&lt;<span class="number">1</span>]+dat[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%mod;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//区间查询,查询[x,y]的和 </span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Ask</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=l[p]&amp;&amp;y&gt;=r[p]) <span class="keyword">return</span> dat[p];<span class="comment">//如果被覆盖，就返回维护的值</span></span><br><span class="line"><span class="comment">//下传懒标记，并查询左右儿子</span></span><br><span class="line"><span class="built_in">Spread</span>(p);</span><br><span class="line"><span class="keyword">int</span> mid=(l[p]+r[p])&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(x&lt;=mid) ans=(ans+<span class="built_in">Ask</span>(p&lt;&lt;<span class="number">1</span>,x,y))%mod;</span><br><span class="line"><span class="keyword">if</span>(y&gt;mid) ans=(ans+<span class="built_in">Ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,x,y));</span><br><span class="line"><span class="keyword">return</span> ans%mod;</span><br><span class="line">&#125; </span><br><span class="line">&#125;st;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;mod);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">st.<span class="built_in">Build</span>(<span class="number">1</span>,<span class="number">1</span>,n); </span><br><span class="line"><span class="keyword">while</span>(m--)&#123;</span><br><span class="line"><span class="keyword">int</span> q,x,y,z;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q);</span><br><span class="line"><span class="keyword">if</span>(q==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">st.<span class="built_in">Change_mul</span>(<span class="number">1</span>,x,y,z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q==<span class="number">2</span>)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">st.<span class="built_in">Change_add</span>(<span class="number">1</span>,x,y,z);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,st.<span class="built_in">Ask</span>(<span class="number">1</span>,x,y));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注：打线段树的时候一定要注意两端取等 </span></span><br><span class="line"><span class="comment">//如51行两端取等，61、62行单边取等 </span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 线段树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络流</title>
      <link href="/2021/11/22/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
      <url>/2021/11/22/%E7%BD%91%E7%BB%9C%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>老有用了</p><span id="more"></span><h1 id="网络流"><a href="#网络流" class="headerlink" title="网络流"></a>网络流</h1><h2 id="网络流的基本概念"><a href="#网络流的基本概念" class="headerlink" title="网络流的基本概念"></a>网络流的基本概念</h2><p>一个有向图 $G=(V,E)$ ，每条有向边 $(x,y)$ 都有一个给定的<strong>容量</strong>记为 $c(x,y)$ （若不存在边 $(x,y)$ ，则 $c(x,y)=0$ ），图中还有两个特殊节点<strong>源点</strong>、<strong>汇点</strong>分别记为 $S$ 、 $T$ ； $S$ 会源源不断地流出无穷的水流，但每条边只能通过 $c(x,y)$ 的水流， $T$ 可以容纳无穷的水流，而其余个点无法容纳水流（即流入就必须全部流出）</p><p>任意一种满足条件的流水方法（即让水流从 $S$ 流到 $T$ ）叫做<strong>流函数</strong>，记为 $f(x,y)$ （表示从点 $x$ 流向 $y$ 的水流），明显，流函数具有如下性质：</p><ul><li><p>$0 \le f(x,y) \le c(x,y)$</p></li><li><p>$f(x,y)=-f(y,x)$ （即从 $x$ 流向 $y$ 的流量也就是从 $y$ 流向 $x$ 的流量的相反数）</p></li><li><p>$\forall x \ne S,T, \sum\limits_{u,x\in     E}^{}f(u,x)= \sum\limits_{x,v\in     E}^{}f(x,v)$ （即除 $S$ ， $T$ 外其余点流入流量等于流出流量，流量守恒）</p></li></ul><h2 id="残量网络"><a href="#残量网络" class="headerlink" title="残量网络"></a>残量网络</h2><p>对于任意合法的流函数 $f$ ，都可构建一个新图 $G2$ （其实应该记做 $G’$ 但这里为了方便记为 $G2$ ），构建方法如下：</p><ol><li>将原图每条边容量变为 $c(x,y)-f(x,y)$ （即减掉已经用掉的流量）</li><li>对于每条边 $(x,y)$ ，创建它的反向边 $(y,x)$ 并令 $c(y,x)=f(x,y)$ （即以流的流量让它可以反悔再流回来）</li></ol><p>该图G2被我们叫做<strong>残量网络</strong>  </p><p>需要注意的是,反向边是我们新加的,原图中并不存在,若原图中本就有边 $(x,y)$ 和边 $(y,x)$ （即原图就有反向边），应在构建原图 $G$ 时就新建一点 $z$ ，使得 $(y,x)$ 变为 $(y,z)$ ， $(z,x)$ 。  </p><p>如图（画的丑求你憋着吧！）<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/2fzwiq9k.png" alt="输入"><br> $\uparrow$ 这是输入的有向图。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/qp8a10w5.png" alt="G"><br> $\uparrow$ 这是去掉反向边的原图 $G$ 。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/eri7qydk.png" alt="f"><br> $\uparrow$ 这是一个合法的流函数，图中绿色代表 $f(x,y)$ 。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/pq7ur9ym.png" alt="G2"><br> $\uparrow$ 这是该流函数的残量网络，蓝色为原图边容量（已改变)，紫色为加入的反向边。</p><h2 id="最大流"><a href="#最大流" class="headerlink" title="最大流"></a>最大流</h2><p>给定一个网络 $G$ ,对于所有合法的 $f$ ,从 $S$ 流出的流量最大的记为该网络的最大流，如上图中最大流为 $7$ （即是绿色的流函数） </p><p>最大流的求法很多,但基本思路大体相同：</p><ol><li><p>先找到任意的一个流函数 $f$ ，并构建它的残量网络 $G2$ </p></li><li><p>在 $G2$ 中寻找 $G2$ 的合法流函数（我们一般记其为 $f’$ ，文中称其为 $f2$ ， $f2$ 也叫做<strong>增广路</strong>）</p></li><li><p>将找到的增广路加上原图的流函数构成新的流函（即 $f_{now}=f+f2$ 并将 $G2$ 更新成为 $f_{now}$ 的残量网络）</p></li><li><p>重复第 $2$ ， $3$ 步直到无增广路，此时的 $f$ 即是最大流</p></li></ol><p>该思路的证明比较简单，想了解的可以自己百度，下面放两种算法（都已通过<a href="https://www.luogu.com.cn/problem/P3376">P3376</a>）：</p><h3 id="一-Edmonds-Karp-EK算法"><a href="#一-Edmonds-Karp-EK算法" class="headerlink" title="一.Edmonds-Karp(EK算法)"></a>一.Edmonds-Karp(EK算法)</h3><p>该算法就是以上思路的直接实现，（未优化版）几乎不会用，仅了解即可，另外，由于这是我很久以前的代码，码风不太好</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Edmonds-Karp    O(nm^2)</span></span><br><span class="line"><span class="comment">//n+m = 10^3~10^4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000</span>+<span class="number">5</span>,M=<span class="number">20000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,S,T;</span><br><span class="line"><span class="keyword">int</span> q[N],incf[N],pre[N];<span class="comment">//q队列,incf残留网络流量,pre前驱边 </span></span><br><span class="line"><span class="keyword">bool</span> vis[N]; </span><br><span class="line"><span class="keyword">int</span> h[N],e[M],f[M],ne[M],idx=<span class="number">0</span>;<span class="comment">//e目标编号,f该边流量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> c)</span></span>&#123;<span class="comment">//使用成对储存的技巧i^1及是i的反向边,不懂的请看第二大部分</span></span><br><span class="line">e[idx]=y,f[idx]=c;</span><br><span class="line">ne[idx]=h[x],h[x]=idx++;</span><br><span class="line"></span><br><span class="line">e[idx]=x,f[idx]=<span class="number">0</span>;</span><br><span class="line">ne[idx]=h[y],h[y]=idx++;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;<span class="comment">//寻找增广路 </span></span><br><span class="line"><span class="keyword">int</span> hh=<span class="number">0</span>,tt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span> vis);</span><br><span class="line">q[<span class="number">0</span>]=S,vis[S]=<span class="literal">true</span>,incf[S]=INF;<span class="comment">//初始化,把S的出流量定为无穷大 </span></span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt)&#123;</span><br><span class="line"><span class="keyword">int</span> t=q[hh++];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=h[t];i!=<span class="number">-1</span>;i=ne[i])&#123;</span><br><span class="line"><span class="keyword">int</span> ver=e[i];</span><br><span class="line"><span class="keyword">if</span>(!vis[ver]&amp;&amp;f[i])&#123;<span class="comment">//未到过且还有流量 </span></span><br><span class="line">vis[ver]=<span class="literal">true</span>;</span><br><span class="line">incf[ver]=<span class="built_in">min</span>(incf[t],f[i]);<span class="comment">//最大流量为各边流量最小值 </span></span><br><span class="line">pre[ver]=i;<span class="comment">//记录前驱边 </span></span><br><span class="line"><span class="keyword">if</span>(ver==T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">q[++tt]=ver;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">EK</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> maxflow=<span class="number">0</span>;<span class="comment">//这里仅是本人习惯开了long long</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">bfs</span>())&#123;<span class="comment">//若存在增广路 </span></span><br><span class="line">maxflow+=incf[T]; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=T;i!=S;i=e[pre[i]^<span class="number">1</span>])&#123;<span class="comment">//pre[i]为前驱边-&gt;pre[i]^1为前驱边的反向边 </span></span><br><span class="line">                                                        <span class="comment">//-&gt;e[pre[i]^]为该反向边的目标点,即是前一个点</span></span><br><span class="line"><span class="comment">//更改残留网络 </span></span><br><span class="line">f[pre[i]]-=incf[T];</span><br><span class="line">f[pre[i]^<span class="number">1</span>]+=incf[T];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxflow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;S,&amp;T);</span><br><span class="line"><span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line"><span class="keyword">int</span> x,y,c;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;c);</span><br><span class="line"><span class="built_in">add</span>(x,y,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%ld&quot;</span>,<span class="built_in">EK</span>());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二-Dinic算法"><a href="#二-Dinic算法" class="headerlink" title="二.Dinic算法"></a>二.Dinic算法</h3><p>通过构建<strong>分层图</strong>来使增广时一次性增广多条增广路,是以上思路的优化,本人较为偏爱该算法（这是以前的码风，由于注释很多，我懒得再打一遍，所以保留）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Dinic   O(n^2m)</span></span><br><span class="line"><span class="comment">//n+m = 10^4~10^5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll; </span><br><span class="line"><span class="keyword">const</span> ll N=<span class="number">1000</span>+<span class="number">5</span>,M=<span class="number">20000</span>+<span class="number">5</span>;<span class="comment">//有方向边M要开2倍 </span></span><br><span class="line"><span class="keyword">const</span> ll INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line">ll n,m,S,T;</span><br><span class="line">ll q[N],d[N],cur[N];<span class="comment">//q队列,d高度,cur当前弧优化 </span></span><br><span class="line">ll h[N],e[M],f[M],ne[M],idx=<span class="number">0</span>;<span class="comment">//h,e,ne,idx邻接表,f流量 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll x,ll y,ll c)</span></span>&#123; </span><br><span class="line">e[idx]=y,f[idx]=c;</span><br><span class="line">ne[idx]=h[x],h[x]=idx++;</span><br><span class="line"></span><br><span class="line">e[idx]=x,f[idx]=<span class="number">0</span>;</span><br><span class="line">ne[idx]=h[y],h[y]=idx++;</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;<span class="comment">//寻找有无增广路并建立分层图 </span></span><br><span class="line">ll hh=<span class="number">0</span>,tt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(d,<span class="number">-1</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">q[<span class="number">0</span>]=S,d[S]=<span class="number">0</span>,cur[S]=h[S]; <span class="comment">//S初始高度为0,当前弧初始为第一条出边 </span></span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt)&#123;</span><br><span class="line">ll t=q[hh++];</span><br><span class="line"><span class="keyword">for</span>(ll i=h[t];i!=<span class="number">-1</span>;i=ne[i])&#123;</span><br><span class="line">ll ver=e[i];</span><br><span class="line"><span class="keyword">if</span>(d[ver]==<span class="number">-1</span> &amp;&amp;f[i])&#123;<span class="comment">//一定要判断容量大于0 </span></span><br><span class="line">d[ver]=d[t]+<span class="number">1</span>;<span class="comment">//层数 </span></span><br><span class="line">cur[ver]=h[ver];<span class="comment">//当前弧初始为第一条出边 </span></span><br><span class="line"><span class="keyword">if</span>(ver==T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">q[++tt]=ver;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">find</span><span class="params">(ll u,ll limit)</span></span>&#123;<span class="comment">//找到增广路,find(u,limit)表示从点u开始,</span></span><br><span class="line"><span class="comment">//从S到u的最大容量为limit </span></span><br><span class="line"><span class="keyword">if</span>(u==T) <span class="keyword">return</span> limit;</span><br><span class="line">ll flow=<span class="number">0</span>;<span class="comment">//flow表示从u向T流的最大流量 </span></span><br><span class="line"><span class="keyword">for</span>(ll i=cur[u];i!=<span class="number">-1</span>&amp;&amp;flow&lt;limit;i=ne[i])&#123;<span class="comment">//从未满的路径开始搜</span></span><br><span class="line"><span class="comment">//flow&lt;limit是很重要的优化! </span></span><br><span class="line">cur[u]=i;<span class="comment">//当前弧优化,搜到i就意味着i前的边已用完,将当前弧更新 </span></span><br><span class="line">ll ver=e[i];</span><br><span class="line"><span class="keyword">if</span>(d[ver]==d[u]+<span class="number">1</span>&amp;&amp;f[i])&#123;<span class="comment">//保证当前点在上一点的下一层,同样要注意f&gt;0 </span></span><br><span class="line">ll t=<span class="built_in">find</span>(ver,<span class="built_in">min</span>(f[i],limit-flow));</span><br><span class="line"><span class="keyword">if</span>(!t) d[ver]=<span class="number">-1</span>;<span class="comment">//若t到终点无增广路径,就删去点ver(把ver高度定为-1) </span></span><br><span class="line"></span><br><span class="line">f[i]-=t;</span><br><span class="line">f[i^<span class="number">1</span>]+=t;</span><br><span class="line">flow+=t; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line">ll maxflow=<span class="number">0</span>,flow;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">bfs</span>())<span class="comment">//若存在增广路 </span></span><br><span class="line"><span class="keyword">while</span>(flow=<span class="built_in">find</span>(S,INF)) <span class="comment">//找出当前图上所有增广路 </span></span><br><span class="line">maxflow+=flow;</span><br><span class="line"><span class="keyword">return</span> maxflow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>,&amp;n,&amp;m,&amp;S,&amp;T);</span><br><span class="line"><span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line">ll x,y,c;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>,&amp;x,&amp;y,&amp;c);</span><br><span class="line"><span class="built_in">add</span>(x,y,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,<span class="built_in">Dinic</span>());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里有一个现在码风的（ $2022/2/24$ ）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10000</span> + <span class="number">5</span>, M = <span class="number">1e5</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w; &#125; e[M &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n, m, S, T;</span><br><span class="line"><span class="keyword">int</span> h[N], cur[N], idx = <span class="number">0</span>, dep[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; <span class="built_in">add</span>(x, y, z), <span class="built_in">add</span>(y, x, <span class="number">0</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    STC <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">int</span> hh = <span class="number">1</span>, tt = <span class="number">1</span>, x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">memset</span>(dep, <span class="number">0</span>, <span class="keyword">sizeof</span> dep), q[dep[S] = <span class="number">1</span>] = S, cur[S] = h[S]; hh &lt;= tt; )</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x = q[hh++]]; i != <span class="number">-1</span>; i = e[i].ne) <span class="keyword">if</span> (!dep[y = e[i].ver] &amp;&amp; e[i].w)</span><br><span class="line">&#123;</span><br><span class="line">dep[y] = dep[x] + <span class="number">1</span>, cur[y] = h[y];</span><br><span class="line"><span class="keyword">if</span> (y == T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">q[++tt] = y;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> lim)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == T) <span class="keyword">return</span> lim;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, y, t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; i != <span class="number">-1</span> &amp;&amp; flow &lt; lim;  i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        cur[x] = i; <span class="comment">//这里非常玄学,一定要这样写,压行的话可能会TLE</span></span><br><span class="line">        <span class="keyword">if</span> (dep[y = e[i].ver] == dep[x] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(t = <span class="built_in">find</span>(y, std::<span class="built_in">min</span>(lim - flow, e[i].w)))) dep[y] = <span class="number">0</span>;</span><br><span class="line">            e[i].w -= t, e[i ^ <span class="number">1</span>].w += t, flow += t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dinic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span>, flow;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">dfs</span>()) <span class="keyword">while</span>(flow = <span class="built_in">find</span>(S, INF)) res += flow;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a, b, c; m--; <span class="built_in">dad</span>(a, b, c)) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">dinic</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="无源汇上下界可行流"><a href="#无源汇上下界可行流" class="headerlink" title="无源汇上下界可行流"></a>无源汇上下界可行流</h2><p>在这类问题中不在仅存在容量上界 $c$ ，还存在下界（不妨记为 $l$ ），并且不存在 $S$ ， $T$ 两点</p><p>对于此类问题，我们可以用如下操作变为网络最大流：</p><ol><li><p>新建源点和汇点</p></li><li><p>为满足性质1（忘了的上去看），将 $c$ 变为 $c-l$ ，即原来 $l(x,y) \le f(x,y) \le c(x,y)$ 变为 $0 \le f(x,y) \le c(x,y)-l(x,y)$ </p></li><li><p>经过第2步后我们发现流量不守恒，故用一个数组 $ve$ （Virtual Edge）储存每个点的流量变化量，即对于边 $(x,y)$ ，经第2步变化后， $x$ 的出流量少了 $l(x,y)$ ， $y$ 的入流量少了 $l(x,y)$ ，故 $ve(x)-=l(x,y)$ ， $ve(y)+=l(x,y)$ </p></li><li><p>利用第3步统计的 $ve$ 数组，新建虚拟边使流量守恒，即若 $ve(x)&gt;0$ ，新建边 $(S,x)$ 并令 $c(S,x)=ve(x)$ ；若 $ve(x)&lt;0$ ，新建边 $(x,T)$ 并令 $c(x,T)=-ve(x)$ ；</p></li><li><p>跑一遍 $S$ 到 $T$ 的最大流，若 $S$ （或 $T$ ）的所有边都可以流满，就说明存在可行流</p></li></ol><p>经过如上操作，就将其变为一个基本的最大流问题，我们把这样建成的图称作虚拟图（仅是本人习惯），记为 $G3$ </p><h2 id="有源汇上下界可行流"><a href="#有源汇上下界可行流" class="headerlink" title="有源汇上下界可行流"></a>有源汇上下界可行流</h2><p>此类问题相比于上一类区别在于原题中就存在源点和汇点（为以示区别记为 $s$ 、 $t$ ）</p><p>而解决方式与上类问题类似，区别仅在于我们要将点 $s$ 、 $t$ 这两个不满足流量守恒的点变为普通点，再用新建的 $S$ 、 $T$ 当为源点</p><p>而使其变成普通点的方式即是新建一条边 $(t,s)$ 并令<br> $c(t,s)= \infty$ （正无穷）</p><h2 id="有源汇上下界最大流"><a href="#有源汇上下界最大流" class="headerlink" title="有源汇上下界最大流"></a>有源汇上下界最大流</h2><p>好，现在问题来了，我们求解可行流时就是求的 $G3$ 的最大流，那么如果我们现在要求原图 $G$ 的可行流中的最大流我们该怎么办？</p><p>仔细思考，发现我们还有一个图没用——原图的残量网络 $G2$ ！辣么，我们可否使用这三个图求出答案呢？ </p><p>当然是可以的，<del>不然我讲个屁啊</del>，而方法如下： </p><ol><li>同上类问题跑出 $G3$ 的最大流记为 $flow3$ ，并将此时原图中的流函数记为 $f3$ </li><li>构建原图 $G$ 关于 $f3$ 的残量网络 $G2$ ，求出 $G2$ 中的曾广路，我们发现这就等价于求出 $G$ 的最大流 $flow$ （注意此时用的是原图 $G$ ，故应删去边 $(t,s)$ ）</li><li>最后答案即是 $flow+flow3$ </li></ol><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h3><p>有 $n$ 天， $m$ 位少女，至少为她们每人拍 $G(i)$ 张照片，每天总的最多拍 $D(i)$ 张，且每天只能为特定的少女拍照，张数为 $x \in [L,R]$ 。</p><h3 id="建立模型"><a href="#建立模型" class="headerlink" title="建立模型"></a>建立模型</h3><p>我们可以很轻松的<del>由题目标题</del>得出应使用网络流，并在稍微，<del>指3天</del>，思考后得出如下方法：</p><ul><li>建立原图 $G$ ：<ol><li>建立源点 $s=1$ ，汇点 $t=m+n+2$ ，并将少女建为点 $2 \sim  m+1$ ，天数建为点 $m+2 \sim n+m+1$ </li><li>将少女至少要拍的照片数 $G(i)$ 定为下界，无穷大定为上界，让少女 $x$ 与源点 $s$ 相连，即建立边 $(s,x)$ （ $x \in [2,m+1]$ ）并使 $c(s,x)=\infty -G(i)$ </li><li>将每天的最大拍照量定为上界， $0$ 为下界，让天数 $y$ 与汇点 $t$ 相连，即建边 $(y,t)$ （ $y \in [m+2,m+n+1]$ ）并使 $c(y,t)=D(i)-0$ </li><li>将少女与天相连，定上下界为 $[L,R]$ ，即建边 $(x,y)$ （ $x \in [2,m+1],y \in [m+2,m+n+1]$ ）并使 $c(x,y)=R-L$ </li><li>在构建原图的同时维护 $ve$ 数组</li></ol></li><li>构建虚拟图 $G3$ ：<ol><li>建立源点 $S=0$ ， $T=n+m+3$ </li><li>用 $ve$ 数组建立连接 $S$ ， $T$ 与其他点的边</li><li>增加边 $(t,s)$ ，并使 $c(t,s)=\infty$ </li><li>并同时维护 $outflow$ （记录从S流出的流量,用于判定是否满流）</li></ol></li><li>求解 $G3$ 的最大流<ol><li>直接用Dinic求解</li><li>判断 $Dinic()$ 是否等于 $outflow$ ，若不等，则说明原图无可行流（原题无解）</li><li>若相等，用 $res$ 记录此时 $s$ 到 $t$ 的流量，并进入下一步</li></ol></li><li>求解 $G$ 的最大流（即是 $G2$ 中的曾广路）<ol><li>删去边 $(t,s)$ </li><li>使 $S=s$ ， $T=t$ （即将 $G3$ 变为 $G$ ）</li><li>Dinic求解最大流，答案即为 $Dinic()+res$ </li></ol></li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>以前的码风</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000000</span>+<span class="number">5</span>,M=<span class="number">1000000</span>+<span class="number">5</span>,INF=<span class="number">2147483647</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;<span class="comment">//如题意 </span></span><br><span class="line"><span class="keyword">int</span> nn,s,t,S,T;<span class="comment">//nn:原图中的点数,s:原图的源点,S虚拟图的源点,t,T同理 </span></span><br><span class="line"><span class="keyword">int</span> q[N],d[N],cur[N],ve[N];<span class="comment">//q:队列,d:高度,cur:当前弧优化,ve(Virtual Edge):虚拟边 </span></span><br><span class="line"><span class="keyword">int</span> h[N],e[N],f[N],ne[N],idx=<span class="number">0</span>;<span class="comment">//h,e,ne,idx:邻接表,f:流量 </span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">e[idx]=y,f[idx]=c,ne[idx]=h[x],h[x]=idx++;</span><br><span class="line">e[idx]=x,f[idx]=<span class="number">0</span>,ne[idx]=h[y],h[y]=idx++;<span class="comment">//使用成对储存的技巧 </span></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&lt;b? a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;<span class="comment">//寻找有无增广路并建立分层图 </span></span><br><span class="line"><span class="keyword">int</span> hh=<span class="number">0</span>,tt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(d,<span class="number">-1</span>,<span class="keyword">sizeof</span> d);</span><br><span class="line">q[hh]=S,d[S]=<span class="number">0</span>,cur[S]=h[S];<span class="comment">//S初始高度为0,当前弧初始为第一条出边 </span></span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt)&#123;</span><br><span class="line"><span class="keyword">int</span> p=q[hh++];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=h[p];i!=<span class="number">-1</span>;i=ne[i])&#123;</span><br><span class="line"><span class="keyword">int</span> ver=e[i];</span><br><span class="line"><span class="keyword">if</span>(d[ver]==<span class="number">-1</span>&amp;&amp;f[i])&#123;<span class="comment">//一定要判断容量大于0 </span></span><br><span class="line">d[ver]=d[p]+<span class="number">1</span>;<span class="comment">//层数  </span></span><br><span class="line">cur[ver]=h[ver];<span class="comment">//当前弧初始为第一条出边 </span></span><br><span class="line"><span class="keyword">if</span>(ver==T) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">q[++tt]=ver;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> limit)</span></span>&#123;<span class="comment">//找到增广路,find(u,limit)表示从点u开始,</span></span><br><span class="line"><span class="comment">//从S到u的最大容量为limit </span></span><br><span class="line"><span class="keyword">if</span>(u==T) <span class="keyword">return</span> limit;</span><br><span class="line"><span class="keyword">int</span> nowflow=<span class="number">0</span>;<span class="comment">//nowflow表示从u向T流的最大流量 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=cur[u];i!=<span class="number">-1</span>&amp;&amp;nowflow&lt;limit;i=ne[i])&#123;<span class="comment">//从未满的路径开始搜</span></span><br><span class="line"><span class="comment">//nowflow&lt;limit是很重要的优化! </span></span><br><span class="line">cur[u]=i;<span class="comment">//当前弧优化,搜到i就意味着i前的边已用完,将当前弧更新 </span></span><br><span class="line"><span class="keyword">int</span> ver=e[i];</span><br><span class="line"><span class="keyword">if</span>(d[ver]==d[u]+<span class="number">1</span>&amp;&amp;f[i])&#123;<span class="comment">//保证当前点在上一点的下一层,同样要注意f&gt;0 </span></span><br><span class="line"><span class="keyword">int</span> tflow=<span class="built_in">find</span>(ver,<span class="built_in">min</span>(f[i],limit-nowflow));</span><br><span class="line"><span class="keyword">if</span>(!tflow) d[ver]=<span class="number">-1</span>;<span class="comment">//若t到终点无增广路径,就删去点ver(把ver高度定为-1) </span></span><br><span class="line">f[i]-=tflow,f[i^<span class="number">1</span>]+=tflow,nowflow+=tflow;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> nowflow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> maxflow=<span class="number">0</span>,inflow;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">bfs</span>())<span class="comment">//若存在增广路 </span></span><br><span class="line"><span class="keyword">while</span>(inflow=<span class="built_in">find</span>(S,INF))  maxflow+=inflow;<span class="comment">//找出当前图上所有增广路 </span></span><br><span class="line"><span class="keyword">return</span> maxflow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m))&#123;</span><br><span class="line"><span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line"><span class="built_in">memset</span>(ve,<span class="number">0</span>,<span class="keyword">sizeof</span> ve);</span><br><span class="line"><span class="comment">//构建原图 </span></span><br><span class="line">s=<span class="number">1</span>,t=n+m+<span class="number">2</span>;<span class="comment">//原图中s=1为源点,t=n+m+2为汇点 </span></span><br><span class="line">nn=n+m+<span class="number">2</span>;<span class="comment">//nn:原图的点数 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m+<span class="number">1</span>;++i)&#123;<span class="comment">//将少女编号为2~m+1,并和源点连通 </span></span><br><span class="line"><span class="keyword">int</span> G;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;G);</span><br><span class="line"><span class="built_in">add</span>(s,i,INF-G);</span><br><span class="line">ve[i]+=G;</span><br><span class="line">ve[s]-=G;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=m+<span class="number">2</span>;i&lt;=m+n+<span class="number">1</span>;++i)&#123;<span class="comment">//将天数编号为m+2~m+n+1,并和汇点连通 </span></span><br><span class="line"><span class="keyword">int</span> C,D;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;C,&amp;D);</span><br><span class="line"><span class="built_in">add</span>(i,t,D);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=C;++j)&#123;<span class="comment">//将天与少女连通 </span></span><br><span class="line"><span class="keyword">int</span> TT,L,R;<span class="comment">//TT即为题中的T</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;TT,&amp;L,&amp;R);</span><br><span class="line">TT+=<span class="number">2</span>;<span class="comment">//注意输入中的少女是从0编号的</span></span><br><span class="line"><span class="built_in">add</span>(TT,i,R-L);</span><br><span class="line">ve[TT]-=L;<span class="comment">//一定要减L,别减R！ </span></span><br><span class="line">ve[i]+=L; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//构建虚拟图 </span></span><br><span class="line">S=<span class="number">0</span>,T=n+m+<span class="number">3</span>;<span class="comment">//S=0为虚拟图源点,T=n+m+3为虚拟图汇点 </span></span><br><span class="line"><span class="keyword">int</span> outflow=<span class="number">0</span>;<span class="comment">//记录从虚拟源点出流量,用于判断是否是满流 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=nn;++i)&#123;<span class="comment">//创建虚拟边保证虚拟图中流量守恒 </span></span><br><span class="line"><span class="keyword">if</span>(ve[i]&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">add</span>(S,i,ve[i]);</span><br><span class="line">outflow+=ve[i]; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ve[i]&lt;<span class="number">0</span>) <span class="built_in">add</span>(i,T,-ve[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">add</span>(t,s,INF);<span class="comment">//增加一条从t到s的边,保证流量守恒 </span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">Dinic</span>()&lt;outflow) <span class="built_in">printf</span>(<span class="string">&quot;-1\n\n&quot;</span>);<span class="comment">//务必两个\n </span></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> res=f[idx<span class="number">-1</span>];<span class="comment">//最后加的边的反向边的流量</span></span><br><span class="line"><span class="comment">//即是当前(虚拟图的)满流中s-&gt;t的流量</span></span><br><span class="line">f[idx<span class="number">-1</span>]=f[idx<span class="number">-2</span>]=<span class="number">0</span>;<span class="comment">//删除该边</span></span><br><span class="line">S=s,T=t;<span class="comment">//因为现在求的是s-&gt;t的最大流量,</span></span><br><span class="line"><span class="comment">//所以重新初始化源点和汇点 </span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n\n&quot;</span>,res+<span class="built_in">Dinic</span>()); <span class="comment">//ans即为虚拟图中s-&gt;t的流量+</span></span><br><span class="line"><span class="comment">//新增加的可行流量 </span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="费用流"><a href="#费用流" class="headerlink" title="费用流"></a>费用流</h2><p>我们已经解决了网络最大流的问题，但是，如果边不仅有容量限制，还有“价格”，也就是说，流单位容量的流还要付出一定代价该怎么办呢？</p><p><strong>最小费用最大流(mcmf)<strong>简称</strong>费用流</strong>就可以解决这样一个问题：给定一张网络，有源点和汇点，网络上的每条边 $(u,v)$ 都有一个流量限制 $w(u,v)$ 和单位流量的费用 $c(u,v)$ ，在满足流量守恒的前提下，求出<strong>使流量最大的最小费用</strong></p><p>其实非常简单，考虑我们Dinic的过程，其实就是不断一个寻找增广路的过程，那么我们在每次寻找增广路的时候，贪心的寻找<strong>单位费用最小</strong>的增广路，正确性显然，考虑具体实现，只需将每条边 $(u,v)$ 的反向边的费用定为 $-c(u,v)$ ，每次寻找增广路的bfs换成一个最短路即可</p><h3 id="spfa实现"><a href="#spfa实现" class="headerlink" title="spfa实现"></a>spfa实现</h3><p>使用spfa可以简单，高效（<del>前提是spfa没死</del>）的实现费用流，但需要注意的是，费用流的时间复杂度是 $O(nmf)$ ，其中 $f$ 代表最大流量，这个复杂度是<strong>伪多项式</strong>的，因为 $f_{max}=2^{\frac{n}{2}},m_{max}=n^2$ ，所以最坏为 $O(n^32^{\frac{n}{2}})$ ，当然实际上远远达不到这个上界</p><p>这里用Dinic+spfa实现了一个费用流：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STC static</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>, M = <span class="number">5e4</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w, c; &#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> n, m, S, T;</span><br><span class="line"><span class="keyword">int</span> h[N], cur[N], idx = <span class="number">0</span>, dis[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line">LL maxflow, mincost;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span></span>&#123; e[idx] = &#123;h[x], y, z, c&#125;, h[x] = idx++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span></span>&#123; <span class="built_in">add</span>(x, y, z, c), <span class="built_in">add</span>(y, x, <span class="number">0</span>, -c); &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) dis[i] = INF, cur[i] = h[i];</span><br><span class="line">    std::queue&lt;<span class="keyword">int</span>&gt; q; <span class="comment">//这里只能stl,因为spfa一个点可能入队多次,空间大小未知</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">for</span> (dis[S] = <span class="number">0</span>, q.<span class="built_in">push</span>(S), vis[S] = <span class="literal">true</span>; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">    &#123;</span><br><span class="line">        vis[x = q.<span class="built_in">front</span>()] = <span class="literal">false</span>, q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne) <span class="keyword">if</span> (dis[y = e[i].ver] &gt; dis[x] + e[i].c &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            dis[y] = dis[x] + e[i].c;</span><br><span class="line">            <span class="keyword">if</span> (!vis[y]) vis[y] = <span class="literal">true</span>, q.<span class="built_in">push</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[T] != INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> lim)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == T) <span class="keyword">return</span> lim;</span><br><span class="line">    vis[x] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, y, t;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; i != <span class="number">-1</span> &amp;&amp; flow &lt; lim; i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        cur[x] = i;</span><br><span class="line">        <span class="keyword">if</span> (!vis[y = e[i].ver] &amp;&amp; dis[y] == dis[x] + e[i].c &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(t = <span class="built_in">find</span>(y, std::<span class="built_in">min</span>(lim - flow, e[i].w)))) <span class="keyword">continue</span>;</span><br><span class="line">            e[i].w -= t, e[i ^ <span class="number">1</span>].w += t, flow += t, mincost += t * e[i].c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vis[x] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mcmf</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    maxflow = mincost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flow;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">spfa</span>()) <span class="keyword">while</span>(flow = <span class="built_in">find</span>(S, INF)) maxflow += flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a, b, c, d; m--; <span class="built_in">dad</span>(a, b, c, d)) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">    <span class="built_in">mcmf</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, maxflow, mincost);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Dijkstra实现"><a href="#Dijkstra实现" class="headerlink" title="Dijkstra实现"></a>Dijkstra实现</h3><p>由于dij不能处理负全，必须像Johns全源最短路一样用一个势能来转换为正权</p><p>首先跑一次最短路，求出源点到每个点的最短距离 $h_i$ （也是该点的初始势能），接下来和Johnson算法一样，对于一条从 $u$ 到 $v$ ，单位费用为 $w$ 的边，将其边权重置为 $w+h_u-h_v$          </p><p>可以发现，这样设置势能后新网络上的最短路径和原网络上的最短路径一定对应，不妨设一条从 $S$ 到 $T$ 的路径为 $S\rightarrow p_1\rightarrow p_2\rightarrow…\rightarrow p_k\rightarrow T$ ，则其重表权值后，路径权值和为<br>$$<br>\begin{align}<br>&amp;(w(S,p_1)+ h_S-h_{p_1})+ (w(p_1,p_2)+ h_{p_1}- h_{p_2}) + … + (w(p_k,T) + h_{p_k}-h_T)\\<br>=&amp;w(S,p_1) + w(p_1,p_2) + … + w(p_k,T) + h_S - h_T<br>\end{align}<br>$$<br>可以发现 $S$ 到 $T$ 的所有路径的相对大小不变</p><p>代码：</p><p>以前的码风，另外，实测 dij 比 spfa 快大概一倍</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5000</span> + <span class="number">5</span>, M = <span class="number">50000</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> S, T, n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w, c;</span><br><span class="line">&#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> dis, id;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Node &amp;t) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> dis &gt; t.dis;</span><br><span class="line">&#125;</span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N], cur[N];</span><br><span class="line"><span class="keyword">bool</span> v[N], vfind[N]; <span class="comment">//为find单独开一个v</span></span><br><span class="line"><span class="keyword">int</span> pe[N]; <span class="comment">//potential energy,势能</span></span><br><span class="line"><span class="keyword">int</span> maxflow, mincost;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx].ver = y, e[idx].w = z, e[idx].c = c, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> c)</span> <span class="comment">//add-double</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">add</span>(x, y, z, c), <span class="built_in">add</span>(y, x, <span class="number">0</span>, -c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">pe[i] = INF;</span><br><span class="line">q.<span class="built_in">push</span>(S);</span><br><span class="line">pe[S] = <span class="number">0</span>;</span><br><span class="line">v[S] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">v[x] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (pe[y] &gt; pe[x] + e[i].c &amp;&amp; e[i].w)</span><br><span class="line">&#123;</span><br><span class="line">pe[y] = pe[x] + e[i].c;</span><br><span class="line"><span class="keyword">if</span> (!v[y])</span><br><span class="line">&#123;</span><br><span class="line">v[y] = <span class="literal">true</span>;</span><br><span class="line">q.<span class="built_in">push</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dij</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">priority_queue&lt;Node&gt; q;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">dis[i] = INF, v[i] = <span class="literal">false</span>, cur[i] = h[i];</span><br><span class="line">dis[S] = <span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>((Node)&#123;<span class="number">0</span>, S&#125;);</span><br><span class="line"><span class="keyword">int</span> x, y, nc;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">x = q.<span class="built_in">top</span>().id, q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">if</span> (v[x])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">v[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver, nc = e[i].c + pe[x] - pe[y];</span><br><span class="line"><span class="keyword">if</span> (dis[y] &gt; dis[x] + nc &amp;&amp; e[i].w)</span><br><span class="line">&#123;</span><br><span class="line">dis[y] = dis[x] + nc;</span><br><span class="line"><span class="keyword">if</span> (!v[y])</span><br><span class="line">q.<span class="built_in">push</span>((Node)&#123;dis[y], y&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> dis[T] != INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x == T)</span><br><span class="line"><span class="keyword">return</span> limit;</span><br><span class="line">vfind[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> flow = <span class="number">0</span>, y, t, nc;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = cur[x]; i != <span class="number">-1</span> &amp;&amp; flow &lt; limit; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">cur[x] = i;</span><br><span class="line">y = e[i].ver, nc = e[i].c + pe[x] - pe[y];</span><br><span class="line"><span class="keyword">if</span> (!vfind[y] &amp;&amp; dis[y] == dis[x] + nc &amp;&amp; e[i].w)</span><br><span class="line">&#123;</span><br><span class="line">t = <span class="built_in">find</span>(y, <span class="built_in">min</span>(limit - flow, e[i].w));</span><br><span class="line"><span class="keyword">if</span> (!t)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">e[i].w -= t;</span><br><span class="line">e[i ^ <span class="number">1</span>].w += t;</span><br><span class="line">flow += t;</span><br><span class="line">mincost += t * e[i].c;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">vfind[x] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> flow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mcmf</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">maxflow = mincost = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> flow;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">dij</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (flow = <span class="built_in">find</span>(S, INF))</span><br><span class="line">maxflow += flow;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="comment">//记得每次更新势能</span></span><br><span class="line">pe[i] += dis[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w, c; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w, &amp;c);</span><br><span class="line"><span class="built_in">addd</span>(u, v, w, c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">spfa</span>();</span><br><span class="line"><span class="built_in">mcmf</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, maxflow, mincost);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="最高标号预流推进"><a href="#最高标号预流推进" class="headerlink" title="最高标号预流推进"></a>最高标号预流推进</h2><p>最高标号预流推进（High Level Preflow Push，即HLPP）是另一种网络流算法，该算法较Dinic更为高效，<del>然而常数更大</del></p><p>HLPP并不是像Dinic和EK一样基于增广路的算法，它用另外一种更直观的方法求最大流</p><h3 id="预流推进"><a href="#预流推进" class="headerlink" title="预流推进"></a>预流推进</h3><p>想象一下，如果给到一个网络流让你手算，你咋办？当然是贪心地从源点开始往死里流，尽可能的把每条边流满，如果超过容量就减掉超过部分，一直推到汇点（应该很好理解，可以自己手推试试）</p><p>PP也是基于以上思想，用一个队列储存待维护的点（初始时只有 $S$ ），对于每一个当前点，把它有的流量尽可能地推往与之相连的点，然后将相连的点也加入队列</p><p>但这样明显有一个问题：可能出现两个点一个推过来一个推回去，结果就死循环了，为了不死循环，我们类似Dinic，引入一个<strong>高度</strong> $hi$ ， $hi[S]=n,hi[T]=0$ 规定只能由高为 $hight$ 的点流向高为 $hight-1$ 的点，如果遇到一个点有多余的流量无法流出，就尝试将其抬高一个高度（我们把这个操作叫做<strong>重贴标签</strong>），直到最后高为 $n+1$ 流回 $S$ </p><h3 id="最高标号"><a href="#最高标号" class="headerlink" title="最高标号"></a>最高标号</h3><p><del>令人讨厌的、让人无奈的、使人疯魔的</del><strong>Tarjan</strong>和他的同事Goldberg在1986年提出了最高标号（HL）预留推进算法，即把普通队列换成<strong>优先队列</strong>，每次取出高度最高的那个来推进，可以理解为先将高处的点的水移到低处，那么给低处节点推流时可以顺便带走，Cheriyan和Maheshwari在1988年证明了这样做的复杂度为 $O(n^2\sqrt{m})$ </p><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>虽然上述的算法是正确的，并且复杂度是稳定的（<del>不像某玄学Dinic</del>），但是因为缺少一些优化，使得其上界比较紧，因此在随机数据下可能不如增广路算法，所以下面介绍一些优化</p><p>首先是喜闻乐见的gap优化：如果我们发现在给一个点抬高一的高度的时候，这个点原来的高度已经没有点了（出现断层），那么我们直接把大于这个高度的点的高度全部设 $n+1$ ，让他们回流到源点去，因为有了断层，他们无法再有机会把水推到汇点（为什么不能有下面一个点抬上来形成路径呢？因为一个点的高度是所有相邻点高度最小值加一，所以不可能出现这种情况）</p><p>其次，我们发现将所有非源点的高度设置为0是有些浪费的。我们不妨通过一遍bfs将每个点的初始高度设置为它到汇点 $T$ 的最短距离，这样就节省了大量重贴标签操作。当然，源点 $S$ 的高度还是应该设置为 $n$ </p><p>然后，我们发现完全没有必要用优先队列的 $O(\log{n})$ 来求最高点，因为高度最大也就 $n+1$ ，完全可以用一个桶存下所有高度的节点，$O(1)$ 得到最高点</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><p><a href="https://www.luogu.com.cn/problem/P4722">模板</a></p><p>以前码风版：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1200</span> + <span class="number">5</span>, M = <span class="number">120000</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, S, T;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> hi[N], ex[N], gap[N]; <span class="comment">//hi:高度,ex:超额流,gap[i]:高度为i的节点的数量</span></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; B[N]; <span class="comment">// 桶B[i]中记录所有hi[x]=i的x</span></span><br><span class="line"><span class="keyword">int</span> level = <span class="number">0</span>; <span class="comment">//溢出节点的最高高度</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx] = (Edge)&#123;h[x], y, z&#125;, h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x, y, z), <span class="built_in">add</span>(y, x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">hi[i] = INF;</span><br><span class="line">hi[T] = <span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(T);</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line">x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (e[i ^ <span class="number">1</span>].w &amp;&amp; hi[y] &gt; hi[x] + <span class="number">1</span>) <span class="comment">//从T倒着搜回去走的是反向边,^1以后就变回正向边</span></span><br><span class="line">hi[y] = hi[x] + <span class="number">1</span>, q.<span class="built_in">push</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> hi[S] != INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//尽可能通过能够推送的边推送超额流</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">bool</span> init = x == S;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, k; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (!e[i].w || (init == <span class="literal">false</span> &amp;&amp; hi[x] != hi[y] + <span class="number">1</span>)) <span class="comment">//初始化时不考虑高度差为1</span></span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">k = init ? e[i].w : <span class="built_in">min</span>(e[i].w, ex[x]); <span class="comment">//取到剩余容量和超额流的最小值初始化时可以使源的溢出量为负数</span></span><br><span class="line"><span class="keyword">if</span> (y != S &amp;&amp; y != T &amp;&amp; !ex[y])</span><br><span class="line">B[hi[y]].<span class="built_in">push_back</span>(y), level = <span class="built_in">max</span>(level, hi[y]);</span><br><span class="line">ex[x] -= k, ex[y] += k, e[i].w -=k, e[i ^ <span class="number">1</span>].w += k;</span><br><span class="line"><span class="keyword">if</span> (!ex[x]) <span class="comment">//如果已经推送完就返回</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">relabel</span><span class="params">(<span class="keyword">int</span> x)</span>  <span class="comment">//重贴标签(高度)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  hi[x] = INF;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">    <span class="keyword">if</span> (e[i].w)</span><br><span class="line">hi[x] = <span class="built_in">min</span>(hi[x], hi[e[i].ver]);</span><br><span class="line">  <span class="keyword">if</span> (++hi[x] &lt; n) <span class="comment">//只处理高度小于n的节点</span></span><br><span class="line">  &#123;</span><br><span class="line">  <span class="comment">//新的高度,更新gap</span></span><br><span class="line">  B[hi[x]].<span class="built_in">push_back</span>(x);</span><br><span class="line">  level = <span class="built_in">max</span>(level, hi[x]);</span><br><span class="line">  ++gap[hi[x]];  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_max</span><span class="params">()</span> <span class="comment">//选出当前高度最大的节点之一,如果已经没有溢出节点返回0</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (B[level].<span class="built_in">empty</span>() &amp;&amp; level &gt; <span class="number">-1</span>)</span><br><span class="line">--level;</span><br><span class="line"><span class="keyword">return</span> level == <span class="number">-1</span> ? <span class="number">0</span> : B[level].<span class="built_in">back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hlpp</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">bfs</span>())</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; ++i)</span><br><span class="line">gap[i] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (hi[i] != INF)</span><br><span class="line">++gap[hi[i]];</span><br><span class="line">hi[S] = n;</span><br><span class="line"><span class="built_in">push</span>(S); <span class="comment">//初始化预流</span></span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="keyword">while</span> (x = <span class="built_in">find_max</span>())</span><br><span class="line">&#123;</span><br><span class="line">B[level].<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">push</span>(x)) <span class="comment">//仍然溢出</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!--gap[hi[x]])</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (i != S &amp;&amp; i != T &amp;&amp; hi[i] &gt; hi[x] &amp;&amp; hi[i] &lt; n + <span class="number">1</span>)</span><br><span class="line">hi[i] = n + <span class="number">1</span>;  <span class="comment">// 这里重贴成 n+1 的节点都不是溢出节点</span></span><br><span class="line">      <span class="built_in">relabel</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ex[T];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, w, c; i &lt;= m; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line"><span class="built_in">addd</span>(u, v, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">hlpp</span>());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>now：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1200</span> + <span class="number">5</span>, M = <span class="number">1.2e5</span> + <span class="number">5</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, S, T;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span> <span class="keyword">int</span> ne, ver, w; &#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>, hi[N], gap[N], lvl = <span class="number">0</span>, ex[N];</span><br><span class="line">std::vector&lt;<span class="keyword">int</span>&gt; B[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; e[idx] = &#123;h[x], y, z&#125;, h[x] = idx++; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dad</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>&#123; <span class="built_in">add</span>(x, y, z), <span class="built_in">add</span>(y, x, <span class="number">0</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(hi, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> hi);</span><br><span class="line">    hi[T] = <span class="number">0</span>, q.<span class="built_in">push</span>(T);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x, y; !q.<span class="built_in">empty</span>(); )</span><br><span class="line">    &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>(), q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">            <span class="keyword">if</span> (e[i ^ <span class="number">1</span>].w &amp;&amp; hi[y = e[i].ver] &gt; hi[x] + <span class="number">1</span>) hi[y] = hi[x] + <span class="number">1</span>, q.<span class="built_in">push</span>(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hi[S] != INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">puf</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//push flow</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> init = x == S;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y, k; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        y = e[i].ver; <span class="comment">//这句不能压行</span></span><br><span class="line">        <span class="keyword">if</span> (!e[i].w || (!init &amp;&amp; hi[x] != hi[y] + <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">        k = init ? e[i].w : std::<span class="built_in">min</span>(e[i].w, ex[x]);</span><br><span class="line">        <span class="keyword">if</span> (y != S &amp;&amp; y != T &amp;&amp; !ex[y]) B[hi[y]].<span class="built_in">push_back</span>(y), lvl = std::<span class="built_in">max</span>(lvl, hi[y]);</span><br><span class="line">        ex[x] -= k, ex[y] += k, e[i].w -= k, e[i ^ <span class="number">1</span>].w += k;</span><br><span class="line">        <span class="keyword">if</span> (!ex[x]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rel</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    hi[x] = INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne) <span class="keyword">if</span> (e[i].w) hi[x] = std::<span class="built_in">min</span>(hi[x], hi[e[i].ver]);</span><br><span class="line">    <span class="keyword">if</span> (++hi[x] &lt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        B[hi[x]].<span class="built_in">push_back</span>(x);</span><br><span class="line">        lvl = std::<span class="built_in">max</span>(lvl, hi[x]);</span><br><span class="line">        ++gap[hi[x]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmx</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (B[lvl].<span class="built_in">empty</span>() &amp;&amp; lvl &gt;= <span class="number">0</span>) --lvl;</span><br><span class="line">    <span class="keyword">return</span> lvl == <span class="number">-1</span> ? <span class="number">0</span> : B[lvl].<span class="built_in">back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hlpp</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">bfs</span>()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(gap, <span class="number">0</span>, <span class="keyword">sizeof</span> gap);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="keyword">if</span> (hi[i] != INF) ++gap[hi[i]];</span><br><span class="line">    hi[S] = n, <span class="built_in">puf</span>(S);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x; x = <span class="built_in">getmx</span>(); )</span><br><span class="line">    &#123;</span><br><span class="line">        B[lvl].<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">puf</span>(x))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!--gap[hi[x]]) </span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">                    <span class="keyword">if</span> (i != S &amp;&amp; i != T &amp;&amp; hi[i] &gt; hi[x] &amp;&amp; hi[i] &lt;= n) hi[i] = n + <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">rel</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ex[T];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;n, &amp;m, &amp;S, &amp;T);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> a, b, c; m--; <span class="built_in">dad</span>(a, b, c)) <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">hlpp</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>一般来说好用又好打的Dinic已经足够，但HLPP在加上优化后完虐Dinic，但不管是哪个，需要注意有可能的最大流炸int的情况</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
            <tag> 网络流 </tag>
            
            <tag> Dinic </tag>
            
            <tag> HLPP </tag>
            
            <tag> 费用流 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>拓展欧几里得</title>
      <link href="/2021/11/22/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/"/>
      <url>/2021/11/22/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/</url>
      
        <content type="html"><![CDATA[<p>拓欧</p><span id="more"></span><h1 id="欧几里德算法（辗转相除法）"><a href="#欧几里德算法（辗转相除法）" class="headerlink" title="欧几里德算法（辗转相除法）"></a>欧几里德算法（辗转相除法）</h1><h2 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h2><p> $\forall a,b \in \mathbb{N},b \ne 0,$ 有 $gcd(a,b)=gcd(b,a \bmod b)$</p><p>证明：</p><ul><li>若 $a&lt;b$ ，则 $gcd(b,a \bmod b)=gcd(b,a)=gcd(a,b)$</li><li>若 $a \ge b$ 设 $a=q \times b +r$ ,其中 $0 \le r &lt;b$ ,则 $gcd(b,a \bmod b)=gcd(b,r)$ 。对于 $a,b$ 的任何公约数 $d$ ，必有 $d|a,d|b$ ，故 $d|q \times b$ ，故 $d|(a-(q \times b))$ ，即 $d|r$ 。因此， $d$ 也是 $r,b$　的公约数，于是 $gcd(a,b)=gcd(r,b)$</li></ul><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>时间复杂度为 $O(\log{(a+b)})$ </p><h1 id="裴蜀定理"><a href="#裴蜀定理" class="headerlink" title="裴蜀定理"></a>裴蜀定理</h1><h2 id="内容-1"><a href="#内容-1" class="headerlink" title="内容"></a>内容</h2><p>$\forall a,b,c \in \mathbb{Z}$ 关于 $x,y$ 的不定方程 $ax+by=c$ 有整数解当且仅当 $gcd(a,b)|c$ ，且一定存在 $x,y$ 使 $c=gcd(a,b)$</p><p>该定理的正确性初中就学过了，这里再简要证明一下：</p><p>设 $d=gcd(a,b)$ ，则 $d|a,d|b$ ，故 $d|(ax+by)$ 。<br>再设 $s$ 为 $ax+by$ 当 $x,y\in \mathbb{Z}$ 时能取得的最小正值。设 $r=a \bmod s=a-\left \lfloor \frac{a}{s} \right \rfloor \times s=a-\left \lfloor \frac{a}{(ax+by)} \right \rfloor \times (ax+by) =a(1-\left \lfloor \frac{a}{ax+by} \right \rfloor x)+b(-\left \lfloor \frac{a}{ax+by} \right \rfloor y)$ ，这里的 $x,y$ 是常量，使 $ax+by=s$ 。<br>可见 $r$ 是 $a,b$ 的线性组合，由于 $r= a \bmod s$ ，故 $0 \le r&lt; s$ 。<br>而 $s=ax+by$ 是 $a,b$ 线性组合的最小正值，故 $r=0$ 。因此 $s|a$ 。<br>同理， $s|b$ 。<br>故 $s$  是 $a,b$　的公约数，故 $s|d$ 。<br>又因为 $d|(ax+by)$ ，故有 $d|s$ ，那么只能 $d=s$ ，命题得证。</p><h2 id="特解"><a href="#特解" class="headerlink" title="特解"></a>特解</h2><p>有了裴蜀定理，我们就可以解出 $ax+by=gcd(a,b)$ ，代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span>&amp; x,<span class="keyword">int</span>&amp; y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!b)&#123;</span><br><span class="line">   x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">      <span class="keyword">return</span> a;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">int</span> d=<span class="built_in">exgcd</span>(b,a%b,y,x);<span class="comment">//这里交换了x和y</span></span><br><span class="line">   y-=(a/b)*x;</span><br><span class="line">   <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们调用函数 $d=exgcd(a,b,x_0,y_0)$ 时，由于 $x,y$ 是实参，结束后 $x_0,y_0$ 即为一组特解， $d$ 为 $gcd(a,b)$ 。</p><p>那么，由于 $d|c$ , $ax+by=c$ 的通解为：</p><p>$$<br>\begin{align}<br>x=\frac{c}{d}x_0+k\frac{b}{d} \\<br>y=\frac{c}{d}y_0-k\frac{a}{d}<br>\end{align}<br>$$</p><p>其中 $k$ 取遍 $\mathbb{Z}$ ，$d=gcd(a,b)$ ，$x_0,y_0$ 是方程 $ax+by=gcd(a,b)$ 的一组特解</p><h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><p><a href="https://www.luogu.com.cn/problem/P1082">P1082</a><br>我们发现 $ax \equiv 1 \pmod{b}$ ，就等价于 $ax=by+1$ 移项得 $ax-by=1$ 。</p><p>代码如下：</p><figure class="highlight pascal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">typedef long long LL;</span><br><span class="line">LL a,m; </span><br><span class="line">LL exgcd(LL a,LL b,LL&amp; x,LL&amp; y)<span class="comment">&#123;</span></span><br><span class="line"><span class="comment">if(!b)&#123;</span></span><br><span class="line"><span class="comment">x=1,y=0;</span></span><br><span class="line"><span class="comment">return a;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line">LL d=exgcd(b,a%b,y,x); </span><br><span class="line">y-=a/b*x;</span><br><span class="line">return d;</span><br><span class="line">&#125;</span><br><span class="line">int main()<span class="comment">&#123;</span></span><br><span class="line"><span class="comment">scanf(&quot;%lld%lld&quot;,&amp;a,&amp;m);</span></span><br><span class="line"><span class="comment">LL x,y;</span></span><br><span class="line"><span class="comment">exgcd(a,m,x,y);</span></span><br><span class="line"><span class="comment">x=(x%m+m)%m; </span></span><br><span class="line"><span class="comment">printf(&quot;%lld&quot;,x);</span></span><br><span class="line"><span class="comment">return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 拓展欧几里得 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数位dp</title>
      <link href="/2021/11/22/%E6%95%B0%E4%BD%8Ddp/"/>
      <url>/2021/11/22/%E6%95%B0%E4%BD%8Ddp/</url>
      
        <content type="html"><![CDATA[<p>简单写写</p><span id="more"></span><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>思考以下问题：<br>对于给定范围的整数 $x \in [a,b]$ ，有多少个 $x$ 满足性质 $p$ （ $p$ 与数的各个位都有关，如“该数中有3个1”）。<br>对于此类问题，我们可以考虑如下方法：  </p><ol><li><p>用 $f[i]$ 表示对于所有的整数 $x \in [0,i]$ 中，满足性质 $p$ 的数的个数</p></li><li><p>则 $ans \ge f[b]-f[a-1]$ </p></li></ol><p>那么，我们来考虑如何去求 $f[N]$ 。</p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>设数 $N$ 是一个 $n$ 位数，且 $N=\overline{a_{n-1}a_{n-2}a_{n-3}…a_0} (a_<br>{n-1} \ne 0)$ 。<br>辣么，对于 $\forall x \in [0,N],x=\overline{b_{n-1}b_{n-2}b_{n-3}…b_0}$ ，有两种情况：</p><ol><li><p>$b_{n-1}=a_{n-1}$ </p></li><li><p>$0 \le b_{n-1} &lt; a_{n-1}$ </p></li></ol><p>我们发现，对于第二种情况，当 $b_{n-1}$ 确定时，方案数可以直接计算。如当 $N=7654321$ ， $p$ 为“该数中有3个1” 时，若 $0 \le b_6 &lt; 7$ 那么 $b_6=1$ 时，有 $C_{6}^{2}$ 种方案，而当 $b_6 \ne 1$ 时，有 $C_{6}^{3}$ 种方案。<br>对于第一种情况，我们只需继续讨论 $b_{n-2}$ 。<br>如图：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/6zh87oc2.png" alt="dp顺序"></p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/w0g1xgw3.png" alt="题"><br>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">35</span>;</span><br><span class="line"><span class="keyword">int</span> k, B; <span class="comment">//B进制数</span></span><br><span class="line"><span class="keyword">int</span> C[N][N];</span><br><span class="line"><span class="comment">//预处理组合数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j)</span><br><span class="line">            <span class="keyword">if</span> (!j)</span><br><span class="line">                C[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                C[i][j] = C[i - <span class="number">1</span>][j] + C[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算0到n中的数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!n)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; nums;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">        nums.<span class="built_in">push_back</span>(n % B), n /= B;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = nums.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = nums[i];</span><br><span class="line">        <span class="comment">//求左边分支</span></span><br><span class="line">        <span class="keyword">if</span> (x)</span><br><span class="line">        &#123;</span><br><span class="line">            res += C[i][k - last];</span><br><span class="line">            <span class="keyword">if</span> (x &gt; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &gt; last)</span><br><span class="line">                    res += C[i][k - last - <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                last++;</span><br><span class="line">                <span class="keyword">if</span> (last &gt; k)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//加上最右侧分支上的方案</span></span><br><span class="line">        <span class="keyword">if</span> (!i &amp;&amp; last == k)</span><br><span class="line">            res++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r &gt;&gt; k &gt;&gt; B;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">dp</span>(r) - <span class="built_in">dp</span>(l - <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树状数组（BIT）</title>
      <link href="/2021/11/22/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88BIT%EF%BC%89/"/>
      <url>/2021/11/22/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%88BIT%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>BIT常数小！（<del>然并卵</del>）</p><span id="more"></span><h2 id="思想铺垫"><a href="#思想铺垫" class="headerlink" title="思想铺垫:"></a>思想铺垫:</h2><p>将一个数$x$化为二进制数$(\overline{a_{k-1}a_{k-2}…a_1a_0})<em>2$ , 并设其中等于1的位是${a</em>{i_1},a_{i_2}…a_{i_m}}$ , 则$x=2^{i_1}+2^{i_2}+…+2^{i_m}$ , 不妨设$i_1&gt;i_2&gt;…&gt;i_m$ , 那么区间$[1,x]$可以拆分成$O(\log_{}{x})$个小区间:  </p><ol><li><p>长度为$2^{i_1}$的小区间$[1,2^{i_1}]$</p></li><li><p>长度为$2^{i_2}$的小区间$[2^{i_1}+1,2^{i_1}+2^{i_2}]$</p></li><li><p>长度为$2^{i_3}$的小区间$[2^{i_1}+2^{i_2}+1,2^{i_1}+2^{i_2}+2^{i_3}]$; </p><p>……</p></li><li><p>长度为$2^{i_m}$的小区间$[2^{i_1}+2^{i_2}+…+2^{i_{m-1}}+1,2^{i_1}+2^{i_2}+…+2^{i_m}]$ </p></li></ol><p>而这些小区间的共同特点是:对于$\forall[x,y ]$ , 其区间长度(记为$|[x,y]|$)就等于”y的二进制拆分下的最小的2的次幂” , 即$lowbit(y)$ .<br>例如大区间$[1,7]$ , 因为$7=2^{2}+2^{1}+2^{0}$ , 所以被分为三个小区间 : $[1,4]$、$[5,6]$、$[7,7]$ . 而其长度分别是$lowbit(4)=4$、$lowbit(4)=4$、$lowbit(4)=4$<br>补充——$lowbit()$:<br>$lowbit(n)$定义为”非负整数$n$在而进制表示下最低位的1及其后的0构成的数的值”. 如$n=22=(10110)_2$ , 则$lowbit(22)=(10)_2=2$<br>则其代码实现如下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="基本思路："><a href="#基本思路：" class="headerlink" title="基本思路："></a>基本思路：</h2><p>对于给定的原序列$a$ , 我们建立一个数组$c$ , 其中$c[x]$保存<strong>原序列$a$的区间$[x-lowbit(x)+1,x]$中所有数的和</strong> , 即$\textstyle\sum_{i=x-lowbit(x)+1}^{x}a[i]$<br>不难发现 , 数组$c$可以看作一个树形结构 , 且满足如下性质:</p><ol><li>每个节点$c[x]$保存以它为根的子树中所有叶节点的和.</li><li>每个节点$c[x]$的子节点个数等于$lowbit(x)$的位数 , 如$lowbit(4)=(100)_2$ , 其位数为$3$ , 故$c[4]有3个子节点$.</li><li>除树根外 , 每个节点$c[x]$的父节点就是$c[x+lowbit(x)]$.</li><li>树的深度为$O(\log_{}{N})$.</li></ol><p>如果$n$不是$2$的整数次幂 , 那么树状数组就是一个具有同样性质的森林.<br>如图:<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/4yowzx8l.png" alt="树状数组"><br>而树状数组支持的操作有两个:<br> <strong>查询前缀和</strong> : 即找到序列$a$第$1 \sim x$个数的和.  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(;x;x-=x&amp;-x) ans+=c[x];<span class="comment">//x&amp;-x即为lowbit(x)</span></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>若要查询$a$的区间$[l,r]$ , 只需计算$ask(r)-ask(l-1)$.<br><strong>单点增加</strong> : 给序列中一个数$a[x]$加上y , 不难发现至多只有$\log{}{N}$个节点包含$a[x]$ , 故时间复杂度为$O(\log{}{N})$.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(;x&lt;=N;x+=x&amp;-x) c[x]+=y;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而在执行操作前 , 我们先要构造出$c$数组.<br>简单方法是 , 先让$c$全为$0$ , 然后对每个$x$执行$add(x,a[x])$ , 时间复杂度为$O(N\log{}{N})$ , 通常用这种方法就已足够.<br>更高效的方法是 , 从小到大依次考虑节点$x$ , 借助$lowbit$运算扫描它的子节点求和.若采用这种办法 , 上面树形结构的每条边只会被遍历一次 , 时间复杂度为 $O(\sum_{k = 1} ^ {\log{N}}k * N / 2 ^ {k}) = O(N)$<br>另外 , 若是题目需要<strong>区间增加</strong> , 可以改存$a$的差分数组.</p><p><a href="https://www.luogu.com.cn/problem/P3374">树状数组1</a><br><a href="https://www.luogu.com.cn/problem/P3368">树状数组2</a></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 树状数组 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树套树</title>
      <link href="/2021/11/22/%E6%A0%91%E5%A5%97%E6%A0%91/"/>
      <url>/2021/11/22/%E6%A0%91%E5%A5%97%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>禁止套娃！</p><span id="more"></span><h1 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想"></a>基本思想</h1><p>顾名思义，树套树就是用一个树套进另一个树，即一个外层的树、一个内层的树。</p><h1 id="简单版"><a href="#简单版" class="headerlink" title="简单版"></a>简单版</h1><p>思考如下问题：<br>维护一个长度为 $n$ 的序列，数列中的位置从左到右依次标号为 $1∼n$ ,其中需要提供以下操作：  </p><ol><li><p>$1\ pos\ x$ ，将 $pos$ 位置的数修改为 $x$ 。</p></li><li><p>$1\ a\ b\ x$ ，查询整数 $x$ 在区间 $[a,b]$ 内的前驱(前驱定义为小于 $x$ ，且最大的数)。  </p></li></ol><p>这个问题发现，第二个操作可以用 $set$ 完成，但 $set$ 仅支持查询整个区间，无法完成在区间 $[a,b]$ 上查询，所以我们考虑用一个线段树套在 $set$ 外层。  </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">5</span>, M = N * <span class="number">4</span>; <span class="comment">//线段树空间开4倍</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="comment">//multiset是&lt;set&gt;库中一个类型,可以看成一个序列,</span></span><br><span class="line">    <span class="comment">//插入删除数都能够在O(logn)的时间内完成,</span></span><br><span class="line">    <span class="comment">//而且能保证序列中的数是有序的,而且序列中可以存在重复的数。</span></span><br><span class="line">    multiset&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _l, <span class="keyword">int</span> _r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        l = _l;</span><br><span class="line">        r = _r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; tr[M];</span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[u].<span class="built_in">inint</span>(l, r);</span><br><span class="line">    tr[u].s.<span class="built_in">insert</span>(-INF), tr[u].s.<span class="built_in">insert</span>(INF); <span class="comment">//防止越界</span></span><br><span class="line">    <span class="comment">//将线段树该节点(即该段)内的所有点插入该节点下套的set中</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">        tr[u].s.<span class="built_in">insert</span>(w[i]);</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//删除w[p],注意不能写erase(w[p]),否则会把所有值为w[p]的都删除</span></span><br><span class="line">    tr[u].s.<span class="built_in">erase</span>(tr[u].s.<span class="built_in">find</span>(w[p]));</span><br><span class="line">    tr[u].s.<span class="built_in">insert</span>(x);</span><br><span class="line">    <span class="keyword">if</span> (tr[u].l == tr[u].r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (tr[u].l + tr[u].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid)</span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span>, p, x);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, p, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//若tr[u]在完全在区间[a,b]内</span></span><br><span class="line">    <span class="keyword">if</span> (tr[u].l &gt;= a &amp;&amp; tr[u].r &lt;= b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//注意it的类型,it是地址,类型得记</span></span><br><span class="line">        std::multiset&lt;<span class="keyword">int</span>&gt;::iterator it = tr[u].s.<span class="built_in">lower_bound</span>(x);</span><br><span class="line">        <span class="comment">//it是&quot;大于等于x的最小数&quot;,减一后就是&quot;小于x的最大数&quot;</span></span><br><span class="line">        --it;</span><br><span class="line">        <span class="keyword">return</span> *it;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (tr[u].l + tr[u].r) &gt;&gt; <span class="number">1</span>, res = -INF;</span><br><span class="line">    <span class="keyword">if</span> (a &lt;= mid)</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span>, a, b, x));</span><br><span class="line">    <span class="keyword">if</span> (b &gt; mid)</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, a, b, x));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m); <span class="comment">//数列长度以及操作次数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> op, a, b, c, ans;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">            <span class="built_in">change</span>(<span class="number">1</span>, a, b);</span><br><span class="line">            w[a] = b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">            ans = <span class="built_in">query</span>(<span class="number">1</span>, a, b, c);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (ans &gt; -INF &amp;&amp; ans &lt; INF) ? ans : <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="正常版"><a href="#正常版" class="headerlink" title="正常版"></a>正常版</h1><h2 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h2><p>问题加强如下（也可见<a href="https://www.luogu.com.cn/problem/P3380">P3380</a>）：<br>维护一个长度为 $n$ 的序列，数列中的位置从左到右依次标号为 $1∼n$ ,其中需要提供以下操作：  </p><ol><li><p> $1\ l\ r\ x$ ，查询整数 $x$ 在区间 $[l,r]$ 内的排名。</p></li><li><p> $2\ l\ r\ k$ ，查询区间 $[l,r]$ 内排名为 $k$ 的值。</p></li><li><p> $3\ pos\ x$ ，将 $pos$ 位置的数修改为 $x$ 。</p></li><li><p> $4\ l\ r\ x$ ，查询整数 $x$ 在区间 $[l,r]$ 内的前驱(前驱定义为小于 $x$ ，且最大的数)。</p></li><li><p> $5\ l\ r\ x$ ，查询整数 $x$ 在区间 $[l,r]$ 内的后继(后继定义为大于 $x$ ，且最小的数)。</p></li></ol><h2 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h2><p>本题的四、五操作与简单版类似，可以用 $set$ 完成，但对于操作一、二， $set$ 却不支持排名，因为它不记录子树大小，so——我们只好手打平衡树。</p><p>而手打的平衡树可以完成操作一，但对于操作二，因为线段树会把区间 $[l,r]$ 分成最多 $\log N$ 个区间，每个区间内的平衡树互不联通，且通过简单的计算每个区间的答案并不能得到最终答案，所以我们思考其他方法——二分。<br>对于每个 $mid$ 用操作一找出它的排名，若排名小于等于 $k$ ，则答案小于等于 $mid$ ，反之则大于等于 $mid$ 。</p><p>由此，操作一、三、四、五的时间复杂度为 $\log^2 N$ ，操作二的时间复杂度为 $\log^3 N$ ,总时间复杂度为 $O(m\log^3 n)$ ，空间复杂度为 $O(N* 4* 2+N\log N)$ ,故空间约需 $50000* 4* 2+50000* 18 \le 1500000 $ 。</p><p>另外，一定要注意，有几个函数传的是实参！（ $update$ 、 $splay$ 和 $insert$）。</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15e5</span> + <span class="number">5</span>, INF = <span class="number">2147483647</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Splay</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> s[<span class="number">2</span>], fa, size, v;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _v, <span class="keyword">int</span> _fa)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        v = _v;</span><br><span class="line">        fa = _fa;</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; tr[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg_Tree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="keyword">int</span> rt;        <span class="comment">//root,对应的Splay的根</span></span><br><span class="line">&#125; ttr[N];          <span class="comment">//ttr表示外层树</span></span><br><span class="line"><span class="keyword">int</span> n, m, idx = <span class="number">0</span>; <span class="comment">//idx:记录Splay的节点</span></span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line"><span class="comment">/*------------------------Splay------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].size = tr[tr[x].s[<span class="number">0</span>]].size + tr[tr[x].s[<span class="number">1</span>]].size + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = tr[x].fa;</span><br><span class="line">    <span class="keyword">int</span> z = tr[y].fa;</span><br><span class="line">    <span class="keyword">int</span> k = tr[y].s[<span class="number">1</span>] == x;</span><br><span class="line">    tr[z].s[tr[z].s[<span class="number">1</span>] == y] = x, tr[x].fa = z;</span><br><span class="line">    tr[y].s[k] = tr[x].s[k ^ <span class="number">1</span>], tr[tr[x].s[k ^ <span class="number">1</span>]].fa = y;</span><br><span class="line">    tr[x].s[k ^ <span class="number">1</span>] = y, tr[y].fa = x;</span><br><span class="line">    <span class="built_in">push_up</span>(y), <span class="built_in">push_up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> &amp;root, <span class="keyword">int</span> x, <span class="keyword">int</span> k)</span> <span class="comment">//一定注意这里传实参</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (tr[x].fa != k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> y = tr[x].fa;</span><br><span class="line">        <span class="keyword">int</span> z = tr[y].fa;</span><br><span class="line">        <span class="keyword">if</span> (z != k)</span><br><span class="line">            (tr[y].s[<span class="number">1</span>] == x) ^ (tr[z].s[<span class="number">1</span>] == y) ? <span class="built_in">rotate</span>(x) : <span class="built_in">rotate</span>(y);</span><br><span class="line">        <span class="built_in">rotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!k)</span><br><span class="line">        root = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在splay中插入v</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;root, <span class="keyword">int</span> v)</span> <span class="comment">//实参!</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = root, p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (u)</span><br><span class="line">        p = u, u = tr[u].s[v &gt; tr[u].v];</span><br><span class="line">    u = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (p)</span><br><span class="line">        tr[p].s[v &gt; tr[p].v] = u;</span><br><span class="line">    tr[u].<span class="built_in">inint</span>(v, p);</span><br><span class="line">    <span class="built_in">splay</span>(root, u, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在该splay中找到比v小的数的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = root, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].v &lt; v)</span><br><span class="line">            res += tr[tr[u].s[<span class="number">0</span>]].size + <span class="number">1</span>, u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在该splay中更新x为y</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> &amp;root, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">//实参!</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//删除x(忘了去看Splay)</span></span><br><span class="line">    <span class="keyword">int</span> u = root;</span><br><span class="line">    <span class="keyword">while</span> (u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].v == x)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].v &lt; x)</span><br><span class="line">            u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">splay</span>(root, u, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> l = tr[u].s[<span class="number">0</span>], r = tr[u].s[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (tr[l].s[<span class="number">1</span>])</span><br><span class="line">        l = tr[l].s[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (tr[r].s[<span class="number">0</span>])</span><br><span class="line">        r = tr[r].s[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">splay</span>(root, l, <span class="number">0</span>), <span class="built_in">splay</span>(root, r, l);</span><br><span class="line">    tr[r].s[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">push_up</span>(r), <span class="built_in">push_up</span>(l);</span><br><span class="line">    <span class="comment">//插入y</span></span><br><span class="line">    <span class="built_in">insert</span>(root, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在该splay中找到比v小的数中最大的</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_pre</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = root, res = -INF;</span><br><span class="line">    <span class="keyword">while</span> (u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].v &lt; v)</span><br><span class="line">            res = <span class="built_in">max</span>(res, tr[u].v), u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在该splay中找到比v大的数中最小的</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_suc</span><span class="params">(<span class="keyword">int</span> root, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = root, res = INF;</span><br><span class="line">    <span class="keyword">while</span> (u)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tr[u].v &gt; v)</span><br><span class="line">            res = <span class="built_in">min</span>(res, tr[u].v), u = tr[u].s[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            u = tr[u].s[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------------------------Segment tree------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ttr[u].l = l, ttr[u].r = r;</span><br><span class="line">    <span class="built_in">insert</span>(ttr[u].rt, -INF), <span class="built_in">insert</span>(ttr[u].rt, INF); <span class="comment">//防止越界</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">        <span class="built_in">insert</span>(ttr[u].rt, w[i]);</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span>, l, mid), <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//找到比x小的数的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ttr[u].l &gt;= l &amp;&amp; ttr[u].r &lt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_k</span>(ttr[u].rt, x) - <span class="number">1</span>; <span class="comment">//因为多插入了-INF</span></span><br><span class="line">    <span class="keyword">int</span> mid = (ttr[u].l + ttr[u].r) &gt;&gt; <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">        res += <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span>, l, r, x);</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">        res += <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, x);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//将w[p]变为x</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">update</span>(ttr[u].rt, w[p], x);</span><br><span class="line">    <span class="keyword">if</span> (ttr[u].l == ttr[u].r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (ttr[u].l + ttr[u].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= mid)</span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span>, p, x);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, p, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//找到比x小的数中最大的</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_pre</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ttr[u].l &gt;= l &amp;&amp; ttr[u].r &lt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_pre</span>(ttr[u].rt, x);</span><br><span class="line">    <span class="keyword">int</span> mid = (ttr[u].l + ttr[u].r) &gt;&gt; <span class="number">1</span>, res = -INF;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">query_pre</span>(u &lt;&lt; <span class="number">1</span>, l, r, x));</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">        res = <span class="built_in">max</span>(res, <span class="built_in">query_pre</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, x));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//找到比v大的数中最小的</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_suc</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ttr[u].l &gt;= l &amp;&amp; ttr[u].r &lt;= r)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">get_suc</span>(ttr[u].rt, x);</span><br><span class="line">    <span class="keyword">int</span> mid = (ttr[u].l + ttr[u].r) &gt;&gt; <span class="number">1</span>, res = INF;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= mid)</span><br><span class="line">        res = <span class="built_in">min</span>(res, <span class="built_in">query_suc</span>(u &lt;&lt; <span class="number">1</span>, l, r, x));</span><br><span class="line">    <span class="keyword">if</span> (r &gt; mid)</span><br><span class="line">        res = <span class="built_in">min</span>(res, <span class="built_in">query_suc</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, x));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> op, a, b, x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">query</span>(<span class="number">1</span>, a, b, x) + <span class="number">1</span>); <span class="comment">//query是&quot;比x小的数的个数&quot;,加1为x的排名</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;x);</span><br><span class="line">            <span class="comment">//二分答案</span></span><br><span class="line">            <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">1e8</span>, ans;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">query</span>(<span class="number">1</span>, a, b, mid) + <span class="number">1</span> &lt;= x)</span><br><span class="line">                    ans = mid, l = mid + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;x);</span><br><span class="line">            <span class="built_in">change</span>(<span class="number">1</span>, a, x);</span><br><span class="line">            w[a] = x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">query_pre</span>(<span class="number">1</span>, a, b, x));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">query_suc</span>(<span class="number">1</span>, a, b, x));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="变式"><a href="#变式" class="headerlink" title="变式"></a>变式</h1><h2 id="问题：-1"><a href="#问题：-1" class="headerlink" title="问题："></a>问题：</h2><p><a href="https://www.acwing.com/problem/content/2308/">AcWing2306</a>：<br>你需要维护 $n$ 个可重整数集，集合的编号从1到 $n$ 。<br>这些集合初始都是空集，有 $m$ 个操作:</p><ol><li><p>$1\ l\ r\ c$ ：表示将 $c$ 加入到编号在 $[l,r]$ 内的集合中</p></li><li><p>$2\ l\ r\ c$ ：表示查询编号在 $[l,r]$ 内的集合的并集中，第 $c$ 大的数是多少。</p></li></ol><p>注意可重集的并是不去除重复元素的，如 ${1,1,4} \cup {5,1,4}={1,1,4,5,1,4}$ 。</p><h2 id="分析：-1"><a href="#分析：-1" class="headerlink" title="分析："></a>分析：</h2><p>先尝试上题思路：外层树线段树，套内层平衡树。<br>但很快啊，啪的一下，我们就发现，这样的话区间修改非常麻烦，操作一（在区间 $[l,r]$ 中的每一个集合里加一个数 $c$ ）的实现过于复杂。<br>于是，我们（听别人说）可以用权值线段树。</p><h2 id="权值线段树："><a href="#权值线段树：" class="headerlink" title="权值线段树："></a>权值线段树：</h2><ol><li><p>将数值离散化</p></li><li><p>以数值（即权值）为节点建立线段树</p></li><li><p>线段数的每一个节点上，再用一棵线段树来维护权值在该节点内的所有数的下标</p></li><li><p>对于操作一，我们在外层数上找到包含 $c$ 的节点，最多有 $\log n$ 个，然后再个节点内层的线段树上找到区间 $[l,r]$ ，打上懒标记</p></li><li><p>对于操作二，我们用类似二分的思想，每次找一半区间（即外层线段数左右节点中的一个），求该区间下套的内层树上 $[l,r]$ 的和 $k$ ，若 $k \ge c$ 就进入（外层树的）右节点，否则进入左节点</p></li></ol><p>时间复杂度为 $O(\log^2 N)$</p><h2 id="标记持久化："><a href="#标记持久化：" class="headerlink" title="标记持久化："></a>标记持久化：</h2><p>我们发现的区间增加也好、区间求和也好，都是在内层树上，而且只有这两个<strong>同类型</strong>（必须同类，例如有加有乘就不行）的操作，所以我们考虑更改 $sum$ 和 $add$ 的含义，使这些标记不必向下传（即省略 $push_down$）。<br>（以下定义都是针对内层树）<br> $sum$ ：定义 $sum$ 为“只考虑本节点及以下节点懒标记的情况下的区间和”。<br> $add$ ：定义 $add$ 为“本节点的所有子节点都要加上一个 $add$ ”。<br>对于区间求和，只需用本节点的 $sum$ 加上所有祖宗节点的 $add$ 和与区间长度的积即可，具体实现的话，只需在递归时顺便累加 $add$ 即可。</p><h2 id="线段树的动态开点："><a href="#线段树的动态开点：" class="headerlink" title="线段树的动态开点："></a>线段树的动态开点：</h2><p>我们发现，直接开线段树套线段树，空间复杂度为 $O(N^2)$ ，对于本题来说无法接受，因此，我们自然想到，只开出用到的节点，即动态开点，空间复杂度为 $O(M\log N)$ </p><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50000</span> + <span class="number">5</span>, Nn = N * <span class="number">17</span> * <span class="number">17</span>, M = N * <span class="number">4</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg_Tree1</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LL l, r, rt;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(u) tr[u].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(u) tr[u].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rt(u) tr[u].rt</span></span><br><span class="line">&#125; tr[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg_Tree2</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LL l, r, sum, add; <span class="comment">//由于动态开点,内层数的l、r表示的是节点下标</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll(u) ttr[u].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rr(u) ttr[u].r</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(u) ttr[u].sum</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> add(u) ttr[u].add</span></span><br><span class="line">&#125; ttr[Nn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span> //为了离散化,需要保存问题</span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    LL op, a, b, c;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> op(u) q[i].op</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> a(u) q[i].a</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> b(u) q[i].b</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> c(u) q[i].c</span></span><br><span class="line">&#125; q[N];</span><br><span class="line">vector&lt;LL&gt; que;</span><br><span class="line">LL n, m;</span><br><span class="line">LL idx = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//离散化的对应</span></span><br><span class="line"><span class="function">LL <span class="title">get</span><span class="params">(LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">lower_bound</span>(que.<span class="built_in">begin</span>(), que.<span class="built_in">end</span>(), x) - que.<span class="built_in">begin</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//intersection,求两区间的交集</span></span><br><span class="line"><span class="function">LL <span class="title">inter</span><span class="params">(LL l1, LL r1, LL l2, LL r2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(r1, r2) - <span class="built_in">max</span>(l1, l2) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//更新内层树</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(LL u, LL l, LL r, LL pl, LL pr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">sum</span>(u) += <span class="built_in">inter</span>(l, r, pl, pr);</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= pl &amp;&amp; r &lt;= pr)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">add</span>(u)++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pl &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">ll</span>(u))</span><br><span class="line">            <span class="built_in">ll</span>(u) = ++idx; <span class="comment">//动态开点</span></span><br><span class="line">        <span class="built_in">update</span>(<span class="built_in">ll</span>(u), l, mid, pl, pr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pr &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">rr</span>(u))</span><br><span class="line">            <span class="built_in">rr</span>(u) = ++idx;</span><br><span class="line">        <span class="built_in">update</span>(<span class="built_in">rr</span>(u), mid + <span class="number">1</span>, r, pl, pr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_sum</span><span class="params">(LL u, LL l, LL r, LL pl, LL pr, LL add)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= pl &amp;&amp; r &lt;= pr)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(u) + (r - l + <span class="number">1</span>) * add;</span><br><span class="line">    LL mid = (l + r) &gt;&gt; <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line">    add += <span class="built_in">add</span>(u);</span><br><span class="line">    <span class="keyword">if</span> (pl &lt;= mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">ll</span>(u))</span><br><span class="line">            res += <span class="built_in">get_sum</span>(<span class="built_in">ll</span>(u), l, mid, pl, pr, add);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res += <span class="built_in">inter</span>(l, mid, pl, pr) * add; <span class="comment">//如果未开ll(u),说明它未修改过</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pr &gt; mid)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">rr</span>(u))</span><br><span class="line">            res += <span class="built_in">get_sum</span>(<span class="built_in">rr</span>(u), mid + <span class="number">1</span>, r, pl, pr, add);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res += <span class="built_in">inter</span>(mid + <span class="number">1</span>, r, pl, pr) * add;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(LL u, LL l, LL r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">l</span>(u) = l, <span class="built_in">r</span>(u) = r, <span class="built_in">rt</span>(u) = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    LL mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span>, l, mid), <span class="built_in">build</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(LL u, LL l, LL r, LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">update</span>(<span class="built_in">rt</span>(u), <span class="number">1</span>, n, l, r);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">l</span>(u) == <span class="built_in">r</span>(u))</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (<span class="built_in">l</span>(u) + <span class="built_in">r</span>(u)) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &lt;= mid)</span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span>, l, r, x);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">change</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(LL u, LL l, LL r, LL x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">l</span>(u) == <span class="built_in">r</span>(u))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">r</span>(u);</span><br><span class="line">    LL mid = (<span class="built_in">l</span>(u) + <span class="built_in">r</span>(u)) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    LL k = <span class="built_in">get_sum</span>(<span class="built_in">rt</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>), <span class="number">1</span>, n, l, r, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (k &gt;= x)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, x);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">query</span>(u &lt;&lt; <span class="number">1</span>, l, r, x - k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; m; ++i) <span class="comment">//为了配合vector,循环也都从0开始</span></span><br><span class="line">    &#123; </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;<span class="built_in">op</span>(i), &amp;<span class="built_in">a</span>(i), &amp;<span class="built_in">b</span>(i), &amp;<span class="built_in">c</span>(i));</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">op</span>(i) == <span class="number">1</span>)</span><br><span class="line">            que.<span class="built_in">push_back</span>(<span class="built_in">c</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//排序,去重</span></span><br><span class="line">    <span class="built_in">sort</span>(que.<span class="built_in">begin</span>(), que.<span class="built_in">end</span>());</span><br><span class="line">    que.<span class="built_in">erase</span>(<span class="built_in">unique</span>(que.<span class="built_in">begin</span>(), que.<span class="built_in">end</span>()), que.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>, que.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">op</span>(i) == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">change</span>(<span class="number">1</span>, <span class="built_in">a</span>(i), <span class="built_in">b</span>(i), <span class="built_in">get</span>(<span class="built_in">c</span>(i)));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, que[<span class="built_in">query</span>(<span class="number">1</span>, <span class="built_in">a</span>(i), <span class="built_in">b</span>(i), <span class="built_in">c</span>(i))]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 树套树 </tag>
            
            <tag> 线段树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树链剖分</title>
      <link href="/2021/11/22/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"/>
      <url>/2021/11/22/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/</url>
      
        <content type="html"><![CDATA[<p>线段树进化！</p><span id="more"></span><h1 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h1><h2 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h2><p>线段树，DFS序</p><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>树链剖分的核心思想是将一棵树的节点重新排序，再将树转换为一个序列，使得树上的任意一条路径可以被最多 $\log{n}$ 段区间表示出来，由此我们可以将树上的路径操作化为区间操作。</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><ul><li><p>重儿子（节点）：子树结点数目最多的结点</p></li><li><p>轻儿子（节点）：除了重儿子以外的结点</p></li><li><p>重边：父亲结点和重儿子连成的边</p></li><li><p>轻边：父亲节点和轻儿子连成的边</p></li><li><p>重链：由多条重边连接而成的路径，如果一个点没连接重边，那该节点也可以是一条重链</p></li><li><p>轻链：由多条轻边连接而成的路径</p></li></ul><p>如图：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/7g3wqit1.png" alt="例子"><br>可以看到：对于节点1，节点4的子树的节点比2,3的多，所以4是重儿子，对于4节点9的子树的节点比8,9的多，所以9是重儿子，以此类推，图中黑色的节点是重儿子，其余的节点是轻儿子。  </p><p>红边是重边，黑边是轻边</p><p>1 - 4 - 9 - 13 - 14；<br>8；<br>10；<br>3 - 7；<br>2 - 6 - 11；<br>5；都是重链</p><p>我们发现：叶节点没有重儿子，非叶节点有且只有1个重儿子</p><p>但要注意，并不是轻儿子之后全是轻儿子，比如2后面就有6和11两个重儿子，也就是说，<strong>当一个节点选了他的重儿子之后，我们并不能保证它的轻儿子就是叶节点，所以我们就以这个轻儿子为根，再去选这个轻儿子的轻重儿子</strong></p><h2 id="化树为列"><a href="#化树为列" class="headerlink" title="化树为列"></a>化树为列</h2><p>我们先用dfs序来实现将树化为序列，但dfs时我们优先搜索重儿子，这样的好处是可以保证一段重链在区间上是连续的，如上面的图上，dfs序应为：1-4-9-13-14-8-10-3-7-2-6-11-5</p><p>那么一条路径就可以拆分成最多 $\log{n}$ 条重链，对应到序列上是最多 $\log{n}$ 个区间。</p><p>现在，问题就是如何找到一条路径对应的区间。</p><h2 id="寻找区间"><a href="#寻找区间" class="headerlink" title="寻找区间"></a>寻找区间</h2><p>对于节点 $x,y$ 若要求 $x$ 到 $y$ 的路径对应的区间，可以用如下方法： </p><ol><li><p>找到 $x,y$ 中所在重链的顶点较低的点（即层数较深的点），不妨设为 $x$ ，并设 $x$ 所在重链顶点为 $z$   </p></li><li><p>对区间 $[z,x]$ 操作，更新 $x$ 为 $z$ 的父节点</p></li><li><p>重复2、3步，直到 $x,y$ 在同一条重链上（这条重链一定是它们的最近公共祖先所在重链）  </p></li><li><p>对区间 $[x,y]$ （或 $[y,x]$ ）操作即可</p></li></ol><p>如上面的图中，要找节点13到节点5的路径，可以让 $x=13$ , $y=5$ 过程如下：  </p><ol><li><p>第一步后，找到较低的点是 $y=5$ ，顶点 $z=5$ </p></li><li><p>第二步，操作区间 $[z,y]=[5,5]$ ，更新 $y=2$</p></li><li><p>第三步，重复，操作区间 $[z,y]=[2,2]$ ，更新 $y=1$ </p></li><li><p>第五步, $x,y$ 已在一条重链上，操作区间 $[y,x]=[1,13]$</p></li></ol><p>一般来说，对于每个区间，我们用线段树、分块等方式去维护，最多有 $\log{n}$ 个区间，故一般时间复杂度为 $O(log^2{n})$ </p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P3384">P3384</a><br>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">int</span> n,m,root,p;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ver,ne;</span><br><span class="line">&#125;e[N*<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> h[N],idx=<span class="number">0</span>,w[N];</span><br><span class="line"><span class="keyword">int</span> id[N],nw[N],cnt=<span class="number">0</span>; <span class="comment">//id:节点在dfs序中的编号,nw:dfs序列每个编号对应的权值</span></span><br><span class="line"><span class="keyword">int</span> dep[N],size[N],top[N],fa[N],h_son[N]; <span class="comment">//dep:节点深度,size:节点为根的子</span></span><br><span class="line">                                          <span class="comment">//树的大小,top:节点所在重链的顶点</span></span><br><span class="line">                                          <span class="comment">//fa:父节点,h_son:重儿子</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    LL add,sum;</span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    e[idx].ver=y,e[idx].ne=h[x],h[x]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> father,<span class="keyword">int</span> depth)</span></span>&#123; <span class="comment">//求每个的重儿子</span></span><br><span class="line">    dep[x]=depth;</span><br><span class="line">    fa[x]=father;</span><br><span class="line">    size[x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x];i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">        <span class="keyword">int</span> y=e[i].ver;</span><br><span class="line">        <span class="keyword">if</span>(y==father) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(y,x,depth+<span class="number">1</span>);</span><br><span class="line">        size[x]+=size[y];</span><br><span class="line">        <span class="keyword">if</span>(size[h_son[x]]&lt;size[y]) h_son[x]=y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> t)</span></span>&#123; <span class="comment">//求dfs序,t:当前节点所在重链的顶点</span></span><br><span class="line">    id[x]=++cnt;</span><br><span class="line">    nw[cnt]=w[x];</span><br><span class="line">    top[x]=t;</span><br><span class="line">    <span class="keyword">if</span>(!h_son[x]) <span class="keyword">return</span> ; <span class="comment">//若是叶节点,直接返回</span></span><br><span class="line">    <span class="built_in">dfs2</span>(h_son[x],t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x];i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">        <span class="keyword">int</span> y=e[i].ver;</span><br><span class="line">        <span class="keyword">if</span>(y==fa[x]||y==h_son[x]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(y,y); <span class="comment">//轻儿子一定是其所在重链的顶点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    tr[u].sum=tr[u&lt;&lt;<span class="number">1</span>].sum+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</span><br><span class="line">    tr[u].sum%=p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[u].add)&#123;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>].add+=tr[u].add;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>].add%=p;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>].sum+=tr[u].add*(tr[u&lt;&lt;<span class="number">1</span>].r-tr[u&lt;&lt;<span class="number">1</span>].l+<span class="number">1</span>);</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>].sum%=p;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].add+=tr[u].add;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].add%=p;</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum+=tr[u].add*(tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].r-tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].l+<span class="number">1</span>);</span><br><span class="line">        tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum%=p;</span><br><span class="line">        tr[u].add=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    tr[u].l=l;</span><br><span class="line">    tr[u].r=r;</span><br><span class="line">    tr[u].add=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        tr[u].sum=nw[r];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line">    <span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r)&#123;</span><br><span class="line">        tr[u].add+=k;</span><br><span class="line">        tr[u].add%=p;</span><br><span class="line">        tr[u].sum+=k*(tr[u].r-tr[u].l+<span class="number">1</span>);</span><br><span class="line">        tr[u].sum%=p;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">push_down</span>(u);</span><br><span class="line">    <span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>,l,r,k);</span><br><span class="line">    <span class="keyword">if</span>(r&gt;mid) <span class="built_in">modify</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,k);</span><br><span class="line">    <span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r) <span class="keyword">return</span> tr[u].sum;</span><br><span class="line">    <span class="built_in">push_down</span>(u);</span><br><span class="line">    <span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    LL res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&lt;=mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>,l,r),res%=p;</span><br><span class="line">    <span class="keyword">if</span>(r&gt;mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r),res%=p;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_path</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[u]!=top[v])&#123;  <span class="comment">//当这两个点不在同一重链</span></span><br><span class="line">        <span class="keyword">if</span>(dep[top[u]]&lt;dep[top[v]]) <span class="built_in">swap</span>(u,v);</span><br><span class="line">        <span class="built_in">modify</span>(<span class="number">1</span>,id[top[u]],id[u],k); <span class="comment">//注意在dfs序中top[u]在u前面</span></span><br><span class="line">        u=fa[top[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&lt;dep[v]) <span class="built_in">swap</span>(u,v);</span><br><span class="line">    <span class="built_in">modify</span>(<span class="number">1</span>,id[v],id[u],k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ask_path</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    LL res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(top[u]!=top[v])&#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[top[u]]&lt;dep[top[v]]) <span class="built_in">swap</span>(u,v);</span><br><span class="line">        res+=<span class="built_in">ask</span>(<span class="number">1</span>,id[top[u]],id[u]);</span><br><span class="line">        res%=p;</span><br><span class="line">        u=fa[top[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&lt;dep[v]) <span class="built_in">swap</span>(u,v);</span><br><span class="line">    res+=<span class="built_in">ask</span>(<span class="number">1</span>,id[v],id[u]);</span><br><span class="line">    <span class="keyword">return</span> res%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_tree</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="built_in">modify</span>(<span class="number">1</span>,id[u],id[u]+size[u]<span class="number">-1</span>,k); <span class="comment">//在dfs序中,以一个节点为根的子树一定</span></span><br><span class="line">                                       <span class="comment">//跟在这个节点后面</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ask_tree</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">1</span>,id[u],id[u]+size[u]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;root,&amp;p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;w[i]);</span><br><span class="line">        w[i]%=p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">add</span>(x,y);</span><br><span class="line">        <span class="built_in">add</span>(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(root,<span class="number">-1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(root,root);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,cnt);</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op,u,v,k;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;op,&amp;u);</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;v,&amp;k);</span><br><span class="line">            <span class="built_in">modify_path</span>(u,v,k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;v);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">ask_path</span>(u,v));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;k);</span><br><span class="line">            <span class="built_in">modify_tree</span>(u,k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">ask_tree</span>(u));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 树链剖分 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>期望DP和概率DP</title>
      <link href="/2021/11/22/%E6%9C%9F%E6%9C%9BDP%E5%92%8C%E6%A6%82%E7%8E%87DP/"/>
      <url>/2021/11/22/%E6%9C%9F%E6%9C%9BDP%E5%92%8C%E6%A6%82%E7%8E%87DP/</url>
      
        <content type="html"><![CDATA[<p>${\color{red} 快跑啊}$</p><span id="more"></span><h1 id="期望DP和概率DP"><a href="#期望DP和概率DP" class="headerlink" title="期望DP和概率DP"></a>期望DP和概率DP</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul><li><p>随机变量：有多种可能值的变量，一般记为 $X$</p></li><li><p>概率：一个事件发生的可能性，一般记为 $P(A)$ ，以下简记 $P(X==x_i)$ 为 $P(x_i)$ </p></li><li><p>期望：一个事件发生的概率乘上权值，记为 $E(X)$ </p></li><li><p>方差：用于描述一组数据的波动程度，记为 $Var(X)$ ，有<br>$$<br>Var(X)=\frac{\sum(x_i-\bar{x})}{n}<br>$$</p></li><li><p>依赖：一个随机变量 $X$ 的取值取决（或有关）于变量 $Y$ ，或者说在保证 $Y$ 发生的情况下发生 $X$ ，记为 $X|Y$ ，一下简记 $P(X==x_i|Y==y_i)$ 为 $P(x_i|y_i)$</p></li><li><p>并：两个事件同时发生（即“且”），记为 $A\cap B$（也可以记为 $AB$ ）</p></li><li><p>交：两个事件分别发生（即“或”），记为 $A\cup B$</p></li><li><p>区分下列概念：</p><p>$E(X)$ ：一个数，是 $x_i$ 的<strong>加权平均值</strong>；</p><p>$E(X|Y)$ ：随机变量，关于 $Y$ 的函数，没有固定的 $y$ 值；</p><p>$E(X|Y==y)$ ：一个数，是局限在 $\omega\in{\omega|Y(\omega)==y}$ 时， $X(\omega)$ 的取值的<strong>局部加权平均值</strong></p></li></ul><h2 id="定理-公式"><a href="#定理-公式" class="headerlink" title="定理/公式"></a>定理/公式</h2><ul><li><p>对于两个独立事件 $A,B$ ，有：<br>$$<br>\begin{align}<br>P(AB)=P(A)P(B)\\<br>E(AB)=E(A)E(B)<br>\end{align}<br>$$<br>正确性显然</p></li><li><p>期望的线性性：</p><p>（1）对于两个随机变量 $X,Y$ （可以相关），有：</p><p>$$<br>E(X+Y)=E(X)+E(X)<br>$$</p><p>证明：</p><p>$$<br>\begin{align}<br>E(X+Y)<br>&amp;=\sum_{i}\sum_{j}P(X==i\wedge Y==j)\times(i+j)\\<br>&amp;=\sum_{i}\sum_{j}P(X==i\wedge Y==j)\times i+\sum_{i}\sum_{j}P(X==i\wedge Y==j)\times j\\<br>&amp;=\sum_{i}i\sum_{j}P(X==i\wedge Y==j)+\sum_{j}j\sum_{i}P(X==i\wedge Y==j)\\<br>&amp;=\sum_{i}iP(X==i)+\sum_{j}jP(Y==j)\\<br>&amp;=E(X)+E(Y)<br>\end{align}<br>$$</p></li></ul><p>  （2）对于一个常量 $C$ 有：<br>$$<br>  E(CX)=CE(X)<br>$$</p><ul><li><p>前缀和技巧：对于离散变量（取值只有整数） $X$ ，有<br>$$<br>P(X==k)=P(X\le k)-P(X\le k-1)<br>$$</p></li><li><p>关于方差的性质:：</p><p>（1）概率与方差的关系：<br>$$<br>\begin{align}<br>Var(X)<br>&amp;=\frac{\sum_{i}(x_i-\bar{x})}{n}\\<br>&amp;=\sum_{i}\frac{(x_i-\bar{x})}{n}\\<br>&amp;=\sum_{x_k\in X}(x_k-\bar{x})P(x_k)<br>\end{align}<br>$$<br>因为一个值出现的次数除以 $n$ 就是选它的概率</p><p>（2）期望与方差的关系：</p><p>首先，明显有 $\bar{x}=E(X)$ ，然后，我们再考虑对于一组数据 $X$ ，令 $y_i=(x_i-E(X))^2$ ，那么明显概率不变，有 $P(y_i)=P(x_i)$ ，则：<br>$$<br>\begin{align}<br>E(Y)<br>&amp;=\sum_{y_k\in Y}y_kP(y_k)\\<br>&amp;=\sum_{x_k\in X}(x_k-E(X))^2P(x_k)\\<br>&amp;=Var(X)<br>\end{align}<br>$$<br>故有：</p><p>$$<br>Var(X)=E((X-E(X))^2)<br>$$</p><p>（3）比较常用的一个性质：</p><p>$$<br>Var(X)=E(X^2)-E(X)^2<br>$$</p><p>需要注意 $E(X)=\bar{x}$ 是一个常数，故  $\sum2E(X)xP(x)=2E(X)\sum xP(x)=2E(X)^2$ ，另外谨记 $\sum P(x)=1$ ，则上述性质证明如下：<br>$$<br>\begin{align}<br>Var(X)<br>&amp;=E((X-E(X))^2)\\<br>&amp;=E(X^2-2XE(X)+E(X)^2)\\<br>&amp;=E(X^2)-E(2XE(X))+E(E(X)^2)\\<br>&amp;=E(X^2)-\sum2E(X)xP(x)+\sum E(X)^2P(x)\\<br>&amp;=E(X^2)-2E(X)^2+E(X)^2\sum P(x)\\<br>&amp;=E(X^2)-2E(X)^2+E(X)^2\\<br>&amp;=E(X^2)-E(X)^2<br>\end{align}<br>$$</p></li><li><p>全期望公式：<br>$$<br>E(E(X|Y))=E(X)<br>$$<br>证明如下：<br>$$<br>\begin{align}<br>E(E(X|Y))<br>&amp;=\sum_{y}E(X|Y==y)P(y)\\<br>&amp;=\sum_{y}{\huge(}\sum_{x}xP(x|y){\huge)}P(y)\\<br>&amp;=\sum_{y}\sum_{x}xP(x|y)P(y)\\<br>&amp;=\sum_{y}\sum_{x}xP(y|x)P(x)\\<br>&amp;=\sum_{x}\sum_{y}xP(y|x)P(x)\\<br>&amp;=\sum_{x}xP(x){\huge(}\sum_{y}P(y|x){\huge)}\\<br>&amp;=\sum_{x}xP(x)\\<br>&amp;=E(X)<br>\end{align}<br>$$</p></li><li><p>全概率公式：<br>$$<br>P(B)=\sum_{a_i\in A}P(a_i)P(B|a_i)<br>$$</p></li></ul><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>对于一些比较难找到递推关系的数学期望问题，可以利用期望的定义式，根据实际情况以概率或者方案数（也就是概率乘总方案数）作为一种状态，而下标直接或间接对应了这个概率下的变量值，将问题变成比较一般的统计方案数问题或者利用全概率公式计算概率的递推问题</p><p>一般来说，概率DP找到正确的状态定义后，转移是比较容易想到的。但状态一定是“可数”的，把有范围的整数作为数组下标。事实上，将问题直接作为状态是最好的。如问“ $n$ 人做 $X$ 事的期望次数”，则设计状态为 $f[i]$ 表示 $i$ 个人做完事的期望。转移一般是递推，即从上一个状态转移得（填表）或转移向下一个状态（刷表），后者更为常用</p><p>有时期望DP需以最终状态为初始状态转移，即逆推。如 $f[i]$ 表示期望还要走 $f[i]$ 步到达终点，这种状态的转移是刷表法，形如 $f[i]=\sum p[i\rightarrow j]f[j]+w[i\rightarrow j]$ ，其中 $p[\ ]$ 表示转移的概率， $w[\ ]$ 表示转移对答案的贡献，一般来说，初始状态确定时可用顺推，终止状态确定时可用逆推</p><p>还有些时候，要结合高斯消元来考虑</p><h2 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.luogu.com.cn/problem/P4284">概率充电器</a></p><p>考虑算出每个点充电的概率 $P(i)$ ，利用期望的线性性， $\sum P(i)$ 就是答案</p><p>利用树形DP，考虑先求出每个点通过自己或是子树冲上电的概率，定为 $f[\ ]$ ，转移为<br>$$<br>\forall v\in son(u)\\<br>f[u]= f[u]+f[v]* P(v\rightarrow u)-f[u]* f[v]* P(v\rightarrow u)<br>$$<br>这里用了一个容斥：<br>$$<br>\begin{align}<br>P(A\cup B)\\<br>=P(A)+P(B)-P(AB)\\<br>=P(A)+P(B)-P(A)P(B)<br>\end{align}<br>$$<br>正确性显然：两个事件至少发生一个的概率就是分别发生的概率减去都发生的概率 </p><p>然后再来考虑 $u$ 如何从父节点转移，转移方程类似于上面，但此时我们需要的是父节点不通过 $u$ 充上电的概率，令 $A$ 为“父节点不通过 $u$ 充上电”， $B$ 为“父节点通过 $u$ 充上电”，利用 $P(A)=\frac{P(A\cup B)-P(B)}{1-P(B)}$ 计算，注意特判 $P(B)==1$ 的情况</p><p>事时间复杂度 $O(n)$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> E = <span class="number">1e-7</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, ver;</span><br><span class="line">    <span class="keyword">double</span> p;</span><br><span class="line">&#125;e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> f[N], ans = <span class="number">0</span>;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">double</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx].ver = y, e[idx].p = z, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        y = e[i].ver;</span><br><span class="line">        <span class="keyword">if</span> (y == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dp</span>(y, x);</span><br><span class="line">        f[x] = f[x] + f[y] * e[i].p - f[x] * f[y] *e[i].p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">dp2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (e[i].ver == fa)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">double</span> pa, pb;</span><br><span class="line">        pb = f[e[i].ver] * e[i].p;</span><br><span class="line">        <span class="keyword">if</span> (pb + E &gt; <span class="number">1</span> &amp;&amp; pb - E &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">dp2</span>(e[i].ver, x);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            pa = (f[x] - pb) / (<span class="number">1</span> - pb);</span><br><span class="line">            f[e[i].ver] = f[e[i].ver] + pa * e[i].p - f[e[i].ver] * pa *e[i].p;</span><br><span class="line">            <span class="built_in">dp2</span>(e[i].ver, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y, z; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        <span class="built_in">add</span>(x, y, (<span class="keyword">double</span>)z / <span class="number">100.0</span>), <span class="built_in">add</span>(y, x, (<span class="keyword">double</span>)z / <span class="number">100.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, q; i &lt;= n; ++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q), f[i] = (<span class="keyword">double</span>)q / <span class="number">100.0</span>;</span><br><span class="line">    <span class="built_in">dp</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">dp2</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        ans += f[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.6lf\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h2><p><a href="https://www.luogu.com.cn/problem/P3239">亚瑟王</a></p><p>依旧利用期望的线性性，考虑求出每张卡被出掉的概率，不难发现，一张卡被出的概率与被经过的次数有关，于是设 $f[i][j]$ 表示 $r$ 轮后，前 $i$ 张卡被选了 $j$ 张的概率，那么 $f[i-1][j]$ 就是 $i$ 被考虑 $r-j$ 次的概率（因为还有 $r-j$ 张在 $i$ 及以后的牌中选），于是 $i$ 被选到的概率为 $\sum_{j&gt;0}f[i-1][j]\times(1-(1-p[i])^{r-j})$ ，则转移就是枚举选不选 $i+1$<br>$$<br>\begin{align}<br>&amp;\text{选：}\\<br>&amp;f[i + 1][j + 1]+=f[i][j]* (1-(1-p[i+1])^{r-j})\\<br>&amp;\text{不选：}\\<br>&amp;f[i + 1][j]+=f[i][j]* (1-p[i+1])^{r-j}\\<br>\end{align}<br>$$<br>时间复杂度 $O(Tnr)$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">220</span> + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Card</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> p, d;</span><br><span class="line">&#125; a[N];</span><br><span class="line"><span class="keyword">double</span> f[N][N], ans;</span><br><span class="line"><span class="function">IL <span class="keyword">double</span> <span class="title">qpow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)</span><br><span class="line">            res = res * x;</span><br><span class="line">        x = x * x;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">int</span> n, r;</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;r);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;a[i].p, &amp;a[i].d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= r; ++j)</span><br><span class="line">                f[i][j] = <span class="number">0</span>;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> <span class="keyword">_t</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="built_in">min</span>(i, r); ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">_t</span> = <span class="built_in">qpow</span>(<span class="number">1</span> - a[i + <span class="number">1</span>].p, r - j);</span><br><span class="line">                f[i + <span class="number">1</span>][j] += f[i][j] * <span class="keyword">_t</span>;</span><br><span class="line">                <span class="keyword">if</span> (j &lt; r)</span><br><span class="line">                &#123;</span><br><span class="line">                    f[i + <span class="number">1</span>][j + <span class="number">1</span>] += f[i][j] * (<span class="number">1</span> - <span class="keyword">_t</span>);</span><br><span class="line">                    ans += f[i][j] * (<span class="number">1</span> - <span class="keyword">_t</span>) * a[i + <span class="number">1</span>].d;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.10lf\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题三"><a href="#例题三" class="headerlink" title="例题三"></a>例题三</h2><p><a href="https://www.luogu.com.cn/problem/P3232">游走</a></p><p>明显，被经过次数多的边编号要小，这启发我们去求每条边期望被经过的次数，但 $m$ 的范围过大，直接求时间复杂度无法接受，于是考虑将边的期望转换为点的期望</p><p>设 $du[i]$ 表示第 $i$ 个点的度， $f[i]$ 表示它的期望经过次数，则有<del>有个鬼啊，我想不到啊！！！</del> ：</p><p>$$<br>f[i]=<br>\begin{cases}<br>&amp;\sum_{(i,j)\in E,j\ne n}\frac{f[j]}{du[j]}+1&amp;i=1\\<br>&amp;\sum_{(i,j)\in E,j\ne n}\frac{f[j]}{du[j]}&amp;1&lt;i&lt;n<br>\end{cases}<br>$$</p><p>需要注意：到 $n$ 点就停止了，所以不考虑从 $n$ 转移过来</p><p>那么第 $i$ 条边的期望经过次数 $g[i]$ 就是<br>$$<br>\begin{align}<br>&amp;g[i]=\frac{f[u]}{du[u]}+\frac{f[v]}{du[v]}&amp;E_i=(u,v),u\ne n,v\ne n<br>\end{align}<br>$$<br>那么只需求出 $f$ 就好了，然鹅，由于是DAG，转移的顺序无法解决（怎么转都有后效性），所以，高斯消元解决<del>不会就和我一样愣着吧</del></p><p>超级毒瘤的代码<del>我尽量标准化了</del>：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span> + <span class="number">5</span>, M = <span class="number">125000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-12</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x[N][N];</span><br><span class="line">&#125; a;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne, from, ver;</span><br><span class="line">&#125; e[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> du[N];</span><br><span class="line"><span class="keyword">double</span> g[M], ans = <span class="number">0</span>;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx].from = x, e[idx].ver = y, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">int</span> <span class="title">gauss</span><span class="params">(Matrix &amp;x, <span class="keyword">int</span> _n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c, r, <span class="keyword">_t</span>;</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">1</span>, r = <span class="number">1</span>; c &lt;= _n; ++c)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">_t</span> = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= _n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(x.x[i][c]) &gt; <span class="built_in">fabs</span>(x.x[<span class="keyword">_t</span>][c]))</span><br><span class="line">                <span class="keyword">_t</span> = i;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(x.x[<span class="keyword">_t</span>][c]) &lt; eps)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = c; i &lt;= _n + <span class="number">1</span>; ++i)</span><br><span class="line">            <span class="built_in">swap</span>(x.x[<span class="keyword">_t</span>][i], x.x[r][i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = _n + <span class="number">1</span>; i &gt;= c; --i)</span><br><span class="line">            x.x[r][i] /= x.x[r][c];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span>; i &lt;= _n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(x.x[i][c]) &gt; eps)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = _n + <span class="number">1</span>; j &gt;= c; --j)</span><br><span class="line">                    x.x[i][j] -= x.x[r][j] * x.x[i][c];</span><br><span class="line">        ++r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (r &lt;= _n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= _n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(x.x[i][_n + <span class="number">1</span>]) &gt; eps)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = _n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= _n; ++j)</span><br><span class="line">            x.x[i][_n + <span class="number">1</span>] -= x.x[i][j] * x.x[j][_n + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">        ++du[u], ++du[v];</span><br><span class="line">    &#125;</span><br><span class="line">    --n; <span class="comment">// 构建矩阵时注意第n个点不转移,所以只有n-1个点</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n + <span class="number">1</span>; ++j)</span><br><span class="line">            a.x[i][j] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        a.x[i][i] = <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = h[i], k; j != <span class="number">-1</span>; j = e[j].ne)</span><br><span class="line">        &#123;</span><br><span class="line">            k = e[j].ver;</span><br><span class="line">            <span class="keyword">if</span> (k == n + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            a.x[i][k] = <span class="number">-1.0</span> / du[k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    a.x[<span class="number">1</span>][n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">gauss</span>(a, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        u = e[i &lt;&lt; <span class="number">1</span>].from;</span><br><span class="line">        v = e[i &lt;&lt; <span class="number">1</span>].ver;</span><br><span class="line">        g[i] = a.x[u][n + <span class="number">1</span>] / du[u] + a.x[v][n + <span class="number">1</span>] / du[v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(g + <span class="number">1</span>, g + <span class="number">1</span> + m);</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i)</span><br><span class="line">        ans += g[i] * (m - i + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3lf&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题四"><a href="#例题四" class="headerlink" title="例题四"></a>例题四</h2><p>最后来看一道毒瘤题</p><p><a href="https://www.luogu.com.cn/problem/P5299">Slay the Spire</a></p><h3 id="贪心策略"><a href="#贪心策略" class="headerlink" title="贪心策略"></a>贪心策略</h3><p>明显，得排个序，由于强化卡的数字至少为 $2$ ，在可以打出的 $k$ 张牌中，尽可能多的打强化卡可以使伤害最大化（当然，至少得剩下一张攻击牌，不然没伤害）</p><p>另一个方面，根据期望的线性性（<del>又是它</del>），期望造成的伤害等于<strong>强化牌的期望乘积</strong>乘上<strong>攻击牌的期望和</strong>（<del>好乱</del>），而答案乘了一个奇奇怪怪的东西后分母没了，分子的化其实就是方案数乘价值</p><h3 id="dp方程设计"><a href="#dp方程设计" class="headerlink" title="dp方程设计"></a>dp方程设计</h3><p>如此，答案就跟强化牌和攻击牌分别独立相关，这启发我们分开计算：令 $f[i][j][0]$ 表示在前 $i$ 张强化牌中取 $j$ 张且第 $i$ 张<strong>被选</strong>的选法的<strong>乘积之和</strong>， $f[i][j][1]$ 表示前 $i$ 张强化牌中取 $j$ 张（不管选没选 $i$ ）的<strong>乘积之和</strong>，令 $g[i][j][0]$ 表示在前 $i$ 张攻击牌中取 $j$ 张且第 $i$ 张<strong>被选</strong>的选法的<strong>和之和</strong>， $f[i][j][1]$ 表示前 $i$ 张强化牌中取 $j$ 张（不管选没选 $i$ ）的<strong>和之和</strong></p><p>可以看到上面的定义非常的痛苦，所以好心的我在这里写点提示：</p><ol><li>为什么要强迫选第 $i$ 张呢？这是因为<del>讨厌的</del>九条可怜是随机选的卡，若不保证选了第 $i$ 张，统计答案时会有重复（或者不好统计）</li><li>为啥都是个<strong>…之和</strong>呢？这是因为最后算的是期望（当然，它乘了个玄学的东西把分母弄没了），期望本身就该算和</li><li>那为啥还要定一个不管选没选 $i$ 的情况呢？其实是为了方便求出强迫选的情况，换句话说，是当辅助的，而在统计答案时我们也靠它们可以去掉一个循环</li></ol><p>如果理解了以上定义（没理解就看看下面的转移和统计答案辅助理解一下），则可以发现转移方程如下（ $a$  是强化牌， $b$ 是攻击牌）：<br>$$<br>\begin{align}<br>&amp;f[i][j][0]=a[i]\times f[i-1][j-1][1]\\<br>&amp;f[i][j][1]=f[i][j][0]+f[i-1][j][1]\\<br>&amp;g[i][j][0]=b[i]\times \binom{i-1}{j-1}+g[i-1][j-1][1]\\<br>&amp;g[i][j][1]=g[i][j][0]+g[i-1][j][1]<br>\end{align}<br>$$<br>需要注意的是， $g[i][j][0]$ 的转移中， $\binom{i-1}{j-1}$ 表示在 $i-1$ 个数中选择 $j-1$ 个数的方案，即从 $g[i-1][j-1][1]$ 转移到 $g[i][j][0]$ 共有 $\binom{i-1}{j-1}$ 种情况，而每种情况卡牌权值和加上了 $b[i]$ </p><p>预处理组合数，推得 $f,g$ 都可以在 $O(n^2)$ 内解决</p><h3 id="统计答案"><a href="#统计答案" class="headerlink" title="统计答案"></a>统计答案</h3><p>来看看如何计算答案！分类讨论！</p><ul><li><p>若抽出来的 $m$ 张牌中，强化牌的数量少于 $k-1$ </p><p>此时当然是把强化牌全出了，然后攻击牌从大到小依次出，可以枚举 $i,j$ 表示被选中的强化牌<strong>有</strong> $i$ 张，最后一张被选中的攻击牌<strong>是</strong>第 $j$ 张</p><p>在强化牌中选择 $i$ 张的所有合法情况下的乘积之和，其实就是 $f[n][i][1]$ </p><p>而强化牌中选择 $i$ 张，攻击牌中就要选择 $k-i$ 张，又由于最后被选中的攻击牌是第 $j$ 张，所以所有合法情况下攻击牌的和之和，其实就是 $g[j][k-i][0]$ </p><p>但不要忘了，九条她的 $m$ 张牌是随机选的！为了保证最后打出的 $k$ 张牌是我们要的 $k$ 张牌，则剩余的 $m-k$ 张牌要满足不存在强化牌且攻击牌都要排在第 $j$ 张牌的后面（这也是我们必须要枚举 $j$ 的原因），因此共有 $\binom{n-j}{m-k}$ 种方案</p><p>总之，对于这种情况，我们枚举 $i,j$ ，每次答案加 $f[n][i][1]\times g[j][k-i][0]\times\binom{n-j}{m-k}$ </p></li><li><p>若抽出来的 $m$ 张牌中，强化牌的数量大于等于 $k-1$ </p><p>此时我们选则出积最大的 $k-1$ 张强化牌，再乘上一张最大的攻击牌，可以枚举 $i,j$ 表示最后一张被选中的强化牌<strong>是</strong>第 $i$ 张，被选中的攻击牌<strong>是</strong>第 $j$ 张</p><p>在前 $i$ 张强化牌中选 $k-1$ 张，且必选第 $i$ 张，其实就是 $f[i][k-1][0]$ </p><p>在攻击牌中选了第 $j$ 张，权值就是 $g[j][1][0]=b[j]$ </p><p>和上面一样，由于是随机选牌，剩余的 $m-k$ 张牌要满足强化牌都要排在第 $i$ 张牌的后面且攻击牌都要排在第 $j$ 张牌的后面，有 $\binom{2n-i-j}{m-k}$ 种方案</p><p>总之，对于这种情况，我们枚举 $i,j$ ，每次答案加 $f[i][k-1][0]\times b[j]\times\binom{2n-i-j}{m-k}$ </p></li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IL inline</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3000</span> + <span class="number">5</span>, P = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N];</span><br><span class="line"><span class="keyword">int</span> C[N][N];</span><br><span class="line"><span class="keyword">int</span> f[N][N][<span class="number">2</span>], g[N][N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="function">IL <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">IL <span class="keyword">void</span> <span class="title">pred</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        C[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j)</span><br><span class="line">            C[i][j] = (C[i - <span class="number">1</span>][j - <span class="number">1</span>] + C[i - <span class="number">1</span>][j]) % P;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">pred</span>(); <span class="comment">//处理C</span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i]);</span><br><span class="line">        <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n, cmp), <span class="built_in">sort</span>(b + <span class="number">1</span>, b + <span class="number">1</span> + n, cmp);</span><br><span class="line">        <span class="comment">//处理f</span></span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                f[i][j][<span class="number">0</span>] = (LL)a[i] * f[i - <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">1</span>] % P;</span><br><span class="line">                f[i][j][<span class="number">1</span>] = (f[i][j][<span class="number">0</span>] + f[i - <span class="number">1</span>][j][<span class="number">1</span>]) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//处理g</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i][j][<span class="number">0</span>] = ((LL)b[i] * C[i - <span class="number">1</span>][j - <span class="number">1</span>] + g[i - <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">1</span>]) % P;</span><br><span class="line">                g[i][j][<span class="number">1</span>] = (g[i][j][<span class="number">0</span>] + g[i - <span class="number">1</span>][j][<span class="number">1</span>]) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//情况1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k - <span class="number">1</span>; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">                ans = ((LL)f[n][i][<span class="number">1</span>] * g[j][k - i][<span class="number">0</span>] % P * C[n - j][m - k] + ans) % P;</span><br><span class="line">        <span class="comment">//情况2</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">                ans = ((LL)f[i][k - <span class="number">1</span>][<span class="number">0</span>] * b[j] % P * C[<span class="number">2</span> * n - i - j][m - k] + ans) % P;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>啊啊啊我太弱了！同机房的 <a href="https://www.luogu.com.cn/user/342891"> ${\Huge{\color{Red}\mathfrak{dalao}}}$ </a>天天嘲笑我/(ㄒoㄒ)/~~</p><p>啊啊啊啊怎么办要被自己菜死了！┏┛墓┗┓…(((m -__-)m</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> dp </tag>
            
            <tag> 期望 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>莫队</title>
      <link href="/2021/11/22/%E8%8E%AB%E9%98%9F/"/>
      <url>/2021/11/22/%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p>然而还没写完（不想填了）</p><span id="more"></span><p>莫队其实是一种基于<strong>分块</strong>的<strong>暴力</strong>思想，是一种<strong>离线算法</strong>，下面用例题来讲</p><h1 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h1><p><a href="https://www.luogu.com.cn/problem/P1972">P1972</a><br>（本题正解不是莫队，但我们可以用莫队<del>玄学艹掉</del>得86分）<br>抽象出下面一个问题：</p><p>有一个长为 $n$ 的数列 $A$ 和 $m$ 个询问，每个询问格式为 $l,r$ ，表示查询区间 $[l,r]$ 中不同的数有多少个。</p><p>本题的暴力做法灰常简单——对于每一个询问，扫描一遍数列，用一个 $cnt$ 数组统计每个数出现的次数，再扫描一遍 $cnt$ ，统计有多少个非零。时间复杂度为 $O(m（n+S))$ （其中 $S$ 表示 $cnt$ 数组的长度，即数据范围）。</p><p>一个简单的优化可以把 $S$ 去掉：<br>在统计时 $a_i$ 出现，判定 $cnt[a_i]$ 若为0， $ans++,cnt[a_i]++$ ,否则只是 $cnt[a_i]++$ 。则时间复杂度优化为 $O(mn)$</p><p>可是时间复杂度还是太大了，为此，我们用一个类似双指针的优化。</p><h2 id="优化一"><a href="#优化一" class="headerlink" title="优化一"></a>优化一</h2><p>思考下面一种情况，上一个询问我们已经求出 $[i,j]$ （这里 $i,j$ 是两个指针）中不同的数的个数，储存在 $ans$ 中，并且 $cnt$ 已经跟新好了，现在我们要求 $[l,r]$ 。<br>求法当然是移动指针，具体如下：  </p><ol><li><p>将 $j$ 一步步向后走直到 $j=r$ ，并将 $cnt[a_j]++$ ，如果 $a_j$ 是新出现的，则 $res++$ 。</p></li><li><p>将 $i$ 一步步向后走直到 $i=l$ ，并将 $cnt[a_j]–$ ，如果 $cnt[a_j]=0$ ，则 $res–$ 。</p></li></ol><p>以上方法<strong>最坏情况下</strong>的时间复杂度仍为 $O(mn)$ ，可恶啊，<del>我们优化了个寂寞！</del></p><h2 id="莫队"><a href="#莫队" class="headerlink" title="莫队"></a>莫队</h2><p>像我一样的蒟蒻们可能到这里就放弃了，但<del>某国国家队的某莫涛队员</del>dalao们却开始思考起来：为啥这个优化<del>优化了个寂寞</del>会到最坏情况呢？当然是因为查询的问题不确定，本个查询和上个查询的区间可能完全没有交集，甚至相隔甚远，这使得指针移动耗费了大量时间。于是，dalao们提出了解决方法——<br>既然查询的顺序会影响时间复杂度，那么我们调整一下查询顺序不就好了！</p><h2 id="优化二"><a href="#优化二" class="headerlink" title="优化二"></a>优化二</h2><p>优化一的时间复杂度在 $O(n^2)$ ，而用了dalao的思路后可以优化为 $O(n\sqrt{n})$ 。  </p><p>先读入所有查询，将二元组 $(l_i,r_i)$ 以 $r_i$ （也可以 $l_i$ ）为关键字排序，完成后以 $r_i$ 有序来查询，这样指针 $j$ 的跳转次数不超过 $n$ 次（因为不会来回跳转）。但指针 $i$ 怎么办呢？dalao也给出方法——不会就分块呗。</p><p>我们在排序时加入第二个关键字——分块的编号。我们以 $l_i$ 所在块的编号为第一关键字， $r_i$ 为第二关键字来从小到大排序。</p><p>综上，我们将所有的查询操作分成长度为 $\sqrt{n}$ 的 $\sqrt{n}$ 块，每一块内的 $r_i$ 是单调递增的。则每一块内部 $j$ 的跳转次数不超过 $n$ 次，共 $\sqrt{n}$ 块；在块内时 $i$ 的移动次数不超过块的长度，即 $\sqrt{n}$ ，而在跨块时移动次数不超过两块的长度，即 $2\sqrt{n}$。那么时间总复杂度为 $O(n\sqrt{n})$</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, len;</span><br><span class="line"><span class="keyword">int</span> w[N], ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id, l, r;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(i) q[i].id</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(i) q[i].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(i) q[i].r</span></span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="keyword">int</span> cnt[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, f = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            f = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x = x * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x * f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x / len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Question &amp;a, <span class="keyword">const</span> Question &amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="built_in">get</span>(a.l), j = <span class="built_in">get</span>(b.l);</span><br><span class="line">    <span class="keyword">if</span> (i != j)</span><br><span class="line">        <span class="keyword">return</span> i &lt; j;</span><br><span class="line">    <span class="keyword">return</span> a.r &lt; b.r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cnt[x])</span><br><span class="line">        res++;</span><br><span class="line">    cnt[x]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt[x]--;</span><br><span class="line">    <span class="keyword">if</span> (!cnt[x])</span><br><span class="line">        res--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        w[i] = <span class="built_in">read</span>();</span><br><span class="line">    m = <span class="built_in">read</span>();</span><br><span class="line">    len = <span class="built_in">sqrt</span>((<span class="keyword">double</span>)n * n / m); <span class="comment">//len的长度很玄学,会直接影响时间复杂度</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        q[i].id = i;</span><br><span class="line">        q[i].l = <span class="built_in">read</span>();</span><br><span class="line">        q[i].r = <span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(q, q + m, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>, j = <span class="number">0</span>, i = <span class="number">1</span>, res = <span class="number">0</span>; k &lt; m; ++k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; <span class="built_in">r</span>(k))</span><br><span class="line">            <span class="built_in">add</span>(w[++j], res);</span><br><span class="line">        <span class="keyword">while</span> (j &gt; <span class="built_in">r</span>(k))</span><br><span class="line">            <span class="built_in">del</span>(w[j--], res);</span><br><span class="line">        <span class="keyword">while</span> (i &lt; <span class="built_in">l</span>(k))</span><br><span class="line">            <span class="built_in">del</span>(w[i++], res);</span><br><span class="line">        <span class="keyword">while</span> (i &gt; <span class="built_in">l</span>(k))</span><br><span class="line">            <span class="built_in">add</span>(w[--i], res);</span><br><span class="line">        ans[<span class="built_in">id</span>(k)] = res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="例题二（带修改的莫队）"><a href="#例题二（带修改的莫队）" class="headerlink" title="例题二（带修改的莫队）"></a>例题二（带修改的莫队）</h1><p><a href="https://www.luogu.com.cn/problem/P1903">P1903</a>  </p><h2 id="新指针"><a href="#新指针" class="headerlink" title="新指针"></a>新指针</h2><p>本题多了一种操作，即可以修改数列 $A$ 的元素。<br>为了解决该问题，我们给询问加一维 $k$ ，即询问 $l\ r\ k$ 表示“在第 $k$ 次修改后 $[l,r]$ 中不同的数的个数”，那么我们用三个指针（ $i,j,k$ ）来跳转。</p><p>指针 $i,j$ 都很好跳转，但 $k$ 的跳转我们必须认真分析一下了：<br>当 $k$ 从 $t-1$ 跳转到 $t$ 时，由于每次操作只会修改一个数的值（设为 $a_x$ ），那么如果 $x\in[l,r]$ 那么我们就必须更新 $cnt$ 和 $res$ 否则我们就不管它。跳转一次的时间复杂度为 $O(1)$ 。</p><p>但是，问题又双叒叕来了——重 $t$ 跳转会 $t-1$ 咋办？询问里面可没存原数列啊！不过，dalao有dalao的解决办法：设操作 $t$ 的修改是“把 $a_x$ 重 $y$ 修改为 $z$ ”，我们在修改完后交换 $y,z$ ，即让操作 $t$ 的修改变为“把 $a_x$ 重 $z$ 修改为 $y$ ”，这样，不管是加还是减，只要经过操作 $t$ 就执行即可。</p><h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p>解决完新指针 $k$ 的问题后，聪明的dalao又开始思考新的问题了——该如何排序呢？</p><p>我们发现，只要以某一个指针为关键字，即让该指针单调，那么该扫描该指针的时间复杂度就会从 $O(n^2)$ 变成 $O(n)$ 。so，our思路还是让一个指针单调，其他指针分块。</p><p>所以排序变成一个三关键字排序：  </p><ol><li><p> $l$ 所在块的编号</p></li><li><p> $r$ 所在块的编号</p></li><li><p> $t$</p></li></ol><h2 id="块的大小"><a href="#块的大小" class="headerlink" title="块的大小"></a>块的大小</h2><p>然后，我们就来到了莫队里最玄学的地方——每一块该有多大呢？<br>像我一样的蒟蒻随便取个 $\sqrt{n}$ 或某个常数就可以了。<br>但总有像 <del>xyc</del> 一样的dalao喜欢<del>秀智商</del>严谨计算：</p><p>设每一块的大小为 $b$ ，则块的数量为 $\frac{n}{b}$ 。<br>那么，指针 $i$ （对应 $l$ ） 在块内移动的次数最大为 $b$ 有 $m$ 个问题，跨块的话每次最多移动 $2b$ （两个块的长度），有 $\frac{n}{b}$ 块，所以总的时间复杂度为 $O(b\times m+2b\times \frac{n}{b})=O(bm+n)$ 。  </p><p>指针 $j$ 的情况有点复杂。 $j$ 在块内和 $i$ 一样，最多为 $am$ 。但块间移动时，对于 $i$ 的每一个块， $j$ 最坏都会从第1块移动到第 $\frac{n}{b}$ 块，每次块间移动为 $O(2b \times \frac{n}{b})=O(n)$ ， $i$ 共有 $\frac{n}{b}$ 块，所以共为 $\frac{n^2}{b}$ ，总的时间复杂度为 $O(bm+\frac{n^2}{b})$</p><p>指针 $k$ 的在 $l,r$ 确定的情况下是单调的，最多移动 $t$ 次。而 $l,r$ 各有 $\frac{n}{b}$ 种情况，故总时间复杂度为 $O(\frac{n^2}{b^2}t)$</p><p>那么，如何取 $b$ 使 $max(O(bm+n),O(bm+\frac{n^2}{b}),O(\frac{n^2}{b^2}t))$ 最小呢？<br>由于 $m=n,bm&gt;n$ ，不妨化简为 $O(bn),O(bn+\frac{n^2}{b}),O(\frac{n^2}{b^2}t)$ 。<br>如果 $b\le \sqrt{n}$ ，则 $\frac{n^2}{b^2}t \ge nt$ 时间复杂度为 $O(n^2)$ 级别，过大，故必须保证 $b \ge \sqrt{n}$ 。<br>那么就有 $\frac{n^2}{b} \le bn$ ，故 $O(bn+\frac{n^2}{b})$ 可化为 $O(bn)$ 。<br>现在只需要比较 $bn$ 和 $\frac{n^2}{b^2}t$ ，使二者的最大值最小，只需解一个方程 $bn=\frac{n^2}{b^2}t$ ，解得 $b=\sqrt[3]{nt}$ 。</p><p>综上，当 $b=\sqrt[3]{nt}$ 时，时间复杂度最优为 $O(\sqrt[3]{n^4t})\approx 10^6\sim10^7$ 。</p><h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">133333</span> + <span class="number">5</span>, S = <span class="number">1000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, mq, mc, len;</span><br><span class="line"><span class="keyword">int</span> w[N], cnt[S], ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id, l, r, t;</span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Modify</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> p, c;</span><br><span class="line">&#125; c[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x / len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Question &amp;a, <span class="keyword">const</span> Question &amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> al = <span class="built_in">get</span>(a.l), ar = <span class="built_in">get</span>(a.r);</span><br><span class="line">    <span class="keyword">int</span> bl = <span class="built_in">get</span>(b.l), br = <span class="built_in">get</span>(b.r);</span><br><span class="line">    <span class="keyword">if</span> (al != bl)</span><br><span class="line">        <span class="keyword">return</span> al &lt; bl;</span><br><span class="line">    <span class="keyword">if</span> (ar != br)</span><br><span class="line">        <span class="keyword">return</span> ar &lt; br;</span><br><span class="line">    <span class="keyword">return</span> a.t &lt; b.t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cnt[x])</span><br><span class="line">        res++;</span><br><span class="line">    cnt[x]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt[x]--;</span><br><span class="line">    <span class="keyword">if</span> (!cnt[x])</span><br><span class="line">        res--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> op[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>, op, &amp;a, &amp;b);</span><br><span class="line">        <span class="keyword">if</span> (*op == <span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">            mq++, q[mq] = &#123;mq, a, b, mc&#125;;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            c[++mc] = &#123;a, b&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    len = <span class="built_in">cbrt</span>((<span class="keyword">double</span>)n * <span class="built_in">max</span>(mc, n));</span><br><span class="line">    <span class="built_in">sort</span>(q + <span class="number">1</span>, q + mq + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>, t = <span class="number">0</span>, k = <span class="number">1</span>, res = <span class="number">0</span>; k &lt;= mq; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> id = q[k].id, l = q[k].l, r = q[k].r, tm = q[k].t;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; r)</span><br><span class="line">            <span class="built_in">add</span>(w[++i], res);</span><br><span class="line">        <span class="keyword">while</span> (i &gt; r)</span><br><span class="line">            <span class="built_in">del</span>(w[i--], res);</span><br><span class="line">        <span class="keyword">while</span> (j &lt; l)</span><br><span class="line">            <span class="built_in">del</span>(w[j++], res);</span><br><span class="line">        <span class="keyword">while</span> (j &gt; l)</span><br><span class="line">            <span class="built_in">add</span>(w[--j], res);</span><br><span class="line">        <span class="keyword">while</span> (t &lt; tm)</span><br><span class="line">        &#123;</span><br><span class="line">            t++;</span><br><span class="line">            <span class="keyword">if</span> (c[t].p &gt;= j &amp;&amp; c[t].p &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">del</span>(w[c[t].p], res);</span><br><span class="line">                <span class="built_in">add</span>(c[t].c, res);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">swap</span>(w[c[t].p], c[t].c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; tm)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (c[t].p &gt;= j &amp;&amp; c[t].p &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">del</span>(w[c[t].p], res);</span><br><span class="line">                <span class="built_in">add</span>(c[t].c, res);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">swap</span>(w[c[t].p], c[t].c);</span><br><span class="line">            t--;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[id] = res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= mq; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="例题三（回滚莫队）"><a href="#例题三（回滚莫队）" class="headerlink" title="例题三（回滚莫队）"></a>例题三（回滚莫队）</h1><p>看看下题<br><a href="https://www.luogu.com.cn/problem/AT1219">AT1219</a><br>本题中区间伸长的时候很好维护信息但区间缩短的时候不太好维护信息<br>于是我们遇到莫队的一个常见问题：当询问的不再是简单的计数，而是最值或其他带有比较性质的信息时，如何在指针移动时用可接受的时间实现答案的跟新（即“当前区间”的插入和删除时如何快速跟新答案）？<br>就本题而言，我们发现插入一个新数的跟新非常简单：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cnt[i]++;</span><br><span class="line"><span class="keyword">if</span>(cnt[i]*i&gt;res) res=cnt[i]*i;</span><br></pre></td></tr></table></figure><p>但是，删除操作会变得十分麻烦：原来 $res=cnt[i]$ ，但当 $cnt[i]-=i$ 后， $res$ 就必须要把整个 $cnt$ 数组扫描一遍才能确定。<br>当然，dalao可以用二叉堆来解决这个问题，但其实莫队有一种 <del>虽然时间慢些</del> 更好写的办法。</p><h2 id="处理"><a href="#处理" class="headerlink" title="处理"></a>处理</h2><p> 首先分块，把询问区间先按左端点（ $l$ ）的块排序，相同按右端点（ $r$ ）从小到大排序</p><p>若询问的左右端点在同一个块内，暴力解决， $O(\sqrt{n})$<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/a1h168qt.png" alt="同块暴力"></p><p>剩下的询问必然是跨块的，如图：<img src="https://cdn.luogu.com.cn/upload/image_hosting/5iuj9rtn.png" alt="跨块暴力"><br>由于排序，对于 $l$ 同块的询问 $r$ 一定是递增的，其指针在转移时不必考虑删除操作（如图中 $r_{i+1}$ 一定在 $r_i$ 右方），只需单独定一个 $cnt2$ 来记录即可；而 $l_{i+1}$ 有可能在 $l_i$ 左侧，但它们一定在同一块，即使涉及删除也不会多次使用。但，到底还是要删除，咋办？</p><p>想想你在玩 $galgame$ 玩出最坏的 $BE$的时候，你是不是会选择回档？想想为毛这东西要叫回滚莫队？想想到底是 $cnt$ 难删除还是 $res$ 那维护？于是，我们 <del>在dalao的提示下</del> 发现，我们也可以让莫队“回档”。<br>综上，操作如下：  </p><ol><li><p>先将指针移动到 $l$ 所在块的末尾（具体来讲，设块尾为 $q$ 则 $i=q+1,j=q$ ，保证初始为空）</p></li><li><p>将 $res$ 备份存档</p></li><li><p>每遇到一个询问，我们先移动 $j$ （对应 $r$ ），这里只会涉及添加操作,移动时跟新 $cnt$ 和 $res$ </p></li><li><p>移动 $i$ ，由于 $i$ 最初一定在 $l$ 右边，故只有添加操作，移动完毕后跟新询问的答案</p></li><li><p>将 $res$ 回复，将 $i$ 归位到 $i=q+1$ ，过程中回复 $cnt$ </p></li></ol><p>最后，如果我们当前这个询问的块是上一个询问的下一个块，即我们跨过了一个块，就直接清空 $cnt$ ，重新再来，重复上面的操作，只是块变成了下一个而已（有dalao说：“就相当于我们对于每一个块做一次莫队”）</p><h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">int</span> n, m, len;</span><br><span class="line"><span class="keyword">int</span> w[N], cnt[N];</span><br><span class="line">LL ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Question</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id, l, r;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> id(k) q[k].id</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(k) q[k].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(k) q[k].r</span></span><br><span class="line">&#125; q[N];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; nums; <span class="comment">//离散化用</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">        x = x * <span class="number">10</span> + ch - <span class="string">&#x27;0&#x27;</span>, ch = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x / len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Question x, Question y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="built_in">get</span>(x.l), j = <span class="built_in">get</span>(y.l);</span><br><span class="line">    <span class="keyword">if</span> (i != j)</span><br><span class="line">        <span class="keyword">return</span> i &lt; j;</span><br><span class="line">    <span class="keyword">return</span> x.r &lt; y.r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, LL &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt[x]++;</span><br><span class="line">    res = <span class="built_in">max</span>(res, (LL)cnt[x] * nums[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    len = <span class="built_in">sqrt</span>(n);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//离散化</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        w[i] = <span class="built_in">read</span>(), nums.<span class="built_in">push_back</span>(w[i]);</span><br><span class="line">    <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">    nums.<span class="built_in">erase</span>(<span class="built_in">unique</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>()), nums.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        w[i] = <span class="built_in">lower_bound</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>(), w[i]) - nums.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="built_in">read</span>(), b = <span class="built_in">read</span>();</span><br><span class="line">        <span class="built_in">id</span>(i) = i, <span class="built_in">l</span>(i) = a, <span class="built_in">r</span>(i) = b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(q, q + m, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; m;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> y = x;</span><br><span class="line">        <span class="keyword">while</span> (y &lt; m &amp;&amp; <span class="built_in">get</span>(<span class="built_in">l</span>(y)) == <span class="built_in">get</span>(<span class="built_in">l</span>(x))) <span class="comment">//完成后x~y就是同块的</span></span><br><span class="line">            ++y;</span><br><span class="line">        <span class="keyword">int</span> right = <span class="built_in">get</span>(<span class="built_in">l</span>(x)) * len + len - <span class="number">1</span>; <span class="comment">//本块右端点</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//暴力求块内</span></span><br><span class="line">        <span class="keyword">while</span> (x &lt; y &amp;&amp; <span class="built_in">r</span>(x) &lt; right)</span><br><span class="line">        &#123;</span><br><span class="line">            LL res = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="built_in">l</span>(x); k &lt;= <span class="built_in">r</span>(x); ++k)</span><br><span class="line">                <span class="built_in">add</span>(w[k], res);</span><br><span class="line">            ans[<span class="built_in">id</span>(x)] = res;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="built_in">l</span>(x); k &lt;= <span class="built_in">r</span>(x); ++k) <span class="comment">//回复</span></span><br><span class="line">                cnt[w[k]]--;</span><br><span class="line"></span><br><span class="line">            x++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//求跨块</span></span><br><span class="line">        LL res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> j = right, i = right + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (x &lt; y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; <span class="built_in">r</span>(x)) <span class="comment">//右指针只增不删</span></span><br><span class="line">                <span class="built_in">add</span>(w[++j], res);</span><br><span class="line"></span><br><span class="line">            LL b_res = res; <span class="comment">//存档</span></span><br><span class="line">            <span class="keyword">while</span> (i &gt; <span class="built_in">l</span>(x))</span><br><span class="line">                <span class="built_in">add</span>(w[--i], res);</span><br><span class="line"></span><br><span class="line">            ans[<span class="built_in">id</span>(x)] = res;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//回复</span></span><br><span class="line">            <span class="keyword">while</span> (i &lt; right + <span class="number">1</span>)</span><br><span class="line">                cnt[w[i++]]--;</span><br><span class="line">            res = b_res;</span><br><span class="line"></span><br><span class="line">            x++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> cnt); <span class="comment">//换块,清空</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="例四（树上莫队）有完没完"><a href="#例四（树上莫队）有完没完" class="headerlink" title="例四（树上莫队）有完没完"></a>例四（树上莫队）<del>有完没完</del></h1><p><a href="https://www.acwing.com/problem/content/2536/">AcWing2536</a><br>与例一类似，只是区间变成了树上的一个路径。<br>那要是可以把树变成一个序列，并且路径就对应一个区间，那该有多好啊！（好假，一看就是dalao告诉的）</p><p>于是 <del>dalao告诉</del> 我们想到，可以用<strong>欧拉序列</strong>！（那系个啥？）</p><h2 id="欧拉序列"><a href="#欧拉序列" class="headerlink" title="欧拉序列"></a>欧拉序列</h2><p>名字挺高级的，其实就是一个DFS遍历，遍历时经过的节点顺序就是欧拉序列。<br>for example：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/zyak8ug3.png" alt="欧拉路径"></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> 分块 </tag>
            
            <tag> 莫队 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>莫比乌斯反演</title>
      <link href="/2021/11/22/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
      <url>/2021/11/22/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/</url>
      
        <content type="html"><![CDATA[<p>数学的恶魔</p><span id="more"></span><h1 id="莫比乌斯反演"><a href="#莫比乌斯反演" class="headerlink" title="莫比乌斯反演"></a>莫比乌斯反演</h1><h2 id="前置知识：数论分块"><a href="#前置知识：数论分块" class="headerlink" title="前置知识：数论分块"></a>前置知识：数论分块</h2><h3 id="基本内容"><a href="#基本内容" class="headerlink" title="基本内容"></a>基本内容</h3><p>数论分块可以快速计算一些含有除法向下取整的和式（即形如 $\sum_{i=1}^{n} f(i)g( \lfloor \frac{n}{i} \rfloor)$ 的式子），只要可以在 $O(1)$ 内计算 $f(r)-f(l)$ 或已经预处理出 $f$ 的前缀和时，可以用数论分块在 $O(\sqrt{n})$ 的时间内计算答案。</p><p>它主要利用<strong>富比尼定理（Fubini’s theorem）</strong>（<del>听起来很厉害但其实没啥</del>）：我们注意到，有很多的 $i$ 它们的 $\lfloor \frac{n}{i} \rfloor$ 是相等的，这启发我们分段打包计算。</p><p>举个例子，如果我们要求 $\sum_{i=1}^{n} \lfloor \frac{n}{i} \rfloor$ ，我们发现很多 $i$ 都对应同一个 $\lfloor \frac{n}{i} \rfloor$ ，它们呈块状分布，在<del>打个表</del>仔细观察（<a href="https://oi-wiki.org/math/number-theory/sqrt-decomposition/">证明</a>），发现对于每一个块，它的最后一个数是 $n/(n/i)$ （ $c++$ 自带下取整，一般我们称其这个式子的值为 $g(i)$ ），如对于 $\sum_{i=1}^{10} \lfloor \frac{10}{i} \rfloor$ ，分成： $(1)(2)(3)(4,5)(6,7,8,9,10)$ ，其中 $1=10/(10/1),2=10/(10/2),3=10/(10/3),5=10/(10/5),10=10/(10/10)$ ，于是，求解上述问题的代码如下（常用）：</p><p><a href="https://www.luogu.com.cn/problem/UVA11526">UVA11526 H(n)</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>,r;l&lt;=n;l=r+<span class="number">1</span>)&#123;</span><br><span class="line">    r=n/(n/l);</span><br><span class="line">    ans+=(r-l+<span class="number">1</span>)*(n/l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>类似的，我们可以用 $O(\sqrt{n})$ 计算 $g(\lfloor \frac{n}{i} \rfloor)$ 那么只要 $f$ 好求我们就能算了！</p><p>一般而言，我们可以统计一个前缀和（积），因为每当我们使用分块跳过一个区间的时候，其所对应的函数值也跳过了一个区间。所以此时，就需要乘上那一个区间的函数值（可以自己举个例子理解一下）。</p><p>但要是不一般（比如 $O(n)$ 的前缀和都会TLE），那……去死吧！（dalao可以用<strong>杜教筛</strong>试一试）</p><h3 id="引理一"><a href="#引理一" class="headerlink" title="引理一"></a>引理一</h3><p>$$<br>\forall a,b,c \in \mathbb{Z},\lfloor \frac{a}{bc} \rfloor=\lfloor \frac{\lfloor \frac{a}{b} \rfloor}{c} \rfloor<br>$$</p><p>证明：<br>$$<br>\frac{a}{b}=\lfloor\frac{a}{b}\rfloor+r(0\le r&lt;1)<br>\Rightarrow\lfloor\frac{a}{bc}\rfloor=\lfloor\frac{1}{c}(\lfloor\frac{a}{b}\rfloor+r)\rfloor=\lfloor\frac{\lfloor\frac{a}{b}\rfloor}{c}+\frac{r}{c}\rfloor=\lfloor \frac{\lfloor \frac{a}{b} \rfloor}{c} \rfloor<br>$$</p><h3 id="引理二"><a href="#引理二" class="headerlink" title="引理二"></a>引理二</h3><p>$$<br>\forall n\in\mathbb{N_+},{\LARGE|}{\lfloor \frac{n}{d}\rfloor|d\in\mathbb{N_+}\wedge d\le n}{\LARGE|}\le\lfloor2\sqrt{n}\rfloor<br>$$</p><p>其中 $|V|$ 表示集合 $V$ 的元素个数</p><p>该引理是时间复杂度的保证</p><p>证明：</p><p>对于 $d\le\lfloor\sqrt{n}\rfloor$ ，由于 $d$ 最多有 $\lfloor\sqrt{n}\rfloor$ 种不同取值， $\lfloor\frac{n}{d}\rfloor$ 也只有 $\lfloor\sqrt{n}\rfloor$ 种取值</p><p>对于 $d&gt;\lfloor\sqrt{n}\rfloor$ ，则 $\lfloor\frac{n}{d}\rfloor\le\lfloor\sqrt{n}\rfloor$ ，也只有 $\lfloor\sqrt{n}\rfloor$ 种取值</p><h2 id="前置知识：积性函数"><a href="#前置知识：积性函数" class="headerlink" title="前置知识：积性函数"></a>前置知识：积性函数</h2><p>若函数 $f(x)$ 为积性函数，则有 $\forall gcd(a,b)=1,f(ab)=f(a)f(b)$ </p><p>可以证明以下函数全是积性函数：</p><ul><li>$\varphi(n)$ －欧拉函数</li><li>$\mu(n)$ －莫比乌斯函数</li><li>$gcd(n,k)$ －最大公因子，当k固定的情况</li><li>$d(n)$ －正因子数目</li><li>$\sigma(n)$ －所有正因子之和</li><li>$\sigma k(n)$ －因子函数， $n$ 的所有正因子的 $k$ 次幂之和，当中 $k$ 可为任何复数</li><li>$1(n)$ －不变的函数，定义为 $1(n)=1$ （完全积性）</li><li>$Id(n)$ －单位函数，定义为 $Id(n)=n$ （完全积性）</li><li>$Idk(n)$ －幂函数，对于任何复数、实数 $k$ ，定义为 $Idk(n)=n^k$ （完全积性）</li><li>$\varepsilon(n)$ －定义为：若 $n=1$ ， $\varepsilon(n)=1$ ；若 $n&gt;1$ ， $\varepsilon(n)=0$ 。别称为“对于狄利克雷卷积的乘法单位”（完全积性）</li><li>$\lambda(n)$ －<a href="https://baike.baidu.com/item/%E5%88%98%E7%BB%B4%E5%B0%94%E5%87%BD%E6%95%B0">刘维尔函数</a>，关于能整除 $n$ 的质因子的数目</li><li>$\gamma(n)$ ，定义为 $\gamma(n)=(-1)^{\omega(n)}$，在此加性函数 $\omega(n)$ 是不同能整除<em>n</em>的质数的数目</li><li>另外，所有<a href="https://baike.baidu.com/item/%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E7%89%B9%E5%BE%81">狄利克雷特征</a>均是完全积性的</li></ul><p>积性函数一般可以用线性筛筛得</p><h2 id="前置知识：狄利克雷卷积"><a href="#前置知识：狄利克雷卷积" class="headerlink" title="前置知识：狄利克雷卷积"></a>前置知识：狄利克雷卷积</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>狄利克雷（ $Dirichlet$ ）卷积定义为：</p><p>对于两个<a href="https://baike.baidu.com/item/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0">数论函数</a> $f,g$ ，有：<br>$$<br>(f*g)(n)=\sum_{d|n}f(d)g(\frac{n}{d})<br>$$</p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>狄利克雷卷积满足以下运算律：</p><ul><li>交换律： $(f* g)=(g* f)$ </li><li>结合律： $((f* g)* h)=(f* (g* h))$ </li><li>分配律： $(f* (g+h))=((f* g)+(f* h))$ </li><li>$(f*\varepsilon)=f$ ，其中 $\varepsilon$ 为狄利克雷卷积的单位元 </li></ul><p>for example：</p><ul><li> $\varepsilon=(\mu*1)\Leftrightarrow\varepsilon(n)=\sum_{d|n}\mu(d)1(\frac{n}{d})=\sum_{d|n}\mu(d)$</li><li> $d=(1*1)\Leftrightarrow d(n)=\sum_{d|n}1(d)1(\frac{n}{d})=\sum_{d|n}1$ </li><li> $Id=(\varphi*1)\Leftrightarrow Id(n)=n=\sum_{d|n}\varphi(n)$ </li><li> $\varphi=(\mu*Id)\Leftrightarrow\varphi(n)=\sum_{d|n}d\mu(\frac{n}{d})$ </li></ul><h3 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h3><p>对于卷积的第 $n$ 项可以直接枚举约数，在 $O(\sqrt{n})$ 的时间内计算</p><p>但是对于狄利克雷卷积的前 $n$ 项<br>$$<br>h[i]=\sum_{d|i}f[d]g[i/d]<br>$$<br>如果一项一项算的话就需要 $O(n\sqrt{n})$ ，但实际上可以优化</p><p>设 $x=d,y=\frac{i}{d}$ 分别枚举 $x,y$ 对于 $h[xy]+=f[x]g[y]$ 即可。<br> 时间复杂度 $O(n\log{n})$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) h[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j*i&lt;=n;++j) h[i*j]=(h[i*j]+f[i]*g[j]%P)%P;</span><br></pre></td></tr></table></figure><p>对于 $k$ 次卷积，还可以快速幂优化</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HanShu</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> f[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    HanShu <span class="keyword">operator</span>*(<span class="keyword">const</span> HanShu <span class="keyword">_t</span>)&#123;</span><br><span class="line">    HanShu h;</span><br><span class="line">h.<span class="built_in">inint</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j*i&lt;=n;++j) h.f[i*j]=(h.f[i*j]+f[i]*<span class="keyword">_t</span>.f[j]%P)%P;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="keyword">operator</span>=(<span class="keyword">const</span> HanShu <span class="keyword">_t</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i]=<span class="keyword">_t</span>.f[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">HanShu <span class="title">H_qpow</span><span class="params">(HanShu x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    HanShu res;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">_t</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(y)&#123;</span><br><span class="line">    <span class="keyword">if</span>(y&amp;<span class="number">1</span>)&#123;</span><br><span class="line">    ++<span class="keyword">_t</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">_t</span>==<span class="number">1</span>) res=x;</span><br><span class="line">    <span class="keyword">else</span> res=res*x;</span><br><span class="line">    &#125;</span><br><span class="line">    x=x*x;</span><br><span class="line">    y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="前置知识：莫比乌斯函数"><a href="#前置知识：莫比乌斯函数" class="headerlink" title="前置知识：莫比乌斯函数"></a>前置知识：莫比乌斯函数</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>设正整数 $N$ 分解质因数为 $N=p_1^{c_1}p_2^{c_2}…p_m^{c_m}$ ，定义函数<br>$$<br>\mu(N)=<br>\begin{cases}<br> 0&amp;\exists i\in[1,m],c_i&gt;1\\<br> 1&amp;m\equiv0(mod\ 2),\forall i\in[1,m],c_i=1\\<br>-1&amp;m\equiv1(mod\ 2),\forall i\in[1,m],c_i=1<br>\end{cases}<br>$$<br>我们称 $\mu$ 为莫比乌斯（ $M\ddot{o}bius$ ）函数。</p><h3 id="性质和结论"><a href="#性质和结论" class="headerlink" title="性质和结论"></a>性质和结论</h3><ul><li><p>莫比乌斯函数是积性函数</p></li><li><p>$\sum_{d|n}\mu(d)=[n==1]$ ，其中 $[p]$ 表示 $p$ 为真时取 $1$ 其他时候取 $0$ ，该式也可表示为 $\sum_{d|n}\mu(d)=\varepsilon(n)$ ，也就是 $\mu*1=\varepsilon$</p><p>证明：</p><p>设 $n=\prod_{i=1}^{k}p_i^{c_i},n’=\prod_{i=1}^{k}p_i$ </p><p>那么 $\sum_{d|n}\mu(d)=\sum_{d|n’}\mu(d)=\sum_{i=0}^{k}C_k^i(-1)^i$ </p><p>又因为二项式定理： $(a+b)^k=\sum_{i=0}^{k}C_k^i a^i b^{k-i}$ </p><p>有： $\sum_{i=0}^{k}C_k^i(-1)^i=\sum_{i=0}^{k}C_k^i(-1)^i 1^{k-i}=((-1)+1)^k$</p><p>当且仅当 $k=0$ ，即 $n=1$ 时原式为 $1$ ，其余时候都为 $0$ </p></li><li><p>$[gcd(i,j)==1]=\sum_{d|gcd(i,j)}\mu(d)$ 该结论在反演中十分常用，正确性显然</p></li></ul><h3 id="筛法"><a href="#筛法" class="headerlink" title="筛法"></a>筛法</h3><p>若只求一项莫比乌斯函数，分解质因数即可；</p><p>若要求多项可以在线性筛素数时一并求出：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> primes[N],mu[N],cnt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> v[N];</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>; <span class="comment">//1特判</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!v[i]) primes[++cnt]=i,mu[i]=<span class="number">-1</span>; <span class="comment">//质数</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;primes[j]*i&lt;=n;++j)&#123;</span><br><span class="line">v[primes[j]*i]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>)&#123; <span class="comment">//若有一个质因数指数大于1</span></span><br><span class="line">            mu[i*primes[j]]=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mu[i*primes[j]]=-mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="正题：莫比乌斯反演"><a href="#正题：莫比乌斯反演" class="headerlink" title="正题：莫比乌斯反演"></a>正题：莫比乌斯反演</h2><h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p>若 $F(n)$ 和 $f(n)$ 是定义在 $\mathbb{N}$ 上的函数，且有<br>$$<br>F(n)=\sum_{d|n}f(d)<br>$$<br>则：<br>$$<br>f(n)=\sum_{d|n}\mu(d)F(\frac{n}{d})<br>$$<br>我们称该定理为<strong>莫比乌斯反演定理</strong>（原来是用 $f$ 表示 $F$ ，现在反过来了）。</p><p>证明如下：<br>$$<br>\begin{align}<br>\sum_{d|n}\mu(d)F(\frac{n}{d})<br>&amp;=\sum_{d|n}\mu(d)\sum_{i|\frac{n}{d}}f(i)\\<br>&amp;=\sum_{i|n}f(i)\sum_{d|\frac{n}{i}}\mu(d)\\<br>&amp;=\sum_{i|n}f(i)[\frac{n}{i}==1]\\<br>&amp;=f(n)<br>\end{align}<br>$$<br>当然，不难发现，狄利克雷卷积也可以证明：</p><p>$$<br>\begin{align}<br>&amp;F(n)=\sum_{d|n}f(d)\\<br>&amp;\Rightarrow F=f* 1\\<br>&amp;\Rightarrow F* \mu=f* 1* \mu\\<br>\text{又}\because&amp;\mu* 1=\varepsilon\\<br>&amp;\Rightarrow F* \mu=f* (1* \mu)=f\\<br>&amp;\Rightarrow f=\mu* F<br>\end{align}<br>$$</p><p>然而，在莫比乌斯反演中更常用的是这个式子：</p><p>当 $F(n)$ 和 $f(n)$ 满足：<br>$$<br>F(n)=\sum_{n|d}f(d)<br>$$<br>则有：<br>$$<br>f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)<br>$$<br>其实就是枚举约数变成了枚举倍数，若用卷积证明，过程都一样，下面用定义证明：<br>$$<br>\begin{align}<br>\sum_{n|d}\mu(\frac{d}{n})F(d)<br>&amp;=\sum_{n|d}\mu(\frac{d}{n})\sum_{d|i}f(i)\\<br>\text{不妨设}d’=\frac{d}{n}\\<br>\text{原式}<br>&amp;=\sum_{n|i}f(i)\sum_{d’|\frac{i}{n}}\mu(d’)\\<br>&amp;=\sum_{n|i}f(i)[\frac{i}{n}==1]\\<br>&amp;=f(n)<br>\end{align}<br>$$<br>以上就是莫比乌斯反演的常用形式（要记住）</p><h3 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h3><p><a href="https://www.luogu.com.cn/problem/P2522">Problem b</a></p><p>分析：</p><p>若我们将数对 $(x,y)$ 对应到坐标系内，其实是要求在左下角为 $(a,c)$ 右上角为 $(b,d)$ 的矩形中有多少个点 $(x,y)$ 满足 $gcd(x,y)==k$ </p><p>由矩形考虑二维前缀和，设 $S(x,y)$ 表示以 $(x,y)$ 为右上角， $(0,0)$ 为左下角的矩形中满足要求的点的个数，则 $Ans=S(b,d)-S(a-1,d)-S(b,c-1)+S(a-1,c-1)$ </p><p>考虑用莫比乌斯反演，我们需要定义 $F,f$ 且让 $F(n)=\sum_{n|d}f(d)$ （即满足反演条件），要注意的是， $F$ 应该是比较好计算的函数（至少要比 $f$ 好计算，不然你反演用 $F$ 表示 $f$ 干嘛），还有就是 $f$ 要与答案有关系（不然求出 $f$ 干嘛）</p><p>那么，不妨令 $f(n)=\sum_{x=1}^{N}\sum_{y=1}^{M}[gcd(x,y)==n]$ 则我们要求的 $S(N,M)$ 就是 $f(k)$ </p><p>又因为 $F(n)=\sum_{n|d}f(d)$ ，故定义 $F(n)=\sum_{x=1}^{N}\sum_{y=1}^{M}[n|gcd(x,y)]$ </p><p>反演得： $f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)$ </p><p>又因为由 $F$ 的定义， $n|gcd(x,y)\Leftrightarrow n|x\wedge n|y$ ，故 $F(d)=\lfloor\frac{N}{d}\rfloor\lfloor\frac{M}{d}\rfloor$</p><p>所以 $f(n)=\sum_{n|d}\mu(\frac{d}{n})\lfloor\frac{N}{d}\rfloor\lfloor\frac{M}{d}\rfloor$ </p><p>枚举倍数比枚举因数要简单，所以我们令 $d’=\frac{d}{n},N’=\frac{N}{n},M’=\frac{M}{n}$ ，原式化为 $f(n)=\sum_{d’}\mu(d’)\lfloor\frac{N’}{d}\rfloor\lfloor\frac{M’}{d}\rfloor$ 预处理 $\mu$ 的前缀和后用数论分块可以求</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> pri[N],cnt,mu[N];</span><br><span class="line"><span class="keyword">bool</span> v[N];</span><br><span class="line">LL sum[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pred</span><span class="params">()</span></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) pri[++cnt]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;pri[j]*i&lt;N;++j)&#123;</span><br><span class="line">v[pri[j]*i]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;</span><br><span class="line">mu[i*pri[j]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i*pri[j]]=-mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">sum[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) sum[i]=sum[i<span class="number">-1</span>]+mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x)</span></span>&#123; <span class="comment">//得到(k/x)中x所在块的右端点</span></span><br><span class="line"><span class="keyword">return</span> k/(k/x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">S</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">LL res=<span class="number">0</span>;</span><br><span class="line">x=x/k,y=y/k;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">_t</span>=<span class="built_in">min</span>(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>,r;l&lt;=<span class="keyword">_t</span>;l=r+<span class="number">1</span>)&#123;</span><br><span class="line">r=<span class="built_in">min</span>(<span class="keyword">_t</span>,<span class="built_in">min</span>(<span class="built_in">g</span>(x,l),<span class="built_in">g</span>(y,l))); <span class="comment">//每次在两个取整中找小的,注意不能超过_t</span></span><br><span class="line">res+=(sum[r]-sum[l<span class="number">-1</span>])*(x/l)*(y/l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a,b,c,d,k;</span><br><span class="line"><span class="built_in">pred</span>();</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>,&amp;a,&amp;b,&amp;c,&amp;d,&amp;k);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">S</span>(b,d,k)-<span class="built_in">S</span>(a<span class="number">-1</span>,d,k)-<span class="built_in">S</span>(b,c<span class="number">-1</span>,k)+<span class="built_in">S</span>(a<span class="number">-1</span>,c<span class="number">-1</span>,k));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h3><p><a href="https://www.luogu.com.cn/problem/P3327">约数个数和</a></p><p>分析：</p><p>先看原题给我们的函数，由于 $d$ 是积性函数（忘了的上去翻），所以有 $d(ij)=\sum_{x|i}\sum_{y|j}[gcd(x,y)==1]$ （<del>呃呃呃，鬼想的到啊！</del>）</p><p>简单证明：</p><p>设 $i=p_1^{\alpha_1}p_2^{\alpha_2}…p_k^{\alpha_k},j=p_1^{\beta_1}p_2^{\beta_2}…p_k^{\beta_k}$ ，则 $ij=i=p_1^{\alpha_1+\beta_1}p_2^{\alpha_2+\beta_2}…p_k^{\alpha_k+\beta_k}$ ，由约数个数定理 $d(ij)=(\alpha_1+\beta_1+1)(\alpha_2+\beta_2+1)…(\alpha_k+\beta_k+1)$ </p><p>再看等式右边， $x,y$ 的因数也一定是在 $p_1,p_2,…,p_k$ 中，对于质因子 $p_1$ ，若 $x$ 含 $p_1^t,(t\ne 0)$ ，则有意义的 $y$ 一定不含 $p_1$ ，此时 $t$ 有 $\alpha_1$ 种取值，同理，若 $y$ 含 $p_1^t,(t\ne 0)$ 有 $\beta_1$ 种取值，加上一种 $x,y$ 都不含 $p_1$ ，共 $\alpha_1+\beta_1+1$ 种有意义的取值，类似的，讨论其它质因数，乘法原理得左式等于右式</p><p> QED</p><p>我们发现 $Ans=\sum_{i=1}^{N}\sum_{j=1}^{M}\sum_{x|i}\sum_{y|j}[gcd(x,y)==1]$ ，类似与上题，令： $f(n)=\sum_{i=1}^{N}\sum_{j=1}^{M}\sum_{x|i}\sum_{y|j}[gcd(x,y)==n],F(n)=\sum_{i=1}^{N}\sum_{j=1}^{M}\sum_{x|i}\sum_{y|j}[n|gcd(x,y)]$ 那么 $Ans=f(1)$ </p><p>则 $F(n)=\sum_{n|d}f(d)$ ，反演得 $f(n)=\sum_{n|d}\mu(\frac{d}{n})F(d)$ </p><p>故 $f(1)=\sum_{d=1}^{N}\mu(d)F(d)$ ，为了求出 $f(1)$ ，我们来看 $F(n)$ ，由于 $[n|gcd(x,y)]$ 与 $i,j$ 无关，我们可以枚举 $x,y$ 计算有多少 $i,j$ 符合要求， $F(n)=\sum_{x=1}^{N}\sum_{y=1}^{M}\lfloor\frac{N}{x}\rfloor\lfloor\frac{M}{y}\rfloor[n|gcd(x,y)]$ </p><p>同上题一样，可设 $x’=\frac{x}{n},y’=\frac{y}{n},N’=\frac{N}{n},M’=\frac{M}{n}$ ，得 $F(n)=\sum_{x’=1}^{N’}\sum_{y’=1}^{M’}\lfloor\frac{N’}{x’}\rfloor\lfloor\frac{M’}{y’}\rfloor$ </p><p>调换循环顺序得 $F(n)=(\sum_{x’=1}^{N’}\lfloor\frac{N’}{x’}\rfloor)(\sum_{y’=1}^{M’}\lfloor\frac{M’}{y’}\rfloor)$ </p><p>令 $h(k)=\sum_{i=1}^{k}\lfloor\frac{k}{i}\rfloor$ ，有 $F(n)=h(N’)h(M’)$ ，故 $f(1)=\sum_{d=1}^{N}\mu(d)h(\frac{N}{d})h(\frac{M}{d})$ ，预处理所有的 $h(x)$ ，数论分块解决</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> pri[N],cnt,mu[N];</span><br><span class="line">LL sum[N],h[N];</span><br><span class="line"><span class="keyword">bool</span> v[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> k/(k/x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pred</span><span class="params">()</span></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) pri[++cnt]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;pri[j]*i&lt;N;++j)&#123;</span><br><span class="line">v[pri[j]*i]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;</span><br><span class="line">mu[i*pri[j]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i*pri[j]]=-mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">sum[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) sum[i]=sum[i<span class="number">-1</span>]+mu[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>,r;l&lt;=i;l=r+<span class="number">1</span>)&#123;</span><br><span class="line">r=<span class="built_in">min</span>(i,<span class="built_in">g</span>(i,l));</span><br><span class="line">h[i]+=(r-l+<span class="number">1</span>)*(i/l);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">pred</span>();</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line"><span class="keyword">while</span>(T--)&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">LL ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">_t</span>=<span class="built_in">min</span>(n,m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>,r;l&lt;=<span class="keyword">_t</span>;l=r+<span class="number">1</span>)&#123;</span><br><span class="line">r=<span class="built_in">min</span>(<span class="keyword">_t</span>,<span class="built_in">min</span>(<span class="built_in">g</span>(n,l),<span class="built_in">g</span>(m,l)));</span><br><span class="line">ans+=(sum[r]-sum[l<span class="number">-1</span>])*h[n/l]*h[m/l];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="例题三"><a href="#例题三" class="headerlink" title="例题三"></a>例题三</h3><p><a href="https://www.luogu.com.cn/problem/P2303">龙哥的问题</a></p><p>本题比较简单，甚至不用莫反</p><p>考虑答案：<br>$$<br>\begin{align}<br>Ans<br>&amp;=\sum_{i=1}^{n}gcd(i,n)\\<br>&amp;=\sum_{d|n}(d\times\sum_{i=1}^{n}[gcd(i,n)==d])\\<br>&amp;=\sum_{d|n}(d\times\sum_{i=1}^{n}[gcd(\frac{i}{d},\frac{n}{d})==1])\\<br>&amp;=\sum_{d|n}d\times\varphi(\frac{n}{d})<br>\end{align}<br>$$<br>对于每一个 $n$ 枚举约数（ $int$ 范围内最多的一个数约数只有 $1600$ 多个） ，再 $\sqrt{n}$ 求 $\varphi$ ，本题的范围可以通过</p><p>那可否继续优化呢？令 $k=\frac{n}{d}$ ，再继续化一下：<br>$$<br>\begin{align}<br>Ans<br>&amp;=\sum_{d|n}d\times\varphi(\frac{n}{d})\\<br>&amp;=\sum_{k|n}\frac{n}{k}\times\varphi(k)\\<br>&amp;=\sum_{k|n}\frac{n}{k}\times k\prod(1-\frac{1}{p_i})\\<br>&amp;=n\sum_{k|n}\prod(1-\frac{1}{p_i})<br>\end{align}<br>$$<br>其中 $k_t=\prod p_i^{c_{i,t}}$ ，又因为 $k|n$ ，不妨设 $n=\prod p_i^{\alpha_i}$  ，下面的变化比较常用，要记住：<br>$$<br>\begin{align}<br>&amp;k|d\\<br>\Rightarrow&amp;\forall k_t,0\le c_{i,t}\le\alpha_i\\<br>\Rightarrow&amp;\sum_{k|n}k=\sum_{t}\prod_{i} p_i^{c_{i,t}}=\prod_{t}\sum_{i} p_i^{c_{i,t}}\\<br>&amp;=(p_1^0+p_1^2+…+p_1^{\alpha_1})(p_2^0+p_2^2+…+p_2^{\alpha_2})…<br>\end{align}<br>$$</p><p>如果不理解的话可以这样想：每个括号里取一项作 $p_i^{c_{i,t}}$ 乘起来刚好对应一个 $k_t$ </p><p>那么考虑上式对答案的贡献，我们发现对于所有的 $k$ ，若取第 $i$ 个质因子的指数为 $0$ （即取 $p_i^0$ ）对答案贡献为 $1$ ，其他情况（即 $p_i^c,c\ne0$ ）对答案的贡献都是 $1-\frac{1}{p_i}$ ，故答案可化为：<br>$$<br>\begin{align}<br>Ans<br>&amp;=n\prod_{i}(1+(1-\frac{1}{p_i})+(1-\frac{1}{p_i})+…+(1-\frac{1}{p_i}))\\<br>&amp;=n\prod_{i}(1+a(1-\frac{1}{p_i}))<br>\end{align}<br>$$<br>分解 $n$ 的质因子，可以在 $O(\sqrt{n})$ 时间求解，但注意，本题对 $long\ long$ 卡的非常死，甚至在计算 $ans$ 时先乘再除都会炸 $long\ long$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">LL n;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;n);</span><br><span class="line">LL ans=n; <span class="comment">//最初的n </span></span><br><span class="line"><span class="keyword">for</span>(LL i=<span class="number">2</span>;i*i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">LL a=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(n%i==<span class="number">0</span>) ++a,n/=i;</span><br><span class="line">ans/=i,ans*=i+a*i-a; <span class="comment">//一定要先除 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(n&gt;<span class="number">1</span>) ans/=n,ans*=n+n<span class="number">-1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="例题四"><a href="#例题四" class="headerlink" title="例题四"></a>例题四</h3><p>来看一道难题：</p><p><a href="https://www.luogu.com.cn/problem/P3704">数字表格</a></p><p>这道题要点很杂很多，我们慢慢看：</p><p>首先明确<br>$$<br>Ans=\prod_{i=1}^{n}\prod_{j=1}^{m}fb(gcd(i,j))<br>$$<br>其中 $fb(x)$ 表示Fibonacci数列第 $x$ 项</p><p>由于 $\prod$ 不好处理，考虑枚举 $gcd$ ：<br>$$<br>Ans=\prod_{d=1}^{N}[fb(d)]^{f(d)}<br>$$<br>其中 $N=\min(n,m)$ ， $f(d)=\sum_{i=1}^{m}\sum_{j=1}^{n}[gcd(i,j)==d]$</p><p>发现这个 $f$ 的定义我们非常熟悉，于是一通莫反：<br>$$<br>\begin{align}<br>\text{令}&amp;F(d)=\sum_{i=1}^{m}\sum_{j=1}^{n}[d|gcd(i,j)]\\<br>\text{则有}&amp;F(d)=\sum_{r|d}f(r)\\<br>\text{反演得}&amp;f(d)=\sum_{d|r}\mu(\frac{r}{d})F(r)\\<br>\text{又有}&amp;d|gcd(i,j)\Leftrightarrow d|i,d|j\\<br>\text{故}&amp;F(d)=\lfloor\frac{n}{d}\rfloor\lfloor\frac{m}{d}\rfloor\\<br>\text{带入得}&amp;f(d)=\sum_{d|r}\mu(\frac{r}{d})\lfloor\frac{n}{r}\rfloor\lfloor\frac{m}{r}\rfloor\\<br>\text{令}w=\frac{r}{d},\text{有}&amp;f(d)=\sum_{w=1}^{\lfloor\frac{N}{d}\rfloor}\mu(w)\lfloor\frac{n}{wd}\rfloor\lfloor\frac{m}{wd}\rfloor<br>\end{align}<br>$$<br>此时我们发现在莫反后， $f(d)$ 可以在 $O(\sqrt{n})$ 内计算，但是，我们观察 $Ans$ ，对于每个 $d$ ， $f(d)$ 都必须重新计算（因为 $f$ 与 $n,m,d$ 都有关），这样的时间负责度为 $O(Tn(\sqrt{n}+\log{n}))$ 直接爆炸好吧</p><p>必须考虑优化，但 $fb$ 和 $\prod$ 都太不好搞了， $f$ 也不好在变形（我在这里卡了好久），既然两个都不好搞，我们不妨把它们一起来看看：<br>$$<br>Ans=\prod_{d=1}^{N}[fb(d)]^{\sum_{w=1}^{\lfloor\frac{N}{d}\rfloor}\mu(w)\lfloor\frac{n}{wd}\rfloor\lfloor\frac{m}{wd}\rfloor}<br>$$<br>我们发现一个关键点：每次询问只修改 $n,m$ 而 $d,w$ 对于每次询问来说是一样的，这启发我们把几个与 $n,m$ 无关的项拿出来预处理：</p><p>$$<br>\begin{align}<br>Ans=\prod_{d=1}^{N}[fb(d)]^{\sum_{w=1}^{\lfloor\frac{N}{d}\rfloor}\mu(w)\lfloor\frac{n}{wd}\rfloor\lfloor\frac{m}{wd}\rfloor}\\<br>=\prod_{d=1}^{N}{[fb(d)]^{\sum_{w=1}^{\lfloor\frac{N}{d}\rfloor}\mu(w)}}^{\lfloor\frac{n}{wd}\rfloor\lfloor\frac{m}{wd}\rfloor}\\<br>\text{令}p=wd,\text{有}Ans<br>=\prod_{p=1}^{N}{[\prod_{d|p}fb(d)]^{\mu(\frac{p}{d})}}^{\lfloor\frac{n}{p}\rfloor\lfloor\frac{m}{p}\rfloor}\\<br>\text{令}h(p)=\prod_{d|p}fb(d)^{\mu(\frac{p}{d})},\text{有}Ans<br>=\prod_{p=1}^{N}h(p)^{\lfloor\frac{n}{p}\rfloor\lfloor\frac{m}{p}\rfloor}<br>\end{align}<br>$$</p><p>发现指数位置的 $\lfloor\frac{n}{p}\rfloor\lfloor\frac{m}{p}\rfloor$ 可以数论分块，而 $h$ 可以提前预处理出前缀积，如此，回答询问的总时间变为 $O(T\sqrt{n}\log{n})$ </p><p>下面考虑如何计算 $h$ ，由于因数不好枚举，我们改为枚举倍数：<br>$$<br>\begin{align}<br>h(p)<br>&amp;=\prod_{d|p}fb(d)^{\mu(\frac{p}{d})}\\<br>&amp;=\prod_{i=1}^{N}fb(\frac{p}{i})^{\mu(i)}\\<br>\text{变形得}h(ij)<br>&amp;=\prod_{i=1}^{N}\prod_{j=1}^{\lfloor\frac{N}{i}\rfloor}fb(j)^{\mu(i)}<br>\end{align}<br>$$<br>预处理时间为 $O(n\log{n})$ </p><p>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1000000</span>+<span class="number">5</span>,P=<span class="number">1000000000</span>+<span class="number">7</span>;</span><br><span class="line">LL pri[N],cnt,mu[N],fb[N],h[N],inv_fb[N],mul[N];</span><br><span class="line"><span class="keyword">bool</span> v[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> k/(k/x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL x,LL y)</span></span>&#123;</span><br><span class="line">LL res=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(y)&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=(res*x)%P;</span><br><span class="line">x=(x*x)%P;</span><br><span class="line">y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pred</span><span class="params">()</span></span>&#123;</span><br><span class="line">mu[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(!v[i]) pri[++cnt]=i,mu[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt&amp;&amp;pri[j]*i&lt;N;++j)&#123;</span><br><span class="line">v[pri[j]*i]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>)&#123;</span><br><span class="line">mu[i*pri[j]]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">mu[i*pri[j]]=-mu[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fb[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">fb[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">inv_fb[<span class="number">1</span>]=<span class="number">1</span>; <span class="comment">//特殊处理</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i) fb[i]=(fb[i<span class="number">-1</span>]+fb[i<span class="number">-2</span>])%P,inv_fb[i]=<span class="built_in">qpow</span>(fb[i],P<span class="number">-2</span>); <span class="comment">//求逆元</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) h[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!mu[i])<span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j*i&lt;N;++j)</span><br><span class="line">        h[j*i]=h[j*i]*(mu[i]==<span class="number">1</span>?fb[j]:inv_fb[j])%P; <span class="comment">//注意mu可能为负一</span></span><br><span class="line">    &#125;</span><br><span class="line">mul[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) mul[i]=(mul[i<span class="number">-1</span>]*h[i])%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get_ans</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">LL res=<span class="number">1</span>,as;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">_t</span>=<span class="built_in">min</span>(x,y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>,r;l&lt;=<span class="keyword">_t</span>;l=r+<span class="number">1</span>)&#123;</span><br><span class="line">r=<span class="built_in">min</span>(<span class="keyword">_t</span>,<span class="built_in">min</span>(<span class="built_in">g</span>(x,l),<span class="built_in">g</span>(y,l)));</span><br><span class="line">as=mul[r]*<span class="built_in">qpow</span>(mul[l<span class="number">-1</span>],P<span class="number">-2</span>)%P; <span class="comment">//前缀积得底数</span></span><br><span class="line">res=res*<span class="built_in">qpow</span>(as,<span class="number">1ll</span>*(x/l)*(y/l)%(P<span class="number">-1</span>))%P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">pred</span>();</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">while</span>(T--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,<span class="built_in">get_ans</span>(n,m));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="补充：变换方法"><a href="#补充：变换方法" class="headerlink" title="补充：变换方法"></a>补充：变换方法</h2><p>下面记录一些常见的变换方法：</p><ul><li><p>$$<br>gcd(i,j)==1\Leftrightarrow\sum_{d|i\wedge d|j}\mu(d)<br>$$</p></li><li><p>像例题四一样的完全展开预处理无关项</p></li><li><p>像例题二一样 $d(ij)=\sum_{x|i}\sum_{y|j}[gcd(x,y)==1]$ </p></li><li><p>改变未知数使得两个 $\sum$ 分离，预处理其中一个（也可以看作将两数积设出，继续化简）</p><p>如<a href="https://www.luogu.com.cn/problem/P2257">YY的GCD</a>，莫反后得<br>$$<br>\sum_{k\in prime}\sum_{d=1}^{\lfloor\frac{min(N,M)}{k}\rfloor}\mu(d)\lfloor\frac{N}{kd}\rfloor\lfloor\frac{M}{kd}\rfloor<br>$$<br>若直接计算，对于每个询问，最坏时间复杂度为 $O(n)$ 会TLE，可以变化如下：</p><p>$$<br>\begin{align}<br>\text{设}T<br>&amp;=kd\\<br>\text{则原式}<br>&amp;=\sum_{k\in primes}\sum_{d=1}^{\lfloor\frac{min(N,M)}{k}\rfloor}\mu(d)\lfloor\frac{N}{T}\rfloor\lfloor\frac{M}{T}\rfloor\\<br>&amp;=\sum_{T=1}^{min(N,M)}\sum_{k|T \wedge k\in prime}\mu(\frac{T}{k})\lfloor\frac{N}{T}\rfloor\lfloor\frac{M}{T}\rfloor\\<br>&amp;=\sum_{T=1}^{min(N,M)}\lfloor\frac{N}{T}\rfloor\lfloor\frac{M}{T}\rfloor\sum_{k|T\wedge k\in prime}\mu(\frac{T}{k})\\<br>\end{align}<br>$$</p><p>后面的 $\sum$ 与询问无关，可以预处理</p></li><li><p>注意卷积中的一些常用等式，如 $Id*\mu=\varphi$ ：</p><p>$$<br>\begin{align}<br>Ans<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{n}gcd(i,j)\\<br>\text{莫反得}Ans<br>&amp;=\sum_{r=1}^{n}\lfloor\frac{n}{r}\rfloor\lfloor\frac{n}{r}\rfloor\sum_{d|r}d*\mu(\frac{r}{d})\\<br>&amp;=\sum_{r=1}^{n}\lfloor\frac{n}{r}\rfloor\lfloor\frac{n}{r}\rfloor\varphi(r)<br>\end{align}<br>$$</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 莫比乌斯反演 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模拟退火和爬山法</title>
      <link href="/2021/11/22/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E5%92%8C%E7%88%AC%E5%B1%B1%E6%B3%95/"/>
      <url>/2021/11/22/%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB%E5%92%8C%E7%88%AC%E5%B1%B1%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>暴搜能过样例了！</p><span id="more"></span><h1 id="模拟退火（Simulated-Annealing）"><a href="#模拟退火（Simulated-Annealing）" class="headerlink" title="模拟退火（Simulated Annealing）"></a>模拟退火（Simulated Annealing）</h1><h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>模拟退火是一种启发式的随机暴力算法，主要用于解决最优化问题。</p><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul><li>温度：决定每次随机时我们随机的范围，温度越大，下一个点的随机区间越大，在模拟退火中，温度总是不断减小，一般把温度记为 $T$ ；</li><li>初始温度：最初的温度值；</li><li>终止温度：结束时的温度；</li><li>衰减方式：每次温度的变化，可以是一次（如 $T_i=T_{i-1}-c$ )，也可以是指数级（如 $T_i=T_{i-1}*c,c\in (0,1)$ )等，根据实际情况而定，但一般要保证 $T_i&lt;T_{i-1}$ ；</li><li>能量值：当前答案的“权值”，或者说“优秀程度”，能量值越小，答案越优，个人喜欢记答案 $x$ 的能量值为 $E(X)$ ；</li></ul><h2 id="算法过程"><a href="#算法过程" class="headerlink" title="算法过程"></a>算法过程</h2><ol><li>确定初始点（初始答案），初始温度为 $T_0$ (一般保证足够大)，终止温度 $T_e$ （一般保证足够小）,衰减方式；</li><li>在当前点（设为 $now$ ）温度范围内随机选择一个值 $np$ ，计算答案 $E(np)$ ，记 $E(np)-E(now)=\Delta E$  ；</li><li>若 $\Delta E &lt; 0$ ，说明 $np$ 比 $now$ 优，则跳转到 $np$ ;</li><li>若 $\Delta E &gt; 0$ ，则以一定的概率跳转到 $np$ ，一般来说，这个概率取成 $e^{-\frac{\Delta E}{T}}$ ，这样取的好处是 $np$ 比 $now$ 越差，我们跳转过去的概率越小 ;</li></ol><h2 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.luogu.com.cn/problem/UVA10228">A Star not a Tree?</a></p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> T0=<span class="number">10000</span>+<span class="number">5</span>,TE=<span class="number">1e-4</span>,C=<span class="number">0.99</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">double</span> x,y;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">double</span> _x,<span class="keyword">double</span> _y)</span></span>&#123;</span><br><span class="line">x=_x;</span><br><span class="line">y=_y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">double</span> ans=INF;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">rand_d</span><span class="params">(<span class="keyword">double</span> l,<span class="keyword">double</span> r)</span></span>&#123; <span class="comment">//随机得到一个[l,r)的浮点数 </span></span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">double</span>)<span class="built_in">rand</span>()/RAND_MAX*(r-l)+l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_dist</span><span class="params">(Node x,Node y)</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> dx=x.x-y.x;</span><br><span class="line"><span class="keyword">double</span> dy=x.y-y.y;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">sqrt</span>(dx*dx+dy*dy);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">E</span><span class="params">(Node x)</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) res+=<span class="built_in">get_dist</span>(x,q[i]);</span><br><span class="line">ans=<span class="built_in">min</span>(ans,res); <span class="comment">//记得更新ans</span></span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">simulate_anneal</span><span class="params">()</span></span>&#123;</span><br><span class="line">Node now;</span><br><span class="line">now.<span class="built_in">inint</span>(<span class="built_in">rand_d</span>(<span class="number">0</span>,T0),<span class="built_in">rand_d</span>(<span class="number">0</span>,T0));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">double</span> t=T0;t&gt;TE;t*=C)&#123;</span><br><span class="line">Node np;</span><br><span class="line">np.<span class="built_in">inint</span>(<span class="built_in">rand_d</span>(now.x-t,now.x+t),<span class="built_in">rand_d</span>(now.y-t,now.y+t));</span><br><span class="line"><span class="keyword">double</span> dt=<span class="built_in">E</span>(np)-<span class="built_in">E</span>(now);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">exp</span>(-dt/t)&gt;<span class="built_in">rand_d</span>(<span class="number">0</span>,<span class="number">1</span>)) now=np;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这里exp(-dt/t)是求e的(-dt/t)次方,当dt&lt;0时,其值恒大于1,一定会跳转到np</span></span><br><span class="line"><span class="comment">当dt&gt;0时,其值恒小于1,且dt越小,其值越大,跳转的概率也就越大 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line"><span class="keyword">while</span>(T--)&#123;</span><br><span class="line">ans=INF;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>,&amp;q[i].x,&amp;q[i].y);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;++i) <span class="built_in">simulate_anneal</span>(); <span class="comment">//多次模拟退火使答案正确的概率变大</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.0lf\n&quot;</span>,ans);</span><br><span class="line"><span class="keyword">if</span>(T!=<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h2><p>模拟退火不只能解决那些数学模型非常明显的题目，也可以解决一些其他最优化问题，只要保证答案具有“连续性”（即设 $\gamma$ 是大于 $0$ 且足够小的实数， $\forall x$ ，有 $|E(x)-E(x+ \gamma)|$ 足够小）。</p><p>看看这题<a href="https://www.luogu.com.cn/problem/P4044">保龄球</a></p><p>对于这种给数列 $A$ ，求 $A$ 的某种最优排列的问题，我们可以思考如何使用模拟退火：</p><ol><li>温度可以直接像上题一样设置，衰减也可以自设；</li><li>初始点（初始排列）就用题目给的原排列，每次转移时在原排列上随机两个位置交换，得到下一个排列；</li><li>依题意打估价函数 $E(x)$ ，估价并概率转移；</li></ol><p>由上，我们发现本题可以轻松用退火解决。</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> T0=<span class="number">1e4</span>+<span class="number">5</span>,TE=<span class="number">1e-4</span>,C=<span class="number">0.99</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> ans=-INF;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Try</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">E</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line">res+=q[i].x+q[i].y;</span><br><span class="line"><span class="keyword">if</span>(i&lt;=n)&#123;</span><br><span class="line"><span class="keyword">if</span>(q[i].x==<span class="number">10</span>) res+=q[i+<span class="number">1</span>].x+q[i+<span class="number">1</span>].y;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(q[i].x+q[i].y==<span class="number">10</span>) res+=q[i+<span class="number">1</span>].x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ans=<span class="built_in">max</span>(ans,res);</span><br><span class="line"><span class="keyword">return</span> -res;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&quot;优&quot;的答案,能量反而低</span></span><br><span class="line"><span class="comment">当然也可以返回res,在simulate_anneal里使dt=x-y </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">simulate_anneal</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">double</span> t=T0;t&gt;TE;t*=C)&#123;</span><br><span class="line"><span class="keyword">int</span> a=<span class="built_in">rand</span>()%m+<span class="number">1</span>,b=<span class="built_in">rand</span>()%m+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> now=<span class="built_in">E</span>();</span><br><span class="line"><span class="built_in">swap</span>(q[a],q[b]);</span><br><span class="line"><span class="keyword">if</span>(n+(q[n].x==<span class="number">10</span>)==m)&#123;</span><br><span class="line"><span class="keyword">int</span> np=<span class="built_in">E</span>();</span><br><span class="line"><span class="keyword">int</span> dt=np-now;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">exp</span>(-dt/t)&lt;(<span class="keyword">double</span>)<span class="built_in">rand</span>()/RAND_MAX) <span class="built_in">swap</span>(q[a],q[b]);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这里用小于号,代表若不跳转至np,就把a、b复原</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">swap</span>(q[a],q[b]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;q[i].x,&amp;q[i].y);</span><br><span class="line"><span class="keyword">if</span>(q[n].x==<span class="number">10</span>) m=n+<span class="number">1</span>,<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;q[m].x,&amp;q[m].y);</span><br><span class="line"><span class="keyword">else</span> m=n;</span><br><span class="line"><span class="keyword">while</span>((<span class="keyword">double</span>)<span class="built_in">clock</span>()/CLOCKS_PER_SEC&lt;<span class="number">0.8</span>) <span class="built_in">simulate_anneal</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题三"><a href="#例题三" class="headerlink" title="例题三"></a>例题三</h2><p>一道类似于上题的排列退火，但加入一定的优化</p><p><a href="https://www.luogu.com.cn/problem/P2503">均分数据</a></p><p>这道题直接模拟退火也能过，但略显的有点过于暴力，我们可以考虑模拟退火加一点贪心（当然也可以加DP，但那样还不如直接用DP，<del>我就是做不出DP才模拟退火的好吧</del>）：</p><p>先用退火得到数列的排列，计算当前答案时，对于当前数 $a_i$ ,我们每次都将 $a_i$ 放到当前和最小的集合中，贪心计算。可以证明，<del>虽然我不会证</del>，这样贪心是不会漏掉最优解的。</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">20</span>+<span class="number">5</span>,M=<span class="number">10</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> T0=<span class="number">1e4</span>+<span class="number">5</span>,TE=<span class="number">1e-6</span>,C=<span class="number">0.99</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> w[N],s[M];</span><br><span class="line"><span class="keyword">double</span> ans=INF;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">E</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) s[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,k=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j) <span class="keyword">if</span>(s[j]&lt;s[k]) k=j;</span><br><span class="line">s[k]+=w[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> avg=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) avg+=(<span class="keyword">double</span>)s[i]/m;</span><br><span class="line"><span class="keyword">double</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) res+=(s[i]-avg)*(s[i]-avg);</span><br><span class="line">res=<span class="built_in">sqrt</span>(res/m);</span><br><span class="line">ans=<span class="built_in">min</span>(ans,res);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">simulate_anneal</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">random_shuffle</span>(w+<span class="number">1</span>,w+<span class="number">1</span>+n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">double</span> t=T0;t&gt;TE;t*=C)&#123;</span><br><span class="line"><span class="keyword">int</span> a=<span class="built_in">rand</span>()%n+<span class="number">1</span>,b=<span class="built_in">rand</span>()%n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">double</span> x=<span class="built_in">E</span>();</span><br><span class="line"><span class="built_in">swap</span>(w[a],w[b]);</span><br><span class="line"><span class="keyword">double</span> y=<span class="built_in">E</span>();</span><br><span class="line"><span class="keyword">double</span> dt=y-x;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">exp</span>(-dt/t)&lt;(<span class="keyword">double</span>)<span class="built_in">rand</span>()/RAND_MAX) <span class="built_in">swap</span>(w[a],w[b]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;w[i]);</span><br><span class="line"><span class="keyword">while</span>((<span class="keyword">double</span>)<span class="built_in">clock</span>()/CLOCKS_PER_SEC&lt;<span class="number">0.8</span>) <span class="built_in">simulate_anneal</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上两个题都用了 $while((double)clock()/CLOCKS_PER_SEC&lt;0.8)$ 来控制退火次数，在实际做题时，一般计算好循环次数的代码会更稳定一些，但如果不好估算循环次数，这样也不失为一种选择。</p><h1 id="爬山法"><a href="#爬山法" class="headerlink" title="爬山法"></a>爬山法</h1><p>对于一个凸函数（单峰函数），我们可以用爬山法解决（当然，和退火一样，不是要求题目有明确的函数模型，只是需要答案对于每一维自变量你能感觉到一个单峰函数即可，<del>有点玄学</del>）。</p><p>爬山法的思路大体如图：</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/v5q77sd9.png" alt="爬山"></p><p>对于点 $now$ 我们并不关心它对应的具体值是多少，我们只关心它去向答案的“方向”（如图中应该是蓝色箭头方向），然后我们只需要向着“方向”走即可，图中是一个维度，而多个维度就分每个维度单独计算“方向”即可。当然，走的“距离”视具体情况而定。</p><p>需要注意的是，爬山法局限较多，不太常用，但仍不失为一种很好的启发式算法。</p><h2 id="例题一-1"><a href="#例题一-1" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.luogu.com.cn/problem/P4035">球形空间产生器</a></p><p>本题正解是高斯消元，建立方程联立求解即可，但如果你和我一样高斯消元和矩阵学的不好，也可以用爬山法搞定。</p><p>我们发现对于 $n$ 维坐标的每一维，都是一个单峰函数（球心到各点距离相等），所以对于一个可能答案的一维，求它到各点的距离的平均值，距离大于平均值的点表现出拉力，反之为推力，将所有力合成即可。</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">20</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> d[N][N];</span><br><span class="line"><span class="keyword">double</span> ans[N],dis[N],delta[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> avg=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)&#123;</span><br><span class="line">dis[i]=delta[i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">dis[i]+=(d[i][j]-ans[j])*(d[i][j]-ans[j]);</span><br><span class="line">dis[i]=<span class="built_in">sqrt</span>(dis[i]);</span><br><span class="line">avg+=dis[i]/(n+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n;++j)</span><br><span class="line">delta[j]+=(dis[i]-avg)*(d[i][j]-ans[j])/avg;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;d[i][j]);</span><br><span class="line">ans[j]+=d[i][j]/(n+<span class="number">1</span>); <span class="comment">//先将初始答案定为重心 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">double</span> t=<span class="number">1e4</span>;t&gt;<span class="number">1e-6</span>;t*=<span class="number">0.99997</span>)&#123;</span><br><span class="line"><span class="built_in">calc</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans[i]+=delta[i]*t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">printf</span>(<span class="string">&quot;%.3lf &quot;</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然，此题用模拟退火也行，代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> T0=<span class="number">1e4</span>+<span class="number">5</span>,TE=<span class="number">1e-6</span>,C=<span class="number">0.99995</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">double</span> x[N];</span><br><span class="line">Node <span class="keyword">operator</span>+(<span class="keyword">const</span> Node &amp;<span class="keyword">_t</span>) &#123;</span><br><span class="line">    Node res;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) res.x[i]=x[i]+<span class="keyword">_t</span>.x[i];</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;q[N],ans;</span><br><span class="line"><span class="keyword">double</span> as=INF;</span><br><span class="line"><span class="keyword">double</span> s[N];</span><br><span class="line">Node now,np;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">rand_d</span><span class="params">(<span class="keyword">double</span> l,<span class="keyword">double</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">double</span>)<span class="built_in">rand</span>()/RAND_MAX*(r-l)+l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_dist</span><span class="params">(Node x,Node y)</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) res+=(x.x[i]-y.x[i])*(x.x[i]-y.x[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">sqrt</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">E</span><span class="params">(Node x)</span></span>&#123;</span><br><span class="line"><span class="keyword">double</span> avg=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)&#123;</span><br><span class="line">s[i]=<span class="built_in">get_dist</span>(x,q[i]);</span><br><span class="line">avg+=s[i];</span><br><span class="line">&#125;</span><br><span class="line">avg=avg/(n+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">double</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i) res+=(s[i]-avg)*(s[i]-avg);</span><br><span class="line">res*=avg;</span><br><span class="line"><span class="keyword">if</span>(res&lt;as)&#123;</span><br><span class="line">as=res;</span><br><span class="line">ans=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">simulate_anneal</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i) now=now+q[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) now.x[i]=now.x[i]/(n+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">double</span> t=T0;t&gt;TE;t*=C)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) np.x[i]=now.x[i]+<span class="built_in">rand_d</span>(-t,t);</span><br><span class="line"><span class="keyword">double</span> dt=<span class="built_in">E</span>(np)-<span class="built_in">E</span>(now);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">exp</span>(-dt/t)&gt;<span class="built_in">rand_d</span>(<span class="number">0</span>,<span class="number">1</span>)) now=np;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;q[i].x[j]);</span><br><span class="line"><span class="built_in">simulate_anneal</span>(); </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">时间有限,且答案对C要求较高,我们只退火一次,</span></span><br><span class="line"><span class="comment">对应的,C调高</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">printf</span>(<span class="string">&quot;%.3lf &quot;</span>,ans.x[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="牛顿迭代法"><a href="#牛顿迭代法" class="headerlink" title="牛顿迭代法"></a>牛顿迭代法</h2><p>对于维度少的单峰函数，除了用三分法求最值外，也可用牛顿迭代法（又名牛顿爬山法）</p><p>牛顿迭代法的核心公式是<br>$$<br>x_{i+1}=x_i-\frac{f(x_i)}{f’(x_i)}<br>$$<br>但牛顿迭代法有一个巨大的缺陷——我这么弱根本求不出导函数来，<del>笑死</del>。</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴力 </tag>
            
            <tag> 模拟退火 </tag>
            
            <tag> 爬山法 </tag>
            
            <tag> 随机数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>快速傅里叶变换</title>
      <link href="/2021/11/22/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/"/>
      <url>/2021/11/22/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<p>FFT常数比NTT大！</p><span id="more"></span><h1 id="快速傅里叶变换"><a href="#快速傅里叶变换" class="headerlink" title="快速傅里叶变换"></a>快速傅里叶变换</h1><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>快速傅里叶变换（FFT）是一种快速求解两个多项式的乘积（或者称之为两个函数的卷积，但注意，这个卷积不是狄拉克雷卷积）的方法</p><p>例如已知<br>$$<br>\begin{align}<br>A(x)=a_0+a_1x+a_2x^2+…+a_nx^n\\<br>B(x)=b_0+b_1x+b_2x^2+…+b_nx^n<br>\end{align}<br>$$<br>求 $A*B$ </p><p>如果直接计算，复杂度显然为 $O(n^2)$ ，而FFT可以在 $O(n\log{n})$ 的时间求出答案</p><h2 id="前置知识：复数"><a href="#前置知识：复数" class="headerlink" title="前置知识：复数"></a>前置知识：复数</h2><p>任意一个复数可以表示为 $a+bi$ 的形式，其中 $a$ 被称为<strong>实部</strong>， $b$ 被称为<strong>虚部</strong>， $i=\sqrt{-1}$ 是<strong>虚数单位</strong></p><p>类似于实数可以对应到数轴上，复数可以对应到坐标轴上 </p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/k3uo7b61.png" alt="复数"></p><p>如上图， $X$ 轴表示实部， $Y$ 轴表示虚部，则 $a+bi$ 可对应到唯一的一个点，而 $a+bi$ 也就有了几何意义：一条从原点指向 $(a,b)$ 的向量 ，而该向量与 $X$ 轴的夹角 $\theta$ 被称为该复数的<strong>辐角</strong></p><p>则复数的运算有以下法则：</p><ul><li><p>$(a+bi)+(c+di)=(a+c)+(b+d)i$ </p><p>复数加法的几何意义就是向量加法</p></li><li><p>$(a+bi)(c+di)=ac+adi+cbi+bdi^2=(ac-bd)+(ad+cb)i$  </p><p>复数乘法有很好的几何意义，两个向量 $\vec{a},\vec{b}$ 的积 $\vec{c}$ 的长度（模）就是两个向量的长度和，即 $|\vec{c}|=|\vec{a}|+|\vec{b}|$ ，积的辐角就是两个向量辐角的和，即 $\theta_c=\theta_a+\theta_b$ </p></li></ul><p>在平面直角坐标系 $X0Y$ 中，画一个单位圆，将其等分为 $n$ 份，取其中的 $k$ 份，将原点于 $k$ 份的点连接形成一个向量，记为 $\omega_n^k$ ，我们称 $\omega_n^k$ 为复数域上的 $n$ 次<strong>单位根</strong>（即方程 $z^n=1$ 的根）</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/72t9f57x.png" alt="单位根"></p><p>单位根有以下性质：</p><ul><li> $\forall i\not\equiv j\pmod n,\omega_n^i\ne\omega_n^j,\forall i\equiv j\pmod n,\omega_n^i=\omega_n^j$ </li><li> $\omega_n^k=\cos{\frac{2k\pi}{n}}+i\sin{\frac{2k\pi}{n}}$ </li><li> $\omega_n^0=\omega_n^n=1$ </li><li> $\omega_{rn}^{rk}=\omega_n^k$ </li><li> $\omega_n^{k+\frac{n}{2}}=-\omega_n^k,\omega_n^{k+n}=\omega_n^k$ </li><li> $\omega_n^i*\omega_n^j=\omega_n^{i+j}$ （相乘等于辐角相加）</li></ul><h2 id="前置知识：小性质"><a href="#前置知识：小性质" class="headerlink" title="前置知识：小性质"></a>前置知识：小性质</h2><p>我们明确一个性质（在拉格朗日插值中也用到了该性质）：</p><ul><li>任意 $n+1$ 个不同的点（可以含复数）可以唯一确定一个 $n$ 次多项式（或者称其为 $n$ 次函数）</li></ul><p>证明：</p><p>把每个点带人列得 $n+1$ 个 $n+1$ 元（因为下标从 $0$ 到 $n$ ）一次方程，明显可解，则每一项的系数唯一确定，原多项式确定</p><h2 id="快速傅里叶正变换"><a href="#快速傅里叶正变换" class="headerlink" title="快速傅里叶正变换"></a>快速傅里叶正变换</h2><p>有了以上性质，我们可以把一个 $n$ 次多项式用 $n+1$ 个点表示（也叫函数的点表示法），则答案推演如下：<br>$$<br>\begin{align}<br>&amp;A(x)=a_0+a_1x+a_2x^2+…+a_nx^n\\<br>\text{可表示为}&amp;A:{(x_1,A(x_1)),(x_2,A(x_2)),…,(x_{n+1},A(x_{n+1}))}\\<br>\text{同理}&amp;B:{(x_1,B(x_1)),(x_2,B(x_2)),…,(x_{n+1},B(x_{n+1}))}\\<br>\text{则}C=A*&amp;B:{(x_1,A(x_1)B(x_1)),(x_2,A(x_2)B(x_2)),…,(x_{n+1},A(x_{n+1})B(x_{n+1}))}<br>\end{align}<br>$$<br>我们发现在点表示法下求 $A*B$ 是 $O(n)$ 的，那么问题其实就变成了如何快速的实现点表示法和系数表示法的互相转换</p><p>我们观察性质，<strong>任意</strong>两个字是关键——我们可否通过取一些特殊的点来使求解变得简单呢？当然是可以的，FFT通过取<strong>复数域上的单位根</strong>来加上运算，也就是说，我们取 $\omega_{n+1}^0\sim\omega_{n+1}^n$ </p><p>那么FFT如何利用这些点来将系数表示法转换为点表示法呢？先变形：<br>$$<br>\begin{align}<br>A(x)<br>&amp;=a_0+a_1x+a_2x^2+…+a_nx^n\\<br>\text{分奇数项和偶数项，令}A_1(x)<br>&amp;=a_0+a_2x+a_4x^2+a_6x^3+…\\<br>A_2(x)<br>&amp;=a_1+a_3x+a_5x^2+a_7x^3+…\\<br>\text{明显，}A_1,A_2&amp;\text{都是}\lfloor\frac{n}{2}\rfloor\text{次多项式}\\<br>\text{则}A(x)<br>&amp;=A_1(x^2)+xA_2(x^2)\\<br>\text{遍历}k\in[0,\frac{n-1}{2}]\text{有}A(\omega_{n+1}^k)<br>&amp;=A_1(\omega_{n+1}^{2k})+\omega_{n+1}^kA_2(\omega_{n+1}^{2k})\\<br>&amp;=A_1(\omega_\frac{n+1}{2}^k)+\omega_{n+1}^kA_2(\omega_\frac{n+1}{2}^k)\\<br>\text{同样，有}A(\omega_{n+1}^{k+\frac{n+1}{2}})<br>&amp;=A_1(\omega_{n+1}^{2k+n+1})+\omega_{n+1}^{k+\frac{n+1}{2}}A_2(\omega_{n+1}^{2k+n+1})\\<br>&amp;=A_1(\omega_{n+1}^{2k})-\omega_{n+1}^{k}A_2(\omega_{n+1}^{2k})\\<br>&amp;=A_1(\omega_\frac{n+1}{2}^k)-\omega_{n+1}^{k}A_2(\omega_\frac{n+1}{2}^k)\\<br>\text{我们发现只要我们求出}<br>&amp;k\in[0,\frac{n-1}{2}]\text{时的所有}A_1(\omega_\frac{n+1}{2}^k)\text{和}\omega_{n+1}^{k}A_2(\omega_\frac{n+1}{2}^k)\\<br>\text{就可以计算出}<br>&amp;k\in[0，n]\text{时的所有}A(\omega_{n+1}^k)<br>\end{align}<br>$$<br>由此，可以每次把区间分半，将系数多项式转换为点表示法，时间复杂度为 $O(n\log{n})$   </p><h2 id="快速傅里叶逆变换"><a href="#快速傅里叶逆变换" class="headerlink" title="快速傅里叶逆变换"></a>快速傅里叶逆变换</h2><p>现在已经解决了正变换，我们来看逆变换：<br>$$<br>\text{已知}A:{(\omega_{n+1}^k,A(\omega_{n+1}^k)),k\in[0,n]}\\<br>\text{设}A(x)=a_0+a_1x+a_2x^2+…+a_nx^n,y_k=A(\omega_{n+1}^k)\\<br>\text{则有}a_k(n+1)=\sum_{i=0}^{n}y_i(\omega_{n+1}^{-k})^i<br>$$<br>证明如下：</p><p>$$<br>\begin{align}<br>\sum_{i = 0} ^ {n} y_i (\omega_{n + 1} ^ {- k}) ^ i<br>&amp;=\sum_{i=0}^{n} A(\omega_{n+1}^i) (\omega_{n+1}^{-k}) ^ i\\<br>&amp;=\sum_{i=0}^{n} (\sum_{j=0}^{n} a_j (\omega_{n+1} ^ i ) ^ j ) (\omega_{n+1}^{-k}) ^ i\\<br>&amp;=\sum_{i=0}^{n}(\sum_{j=0}^{n} a_j (\omega_{n+1}^j) ^ i (\omega_{n+1}^{-k}) ^ i)\\<br>&amp;=\sum_{i=0}^{n}\sum_{j=0}^{n} a_j (\omega_{n+1}^{j-k}) ^ i\\<br>&amp;=\sum_{j=0}^{n}\sum_{i=0}^{n} a_j (\omega_{n+1}^{j-k}) ^ i\\<br>&amp;=\sum_{j=0}^{n}a_j (\sum_{i=0}^{n} (\omega_{n+1}^{j-k}) ^ i)\\<br>&amp;\text{令}S(x)=\sum_{j=0}^{n}x^i\\<br>&amp;\text{则} S(\omega_{n+1}^k)=\omega_{n+1}^0+\omega_{n+1}^k+\omega_{n+1}^{2k}+…+\omega_{n+1}^{nk}\\<br>&amp;\omega_{n+1}^k S(\omega_{n+1}^k) =\omega_{n+1}^k+\omega_{n+1}^{2k}+\omega_{n+1}^{3k}+…+\omega_{n+1}^{(n+1)k}\\<br>\text{又}<br>&amp;\because \omega_{n+1}^{(n+1)k}= \omega_{n+1}^0=1\\<br>&amp;\therefore S(\omega_{n+1}^k)=\omega_{n+1}^k S(\omega_{n+1}^k)\\<br>&amp;\therefore (1-\omega_{n+1}^k) S(\omega_{n+1}^k)=0\\<br>&amp;\text{若}k=0\text{，即}1- \omega_{n+1}^k=0\\<br>&amp;\text{则} S(\omega_{n+1}^k) = S(1) = n+1\\<br>&amp;\text{若}k\ne0\text{，即} 1-\omega_{n+1}^k\ne0\\<br>&amp;\text{则} S(\omega_{n+1}^k)=0\\<br>\text{总上所述} S(\omega_{n+1}^k)<br>&amp;=[k==0] (n+1)\\<br>\text{故}\sum_{i=0}^{n} y_i (\omega_{n+1}^{-k})^i<br>&amp;=\sum_{j=0}^{n} a_j S(\omega_{n+1}^{j-k})\\<br>&amp;=\sum_{j=0}^{n} a_j [j==k] (n+1)\\<br>&amp;=a_k(n+1)\\<br>\end{align}<br>$$</p><p>那么现在，有了 $a_k(n+1)=\sum_{i=0}^{n}y_i(\omega_{n+1}^{-k})^i$ ，不妨令 $A’(x)=\sum_{i=0}^{n}y_ix^i$ ，则 $a_k(n+1)=A’(\omega_{n+1}^{-k})$ </p><p>我们只需要快速求出 $A’(\omega_{n+1}^{0})\sim A’(\omega_{n+1}^{-n})$ ——这正好就是快速傅里叶正变换！</p><h2 id="递归化迭代"><a href="#递归化迭代" class="headerlink" title="递归化迭代"></a>递归化迭代</h2><p>由于用递归实现FFT常数过大，我们考虑用迭代的方式实现FFT（其实常数也挺大的），观察下面的图：</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/rc07p4no.png" alt="迭代"></p><p>计算每一个数时都要用到下方被横线连着的几个数，找找规律<del>找的到个鬼</del>，我们发现下面的每一项都是上面的数的二进制翻转，如 $1=(001)_2$ 对应最下方的 $4=(100)_2$ ，$6=(110)_2$ 对应最下方的 $3=(011)<em>2$ ，不妨设 $i$ 二进制翻转后为 $r_i$ ，则有：<br>$$<br>i = (r</em>{\frac{i}{2}} &gt;&gt; 1) {\Large|} (i &amp; 1) &lt;&lt; (bit - 1)<br>$$</p><p>为了好算，我们保证项数为 $2$ 的整次幂（不足就补）</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P3803">模板</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3000000</span>+<span class="number">5</span>; <span class="comment">//注意N要大于二倍n </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span>&#123;</span> <span class="comment">//定义复数 </span></span><br><span class="line"><span class="keyword">double</span> a,b;</span><br><span class="line"><span class="function">Complex <span class="title">make_C</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span> _a,<span class="keyword">const</span> <span class="keyword">double</span> _b)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line">Complex res;</span><br><span class="line">res.a=_a,res.b=_b;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>+(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a+<span class="keyword">_t</span>.a,b+<span class="keyword">_t</span>.b);</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>-(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a-<span class="keyword">_t</span>.a,b-<span class="keyword">_t</span>.b);</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>*(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a*<span class="keyword">_t</span>.a-b*<span class="keyword">_t</span>.b,a*<span class="keyword">_t</span>.b+b*<span class="keyword">_t</span>.a);</span><br><span class="line">&#125;</span><br><span class="line">&#125;a[N],b[N];</span><br><span class="line"><span class="keyword">int</span> r[N],bit,tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(Complex x[],<span class="keyword">int</span> inv)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i)</span><br><span class="line"><span class="keyword">if</span>(i&lt;r[i]) <span class="built_in">swap</span>(x[i],x[r[i]]);</span><br><span class="line">Complex w1,wk,a1,a2;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> mid=<span class="number">1</span>;mid&lt;tot;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">w1=w1.<span class="built_in">make_C</span>(<span class="built_in">cos</span>(PI/mid),inv*<span class="built_in">sin</span>(PI/mid)); ; <span class="comment">//由于cos正负相同,不必乘inv </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">wk=wk.<span class="built_in">make_C</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;mid;++j,wk=wk*w1)&#123;</span><br><span class="line">a1=x[i+j],a2=wk*x[i+j+mid];</span><br><span class="line">x[i+j]=a1+a2,x[i+j+mid]=a1-a2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m; <span class="comment">//建议将n,m定义为局部变量,防止与tot混淆 </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;a[i].a);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;b[i].a);</span><br><span class="line"><span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit)&lt;n+m+<span class="number">1</span>) ++bit;</span><br><span class="line">tot=<span class="number">1</span>&lt;&lt;bit;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i) r[i]=(r[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(bit<span class="number">-1</span>)); </span><br><span class="line"><span class="built_in">fft</span>(a,<span class="number">1</span>),<span class="built_in">fft</span>(b,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i) a[i]=a[i]*b[i];</span><br><span class="line"><span class="built_in">fft</span>(a,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n+m;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,(<span class="keyword">int</span>)(a[i].a/tot+<span class="number">0.5</span>)); <span class="comment">//加0.5来四舍五入 </span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>FFT的题一般都转化成两个多项式（函数）的乘积，是来看一道题：</p><p><a href="https://www.luogu.com.cn/problem/P1919">A*B</a></p><p>题目要求我们求一个高精乘高精，若直接求，显然 $O(n^2)$ ，考虑FFT优化：<br>$$<br>\begin{align}<br>A<br>&amp;={a_{n-1} a_{n-2} …a_0}\\<br>B<br>&amp;={b_{n-1} b_{n-2} …b_0}\\<br>\text{不妨设} f_A(x)<br>&amp;=a_{n-1} x^{n-1} + a_{n-2} x^{n-2} +…+ a_0x^0\\<br>f_B(x)<br>&amp;=b_{n-1} x^{n-1} + b_{n-2} x^{n-2} +…+ b_0x^0\\<br>\text{则} Ans<br>&amp;=A* B\\<br>\end{align}<br>$$<br>那么问题就转化为求函数 $f_C=f_A*f_B$ 答案就是 $f_C$ 的系数 </p><p>用FFT求 $f_C$ 时间复杂度 $O(n\log{n})$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3000000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span>&#123;</span></span><br><span class="line"><span class="keyword">double</span> a,b;</span><br><span class="line"><span class="function">Complex <span class="title">make_C</span><span class="params">(<span class="keyword">const</span> <span class="keyword">double</span> _a,<span class="keyword">const</span> <span class="keyword">double</span> _b)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line">Complex res;</span><br><span class="line">res.a=_a,res.b=_b;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>+(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a+<span class="keyword">_t</span>.a,b+<span class="keyword">_t</span>.b);</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>-(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a-<span class="keyword">_t</span>.a,b-<span class="keyword">_t</span>.b);</span><br><span class="line">&#125;</span><br><span class="line">Complex <span class="keyword">operator</span>*(<span class="keyword">const</span> Complex &amp;<span class="keyword">_t</span>)<span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">make_C</span>(a*<span class="keyword">_t</span>.a-b*<span class="keyword">_t</span>.b,a*<span class="keyword">_t</span>.b+b*<span class="keyword">_t</span>.a);</span><br><span class="line">&#125;</span><br><span class="line">&#125;a[N],b[N];</span><br><span class="line"><span class="keyword">char</span> s1[N],s2[N];</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="keyword">int</span> r[N],bit=<span class="number">0</span>,tot=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(Complex x[],<span class="keyword">int</span> inv)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i)</span><br><span class="line"><span class="keyword">if</span>(i&lt;r[i]) <span class="built_in">swap</span>(x[i],x[r[i]]);</span><br><span class="line">Complex w1,wk,a1,a2;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> mid=<span class="number">1</span>;mid&lt;tot;mid&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">w1=w1.<span class="built_in">make_C</span>(<span class="built_in">cos</span>(PI/mid),inv*<span class="built_in">sin</span>(PI/mid));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;i+=(mid&lt;&lt;<span class="number">1</span>))&#123;</span><br><span class="line">wk=wk.<span class="built_in">make_C</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;mid;++j,wk=wk*w1)&#123;</span><br><span class="line">a1=x[i+j],a2=wk*x[i+j+mid];</span><br><span class="line">x[i+j]=a1+a2,x[i+j+mid]=a1-a2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>,s1,s2);</span><br><span class="line">n=<span class="built_in">strlen</span>(s1)<span class="number">-1</span>,m=<span class="built_in">strlen</span>(s2)<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) a[i].a=s1[n-i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;++i) b[i].a=s2[m-i]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;bit)&lt;n+m+<span class="number">1</span>) ++bit;</span><br><span class="line">tot=<span class="number">1</span>&lt;&lt;bit;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i)</span><br><span class="line">r[i]=(r[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(bit<span class="number">-1</span>));</span><br><span class="line"><span class="built_in">fft</span>(a,<span class="number">1</span>),<span class="built_in">fft</span>(b,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tot;++i) a[i]=a[i]*b[i];</span><br><span class="line"><span class="built_in">fft</span>(a,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,<span class="keyword">_t</span>=<span class="number">0</span>;i&lt;tot||<span class="keyword">_t</span>;++i)&#123;</span><br><span class="line"><span class="keyword">_t</span>+=a[i].a/tot+<span class="number">0.5</span>;</span><br><span class="line">ans[k++]=<span class="keyword">_t</span>%<span class="number">10</span>;</span><br><span class="line"><span class="keyword">_t</span>/=<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(k&gt;<span class="number">1</span>&amp;&amp;ans[k<span class="number">-1</span>]==<span class="number">0</span>) --k;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=k<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 快速傅里叶变换,FFT </tag>
            
            <tag> 多项式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基环树DP</title>
      <link href="/2021/11/22/%E5%9F%BA%E7%8E%AF%E6%A0%91DP/"/>
      <url>/2021/11/22/%E5%9F%BA%E7%8E%AF%E6%A0%91DP/</url>
      
        <content type="html"><![CDATA[<p>仙人掌的特殊情况</p><span id="more"></span><h1 id="基环树DP"><a href="#基环树DP" class="headerlink" title="基环树DP"></a>基环树DP</h1><h2 id="前置知识：基环树"><a href="#前置知识：基环树" class="headerlink" title="前置知识：基环树"></a>前置知识：基环树</h2><p>包含 $n$ 个点 $n$​ 条边的联通图叫做<strong>基环树</strong>，可以看作一棵树上添加一条边（可重边和自环），这样会形成一个<strong>只有一个环</strong>的图，可以把环看成一个广义上的根节点，环上的每一个点为根都挂着一棵树（可以为空），所以叫做基环树，当然，很多棵基环树构成一个<strong>基环树森林</strong>，明显，基环树森林也是点数等于边数的</p><p>对于基环树，关键点是处理环</p><h2 id="例题一"><a href="#例题一" class="headerlink" title="例题一"></a>例题一</h2><p><a href="https://www.acwing.com/problem/content/360/">岛屿</a></p><p>本题大意是要求一个基环树森林中每个基环树的直径，这就是一个非常经典的基环树dp：</p><p>考虑某一棵基环树的直径（设为 $u$ 到 $v$ ），若直径不经过环，即 $u,v$ 属于同一棵树，树形dp即可求出直径；若直径经过环，即 $u,v$ 分属于两棵树，两棵树的根节点通过环联通，可以计算出 $u,v$ 各自到根的距离，再计算出环上两根的距离，求和即可</p><p>以上是我们知道直径的情况，但实际上，我们并不知道直径是哪两个点，所以必须两种情况都计算：先树形dp处理情况1，再枚举环上的点 $x,y$ （这两个节点必然是某棵树的根），计算情况2，总的时间复杂度 $O(n^2)$ ，必须考虑优化</p><p>我们发现树形dp是 $O(n)$ 的，时间主要耗费在情况2的枚举上了</p><p>不妨设 $d[x]$ 表示 $x$ 所在树上离 $x$ 最远的点到 $x$ 的距离， $d[y]$ 同理，设 $S(x,y)$ 表示环上从 $x$ 顺时针走到 $y$ 的距离（这样的好处是 $S(x,y)$ 是唯一确定的，并且这样也一定不会漏答案，因为 $x$ 逆时针走到 $y$ 的情况就是 $y$ 顺时针走到 $x$ ），那么对于每一个 $x$ ，我们要在环上找到一个 $y$  ， 使 $d[x] + d[y] + S(x, y)$ 最大</p><p>明显， $S(x,y)$ 可以转化为前缀和，则原式变为 $d[x] + d[y] + sum[x] - sum[y]$ ，对于确定的 $x$ ，只需要求一个 $d[y] - sum[y]$  的最大值，考虑经典的把环二倍成链的方法，破环成链，这就是一个典型的滑动窗口问题，单调队列解决，时间复杂度 $O(n)$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver, w;</span><br><span class="line">&#125; e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> fa[N], fw[N]; <span class="comment">//父节点和到父节点的距离</span></span><br><span class="line"><span class="keyword">int</span> q[N], l, r; <span class="comment">//单调队列</span></span><br><span class="line">LL s[N], d[N &lt;&lt; <span class="number">1</span>], sum[N &lt;&lt; <span class="number">1</span>]; <span class="comment">//s:环上前缀和,sum:成链二倍后的前缀和</span></span><br><span class="line">LL ans, as;</span><br><span class="line"><span class="keyword">bool</span> v[N], ins[N];</span><br><span class="line"><span class="keyword">int</span> cir[N], ed[N], cnt = <span class="number">0</span>; <span class="comment">//cir:所有的环成的链(未二倍),ed:每个环的终点</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx].ver = y, e[idx].w = z, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_c</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> in_e)</span> <span class="comment">//找环</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x] = ins[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i == (in_e ^ <span class="number">1</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">y = e[i].ver;</span><br><span class="line">fa[y] = x, fw[y] = e[i].w;</span><br><span class="line"><span class="keyword">if</span> (!v[y])</span><br><span class="line"><span class="built_in">dfs_c</span>(y, i);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ins[y])</span><br><span class="line">&#123;</span><br><span class="line">++cnt;</span><br><span class="line">ed[cnt] = ed[cnt - <span class="number">1</span>];</span><br><span class="line">LL _sum = e[i].w;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> z = x; z != y; z = fa[z])</span><br><span class="line">&#123;</span><br><span class="line">s[z] = _sum;</span><br><span class="line">cir[++ed[cnt]] = z;</span><br><span class="line">_sum += fw[z];</span><br><span class="line">&#125;</span><br><span class="line">s[y] = _sum;</span><br><span class="line">cir[++ed[cnt]] = y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ins[x] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//树形dp</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x] = <span class="literal">true</span>;</span><br><span class="line">LL d1 = <span class="number">0</span>, d2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (v[y])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">LL _d = <span class="built_in">dp</span>(y) + e[i].w;</span><br><span class="line"><span class="keyword">if</span> (_d &gt;= d1)</span><br><span class="line">d2 = d1, d1 = _d;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (_d &gt; d2)</span><br><span class="line">d2 = _d;</span><br><span class="line">&#125;</span><br><span class="line">as = <span class="built_in">max</span>(as, d1 + d2); <span class="comment">//统计不过环的情况</span></span><br><span class="line"><span class="keyword">return</span> d1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j, w; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;j, &amp;w);</span><br><span class="line"><span class="built_in">add</span>(i, j, w), <span class="built_in">add</span>(j, i, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (!v[i])</span><br><span class="line"><span class="built_in">dfs_c</span>(i, <span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">v[i] = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ed[cnt]; ++i)</span><br><span class="line">v[cir[i]] = <span class="literal">true</span>;</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, si; i &lt;= cnt; ++i)</span><br><span class="line">&#123;</span><br><span class="line">as = si = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = ed[i - <span class="number">1</span>] + <span class="number">1</span>; j &lt;= ed[i]; ++j)</span><br><span class="line">&#123;</span><br><span class="line">d[++si] = <span class="built_in">dp</span>(cir[j]);</span><br><span class="line">sum[si] = s[cir[j]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= si; ++j)</span><br><span class="line">d[si + j] = d[j], sum[si + j] = sum[j] + sum[si];</span><br><span class="line">l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= si * <span class="number">2</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r &amp;&amp; j - q[l] &gt;= si)</span><br><span class="line">++l;</span><br><span class="line"><span class="keyword">if</span> (l &lt;= r)</span><br><span class="line">as = <span class="built_in">max</span>(as, d[j] + sum[j] + d[q[l]] - sum[q[l]]);</span><br><span class="line"><span class="keyword">while</span> (l &lt;= r &amp;&amp; d[q[r]] - sum[q[r]] &lt;= d[j] - sum[j])</span><br><span class="line">--r;</span><br><span class="line">q[++r] = j;</span><br><span class="line">&#125;</span><br><span class="line">ans += as;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题二"><a href="#例题二" class="headerlink" title="例题二"></a>例题二</h2><p><a href="https://www.luogu.com.cn/problem/P2607">骑士</a></p><p>给定一个内向基环树森林，要求一个点集，在满足集合中任意两点没有公共边的前提下最大化点权和</p><p>这道题和树形dp中<a href="https://www.luogu.com.cn/problem/P1352">没有上司的舞会</a>非常像，区别是本题是基环树，而那道题是树，这样，就有一个明显的方法：删掉环上的一条边 $(x,y)$ ，就转化为没有上司的舞会，设 $f[i][0/1]$ 表示在以 $i$ 为根的子树中不选/选了 $i$ 的最大点权和，以 $x$ 为根做树形dp即可</p><p>思考该方法的正确性：若最终答案没有选 $x$ ，那么 $(x,y)$ 没有意义，删去也没有关系， $f[x][0]$ 就是答案；但如果最终答案选了 $x$ 就必然不能选 $y$ 可以再做第二次树形dp，这次强迫不选 $y$ ，答案就是 $f[x][1]$ ，总的时间复杂度为 $O(n)$</p><p>像本题这样<strong>删去一条环上的边后考虑删去造成的影响，通过强行限定一些条件多次dp求解</strong>也是解决基环树dp的常用方法</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line">LL f1[N][<span class="number">2</span>], f2[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> v[N], ins[N], rme[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx].ver = y, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> rmn, LL f[][<span class="number">2</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rme[i])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="built_in">dp</span>(y, rmn, f);</span><br><span class="line">f[x][<span class="number">0</span>] += <span class="built_in">max</span>(f[y][<span class="number">0</span>], f[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">f[x][<span class="number">1</span>] = -INF;</span><br><span class="line"><span class="keyword">if</span> (x != rmn)</span><br><span class="line">&#123;</span><br><span class="line">f[x][<span class="number">1</span>] = w[x];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rme[i])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">y = e[i].ver; </span><br><span class="line">f[x][<span class="number">1</span>] += f[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_c</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x] = ins[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (!v[y])</span><br><span class="line"><span class="built_in">dfs_c</span>(y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ins[y])</span><br><span class="line">&#123;</span><br><span class="line">rme[i] = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">dp</span>(y, <span class="number">-1</span>, f1);</span><br><span class="line"><span class="built_in">dp</span>(y, x, f2);</span><br><span class="line">ans += <span class="built_in">max</span>(f1[y][<span class="number">0</span>], f2[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ins[x] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j, _w; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;_w, &amp;j);</span><br><span class="line"><span class="built_in">add</span>(j, i);</span><br><span class="line">w[i] = _w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (!v[i])</span><br><span class="line"><span class="built_in">dfs_c</span>(i);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题三"><a href="#例题三" class="headerlink" title="例题三"></a>例题三</h2><p>在来看看最后一题</p><p><a href="https://www.acwing.com/problem/content/361/">创世纪</a></p><p>和上题类似，考虑断开一条环上的边 $(x,y)$ ，设 $f[i][0/1]$ 表示在以 $i$ 为根的子树中不选/选了 $i$ 最多能选多少个点，转移如下：<br>$$<br>f[i][0]=\sum_{j\in son(i)}\max(f[k][0],f[k][1])\<br>f[i][1]=\max_{j\in son(i)}(f[i][0]-\max(f[j][0],f[j][1])+f[j][0])+1<br>$$<br>同样的，做两遍dp，一遍强迫不选 $(x,y)$ ，不必做任何处理， $Ans=\max(f[x][0],f[x][1])$ ；另一遍必选 $(x,y)$ 则一定用 $x$ 去限制 $y$ ，则必不选 $x$ ，必选 $y$， $Ans=f[x][0]$ </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne, ver;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="keyword">int</span> h[N], idx = <span class="number">0</span>;</span><br><span class="line">LL f1[N][<span class="number">2</span>], f2[N][<span class="number">2</span>];</span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> v[N], ins[N], rme[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">e[idx].ver = y, e[idx].ne = h[x], h[x] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> must, LL f[][<span class="number">2</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rme[i])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="built_in">dp</span>(y, must, f);</span><br><span class="line">f[x][<span class="number">0</span>] += <span class="built_in">max</span>(f[y][<span class="number">0</span>], f[y][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (x == must)</span><br><span class="line">&#123;</span><br><span class="line">f[x][<span class="number">1</span>] = f[x][<span class="number">0</span>] + <span class="number">1</span>; <span class="comment">//若必选,则该点以被限制,其字节点可选可不选,加本身一个点</span></span><br><span class="line">f[x][<span class="number">0</span>] = -INF; <span class="comment">//必须就没有不选的情况</span></span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">f[x][<span class="number">1</span>] = -INF;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rme[i])</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">y = e[i].ver; </span><br><span class="line">f[x][<span class="number">1</span>] = <span class="built_in">max</span>(f[x][<span class="number">0</span>] - <span class="built_in">max</span>(f[y][<span class="number">1</span>], f[y][<span class="number">0</span>]) + f[y][<span class="number">0</span>] + <span class="number">1</span>, f[x][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs_c</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">v[x] = ins[x] = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = h[x], y; i != <span class="number">-1</span>; i = e[i].ne)</span><br><span class="line">&#123;</span><br><span class="line">y = e[i].ver;</span><br><span class="line"><span class="keyword">if</span> (!v[y])</span><br><span class="line"><span class="built_in">dfs_c</span>(y);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ins[y])</span><br><span class="line">&#123;</span><br><span class="line">rme[i] = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">dp</span>(y, <span class="number">-1</span>, f1);</span><br><span class="line"><span class="built_in">dp</span>(y, x, f2);</span><br><span class="line">ans += <span class="built_in">max</span>(<span class="built_in">max</span>(f1[y][<span class="number">0</span>], f1[y][<span class="number">1</span>]), f2[y][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">ins[x] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">h[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;j);</span><br><span class="line"><span class="built_in">add</span>(j, i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (!v[i])</span><br><span class="line"><span class="built_in">dfs_c</span>(i);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树 </tag>
            
            <tag> 图论 </tag>
            
            <tag> dp </tag>
            
            <tag> 基环树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>分块和块状链表</title>
      <link href="/2021/11/22/%E5%88%86%E5%9D%97%E5%92%8C%E5%9D%97%E7%8A%B6%E9%93%BE%E8%A1%A8/"/>
      <url>/2021/11/22/%E5%88%86%E5%9D%97%E5%92%8C%E5%9D%97%E7%8A%B6%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p>暴力真的出了奇迹</p><span id="more"></span><h2 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想"></a>基本思想</h2><p>对于一个长为 $n$ 的序列，把它分为 $\sqrt{n}$ 个“块”，“块”内的操作暴力求解，跨“块”的操作用“块”中的信息计算。 </p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>由于分块是一种思想，我们用一道例题具体分析。<br><a href="https://www.acwing.com/problem/content/244/">AcWing243一个简单的整数问题2</a><br>本题标程是线段树求解，用分块虽然效率不如，但思路和代码难度较之间单不少。</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ol><li><p>把序列分为 $\sqrt{n}$ 个“块” </p></li><li><p>对于操作一，区间 $[l,r]$ 被分为若干个完整“块”和至多两个不完整“块”，不妨在完整“块”上打一个懒标记，定义 $add$ 为“本‘块’中的所有数都要加上 $add$ ”，而不完整块暴力解决</p></li><li><p>对于操作二，区间 $[l,r]$ 被分为若干个完整“块”和至多两个不完整“块”，同上可定义 $sum$ 为“本‘块’中所有数的真实的，即算了 $add$ 的和”，而不完整块暴力解决</p></li></ol><p>总的来说，就是“整‘块’懒标记，‘块’内打暴力”。修改和查询的时间复杂度都为 $O(\sqrt{n})$ ，大于线段树的 $O(\log n)$ （当 $n=10^5$ 时， $\sqrt{n} \approx 317$ 而 $\log n \approx 17$ ），但分块的思路和代码难度都简单不少。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">350</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, len;</span><br><span class="line"><span class="keyword">int</span> w[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Block</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LL add, sum;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> add(i) b[i].add</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sum(i) b[i].sum</span></span><br><span class="line">&#125; b[M];</span><br><span class="line"><span class="comment">//判断x对应第几块</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x - <span class="number">1</span>) / len; <span class="comment">//减一可以保证第0块一定有len个</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> d)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get</span>(l) == <span class="built_in">get</span>(r))</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">            w[i] += d, <span class="built_in">sum</span>(<span class="built_in">get</span>(i)) += d;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">int</span> i = l, j = r;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">get</span>(i) == <span class="built_in">get</span>(l))</span><br><span class="line">            w[i] += d, <span class="built_in">sum</span>(<span class="built_in">get</span>(i)) += d, ++i;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">get</span>(j) == <span class="built_in">get</span>(r))</span><br><span class="line">            w[j] += d, <span class="built_in">sum</span>(<span class="built_in">get</span>(j)) += d, --j;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="built_in">get</span>(i); k &lt;= <span class="built_in">get</span>(j); ++k)</span><br><span class="line">            <span class="built_in">sum</span>(k) += len * d, <span class="built_in">add</span>(k) += d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">get</span>(l) == <span class="built_in">get</span>(r))</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</span><br><span class="line">            res += w[i] + <span class="built_in">add</span>(<span class="built_in">get</span>(i));</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">int</span> i = l, j = r;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">get</span>(i) == <span class="built_in">get</span>(l))</span><br><span class="line">            res += w[i] + <span class="built_in">add</span>(<span class="built_in">get</span>(i)), ++i;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">get</span>(j) == <span class="built_in">get</span>(r))</span><br><span class="line">            res += w[j] + <span class="built_in">add</span>(<span class="built_in">get</span>(j)), --j;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="built_in">get</span>(i); k &lt;= <span class="built_in">get</span>(j); ++k)</span><br><span class="line">            res += <span class="built_in">sum</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    len = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) </span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w[i]);</span><br><span class="line">        <span class="built_in">sum</span>(<span class="built_in">get</span>(i)) += w[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> op[<span class="number">2</span>];<span class="number">1.</span> </span><br><span class="line">    <span class="keyword">int</span> l, r, d;</span><br><span class="line">    <span class="keyword">while</span> (m--)</span><br><span class="line"> &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>, op, &amp;l, &amp;r);</span><br><span class="line">        <span class="keyword">if</span> (*op == <span class="string">&#x27;C&#x27;</span>) </span><br><span class="line">&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;d);</span><br><span class="line">            <span class="built_in">change</span>(l, r, d);</span><br><span class="line">        &#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">query</span>(l, r));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="块状链表"><a href="#块状链表" class="headerlink" title="块状链表"></a>块状链表</h2><p>我们已经用分块的思想实现了修改和查询操作，但是，如何实现插入、删除操作呢？<br>我们发现，对于一个序列，插入新数后，其分块方式就变了，必须更新每一块！每一块都要重新计算，太过麻烦，且时间复杂度过大。<br>为此，我们只好换一种分块方式——用链表的形式储存块，相邻两块之间用指针相连。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/euwvrafj.png" alt="块状链表"></p><h3 id="插入-删除"><a href="#插入-删除" class="headerlink" title="插入/删除"></a>插入/删除</h3><p>进行插入操作（如在块 $[l,r]$ 中插入一段 $[a,b]$ ）时，我们如下操作：</p><ol><li><p>把 $[l,r]$ 断开，并把断开后的两段用指针相连<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/zy0alq1a.png" alt="分段"></p></li><li><p>把 $[a,b]$ 构建成一个块状链表<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/eosmzh6y.png" alt="构造"></p></li><li><p>把断开的两段间的指针指向 $[a,b]$<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/fjs4u4cr.png" alt="插入"></p></li></ol><p>同理，删除操作：</p><ol><li><p>删除开头块中被区间覆盖的部分，具体方法为：把本块被覆盖前的点后移，覆盖掉需要被删除的点，并更新长度<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/cvevijkv.png" alt="删除前"></p></li><li><p>删除中间的完整块，具体方法为：调整两端指针，回收中间指针<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/qot7oa22.png" alt="删除中"></p></li><li><p>删除结尾块被覆盖的部分，具体方法为：把本块被覆盖的点后的点前移，覆盖掉需要被删除的点，并更新长度<img src="https://cdn.luogu.com.cn/upload/image_hosting/a7uqipax.png" alt="删除后"></p></li></ol><p>但是聪明的人已经发现了，这样做的一个问题——无法保证每个块的长度均匀，甚至会有块中只有1、2个数，这样会导致块非常多，严重影响我们的效率。</p><h3 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h3><p>为了解决那些长度很小的块，我们需要定期合并一些块。合并方法如下：</p><ol><li><p>遍历每个块</p></li><li><p>对于每个块，若下一个块可以合并在当前块中（即当前块的长度加下一个块的长度小于等于最大长度，即 $\sqrt{n}$ ），就进行合并。具体方法为： 将下一个块复制到当前块，删除下一个块。</p></li></ol><p>进行完如下操作后，剩下的块中任意相邻两块的长度和是一定大于 $\sqrt{n}$ 的，这样平均下来每一段的长度大于 $\frac{\sqrt{n}}{2}$ 总的段数小于 $2\sqrt{n}$ 。</p><h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P4008">P4008</a><br>代码：  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2000</span> + <span class="number">5</span>, M = <span class="number">2000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, x, y; <span class="comment">//n:操作个数,x、y:光标位置</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bolck</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> s[N + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> c;    <span class="comment">//字符个数</span></span><br><span class="line">    <span class="keyword">int</span> l, r; <span class="comment">//左右指针</span></span><br><span class="line">&#125; p[M];</span><br><span class="line"><span class="keyword">char</span> str[<span class="number">20000000</span> + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> q[M], tt; <span class="comment">//内存缓冲区</span></span><br><span class="line"><span class="comment">//光标移动到第k个字符后</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x = p[<span class="number">0</span>].r;</span><br><span class="line">    <span class="keyword">while</span> (k &gt; p[x].c)</span><br><span class="line">        k -= p[x].c, x = p[x].r;</span><br><span class="line">    y = k - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//将节点v插入到节点u右边</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p[v].r = p[u].r, p[p[u].r].l = v;</span><br><span class="line">    p[u].r = v, p[v].l = u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除节点u</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p[p[u].l].r = p[u].r;</span><br><span class="line">    p[p[u].r].l = p[u].l;</span><br><span class="line">    p[u].l = p[u].r = p[u].c = <span class="number">0</span>;</span><br><span class="line">    q[++tt] = u; <span class="comment">//回收节点u</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在光标后插入k个字符</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//若是在节点内插入,必须先将节点分裂成在节点末尾插入</span></span><br><span class="line">    <span class="keyword">if</span> (y &lt; p[x].c - <span class="number">1</span>)</span><br><span class="line">    &#123;                                        <span class="comment">//从光标处分裂</span></span><br><span class="line">        <span class="keyword">int</span> u = q[tt--];                     <span class="comment">//新建节点</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt; p[x].c; ++i) <span class="comment">//复制后段到新建节点</span></span><br><span class="line">            p[u].s[p[u].c++] = p[x].s[i];</span><br><span class="line">        p[x].c = y + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">add</span>(x, u);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cur = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q[tt--];            <span class="comment">//新建节点</span></span><br><span class="line">        <span class="keyword">while</span> (p[u].c &lt; N &amp;&amp; i &lt; k) <span class="comment">//在当前节点装满前一直装</span></span><br><span class="line">            p[u].s[p[u].c++] = str[i++];</span><br><span class="line">        <span class="built_in">add</span>(cur, u);</span><br><span class="line">        cur = u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除光标后的k个字符</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//若是在节点内删除,只需前后覆盖即可</span></span><br><span class="line">    <span class="keyword">if</span> (p[x].c - <span class="number">1</span> - y &gt;= k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = y + k + <span class="number">1</span>, j = y + <span class="number">1</span>; i &lt; p[x].c; ++i, ++j)</span><br><span class="line">            p[x].s[j] = p[x].s[i];</span><br><span class="line">        p[x].c -= k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//否则必须分类</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//除去前面节点内部的部分</span></span><br><span class="line">        k -= p[x].c - y - <span class="number">1</span>;</span><br><span class="line">        p[x].c = y + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//把中间整段删除</span></span><br><span class="line">        <span class="keyword">while</span> (p[x].r &amp;&amp; k &gt;= p[p[x].r].c)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u = p[x].r;</span><br><span class="line">            k -= p[u].c;</span><br><span class="line">            <span class="built_in">del</span>(u);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//删除后面节点内部的部分</span></span><br><span class="line">        <span class="keyword">int</span> u = p[x].r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = k; j &lt; p[u].c; ++i, ++j)</span><br><span class="line">            p[u].s[i] = p[u].s[j];</span><br><span class="line">        p[u].c -= k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出光标后的k个字符(类似删除)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x].c - <span class="number">1</span> - y &gt;= k)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = y + <span class="number">1</span>; i &lt; k; ++i, ++j)</span><br><span class="line">            <span class="built_in">putchar</span>(p[x].s[j]);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        k -= p[x].c - y - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt; p[x].c; ++i)</span><br><span class="line">            <span class="built_in">putchar</span>(p[x].s[i]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> cur = x;</span><br><span class="line">        <span class="keyword">while</span> (p[cur].r &amp;&amp; k &gt;= p[p[cur].r].c)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u = p[cur].r;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; p[u].c; ++i)</span><br><span class="line">                <span class="built_in">putchar</span>(p[u].s[i]);</span><br><span class="line">            k -= p[u].c;</span><br><span class="line">            cur = u;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> u = p[cur].r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i)</span><br><span class="line">            <span class="built_in">putchar</span>(p[u].s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//光标前移</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">front</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!y)</span><br><span class="line">    &#123;</span><br><span class="line">        x = p[x].l;</span><br><span class="line">        y = p[x].c - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        y--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//光标后移</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y &lt; p[x].c - <span class="number">1</span>)</span><br><span class="line">        y++;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        x = p[x].r;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//将相邻节点合并</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = p[<span class="number">0</span>].r; i; i = p[i].r)</span><br><span class="line">        <span class="keyword">while</span> (p[i].r &amp;&amp; p[i].c + p[p[i].r].c &lt; N)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> r = p[i].r;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = p[i].c, k = <span class="number">0</span>; k &lt; p[r].c; ++j, ++k)</span><br><span class="line">                p[i].s[j] = p[r].s[k];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (x == r)</span><br><span class="line">                x = i, y += p[i].c; <span class="comment">//更新光标位置</span></span><br><span class="line"></span><br><span class="line">            p[i].c += p[r].c;</span><br><span class="line">            <span class="built_in">del</span>(r);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; M; ++i)</span><br><span class="line">        q[++tt] = i;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">char</span> op[<span class="number">10</span>];</span><br><span class="line">    <span class="comment">//插入哨兵,把光标移动到开头</span></span><br><span class="line">    str[<span class="number">0</span>] = <span class="string">&#x27;&gt;&#x27;</span>;</span><br><span class="line">    <span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">move</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(op, <span class="string">&quot;Move&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="built_in">move</span>(a + <span class="number">1</span>); <span class="comment">//因为有一个哨兵</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(op, <span class="string">&quot;Insert&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>, k = a;</span><br><span class="line">            <span class="keyword">while</span> (a)</span><br><span class="line">            &#123;</span><br><span class="line">                str[i] = <span class="built_in">getchar</span>();</span><br><span class="line">                <span class="keyword">if</span> (str[i] &gt;= <span class="number">32</span> &amp;&amp; str[i] &lt;= <span class="number">126</span>)</span><br><span class="line">                    i++, a--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">insert</span>(k);</span><br><span class="line">            <span class="built_in">merge</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(op, <span class="string">&quot;Delete&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="built_in">remove</span>(a);</span><br><span class="line">            <span class="built_in">merge</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(op, <span class="string">&quot;Get&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">            <span class="built_in">get</span>(a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(op, <span class="string">&quot;Prev&quot;</span>))</span><br><span class="line">            <span class="built_in">front</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">after</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 暴力 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>笛卡尔树</title>
      <link href="/2021/11/22/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/"/>
      <url>/2021/11/22/%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>老缝合怪了</p><span id="more"></span><h1 id="笛卡尔树"><a href="#笛卡尔树" class="headerlink" title="笛卡尔树"></a>笛卡尔树</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>笛卡尔树是一种二叉树， 每个节点有一个键值二元组 $(k,w)$ ，其中 $k$ 满足二叉搜索树的性质，而 $w$ 满足堆的性质，<del>我知道你和我一样没看懂所以</del>，看图：</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/r2jzrc9y.png" alt="笛卡尔树"></p><p>上图是一棵笛卡尔树， $k$ 是下标， $w$ 是权值，则图中的树既满足二叉搜索树的性质（ $r$ 左子树的节点下标小于 $r$ ，右子树的节点下标大于 $r$ ），也满足一个小根堆（父节点的权值小于子节点）</p><p>当然上图是一种特殊的（也是常用的）笛卡尔树，它的键值 $k$ 恰好是数组下标，这使得它有一个性质：一棵子树内的下标是连续的一个区间（这样才能满足二叉搜索树的性质）</p><h2 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h2><p>构建一棵笛卡尔树无非就两种思路：</p><h3 id="一、保证堆性质的情况下构造二叉搜索树"><a href="#一、保证堆性质的情况下构造二叉搜索树" class="headerlink" title="一、保证堆性质的情况下构造二叉搜索树"></a>一、保证堆性质的情况下构造二叉搜索树</h3><p>其实<strong>基本不会这么写</strong>……只是提一提</p><p>以小根堆为例，每次找到最小值（记其位置为 $pos$ ）作为当前子树的根，再递归处理左子树 $[l,pos-1]$ ，右子树 $[pos+1,r]$ ，找最小值可以ST表优化，时间复杂度 $O(n\log n)$ <del>显然不能接受</del></p><h3 id="二、保证二叉搜索树性质的情况下构造堆"><a href="#二、保证二叉搜索树性质的情况下构造堆" class="headerlink" title="二、保证二叉搜索树性质的情况下构造堆"></a>二、保证二叉搜索树性质的情况下构造堆</h3><p>这才是正道</p><p>考虑将元素按照键值 $k$ 排序（如果 $k$ 是下标显然不用排序了），然后一个一个插入到当前的笛卡尔树中，则每次我们插入当前节点时，一定是插入到当前树的最右端（一直向右子树走直到无法再走），这样才满足二叉搜索树的性质（我们称根节点到最右端的节点构成的链为<strong>右链</strong>）</p><p>但我们又必须满足堆性质，所以我们执行如下操作：<strong>从下往上</strong>比较比较右链结点（设为 $x$ ）与当前新插入结点（设为 $u$ ）的权值，若找到节点 $x$ 满足 $x_w&lt;u_w$ ，就把 $u$ 接到 $x$ 的<strong>右儿子</strong>上（这样满足了堆性质），然后把原来 $x$ 的右子树变成 $u$ 的<strong>左子树</strong>（这样满足了二叉搜索树性质），具体如图：</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/d3lplvvp.png" alt="构建笛卡尔树"></p><p>这样，我们发现我们维护的其实是当前树的右链（图中红色部分），可以用一个单调栈维护，每个节点显然最多进出栈一次，时间复杂度为 $O(n)$ </p><p>代码如下：</p><p><a href="https://www.luogu.com.cn/record/62335984">建树</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CartesianTree</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> dat, lc, rc;</span><br><span class="line">&#125; tr[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"><span class="keyword">int</span> stk[N], top = <span class="number">0</span>; <span class="comment">//数组太大,开在函数里会爆栈</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">tr[i].dat = a[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, k; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">k = top;</span><br><span class="line"><span class="comment">//找到最下面的一个比当前小的,满足小根堆</span></span><br><span class="line"><span class="keyword">while</span> (k &gt; <span class="number">0</span> &amp;&amp; tr[stk[k]].dat &gt; tr[i].dat)</span><br><span class="line">--k;</span><br><span class="line"><span class="keyword">if</span> (k)</span><br><span class="line">tr[stk[k]].rc = i;</span><br><span class="line"><span class="keyword">if</span> (k &lt; top)</span><br><span class="line">tr[i].lc = stk[k + <span class="number">1</span>];</span><br><span class="line">top = k;</span><br><span class="line">stk[++top] = i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// freopen(&quot;t.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class="line"><span class="comment">// freopen(&quot;t.out&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line"><span class="built_in">build</span>();</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">ans ^= (<span class="keyword">long</span> <span class="keyword">long</span>)i * (tr[i].lc + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, ans);</span><br><span class="line">ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">ans ^= (<span class="keyword">long</span> <span class="keyword">long</span>)i * (tr[i].rc + <span class="number">1</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有些时候我们甚至不必建出树，直接用单调栈即可</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> 笛卡尔树 </tag>
            
            <tag> 堆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>乘法逆元</title>
      <link href="/2021/11/22/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"/>
      <url>/2021/11/22/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/</url>
      
        <content type="html"><![CDATA[<p>其实比较简单</p><span id="more"></span><h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p>在数论中，若 $ab \equiv 1\pmod p$ ，我们就称 $a,b$　在模 $p$ 意义下互为乘法逆元，记为 $a=inv(b) \pmod p $ 或 $a=b^{-1} \pmod p$ 。</p><h1 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h1><p>逆元有什么用？我们常常遇到一些题目要求结果对一个大质数 $p$ 取模，这是因为答案很大，出题人为了不麻烦大家写高精，就采取这样的方法。加减法和乘法对取模运算都是封闭的，所以你可以处处取模来避免溢出。如：  </p><ul><li>加法：<br>$12%10=2$<br>$3%10=3$<br>$(12+3) % 10=(2+3)%10=5$</li><li>乘法：<br>$12%10=2$<br>$3%10=3$<br>$(12 \times 3) %10=(2 \times 3) %10=6$</li></ul><p>但遇到除法时，就麻烦了： </p><ul><li>除法：<br> $12%10=2$<br> $3%10=3$<br> $(12/3) %10=4 \ne(2/3)%10$ </li></ul><p>那咋办？逆元啊！看看定义式： $a=inv(b)=b^{-1} \pmod p$ ，这里明白的告诉你了： $a$ 就是模 $p$ 意义下的 $\frac{1}{b}$ 啊！故除法可以这样计算：</p><ul><li>除法：<br> $12%10=2$<br> $3%10=3$<br> $(12/3) %10=(12 \times \frac{1}{3}) %10=(2 \times inv(3))%10=4$ </li></ul><p>妙啊，dalao们的智慧真是无穷的！</p><h1 id="计算逆元"><a href="#计算逆元" class="headerlink" title="计算逆元"></a>计算逆元</h1><h2 id="拓展欧几里得"><a href="#拓展欧几里得" class="headerlink" title="拓展欧几里得"></a>拓展欧几里得</h2><p>这种方法在<a href="https://dydbenren.blog.luogu.org/ta-zhan-ou-ji-li-dei">拓展欧几里得</a>已经介绍了，那道“同余方程”其实就是在求逆元。实际上，这就是最常用的求逆元的方法。代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">exgcd</span><span class="params">(LL a,LL b,LL&amp; x,LL&amp; y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!b)&#123;</span><br><span class="line">x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line">LL d=<span class="built_in">exgcd</span>(b,a%b,y,x); </span><br><span class="line">y-=a/b*x;</span><br><span class="line"><span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a,LL p)</span></span>&#123; <span class="comment">//求a在模p下的逆元 </span></span><br><span class="line">LL x,y;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">exgcd</span>(a,p,x,y)==<span class="number">1</span>?(x%p+p)%p:<span class="number">-1</span>;<span class="comment">//-1表示无解 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h2><p>若 $p$ 为质数 ，则有 $a^p \equiv a \pmod p$ </p><p>证明：<br>费马小定理是<a href="https://dydbenren.blog.luogu.org/ou-la-ding-li">欧拉定理</a>的特殊情况，<br>欧拉定理 $a^{\varphi(n)} \equiv 1 \pmod n$ ，其中 $gcd(a,n)=1$ ，$\varphi(n)$ 为<a href="https://dydbenren.blog.luogu.org/ou-la-han-shuo">欧拉函数</a></p><ul><li>当 $gcd(a,p)=1$ 时，由欧拉定理 $a^{p-1} \equiv 1 \pmod p$ 两边同时乘 $a$ 得 $a^p \equiv a \pmod p$ </li><li>当 $gcd(a,p)\ne 1$ 时， $a$ 只能是 $p$ 的倍数，定理显然成立</li></ul><p>证毕</p><p>那么由逆元的定义推导：<br>$a\times inv(a)\equiv 1 \equiv a^{p-1} \pmod p$ ，这里 $gcd(a,p)=1$<br>于是有 $inv(a) = a^{p-2} \pmod p$<br>So，只要求下快速幂即可，注意这个方法<strong>只对 $p$ 是质数的情形有效</strong>，代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL a,LL n,LL p)</span></span>&#123;</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&amp;<span class="number">1</span>) ans=ans%p*a%p;</span><br><span class="line">        a=a%p*a%p;</span><br><span class="line">        n&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a,LL p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">qpow</span>(a,p<span class="number">-2</span>,p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="线性递推"><a href="#线性递推" class="headerlink" title="线性递推"></a>线性递推</h2><p>以上两种方法都是常用的求逆元方法，但是，洛谷<a href="https://www.luogu.com.cn/problem/P3811">P3811</a>的毒瘤模板题，必须要用特殊的方法</p><p>因为这道题要求一系列的乘法逆元，而且数据范围有点大，常规方法是行不通的。这里介绍逆元的线性递推求法（<strong>需保证 $p$ 是质数</strong>）。</p><p>设 $p=aq+r$ ，且 $q=\left \lfloor \frac{p}{a} \right \rfloor$ ， $r= p \bmod a$<br>在模 $p$ 意义下，有 $(aq+r) \equiv 0 \pmod p$<br>移项得 $aq=-r\pmod p$<br>把 $q$ 换成逆元 $a=-r \times inv(q) \pmod p$<br>再两边变逆元 $inv(a)=-inv(r) \times q\pmod p$<br>即 $inv(a)= -\left \lfloor \frac{p}{a} \right \rfloor \times inv(p \bmod a) \pmod p$</p><p>我们可以用记忆化搜索的方法，减少多次查询的时间复杂度（空间换时间）。（递推亦可，其实就这题而言递推更好）</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3000000</span>+<span class="number">5</span>;</span><br><span class="line">LL inv[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">LL n,p;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;p);</span><br><span class="line">inv[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">inv[i]=p-(p/i)*inv[p%i]%p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,inv[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="阶乘逆元法"><a href="#阶乘逆元法" class="headerlink" title="阶乘逆元法"></a>阶乘逆元法</h2><p>再补充一张用阶乘求逆元的方法，<strong>只适用于模数为质数的情况</strong></p><p>设 $f(i)=inv(i!),g(i)=i!$<br>则有： $f(i-1)=f(i) \times i$<br>证明： $f(i-1)= \frac{1}{(i-1)!}=\frac{1}{i!} \times i=f(i) \times i$ </p><p>若我们要求 $[1,n]$ 中所有数的的逆元，可以先求 $[1,n]$ 每个数的阶乘的，再用费马小定理求得 $f(n)$ ，之后地推出 $f(1\sim n)$ 但是这还不是我们要的答案啊</p><p>dalao又说： $inv(i)=inv(i!) \times (i-1)!$<br>证明思路同上</p><p>So， $inv(i)=f(i) \times (i-1)!$</p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 逆元 </tag>
            
            <tag> 费马小定理 </tag>
            
            <tag> 拓展欧几里得 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>背包问题</title>
      <link href="/2021/11/22/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"/>
      <url>/2021/11/22/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>只写了一点点</p><span id="more"></span><h1 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h1><h2 id="01背包"><a href="#01背包" class="headerlink" title="01背包"></a>01背包</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xcf</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">ans=-INF;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=m;j&gt;=v[i];--j)</span><br><span class="line">  f[j]=<span class="built_in">max</span>(f[j-v[i]]+w[i],f[j]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">ans=<span class="built_in">max</span>(ans,f[i]);</span><br></pre></td></tr></table></figure><h2 id="完全背包"><a href="#完全背包" class="headerlink" title="完全背包"></a>完全背包</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xcf</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">ans=-INF;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=v[i];j&lt;=m;++j)</span><br><span class="line">  f[j]=<span class="built_in">max</span>(f[j-v[i]]+w[i],f[j]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">ans=<span class="built_in">max</span>(ans,f[i]);</span><br></pre></td></tr></table></figure><h2 id="多重背包"><a href="#多重背包" class="headerlink" title="多重背包"></a>多重背包</h2><p>用二进制优化转换为01背包</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(Node x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(x.p&gt;=p)&#123;</span><br><span class="line">        b[++o].c=x.c*p;</span><br><span class="line">        b[o].t=x.t*p;</span><br><span class="line">        b[o].p=<span class="number">1</span>;</span><br><span class="line">        x.p-=p;</span><br><span class="line">        p&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x.p)&#123;</span><br><span class="line">        b[++o].c=x.c*x.p;</span><br><span class="line">        b[o].t=x.t*x.p;</span><br><span class="line">        b[o].p=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="新知"><a href="#新知" class="headerlink" title="新知"></a>新知</h1><h2 id="单调队列优化的多重背包"><a href="#单调队列优化的多重背包" class="headerlink" title="单调队列优化的多重背包"></a>单调队列优化的多重背包</h2><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>我们考虑多重背包的转移方程（二维），思考，能否像完全背包一样，让 $f[i][j]=max(f[i-1][j],f[i][j-v]+w)$ ，以此来优化呢？<br>观察：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/cn26sm1f.png" alt="对比"><br>我们会发现和完全背包相同的是，红色方框内的两个表达式一一对应，相差一个 $w$ ，但是， $f[i][j-v]$ ，有一项没有对应上。<br>这是为何呢？原因很简单，完全背包 $f[i][j]$ 在不考虑越界的情况下有无穷多种转移情况，在去掉最前端的 $f[i-1][j]$ 后还有无穷多种，恰好可以与 $f[i][j-v]$ 的无穷多种情况一一对应。<br>但是，变成多重背包后， $f[i][j]$ 只有 $s$ 种，即有限种转移情况，在去掉最前端的 $f[i-1][j]$ 后只有 $s-1$ 种，与 $f[i][j-v]$ 的 $s$ 种一一对应后，还剩一个。<br>但就是这多余的一个，导致我们无法用 $f[i][j]=max(f[i-1][j],f[i][j-v]+w)$ 来转移，因为多余的一个情况无法预料。</p><p>但这仍可以给我们一些启示：<br>在数轴上标出 $x=j+kv,k \in \mathbb{Z}$ ，即， $x \equiv j \pmod v$ 。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/ghxq7ly8.png" alt="滑动"><br>$j$ 是由它前面 $s$ 个点的最大值<br>转移过来的，即蓝色窗口中标出的点的最大值，而 $j-v$ 也是由其前方 $s$ 个点的最大值转移而来，也就是说，窗口大小不变，窗口在数轴上滑动。<br>需要注意的是，数轴是无限的，但数组的转移是有边界的，所以我们可以把数轴上无意义的点设为负无穷（当然具体视情况而定） ，这样防止越界。<br>在解决了以上问题后，我们就只需要找出一种快速求滑动窗口最值的方法即可，而以前学过的单调队列可以在线性的时间内维护该问题。</p><p>具体来说，我们把“倒序循环 $j$ ”，改为对每个余数 $u \in [0,v_i-1]$ 倒序循环 $p=\left \lfloor (m-u)/v_i \right \rfloor \sim 0$ ，对应的状态就是 $j=u+p * v_i$ ，由于只能选 $c_i$ 个，故状态转移方程为：<br> $$f[u+p * v_i]=\max_{p-c_i \le k \le p-1} (f[u+k * v_i]+(p-k) * w_i)$$<br>我们发现，把 $i,u$ 看做定值，当内层变量 $p$ 减少 $1$ 时，决策 $k$ 的取值范围 $[p-c_i,p-1]$ 均单调减小，所以我们可以维护一个决策点 $k$ 单调递减，数值 $f[u+k * v_i]-k * w_i$ 递减的队列。</p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><a href="https://www.acwing.com/problem/content/6/">多重背包问题</a></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> f[N],v[N],w[N],c[N],q[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> u,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> f[u+k*v[i]]-k*w[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xcf</span>,<span class="keyword">sizeof</span> f);</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;v[i],&amp;w[i],&amp;c[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> u=<span class="number">0</span>;u&lt;v[i];++u)&#123; <span class="comment">//u:余数 </span></span><br><span class="line"><span class="keyword">int</span> hh=<span class="number">1</span>,tt=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> maxp=(m-u)/v[i];</span><br><span class="line"><span class="comment">//将初始的候选集合插入队列 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k=maxp<span class="number">-1</span>;k&gt;=<span class="built_in">max</span>(maxp-c[i],<span class="number">0</span>);--k)&#123; </span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt&amp;&amp;<span class="built_in">calc</span>(i,u,q[tt])&lt;=<span class="built_in">calc</span>(i,u,k)) --tt;</span><br><span class="line">q[++tt]=k; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//dp </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> p=maxp;p&gt;=<span class="number">0</span>;p--)&#123; <span class="comment">//循环状态 </span></span><br><span class="line"><span class="comment">//排除过时决策</span></span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt&amp;&amp;q[hh]&gt;p<span class="number">-1</span>) ++hh;</span><br><span class="line"><span class="comment">//取队头转移</span></span><br><span class="line"><span class="keyword">if</span>(hh&lt;=tt) </span><br><span class="line">f[u+p*v[i]]=<span class="built_in">max</span>(f[u+p*v[i]],<span class="built_in">calc</span>(i,u,q[hh])+p*w[i]);</span><br><span class="line"><span class="comment">//新决策入队,同时维护单调</span></span><br><span class="line"><span class="keyword">if</span>(p-c[i]<span class="number">-1</span>&gt;=<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">while</span>(hh&lt;=tt&amp;&amp;<span class="built_in">calc</span>(i,u,q[tt])&lt;=<span class="built_in">calc</span>(i,u,p-c[i]<span class="number">-1</span>)) --tt;</span><br><span class="line">q[++tt]=p-c[i]<span class="number">-1</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) ans=<span class="built_in">max</span>(ans,f[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> 背包 </tag>
            
            <tag> 优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tarjan缩点</title>
      <link href="/2021/11/22/Tarjan%E7%BC%A9%E7%82%B9/"/>
      <url>/2021/11/22/Tarjan%E7%BC%A9%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>辣个男银太讨厌了！</p><span id="more"></span><h1 id="Tarjan缩点"><a href="#Tarjan缩点" class="headerlink" title="Tarjan缩点"></a>Tarjan缩点</h1><h2 id="割点与桥"><a href="#割点与桥" class="headerlink" title="割点与桥"></a>割点与桥</h2><p>给定无向连通图 $G=(V,E)$ ：<br>若对于 $x \in V$ ，从图中删去节点 $x$ 及其所以连边后， $G$ 分裂成两个及以上不连通的子图，则称 $x$ 为 $G$ 的<strong>割点</strong>；<br>若对与 $e \in E$ ，从图中删去 $e$ 后， $G$ 分裂为两个（也只可能分裂成两个）不连通的子图，则称 $e$ 为 $G$ 的<strong>割边</strong>或<strong>桥</strong>。</p><p>由Robert Tarjan的名字命名的Tarjan算法可以在线性时间内求无向图的割点与桥，进一步可以求出双连通分量。</p><h2 id="时间戳与追溯值"><a href="#时间戳与追溯值" class="headerlink" title="时间戳与追溯值"></a>时间戳与追溯值</h2><p>“时间戳”的概念比较简单，就是在dfs搜索时按搜索顺序对每个节点编号，一般记作 $dfn[x]$<br>在dfs遍历时，经过的边被定义为“搜索树”中的边，如图，红色为“搜索树”中的边，点中的数字为时间戳：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/vpegwalx.png" alt="搜索树"><br>Tarjan算法又引入了一个”追溯值”，记作 $low[x]$ 。定义 $low[x]=\min (dfn[y])$ ，其中 $y$ 为满足下列两个条件之一的节点:  </p><ol><li><p> $y$ 在 $x$ 的子树中（包括 $x$ 本身）</p></li><li><p> $y$ 通过1条不在搜索树上的边，能够到达 $x$ 的子树（包括 $x$ 本身）</p></li></ol><p>可以感性地将追溯值理解为从点 $x$ 出发，不走先前走过的点，可以到达的时间戳最小的点的时间戳<br>下图用绿色数字标出了每个点的追溯值：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/kwfnwe8y.png" alt="追溯值"><br>根据定义，可以这样计算计算 $low[x]$ ：</p><ul><li><p>令 $low[x]=dfn[x]$ （因为 $x$ 的时间戳一定是它所在子树中最小的）</p></li><li><p>枚举每条边 $(x,y)$ ：</p></li></ul><ol><li><p>若搜索树上 $x$ 是 $y$ 的父亲， 递归计算 $y$  ，然后令 $low[x]=\min (low[x],low[y])$ </p></li><li><p>若 $(x,y)$ 不在搜索树上，令 $low[x]=\min (low[x],dfn[y])$</p></li></ol><h2 id="桥（割边）的判断"><a href="#桥（割边）的判断" class="headerlink" title="桥（割边）的判断"></a>桥（割边）的判断</h2><p>无向边 $(x,y)$ 是桥，当且仅当 $(x,y)$ 在搜索树上（设 $x$ 为父节点），且满足 $dfn[x]&lt;low[y]$  </p><p>正确性显然：若 $dfn[x]&lt;low[y]$ ，说明从 $y$ 出发，不走 $(x,y)$ ，不管如何走都无法到达比 $x$ 更早遍历的点，所以只要删除 $(x,y)$ ， $y$ 及其子树就与比 $x$ 早遍历的点分隔开了，故 $(x,y)$ 为割边，反之则不是。<br>下图中桥用虚线标出：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/02xalq39.png" alt="桥"><br>不难发现：桥一定是搜索树中的边，且一个简单环中的边一定不是桥。</p><p>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne,ver;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N],idx=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N],num=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> bridge[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    e[idx].ver=y,e[idx].ne=h[x],h[x]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> in_e)</span></span>&#123;</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x],y;i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">        y=e[i].ver;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y])&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y,i);</span><br><span class="line">            low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line">            <span class="keyword">if</span>(low[y]&gt;dfn[x]) bridge[i]=bridge[i^<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i!=(in_e^<span class="number">1</span>)) low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) h[i]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v;i&lt;=m;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v);</span><br><span class="line">        <span class="built_in">add</span>(u,v);</span><br><span class="line">        <span class="built_in">add</span>(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;idx;i+=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span>(bridge[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,e[i^<span class="number">1</span>].ver,e[i].ver);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="割点的判断"><a href="#割点的判断" class="headerlink" title="割点的判断"></a>割点的判断</h2><p>若 $x$ 不是搜索树的根，则 $x$ 是割点当且仅当存在 $x$ 的一个子节点 $y$ 满足 $dfn[x] \le low[y]$ ，特别的，当 $x$ 为搜索树的根时，需要有至少两个子节点 $y_1,y_2$ 满足条件<br>证明方法同上，下图用蓝色标出了两个割点，它们的时间戳分别是1和6：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/ej6on0sx.png" alt="割点"><br>值得注意的是，在判断割点时，由于是小于等于号，所以不必像桥一样考虑重边和父节点，但要比桥多判一个自环。</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne,ver;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N],idx=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N],num=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> cut[N];</span><br><span class="line"><span class="keyword">int</span> root;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    e[idx].ver=y,e[idx].ne=h[x],h[x]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    <span class="keyword">int</span> f=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x],y;i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">        y=e[i].ver;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y])&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line">            <span class="keyword">if</span>(low[y]&gt;=dfn[x])&#123;</span><br><span class="line">            ++f;</span><br><span class="line">            <span class="keyword">if</span>(x!=root||f&gt;<span class="number">1</span>) cut[x]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) h[i]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v;i&lt;=m;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v);</span><br><span class="line">        <span class="keyword">if</span>(u==v) <span class="keyword">continue</span>; <span class="comment">//判自环 </span></span><br><span class="line">        <span class="built_in">add</span>(u,v);</span><br><span class="line">        <span class="built_in">add</span>(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) root=i,<span class="built_in">tarjan</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">if</span>(cut[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="无向图的双连通分量"><a href="#无向图的双连通分量" class="headerlink" title="无向图的双连通分量"></a>无向图的双连通分量</h2><p>若无向图 $G$ 不存在割点，即其中任意两点间都有至少两条简单路径满足两条路径上的点集的并中只存在起点和终点，则称 $G$ 为“点双连通图”。</p><p>类似的，若无向图 $G$ 不存在桥，即其中任意两点间都有至少两条简单路径满足两条路径上的边集的并为空集，则称 $G$ 为“边双连通图”。</p><p>如图，图一是“点双连通图”而不是“边双连通图”，图二相反：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/47zj9nti.png" alt="范例"><br>无向图的“极大”点双连通子图称为“点双连通分量”，记作“v-DCC”；无向图的“极大”边双连通子图称为“边双连通分量”，记作“e-DCC”<br>在以上定义中，一个双连通子图 $G$ 定义为“极大”是指不存在一个双连通子图 ${G}’$ 使得 $G$ 是它的子图</p><h2 id="边双连通分量"><a href="#边双连通分量" class="headerlink" title="边双连通分量"></a>边双连通分量</h2><p>e-DCC比较好求，只需删除所有桥，无向图就会分裂成若干e-DCC<br>代码（加到求桥的代码中）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">int</span> c[N],dcc;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">c[x]=dcc;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=h[x],y;i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">y=e[i].ver;</span><br><span class="line"><span class="keyword">if</span>(c[y]||bridge[i]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">......</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="keyword">if</span>(!c[i])&#123;</span><br><span class="line">    ++dcc;</span><br><span class="line">    <span class="built_in">dfs</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the num of e-DCC is %d\n&quot;</span>,dcc);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d blongs to e-DCC %d\n&quot;</span>,i,c[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>e-DCC的缩点就是把每个e-DCC看作一个新的点，用桥将新的点连起来，构成一棵树（或森林），在上面代码中再加入这段代码，可以实现e-DCC缩点：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne,ver;</span><br><span class="line">&#125;ec[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> hc[N&lt;&lt;<span class="number">1</span>],idc=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_c</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ec[idc].ver=y,ec[idc].ne=hc[x],hc[x]=idc++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">......</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) hc[i]=<span class="number">-1</span>;</span><br><span class="line">......</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,x,y;i&lt;idx;i+=<span class="number">2</span>)&#123;</span><br><span class="line">x=e[i].ver,y=e[i^<span class="number">1</span>].ver;</span><br><span class="line"><span class="keyword">if</span>(c[x]==c[y]) <span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">add_c</span>(c[x],c[y]);</span><br><span class="line"><span class="built_in">add_c</span>(c[y],c[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;缩点后的森林，点数：%d，边数（可能有重边）：%d\n&quot;</span>,dcc,(idc+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;idc;i+=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,ec[i].ver,ec[i^<span class="number">1</span>].ver);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="点双连通分量"><a href="#点双连通分量" class="headerlink" title="点双连通分量"></a>点双连通分量</h2><p>根据v-DCC的定义，除孤立点外，v-DCC的大小至少为二，且每个割点至少属于两个不同的点双连通分量，在求割点的代码中加入一个栈可以求出v-DCC（下面的代码不用加在之前代码前）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ne,ver;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> h[N],idx=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dfn[N],low[N],num=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> cut[N];</span><br><span class="line"><span class="keyword">int</span> root;</span><br><span class="line"><span class="keyword">int</span> stk[N],top=<span class="number">0</span>,cnt=<span class="number">0</span>;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;dcc[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    e[idx].ver=y,e[idx].ne=h[x],h[x]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    stk[++top]=x; <span class="comment">//栈记录经过的节点</span></span><br><span class="line"><span class="keyword">if</span>(x==root&amp;&amp;h[x]==<span class="number">-1</span>)&#123; <span class="comment">//孤立点 </span></span><br><span class="line">dcc[++cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125; </span><br><span class="line">    <span class="keyword">int</span> f=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x],y;i!=<span class="number">-1</span>;i=e[i].ne)&#123;</span><br><span class="line">        y=e[i].ver;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y])&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x]=<span class="built_in">min</span>(low[x],low[y]);</span><br><span class="line">            <span class="keyword">if</span>(low[y]&gt;=dfn[x])&#123;</span><br><span class="line">            ++f;</span><br><span class="line">            <span class="keyword">if</span>(x!=root||f&gt;<span class="number">1</span>) cut[x]=<span class="literal">true</span>;</span><br><span class="line">            ++cnt;</span><br><span class="line">            <span class="keyword">int</span> z;</span><br><span class="line">            <span class="keyword">do</span>&#123;</span><br><span class="line">            z=stk[top--];</span><br><span class="line">            dcc[cnt].<span class="built_in">push_back</span>(z);</span><br><span class="line">            &#125;<span class="keyword">while</span>(z!=y);</span><br><span class="line">            dcc[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> low[x]=<span class="built_in">min</span>(low[x],dfn[y]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) h[i]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v;i&lt;=m;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v);</span><br><span class="line">        <span class="keyword">if</span>(u==v) <span class="keyword">continue</span>; <span class="comment">//判自环 </span></span><br><span class="line">        <span class="built_in">add</span>(u,v);</span><br><span class="line">        <span class="built_in">add</span>(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) root=i,<span class="built_in">tarjan</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;v-DCC %d: &quot;</span>,i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;dcc[i].<span class="built_in">size</span>();++j) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,dcc[i][j]);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>与e-DCC不同，由于每一个割点会包含在不同的v-DCC中，所以对于一个有 $p$ 个割点和 $t$ 个v-DCC的图，其缩点后的图包含 $p+t$ 个节点，由 $p$ 个割点将图连通，构成一棵树（或森林），如图：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/6pv8amuw.png" alt="v-DCC"><br>代码如下（插在上面的代码中）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="keyword">int</span> new_id[N],c[N]; </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> ne,ver;</span><br><span class="line">&#125;ec[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> hc[N&lt;&lt;<span class="number">1</span>],idc=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_c</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">ec[idc].ver=y,ec[idc].ne=hc[x],hc[x]=idc++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) hc[i]=<span class="number">-1</span>;</span><br><span class="line"><span class="comment">//给每个割点一个编号，从cnt+1开始 </span></span><br><span class="line"><span class="keyword">int</span> id=cnt;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(cut[i]) new_id[i]=++id; </span><br><span class="line"><span class="comment">//建图，用割点连接v-DCC</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>,x;j&lt;dcc[i].<span class="built_in">size</span>();++j)&#123;</span><br><span class="line">x=dcc[i][j];</span><br><span class="line"><span class="keyword">if</span>(cut[x])&#123;</span><br><span class="line"><span class="built_in">add_c</span>(i,new_id[x]);</span><br><span class="line"><span class="built_in">add_c</span>(new_id[x],i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> c[x]=i; <span class="comment">//割点外的点只属于1个v-DCC </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;缩点后的森林，点数：%d，边数：%d\n&quot;</span>,id,(idc+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;idc;i+=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,ec[i].ver,ec[i^<span class="number">1</span>].ver); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="nice-终于写完了！"><a href="#nice-终于写完了！" class="headerlink" title="nice!终于写完了！"></a>nice!终于写完了！</h2>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图论 </tag>
            
            <tag> 缩点 </tag>
            
            <tag> Tarjan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Splay</title>
      <link href="/2021/11/22/Splay/"/>
      <url>/2021/11/22/Splay/</url>
      
        <content type="html"><![CDATA[<p>真正好打的平衡树</p><span id="more"></span><h1 id="Splay"><a href="#Splay" class="headerlink" title="Splay"></a>Splay</h1><p>首先是Splay的定义，上代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Splay</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">2</span>];<span class="comment">//左右儿子</span></span><br><span class="line"><span class="keyword">int</span> fa;<span class="comment">//父节点</span></span><br><span class="line"><span class="keyword">int</span> v;<span class="comment">//值</span></span><br><span class="line"><span class="keyword">int</span> size;<span class="comment">//儿子数量</span></span><br><span class="line"><span class="keyword">int</span> tag;<span class="comment">//懒标记</span></span><br><span class="line"><span class="keyword">int</span> cnt;<span class="comment">//值等于v的数都建成一个点,故记录数量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _v,<span class="keyword">int</span> _fa)</span></span>&#123;<span class="comment">//初始化</span></span><br><span class="line">ch[<span class="number">0</span>]=ch[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"> v=_v;</span><br><span class="line">fa=_fa;</span><br><span class="line">tag=<span class="number">0</span>;</span><br><span class="line">size=<span class="number">1</span>;</span><br><span class="line">cnt=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;tr[N];</span><br></pre></td></tr></table></figure><p>Splay的基本操作是旋转，在保证中序遍历不变的情况下，通过旋转将树的结构改变，如下图中 $x$ 、 $y$ 、 $z$ 是三个节点，而 $A$ 、 $B$ 、 $C$ 是三棵子树，在将 $x-y$ 左右旋转后，树的结构发生变化：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/mye61pp9.png" alt="旋转"><br>如上图中，将 $x-y$ 右旋，那么 $z$ 就完全不动，而旋转后我们发现 $A$ 、 $B$ 、 $y$ 都成了 $x$ 的子节点，这显然不满足BST性质。为了满足BST，我们比较三个子节点（子树），发现由BST性质，有 $A&lt;x&lt;B&lt;y&lt;C$ ，明显，为了BST性质，只能让 $A$ 继续做 $x$ 的左子树，将 $B$ 、 $y$ 、 $C$ 构造成 $x$ 的右子树。<br>具体实现如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//计算x的儿子数量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">tr[x].size=tr[tr[x].ch[<span class="number">0</span>]].size+tr[tr[x].ch[<span class="number">1</span>]].size+tr[u].cnt;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//旋转</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> y=tr[x].fa;<span class="keyword">int</span> z=tr[y].fa;</span><br><span class="line">    <span class="comment">//k=0表示x是y的左儿子,k=1表示x是y的右儿子</span></span><br><span class="line"><span class="keyword">int</span> k=tr[y].ch[<span class="number">1</span>]==x;</span><br><span class="line">    <span class="comment">//把x变成z的儿子</span></span><br><span class="line">tr[z].ch[tr[z].ch[<span class="number">1</span>]==y]=x,tr[x].fa=z;</span><br><span class="line">    <span class="comment">//把x的一个儿子改为y的儿子,具体哪个儿子看最初x是y的哪个儿子,就改成相同的儿子</span></span><br><span class="line">tr[y].ch[k]=tr[x].ch[k^<span class="number">1</span>],tr[tr[x].ch[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">    <span class="comment">//把y变成x的儿子,具体哪个儿子看最初x是y的哪个儿子,就改成相反的儿子</span></span><br><span class="line">tr[x].ch[k^<span class="number">1</span>]=y,tr[y].fa=x;</span><br><span class="line">   <span class="comment">//重新计算x、y</span></span><br><span class="line"><span class="built_in">push_up</span>(y),<span class="built_in">push_up</span>(x);</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而在Splay中我们插入、修改、删除任何一个节点的方式就是将该节点转至根节点，再进行操作。<br>为将节点 $x$ 转至根节点，我们定义函数 $Splay(x,k)$ 表示将节点 $x$ 转至节点 $k$ 下方（即 $x$ 是 $k$ 的子节点），通过 $Splay(x,0)$ ，我们可以将 $x$ 转至根节点。<br>而为了实现该函数，我们发现有如下两类情况（以下我们设 $y$ 是 $x$ 的父节点， $z$ 是 $y$ 的父节点）：  </p><ol><li><p> $x$ 、 $y$ 、 $z$ 在同一直线，如图：<img src="https://cdn.luogu.com.cn/upload/image_hosting/2jytcbe1.png" alt="共线"></p></li><li><p> $x$ 、 $y$ 、 $z$ 不在同一直线，如图：<img src="https://cdn.luogu.com.cn/upload/image_hosting/v6dei9f7.png" alt="不共线"></p></li></ol><p>而对于这两种情况，我们也有不同的策略：  </p><ol><li><p>先转一次 $y$ ，再转一次 $x$ （具体方向取决于是左儿子还是右儿子）如图：<img src="https://cdn.luogu.com.cn/upload/image_hosting/kz3xidkx.png" alt="c1"> </p></li><li><p>连转两次 $x$ （具体方向取决于是左儿子还是右儿子）如图：<img src="https://cdn.luogu.com.cn/upload/image_hosting/6i3qhpcp.png" alt="c2"></p></li></ol><p>代码实现如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="comment">//if(x==k) return ;</span></span><br><span class="line"> <span class="keyword">while</span>(tr[x].fa!=k)&#123;</span><br><span class="line"><span class="keyword">int</span> y=tr[x].fa;<span class="keyword">int</span> z=tr[y].fa;</span><br><span class="line"><span class="keyword">if</span>(z!=k)</span><br><span class="line">        <span class="comment">//若是折线关系,先转一次x,否则先转一次y</span></span><br><span class="line">(tr[y].ch[<span class="number">1</span>]==x)^(tr[z].ch[<span class="number">1</span>]==y)?<span class="built_in">rotate</span>(x):<span class="built_in">rotate</span>(y); </span><br><span class="line">        <span class="comment">//无论如何第二次都转x</span></span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//若k=0,说明x是根节点</span></span><br><span class="line"><span class="keyword">if</span>(!k) root=x;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在实现 $Splay()$ 后，我们就可以完成操作。</p><h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><p>将一个数 $x$ 插入到Splay中：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root,ff=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//找到x的位置u和其父节点ff</span></span><br><span class="line"><span class="keyword">while</span>(u&amp;&amp;tr[u].v!=x) ff=u,u=tr[u].ch[x&gt;tr[u].v];</span><br><span class="line">    <span class="comment">//若已存在,个数加1</span></span><br><span class="line"><span class="keyword">if</span>(u) t[u].cnt++;</span><br><span class="line">    <span class="comment">//否则新建节点</span></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">u=++idx;</span><br><span class="line"><span class="keyword">if</span>(ff) tr[ff].ch[x&gt;tr[ff].v]=u;</span><br><span class="line">tr[u].<span class="built_in">init</span>(x,ff);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//优化:每次都让新加入的点为根</span></span><br><span class="line"><span class="built_in">splay</span>(u,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="查找第k个数"><a href="#查找第k个数" class="headerlink" title="查找第k个数"></a>查找第k个数</h2><p>找到第 $k$ 大的数：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>(tr[u].size&lt;k) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">int</span> y=t[u].ch[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//若k在u的后面,直接减掉u及前面的数,进入右子树</span></span><br><span class="line"><span class="keyword">if</span>(k&gt;tr[y].size+tr[u].cnt) k-=tr[y].size+tr[u].cnt,u=tr[u].ch[<span class="number">1</span>];</span><br><span class="line">        <span class="comment">//若u的左子树的节点数大于k,说明k在左子树中</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(tr[y].size&gt;=k) u=y;</span><br><span class="line">        <span class="comment">//否则第k个就是u</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> tr[u].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="查找x的位置"><a href="#查找x的位置" class="headerlink" title="查找x的位置"></a>查找x的位置</h2><p>该函数可以把数 $x$ 转到根节点，完成后x的排名就是<br>$tr[tr[root].ch[0]].size+1 \sim tr[tr[root].ch[0]].size+tr[root].cnt$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>(!u) <span class="keyword">return</span> ;<span class="comment">//不存在节点</span></span><br><span class="line">    <span class="comment">//找到x所在的位置u</span></span><br><span class="line"><span class="keyword">while</span>(tr[u].ch[x&gt;tr[u].v]&amp;&amp;x!=tr[u].v) u=tr[u].ch[x&gt;tr[u].v];</span><br><span class="line"><span class="built_in">splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="查找前驱-后继"><a href="#查找前驱-后继" class="headerlink" title="查找前驱/后继"></a>查找前驱/后继</h2><p>该函数可以找到数 $x$ 的前驱（ $f=0$ ）或后继（ $f=1$ ）（大小关系严格）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">near</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line"><span class="built_in">find</span>(x);</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>((tr[u].v&gt;x&amp;&amp;f)||(tr[u].v&lt;x&amp;&amp;!f)) <span class="keyword">return</span> u;</span><br><span class="line">    <span class="comment">//若不严格，用if((tr[u].v&gt;x&amp;&amp;f)||(tr[u].v&lt;x&amp;&amp;!f)||(tr[u].v==x&amp;&amp;tr[u].cnt&gt;1)) return u;</span></span><br><span class="line">    <span class="comment">//进入左/右子树</span></span><br><span class="line">u=tr[u].ch[f];</span><br><span class="line">    <span class="comment">//找到该子树中的最大/小值,方法是一直向与f相反的方向走</span></span><br><span class="line"><span class="keyword">while</span>(tr[u].ch[f^<span class="number">1</span>]) u=tr[u].ch[f^<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="删除数x"><a href="#删除数x" class="headerlink" title="删除数x"></a>删除数x</h2><p>在Splay中删除 $x$ ：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> last=<span class="built_in">near</span>(x,<span class="number">0</span>);<span class="comment">//前驱</span></span><br><span class="line"><span class="keyword">int</span> next=<span class="built_in">near</span>(x,<span class="number">1</span>);<span class="comment">//后继</span></span><br><span class="line"><span class="built_in">splay</span>(last,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">splay</span>(next,last);</span><br><span class="line">    <span class="comment">//x此时就是next的左儿子</span></span><br><span class="line"><span class="keyword">int</span> rem=tr[next].ch[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(tr[rem].cnt&gt;<span class="number">1</span>) tr[rem].cnt--,<span class="built_in">splay</span>(rem,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">else</span> tr[next].ch[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="中序输出"><a href="#中序输出" class="headerlink" title="中序输出"></a>中序输出</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">midout</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">if</span>(tr[u].ch[<span class="number">0</span>]) <span class="built_in">midout</span>(tr[u].ch[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span>(tr[u].v&gt;<span class="number">1</span>&amp;&amp;tr[u].v&lt;n+<span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,tr[u].v<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">if</span>(tr[u].ch[<span class="number">1</span>]) <span class="built_in">midout</span>(tr[u].ch[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="下传懒标记"><a href="#下传懒标记" class="headerlink" title="下传懒标记"></a>下传懒标记</h2><p>以下用区间翻转举例：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[x].tag)&#123;</span><br><span class="line">tr[tr[x].ch[<span class="number">0</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">tr[tr[x].ch[<span class="number">1</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">tr[x].tag=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">swap</span>(tr[x].ch[<span class="number">0</span>],tr[x].ch[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Splay</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> ch[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> fa;</span><br><span class="line"><span class="keyword">int</span> v;</span><br><span class="line"><span class="keyword">int</span> size;</span><br><span class="line"><span class="keyword">int</span> tag;</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> _v,<span class="keyword">int</span> _fa)</span></span>&#123;</span><br><span class="line">ch[<span class="number">0</span>]=ch[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"> v=_v;</span><br><span class="line">fa=_fa;</span><br><span class="line">tag=<span class="number">0</span>;</span><br><span class="line">size=<span class="number">1</span>;</span><br><span class="line">cnt=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="keyword">int</span> root=<span class="number">0</span>,idx=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[x].tag)&#123;</span><br><span class="line">tr[tr[x].ch[<span class="number">0</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">tr[tr[x].ch[<span class="number">1</span>]].tag^=<span class="number">1</span>;</span><br><span class="line">tr[x].tag=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">swap</span>(tr[x].ch[<span class="number">0</span>],tr[x].ch[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">tr[x].size=tr[tr[x].ch[<span class="number">0</span>]].size+tr[tr[x].ch[<span class="number">1</span>]].size+tr[x].cnt;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> y=tr[x].fa;<span class="keyword">int</span> z=tr[y].fa;</span><br><span class="line"><span class="keyword">int</span> k=tr[y].ch[<span class="number">1</span>]==x;</span><br><span class="line">tr[z].ch[tr[z].ch[<span class="number">1</span>]==y]=x,tr[x].fa=z;</span><br><span class="line">tr[y].ch[k]=tr[x].ch[k^<span class="number">1</span>],tr[tr[x].ch[k^<span class="number">1</span>]].fa=y;</span><br><span class="line">tr[x].ch[k^<span class="number">1</span>]=y,tr[y].fa=x;</span><br><span class="line"><span class="built_in">push_up</span>(y),<span class="built_in">push_up</span>(x);</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x==k) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">while</span>(tr[x].fa!=k)&#123;</span><br><span class="line"><span class="keyword">int</span> y=tr[x].fa;<span class="keyword">int</span> z=tr[y].fa;</span><br><span class="line"><span class="keyword">if</span>(z!=k)</span><br><span class="line">(tr[y].ch[<span class="number">1</span>]==x)^(tr[z].ch[<span class="number">1</span>]==y)?<span class="built_in">rotate</span>(x):<span class="built_in">rotate</span>(y); </span><br><span class="line"><span class="built_in">rotate</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!k) root=x;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>(!u) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">while</span>(tr[u].ch[x&gt;tr[u].v]&amp;&amp;x!=tr[u].v) u=tr[u].ch[x&gt;tr[u].v];</span><br><span class="line"><span class="built_in">splay</span>(u,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">near</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">bool</span> f)</span></span>&#123;</span><br><span class="line"><span class="built_in">find</span>(x);</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>((tr[u].v&gt;x&amp;&amp;f)||(tr[u].v&lt;x&amp;&amp;!f)) <span class="keyword">return</span> u;</span><br><span class="line">u=tr[u].ch[f];</span><br><span class="line"><span class="keyword">while</span>(tr[u].ch[f^<span class="number">1</span>]) u=tr[u].ch[f^<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> last=<span class="built_in">near</span>(x,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">int</span> next=<span class="built_in">near</span>(x,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">splay</span>(last,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">splay</span>(next,last);</span><br><span class="line"><span class="keyword">int</span> rem=tr[next].ch[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(tr[rem].cnt&gt;<span class="number">1</span>) tr[rem].cnt--,<span class="built_in">splay</span>(rem,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">else</span> tr[next].ch[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root,ff=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(u&amp;&amp;tr[u].v!=x) ff=u,u=tr[u].ch[x&gt;tr[u].v];</span><br><span class="line"><span class="keyword">if</span>(u) tr[u].cnt++;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">u=++idx;</span><br><span class="line"><span class="keyword">if</span>(ff) tr[ff].ch[x&gt;tr[ff].v]=u;</span><br><span class="line">tr[u].<span class="built_in">init</span>(x,ff);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">splay</span>(u,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> u=root;</span><br><span class="line"><span class="keyword">if</span>(tr[u].size&lt;k) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">int</span> y=tr[u].ch[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(k&gt;tr[y].size+tr[u].cnt) k-=tr[y].size+tr[u].cnt,u=tr[u].ch[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(tr[y].size&gt;=k) u=y;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> tr[u].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">midout</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line"><span class="built_in">push_down</span>(u);</span><br><span class="line"><span class="keyword">if</span>(tr[u].ch[<span class="number">0</span>]) <span class="built_in">midout</span>(tr[u].ch[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span>(tr[u].v&gt;<span class="number">1</span>&amp;&amp;tr[u].v&lt;n+<span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,tr[u].v<span class="number">-1</span>);<span class="comment">//视具体情况 </span></span><br><span class="line"><span class="keyword">if</span>(tr[u].ch[<span class="number">1</span>]) <span class="built_in">midout</span>(tr[u].ch[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">insert</span>(x);</span><br><span class="line"><span class="built_in">remove</span>(x);</span><br><span class="line"><span class="built_in">find</span>(x);</span><br><span class="line"><span class="built_in">get_k</span>(x+<span class="number">1</span>);<span class="comment">//编号要加1</span></span><br><span class="line"><span class="built_in">near</span>(x,<span class="number">0</span>); </span><br><span class="line"><span class="built_in">near</span>(x,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">midout</span>(root);</span><br><span class="line"><span class="comment">//P3369</span></span><br><span class="line"><span class="comment">/*scanf(&quot;%d&quot;,&amp;n);</span></span><br><span class="line"><span class="comment">//注意要多插入两个数 </span></span><br><span class="line"><span class="comment">insert(-INF);</span></span><br><span class="line"><span class="comment">insert(INF);</span></span><br><span class="line"><span class="comment">while(n--)&#123;</span></span><br><span class="line"><span class="comment">int op,x;</span></span><br><span class="line"><span class="comment">scanf(&quot;%d%d&quot;,&amp;op,&amp;x);</span></span><br><span class="line"><span class="comment">if(op==1) insert(x);</span></span><br><span class="line"><span class="comment">else if(op==2) remove(x);</span></span><br><span class="line"><span class="comment">else if(op==3) find(x),printf(&quot;%d\n&quot;,tr[tr[root].ch[0]].size);</span></span><br><span class="line"><span class="comment">else if(op==4) printf(&quot;%d\n&quot;,get_k(x+1));</span></span><br><span class="line"><span class="comment">else if(op==5) printf(&quot;%d\n&quot;,tr[near(x,0)].v);</span></span><br><span class="line"><span class="comment">else printf(&quot;%d\n&quot;,tr[near(x,1)].v);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//P3391</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scanf(&quot;%d%d&quot;,&amp;n,&amp;m);</span></span><br><span class="line"><span class="comment">for(int i=1;i&lt;=n+2;++i) insert(i);//增加两个点防止越界 </span></span><br><span class="line"><span class="comment">while(m--)&#123;</span></span><br><span class="line"><span class="comment">int l,r;</span></span><br><span class="line"><span class="comment">scanf(&quot;%d%d&quot;,&amp;l,&amp;r);</span></span><br><span class="line"><span class="comment">l=get_k(l),r=get_k(r+2); </span></span><br><span class="line"><span class="comment">splay(l,0);splay(r,l);</span></span><br><span class="line"><span class="comment">tr[tr[tr[root].ch[1]].ch[0]].tag^=1;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">midout(root);</span></span><br><span class="line"><span class="comment">printf(&quot;\n&quot;);</span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
            <tag> splay </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SBT（Size Balanced Tree）</title>
      <link href="/2021/11/22/SBT%EF%BC%88Size-Balanced-Tree%EF%BC%89/"/>
      <url>/2021/11/22/SBT%EF%BC%88Size-Balanced-Tree%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>cqf大佬智慧的结晶</p><span id="more"></span><h1 id="SBT"><a href="#SBT" class="headerlink" title="SBT"></a>SBT</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SBT（子树大小平衡树）是一种通过子树大小来维持平衡的平衡树，由cqf大佬发明，是一种非常非常优秀的平衡树（反正比Splay快），与Splay的旋转类似，它通过旋转来平衡，但不同的是，Splay的旋转没有条件，而SBT的旋转是为了维护一个有关子树大小的性质。</p><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SBT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v; <span class="comment">//价值关键字</span></span><br><span class="line">    <span class="keyword">int</span> size; <span class="comment">//子树大小</span></span><br><span class="line">    <span class="keyword">int</span> l,r; <span class="comment">//左右儿子</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _v)</span></span>&#123;</span><br><span class="line">        v=_v;</span><br><span class="line">        size=<span class="number">1</span>;</span><br><span class="line">        l=r=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(i) tr[i].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> size(i) tr[i].size</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(i) tr[i].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(i) tr[i].r</span></span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>，root;</span><br></pre></td></tr></table></figure><h2 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h2><p>SBT的旋转与Splay类似，但略有不同，主要表现在它不记录父节点，而是通过传实参来更新与 $Z$ 的关系<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/mye61pp9.png" alt="旋转"><br>代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_rotate</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span>&#123; <span class="comment">//右旋</span></span><br><span class="line">    <span class="keyword">int</span> k=<span class="built_in">l</span>(t);</span><br><span class="line">    <span class="built_in">l</span>(t)=<span class="built_in">r</span>(k);</span><br><span class="line">    <span class="built_in">r</span>(k)=t;</span><br><span class="line">    <span class="comment">//代替Splay的push_up</span></span><br><span class="line">    <span class="built_in">size</span>(k)=<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="built_in">size</span>(t)=<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="built_in">size</span>(<span class="built_in">r</span>(t))+<span class="number">1</span>;</span><br><span class="line">    <span class="comment">//更新z的儿子</span></span><br><span class="line">    t=k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">l_rotate</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span>&#123; <span class="comment">//左旋</span></span><br><span class="line">    <span class="keyword">int</span> k=<span class="built_in">r</span>(t);</span><br><span class="line">    <span class="built_in">r</span>(t)=<span class="built_in">l</span>(k);</span><br><span class="line">    <span class="built_in">l</span>(k)=t;</span><br><span class="line">    <span class="built_in">size</span>(k)=<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="built_in">size</span>(t)=<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="built_in">size</span>(<span class="built_in">r</span>(t))+<span class="number">1</span>;</span><br><span class="line">    t=k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>SBT和Splay的主要不同点是SBT维护了两个性质：</p><ol><li><p>$size(r(t)) \ge size(l(l(t)))\ ,\ size(r(l(t)))$  </p></li><li><p>$size(l(t)) \ge size(r(r(t)))\ ,\ size(l(r(t)))$  </p></li></ol><p>如图，就是说：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/fu20g4nj.png" alt="SBT性质"></p><ol><li><p>$size(R) \ge size(A)\ ,\ size(B)$ </p></li><li><p>$size(L) \ge size(C)\ ,\ size(D)$ </p></li></ol><p>而为了在插入新节点后仍保持该性质，我们需要“机智”地旋转，假设我们用一个函数（命名为 $maintain(t)$ ）可以做到使 $t$ 和它的子树符合以上性质，我们来考虑如何做到，无非有四种情况：<br>一、 $size(l(l(t))) &gt; size(r(t))$ ，即 $size(A) &gt; size(R)$ ，我们操作如下：  </p><ol><li><p>$r_rotate(t)$ ，完成后树的结构如下<br> <img src="https://cdn.luogu.com.cn/upload/image_hosting/3ij9tdws.png" alt="R"></p></li><li><p> 完成后 $t,L,A,R$ 都已满足性质，但仍可能出现 $size(C) &gt; size(B)$ 或 $size(D) &gt; size(B)$ ，所以我们还需调用 $maintain(t)$ ，完成后 $t$ 所在子树满足了性质</p></li><li><p> 此时 $L$ 的右子树可能已经被改变形状，不满足性质，所以必须再次 $maintain(t)$</p></li></ol><p>二、 $size(r(l(t))) &gt; size(r(t))$ ，即 $size(B) &gt; size(R)$ ，此时情况较为复杂，需要考虑 $B$ 的子树：<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/q8b4vsag.png" alt="SBT_2"></p><ol><li><p>$l_rotate(t)$ ，完成后树的结构如下:<br> <img src="https://cdn.luogu.com.cn/upload/image_hosting/vbpiuwzj.png" alt="L"></p></li><li><p>然后  $r_rotate(t)$ ，完成后树的结构如下：<br> <img src="https://cdn.luogu.com.cn/upload/image_hosting/vay5w3i5.png" alt="L_R"></p></li><li><p> 在两次旋转后，满足性质的有 $A,E,F,R$ ，我们调用 $maintain(L)$ 和 $maintain(t)$ 来修复  $B$ 的儿子</p></li><li><p> 现在， $B$ 的儿子都是满足性质的了，只需再调用一次 $maintain(B)$</p></li></ol><p>三、 $size(r(r(t))) &gt; size(l(t))$ ，即 $size(D) &gt; size(L)$ ，与情况一相反</p><p>四、 $size(r(r(t))) &gt; size(l(t))$ ，即 $size(D) &gt; size(L)$ ，与情况二相反</p><p>综上所述，我们可以写出伪代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">miantain</span>(t)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t)))&#123;</span><br><span class="line">        <span class="built_in">r_rotate</span>(t)</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">r</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t)))&#123;</span><br><span class="line">        <span class="built_in">l_rotate</span>(<span class="built_in">l</span>(t))</span><br><span class="line">        <span class="built_in">r_rotate</span>(t)</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">l</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">r</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t)))&#123;</span><br><span class="line">        <span class="built_in">l_rotate</span>(t)</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">l</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(t)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t)))&#123;</span><br><span class="line">        <span class="built_in">r_rotate</span>(<span class="built_in">r</span>(t))</span><br><span class="line">        <span class="built_in">l_rotate</span>(t)</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">l</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(<span class="built_in">r</span>(t))</span><br><span class="line">        <span class="built_in">miantain</span>(t)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码有点复杂，在通常情况下，一棵树只会出现情况一、情况二或情况三、情况四，我们不妨多传一个 $bool$ 来简化代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">bool</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t))) <span class="built_in">r_rotate</span>(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t)))&#123;</span><br><span class="line">            <span class="built_in">l_rotate</span>(<span class="built_in">l</span>(t));</span><br><span class="line">            <span class="built_in">r_rotate</span>(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t))) <span class="built_in">l_rotate</span>(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t)))&#123;</span><br><span class="line">            <span class="built_in">r_rotate</span>(<span class="built_in">r</span>(t));</span><br><span class="line">            <span class="built_in">l_rotate</span>(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">maintain</span>(<span class="built_in">l</span>(t),<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(<span class="built_in">r</span>(t),<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(t,<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(t,<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>至此我们还有两个问题：为啥 $maintain(l(t),true),maintain(r(t),false)$ 被省略了？而 $maintain(t)$ 的时间复杂度又是多少呢？下面我们来讨论。  </p><p>首先是为何省略：<br>在情况一的图中（即右旋后的图），因为插入后 $size(A)&gt;size(R)$ 所以 $size(B)$ 一定仍和插入前一样，即仍有 $size(B)\le size(R)$ ，故 $B$ 的子节点大小一定小于 $R$ ，即根本不需要 $maintain(r(t),false)$ 。其余情况同理。</p><p>然后我们来分析时间复杂度：<br>我们设 $SD$ 表示所有节点的深度和，明显， $SD$ 越小，BST（二叉搜索树）越优，并设 $T$ 表示 $maintain$ 中的旋转次数。<br>回顾整个 $maintain$ 我们发现在每次旋转后 $SD$ 总是在减小（不妨设减小了 $r$ ），所以，一个高度为 $O(\log{n})$ 的树，其深度和 $SD$ 总是保持在 $O(n\log{n})$ ，而在插入 $SD$ 仅增加 $O(log{n})$ ，故有： $SD=n \times O(\log{n})-T \times r=O(\log{n})$ ,取 $r$ 最小为 $1$ ，则 $T=O(\log{n})$ 。<br>于是，得到 $maintian$ 的平摊时间是：<br>$\frac{O(T)+O(n\log{n})+O(T)}{n\log{n}}=O(1) $ </p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>SBT的基本操作如下：  </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//插入</span></span><br><span class="line">    <span class="keyword">if</span>(!t)&#123;</span><br><span class="line">        t=++cnt;</span><br><span class="line">        tr[t].<span class="built_in">inint</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ++<span class="built_in">size</span>(t);</span><br><span class="line">        <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="built_in">insert</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">        <span class="built_in">maintain</span>(t,v&gt;<span class="built_in">v</span>(t));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//删除,返回被删的值</span></span><br><span class="line">    <span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    --<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="keyword">if</span>((v==<span class="built_in">v</span>(t))||((v&lt;<span class="built_in">v</span>(t))&amp;&amp;!<span class="built_in">l</span>(t))||((v&gt;<span class="built_in">v</span>(t))&amp;&amp;!<span class="built_in">r</span>(t)))&#123; <span class="comment">//若找到或无法继续找</span></span><br><span class="line">        ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">l</span>(t)||!<span class="built_in">r</span>(t)) t=<span class="built_in">l</span>(t)+<span class="built_in">r</span>(t); <span class="comment">//若只有一个儿子(或没有),就让儿子代替自己的位置</span></span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">v</span>(t)=<span class="built_in">del</span>(<span class="built_in">l</span>(t),<span class="built_in">v</span>(t)+<span class="number">1</span>); <span class="comment">//否则就把左子树中最大的数移动到自己的位置</span></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(v&lt;<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">del</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">del</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 一个优化？</span></span><br><span class="line">    <span class="comment">// maintain(t,false);</span></span><br><span class="line">    <span class="comment">// maintain(t,true);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//查找关键字为v的节点</span></span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">find</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> (<span class="built_in">v</span>(t)==v||<span class="built_in">find</span>(<span class="built_in">r</span>(t),v)); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_rank</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//返回v在以t为根的树中的排名</span></span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">get_rank</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="number">1</span>+<span class="built_in">get_rank</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">select</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> k)</span></span>&#123; <span class="comment">//返回以t为根的树中排名第k的值</span></span><br><span class="line">    <span class="keyword">if</span>(k==<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">v</span>(t);</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=<span class="built_in">size</span>(<span class="built_in">l</span>(t))) <span class="keyword">return</span> <span class="built_in">select</span>(<span class="built_in">l</span>(t),k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">select</span>(<span class="built_in">r</span>(t),k<span class="number">-1</span>-<span class="built_in">size</span>(<span class="built_in">l</span>(t)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pred</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//返回比v小的最大的数</span></span><br><span class="line">    <span class="keyword">int</span> ret;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">pred</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ret=<span class="built_in">pred</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">        <span class="keyword">if</span>(ret==v) ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">succ</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123; <span class="comment">//返回比v大的最小的数</span></span><br><span class="line">    <span class="keyword">int</span> ret;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">v</span>(t)&lt;=v) <span class="keyword">return</span> <span class="built_in">succ</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ret=<span class="built_in">succ</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">if</span>(ret==v) ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注：  </p><ol><li><p>在 $insert$ 操作中，如果插入了两个值相同的节点，BST并不会像Splay一样用一个 $cnt$ 来记录，而是直接新建节点，把两个相同的值放在两个不同的节点上</p></li><li><p>在 $del$ 操作中，有一个小优化，即注释掉 $miantain$ ，在删除后不去维护SBT的结构（但性质是一定满足了的）,这样做树的高度变成了 $O(\log{K})$ ，这里 $K$ 表示插入的节点个数</p></li></ol><h2 id="时间分析"><a href="#时间分析" class="headerlink" title="时间分析"></a>时间分析</h2><p>我们来分析SBT的时间复杂度（其实不用分析了，是个人都知道是 $O(log{n})$）:<br>设 $f[h]$ 表示高度为 $h$ 的SBT包含的最少节点数，有：<br>$$<br>f[h]=\begin{cases}<br> 1 &amp; (h=0)\<br> 2 &amp; (h=1)\<br> f[h-1]+f[h-2]+1 &amp; (h&gt;1)<br>\end{cases}<br>$$</p><p>证明如下：<br>我们把一个高度为 $h-1$ 的SBT作为当前高度为 $h$ 的SBT的左子树，目前有 $f[h-1]+1$ 个节点，但为了满足SBT性质，右子树至少应有 $f[h-2]$ 个节点。<br>然后，我们可以由 $fibonacci$ 数列得到 $f[h]$ 计算公式：<br> $$f[h]=\sum_{i=0}^{h} Fibonacci[i]=\left | \frac{\alpha^{h+3}}{\sqrt{5}} \right |$$<br>其中 $\alpha=\frac{1+\sqrt{5}}{2}$</p><p>设 $maxh$ 表示有 n 个节点的SBT的最坏高度，有<br>$$f[maxh]=\left | \frac{\alpha^{h+3}}{\sqrt{5}} \right |-1 \le n \Rightarrow$$<br>$$\frac{\alpha^{h+3}}{\sqrt{5}} \le n+1.5 \Rightarrow$$<br>$$maxh \le \log_{\alpha}{\sqrt{5}(n+1.5)}-3 \Rightarrow$$<br>$$maxh \le 1.44\log_{2}{n+1.5}-1.33$$<br>明显，SBT高度为 $O(\log{n})$。<br>且SBT效率一般优于其他平衡树。</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://www.luogu.com.cn/problem/P6136">P6136</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m,last=<span class="number">0</span>,ans=<span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SBT</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _v)</span></span>&#123;</span><br><span class="line">        v=_v;</span><br><span class="line">        size=<span class="number">1</span>;</span><br><span class="line">        l=r=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> v(i) tr[i].v</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> size(i) tr[i].size</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(i) tr[i].l</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(i) tr[i].r</span></span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>,root=<span class="number">0</span>;</span><br><span class="line"><span class="comment">/*-----------------------------SBT--------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_rotate</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k=<span class="built_in">l</span>(t);</span><br><span class="line">    <span class="built_in">l</span>(t)=<span class="built_in">r</span>(k);</span><br><span class="line">    <span class="built_in">r</span>(k)=t;</span><br><span class="line">    <span class="built_in">size</span>(k)=<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="built_in">size</span>(t)=<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="built_in">size</span>(<span class="built_in">r</span>(t))+<span class="number">1</span>;</span><br><span class="line">    t=k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">l_rotate</span><span class="params">(<span class="keyword">int</span> &amp;t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k=<span class="built_in">r</span>(t);</span><br><span class="line">    <span class="built_in">r</span>(t)=<span class="built_in">l</span>(k);</span><br><span class="line">    <span class="built_in">l</span>(k)=t;</span><br><span class="line">    <span class="built_in">size</span>(k)=<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="built_in">size</span>(t)=<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="built_in">size</span>(<span class="built_in">r</span>(t))+<span class="number">1</span>;</span><br><span class="line">    t=k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">maintain</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">bool</span> flag)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t))) <span class="built_in">r_rotate</span>(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">l</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">r</span>(t)))&#123;</span><br><span class="line">            <span class="built_in">l_rotate</span>(<span class="built_in">l</span>(t));</span><br><span class="line">            <span class="built_in">r_rotate</span>(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">r</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t))) <span class="built_in">l_rotate</span>(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">size</span>(<span class="built_in">l</span>(<span class="built_in">r</span>(t)))&gt;<span class="built_in">size</span>(<span class="built_in">l</span>(t)))&#123;</span><br><span class="line">            <span class="built_in">r_rotate</span>(<span class="built_in">r</span>(t));</span><br><span class="line">            <span class="built_in">l_rotate</span>(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">maintain</span>(<span class="built_in">l</span>(t),<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(<span class="built_in">r</span>(t),<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(t,<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">maintain</span>(t,<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!t)&#123;</span><br><span class="line">        t=++cnt;</span><br><span class="line">        tr[t].<span class="built_in">inint</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ++<span class="built_in">size</span>(t);</span><br><span class="line">        <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="built_in">insert</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">        <span class="built_in">maintain</span>(t,v&gt;<span class="built_in">v</span>(t));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    --<span class="built_in">size</span>(t);</span><br><span class="line">    <span class="keyword">if</span>((v==<span class="built_in">v</span>(t))||((v&lt;<span class="built_in">v</span>(t))&amp;&amp;!<span class="built_in">l</span>(t))||((v&gt;<span class="built_in">v</span>(t))&amp;&amp;!<span class="built_in">r</span>(t)))&#123;</span><br><span class="line">        ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">l</span>(t)||!<span class="built_in">r</span>(t)) t=<span class="built_in">l</span>(t)+<span class="built_in">r</span>(t);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">v</span>(t)=<span class="built_in">del</span>(<span class="built_in">l</span>(t),<span class="built_in">v</span>(t)+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(v&lt;<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">del</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">del</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">find</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> (<span class="built_in">v</span>(t)==v||<span class="built_in">find</span>(<span class="built_in">r</span>(t),v)); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_rank</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">get_rank</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="number">1</span>+<span class="built_in">get_rank</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">select</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="built_in">size</span>(<span class="built_in">l</span>(t))+<span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">v</span>(t);</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=<span class="built_in">size</span>(<span class="built_in">l</span>(t))) <span class="keyword">return</span> <span class="built_in">select</span>(<span class="built_in">l</span>(t),k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">select</span>(<span class="built_in">r</span>(t),k<span class="number">-1</span>-<span class="built_in">size</span>(<span class="built_in">l</span>(t)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pred</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=<span class="built_in">v</span>(t)) <span class="keyword">return</span> <span class="built_in">pred</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ret=<span class="built_in">pred</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">        <span class="keyword">if</span>(ret==v) ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">succ</span><span class="params">(<span class="keyword">int</span> &amp;t,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret;</span><br><span class="line">    <span class="keyword">if</span>(!t) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">v</span>(t)&lt;=v) <span class="keyword">return</span> <span class="built_in">succ</span>(<span class="built_in">r</span>(t),v);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ret=<span class="built_in">succ</span>(<span class="built_in">l</span>(t),v);</span><br><span class="line">        <span class="keyword">if</span>(ret==v) ret=<span class="built_in">v</span>(t);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">        <span class="built_in">insert</span>(root,a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="keyword">int</span> op,x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;op,&amp;x);</span><br><span class="line">        x^=last;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">insert</span>(root,x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">del</span>(root,x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)&#123;</span><br><span class="line">            last=<span class="built_in">get_rank</span>(root,x);</span><br><span class="line">            ans^=last;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">4</span>)&#123;</span><br><span class="line">            last=<span class="built_in">select</span>(root,x);</span><br><span class="line">            ans^=last;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">5</span>)&#123;</span><br><span class="line">            last=<span class="built_in">pred</span>(root,x);</span><br><span class="line">            ans^=last;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            last=<span class="built_in">succ</span>(root,x);</span><br><span class="line">            ans^=last;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SBT </tag>
            
            <tag> 平衡树 </tag>
            
            <tag> 数据结构 </tag>
            
            <tag> 树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CDQ分治</title>
      <link href="/2021/11/22/CDQ%E5%88%86%E6%B2%BB/"/>
      <url>/2021/11/22/CDQ%E5%88%86%E6%B2%BB/</url>
      
        <content type="html"><![CDATA[<p>cdq，又一个大佬</p><span id="more"></span><h1 id="CDQ分治"><a href="#CDQ分治" class="headerlink" title="CDQ分治"></a>CDQ分治</h1><p>CDQ分治是一种运用广泛的分治思想，主要用于解决偏序问题，尤其是三维偏序，其主要思想是将区间分成两段，段内的信息递归处理，跨段的信息在左右两段都处理好后处理。</p><p>先看模板题吧：</p><h2 id="三维偏序"><a href="#三维偏序" class="headerlink" title="三维偏序"></a><a href="https://www.luogu.com.cn/problem/P3810">三维偏序</a></h2><p>这道题就是一个三维偏序的裸题，不过，在三维前，我们先想想一、二维偏序怎么做。</p><ul><li>一维偏序<br>非常简单，排序即可，时间复杂度为 $O(n\log{n})$</li><li>二维偏序<br>先双关键字排序，完成后就可以不管第一关键字了（只需保证 $i&gt;j$ 就可以使 $a_i \ge a_j$），而对于第二关键字，将其离散化到值域为 $[1,n]$ 建立一棵线段树来维护值 $x$ 的数量，则 $ask(1,1,b_i)$ 就储存了小于 $b_i$ 的值的个数，更新完 $i$ 的答案后让 $b_i$ 这个点 $+1$ 然后继续向后扫描即可。时间复杂度为 $O(n\log{n})$ </li></ul><p>如上，我们可以在 $O(n\log{n})$ 的时间内求解一、二维偏序，那么，我们现在来康康三维。</p><p>首先，类似一、二维偏序，三维偏序的第一维可以通过排序解决，第三维在前两维有序（即 $\forall i&gt;j,a_i \ge a_j,b_i \ge b_j$ ）的情况下可以用线段树解决，问题在于：如何在保证前两维都有序？</p><p>很明显，在对第一维排序后（三关键字排序），若再更改顺序来满足第二维，第一维的单调会被破坏，而CDQ分治解决了这个问题，其过程如下：  </p><ol><li>对于区间 $[l,r]$ （此时第一维仍然单调）,把区间中满足三维偏序的数对 $(i,j)(i&gt;j)$ 以 $mid$ 为界分为三种： $i,j \in [l,mid]$ 、 $i,j \in [mid+1,r]$ 、 $i \in [mid+1,r],j \in [l,mid]$</li><li>对于前两种（ $i,j$ 在同一段的）递归处理</li><li>处理完毕后，只剩下 $i,j$ 分别在 $mid$ 左右的情况，此时，由于 $mid$ 左边的数第一维一定小于右边，我们可以对左右分别以第二维排序，然后双指针枚举 $i,j$ 用线段树求解第三维</li></ol><p>以上就是CDQ分治的主要思路，不难发现，由于每次取 $mid$ ，递归层数不会超过 $\log{n}$ 层，每一层中对左右的分别排序可以用归并在递归中顺带完成，真正消耗时间的是双指针和线段树，第 $x$ 层中 $[1,n]$ 被分为了 $2^{x-1}$ 段，每段时间复杂度为 $O(2^{x-1} \times \frac{n}{2^{x-1}} \times \log{ \frac{n}{2^{x-1}}}) = O(n\log{n})$ ，乘上层数，总时间复杂度为 $O(n \log^2_{}{n})$</p><p>一个要注意的问题是，当出现三维都相等的数时，会导致排在前面的数少算，故应先去重。  </p><p>代码实现（注意代码中的 $m$ 是题目中的 $k$ ）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>,M=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> a,b,c,num,res; <span class="comment">//a,b,c:三维,num:重复的个数,res:三维都比它小的数的个数</span></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;x) <span class="keyword">const</span>&#123; <span class="comment">//重载三关键字排序</span></span><br><span class="line"><span class="keyword">if</span>(a!=x.a) <span class="keyword">return</span> a&lt;x.a;</span><br><span class="line"><span class="keyword">if</span>(b!=x.b) <span class="keyword">return</span> b&lt;x.b;</span><br><span class="line"><span class="keyword">return</span> c&lt;x.c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Node &amp;x) <span class="keyword">const</span>&#123; <span class="comment">//重载等于用于判重</span></span><br><span class="line"><span class="keyword">return</span> a==x.a&amp;&amp;b==x.b&amp;&amp;c==x.c;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N],w[N]; <span class="comment">//w用于归并排序</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,dat;</span><br><span class="line">&#125;tr[M*<span class="number">4</span>];</span><br><span class="line"><span class="comment">/*--------------------------LineTree---------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">tr[u].dat=tr[u&lt;&lt;<span class="number">1</span>].dat+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">tr[u].l=l;</span><br><span class="line">tr[u].r=r;</span><br><span class="line">tr[u].dat=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pos,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l==tr[u].r)&#123;</span><br><span class="line">tr[u].dat+=d;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(pos&lt;=mid) <span class="built_in">change</span>(u&lt;&lt;<span class="number">1</span>,pos,d);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">change</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,pos,d);</span><br><span class="line"><span class="built_in">push_up</span>(u);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r) <span class="keyword">return</span> tr[u].dat;</span><br><span class="line"><span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*----------------------------CDQ------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">merge_sort</span>(l,mid);</span><br><span class="line"><span class="built_in">merge_sort</span>(mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="keyword">int</span> i=l,j=mid+<span class="number">1</span>,k=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line"><span class="keyword">if</span>(q[i].b&lt;=q[j].b) <span class="built_in">change</span>(<span class="number">1</span>,q[i].c,q[i].num),w[k++]=q[i++];</span><br><span class="line"><span class="keyword">else</span> q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].c),w[k++]=q[j++];</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid) <span class="built_in">change</span>(<span class="number">1</span>,q[i].c,q[i].num),w[k++]=q[i++];</span><br><span class="line"><span class="keyword">while</span>(j&lt;=r) q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].c),w[k++]=q[j++];</span><br><span class="line"><span class="keyword">for</span>(i=l;i&lt;=mid;++i) <span class="built_in">change</span>(<span class="number">1</span>,q[i].c,-q[i].num); <span class="comment">//还原线段树以备下次使用</span></span><br><span class="line"><span class="keyword">for</span>(i=l,j=<span class="number">1</span>;j&lt;k;++i,++j) q[i]=w[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;q[i].a,&amp;q[i].b,&amp;q[i].c),q[i].num=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+<span class="number">1</span>+n);</span><br><span class="line"><span class="keyword">int</span> k=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">if</span>(q[i]==q[k<span class="number">-1</span>]) ++q[k<span class="number">-1</span>].num;</span><br><span class="line"><span class="keyword">else</span> q[k++]=q[i];</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,m); <span class="comment">//这里m足够小不必离散化</span></span><br><span class="line"><span class="built_in">merge_sort</span>(<span class="number">1</span>,k<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;k;++i)</span><br><span class="line">ans[q[i].num+q[i].res<span class="number">-1</span>]+=q[i].num; <span class="comment">//f(i)=q[i].num+q[i].res-1(去掉自己)</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="老C的任务"><a href="#老C的任务" class="headerlink" title="老C的任务"></a><a href="https://www.luogu.com.cn/problem/P3755">老C的任务</a></h3><p>提示：考虑二维前缀和，对于每个询问 $(x1,y1,x2,y2),ans=s(x2,y2)-s(x2,y1-1)-s(x1-1,y2)+s(x1-1,y1-1)$ ，不妨以坐标作为第一、二维，是否是询问为第三维（是为1，不是为0）,把询问拆成四个点（注意保留符号），和不是询问的点一起，对于每个点，求其三维偏序（求出的点就是会对其二维前缀和有贡献的点），最后计算即可，本题第三维只有0、1两中情况，故可以省略线段树，直接用一个 $sum$ 记录为0的数的权值和。</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> x,y,z,p,i,sign;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;t) <span class="keyword">const</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(x!=t.x) <span class="keyword">return</span> x&lt;t.x;</span><br><span class="line"><span class="keyword">if</span>(y!=t.y) <span class="keyword">return</span> y&lt;t.y;</span><br><span class="line"><span class="keyword">return</span> z&lt;t.z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _x,<span class="keyword">int</span> _y,<span class="keyword">int</span> _z,<span class="keyword">int</span> _p,<span class="keyword">int</span> _i,<span class="keyword">int</span> _s)</span></span>&#123;</span><br><span class="line">x=_x;</span><br><span class="line">y=_y;</span><br><span class="line">z=_z;</span><br><span class="line">p=_p;</span><br><span class="line">i=_i;</span><br><span class="line">sign=_s;</span><br><span class="line">sum=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;q[N*<span class="number">5</span>],w[N*<span class="number">5</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">merge_sort</span>(l,mid);</span><br><span class="line"><span class="built_in">merge_sort</span>(mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="keyword">int</span> i=l,j=mid+<span class="number">1</span>,k=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line"><span class="keyword">if</span>(q[i].y&lt;=q[j].y) sum+=!q[i].z*q[i].p,w[k++]=q[i++];</span><br><span class="line"><span class="keyword">else</span> q[j].sum+=sum,w[k++]=q[j++];</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid) sum+=!q[i].z*q[i].p,w[k++]=q[i++];</span><br><span class="line"><span class="keyword">while</span>(j&lt;=r) q[j].sum+=sum,w[k++]=q[j++];</span><br><span class="line"><span class="keyword">for</span>(i=l,j=<span class="number">1</span>;j&lt;k;++i,++j) q[i]=w[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;q[i].x,&amp;q[i].y,&amp;q[i].p),q[i].z=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> k=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line"><span class="keyword">int</span> x_1,y_1,x_2,y_2;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;x_1,&amp;y_1,&amp;x_2,&amp;y_2);</span><br><span class="line">q[k++].<span class="built_in">inint</span>(x_2,y_2,<span class="number">1</span>,<span class="number">0</span>,i,<span class="number">1</span>);</span><br><span class="line">q[k++].<span class="built_in">inint</span>(x_1<span class="number">-1</span>,y_2,<span class="number">1</span>,<span class="number">0</span>,i,<span class="number">-1</span>);</span><br><span class="line">q[k++].<span class="built_in">inint</span>(x_2,y_1<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,i,<span class="number">-1</span>);</span><br><span class="line">q[k++].<span class="built_in">inint</span>(x_1<span class="number">-1</span>,y_1<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,i,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(q+<span class="number">1</span>,q+k);</span><br><span class="line"><span class="built_in">merge_sort</span>(<span class="number">1</span>,k<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;k;++i)</span><br><span class="line"><span class="keyword">if</span>(q[i].z) ans[q[i].i]+=q[i].sum*q[i].sign;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans[i]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态逆序对"><a href="#动态逆序对" class="headerlink" title="动态逆序对"></a><a href="https://www.luogu.com.cn/problem/P3157">动态逆序对</a></h3><p>提示：以时间为第三维，对于每个删除，求出该删除会导致此时仍存在的数列减少多少个逆序对即可。注意第三维越大越早删除，注意逆序应分类讨论</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> a,t,res; <span class="comment">//位置关系已经是有序且互不相等的,不必记录和排序 </span></span><br><span class="line">&#125;q[N],w[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LineTree</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> l,r,dat;</span><br><span class="line">&#125;tr[N*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> pos[N];</span><br><span class="line">LL ans[N];</span><br><span class="line"><span class="comment">/*---------------------------------LineTree--------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">tr[u].dat=tr[u&lt;&lt;<span class="number">1</span>].dat+tr[u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].dat;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">tr[u].l=l;</span><br><span class="line">tr[u].r=r;</span><br><span class="line">tr[u].dat=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>,l,mid);</span><br><span class="line"><span class="built_in">build</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> pos,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l==tr[u].r)&#123;</span><br><span class="line">tr[u].dat+=d;</span><br><span class="line"><span class="keyword">return</span> ; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(pos&lt;=mid) <span class="built_in">change</span>(u&lt;&lt;<span class="number">1</span>,pos,d);</span><br><span class="line"><span class="keyword">if</span>(pos &gt; mid) <span class="built_in">change</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,pos,d);</span><br><span class="line"><span class="built_in">push_up</span>(u); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[u].l&gt;=l&amp;&amp;tr[u].r&lt;=r) <span class="keyword">return</span> tr[u].dat;</span><br><span class="line"><span class="keyword">int</span> mid=tr[u].l+tr[u].r&gt;&gt;<span class="number">1</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(l&lt;=mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">if</span>(r&gt;mid) res+=<span class="built_in">ask</span>(u&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*----------------------------------CDQ---------------------------------------*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">merge_sort</span>(l,mid);</span><br><span class="line"><span class="built_in">merge_sort</span>(mid+<span class="number">1</span>,r);</span><br><span class="line"><span class="keyword">int</span> i=mid,j=r,k;</span><br><span class="line"><span class="comment">//j的位置在i后时 </span></span><br><span class="line"><span class="keyword">while</span>(i&gt;=l&amp;&amp;j&gt;mid)</span><br><span class="line"><span class="keyword">if</span>(q[i].a&gt;q[j].a) <span class="built_in">change</span>(<span class="number">1</span>,q[i].t,<span class="number">1</span>),--i;</span><br><span class="line"><span class="keyword">else</span> q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].t<span class="number">-1</span>),--j;</span><br><span class="line"><span class="keyword">while</span>(j&gt;mid) q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].t<span class="number">-1</span>),--j;</span><br><span class="line"><span class="keyword">for</span>(k=i+<span class="number">1</span>;k&lt;=mid;++k) <span class="built_in">change</span>(<span class="number">1</span>,q[k].t,<span class="number">-1</span>);</span><br><span class="line"><span class="comment">//j的位置在i前时</span></span><br><span class="line">j=l,i=mid+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(j&lt;=mid&amp;&amp;i&lt;=r)</span><br><span class="line"><span class="keyword">if</span>(q[i].a&lt;q[j].a) <span class="built_in">change</span>(<span class="number">1</span>,q[i].t,<span class="number">1</span>),++i;</span><br><span class="line"><span class="keyword">else</span> q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].t<span class="number">-1</span>),++j;</span><br><span class="line"><span class="keyword">while</span>(j&lt;=mid) q[j].res+=<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,q[j].t<span class="number">-1</span>),++j;</span><br><span class="line"><span class="keyword">for</span>(k=i<span class="number">-1</span>;k&gt;mid;--k) <span class="built_in">change</span>(<span class="number">1</span>,q[k].t,<span class="number">-1</span>);</span><br><span class="line"><span class="comment">//归并排序可以用sort代替</span></span><br><span class="line">i=l,j=mid+<span class="number">1</span>;</span><br><span class="line">k=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line"><span class="keyword">if</span>(q[i].a&lt;=q[j].a) w[k++]=q[i++];</span><br><span class="line"><span class="keyword">else</span> w[k++]=q[j++];</span><br><span class="line"><span class="keyword">while</span>(i&lt;=mid) w[k++]=q[i++];</span><br><span class="line"><span class="keyword">while</span>(j&lt;=r) w[k++]=q[j++];</span><br><span class="line"><span class="keyword">for</span>(i=l,j=<span class="number">1</span>;j&lt;k;++i,++j) q[i]=w[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q[i].a);</span><br><span class="line">pos[q[i].a]=i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=n;i&lt;=m;++i)&#123;</span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a);</span><br><span class="line">q[pos[a]].t=j--;</span><br><span class="line">pos[a]=<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=n-m;i&lt;=n;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(pos[i]!=<span class="number">-1</span>) q[pos[i]].t=j--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="built_in">merge_sort</span>(<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans[q[i].t]=q[i].res;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) ans[i]+=ans[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=n;i&lt;=m;++i,--j) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans[j]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cdq </tag>
            
            <tag> 分治 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BSGS算法</title>
      <link href="/2021/11/22/BSGS%E7%AE%97%E6%B3%95/"/>
      <url>/2021/11/22/BSGS%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>大步小步</p><span id="more"></span><h1 id="BSGS算法"><a href="#BSGS算法" class="headerlink" title="BSGS算法"></a>BSGS算法</h1><h2 id="普通版"><a href="#普通版" class="headerlink" title="普通版"></a>普通版</h2><p>在以前我们学了用拓欧求解线性同余方程 $ax\equiv 1\pmod b$ ，现在我们来思考高次同余方程，考虑如下问题：</p><p>求解关于 $x$ 的方程 $a^x\equiv b\pmod p$ ，其中 $gcd(a,p)=1$  </p><p>不难想到欧拉定理 $a^{\varphi(p)}\equiv 1\pmod p$ ，设 $a^t\equiv a^{x\mod \varphi(p)}\pmod p$ ，易得 $t\in[0,\varphi(p)-1]$ ，我们只需找到 $t$ 使 $x=t$ 时方程成立即可，为了代码简洁（懒得求欧拉函数）不 妨扩大 $t$ 的范围，使 $t\in[0,p]$ </p><p>直接枚举 $t$ 计算显得过于暴力，BSGS算法使用一个“以空间换时间”的思想，用分块加hash表处理：</p><p>令 $k=\lceil\sqrt{p}\rceil$ （代码中为简洁一般是 $k=\sqrt{n}+1$ ），将 $[0,p]$ 每 $k$ 个分为一段，则可以把 $t$ 表示为 $t=kx-y,x\in[1,k],y\in[0,k-1]$ (这里的 $x$ 已经不是上面方程的 $x$ 了，而是新设的未知数，不用 $+y$ 而用 $-y$ 是为了在后面移项后不出现逆元) ，这样， $t$ 可以取遍 $[1,p]$ 中所有值，剩下的 $0$ 特判即可</p><p>那么问题转化为求出一组 $x,y$ 使 $t=kx-y,a^t\equiv b\pmod p$ ，很暴力的思路是，枚举每一个 $x$ 判断是否存在 $y$ ，这里就体现出用 $-y$ 的好处，我们来变个形：<br>$$<br>a^t\equiv b\pmod p\Rightarrow a^{kx-y}\equiv b\pmod p\Rightarrow a^{kx}\equiv b\times a^y\pmod p<br>$$<br>可以提前将 $b\times a^y$ 存到hash表里，枚举 $x$ 判定即可，如果有多个 $y$ 的 $b\times a^y$ 相同，我们保留较大的（这样减了以后 $t$ 最小）</p><p>时间复杂度为 $O(\sqrt{p})$ </p><p><a href="https://www.luogu.com.cn/problem/P3846">BSGS板子</a> </p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50000</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> H=<span class="number">20051221</span>; <span class="comment">//取的质数很玄妙 </span></span><br><span class="line"><span class="comment">//拉链法Hash </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hash</span>&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> key,val,ne;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">2</span>]; </span><br><span class="line"><span class="keyword">int</span> h[H],idx=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;H;++i) h[i]=<span class="number">-1</span>; <span class="comment">//初始化hash表 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> key)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> _key=(key%H+H)%H;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=h[_key];i!=<span class="number">-1</span>;i=e[i].ne)</span><br><span class="line"><span class="keyword">if</span>(e[i].key==key) <span class="keyword">return</span> e[i].val;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> key,<span class="keyword">int</span> val)</span></span>&#123; <span class="comment">//用后面的覆盖前面 </span></span><br><span class="line"><span class="keyword">int</span> _key=(key%H+H)%H;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=h[_key];i!=<span class="number">-1</span>;i=e[i].ne)</span><br><span class="line"><span class="keyword">if</span>(e[i].key==key) <span class="keyword">return</span> e[i].val=val;</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> key,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">change</span>(key,val)!=<span class="number">-1</span>) <span class="keyword">return</span> ;</span><br><span class="line"><span class="keyword">int</span> _key=(key%H+H)%H;</span><br><span class="line">e[idx].key=key,e[idx].val=val,e[idx].ne=h[_key],h[_key]=idx++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;ha; <span class="comment">//注意hash会重名 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>%p==b%p) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//特判0的情况 </span></span><br><span class="line"><span class="keyword">int</span> k=<span class="built_in">sqrt</span>(p)+<span class="number">1</span>;</span><br><span class="line">ha.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=b%p;i&lt;k;++i)&#123; <span class="comment">//提交将每个y插入hash表里,</span></span><br><span class="line"><span class="comment">//枚举方法本身保证了保留的是更大的y </span></span><br><span class="line">ha.<span class="built_in">insert</span>(j,i);</span><br><span class="line">j=(LL)j*a%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ak=<span class="number">1</span>; <span class="comment">//处理出a^k </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) ak=(LL)ak*a%p; <span class="comment">//可以用qpow,然而对时间复杂度没有优化 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=ak,_h;i&lt;=k;++i)&#123;</span><br><span class="line">_h=ha.<span class="built_in">find</span>(j);</span><br><span class="line"><span class="keyword">if</span>(_h!=<span class="number">-1</span>) <span class="keyword">return</span> (LL)i*k-_h;</span><br><span class="line">j=(LL)j*ak%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> -INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,p,b;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;p,&amp;a,&amp;b);</span><br><span class="line"><span class="keyword">int</span> ans=<span class="built_in">bsgs</span>(a,b,p);</span><br><span class="line">ans&lt;<span class="number">0</span>?<span class="built_in">printf</span>(<span class="string">&quot;no solution\n&quot;</span>):<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拓展版"><a href="#拓展版" class="headerlink" title="拓展版"></a>拓展版</h2><p>考虑更一般的情况：</p><p> $a^x\equiv b\pmod p$ ，其中 $a,p$ 不一定互质，求解 $x$ ，理所当然想办法转化为普通版，过程如下：</p><ol><li><p>若 $a^0\equiv b\pmod p$ ， $x=0$ ，结束 </p></li><li><p>若 $x\ge1$ 且 $gcd(a,p)==1$ 用普通版BSGS</p></li><li><p>若 $gcd(a,p)=d,d&gt;1$ ，则 $a^x\equiv b\pmod p\Leftrightarrow a^x+kp=b$ </p><p>明显，若 $d\nmid b$ 原方程无解</p><p>否则有 $d|b$ ，可以所有数同时除以 $d$ ，化为  $\frac{a}{d}\times a^{x-1}\equiv\frac{b}{d}\pmod {\frac{p}{d}}$ 此时 $gcd(\frac{a}{d},\frac{p}{d})=1$ ，可以求 $\frac{a}{b}$ 的逆元，于是化为 $a^{x-1}\equiv\frac{b}{d}\times(\frac{a}{d})^{-1}\pmod {\frac{p}{d}}$ ，让 $a’=a,x’=x-1,b’=\frac{b}{d}\times(\frac{a}{d})^{-1},p’=\frac{p}{d}$ ，再次回到第一步求解 $a’^{x’}\equiv b’\pmod {p’}$ </p></li></ol><p><a href="https://www.luogu.com.cn/problem/P4195">拓展BSGS</a></p><p>本题有多组数据，每次清空hash表还不如每次重开一个map快（unordered_map也行）</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">50000</span>+<span class="number">5</span>,INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!b)&#123;</span><br><span class="line">x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> d=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">y-=a/b*x;</span><br><span class="line"><span class="keyword">return</span> d;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>%p==b%p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> k=<span class="built_in">sqrt</span>(p)+<span class="number">1</span>;</span><br><span class="line">map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;ha;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=b%p;i&lt;k;++i)&#123;</span><br><span class="line">ha[j]=i;</span><br><span class="line">j=(LL)j*a%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ak=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) ak=(LL)ak*a%p;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=ak;i&lt;=k;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(ha.<span class="built_in">find</span>(j)!=ha.<span class="built_in">end</span>()) <span class="keyword">return</span> i*k-ha[j];</span><br><span class="line">j=(LL)j*ak%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> -INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exbsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">b=(b%p+p)%p; <span class="comment">//保证b为正数 </span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>%p==b%p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="keyword">int</span> d=<span class="built_in">exgcd</span>(a,p,x,y);</span><br><span class="line"><span class="keyword">if</span>(d&gt;<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(b%d) <span class="keyword">return</span> -INF;</span><br><span class="line"><span class="built_in">exgcd</span>(a/d,p/d,x,y);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">exbsgs</span>(a,(LL)b/d*x%(p/d),p/d)+<span class="number">1</span>; <span class="comment">//注意加1 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bsgs</span>(a,b,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,p,b;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;a,&amp;p,&amp;b),a||p||b)&#123;</span><br><span class="line"><span class="keyword">int</span> ans=<span class="built_in">exbsgs</span>(a,b,p);</span><br><span class="line">ans&lt;<span class="number">0</span>?<span class="built_in">printf</span>(<span class="string">&quot;No Solution\n&quot;</span>):<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p><a href="https://www.luogu.com.cn/problem/P3306">随机数生成器</a></p><p>本题的特判较多，我们慢慢分析</p><p>首先是 $a,b$ 可以等于 $0$ ，先特判掉，保证 $a,b&gt;0$ </p><p>再将问题转化：给定 $p,a,b,x_1,t$ 和递推公式 $x_{i+1}=a\times x_i+b\pmod p$ 求一个最小的 $n$ 使得 $x_n=t$  </p><p>当然，我们的第一步应该是找到 $x_n$ 的通项公式，<strong>我要开始变形了</strong>（以下均默认 $\mod p$）：<br>$$<br>\begin{align}<br>&amp;\text{设}c\in\mathbb{R}\text{且使得}x_i+c=a(x_{i-1}+c)\\<br>\Rightarrow&amp;x_i=ax_{i-1}+c(a-1)\\<br>&amp;\text{又}\because x_i=ax_{i-1}+b\\<br>\Rightarrow&amp;c=\frac{b}{a-1}(a\ne1)\\<br>\Rightarrow&amp;x_i+\frac{b}{a-1}=a(x_{i-1}+\frac{b}{a-1})(a\ne1)\\<br>&amp;\text{等比数列通项公式得}x_i+\frac{b}{a-1}=a^{i-1}(x_1+\frac{b}{a-1})(a\ne1)\\<br>\Rightarrow&amp;x_n+\frac{b}{a-1}=a^{n-1}(x_1+\frac{b}{a-1})(a\ne1)\\<br>&amp;\text{又}\because x_n=t\\<br>\Rightarrow&amp;t+\frac{b}{a-1}=a^{n-1}(x_1+\frac{b}{a-1})(a\ne1)\\<br>&amp;\text{特判掉}x_1+\frac{b}{a-1}=0\\<br>\Rightarrow&amp;a^{n-1}=\frac{t+\frac{b}{a-1}}{x_1+\frac{b}{a-1}}(a\ne1)<br>\end{align}<br>$$<br>特判 $a=1$ 的情况，然后，由于 $p$ 问题就转化为 $a^x\equiv b\pmod p$ 的形式，解出 $x$ 即是 $n-1$ </p><p>以上，用了三个特判，我们把问题转换为BSGS</p><p>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!b)&#123;</span><br><span class="line">x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> d=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">y-=a/b*x;</span><br><span class="line"><span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line"><span class="built_in">exgcd</span>(a,p,x,y);</span><br><span class="line"><span class="keyword">return</span> (x+p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>%p==b%p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;ha;</span><br><span class="line"><span class="keyword">int</span> k=<span class="built_in">sqrt</span>(p)+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=b%p;i&lt;k;++i)&#123;</span><br><span class="line">ha[j]=i;</span><br><span class="line">j=(LL)j*a%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ak=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) ak=(LL)ak*a%p;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=ak;i&lt;=k;++i)&#123;</span><br><span class="line"><span class="keyword">if</span>(ha.<span class="built_in">find</span>(j)!=ha.<span class="built_in">end</span>()) <span class="keyword">return</span> (LL)i*k-ha[j];</span><br><span class="line">j=(LL)j*ak%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> -INF;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line"><span class="keyword">int</span> p,a,b,x1,t;</span><br><span class="line"><span class="keyword">while</span>(T--)&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>,&amp;p,&amp;a,&amp;b,&amp;x1,&amp;t);</span><br><span class="line"><span class="keyword">if</span>(a==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(x1==t) <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(b==t) <span class="built_in">puts</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(b==<span class="number">0</span>) t==x1?<span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>):<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> x;</span><br><span class="line">x=((LL)<span class="built_in">inv</span>(b,p)*(t-x1)%p+p)%p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,x+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> C=(LL)b*<span class="built_in">inv</span>(a<span class="number">-1</span>,p)%p;</span><br><span class="line"><span class="keyword">int</span> A=(x1+C)%p;</span><br><span class="line"><span class="keyword">if</span>(A==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">int</span> u=(-C+p)%p;</span><br><span class="line">t==u?<span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>):<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">int</span> B=(t+C)%p;</span><br><span class="line"><span class="keyword">int</span> ans=<span class="built_in">bsgs</span>(a,(LL)B*<span class="built_in">inv</span>(A,p)%p,p);</span><br><span class="line">ans&lt;<span class="number">0</span>?<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>):<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数论,数学 </tag>
            
            <tag> 欧拉定理 </tag>
            
            <tag> hash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AC自动机</title>
      <link href="/2021/11/22/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
      <url>/2021/11/22/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<p>然而AC自动机并不能自动帮你AC</p><span id="more"></span><h2 id="钳制芝士"><a href="#钳制芝士" class="headerlink" title="钳制芝士"></a>钳制芝士</h2><ul><li>KMP<br>对字符串 $A$ 进行自我匹配，求出数组 $ne$ 使 $ne[i]$ 表示“ $A$ 中以 $i$ 结尾的非前缀子串与 $A$ 的前缀子串能匹配的最长长度”，即： $ne[i]=max{j}$ ，其中 $j&lt;i$ 并且 $\forall k \in [i-j+1,i],A[k]=A[k+j-i]$ （ $A[k+j-i]$ 即是 $A[1 \sim j]$ ） ，如图：<img src="https://i.loli.net/2021/12/02/RfbB6x92tagA71D.png" alt="KMP例子"><br>同理我们对字符串 $A$ 与 $B$ 进行匹配，求出数组 $f$ ，使 $f[i]$ 表示“ $B$ 中以 $i$ 结尾的子串与 $A$ 的前缀子串能匹配的最长长度”,即： $f[i]=max{j}$ ，其中 $j \le i$ 并且 $\forall k \in [i-j+1,i],B[k]=A[k+j-i]$<br>代码实现：</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//求ne数组</span></span><br><span class="line">ne[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=n;++i)&#123;<span class="comment">//&quot;非前缀子串&quot;,故i从2开始 </span></span><br><span class="line"><span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;a[i]!=a[j+<span class="number">1</span>]) j=ne[j];</span><br><span class="line"><span class="keyword">if</span>(a[i]==a[j+<span class="number">1</span>]) ++j;</span><br><span class="line">ne[i]=j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求f数组</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=m;++i)&#123;</span><br><span class="line"><span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;(j==n||b[i]!=a[j+<span class="number">1</span>])) j=ne[j];</span><br><span class="line"><span class="keyword">if</span>(b[i]==a[j+<span class="number">1</span>]) ++j;</span><br><span class="line">f[i]=j;</span><br><span class="line"><span class="keyword">if</span>(f[i]==n)&#123;</span><br><span class="line"><span class="comment">//此时就是A在B中的一次出现 </span></span><br><span class="line">&#125;</span><br><span class="line">&#125;                     </span><br></pre></td></tr></table></figure><ul><li>Trie（字典树）<br>用于统计，排序和保存大量的字符串（但不仅限于字符串），优点是：利用字符串的公共前缀来减少查询时间，最大限度地减少无谓的字符串比较。<br><img src="https://cdn.luogu.com.cn/upload/image_hosting/vcxx8qhd.png" alt="Trie"><br>代码：</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> trie[N][<span class="number">26</span>],tot=<span class="number">1</span>;<span class="comment">//设字符串由小写字母构成</span></span><br><span class="line"><span class="keyword">bool</span> end[N];</span><br><span class="line"><span class="comment">//插入一个字符串</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l=<span class="built_in">strlen</span>(s),p=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;l;++k)&#123;</span><br><span class="line"><span class="keyword">int</span> ch=s[k]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(trie[p][ch]==<span class="number">0</span>) trie[p][ch]=++tot;</span><br><span class="line">p=trie[p][ch];</span><br><span class="line">&#125;</span><br><span class="line">end[p]=<span class="literal">true</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// 搜索一个字符串</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l=<span class="built_in">strlen</span>(s),p=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;l;++k)&#123;</span><br><span class="line">p=trie[p][s[k]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(p==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> end[p];</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h2 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h2><p>大家都知道KMP算法是求单字符串对单字符串的匹配使用的，那么，多个字符串在一个字符串上的匹配怎么办？ 如：<br>求 abab 在 abababbabbaabbabbab 中出现了几次。<br>很明显，求出abab的 $ne$ 数组，然后进行KMP的匹配即可出解。<br>辣么——求 aba 、 aca 、 bab 、 sab 、 sba 在字符串 asabbasbaabbabbacaacbscbs 中总共出现了几次。此时如果再对于每一个需要匹配的串求一次 $ne$ 数组，时间复杂度过大了……<br>辣么，AC自动机是如何解决此问题的呢？ </p><hr><p>开始前，先看看定义：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span>&#123;</span><span class="comment">//字典树 </span></span><br><span class="line"><span class="keyword">int</span> fail;<span class="comment">//失配指针 </span></span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">26</span>];<span class="comment">//子节点位置 </span></span><br><span class="line"><span class="keyword">int</span> end;<span class="comment">//标记结尾</span></span><br><span class="line">&#125;ac[N];</span><br></pre></td></tr></table></figure><p>然后开始吧！<br>首先，将所有的需要匹配的字符串构造成一棵Tire树，如图（灰色节点表示一个单词的结尾）：<img src="https://cdn.luogu.com.cn/upload/image_hosting/vnrb9ian.png" alt="待匹配串"><br>然后，类似于KMP建立失配指针（即 $ne$ 数组），其定义为：当前节点所代表的串中，最长的、能与后缀匹配的，在 Trie 中出现过的前缀所代表的节点。<br>类似的，可以通过跳转来省略重复的检查。<br>如图是已建立好的：<img src="https://cdn.luogu.com.cn/upload/image_hosting/c9lxu68e.png" alt="失配"><br>每次沿着Trie树匹配，匹配到当前位置没有匹配上时，直接跳转到失配指针所指向的位置继续进行匹配。<br>所以，这个Trie树的失配指针要怎么求？<br>我们发现Trie树的失配指针是指向：沿着其父节点的失配指针，一直向上，直到找到拥有当前这个字母为子节点的节点，它的那个子节点就是目标。<br>如上图中 she 中的 e ，它的父节点是 h （ s 下面那个），而 h 的失配指针指向另一个 h （根下面那个），且这个 h 的子节点中有一个 e ，就将 she 中的 e 指向这个 e 。<br>需要注意的是，若找不到符合要求的节点，就将失配指针指向根，不难发现，第二层的所有节点的失配指针，都要直接指向Trie树的根节点。<br>代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造fail指针 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get_fail</span><span class="params">()</span></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt;q;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)<span class="comment">//第二层的fail指针预处理 </span></span><br><span class="line"><span class="keyword">if</span>(ac[<span class="number">0</span>].vis[i]!=<span class="number">0</span>)&#123;</span><br><span class="line">ac[ac[<span class="number">0</span>].vis[i]].fail=<span class="number">0</span>;<span class="comment">//指向根节点 </span></span><br><span class="line">q.<span class="built_in">push</span>(ac[<span class="number">0</span>].vis[i]);<span class="comment">//入队 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;<span class="comment">//BFS求fail指针 </span></span><br><span class="line"><span class="keyword">int</span> u=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)<span class="comment">//枚举子节点 </span></span><br><span class="line"><span class="keyword">if</span>(ac[u].vis[i]!=<span class="number">0</span>)&#123;<span class="comment">//该节点存在 </span></span><br><span class="line">ac[ac[u].vis[i]].fail=ac[ac[u].fail].vis[i];<span class="comment">//子节点的fail指针 指向当前节点的</span></span><br><span class="line"><span class="comment">//fail指针 所指向的节点 的相同子节点 </span></span><br><span class="line">q.<span class="built_in">push</span>(ac[u].vis[i]);<span class="comment">//入队 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//不存在这个子节点 </span></span><br><span class="line">ac[u].vis[i]=ac[ac[u].fail].vis[i]; <span class="comment">//当前节点的这个子节点指向当</span></span><br><span class="line">                      <span class="comment">//前节点fail指针的这个子节点</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后，我们直接匹配即可了！先让指针指向根节点<br>依次读入单词，检查是否存在这个子节点，然后指针跳转到子节点，如果不存在，直接跳转到失配指针即可。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AC自动机匹配</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ac_query</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l=s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">int</span> now=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;l;++i)&#123;</span><br><span class="line">now=ac[now].vis[s[i]-<span class="string">&#x27;a&#x27;</span>];<span class="comment">//向下一层</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> t=now;t;t=ac[t].fail)<span class="comment">//循环求解 </span></span><br><span class="line">ans[ac[t].end].num++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>最后给出总的代码（尝试了一下标准码风）：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P376</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> fail;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">26</span>];</span><br><span class="line"><span class="keyword">int</span> end;</span><br><span class="line">&#125; ac[N];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Result</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"><span class="keyword">int</span> pos;</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Result &amp;y)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> num != y.num ? num &gt; y.num : pos &lt; y.pos;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inint</span><span class="params">(<span class="keyword">int</span> _num, <span class="keyword">int</span> _pos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">num = _num;</span><br><span class="line">pos = _pos;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; ans[N];</span><br><span class="line">string s[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clean</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">memset</span>(ac[x].vis, <span class="number">0</span>, <span class="keyword">sizeof</span> ac[x].vis);</span><br><span class="line">ac[x].fail = <span class="number">0</span>;</span><br><span class="line">ac[x].end = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_Trie</span><span class="params">(string s, <span class="keyword">int</span> Num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>] == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++cnt;</span><br><span class="line"><span class="built_in">clean</span>(cnt);</span><br><span class="line">&#125;</span><br><span class="line">now = ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line">ac[now].end = Num;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line"><span class="keyword">if</span> (ac[<span class="number">0</span>].vis[i] != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ac[ac[<span class="number">0</span>].vis[i]].fail = <span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(ac[<span class="number">0</span>].vis[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line"><span class="keyword">if</span> (ac[u].vis[i] != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ac[ac[u].vis[i]].fail = ac[ac[u].fail].vis[i];</span><br><span class="line">q.<span class="built_in">push</span>(ac[u].vis[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ac[u].vis[i] = ac[ac[u].fail].vis[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AC_query</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i)</span><br><span class="line">&#123;</span><br><span class="line">now = ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> t = now; t; t = ac[t].fail)</span><br><span class="line">ans[ac[t].end].num++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">clean</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; s[i];</span><br><span class="line">ans[i].<span class="built_in">inint</span>(<span class="number">0</span>, i);</span><br><span class="line"><span class="built_in">build_Trie</span>(s[i], i);</span><br><span class="line">&#125;</span><br><span class="line">ac[<span class="number">0</span>].fail = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_fail</span>();</span><br><span class="line">cin &gt;&gt; s[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">AC_query</span>(s[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">sort</span>(ans + <span class="number">1</span>, ans + <span class="number">1</span> + n);</span><br><span class="line">cout &lt;&lt; ans[<span class="number">1</span>].num &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; s[ans[<span class="number">1</span>].pos] &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line"><span class="keyword">if</span> (ans[i].num == ans[i - <span class="number">1</span>].num)</span><br><span class="line">cout &lt;&lt; s[ans[i].pos] &lt;&lt; endl;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>补充，可以把搜索过程改为拓扑序，可以过加强版</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P5357</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">300005</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> fail;</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">26</span>];</span><br><span class="line"><span class="keyword">int</span> end;</span><br><span class="line"><span class="keyword">int</span> as;</span><br><span class="line">&#125; ac[N];</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> re[N], in[N], ans[N];</span><br><span class="line">string s[N];</span><br><span class="line">queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_Trie</span><span class="params">(string s, <span class="keyword">int</span> Num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>] = ++cnt;</span><br><span class="line">now = ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!ac[now].end)</span><br><span class="line">ac[now].end = Num;</span><br><span class="line">re[Num] = ac[now].end;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_fail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line"><span class="keyword">if</span> (ac[<span class="number">0</span>].vis[i] != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ac[ac[<span class="number">0</span>].vis[i]].fail = <span class="number">0</span>;</span><br><span class="line">q.<span class="built_in">push</span>(ac[<span class="number">0</span>].vis[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> v = ac[u].vis[i];</span><br><span class="line"><span class="keyword">if</span> (v)</span><br><span class="line">&#123;</span><br><span class="line">ac[v].fail = ac[ac[u].fail].vis[i];</span><br><span class="line">in[ac[v].fail]++;</span><br><span class="line">q.<span class="built_in">push</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ac[u].vis[i] = ac[ac[u].fail].vis[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AC_query</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l = s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i)</span><br><span class="line">&#123;</span><br><span class="line">now = ac[now].vis[s[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">ac[now].as++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line"><span class="keyword">if</span> (!in[i])</span><br><span class="line">q.<span class="built_in">push</span>(i);</span><br><span class="line"><span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line">ans[ac[u].end] = ac[u].as;</span><br><span class="line"><span class="keyword">int</span> v = ac[u].fail;</span><br><span class="line">in[v]--;</span><br><span class="line">ac[v].as += ac[u].as;</span><br><span class="line"><span class="keyword">if</span> (!in[v])</span><br><span class="line">q.<span class="built_in">push</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; s[i];</span><br><span class="line"><span class="built_in">build_Trie</span>(s[i], i);</span><br><span class="line">&#125;</span><br><span class="line">ac[<span class="number">0</span>].fail = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">get_fail</span>();</span><br><span class="line">cin &gt;&gt; s[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">AC_query</span>(s[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">topu</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">cout &lt;&lt; ans[re[i]] &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串 </tag>
            
            <tag> 自动机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Noip2021游记</title>
      <link href="/2021/11/22/Noip2021%E6%B8%B8%E8%AE%B0/"/>
      <url>/2021/11/22/Noip2021%E6%B8%B8%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>Dyd’s stroy of noip2021</p><span id="more"></span><h1 id="NOIP2021游记"><a href="#NOIP2021游记" class="headerlink" title="NOIP2021游记"></a>NOIP2021游记</h1><h2 id="CSP-S"><a href="#CSP-S" class="headerlink" title="CSP-S"></a>CSP-S</h2><p>备考CSP-S时主要靠做题吧，期间学了些东西（基环树、笛卡尔树、<strong>模拟退火</strong>……），考的时候<strong>T1</strong>看错了数据范围，又打线段树又打平衡树的，还是爆0了，心态爆炸，后面三道题随便打了暴力，结果学的东西一个都没用上，从考场出来就知道自己要凉凉，就这样吧</p><h2 id="Day-n"><a href="#Day-n" class="headerlink" title="Day-n"></a>Day-n</h2><h3 id="大概情况"><a href="#大概情况" class="headerlink" title="大概情况"></a>大概情况</h3><p>学倒是学了很多东西，但<strong>漏洞颇多</strong>（很多遗忘、不会运用、看着题目转化不来），感觉是平日里划水划多了，练题练少了，但也就那样混过了CSP-S（考得跟shit一样），备战NOIP期间学了些数学知识，感觉难得一匹（<del>然而考都没考</del>），其它的事都忘得差不多了，但记得天天模拟测试，每天也就那样（感觉自己好佛系，但有点进步吧）</p><h3 id="印象较深的一天"><a href="#印象较深的一天" class="headerlink" title="印象较深的一天"></a>印象较深的一天</h3><p>有一天上上届的银牌巨佬<strong>lhj</strong>（<del>jklover</del>）来给我们又讲了讲数学（莫反、斯特林数……），感觉到后面高二的<strong>龙巨</strong>是唯一听懂他说话的人，平时常常听什么牛B的人的故事，最近的如重庆<strong>wdw</strong>高一就考上五道口职业技术学校（<del>清华</del>），但真正活生生的巨佬（听老师说他不仅竞赛强，高考还考了680+，清华发了通知书的，但专业不满意，复读一年）站在面前才感觉到强大</p><p>讲个冷笑话吧：<strong>wdw</strong>高一就被清华录取、<strong>lxl</strong>的毒瘤名扬luogu、<strong>lhj</strong>竞赛常规双强、<strong>我（Dyd）</strong>做完了青年大学习……我们都有<strong>光明的前途</strong></p><p>笑笑归笑笑，人活一辈子受苦受福都是自己的事，莫管别人如何厉害都玉女无瓜</p><p><strong>lhj</strong>巨佬给我们讲题时上了他的blog，感觉好厉害，自己也（<del>浪费了有一两天的时间</del>）从零开始搭了个（<del>特别拉垮的</del>）blog，好看是挺好看的，但 $LeTaX$ 太拉了，而且github的访问性过差，不是很想维护了，感觉Typora是yyds</p><h3 id="印象较深的一天2"><a href="#印象较深的一天2" class="headerlink" title="印象较深的一天2"></a>印象较深的一天2</h3><p>还有一天，遇到了下一届信息竞赛的人，里面有好多我们认识的，我还教了他们用VScode和firefox插件，机房里的<strong>wfy</strong>大佬还给他们讲了课（讲的Trie），<strong>wfy</strong>大佬说他感觉下一届的人不怎么强，我不是很了解，但作为不大不小的一个前辈，我衷心希望他们会比我们更强，毕竟后浪要推前浪，人类才会进步</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>然后就是复习了，花了较多时间复习<strong>dp</strong>，树上的、区间的等等（<del>然而后面就会知道一点用都没有</del>），网络流也看了看（因为CSP-S时机房里有人用网络流第四题拿了高分）</p><h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day-2"></a>Day-2</h2><p>考前两天，在luogu上AC300祭了，个人感觉要凉凉，因为我CSP-S考前也祭了个啥（具体忘了），结果CSP-S爆炸，A的是一道<strong>退火</strong>的紫题，由于第301题就是（<del>一道很水的</del>）黑题，所以很后悔没用黑题300祭，印象很深，心里有点忐忑，不过我和<strong>龙巨</strong>一起在玩一个很好玩的单机网页游戏，叫“膜拜Siyuan”，虽然就是点点点，但挺有意思的，<strong>龙巨</strong>给了我两个连点器，一个用C++写的（然而中文注释部分在运行时会乱码，不过不影响使用），还有一个用JavaScript写的（这个看不懂，但很好用），<strong>龙巨</strong>玩的比我晚，但凭着连点器和完美的策略，<strong>龙巨</strong>已经比我强了</p><p>除此之外，认真复习了一下<strong>线段树</strong>（<del>然而后面就会知道一点用都没有</del>）</p><h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day-1"></a>Day-1</h2><p>考前一天，看了看考场，键盘是个痛，但适应了还好，考试时准备用虚拟机，所以没怎么看windows下的C++（**<del>埋下伏笔</del>**）</p><p>下午和晚上复习了模板，对着书把能想到的模板都过了一遍手（Tarjan打的有点急，不知对错，Dinic是第二天早上打的，当天来不及了），感觉自己图论和数学忘的差不多了，膜拜Siyuan没怎么管，开着连点器挂着的</p><p>机房<strong>张巨</strong>佬在luogu上发了个邀请面基的帖子，没想到真有（<del>除了我们机房以外的</del>）人回了，我们（<del>非常高素质的</del>）通过考号把别人人肉出来了，私信问他是不是xxx中学的xxx，他可能是有点怕，把帖子删了，但和我们机房某位大佬在私信里聊了起来，不知他们聊了什么</p><p>机房的<strong>龙巨</strong>把账号名改成了Tir_JK_LOVER，说是要延续<strong>lhj</strong>巨佬的名号，我本来也想改的，但好像改了就改不回来了（luogu的中文用户名据说绝版了），就没改</p><p>晚上走之前极限发了个rp++的帖子，标题叫“to add or not to add,it’s a problem”</p><h2 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h2><p>为了方便以负数代表考前，正数代表考试，所以考试这天是Day1</p><h3 id="考前"><a href="#考前" class="headerlink" title="考前"></a>考前</h3><p>上午打了昨天留下的Dinic模板，然后机房里就开始各自<strong>听歌</strong>，我听了《If We Have Each Other》（最多）、《Salt》、《Boy in the Bubble》和《Next of Kin》，感觉听了后心情挺好的，然后我们就奔赴考场了</p><h3 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h3><p>T1看了一眼，第一反应是个类似与<strong>筛质数</strong>的水题，很快打好了，算了一下时间复杂度是 $O(n\log n)$ 一看 $n$ ，1e7，我没想到这个1e7有很多会跳过，<strong>根本跑不满</strong>，只觉得这不是完蛋了（考场上<strong>第一题还是很慌</strong>，毕竟上一次CSP-S也败在第一题上了），于是脑袋一蒙，竟然决定打一个1e7的表！（<del>我就完全没注意我的程序在打表的时候1e7的数据都跑的飞快</del>）好不容易打好了（中间还因为表太大虚拟机挂了一次，<strong>有点炸心态</strong>，为了这个表我打了一个超长的快读快输，不然输出太耗时了），一看代码<strong>3千多k</strong>，这不完蛋，我一看就打了个分段的代码， $O(n\log n)$ 去拿70分，剩下30分玄学（我真的觉的自己这个是脑袋有问题，不分段就能过了的）</p><h3 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h3><p>T2感觉是个<strong>dp</strong>，但那个数据范围太奇怪（我dp题见得少），只想到设<strong>二维</strong>，怎么搞怎么不对，推了5分钟跳了</p><p>T3一看没思路，感觉得暴力，就跳了</p><p>T4先一看：和CSP-S一样又是<strong>网格图</strong>，又是巨长无比的题面，简直离谱，读完题先想<strong>网络流</strong>，想不出来，看了一下数据范围就决定打暴力，但感觉暴力<strong>不好打</strong>（太长），就先去打T3</p><p>回到T3，看到序列变方式感觉像<strong>差分</strong>，一推发现变化 $a_x$ 就是把差分序列 $b_x$ 和 $b_{x + 1}$ 交换，马上来劲了，把差分带回去看能不能求方差，结果没搞出来，果断决定<strong>退火</strong>，大概就是求出差分序列，每次随机交换两个相邻的数，然后 $O(n)$ 求估价并更新答案，第一次只过了样例一，有点慌，怕打错，调了下<strong>精度</strong>过了样例二，感觉好多了，至少正确性是对的，只是精度和时间的问题罢了，又调精度，第三、四个样例要么WA（精度不够）要么TLE（精度太大），感觉遇到瓶颈了，决定去<strong>上个厕所</strong></p><p>回来以后<strong>心态好多了</strong>，开始认真<strong>优化退火</strong>，又鼓捣了不知多久的数学，发现答案就是 $sum2 * n - sum^2$ ，其中 $sum2$ 代表 ${a_i}$ 的平方和， $sum$ 代表 ${a_i}$ 的和，于是思考可否在退火时利用上一次的估价 $O(1)$ 求估价，发现对于同一个数连续操作两次其实就和没操作一样（交换两次就交换回来了），于是状态可以还原了，果断<strong>放弃差分数组</strong>，就对着原数组每次随机选一个数操作， $O(1)$ 估价，调了一下精度和退火次数，过了样例，但估价只能拿个40分的样子，看了数据范围发现 $a_i$ 有很多都<strong>相等</strong>，应该还可以优化，但我还有两题没有代码，不敢再多耗时间，就走了</p><h3 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h3><p>打完T3决定把剩下两题的<strong>暴力</strong>打了，看了看觉得T2的暴力<strong>好打</strong>点，就去打T2，最初想的 $m^n$ 枚举序列 ${a_i}$ ，用map来判重，直接暴力只能过样例一，感觉太悬了，看到样例解释，决定枚举 $S$ 暴力求 ${a_i}$ 中每个数有几个，用<strong>组合数</strong>统计答案，又随便调了一下，样例二太<strong>水</strong>了，竟然优化过了，也不想其他的，就去打T4</p><h3 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h3><p>打T4暴力的时候<strong>时间已经不多了</strong>，随便想了个暴力，看了看估计能有20 $\sim$ 30分吧，但没调好就有老师提醒说还有半个小时了，叫我们先<strong>检查</strong>一下，我也觉得有道理，毕竟考场上不敢赌博，就<strong>关了虚拟机</strong>去检查一下前面的freopen等等，打算检查完了用windows下的**devc++<strong>调试（</strong><del>伏笔回收</del>**）</p><p>检查完了，打开dev，一调试就<strong>闪退</strong>，连着两、三次，只好放弃调试，用**cout+exit(0)**的组合硬调（感觉再打开虚拟机来不及了），调出了 $opt = 0,1,2$ 的情况， $opt = 3$ 的情况来不及调就结束了，估计是没分了</p><h3 id="考后"><a href="#考后" class="headerlink" title="考后"></a>考后</h3><p>刚从考场出来感觉还行，和同机房的人聊了下情况，T1他们几乎都打的 $O(n\log n)$ ，<strong>wfy</strong>大佬拍着胸口说第一题<strong>不会太卡你</strong>的，我觉得有道理（当然事实证明是真的有道理），有点后悔，T3<strong>wfy</strong>和<strong>l18q</strong>也打的退火，但我们三个退思路的都不一样，感觉自己要凉凉，T4发现暴力的分比T2高，后悔没先打T4，T2好像只有<strong>wfy</strong>大佬打的dp，他说 $O(n^4m)$ 能过，我对这个复杂度想都没想过</p><p>中午出去吃了个汉堡，买了奶茶<strong>散了会儿步</strong>（我比较喜欢一个人散步），散完步心情很好，如释重负的感觉，就像一直被系着的麻雀突然发现绳子变长了一样（<del>奇妙比喻</del>）</p><p>下午和晚上和同学一起玩去了，主要是看番（钢炼09、杀手……）和打文明6（我们打了好久才干掉一个电脑），还行吧，收假就要回归常规了</p><h2 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h2><p>考后第二天，在luogu上自测，T1被分段卡的只有50分，比想象的还惨，T2暴力20分正常吧，T3退火退了44分，T4爆0，总分100来分吧，估价1=是无望了，明年再加油吧！</p><p>机房里最强的是<strong>wfy</strong>大佬，T1过了，T2也应该是过了（luogu上80，小灵通100），T3他的退火也接近满分（他是退差分数组，比我多推出来一个性质： ${b_i}$ 应该是先降后升，呈<strong>单谷型</strong>的），T4他暴力20 $\sim$ 40分，总分300+（<del>艹比我高200多</del>）</p><p>看了题解，T1是真的可惜，T2的dp我估计我是打不出来（dp学的太拉了，加油补吧），T3竟然也是dp，还巨难，要推很多性质和优化，T4是最离谱的，几乎把线段树用到了极致，可我连线段树都没想到</p><p>刚对下来还是有点<strong>失望</strong>，毕竟T1和T4不免有些可惜，但又一想，我犯了低级错误，别人就没犯吗?<strong>wfy</strong>大佬都犯了低价错误，不然T4还要高些分，犯这些错只说明我的<strong>水平还待提高</strong>罢了</p><p>还有一件让人伤心的事是高二的两位巨佬（<strong>龙巨</strong>和<strong>张巨</strong>）考完就<strong>AFO</strong>了，补完常规就分到别的班去了，虽然和两位巨佬相处不足一年，但他们还是<strong>很照顾我们这些后辈</strong>的，给了我们很多帮助，老实说，考完以后他们就早早离开了，还是很不舍的，祝愿他们能进入自己理想的大学吧</p><h2 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h2><p>写完游记感觉心情好多了，可能是因为我比较乐观吧</p><p>不管如何，生活的车轮只会自顾自的碾过时间，命运的道路永远是单向的，愿我们回首时无悔于所有自己做对的事和做错的事</p><p>2021/11/29 成绩出来了，50 + 20 + 56 + 0，一共126，估计是2=了，不过我早就看开了（<del>话说我也太没心没肺了吧</del>）</p><p><strong>the end</strong></p>]]></content>
      
      
      <categories>
          
          <category> 游记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游记 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
